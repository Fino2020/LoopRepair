2025-02-02 13:03:58.464 | INFO     | scenario:build:265 - loaded bug scenario: Scenario(subject='libxml2', name='CVE-2016-1839', directory='/data/vulnloc/libxml2/CVE-2016-1839', build_directory='/data/vulnloc/libxml2/CVE-2016-1839/src', source_directory='/data/vulnloc/libxml2/CVE-2016-1839/src', tag_id='libxml2_CVE-2016-1839', binary_path='/data//vulnloc/libxml2/CVE-2016-1839/src/xmllint', clean_command='make clean', prebuild_command='exit 0', build_command='make CFLAGS="${INJECT_CFLAGS}" CXXFLAGS="${INJECT_CXXFLAGS}" LDFLAGS="${INJECT_LDFLAGS}" xmllint', crashing_command='-html $POC', crashing_input='/CrashRepair/experiments/vulnloc/libxml2/CVE-2016-1839/tests/1.txt', shell=Shell(cwd='/data/vulnloc/libxml2/CVE-2016-1839'), crash_test=Test(name='crash', command='/data//vulnloc/libxml2/CVE-2016-1839/src/xmllint -html /CrashRepair/experiments/vulnloc/libxml2/CVE-2016-1839/tests/1.txt', expected_exit_code=0, expected_stdout=None, bad_output='SUMMARY: AddressSanitizer:', asan_options=None, ubsan_options=None), sanitizer_flags='-fsanitize=address', additional_klee_flags='', expected_exit_code_for_crashing_input=0, should_terminate_early=True, fuzzer_tests=[], fuzzer=None, time_limit_minutes_validation=None, time_limit_seconds_single_test=30, time_limit_minutes_analysis=3600, halt_on_error=True, rebuild_for_validation=False, asan_options=None, ubsan_options=None, use_ghost_functions=True, acceptable_patch_limit=None)
2025-02-02 13:03:58.464 | INFO     | scenario:fuzz:426 - skipping fuzzing: fuzzer disabled
2025-02-02 13:03:58.464 | INFO     | analyzer:run:114 - running analysis with timeout: 60 minutes
2025-02-02 13:03:58.464 | DEBUG    | analyzer:write_config_to_file:88 - generated analyzer config:

dir_exp:/data/vulnloc/libxml2/CVE-2016-1839
tag_id:libxml2_CVE-2016-1839
src_directory:/data/vulnloc/libxml2/CVE-2016-1839/src
binary_path:/data//vulnloc/libxml2/CVE-2016-1839/src/xmllint
config_command:exit 0
build_command:make CFLAGS="${INJECT_CFLAGS}" CXXFLAGS="${INJECT_CXXFLAGS}" LDFLAGS="${INJECT_LDFLAGS}" xmllint
test_input_list:-html $POC
poc_list:/CrashRepair/experiments/vulnloc/libxml2/CVE-2016-1839/tests/1.txt
klee_flags:--link-llvm-lib=/CrashRepair/lib/libcrepair_proxy.bca 

2025-02-02 13:03:58.464 | DEBUG    | analyzer:run:124 - wrote analyzer config file to: /tmp/tmpx5daskz5
2025-02-02 13:03:58.464 | DEBUG    | shell:__call__:41 - executing: crepair --conf=/tmp/tmpx5daskz5
[K[1;36m
====================================================================================================

	Starting CRepair (C Crash Repair) 
====================================================================================================
[0m
[K[1;36m
	Loading Configurations
	__________________________________________________________________________________________
[0m
[K	[1;34mreading configuration values from arguments[0m
[K	[1;34mreading configuration values form configuration file[0m
[K	[1;37m	[file] /tmp/tmpx5daskz5[0m
[K	[1;34mupdating configuration values[0m
[K	[1;34mreading test configuration[0m
[K	[1;34mreading seed information[0m
[K	[1;37m	[config] stack size: 15000[0m
[K	[1;37m	[config] collecting stats: False[0m
[K	[1;37m	[config] number of tests: 1[0m
[K	[1;37m	[config] number of cores: 8[0m
[K	[1;37m	[config] klee concrete execution timeout: 600[0m
[K	[1;37m	[config] klee concolic execution timeout: 1200[0m
[K	[1;37m	[config] synthesize subset expressions: True[0m
[K	[1;37m	[config] window size for taint locations: 500[0m
[K	[1;37m	[config] window size for taint values: 500000[0m
[K[1;36m

	Analyzing Program
====================================================================================================
[0m
[K[1;36m
	Test Case #1
	__________________________________________________________________________________________
[0m
[K[1;36m
		Running Concrete Execution
		------------------------------------------------------------------------------------------
[0m
[K	[1;37m	[0m[K     [1;37mUsing Arguments: ['-html', '$POC'][0m
[K	[1;37m	[0m[K     [1;37mUsing Input File: /CrashRepair/experiments/vulnloc/libxml2/CVE-2016-1839/tests/1.txt[0m
[K	[1;34m	building program[0m
[K	[1;34m		setting environment variables[0m
[K	[1;34m		cleaning files[0m
[K	[1;34m		configuring program[0m
[K	[1;34m		compiling program[0m
[K	[1;37m	[0m[K     [1;37mUsing Binary: /data//vulnloc/libxml2/CVE-2016-1839/src/xmllint[0m
[K	[1;34m	extracting bytecode[0m
[K	[1;34m	executing klee in concrete mode[0m
[K	[1;34m	extracting instruction trace[0m
[K	[1;37m		[note] program crashed[0m
[K	[1;34m	collecting tainted expressions[0m
[K	[1;34m	collecting tainted concrete values[0m
[K	[1;34m	collecting memory allocations/de-allocations[0m
[K	[1;34m	collecting pointer mapping[0m
[K	[1;34m	extracting crash information[0m
[K	[1;37m		[0m[K     [1;37m[info] crash type: memory read overflow[0m
[K	[1;37m		[0m[K     [1;37m[info] crash location: /data/vulnloc/libxml2/CVE-2016-1839/src/dict.c:448:13[0m
[K	[1;37m		[0m[K     [1;37m[info] crash function: xmlDictComputeFastKey[0m
[K	[1;37m		[0m[K     [1;37m[info] crash address: 48412[0m
[K	[1;37m		[0m[K     [1;37m[info] crash free constraint: ((base  @var(pointer, name)) <= @var(pointer, name))[0m
[K	[1;37m		[0m[K     [1;37m[info] crash inducing variables: (base  @var(pointer, name)), name[0m
[K	[1;37m			[info] identified crash type: memory read overflow[0m
[K[1;36m
		Running Concolic Execution
		------------------------------------------------------------------------------------------
[0m
[K	[1;37m	[0m[K     [1;37mUsing Arguments: ['-html', '$POC'][0m
[K	[1;37m	[0m[K     [1;37mUsing Input File: /CrashRepair/experiments/vulnloc/libxml2/CVE-2016-1839/tests/1.txt[0m
[K	[1;34m	building program[0m
[K	[1;34m		setting environment variables[0m
[K	[1;34m		cleaning files[0m
[K	[1;34m		configuring program[0m
[K	[1;34m		compiling program[0m
[K	[1;34m	extracting bytecode[0m
[K	[1;34m	generating ktest file[0m
[K	[1;34m	executing klee in concolic mode[0m
[K	[1;34m	extracting largest symbolic path[0m
[K	[1;34m	extracting instruction trace[0m
[K	[1;37m		[note] program did not crash[0m
[K	[1;33m	[warning] Unknown Crash Reason: [0m
[K	[1;33m	[warning] taint analysis failed, using concrete values[0m
[K	[1;37m		[0m[K     [1;37m[info] Symbolic Mapping: name -> [bv1111107160][0m
[K	[1;37m		[0m[K     [1;37m[info] Symbolic Mapping: (base  @var(pointer, name)) -> [bv1111107160][0m
[K[1;36m

	Fix Localization
====================================================================================================
[0m
[K[1;36m
	Generating Fix Locations
	__________________________________________________________________________________________
[0m
[K	[1;34m	generating taint map[0m
[K	[1;37m		[0m[K     [1;37m[info] found 1328 tainted locations[0m
[K	[1;34m		starting parallel computing[0m
[K	[1;34m		waiting for thread completion[0m
[K	[1;37m		[0m[K     [1;37m[info] found 6 source files[0m
[K	[1;37m		[0m[K     [1;37m[info] found 12 executed functions[0m
[K	[1;34m	generating possible fix locations[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] xmlDictComputeFastKey,
                             /data/vulnloc/libxml2/CVE-2016-1839/src/dict.c:448:13[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] xmlDictComputeFastKey,
                             /data/vulnloc/libxml2/CVE-2016-1839/src/dict.c:448:14[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] xmlDictComputeFastKey,
                             /data/vulnloc/libxml2/CVE-2016-1839/src/dict.c:447:14[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] xmlDictComputeFastKey,
                             /data/vulnloc/libxml2/CVE-2016-1839/src/dict.c:447:9[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] xmlDictComputeFastKey,
                             /data/vulnloc/libxml2/CVE-2016-1839/src/dict.c:445:19[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] xmlDictComputeFastKey,
                             /data/vulnloc/libxml2/CVE-2016-1839/src/dict.c:445:27[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] xmlDictComputeFastKey,
                             /data/vulnloc/libxml2/CVE-2016-1839/src/dict.c:444:2[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] xmlDictComputeFastKey,
                             /data/vulnloc/libxml2/CVE-2016-1839/src/dict.c:444:1[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] xmlDictComputeFastKey,
                             /data/vulnloc/libxml2/CVE-2016-1839/src/dict.c:444:0[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] xmlDictLookup, /data/vulnloc/libxml2/CVE-2016-1839/src/dict.c:851:12[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] xmlDictLookup, /data/vulnloc/libxml2/CVE-2016-1839/src/dict.c:845:12[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] xmlDictLookup, /data/vulnloc/libxml2/CVE-2016-1839/src/dict.c:845:10[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] xmlDictLookup, /data/vulnloc/libxml2/CVE-2016-1839/src/dict.c:844:23[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] xmlDictLookup, /data/vulnloc/libxml2/CVE-2016-1839/src/dict.c:844:17[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] xmlDictLookup, /data/vulnloc/libxml2/CVE-2016-1839/src/dict.c:844:11[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] xmlDictLookup, /data/vulnloc/libxml2/CVE-2016-1839/src/dict.c:842:11[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] xmlDictLookup, /data/vulnloc/libxml2/CVE-2016-1839/src/dict.c:842:13[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] xmlDictLookup, /data/vulnloc/libxml2/CVE-2016-1839/src/dict.c:839:13[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] xmlDictLookup, /data/vulnloc/libxml2/CVE-2016-1839/src/dict.c:839:9[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] xmlDictLookup, /data/vulnloc/libxml2/CVE-2016-1839/src/dict.c:836:33[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] xmlDictLookup, /data/vulnloc/libxml2/CVE-2016-1839/src/dict.c:836:28[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] xmlDictLookup, /data/vulnloc/libxml2/CVE-2016-1839/src/dict.c:836:15[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] xmlDictLookup, /data/vulnloc/libxml2/CVE-2016-1839/src/dict.c:836:10[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] xmlDictLookup, /data/vulnloc/libxml2/CVE-2016-1839/src/dict.c:830:30[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] xmlDictLookup, /data/vulnloc/libxml2/CVE-2016-1839/src/dict.c:829:2[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] xmlDictLookup, /data/vulnloc/libxml2/CVE-2016-1839/src/dict.c:829:1[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] htmlParseNameComplex,
                             /data/vulnloc/libxml2/CVE-2016-1839/src/HTMLparser.c:2517:62[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] htmlParseNameComplex,
                             /data/vulnloc/libxml2/CVE-2016-1839/src/HTMLparser.c:2517:55[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] htmlParseNameComplex,
                             /data/vulnloc/libxml2/CVE-2016-1839/src/HTMLparser.c:2517:57[0m
[K[1;36m
	Localizing Constraints
	__________________________________________________________________________________________
[0m
[K	[1;33m	[warning] did not find top-level for ('/data/vulnloc/libxml2/CVE-2016-1839/src/dict.c', 444, 0)[0m
[K[1;36m
		[fix-loc] /data/vulnloc/libxml2/CVE-2016-1839/src/dict.c:447:5
		------------------------------------------------------------------------------------------
[0m
[K	[1;37m	[0m[K     [1;37m[constraint] (@var(pointer, crepair_base(name)) <= @var(pointer, name))[0m
[K[1;36m
		[fix-loc] /data/vulnloc/libxml2/CVE-2016-1839/src/dict.c:448:5
		------------------------------------------------------------------------------------------
[0m
[K	[1;37m	[0m[K     [1;37m[constraint] (@var(pointer, crepair_base(name)) <= @var(pointer, name))[0m
[K	[1;33m	[warning] did not find top-level for ('/data/vulnloc/libxml2/CVE-2016-1839/src/dict.c', 444, 0)[0m
[K	[1;33m	[warning] did not find top-level for ('/data/vulnloc/libxml2/CVE-2016-1839/src/dict.c', 444, 0)[0m
[K	[1;33m	[warning] did not find top-level for ('/data/vulnloc/libxml2/CVE-2016-1839/src/dict.c', 444, 0)[0m
[K	[1;33m	[warning] did not find top-level for ('/data/vulnloc/libxml2/CVE-2016-1839/src/dict.c', 444, 0)[0m
[K	[1;33m	[warning] did not find top-level for ('/data/vulnloc/libxml2/CVE-2016-1839/src/dict.c', 444, 0)[0m
[K[1;36m
		[fix-loc] /data/vulnloc/libxml2/CVE-2016-1839/src/dict.c:445:5
		------------------------------------------------------------------------------------------
[0m
[K	[1;37m	[0m[K     [1;37m[constraint] (@var(pointer, crepair_base(name)) <= @var(pointer, name))[0m
[K	[1;33m	[warning] did not find top-level for ('/data/vulnloc/libxml2/CVE-2016-1839/src/dict.c', 444, 0)[0m
[K	[1;33m	[warning] did not find top-level for ('/data/vulnloc/libxml2/CVE-2016-1839/src/dict.c', 829, 1)[0m
[K[1;36m
		[fix-loc] /data/vulnloc/libxml2/CVE-2016-1839/src/dict.c:836:5
		------------------------------------------------------------------------------------------
[0m
[K	[1;37m	[0m[K     [1;37m[constraint] (@var(pointer, crepair_base(name)) <= @var(pointer, name))[0m
[K[1;36m
		[fix-loc] /data/vulnloc/libxml2/CVE-2016-1839/src/dict.c:851:12
		------------------------------------------------------------------------------------------
[0m
[K	[1;37m	[0m[K     [1;37m[constraint] (@var(pointer, crepair_base(name)) <= @var(pointer, name))[0m
[K	[1;33m	[warning] did not find top-level for ('/data/vulnloc/libxml2/CVE-2016-1839/src/dict.c', 829, 1)[0m
[K[1;36m
		[fix-loc] /data/vulnloc/libxml2/CVE-2016-1839/src/dict.c:844:5
		------------------------------------------------------------------------------------------
[0m
[K	[1;37m	[0m[K     [1;37m[constraint] (@var(pointer, crepair_base(name)) <= @var(pointer, name))[0m
[K	[1;33m	[warning] did not find top-level for ('/data/vulnloc/libxml2/CVE-2016-1839/src/dict.c', 829, 1)[0m
[K	[1;33m	[warning] did not find top-level for ('/data/vulnloc/libxml2/CVE-2016-1839/src/dict.c', 829, 1)[0m
[K	[1;33m	[warning] did not find top-level for ('/data/vulnloc/libxml2/CVE-2016-1839/src/dict.c', 829, 1)[0m
[K	[1;33m	[warning] did not find top-level for ('/data/vulnloc/libxml2/CVE-2016-1839/src/dict.c', 829, 1)[0m
[K[1;36m
		[fix-loc] /data/vulnloc/libxml2/CVE-2016-1839/src/dict.c:842:9
		------------------------------------------------------------------------------------------
[0m
[K	[1;37m	[0m[K     [1;37m[constraint] (@var(pointer, crepair_base(name)) <= @var(pointer, name))[0m
[K	[1;33m	[warning] did not find top-level for ('/data/vulnloc/libxml2/CVE-2016-1839/src/dict.c', 829, 1)[0m
[K	[1;33m	[warning] did not find top-level for ('/data/vulnloc/libxml2/CVE-2016-1839/src/dict.c', 829, 1)[0m
[K[1;36m
		[fix-loc] /data/vulnloc/libxml2/CVE-2016-1839/src/dict.c:839:5
		------------------------------------------------------------------------------------------
[0m
[K	[1;37m	[0m[K     [1;37m[constraint] (@var(pointer, crepair_base(name)) <= @var(pointer, name))[0m
[K	[1;33m	[warning] did not find top-level for ('/data/vulnloc/libxml2/CVE-2016-1839/src/dict.c', 829, 1)[0m
[K	[1;33m	[warning] did not find top-level for ('/data/vulnloc/libxml2/CVE-2016-1839/src/dict.c', 829, 1)[0m
[K	[1;33m	[warning] did not find top-level for ('/data/vulnloc/libxml2/CVE-2016-1839/src/dict.c', 829, 1)[0m
[K	[1;33m	[warning] did not find top-level for ('/data/vulnloc/libxml2/CVE-2016-1839/src/dict.c', 829, 1)[0m
[K	[1;33m	[warning] did not find top-level for ('/data/vulnloc/libxml2/CVE-2016-1839/src/dict.c', 829, 1)[0m
[K	[1;33m	[warning] did not find top-level for ('/data/vulnloc/libxml2/CVE-2016-1839/src/dict.c', 829, 1)[0m
[K[1;36m
		[fix-loc] /data/vulnloc/libxml2/CVE-2016-1839/src/dict.c:830:5
		------------------------------------------------------------------------------------------
[0m
[K	[1;37m	[0m[K     [1;37m[constraint] (@var(pointer, crepair_base(name)) <= @var(pointer, name))[0m
[K[1;36m
		[fix-loc] /data/vulnloc/libxml2/CVE-2016-1839/src/HTMLparser.c:2517:12
		------------------------------------------------------------------------------------------
[0m
[K	[1;37m	[0m[K     [1;37m[constraint] (@var(pointer, crepair_base(ctxt->input->cur - len)) <= (@var(pointer,
                        ctxt->input->cur) - @var(pointer, len)))[0m
[K[1;32m
	localization information saved at /CrashRepair/output/libxml2_CVE-2016-1839/localization.json[0m
[K[1;32m
	state values saved at /CrashRepair/output/libxml2_CVE-2016-1839/values/[0m
[K	[1;37m
Run time statistics:
-----------------------
[0m
[K	[1;37mStartup: 0.000 minutes[0m
[K	[1;37mBuild: 0 minutes[0m
[K	[1;37mConcrete Analysis: 0.872 minutes[0m
[K	[1;37mConcolic Analysis: 20.948 minutes[0m
[K	[1;37mTotal Analysis: 22.095 minutes[0m
[K	[1;37mLocalization: 0.802 minutes[0m
[K[1;32m
CRepair finished successfully after 22.905 minutes 
[0m
2025-02-02 13:26:53.549 | WARNING  | analyzer:run:143 - analysis output directory does not exist [/data/vulnloc/libxml2/CVE-2016-1839/analysis]: creating...
2025-02-02 13:26:53.695 | INFO     | scenario:generate:454 - generating candidate repairs in implicated files: {'/data/vulnloc/libxml2/CVE-2016-1839/src/dict.c', '/data/vulnloc/libxml2/CVE-2016-1839/src/HTMLparser.c'}
total_candidates:[{'diff': '@@ -440,11 +440,12 @@\n  * Calculate a hash key using a fast hash function that works well\n  * for low hash table fill.\n  */\n+\n static unsigned long\n xmlDictComputeFastKey(const xmlChar *name, int namelen, int seed) {\n     unsigned long value = seed;\n \n-    if (name == NULL) return(0);\n+    if (name == NULL || namelen < 0) return(0);\n     value = *name;\n     value <<= 5;\n     if (namelen > 10) {\n@@ -452,20 +453,21 @@\n         namelen = 10;\n     }\n     switch (namelen) {\n-        case 10: value += name[9];\n-        case 9: value += name[8];\n-        case 8: value += name[7];\n-        case 7: value += name[6];\n-        case 6: value += name[5];\n-        case 5: value += name[4];\n-        case 4: value += name[3];\n-        case 3: value += name[2];\n-        case 2: value += name[1];\n+        case 10: value += name[9]; // fall through\n+        case 9: value += name[8];  // fall through\n+        case 8: value += name[7];  // fall through\n+        case 7: value += name[6];  // fall through\n+        case 6: value += name[5];  // fall through\n+        case 5: value += name[4];  // fall through\n+        case 4: value += name[3];  // fall through\n+        case 3: value += name[2];  // fall through\n+        case 2: value += name[1];  // fall through\n         default: break;\n     }\n     return(value);\n }\n \n+\n /*\n  * xmlDictComputeFastQKey:\n  *\n', 'id': 0, 'location': '/data/vulnloc/libxml2/CVE-2016-1839/src/dict.c:447:5'}, {'diff': '@@ -440,11 +440,12 @@\n  * Calculate a hash key using a fast hash function that works well\n  * for low hash table fill.\n  */\n+\n static unsigned long\n xmlDictComputeFastKey(const xmlChar *name, int namelen, int seed) {\n     unsigned long value = seed;\n \n-    if (name == NULL) return(0);\n+    if (name == NULL || namelen < 0) return(0);\n     value = *name;\n     value <<= 5;\n     if (namelen > 10) {\n@@ -466,6 +467,7 @@\n     return(value);\n }\n \n+\n /*\n  * xmlDictComputeFastQKey:\n  *\n', 'id': 1, 'location': '/data/vulnloc/libxml2/CVE-2016-1839/src/dict.c:447:5'}, {'diff': '@@ -440,11 +440,12 @@\n  * Calculate a hash key using a fast hash function that works well\n  * for low hash table fill.\n  */\n+\n static unsigned long\n xmlDictComputeFastKey(const xmlChar *name, int namelen, int seed) {\n     unsigned long value = seed;\n \n-    if (name == NULL) return(0);\n+    if (name == NULL || namelen < 0) return(0);\n     value = *name;\n     value <<= 5;\n     if (namelen > 10) {\n@@ -452,20 +453,21 @@\n         namelen = 10;\n     }\n     switch (namelen) {\n-        case 10: value += name[9];\n-        case 9: value += name[8];\n-        case 8: value += name[7];\n-        case 7: value += name[6];\n-        case 6: value += name[5];\n-        case 5: value += name[4];\n-        case 4: value += name[3];\n-        case 3: value += name[2];\n-        case 2: value += name[1];\n+        case 10: value += name[9]; // Fall-through intentional\n+        case 9: value += name[8];  // Fall-through intentional\n+        case 8: value += name[7];  // Fall-through intentional\n+        case 7: value += name[6];  // Fall-through intentional\n+        case 6: value += name[5];  // Fall-through intentional\n+        case 5: value += name[4];  // Fall-through intentional\n+        case 4: value += name[3];  // Fall-through intentional\n+        case 3: value += name[2];  // Fall-through intentional\n+        case 2: value += name[1];  // Fall-through intentional\n         default: break;\n     }\n     return(value);\n }\n \n+\n /*\n  * xmlDictComputeFastQKey:\n  *\n', 'id': 2, 'location': '/data/vulnloc/libxml2/CVE-2016-1839/src/dict.c:447:5'}, {'diff': '@@ -440,11 +440,12 @@\n  * Calculate a hash key using a fast hash function that works well\n  * for low hash table fill.\n  */\n+\n static unsigned long\n xmlDictComputeFastKey(const xmlChar *name, int namelen, int seed) {\n     unsigned long value = seed;\n \n-    if (name == NULL) return(0);\n+    if (name == NULL || namelen < 0) return(0); // Modified to check for negative namelen\n     value = *name;\n     value <<= 5;\n     if (namelen > 10) {\n@@ -452,20 +453,21 @@\n         namelen = 10;\n     }\n     switch (namelen) {\n-        case 10: value += name[9];\n-        case 9: value += name[8];\n-        case 8: value += name[7];\n-        case 7: value += name[6];\n-        case 6: value += name[5];\n-        case 5: value += name[4];\n-        case 4: value += name[3];\n-        case 3: value += name[2];\n-        case 2: value += name[1];\n+        case 10: value += name[9]; // Added break statement\n+        case 9:  value += name[8]; // Added break statement\n+        case 8:  value += name[7]; // Added break statement\n+        case 7:  value += name[6]; // Added break statement\n+        case 6:  value += name[5]; // Added break statement\n+        case 5:  value += name[4]; // Added break statement\n+        case 4:  value += name[3]; // Added break statement\n+        case 3:  value += name[2]; // Added break statement\n+        case 2:  value += name[1]; // Added break statement\n         default: break;\n     }\n     return(value);\n }\n \n+\n /*\n  * xmlDictComputeFastQKey:\n  *\n', 'id': 3, 'location': '/data/vulnloc/libxml2/CVE-2016-1839/src/dict.c:447:5'}, {'diff': '@@ -440,11 +440,12 @@\n  * Calculate a hash key using a fast hash function that works well\n  * for low hash table fill.\n  */\n+\n static unsigned long\n xmlDictComputeFastKey(const xmlChar *name, int namelen, int seed) {\n     unsigned long value = seed;\n \n-    if (name == NULL) return(0);\n+    if (name == NULL || namelen < 0) return(0);\n     value = *name;\n     value <<= 5;\n     if (namelen > 10) {\n@@ -452,20 +453,21 @@\n         namelen = 10;\n     }\n     switch (namelen) {\n-        case 10: value += name[9];\n-        case 9: value += name[8];\n-        case 8: value += name[7];\n-        case 7: value += name[6];\n-        case 6: value += name[5];\n-        case 5: value += name[4];\n-        case 4: value += name[3];\n-        case 3: value += name[2];\n-        case 2: value += name[1];\n+        case 10: value += name[9]; // Fallthrough intentional\n+        case 9: value += name[8]; // Fallthrough intentional\n+        case 8: value += name[7]; // Fallthrough intentional\n+        case 7: value += name[6]; // Fallthrough intentional\n+        case 6: value += name[5]; // Fallthrough intentional\n+        case 5: value += name[4]; // Fallthrough intentional\n+        case 4: value += name[3]; // Fallthrough intentional\n+        case 3: value += name[2]; // Fallthrough intentional\n+        case 2: value += name[1]; // Fallthrough intentional\n         default: break;\n     }\n     return(value);\n }\n \n+\n /*\n  * xmlDictComputeFastQKey:\n  *\n', 'id': 4, 'location': '/data/vulnloc/libxml2/CVE-2016-1839/src/dict.c:447:5'}, {'diff': '@@ -440,11 +440,12 @@\n  * Calculate a hash key using a fast hash function that works well\n  * for low hash table fill.\n  */\n+\n static unsigned long\n xmlDictComputeFastKey(const xmlChar *name, int namelen, int seed) {\n     unsigned long value = seed;\n \n-    if (name == NULL) return(0);\n+    if (name == NULL || namelen <= 0) return(0);\n     value = *name;\n     value <<= 5;\n     if (namelen > 10) {\n@@ -452,20 +453,21 @@\n         namelen = 10;\n     }\n     switch (namelen) {\n-        case 10: value += name[9];\n-        case 9: value += name[8];\n-        case 8: value += name[7];\n-        case 7: value += name[6];\n-        case 6: value += name[5];\n-        case 5: value += name[4];\n-        case 4: value += name[3];\n-        case 3: value += name[2];\n-        case 2: value += name[1];\n+        case 10: value += name[9]; // fall through\n+        case 9: value += name[8]; // fall through\n+        case 8: value += name[7]; // fall through\n+        case 7: value += name[6]; // fall through\n+        case 6: value += name[5]; // fall through\n+        case 5: value += name[4]; // fall through\n+        case 4: value += name[3]; // fall through\n+        case 3: value += name[2]; // fall through\n+        case 2: value += name[1]; // fall through\n         default: break;\n     }\n     return(value);\n }\n \n+\n /*\n  * xmlDictComputeFastQKey:\n  *\n', 'id': 5, 'location': '/data/vulnloc/libxml2/CVE-2016-1839/src/dict.c:448:5'}, {'diff': '@@ -440,11 +440,12 @@\n  * Calculate a hash key using a fast hash function that works well\n  * for low hash table fill.\n  */\n+\n static unsigned long\n xmlDictComputeFastKey(const xmlChar *name, int namelen, int seed) {\n     unsigned long value = seed;\n \n-    if (name == NULL) return(0);\n+    if (name == NULL || namelen <= 0) return(0);\n     value = *name;\n     value <<= 5;\n     if (namelen > 10) {\n@@ -466,6 +467,7 @@\n     return(value);\n }\n \n+\n /*\n  * xmlDictComputeFastQKey:\n  *\n', 'id': 6, 'location': '/data/vulnloc/libxml2/CVE-2016-1839/src/dict.c:448:5'}, {'diff': '@@ -440,11 +440,12 @@\n  * Calculate a hash key using a fast hash function that works well\n  * for low hash table fill.\n  */\n+\n static unsigned long\n xmlDictComputeFastKey(const xmlChar *name, int namelen, int seed) {\n     unsigned long value = seed;\n \n-    if (name == NULL) return(0);\n+    if (name == NULL || namelen < 1) return(0);\n     value = *name;\n     value <<= 5;\n     if (namelen > 10) {\n@@ -452,20 +453,21 @@\n         namelen = 10;\n     }\n     switch (namelen) {\n-        case 10: value += name[9];\n-        case 9: value += name[8];\n-        case 8: value += name[7];\n-        case 7: value += name[6];\n-        case 6: value += name[5];\n-        case 5: value += name[4];\n-        case 4: value += name[3];\n-        case 3: value += name[2];\n-        case 2: value += name[1];\n+        case 10: value += name[9]; \n+        case 9:  value += name[8]; \n+        case 8:  value += name[7]; \n+        case 7:  value += name[6]; \n+        case 6:  value += name[5]; \n+        case 5:  value += name[4]; \n+        case 4:  value += name[3]; \n+        case 3:  value += name[2]; \n+        case 2:  value += name[1]; \n         default: break;\n     }\n     return(value);\n }\n \n+\n /*\n  * xmlDictComputeFastQKey:\n  *\n', 'id': 7, 'location': '/data/vulnloc/libxml2/CVE-2016-1839/src/dict.c:448:5'}, {'diff': '@@ -440,11 +440,12 @@\n  * Calculate a hash key using a fast hash function that works well\n  * for low hash table fill.\n  */\n+\n static unsigned long\n xmlDictComputeFastKey(const xmlChar *name, int namelen, int seed) {\n     unsigned long value = seed;\n \n-    if (name == NULL) return(0);\n+    if (name == NULL || namelen <= 0) return(0);\n     value = *name;\n     value <<= 5;\n     if (namelen > 10) {\n@@ -452,20 +453,21 @@\n         namelen = 10;\n     }\n     switch (namelen) {\n-        case 10: value += name[9];\n-        case 9: value += name[8];\n-        case 8: value += name[7];\n-        case 7: value += name[6];\n-        case 6: value += name[5];\n-        case 5: value += name[4];\n-        case 4: value += name[3];\n-        case 3: value += name[2];\n-        case 2: value += name[1];\n+        case 10: value += name[9]; // fall through\n+        case 9: value += name[8]; // fall through\n+        case 8: value += name[7]; // fall through\n+        case 7: value += name[6]; // fall through\n+        case 6: value += name[5]; // fall through\n+        case 5: value += name[4]; // fall through\n+        case 4: value += name[3]; // fall through\n+        case 3: value += name[2]; // fall through\n+        case 2: value += name[1]; // fall through\n         default: break;\n     }\n     return(value);\n }\n \n+\n /*\n  * xmlDictComputeFastQKey:\n  *\n', 'id': 8, 'location': '/data/vulnloc/libxml2/CVE-2016-1839/src/dict.c:448:5'}, {'diff': '@@ -440,11 +440,12 @@\n  * Calculate a hash key using a fast hash function that works well\n  * for low hash table fill.\n  */\n+\n static unsigned long\n xmlDictComputeFastKey(const xmlChar *name, int namelen, int seed) {\n     unsigned long value = seed;\n \n-    if (name == NULL) return(0);\n+    if (name == NULL || namelen <= 0) return(0);\n     value = *name;\n     value <<= 5;\n     if (namelen > 10) {\n@@ -452,20 +453,21 @@\n         namelen = 10;\n     }\n     switch (namelen) {\n-        case 10: value += name[9];\n-        case 9: value += name[8];\n-        case 8: value += name[7];\n-        case 7: value += name[6];\n-        case 6: value += name[5];\n-        case 5: value += name[4];\n-        case 4: value += name[3];\n-        case 3: value += name[2];\n-        case 2: value += name[1];\n-        default: break;\n+        case 10: value += name[9]; \n+        case 9: value += name[8]; \n+        case 8: value += name[7]; \n+        case 7: value += name[6]; \n+        case 6: value += name[5]; \n+        case 5: value += name[4]; \n+        case 4: value += name[3]; \n+        case 3: value += name[2]; \n+        case 2: value += name[1]; \n+        default: break; \n     }\n     return(value);\n }\n \n+\n /*\n  * xmlDictComputeFastQKey:\n  *\n', 'id': 9, 'location': '/data/vulnloc/libxml2/CVE-2016-1839/src/dict.c:448:5'}, {'diff': '@@ -440,11 +440,12 @@\n  * Calculate a hash key using a fast hash function that works well\n  * for low hash table fill.\n  */\n+\n static unsigned long\n xmlDictComputeFastKey(const xmlChar *name, int namelen, int seed) {\n     unsigned long value = seed;\n \n-    if (name == NULL) return(0);\n+    if (name == NULL || namelen <= 0) return(0); // Added check for namelen\n     value = *name;\n     value <<= 5;\n     if (namelen > 10) {\n@@ -452,20 +453,21 @@\n         namelen = 10;\n     }\n     switch (namelen) {\n-        case 10: value += name[9];\n-        case 9: value += name[8];\n-        case 8: value += name[7];\n-        case 7: value += name[6];\n-        case 6: value += name[5];\n-        case 5: value += name[4];\n-        case 4: value += name[3];\n-        case 3: value += name[2];\n-        case 2: value += name[1];\n+        case 10: value += name[9]; // Added break; \n+        case 9:  value += name[8]; // Added break; \n+        case 8:  value += name[7]; // Added break; \n+        case 7:  value += name[6]; // Added break; \n+        case 6:  value += name[5]; // Added break; \n+        case 5:  value += name[4]; // Added break; \n+        case 4:  value += name[3]; // Added break; \n+        case 3:  value += name[2]; // Added break; \n+        case 2:  value += name[1]; // Added break; \n         default: break;\n     }\n     return(value);\n }\n \n+\n /*\n  * xmlDictComputeFastQKey:\n  *\n', 'id': 10, 'location': '/data/vulnloc/libxml2/CVE-2016-1839/src/dict.c:445:5'}, {'diff': '@@ -440,11 +440,13 @@\n  * Calculate a hash key using a fast hash function that works well\n  * for low hash table fill.\n  */\n+\n static unsigned long\n xmlDictComputeFastKey(const xmlChar *name, int namelen, int seed) {\n     unsigned long value = seed;\n \n     if (name == NULL) return(0);\n+    if (namelen < 0) return(0); // Added check for negative length\n     value = *name;\n     value <<= 5;\n     if (namelen > 10) {\n@@ -466,6 +468,7 @@\n     return(value);\n }\n \n+\n /*\n  * xmlDictComputeFastQKey:\n  *\n', 'id': 11, 'location': '/data/vulnloc/libxml2/CVE-2016-1839/src/dict.c:445:5'}, {'diff': '@@ -440,11 +440,12 @@\n  * Calculate a hash key using a fast hash function that works well\n  * for low hash table fill.\n  */\n+\n static unsigned long\n xmlDictComputeFastKey(const xmlChar *name, int namelen, int seed) {\n     unsigned long value = seed;\n \n-    if (name == NULL) return(0);\n+    if (name == NULL || namelen < 1) return(0);\n     value = *name;\n     value <<= 5;\n     if (namelen > 10) {\n@@ -452,20 +453,21 @@\n         namelen = 10;\n     }\n     switch (namelen) {\n-        case 10: value += name[9];\n-        case 9: value += name[8];\n-        case 8: value += name[7];\n-        case 7: value += name[6];\n-        case 6: value += name[5];\n-        case 5: value += name[4];\n-        case 4: value += name[3];\n-        case 3: value += name[2];\n-        case 2: value += name[1];\n+        case 10: value += name[9]; // fall through\n+        case 9:  value += name[8]; // fall through\n+        case 8:  value += name[7]; // fall through\n+        case 7:  value += name[6]; // fall through\n+        case 6:  value += name[5]; // fall through\n+        case 5:  value += name[4]; // fall through\n+        case 4:  value += name[3]; // fall through\n+        case 3:  value += name[2]; // fall through\n+        case 2:  value += name[1]; // fall through\n         default: break;\n     }\n     return(value);\n }\n \n+\n /*\n  * xmlDictComputeFastQKey:\n  *\n', 'id': 12, 'location': '/data/vulnloc/libxml2/CVE-2016-1839/src/dict.c:445:5'}, {'diff': '@@ -440,11 +440,12 @@\n  * Calculate a hash key using a fast hash function that works well\n  * for low hash table fill.\n  */\n+\n static unsigned long\n xmlDictComputeFastKey(const xmlChar *name, int namelen, int seed) {\n     unsigned long value = seed;\n \n-    if (name == NULL) return(0);\n+    if (name == NULL || namelen <= 0) return(0);\n     value = *name;\n     value <<= 5;\n     if (namelen > 10) {\n@@ -466,6 +467,7 @@\n     return(value);\n }\n \n+\n /*\n  * xmlDictComputeFastQKey:\n  *\n', 'id': 13, 'location': '/data/vulnloc/libxml2/CVE-2016-1839/src/dict.c:445:5'}, {'diff': '@@ -440,11 +440,12 @@\n  * Calculate a hash key using a fast hash function that works well\n  * for low hash table fill.\n  */\n+\n static unsigned long\n xmlDictComputeFastKey(const xmlChar *name, int namelen, int seed) {\n     unsigned long value = seed;\n \n-    if (name == NULL) return(0);\n+    if (name == NULL || namelen < 0) return(0);\n     value = *name;\n     value <<= 5;\n     if (namelen > 10) {\n@@ -452,20 +453,21 @@\n         namelen = 10;\n     }\n     switch (namelen) {\n-        case 10: value += name[9];\n-        case 9: value += name[8];\n-        case 8: value += name[7];\n-        case 7: value += name[6];\n-        case 6: value += name[5];\n-        case 5: value += name[4];\n-        case 4: value += name[3];\n-        case 3: value += name[2];\n-        case 2: value += name[1];\n+        case 10: value += name[9]; // fall through\n+        case 9: value += name[8]; // fall through\n+        case 8: value += name[7]; // fall through\n+        case 7: value += name[6]; // fall through\n+        case 6: value += name[5]; // fall through\n+        case 5: value += name[4]; // fall through\n+        case 4: value += name[3]; // fall through\n+        case 3: value += name[2]; // fall through\n+        case 2: value += name[1]; // fall through\n         default: break;\n     }\n     return(value);\n }\n \n+\n /*\n  * xmlDictComputeFastQKey:\n  *\n', 'id': 14, 'location': '/data/vulnloc/libxml2/CVE-2016-1839/src/dict.c:445:5'}, {'diff': '@@ -825,6 +825,7 @@\n  *\n  * Returns the internal copy of the name or NULL in case of internal error\n  */\n+\n const xmlChar *\n xmlDictLookup(xmlDictPtr dict, const xmlChar *name, int len) {\n     unsigned long key, okey, nbi = 0;\n@@ -833,8 +834,8 @@\n     const xmlChar *ret;\n     unsigned int l;\n \n-    if ((dict == NULL) || (name == NULL))\n-\treturn(NULL);\n+    if ((dict == NULL) || (name == NULL) || (len < 0)) \n+        return(NULL);\n \n     if (len < 0)\n         l = strlen((const char *) name);\n@@ -851,31 +852,31 @@\n     okey = xmlDictComputeKey(dict, name, l);\n     key = okey % dict->size;\n     if (dict->dict[key].valid == 0) {\n-\tinsert = NULL;\n+        insert = NULL;\n     } else {\n-\tfor (insert = &(dict->dict[key]); insert->next != NULL;\n-\t     insert = insert->next) {\n+        for (insert = &(dict->dict[key]); insert->next != NULL;\n+             insert = insert->next) {\n #ifdef __GNUC__\n-\t    if ((insert->okey == okey) && (insert->len == l)) {\n-\t\tif (!memcmp(insert->name, name, l))\n-\t\t    return(insert->name);\n-\t    }\n+            if ((insert->okey == okey) && (insert->len == l)) {\n+                if (!memcmp(insert->name, name, l))\n+                    return(insert->name);\n+            }\n #else\n-\t    if ((insert->okey == okey) && (insert->len == l) &&\n-\t        (!xmlStrncmp(insert->name, name, l)))\n-\t\treturn(insert->name);\n+            if ((insert->okey == okey) && (insert->len == l) &&\n+                (!xmlStrncmp(insert->name, name, l)))\n+                return(insert->name);\n #endif\n-\t    nbi++;\n-\t}\n+            nbi++;\n+        }\n #ifdef __GNUC__\n-\tif ((insert->okey == okey) && (insert->len == l)) {\n-\t    if (!memcmp(insert->name, name, l))\n-\t\treturn(insert->name);\n-\t}\n+        if ((insert->okey == okey) && (insert->len == l)) {\n+            if (!memcmp(insert->name, name, l))\n+                return(insert->name);\n+        }\n #else\n-\tif ((insert->okey == okey) && (insert->len == l) &&\n-\t    (!xmlStrncmp(insert->name, name, l)))\n-\t    return(insert->name);\n+        if ((insert->okey == okey) && (insert->len == l) &&\n+            (!xmlStrncmp(insert->name, name, l)))\n+            return(insert->name);\n #endif\n     }\n \n@@ -884,54 +885,54 @@\n \n         /* we cannot always reuse the same okey for the subdict */\n         if (((dict->size == MIN_DICT_SIZE) &&\n-\t     (dict->subdict->size != MIN_DICT_SIZE)) ||\n+             (dict->subdict->size != MIN_DICT_SIZE)) ||\n             ((dict->size != MIN_DICT_SIZE) &&\n-\t     (dict->subdict->size == MIN_DICT_SIZE)))\n-\t    skey = xmlDictComputeKey(dict->subdict, name, l);\n-\telse\n-\t    skey = okey;\n-\n-\tkey = skey % dict->subdict->size;\n-\tif (dict->subdict->dict[key].valid != 0) {\n-\t    xmlDictEntryPtr tmp;\n+             (dict->subdict->size == MIN_DICT_SIZE)))\n+            skey = xmlDictComputeKey(dict->subdict, name, l);\n+        else\n+            skey = okey;\n+\n+        key = skey % dict->subdict->size;\n+        if (dict->subdict->dict[key].valid != 0) {\n+            xmlDictEntryPtr tmp;\n \n-\t    for (tmp = &(dict->subdict->dict[key]); tmp->next != NULL;\n-\t\t tmp = tmp->next) {\n+            for (tmp = &(dict->subdict->dict[key]); tmp->next != NULL;\n+                 tmp = tmp->next) {\n #ifdef __GNUC__\n-\t\tif ((tmp->okey == skey) && (tmp->len == l)) {\n-\t\t    if (!memcmp(tmp->name, name, l))\n-\t\t\treturn(tmp->name);\n-\t\t}\n+                if ((tmp->okey == skey) && (tmp->len == l)) {\n+                    if (!memcmp(tmp->name, name, l))\n+                        return(tmp->name);\n+                }\n #else\n-\t\tif ((tmp->okey == skey) && (tmp->len == l) &&\n-\t\t    (!xmlStrncmp(tmp->name, name, l)))\n-\t\t    return(tmp->name);\n+                if ((tmp->okey == skey) && (tmp->len == l) &&\n+                    (!xmlStrncmp(tmp->name, name, l)))\n+                    return(tmp->name);\n #endif\n-\t\tnbi++;\n-\t    }\n+                nbi++;\n+            }\n #ifdef __GNUC__\n-\t    if ((tmp->okey == skey) && (tmp->len == l)) {\n-\t\tif (!memcmp(tmp->name, name, l))\n-\t\t    return(tmp->name);\n-\t    }\n+            if ((tmp->okey == skey) && (tmp->len == l)) {\n+                if (!memcmp(tmp->name, name, l))\n+                    return(tmp->name);\n+            }\n #else\n-\t    if ((tmp->okey == skey) && (tmp->len == l) &&\n-\t\t(!xmlStrncmp(tmp->name, name, l)))\n-\t\treturn(tmp->name);\n+            if ((tmp->okey == skey) && (tmp->len == l) &&\n+                (!xmlStrncmp(tmp->name, name, l)))\n+                return(tmp->name);\n #endif\n-\t}\n-\tkey = okey % dict->size;\n+        }\n+        key = okey % dict->size;\n     }\n \n     ret = xmlDictAddString(dict, name, l);\n     if (ret == NULL)\n         return(NULL);\n     if (insert == NULL) {\n-\tentry = &(dict->dict[key]);\n+        entry = &(dict->dict[key]);\n     } else {\n-\tentry = xmlMalloc(sizeof(xmlDictEntry));\n-\tif (entry == NULL)\n-\t     return(NULL);\n+        entry = xmlMalloc(sizeof(xmlDictEntry));\n+        if (entry == NULL)\n+            return(NULL);\n     }\n     entry->name = ret;\n     entry->len = l;\n@@ -939,22 +940,22 @@\n     entry->valid = 1;\n     entry->okey = okey;\n \n-\n     if (insert != NULL)\n-\tinsert->next = entry;\n+        insert->next = entry;\n \n     dict->nbElems++;\n \n     if ((nbi > MAX_HASH_LEN) &&\n         (dict->size <= ((MAX_DICT_HASH / 2) / MAX_HASH_LEN))) {\n-\tif (xmlDictGrow(dict, MAX_HASH_LEN * 2 * dict->size) != 0)\n-\t    return(NULL);\n+        if (xmlDictGrow(dict, MAX_HASH_LEN * 2 * dict->size) != 0)\n+            return(NULL);\n     }\n     /* Note that entry may have been freed at this point by xmlDictGrow */\n \n     return(ret);\n }\n \n+\n /**\n  * xmlDictExists:\n  * @dict: the dictionary\n', 'id': 15, 'location': '/data/vulnloc/libxml2/CVE-2016-1839/src/dict.c:836:5'}, {'diff': '@@ -825,6 +825,7 @@\n  *\n  * Returns the internal copy of the name or NULL in case of internal error\n  */\n+\n const xmlChar *\n xmlDictLookup(xmlDictPtr dict, const xmlChar *name, int len) {\n     unsigned long key, okey, nbi = 0;\n@@ -833,8 +834,15 @@\n     const xmlChar *ret;\n     unsigned int l;\n \n-    if ((dict == NULL) || (name == NULL))\n-\treturn(NULL);\n+    if (dict == NULL) {\n+        // Handle NULL dict case\n+        return(NULL);\n+    }\n+\n+    if (name == NULL) {\n+        // Handle NULL name case\n+        return(NULL);\n+    }\n \n     if (len < 0)\n         l = strlen((const char *) name);\n@@ -851,31 +859,31 @@\n     okey = xmlDictComputeKey(dict, name, l);\n     key = okey % dict->size;\n     if (dict->dict[key].valid == 0) {\n-\tinsert = NULL;\n+        insert = NULL;\n     } else {\n-\tfor (insert = &(dict->dict[key]); insert->next != NULL;\n-\t     insert = insert->next) {\n+        for (insert = &(dict->dict[key]); insert->next != NULL;\n+             insert = insert->next) {\n #ifdef __GNUC__\n-\t    if ((insert->okey == okey) && (insert->len == l)) {\n-\t\tif (!memcmp(insert->name, name, l))\n-\t\t    return(insert->name);\n-\t    }\n+            if ((insert->okey == okey) && (insert->len == l)) {\n+                if (!memcmp(insert->name, name, l))\n+                    return(insert->name);\n+            }\n #else\n-\t    if ((insert->okey == okey) && (insert->len == l) &&\n-\t        (!xmlStrncmp(insert->name, name, l)))\n-\t\treturn(insert->name);\n+            if ((insert->okey == okey) && (insert->len == l) &&\n+                (!xmlStrncmp(insert->name, name, l)))\n+                return(insert->name);\n #endif\n-\t    nbi++;\n-\t}\n+            nbi++;\n+        }\n #ifdef __GNUC__\n-\tif ((insert->okey == okey) && (insert->len == l)) {\n-\t    if (!memcmp(insert->name, name, l))\n-\t\treturn(insert->name);\n-\t}\n+        if ((insert->okey == okey) && (insert->len == l)) {\n+            if (!memcmp(insert->name, name, l))\n+                return(insert->name);\n+        }\n #else\n-\tif ((insert->okey == okey) && (insert->len == l) &&\n-\t    (!xmlStrncmp(insert->name, name, l)))\n-\t    return(insert->name);\n+        if ((insert->okey == okey) && (insert->len == l) &&\n+            (!xmlStrncmp(insert->name, name, l)))\n+            return(insert->name);\n #endif\n     }\n \n@@ -884,54 +892,54 @@\n \n         /* we cannot always reuse the same okey for the subdict */\n         if (((dict->size == MIN_DICT_SIZE) &&\n-\t     (dict->subdict->size != MIN_DICT_SIZE)) ||\n+             (dict->subdict->size != MIN_DICT_SIZE)) ||\n             ((dict->size != MIN_DICT_SIZE) &&\n-\t     (dict->subdict->size == MIN_DICT_SIZE)))\n-\t    skey = xmlDictComputeKey(dict->subdict, name, l);\n-\telse\n-\t    skey = okey;\n-\n-\tkey = skey % dict->subdict->size;\n-\tif (dict->subdict->dict[key].valid != 0) {\n-\t    xmlDictEntryPtr tmp;\n+             (dict->subdict->size == MIN_DICT_SIZE)))\n+            skey = xmlDictComputeKey(dict->subdict, name, l);\n+        else\n+            skey = okey;\n+\n+        key = skey % dict->subdict->size;\n+        if (dict->subdict->dict[key].valid != 0) {\n+            xmlDictEntryPtr tmp;\n \n-\t    for (tmp = &(dict->subdict->dict[key]); tmp->next != NULL;\n-\t\t tmp = tmp->next) {\n+            for (tmp = &(dict->subdict->dict[key]); tmp->next != NULL;\n+                 tmp = tmp->next) {\n #ifdef __GNUC__\n-\t\tif ((tmp->okey == skey) && (tmp->len == l)) {\n-\t\t    if (!memcmp(tmp->name, name, l))\n-\t\t\treturn(tmp->name);\n-\t\t}\n+                if ((tmp->okey == skey) && (tmp->len == l)) {\n+                    if (!memcmp(tmp->name, name, l))\n+                        return(tmp->name);\n+                }\n #else\n-\t\tif ((tmp->okey == skey) && (tmp->len == l) &&\n-\t\t    (!xmlStrncmp(tmp->name, name, l)))\n-\t\t    return(tmp->name);\n+                if ((tmp->okey == skey) && (tmp->len == l) &&\n+                    (!xmlStrncmp(tmp->name, name, l)))\n+                    return(tmp->name);\n #endif\n-\t\tnbi++;\n-\t    }\n+                nbi++;\n+            }\n #ifdef __GNUC__\n-\t    if ((tmp->okey == skey) && (tmp->len == l)) {\n-\t\tif (!memcmp(tmp->name, name, l))\n-\t\t    return(tmp->name);\n-\t    }\n+            if ((tmp->okey == skey) && (tmp->len == l)) {\n+                if (!memcmp(tmp->name, name, l))\n+                    return(tmp->name);\n+            }\n #else\n-\t    if ((tmp->okey == skey) && (tmp->len == l) &&\n-\t\t(!xmlStrncmp(tmp->name, name, l)))\n-\t\treturn(tmp->name);\n+            if ((tmp->okey == skey) && (tmp->len == l) &&\n+                (!xmlStrncmp(tmp->name, name, l)))\n+                return(tmp->name);\n #endif\n-\t}\n-\tkey = okey % dict->size;\n+        }\n+        key = okey % dict->size;\n     }\n \n     ret = xmlDictAddString(dict, name, l);\n     if (ret == NULL)\n         return(NULL);\n     if (insert == NULL) {\n-\tentry = &(dict->dict[key]);\n+        entry = &(dict->dict[key]);\n     } else {\n-\tentry = xmlMalloc(sizeof(xmlDictEntry));\n-\tif (entry == NULL)\n-\t     return(NULL);\n+        entry = xmlMalloc(sizeof(xmlDictEntry));\n+        if (entry == NULL)\n+            return(NULL);\n     }\n     entry->name = ret;\n     entry->len = l;\n@@ -941,20 +949,21 @@\n \n \n     if (insert != NULL)\n-\tinsert->next = entry;\n+        insert->next = entry;\n \n     dict->nbElems++;\n \n     if ((nbi > MAX_HASH_LEN) &&\n         (dict->size <= ((MAX_DICT_HASH / 2) / MAX_HASH_LEN))) {\n-\tif (xmlDictGrow(dict, MAX_HASH_LEN * 2 * dict->size) != 0)\n-\t    return(NULL);\n+        if (xmlDictGrow(dict, MAX_HASH_LEN * 2 * dict->size) != 0)\n+            return(NULL);\n     }\n     /* Note that entry may have been freed at this point by xmlDictGrow */\n \n     return(ret);\n }\n \n+\n /**\n  * xmlDictExists:\n  * @dict: the dictionary\n', 'id': 16, 'location': '/data/vulnloc/libxml2/CVE-2016-1839/src/dict.c:836:5'}, {'diff': '@@ -825,6 +825,7 @@\n  *\n  * Returns the internal copy of the name or NULL in case of internal error\n  */\n+\n const xmlChar *\n xmlDictLookup(xmlDictPtr dict, const xmlChar *name, int len) {\n     unsigned long key, okey, nbi = 0;\n@@ -833,8 +834,10 @@\n     const xmlChar *ret;\n     unsigned int l;\n \n-    if ((dict == NULL) || (name == NULL))\n-\treturn(NULL);\n+    if (dict == NULL)\n+        return(NULL);\n+    if (name == NULL)\n+        return(NULL);\n \n     if (len < 0)\n         l = strlen((const char *) name);\n@@ -851,31 +854,31 @@\n     okey = xmlDictComputeKey(dict, name, l);\n     key = okey % dict->size;\n     if (dict->dict[key].valid == 0) {\n-\tinsert = NULL;\n+        insert = NULL;\n     } else {\n-\tfor (insert = &(dict->dict[key]); insert->next != NULL;\n-\t     insert = insert->next) {\n+        for (insert = &(dict->dict[key]); insert->next != NULL;\n+             insert = insert->next) {\n #ifdef __GNUC__\n-\t    if ((insert->okey == okey) && (insert->len == l)) {\n-\t\tif (!memcmp(insert->name, name, l))\n-\t\t    return(insert->name);\n-\t    }\n+            if ((insert->okey == okey) && (insert->len == l)) {\n+                if (!memcmp(insert->name, name, l))\n+                    return(insert->name);\n+            }\n #else\n-\t    if ((insert->okey == okey) && (insert->len == l) &&\n-\t        (!xmlStrncmp(insert->name, name, l)))\n-\t\treturn(insert->name);\n+            if ((insert->okey == okey) && (insert->len == l) &&\n+                (!xmlStrncmp(insert->name, name, l)))\n+                return(insert->name);\n #endif\n-\t    nbi++;\n-\t}\n+            nbi++;\n+        }\n #ifdef __GNUC__\n-\tif ((insert->okey == okey) && (insert->len == l)) {\n-\t    if (!memcmp(insert->name, name, l))\n-\t\treturn(insert->name);\n-\t}\n+        if ((insert->okey == okey) && (insert->len == l)) {\n+            if (!memcmp(insert->name, name, l))\n+                return(insert->name);\n+        }\n #else\n-\tif ((insert->okey == okey) && (insert->len == l) &&\n-\t    (!xmlStrncmp(insert->name, name, l)))\n-\t    return(insert->name);\n+        if ((insert->okey == okey) && (insert->len == l) &&\n+            (!xmlStrncmp(insert->name, name, l)))\n+            return(insert->name);\n #endif\n     }\n \n@@ -884,54 +887,54 @@\n \n         /* we cannot always reuse the same okey for the subdict */\n         if (((dict->size == MIN_DICT_SIZE) &&\n-\t     (dict->subdict->size != MIN_DICT_SIZE)) ||\n+             (dict->subdict->size != MIN_DICT_SIZE)) ||\n             ((dict->size != MIN_DICT_SIZE) &&\n-\t     (dict->subdict->size == MIN_DICT_SIZE)))\n-\t    skey = xmlDictComputeKey(dict->subdict, name, l);\n-\telse\n-\t    skey = okey;\n-\n-\tkey = skey % dict->subdict->size;\n-\tif (dict->subdict->dict[key].valid != 0) {\n-\t    xmlDictEntryPtr tmp;\n+             (dict->subdict->size == MIN_DICT_SIZE)))\n+            skey = xmlDictComputeKey(dict->subdict, name, l);\n+        else\n+            skey = okey;\n+\n+        key = skey % dict->subdict->size;\n+        if (dict->subdict->dict[key].valid != 0) {\n+            xmlDictEntryPtr tmp;\n \n-\t    for (tmp = &(dict->subdict->dict[key]); tmp->next != NULL;\n-\t\t tmp = tmp->next) {\n+            for (tmp = &(dict->subdict->dict[key]); tmp->next != NULL;\n+                 tmp = tmp->next) {\n #ifdef __GNUC__\n-\t\tif ((tmp->okey == skey) && (tmp->len == l)) {\n-\t\t    if (!memcmp(tmp->name, name, l))\n-\t\t\treturn(tmp->name);\n-\t\t}\n+                if ((tmp->okey == skey) && (tmp->len == l)) {\n+                    if (!memcmp(tmp->name, name, l))\n+                        return(tmp->name);\n+                }\n #else\n-\t\tif ((tmp->okey == skey) && (tmp->len == l) &&\n-\t\t    (!xmlStrncmp(tmp->name, name, l)))\n-\t\t    return(tmp->name);\n+                if ((tmp->okey == skey) && (tmp->len == l) &&\n+                    (!xmlStrncmp(tmp->name, name, l)))\n+                    return(tmp->name);\n #endif\n-\t\tnbi++;\n-\t    }\n+                nbi++;\n+            }\n #ifdef __GNUC__\n-\t    if ((tmp->okey == skey) && (tmp->len == l)) {\n-\t\tif (!memcmp(tmp->name, name, l))\n-\t\t    return(tmp->name);\n-\t    }\n+            if ((tmp->okey == skey) && (tmp->len == l)) {\n+                if (!memcmp(tmp->name, name, l))\n+                    return(tmp->name);\n+            }\n #else\n-\t    if ((tmp->okey == skey) && (tmp->len == l) &&\n-\t\t(!xmlStrncmp(tmp->name, name, l)))\n-\t\treturn(tmp->name);\n+            if ((tmp->okey == skey) && (tmp->len == l) &&\n+                (!xmlStrncmp(tmp->name, name, l)))\n+                return(tmp->name);\n #endif\n-\t}\n-\tkey = okey % dict->size;\n+        }\n+        key = okey % dict->size;\n     }\n \n     ret = xmlDictAddString(dict, name, l);\n     if (ret == NULL)\n         return(NULL);\n     if (insert == NULL) {\n-\tentry = &(dict->dict[key]);\n+        entry = &(dict->dict[key]);\n     } else {\n-\tentry = xmlMalloc(sizeof(xmlDictEntry));\n-\tif (entry == NULL)\n-\t     return(NULL);\n+        entry = xmlMalloc(sizeof(xmlDictEntry));\n+        if (entry == NULL)\n+            return(NULL);\n     }\n     entry->name = ret;\n     entry->len = l;\n@@ -941,20 +944,21 @@\n \n \n     if (insert != NULL)\n-\tinsert->next = entry;\n+        insert->next = entry;\n \n     dict->nbElems++;\n \n     if ((nbi > MAX_HASH_LEN) &&\n         (dict->size <= ((MAX_DICT_HASH / 2) / MAX_HASH_LEN))) {\n-\tif (xmlDictGrow(dict, MAX_HASH_LEN * 2 * dict->size) != 0)\n-\t    return(NULL);\n+        if (xmlDictGrow(dict, MAX_HASH_LEN * 2 * dict->size) != 0)\n+            return(NULL);\n     }\n     /* Note that entry may have been freed at this point by xmlDictGrow */\n \n     return(ret);\n }\n \n+\n /**\n  * xmlDictExists:\n  * @dict: the dictionary\n', 'id': 17, 'location': '/data/vulnloc/libxml2/CVE-2016-1839/src/dict.c:836:5'}, {'diff': '@@ -825,6 +825,7 @@\n  *\n  * Returns the internal copy of the name or NULL in case of internal error\n  */\n+\n const xmlChar *\n xmlDictLookup(xmlDictPtr dict, const xmlChar *name, int len) {\n     unsigned long key, okey, nbi = 0;\n@@ -833,8 +834,8 @@\n     const xmlChar *ret;\n     unsigned int l;\n \n-    if ((dict == NULL) || (name == NULL))\n-\treturn(NULL);\n+    if ((dict == NULL) || (name == NULL) || (len < 0))\n+        return(NULL);\n \n     if (len < 0)\n         l = strlen((const char *) name);\n@@ -851,31 +852,31 @@\n     okey = xmlDictComputeKey(dict, name, l);\n     key = okey % dict->size;\n     if (dict->dict[key].valid == 0) {\n-\tinsert = NULL;\n+        insert = NULL;\n     } else {\n-\tfor (insert = &(dict->dict[key]); insert->next != NULL;\n-\t     insert = insert->next) {\n+        for (insert = &(dict->dict[key]); insert->next != NULL;\n+             insert = insert->next) {\n #ifdef __GNUC__\n-\t    if ((insert->okey == okey) && (insert->len == l)) {\n-\t\tif (!memcmp(insert->name, name, l))\n-\t\t    return(insert->name);\n-\t    }\n+            if ((insert->okey == okey) && (insert->len == l)) {\n+                if (!memcmp(insert->name, name, l))\n+                    return(insert->name);\n+            }\n #else\n-\t    if ((insert->okey == okey) && (insert->len == l) &&\n-\t        (!xmlStrncmp(insert->name, name, l)))\n-\t\treturn(insert->name);\n+            if ((insert->okey == okey) && (insert->len == l) &&\n+                (!xmlStrncmp(insert->name, name, l)))\n+                return(insert->name);\n #endif\n-\t    nbi++;\n-\t}\n+            nbi++;\n+        }\n #ifdef __GNUC__\n-\tif ((insert->okey == okey) && (insert->len == l)) {\n-\t    if (!memcmp(insert->name, name, l))\n-\t\treturn(insert->name);\n-\t}\n+        if ((insert->okey == okey) && (insert->len == l)) {\n+            if (!memcmp(insert->name, name, l))\n+                return(insert->name);\n+        }\n #else\n-\tif ((insert->okey == okey) && (insert->len == l) &&\n-\t    (!xmlStrncmp(insert->name, name, l)))\n-\t    return(insert->name);\n+        if ((insert->okey == okey) && (insert->len == l) &&\n+            (!xmlStrncmp(insert->name, name, l)))\n+            return(insert->name);\n #endif\n     }\n \n@@ -884,54 +885,54 @@\n \n         /* we cannot always reuse the same okey for the subdict */\n         if (((dict->size == MIN_DICT_SIZE) &&\n-\t     (dict->subdict->size != MIN_DICT_SIZE)) ||\n+             (dict->subdict->size != MIN_DICT_SIZE)) ||\n             ((dict->size != MIN_DICT_SIZE) &&\n-\t     (dict->subdict->size == MIN_DICT_SIZE)))\n-\t    skey = xmlDictComputeKey(dict->subdict, name, l);\n-\telse\n-\t    skey = okey;\n-\n-\tkey = skey % dict->subdict->size;\n-\tif (dict->subdict->dict[key].valid != 0) {\n-\t    xmlDictEntryPtr tmp;\n+             (dict->subdict->size == MIN_DICT_SIZE)))\n+            skey = xmlDictComputeKey(dict->subdict, name, l);\n+        else\n+            skey = okey;\n+\n+        key = skey % dict->subdict->size;\n+        if (dict->subdict->dict[key].valid != 0) {\n+            xmlDictEntryPtr tmp;\n \n-\t    for (tmp = &(dict->subdict->dict[key]); tmp->next != NULL;\n-\t\t tmp = tmp->next) {\n+            for (tmp = &(dict->subdict->dict[key]); tmp->next != NULL;\n+                 tmp = tmp->next) {\n #ifdef __GNUC__\n-\t\tif ((tmp->okey == skey) && (tmp->len == l)) {\n-\t\t    if (!memcmp(tmp->name, name, l))\n-\t\t\treturn(tmp->name);\n-\t\t}\n+                if ((tmp->okey == skey) && (tmp->len == l)) {\n+                    if (!memcmp(tmp->name, name, l))\n+                        return(tmp->name);\n+                }\n #else\n-\t\tif ((tmp->okey == skey) && (tmp->len == l) &&\n-\t\t    (!xmlStrncmp(tmp->name, name, l)))\n-\t\t    return(tmp->name);\n+                if ((tmp->okey == skey) && (tmp->len == l) &&\n+                    (!xmlStrncmp(tmp->name, name, l)))\n+                    return(tmp->name);\n #endif\n-\t\tnbi++;\n-\t    }\n+                nbi++;\n+            }\n #ifdef __GNUC__\n-\t    if ((tmp->okey == skey) && (tmp->len == l)) {\n-\t\tif (!memcmp(tmp->name, name, l))\n-\t\t    return(tmp->name);\n-\t    }\n+            if ((tmp->okey == skey) && (tmp->len == l)) {\n+                if (!memcmp(tmp->name, name, l))\n+                    return(tmp->name);\n+            }\n #else\n-\t    if ((tmp->okey == skey) && (tmp->len == l) &&\n-\t\t(!xmlStrncmp(tmp->name, name, l)))\n-\t\treturn(tmp->name);\n+            if ((tmp->okey == skey) && (tmp->len == l) &&\n+                (!xmlStrncmp(tmp->name, name, l)))\n+                return(tmp->name);\n #endif\n-\t}\n-\tkey = okey % dict->size;\n+        }\n+        key = okey % dict->size;\n     }\n \n     ret = xmlDictAddString(dict, name, l);\n     if (ret == NULL)\n         return(NULL);\n     if (insert == NULL) {\n-\tentry = &(dict->dict[key]);\n+        entry = &(dict->dict[key]);\n     } else {\n-\tentry = xmlMalloc(sizeof(xmlDictEntry));\n-\tif (entry == NULL)\n-\t     return(NULL);\n+        entry = xmlMalloc(sizeof(xmlDictEntry));\n+        if (entry == NULL)\n+            return(NULL);\n     }\n     entry->name = ret;\n     entry->len = l;\n@@ -939,22 +940,22 @@\n     entry->valid = 1;\n     entry->okey = okey;\n \n-\n     if (insert != NULL)\n-\tinsert->next = entry;\n+        insert->next = entry;\n \n     dict->nbElems++;\n \n     if ((nbi > MAX_HASH_LEN) &&\n         (dict->size <= ((MAX_DICT_HASH / 2) / MAX_HASH_LEN))) {\n-\tif (xmlDictGrow(dict, MAX_HASH_LEN * 2 * dict->size) != 0)\n-\t    return(NULL);\n+        if (xmlDictGrow(dict, MAX_HASH_LEN * 2 * dict->size) != 0)\n+            return(NULL);\n     }\n     /* Note that entry may have been freed at this point by xmlDictGrow */\n \n     return(ret);\n }\n \n+\n /**\n  * xmlDictExists:\n  * @dict: the dictionary\n', 'id': 18, 'location': '/data/vulnloc/libxml2/CVE-2016-1839/src/dict.c:836:5'}, {'diff': '@@ -825,21 +825,17 @@\n  *\n  * Returns the internal copy of the name or NULL in case of internal error\n  */\n+\n const xmlChar *\n xmlDictLookup(xmlDictPtr dict, const xmlChar *name, int len) {\n+    if (dict == NULL || name == NULL || len < 0)  // Combined conditions for null checks\n+        return(NULL);\n+\n     unsigned long key, okey, nbi = 0;\n     xmlDictEntryPtr entry;\n     xmlDictEntryPtr insert;\n     const xmlChar *ret;\n-    unsigned int l;\n-\n-    if ((dict == NULL) || (name == NULL))\n-\treturn(NULL);\n-\n-    if (len < 0)\n-        l = strlen((const char *) name);\n-    else\n-        l = len;\n+    unsigned int l = (len < 0) ? strlen((const char *) name) : len;  // Validating length after null checks\n \n     if (((dict->limit > 0) && (l >= dict->limit)) ||\n         (l > INT_MAX / 2))\n@@ -851,31 +847,31 @@\n     okey = xmlDictComputeKey(dict, name, l);\n     key = okey % dict->size;\n     if (dict->dict[key].valid == 0) {\n-\tinsert = NULL;\n+        insert = NULL;\n     } else {\n-\tfor (insert = &(dict->dict[key]); insert->next != NULL;\n-\t     insert = insert->next) {\n+        for (insert = &(dict->dict[key]); insert->next != NULL; \n+             insert = insert->next) {\n #ifdef __GNUC__\n-\t    if ((insert->okey == okey) && (insert->len == l)) {\n-\t\tif (!memcmp(insert->name, name, l))\n-\t\t    return(insert->name);\n-\t    }\n+            if ((insert->okey == okey) && (insert->len == l)) {\n+                if (!memcmp(insert->name, name, l))\n+                    return(insert->name);\n+            }\n #else\n-\t    if ((insert->okey == okey) && (insert->len == l) &&\n-\t        (!xmlStrncmp(insert->name, name, l)))\n-\t\treturn(insert->name);\n+            if ((insert->okey == okey) && (insert->len == l) &&\n+                (!xmlStrncmp(insert->name, name, l)))\n+                return(insert->name);\n #endif\n-\t    nbi++;\n-\t}\n+            nbi++;\n+        }\n #ifdef __GNUC__\n-\tif ((insert->okey == okey) && (insert->len == l)) {\n-\t    if (!memcmp(insert->name, name, l))\n-\t\treturn(insert->name);\n-\t}\n+        if ((insert->okey == okey) && (insert->len == l)) {\n+            if (!memcmp(insert->name, name, l))\n+                return(insert->name);\n+        }\n #else\n-\tif ((insert->okey == okey) && (insert->len == l) &&\n-\t    (!xmlStrncmp(insert->name, name, l)))\n-\t    return(insert->name);\n+        if ((insert->okey == okey) && (insert->len == l) &&\n+            (!xmlStrncmp(insert->name, name, l)))\n+            return(insert->name);\n #endif\n     }\n \n@@ -884,77 +880,79 @@\n \n         /* we cannot always reuse the same okey for the subdict */\n         if (((dict->size == MIN_DICT_SIZE) &&\n-\t     (dict->subdict->size != MIN_DICT_SIZE)) ||\n+             (dict->subdict->size != MIN_DICT_SIZE)) ||\n             ((dict->size != MIN_DICT_SIZE) &&\n-\t     (dict->subdict->size == MIN_DICT_SIZE)))\n-\t    skey = xmlDictComputeKey(dict->subdict, name, l);\n-\telse\n-\t    skey = okey;\n-\n-\tkey = skey % dict->subdict->size;\n-\tif (dict->subdict->dict[key].valid != 0) {\n-\t    xmlDictEntryPtr tmp;\n+             (dict->subdict->size == MIN_DICT_SIZE)))\n+            skey = xmlDictComputeKey(dict->subdict, name, l);\n+        else\n+            skey = okey;\n+\n+        key = skey % dict->subdict->size;\n+        if (dict->subdict->dict[key].valid != 0) {\n+            xmlDictEntryPtr tmp;\n \n-\t    for (tmp = &(dict->subdict->dict[key]); tmp->next != NULL;\n-\t\t tmp = tmp->next) {\n+            for (tmp = &(dict->subdict->dict[key]); tmp->next != NULL;\n+                 tmp = tmp->next) {\n #ifdef __GNUC__\n-\t\tif ((tmp->okey == skey) && (tmp->len == l)) {\n-\t\t    if (!memcmp(tmp->name, name, l))\n-\t\t\treturn(tmp->name);\n-\t\t}\n+                if ((tmp->okey == skey) && (tmp->len == l)) {\n+                    if (!memcmp(tmp->name, name, l))\n+                        return(tmp->name);\n+                }\n #else\n-\t\tif ((tmp->okey == skey) && (tmp->len == l) &&\n-\t\t    (!xmlStrncmp(tmp->name, name, l)))\n-\t\t    return(tmp->name);\n+                if ((tmp->okey == skey) && (tmp->len == l) &&\n+                    (!xmlStrncmp(tmp->name, name, l)))\n+                    return(tmp->name);\n #endif\n-\t\tnbi++;\n-\t    }\n+                nbi++;\n+            }\n #ifdef __GNUC__\n-\t    if ((tmp->okey == skey) && (tmp->len == l)) {\n-\t\tif (!memcmp(tmp->name, name, l))\n-\t\t    return(tmp->name);\n-\t    }\n+            if ((tmp->okey == skey) && (tmp->len == l)) {\n+                if (!memcmp(tmp->name, name, l))\n+                    return(tmp->name);\n+            }\n #else\n-\t    if ((tmp->okey == skey) && (tmp->len == l) &&\n-\t\t(!xmlStrncmp(tmp->name, name, l)))\n-\t\treturn(tmp->name);\n+            if ((tmp->okey == skey) && (tmp->len == l) &&\n+                (!xmlStrncmp(tmp->name, name, l)))\n+                return(tmp->name);\n #endif\n-\t}\n-\tkey = okey % dict->size;\n+        }\n+        key = okey % dict->size;\n     }\n \n     ret = xmlDictAddString(dict, name, l);\n     if (ret == NULL)\n         return(NULL);\n+    \n     if (insert == NULL) {\n-\tentry = &(dict->dict[key]);\n+        entry = &(dict->dict[key]);\n     } else {\n-\tentry = xmlMalloc(sizeof(xmlDictEntry));\n-\tif (entry == NULL)\n-\t     return(NULL);\n+        entry = xmlMalloc(sizeof(xmlDictEntry));\n+        if (entry == NULL)\n+             return(NULL);\n     }\n+    \n     entry->name = ret;\n     entry->len = l;\n     entry->next = NULL;\n     entry->valid = 1;\n     entry->okey = okey;\n \n-\n     if (insert != NULL)\n-\tinsert->next = entry;\n+        insert->next = entry;\n \n     dict->nbElems++;\n \n     if ((nbi > MAX_HASH_LEN) &&\n         (dict->size <= ((MAX_DICT_HASH / 2) / MAX_HASH_LEN))) {\n-\tif (xmlDictGrow(dict, MAX_HASH_LEN * 2 * dict->size) != 0)\n-\t    return(NULL);\n+        if (xmlDictGrow(dict, MAX_HASH_LEN * 2 * dict->size) != 0)\n+            return(NULL);\n     }\n     /* Note that entry may have been freed at this point by xmlDictGrow */\n \n     return(ret);\n }\n \n+\n /**\n  * xmlDictExists:\n  * @dict: the dictionary\n', 'id': 19, 'location': '/data/vulnloc/libxml2/CVE-2016-1839/src/dict.c:836:5'}, {'diff': '@@ -825,6 +825,7 @@\n  *\n  * Returns the internal copy of the name or NULL in case of internal error\n  */\n+\n const xmlChar *\n xmlDictLookup(xmlDictPtr dict, const xmlChar *name, int len) {\n     unsigned long key, okey, nbi = 0;\n@@ -834,7 +835,7 @@\n     unsigned int l;\n \n     if ((dict == NULL) || (name == NULL))\n-\treturn(NULL);\n+        return(NULL);\n \n     if (len < 0)\n         l = strlen((const char *) name);\n@@ -844,38 +845,43 @@\n     if (((dict->limit > 0) && (l >= dict->limit)) ||\n         (l > INT_MAX / 2))\n         return(NULL);\n+    \n+    if (l == 0) // Step 1: Check for zero-length name\n+        return(NULL);\n \n     /*\n      * Check for duplicate and insertion location.\n      */\n     okey = xmlDictComputeKey(dict, name, l);\n+    if (okey == 0) // Step 1: Check if the computed key is zero\n+        return(NULL);\n     key = okey % dict->size;\n     if (dict->dict[key].valid == 0) {\n-\tinsert = NULL;\n+        insert = NULL;\n     } else {\n-\tfor (insert = &(dict->dict[key]); insert->next != NULL;\n-\t     insert = insert->next) {\n+        for (insert = &(dict->dict[key]); insert->next != NULL;\n+             insert = insert->next) {\n #ifdef __GNUC__\n-\t    if ((insert->okey == okey) && (insert->len == l)) {\n-\t\tif (!memcmp(insert->name, name, l))\n-\t\t    return(insert->name);\n-\t    }\n+            if ((insert->okey == okey) && (insert->len == l)) {\n+                if (!memcmp(insert->name, name, l))\n+                    return(insert->name);\n+            }\n #else\n-\t    if ((insert->okey == okey) && (insert->len == l) &&\n-\t        (!xmlStrncmp(insert->name, name, l)))\n-\t\treturn(insert->name);\n+            if ((insert->okey == okey) && (insert->len == l) &&\n+                (!xmlStrncmp(insert->name, name, l)))\n+                return(insert->name);\n #endif\n-\t    nbi++;\n-\t}\n+            nbi++;\n+        }\n #ifdef __GNUC__\n-\tif ((insert->okey == okey) && (insert->len == l)) {\n-\t    if (!memcmp(insert->name, name, l))\n-\t\treturn(insert->name);\n-\t}\n+        if ((insert->okey == okey) && (insert->len == l)) {\n+            if (!memcmp(insert->name, name, l))\n+                return(insert->name);\n+        }\n #else\n-\tif ((insert->okey == okey) && (insert->len == l) &&\n-\t    (!xmlStrncmp(insert->name, name, l)))\n-\t    return(insert->name);\n+        if ((insert->okey == okey) && (insert->len == l) &&\n+            (!xmlStrncmp(insert->name, name, l)))\n+            return(insert->name);\n #endif\n     }\n \n@@ -884,54 +890,56 @@\n \n         /* we cannot always reuse the same okey for the subdict */\n         if (((dict->size == MIN_DICT_SIZE) &&\n-\t     (dict->subdict->size != MIN_DICT_SIZE)) ||\n+             (dict->subdict->size != MIN_DICT_SIZE)) ||\n             ((dict->size != MIN_DICT_SIZE) &&\n-\t     (dict->subdict->size == MIN_DICT_SIZE)))\n-\t    skey = xmlDictComputeKey(dict->subdict, name, l);\n-\telse\n-\t    skey = okey;\n-\n-\tkey = skey % dict->subdict->size;\n-\tif (dict->subdict->dict[key].valid != 0) {\n-\t    xmlDictEntryPtr tmp;\n+             (dict->subdict->size == MIN_DICT_SIZE)))\n+            skey = xmlDictComputeKey(dict->subdict, name, l);\n+        else\n+            skey = okey;\n+\n+        if (skey == 0) // Step 1: Check if the subdict key is zero\n+            return(NULL);\n+        key = skey % dict->subdict->size;\n+        if (dict->subdict->dict[key].valid != 0) {\n+            xmlDictEntryPtr tmp;\n \n-\t    for (tmp = &(dict->subdict->dict[key]); tmp->next != NULL;\n-\t\t tmp = tmp->next) {\n+            for (tmp = &(dict->subdict->dict[key]); tmp->next != NULL;\n+                 tmp = tmp->next) {\n #ifdef __GNUC__\n-\t\tif ((tmp->okey == skey) && (tmp->len == l)) {\n-\t\t    if (!memcmp(tmp->name, name, l))\n-\t\t\treturn(tmp->name);\n-\t\t}\n+                if ((tmp->okey == skey) && (tmp->len == l)) {\n+                    if (!memcmp(tmp->name, name, l))\n+                        return(tmp->name);\n+                }\n #else\n-\t\tif ((tmp->okey == skey) && (tmp->len == l) &&\n-\t\t    (!xmlStrncmp(tmp->name, name, l)))\n-\t\t    return(tmp->name);\n+                if ((tmp->okey == skey) && (tmp->len == l) &&\n+                    (!xmlStrncmp(tmp->name, name, l)))\n+                    return(tmp->name);\n #endif\n-\t\tnbi++;\n-\t    }\n+                nbi++;\n+            }\n #ifdef __GNUC__\n-\t    if ((tmp->okey == skey) && (tmp->len == l)) {\n-\t\tif (!memcmp(tmp->name, name, l))\n-\t\t    return(tmp->name);\n-\t    }\n+            if ((tmp->okey == skey) && (tmp->len == l)) {\n+                if (!memcmp(tmp->name, name, l))\n+                    return(tmp->name);\n+            }\n #else\n-\t    if ((tmp->okey == skey) && (tmp->len == l) &&\n-\t\t(!xmlStrncmp(tmp->name, name, l)))\n-\t\treturn(tmp->name);\n+            if ((tmp->okey == skey) && (tmp->len == l) &&\n+                (!xmlStrncmp(tmp->name, name, l)))\n+                return(tmp->name);\n #endif\n-\t}\n-\tkey = okey % dict->size;\n+        }\n+        key = okey % dict->size;\n     }\n \n     ret = xmlDictAddString(dict, name, l);\n     if (ret == NULL)\n         return(NULL);\n     if (insert == NULL) {\n-\tentry = &(dict->dict[key]);\n+        entry = &(dict->dict[key]);\n     } else {\n-\tentry = xmlMalloc(sizeof(xmlDictEntry));\n-\tif (entry == NULL)\n-\t     return(NULL);\n+        entry = xmlMalloc(sizeof(xmlDictEntry));\n+        if (entry == NULL)\n+             return(NULL);\n     }\n     entry->name = ret;\n     entry->len = l;\n@@ -941,20 +949,21 @@\n \n \n     if (insert != NULL)\n-\tinsert->next = entry;\n+        insert->next = entry;\n \n     dict->nbElems++;\n \n     if ((nbi > MAX_HASH_LEN) &&\n         (dict->size <= ((MAX_DICT_HASH / 2) / MAX_HASH_LEN))) {\n-\tif (xmlDictGrow(dict, MAX_HASH_LEN * 2 * dict->size) != 0)\n-\t    return(NULL);\n+        if (xmlDictGrow(dict, MAX_HASH_LEN * 2 * dict->size) != 0)\n+            return(NULL);\n     }\n     /* Note that entry may have been freed at this point by xmlDictGrow */\n \n     return(ret);\n }\n \n+\n /**\n  * xmlDictExists:\n  * @dict: the dictionary\n', 'id': 20, 'location': '/data/vulnloc/libxml2/CVE-2016-1839/src/dict.c:851:12'}, {'diff': '@@ -825,6 +825,7 @@\n  *\n  * Returns the internal copy of the name or NULL in case of internal error\n  */\n+\n const xmlChar *\n xmlDictLookup(xmlDictPtr dict, const xmlChar *name, int len) {\n     unsigned long key, okey, nbi = 0;\n@@ -834,7 +835,7 @@\n     unsigned int l;\n \n     if ((dict == NULL) || (name == NULL))\n-\treturn(NULL);\n+        return(NULL);\n \n     if (len < 0)\n         l = strlen((const char *) name);\n@@ -848,34 +849,38 @@\n     /*\n      * Check for duplicate and insertion location.\n      */\n+    // Validate inputs to avoid potential hash computation vulnerabilities\n+    if (l == 0 || l > MAX_NAME_LENGTH) // MAX_NAME_LENGTH should be defined according to the allowed name length range\n+        return(NULL);\n+\n     okey = xmlDictComputeKey(dict, name, l);\n     key = okey % dict->size;\n     if (dict->dict[key].valid == 0) {\n-\tinsert = NULL;\n+        insert = NULL;\n     } else {\n-\tfor (insert = &(dict->dict[key]); insert->next != NULL;\n-\t     insert = insert->next) {\n+        for (insert = &(dict->dict[key]); insert->next != NULL;\n+             insert = insert->next) {\n #ifdef __GNUC__\n-\t    if ((insert->okey == okey) && (insert->len == l)) {\n-\t\tif (!memcmp(insert->name, name, l))\n-\t\t    return(insert->name);\n-\t    }\n+            if ((insert->okey == okey) && (insert->len == l)) {\n+                if (!memcmp(insert->name, name, l))\n+                    return(insert->name);\n+            }\n #else\n-\t    if ((insert->okey == okey) && (insert->len == l) &&\n-\t        (!xmlStrncmp(insert->name, name, l)))\n-\t\treturn(insert->name);\n+            if ((insert->okey == okey) && (insert->len == l) &&\n+                (!xmlStrncmp(insert->name, name, l)))\n+                return(insert->name);\n #endif\n-\t    nbi++;\n-\t}\n+            nbi++;\n+        }\n #ifdef __GNUC__\n-\tif ((insert->okey == okey) && (insert->len == l)) {\n-\t    if (!memcmp(insert->name, name, l))\n-\t\treturn(insert->name);\n-\t}\n+        if ((insert->okey == okey) && (insert->len == l)) {\n+            if (!memcmp(insert->name, name, l))\n+                return(insert->name);\n+        }\n #else\n-\tif ((insert->okey == okey) && (insert->len == l) &&\n-\t    (!xmlStrncmp(insert->name, name, l)))\n-\t    return(insert->name);\n+        if ((insert->okey == okey) && (insert->len == l) &&\n+            (!xmlStrncmp(insert->name, name, l)))\n+            return(insert->name);\n #endif\n     }\n \n@@ -884,54 +889,54 @@\n \n         /* we cannot always reuse the same okey for the subdict */\n         if (((dict->size == MIN_DICT_SIZE) &&\n-\t     (dict->subdict->size != MIN_DICT_SIZE)) ||\n+             (dict->subdict->size != MIN_DICT_SIZE)) ||\n             ((dict->size != MIN_DICT_SIZE) &&\n-\t     (dict->subdict->size == MIN_DICT_SIZE)))\n-\t    skey = xmlDictComputeKey(dict->subdict, name, l);\n-\telse\n-\t    skey = okey;\n-\n-\tkey = skey % dict->subdict->size;\n-\tif (dict->subdict->dict[key].valid != 0) {\n-\t    xmlDictEntryPtr tmp;\n+             (dict->subdict->size == MIN_DICT_SIZE)))\n+            skey = xmlDictComputeKey(dict->subdict, name, l);\n+        else\n+            skey = okey;\n+\n+        key = skey % dict->subdict->size;\n+        if (dict->subdict->dict[key].valid != 0) {\n+            xmlDictEntryPtr tmp;\n \n-\t    for (tmp = &(dict->subdict->dict[key]); tmp->next != NULL;\n-\t\t tmp = tmp->next) {\n+            for (tmp = &(dict->subdict->dict[key]); tmp->next != NULL;\n+                 tmp = tmp->next) {\n #ifdef __GNUC__\n-\t\tif ((tmp->okey == skey) && (tmp->len == l)) {\n-\t\t    if (!memcmp(tmp->name, name, l))\n-\t\t\treturn(tmp->name);\n-\t\t}\n+                if ((tmp->okey == skey) && (tmp->len == l)) {\n+                    if (!memcmp(tmp->name, name, l))\n+                        return(tmp->name);\n+                }\n #else\n-\t\tif ((tmp->okey == skey) && (tmp->len == l) &&\n-\t\t    (!xmlStrncmp(tmp->name, name, l)))\n-\t\t    return(tmp->name);\n+                if ((tmp->okey == skey) && (tmp->len == l) &&\n+                    (!xmlStrncmp(tmp->name, name, l)))\n+                    return(tmp->name);\n #endif\n-\t\tnbi++;\n-\t    }\n+                nbi++;\n+            }\n #ifdef __GNUC__\n-\t    if ((tmp->okey == skey) && (tmp->len == l)) {\n-\t\tif (!memcmp(tmp->name, name, l))\n-\t\t    return(tmp->name);\n-\t    }\n+            if ((tmp->okey == skey) && (tmp->len == l)) {\n+                if (!memcmp(tmp->name, name, l))\n+                    return(tmp->name);\n+            }\n #else\n-\t    if ((tmp->okey == skey) && (tmp->len == l) &&\n-\t\t(!xmlStrncmp(tmp->name, name, l)))\n-\t\treturn(tmp->name);\n+            if ((tmp->okey == skey) && (tmp->len == l) &&\n+                (!xmlStrncmp(tmp->name, name, l)))\n+                return(tmp->name);\n #endif\n-\t}\n-\tkey = okey % dict->size;\n+        }\n+        key = okey % dict->size;\n     }\n \n     ret = xmlDictAddString(dict, name, l);\n     if (ret == NULL)\n         return(NULL);\n     if (insert == NULL) {\n-\tentry = &(dict->dict[key]);\n+        entry = &(dict->dict[key]);\n     } else {\n-\tentry = xmlMalloc(sizeof(xmlDictEntry));\n-\tif (entry == NULL)\n-\t     return(NULL);\n+        entry = xmlMalloc(sizeof(xmlDictEntry));\n+        if (entry == NULL)\n+            return(NULL);\n     }\n     entry->name = ret;\n     entry->len = l;\n@@ -939,22 +944,22 @@\n     entry->valid = 1;\n     entry->okey = okey;\n \n-\n     if (insert != NULL)\n-\tinsert->next = entry;\n+        insert->next = entry;\n \n     dict->nbElems++;\n \n     if ((nbi > MAX_HASH_LEN) &&\n         (dict->size <= ((MAX_DICT_HASH / 2) / MAX_HASH_LEN))) {\n-\tif (xmlDictGrow(dict, MAX_HASH_LEN * 2 * dict->size) != 0)\n-\t    return(NULL);\n+        if (xmlDictGrow(dict, MAX_HASH_LEN * 2 * dict->size) != 0)\n+            return(NULL);\n     }\n     /* Note that entry may have been freed at this point by xmlDictGrow */\n \n     return(ret);\n }\n \n+\n /**\n  * xmlDictExists:\n  * @dict: the dictionary\n', 'id': 21, 'location': '/data/vulnloc/libxml2/CVE-2016-1839/src/dict.c:851:12'}, {'diff': '@@ -825,6 +825,7 @@\n  *\n  * Returns the internal copy of the name or NULL in case of internal error\n  */\n+\n const xmlChar *\n xmlDictLookup(xmlDictPtr dict, const xmlChar *name, int len) {\n     unsigned long key, okey, nbi = 0;\n@@ -834,7 +835,7 @@\n     unsigned int l;\n \n     if ((dict == NULL) || (name == NULL))\n-\treturn(NULL);\n+        return(NULL);\n \n     if (len < 0)\n         l = strlen((const char *) name);\n@@ -848,34 +849,37 @@\n     /*\n      * Check for duplicate and insertion location.\n      */\n+    if (l == 0)  // Additional check for zero-length names\n+        return(NULL);\n+\n     okey = xmlDictComputeKey(dict, name, l);\n     key = okey % dict->size;\n     if (dict->dict[key].valid == 0) {\n-\tinsert = NULL;\n+        insert = NULL;\n     } else {\n-\tfor (insert = &(dict->dict[key]); insert->next != NULL;\n-\t     insert = insert->next) {\n+        for (insert = &(dict->dict[key]); insert->next != NULL;\n+             insert = insert->next) {\n #ifdef __GNUC__\n-\t    if ((insert->okey == okey) && (insert->len == l)) {\n-\t\tif (!memcmp(insert->name, name, l))\n-\t\t    return(insert->name);\n-\t    }\n+            if ((insert->okey == okey) && (insert->len == l)) {\n+                if (!memcmp(insert->name, name, l))\n+                    return(insert->name);\n+            }\n #else\n-\t    if ((insert->okey == okey) && (insert->len == l) &&\n-\t        (!xmlStrncmp(insert->name, name, l)))\n-\t\treturn(insert->name);\n+            if ((insert->okey == okey) && (insert->len == l) &&\n+                (!xmlStrncmp(insert->name, name, l)))\n+                return(insert->name);\n #endif\n-\t    nbi++;\n-\t}\n+            nbi++;\n+        }\n #ifdef __GNUC__\n-\tif ((insert->okey == okey) && (insert->len == l)) {\n-\t    if (!memcmp(insert->name, name, l))\n-\t\treturn(insert->name);\n-\t}\n+        if ((insert->okey == okey) && (insert->len == l)) {\n+            if (!memcmp(insert->name, name, l))\n+                return(insert->name);\n+        }\n #else\n-\tif ((insert->okey == okey) && (insert->len == l) &&\n-\t    (!xmlStrncmp(insert->name, name, l)))\n-\t    return(insert->name);\n+        if ((insert->okey == okey) && (insert->len == l) &&\n+            (!xmlStrncmp(insert->name, name, l)))\n+            return(insert->name);\n #endif\n     }\n \n@@ -884,54 +888,54 @@\n \n         /* we cannot always reuse the same okey for the subdict */\n         if (((dict->size == MIN_DICT_SIZE) &&\n-\t     (dict->subdict->size != MIN_DICT_SIZE)) ||\n+             (dict->subdict->size != MIN_DICT_SIZE)) ||\n             ((dict->size != MIN_DICT_SIZE) &&\n-\t     (dict->subdict->size == MIN_DICT_SIZE)))\n-\t    skey = xmlDictComputeKey(dict->subdict, name, l);\n-\telse\n-\t    skey = okey;\n-\n-\tkey = skey % dict->subdict->size;\n-\tif (dict->subdict->dict[key].valid != 0) {\n-\t    xmlDictEntryPtr tmp;\n+             (dict->subdict->size == MIN_DICT_SIZE)))\n+            skey = xmlDictComputeKey(dict->subdict, name, l);\n+        else\n+            skey = okey;\n+\n+        key = skey % dict->subdict->size;\n+        if (dict->subdict->dict[key].valid != 0) {\n+            xmlDictEntryPtr tmp;\n \n-\t    for (tmp = &(dict->subdict->dict[key]); tmp->next != NULL;\n-\t\t tmp = tmp->next) {\n+            for (tmp = &(dict->subdict->dict[key]); tmp->next != NULL;\n+                 tmp = tmp->next) {\n #ifdef __GNUC__\n-\t\tif ((tmp->okey == skey) && (tmp->len == l)) {\n-\t\t    if (!memcmp(tmp->name, name, l))\n-\t\t\treturn(tmp->name);\n-\t\t}\n+                if ((tmp->okey == skey) && (tmp->len == l)) {\n+                    if (!memcmp(tmp->name, name, l))\n+                        return(tmp->name);\n+                }\n #else\n-\t\tif ((tmp->okey == skey) && (tmp->len == l) &&\n-\t\t    (!xmlStrncmp(tmp->name, name, l)))\n-\t\t    return(tmp->name);\n+                if ((tmp->okey == skey) && (tmp->len == l) &&\n+                    (!xmlStrncmp(tmp->name, name, l)))\n+                    return(tmp->name);\n #endif\n-\t\tnbi++;\n-\t    }\n+                nbi++;\n+            }\n #ifdef __GNUC__\n-\t    if ((tmp->okey == skey) && (tmp->len == l)) {\n-\t\tif (!memcmp(tmp->name, name, l))\n-\t\t    return(tmp->name);\n-\t    }\n+            if ((tmp->okey == skey) && (tmp->len == l)) {\n+                if (!memcmp(tmp->name, name, l))\n+                    return(tmp->name);\n+            }\n #else\n-\t    if ((tmp->okey == skey) && (tmp->len == l) &&\n-\t\t(!xmlStrncmp(tmp->name, name, l)))\n-\t\treturn(tmp->name);\n+            if ((tmp->okey == skey) && (tmp->len == l) &&\n+                (!xmlStrncmp(tmp->name, name, l)))\n+                return(tmp->name);\n #endif\n-\t}\n-\tkey = okey % dict->size;\n+        }\n+        key = okey % dict->size;\n     }\n \n     ret = xmlDictAddString(dict, name, l);\n     if (ret == NULL)\n         return(NULL);\n     if (insert == NULL) {\n-\tentry = &(dict->dict[key]);\n+        entry = &(dict->dict[key]);\n     } else {\n-\tentry = xmlMalloc(sizeof(xmlDictEntry));\n-\tif (entry == NULL)\n-\t     return(NULL);\n+        entry = xmlMalloc(sizeof(xmlDictEntry));\n+        if (entry == NULL)\n+            return(NULL);\n     }\n     entry->name = ret;\n     entry->len = l;\n@@ -939,22 +943,22 @@\n     entry->valid = 1;\n     entry->okey = okey;\n \n-\n     if (insert != NULL)\n-\tinsert->next = entry;\n+        insert->next = entry;\n \n     dict->nbElems++;\n \n     if ((nbi > MAX_HASH_LEN) &&\n         (dict->size <= ((MAX_DICT_HASH / 2) / MAX_HASH_LEN))) {\n-\tif (xmlDictGrow(dict, MAX_HASH_LEN * 2 * dict->size) != 0)\n-\t    return(NULL);\n+        if (xmlDictGrow(dict, MAX_HASH_LEN * 2 * dict->size) != 0)\n+            return(NULL);\n     }\n     /* Note that entry may have been freed at this point by xmlDictGrow */\n \n     return(ret);\n }\n \n+\n /**\n  * xmlDictExists:\n  * @dict: the dictionary\n', 'id': 22, 'location': '/data/vulnloc/libxml2/CVE-2016-1839/src/dict.c:851:12'}, {'diff': '@@ -825,6 +825,7 @@\n  *\n  * Returns the internal copy of the name or NULL in case of internal error\n  */\n+\n const xmlChar *\n xmlDictLookup(xmlDictPtr dict, const xmlChar *name, int len) {\n     unsigned long key, okey, nbi = 0;\n@@ -848,6 +849,9 @@\n     /*\n      * Check for duplicate and insertion location.\n      */\n+    if (l > MAX_NAME_LENGTH)  // Added check for name length to prevent excessive computation\n+        return(NULL);\n+\n     okey = xmlDictComputeKey(dict, name, l);\n     key = okey % dict->size;\n     if (dict->dict[key].valid == 0) {\n@@ -955,6 +959,7 @@\n     return(ret);\n }\n \n+\n /**\n  * xmlDictExists:\n  * @dict: the dictionary\n', 'id': 23, 'location': '/data/vulnloc/libxml2/CVE-2016-1839/src/dict.c:851:12'}, {'diff': '@@ -825,6 +825,7 @@\n  *\n  * Returns the internal copy of the name or NULL in case of internal error\n  */\n+\n const xmlChar *\n xmlDictLookup(xmlDictPtr dict, const xmlChar *name, int len) {\n     unsigned long key, okey, nbi = 0;\n@@ -834,7 +835,7 @@\n     unsigned int l;\n \n     if ((dict == NULL) || (name == NULL))\n-\treturn(NULL);\n+        return(NULL);\n \n     if (len < 0)\n         l = strlen((const char *) name);\n@@ -845,37 +846,43 @@\n         (l > INT_MAX / 2))\n         return(NULL);\n \n+    if (l == 0) // New check for empty name\n+        return(NULL);\n+\n     /*\n      * Check for duplicate and insertion location.\n      */\n     okey = xmlDictComputeKey(dict, name, l);\n+    if (okey == 0) // New check for invalid key\n+        return(NULL);\n+\n     key = okey % dict->size;\n     if (dict->dict[key].valid == 0) {\n-\tinsert = NULL;\n+        insert = NULL;\n     } else {\n-\tfor (insert = &(dict->dict[key]); insert->next != NULL;\n-\t     insert = insert->next) {\n+        for (insert = &(dict->dict[key]); insert->next != NULL;\n+             insert = insert->next) {\n #ifdef __GNUC__\n-\t    if ((insert->okey == okey) && (insert->len == l)) {\n-\t\tif (!memcmp(insert->name, name, l))\n-\t\t    return(insert->name);\n-\t    }\n+            if ((insert->okey == okey) && (insert->len == l)) {\n+                if (!memcmp(insert->name, name, l))\n+                    return(insert->name);\n+            }\n #else\n-\t    if ((insert->okey == okey) && (insert->len == l) &&\n-\t        (!xmlStrncmp(insert->name, name, l)))\n-\t\treturn(insert->name);\n+            if ((insert->okey == okey) && (insert->len == l) &&\n+                (!xmlStrncmp(insert->name, name, l)))\n+                return(insert->name);\n #endif\n-\t    nbi++;\n-\t}\n+            nbi++;\n+        }\n #ifdef __GNUC__\n-\tif ((insert->okey == okey) && (insert->len == l)) {\n-\t    if (!memcmp(insert->name, name, l))\n-\t\treturn(insert->name);\n-\t}\n+        if ((insert->okey == okey) && (insert->len == l)) {\n+            if (!memcmp(insert->name, name, l))\n+                return(insert->name);\n+        }\n #else\n-\tif ((insert->okey == okey) && (insert->len == l) &&\n-\t    (!xmlStrncmp(insert->name, name, l)))\n-\t    return(insert->name);\n+        if ((insert->okey == okey) && (insert->len == l) &&\n+            (!xmlStrncmp(insert->name, name, l)))\n+            return(insert->name);\n #endif\n     }\n \n@@ -884,54 +891,54 @@\n \n         /* we cannot always reuse the same okey for the subdict */\n         if (((dict->size == MIN_DICT_SIZE) &&\n-\t     (dict->subdict->size != MIN_DICT_SIZE)) ||\n+             (dict->subdict->size != MIN_DICT_SIZE)) ||\n             ((dict->size != MIN_DICT_SIZE) &&\n-\t     (dict->subdict->size == MIN_DICT_SIZE)))\n-\t    skey = xmlDictComputeKey(dict->subdict, name, l);\n-\telse\n-\t    skey = okey;\n-\n-\tkey = skey % dict->subdict->size;\n-\tif (dict->subdict->dict[key].valid != 0) {\n-\t    xmlDictEntryPtr tmp;\n+             (dict->subdict->size == MIN_DICT_SIZE)))\n+            skey = xmlDictComputeKey(dict->subdict, name, l);\n+        else\n+            skey = okey;\n+\n+        key = skey % dict->subdict->size;\n+        if (dict->subdict->dict[key].valid != 0) {\n+            xmlDictEntryPtr tmp;\n \n-\t    for (tmp = &(dict->subdict->dict[key]); tmp->next != NULL;\n-\t\t tmp = tmp->next) {\n+            for (tmp = &(dict->subdict->dict[key]); tmp->next != NULL;\n+                 tmp = tmp->next) {\n #ifdef __GNUC__\n-\t\tif ((tmp->okey == skey) && (tmp->len == l)) {\n-\t\t    if (!memcmp(tmp->name, name, l))\n-\t\t\treturn(tmp->name);\n-\t\t}\n+                if ((tmp->okey == skey) && (tmp->len == l)) {\n+                    if (!memcmp(tmp->name, name, l))\n+                        return(tmp->name);\n+                }\n #else\n-\t\tif ((tmp->okey == skey) && (tmp->len == l) &&\n-\t\t    (!xmlStrncmp(tmp->name, name, l)))\n-\t\t    return(tmp->name);\n+                if ((tmp->okey == skey) && (tmp->len == l) &&\n+                    (!xmlStrncmp(tmp->name, name, l)))\n+                    return(tmp->name);\n #endif\n-\t\tnbi++;\n-\t    }\n+                nbi++;\n+            }\n #ifdef __GNUC__\n-\t    if ((tmp->okey == skey) && (tmp->len == l)) {\n-\t\tif (!memcmp(tmp->name, name, l))\n-\t\t    return(tmp->name);\n-\t    }\n+            if ((tmp->okey == skey) && (tmp->len == l)) {\n+                if (!memcmp(tmp->name, name, l))\n+                    return(tmp->name);\n+            }\n #else\n-\t    if ((tmp->okey == skey) && (tmp->len == l) &&\n-\t\t(!xmlStrncmp(tmp->name, name, l)))\n-\t\treturn(tmp->name);\n+            if ((tmp->okey == skey) && (tmp->len == l) &&\n+                (!xmlStrncmp(tmp->name, name, l)))\n+                return(tmp->name);\n #endif\n-\t}\n-\tkey = okey % dict->size;\n+        }\n+        key = okey % dict->size;\n     }\n \n     ret = xmlDictAddString(dict, name, l);\n     if (ret == NULL)\n         return(NULL);\n     if (insert == NULL) {\n-\tentry = &(dict->dict[key]);\n+        entry = &(dict->dict[key]);\n     } else {\n-\tentry = xmlMalloc(sizeof(xmlDictEntry));\n-\tif (entry == NULL)\n-\t     return(NULL);\n+        entry = xmlMalloc(sizeof(xmlDictEntry));\n+        if (entry == NULL)\n+            return(NULL);\n     }\n     entry->name = ret;\n     entry->len = l;\n@@ -941,20 +948,21 @@\n \n \n     if (insert != NULL)\n-\tinsert->next = entry;\n+        insert->next = entry;\n \n     dict->nbElems++;\n \n     if ((nbi > MAX_HASH_LEN) &&\n         (dict->size <= ((MAX_DICT_HASH / 2) / MAX_HASH_LEN))) {\n-\tif (xmlDictGrow(dict, MAX_HASH_LEN * 2 * dict->size) != 0)\n-\t    return(NULL);\n+        if (xmlDictGrow(dict, MAX_HASH_LEN * 2 * dict->size) != 0)\n+            return(NULL);\n     }\n     /* Note that entry may have been freed at this point by xmlDictGrow */\n \n     return(ret);\n }\n \n+\n /**\n  * xmlDictExists:\n  * @dict: the dictionary\n', 'id': 24, 'location': '/data/vulnloc/libxml2/CVE-2016-1839/src/dict.c:851:12'}, {'diff': '@@ -825,6 +825,7 @@\n  *\n  * Returns the internal copy of the name or NULL in case of internal error\n  */\n+\n const xmlChar *\n xmlDictLookup(xmlDictPtr dict, const xmlChar *name, int len) {\n     unsigned long key, okey, nbi = 0;\n@@ -834,15 +835,19 @@\n     unsigned int l;\n \n     if ((dict == NULL) || (name == NULL))\n-\treturn(NULL);\n+        return(NULL);\n \n-    if (len < 0)\n+    if (len < 0) {\n         l = strlen((const char *) name);\n-    else\n+        if (l >= dict->limit) // Added limit check here to avoid overflow\n+            return(NULL);\n+    } else {\n         l = len;\n+        if ((dict->limit > 0) && (l >= dict->limit)) // Check if limit is respected\n+            return(NULL);\n+    }\n \n-    if (((dict->limit > 0) && (l >= dict->limit)) ||\n-        (l > INT_MAX / 2))\n+    if (l > INT_MAX / 2)\n         return(NULL);\n \n     /*\n@@ -851,31 +856,31 @@\n     okey = xmlDictComputeKey(dict, name, l);\n     key = okey % dict->size;\n     if (dict->dict[key].valid == 0) {\n-\tinsert = NULL;\n+        insert = NULL;\n     } else {\n-\tfor (insert = &(dict->dict[key]); insert->next != NULL;\n-\t     insert = insert->next) {\n+        for (insert = &(dict->dict[key]); insert->next != NULL;\n+             insert = insert->next) {\n #ifdef __GNUC__\n-\t    if ((insert->okey == okey) && (insert->len == l)) {\n-\t\tif (!memcmp(insert->name, name, l))\n-\t\t    return(insert->name);\n-\t    }\n+            if ((insert->okey == okey) && (insert->len == l)) {\n+                if (!memcmp(insert->name, name, l))\n+                    return(insert->name);\n+            }\n #else\n-\t    if ((insert->okey == okey) && (insert->len == l) &&\n-\t        (!xmlStrncmp(insert->name, name, l)))\n-\t\treturn(insert->name);\n+            if ((insert->okey == okey) && (insert->len == l) &&\n+                (!xmlStrncmp(insert->name, name, l)))\n+                return(insert->name);\n #endif\n-\t    nbi++;\n-\t}\n+            nbi++;\n+        }\n #ifdef __GNUC__\n-\tif ((insert->okey == okey) && (insert->len == l)) {\n-\t    if (!memcmp(insert->name, name, l))\n-\t\treturn(insert->name);\n-\t}\n+        if ((insert->okey == okey) && (insert->len == l)) {\n+            if (!memcmp(insert->name, name, l))\n+                return(insert->name);\n+        }\n #else\n-\tif ((insert->okey == okey) && (insert->len == l) &&\n-\t    (!xmlStrncmp(insert->name, name, l)))\n-\t    return(insert->name);\n+        if ((insert->okey == okey) && (insert->len == l) &&\n+            (!xmlStrncmp(insert->name, name, l)))\n+            return(insert->name);\n #endif\n     }\n \n@@ -884,54 +889,54 @@\n \n         /* we cannot always reuse the same okey for the subdict */\n         if (((dict->size == MIN_DICT_SIZE) &&\n-\t     (dict->subdict->size != MIN_DICT_SIZE)) ||\n+             (dict->subdict->size != MIN_DICT_SIZE)) ||\n             ((dict->size != MIN_DICT_SIZE) &&\n-\t     (dict->subdict->size == MIN_DICT_SIZE)))\n-\t    skey = xmlDictComputeKey(dict->subdict, name, l);\n-\telse\n-\t    skey = okey;\n-\n-\tkey = skey % dict->subdict->size;\n-\tif (dict->subdict->dict[key].valid != 0) {\n-\t    xmlDictEntryPtr tmp;\n+             (dict->subdict->size == MIN_DICT_SIZE)))\n+            skey = xmlDictComputeKey(dict->subdict, name, l);\n+        else\n+            skey = okey;\n+\n+        key = skey % dict->subdict->size;\n+        if (dict->subdict->dict[key].valid != 0) {\n+            xmlDictEntryPtr tmp;\n \n-\t    for (tmp = &(dict->subdict->dict[key]); tmp->next != NULL;\n-\t\t tmp = tmp->next) {\n+            for (tmp = &(dict->subdict->dict[key]); tmp->next != NULL;\n+                 tmp = tmp->next) {\n #ifdef __GNUC__\n-\t\tif ((tmp->okey == skey) && (tmp->len == l)) {\n-\t\t    if (!memcmp(tmp->name, name, l))\n-\t\t\treturn(tmp->name);\n-\t\t}\n+                if ((tmp->okey == skey) && (tmp->len == l)) {\n+                    if (!memcmp(tmp->name, name, l))\n+                        return(tmp->name);\n+                }\n #else\n-\t\tif ((tmp->okey == skey) && (tmp->len == l) &&\n-\t\t    (!xmlStrncmp(tmp->name, name, l)))\n-\t\t    return(tmp->name);\n+                if ((tmp->okey == skey) && (tmp->len == l) &&\n+                    (!xmlStrncmp(tmp->name, name, l)))\n+                    return(tmp->name);\n #endif\n-\t\tnbi++;\n-\t    }\n+                nbi++;\n+            }\n #ifdef __GNUC__\n-\t    if ((tmp->okey == skey) && (tmp->len == l)) {\n-\t\tif (!memcmp(tmp->name, name, l))\n-\t\t    return(tmp->name);\n-\t    }\n+            if ((tmp->okey == skey) && (tmp->len == l)) {\n+                if (!memcmp(tmp->name, name, l))\n+                    return(tmp->name);\n+            }\n #else\n-\t    if ((tmp->okey == skey) && (tmp->len == l) &&\n-\t\t(!xmlStrncmp(tmp->name, name, l)))\n-\t\treturn(tmp->name);\n+            if ((tmp->okey == skey) && (tmp->len == l) &&\n+                (!xmlStrncmp(tmp->name, name, l)))\n+                return(tmp->name);\n #endif\n-\t}\n-\tkey = okey % dict->size;\n+        }\n+        key = okey % dict->size;\n     }\n \n     ret = xmlDictAddString(dict, name, l);\n     if (ret == NULL)\n         return(NULL);\n     if (insert == NULL) {\n-\tentry = &(dict->dict[key]);\n+        entry = &(dict->dict[key]);\n     } else {\n-\tentry = xmlMalloc(sizeof(xmlDictEntry));\n-\tif (entry == NULL)\n-\t     return(NULL);\n+        entry = xmlMalloc(sizeof(xmlDictEntry));\n+        if (entry == NULL)\n+             return(NULL);\n     }\n     entry->name = ret;\n     entry->len = l;\n@@ -939,22 +944,22 @@\n     entry->valid = 1;\n     entry->okey = okey;\n \n-\n     if (insert != NULL)\n-\tinsert->next = entry;\n+        insert->next = entry;\n \n     dict->nbElems++;\n \n     if ((nbi > MAX_HASH_LEN) &&\n         (dict->size <= ((MAX_DICT_HASH / 2) / MAX_HASH_LEN))) {\n-\tif (xmlDictGrow(dict, MAX_HASH_LEN * 2 * dict->size) != 0)\n-\t    return(NULL);\n+        if (xmlDictGrow(dict, MAX_HASH_LEN * 2 * dict->size) != 0)\n+            return(NULL);\n     }\n     /* Note that entry may have been freed at this point by xmlDictGrow */\n \n     return(ret);\n }\n \n+\n /**\n  * xmlDictExists:\n  * @dict: the dictionary\n', 'id': 25, 'location': '/data/vulnloc/libxml2/CVE-2016-1839/src/dict.c:844:5'}, {'diff': '@@ -825,6 +825,7 @@\n  *\n  * Returns the internal copy of the name or NULL in case of internal error\n  */\n+\n const xmlChar *\n xmlDictLookup(xmlDictPtr dict, const xmlChar *name, int len) {\n     unsigned long key, okey, nbi = 0;\n@@ -834,15 +835,20 @@\n     unsigned int l;\n \n     if ((dict == NULL) || (name == NULL))\n-\treturn(NULL);\n+        return(NULL);\n \n-    if (len < 0)\n+    if (len < 0) {\n         l = strlen((const char *) name);\n-    else\n+    } else {\n         l = len;\n+    }\n \n-    if (((dict->limit > 0) && (l >= dict->limit)) ||\n-        (l > INT_MAX / 2))\n+    // Added validation for negative lengths\n+    if (l < 0 || l >= dict->limit) {\n+        return(NULL);\n+    }\n+\n+    if ((dict->limit > 0 && l >= dict->limit) || (l > INT_MAX / 2)) \n         return(NULL);\n \n     /*\n@@ -851,31 +857,28 @@\n     okey = xmlDictComputeKey(dict, name, l);\n     key = okey % dict->size;\n     if (dict->dict[key].valid == 0) {\n-\tinsert = NULL;\n+        insert = NULL;\n     } else {\n-\tfor (insert = &(dict->dict[key]); insert->next != NULL;\n-\t     insert = insert->next) {\n+        for (insert = &(dict->dict[key]); insert->next != NULL; insert = insert->next) {\n #ifdef __GNUC__\n-\t    if ((insert->okey == okey) && (insert->len == l)) {\n-\t\tif (!memcmp(insert->name, name, l))\n-\t\t    return(insert->name);\n-\t    }\n+            if ((insert->okey == okey) && (insert->len == l)) {\n+                if (!memcmp(insert->name, name, l))\n+                    return(insert->name);\n+            }\n #else\n-\t    if ((insert->okey == okey) && (insert->len == l) &&\n-\t        (!xmlStrncmp(insert->name, name, l)))\n-\t\treturn(insert->name);\n+            if ((insert->okey == okey) && (insert->len == l) && (!xmlStrncmp(insert->name, name, l)))\n+                return(insert->name);\n #endif\n-\t    nbi++;\n-\t}\n+            nbi++;\n+        }\n #ifdef __GNUC__\n-\tif ((insert->okey == okey) && (insert->len == l)) {\n-\t    if (!memcmp(insert->name, name, l))\n-\t\treturn(insert->name);\n-\t}\n+        if ((insert->okey == okey) && (insert->len == l)) {\n+            if (!memcmp(insert->name, name, l))\n+                return(insert->name);\n+        }\n #else\n-\tif ((insert->okey == okey) && (insert->len == l) &&\n-\t    (!xmlStrncmp(insert->name, name, l)))\n-\t    return(insert->name);\n+        if ((insert->okey == okey) && (insert->len == l) && (!xmlStrncmp(insert->name, name, l)))\n+            return(insert->name);\n #endif\n     }\n \n@@ -884,54 +887,51 @@\n \n         /* we cannot always reuse the same okey for the subdict */\n         if (((dict->size == MIN_DICT_SIZE) &&\n-\t     (dict->subdict->size != MIN_DICT_SIZE)) ||\n+            (dict->subdict->size != MIN_DICT_SIZE)) ||\n             ((dict->size != MIN_DICT_SIZE) &&\n-\t     (dict->subdict->size == MIN_DICT_SIZE)))\n-\t    skey = xmlDictComputeKey(dict->subdict, name, l);\n-\telse\n-\t    skey = okey;\n-\n-\tkey = skey % dict->subdict->size;\n-\tif (dict->subdict->dict[key].valid != 0) {\n-\t    xmlDictEntryPtr tmp;\n+            (dict->subdict->size == MIN_DICT_SIZE)))\n+            skey = xmlDictComputeKey(dict->subdict, name, l);\n+        else\n+            skey = okey;\n+\n+        key = skey % dict->subdict->size;\n+        if (dict->subdict->dict[key].valid != 0) {\n+            xmlDictEntryPtr tmp;\n \n-\t    for (tmp = &(dict->subdict->dict[key]); tmp->next != NULL;\n-\t\t tmp = tmp->next) {\n+            for (tmp = &(dict->subdict->dict[key]); tmp->next != NULL; tmp = tmp->next) {\n #ifdef __GNUC__\n-\t\tif ((tmp->okey == skey) && (tmp->len == l)) {\n-\t\t    if (!memcmp(tmp->name, name, l))\n-\t\t\treturn(tmp->name);\n-\t\t}\n+                if ((tmp->okey == skey) && (tmp->len == l)) {\n+                    if (!memcmp(tmp->name, name, l))\n+                        return(tmp->name);\n+                }\n #else\n-\t\tif ((tmp->okey == skey) && (tmp->len == l) &&\n-\t\t    (!xmlStrncmp(tmp->name, name, l)))\n-\t\t    return(tmp->name);\n+                if ((tmp->okey == skey) && (tmp->len == l) && (!xmlStrncmp(tmp->name, name, l)))\n+                    return(tmp->name);\n #endif\n-\t\tnbi++;\n-\t    }\n+                nbi++;\n+            }\n #ifdef __GNUC__\n-\t    if ((tmp->okey == skey) && (tmp->len == l)) {\n-\t\tif (!memcmp(tmp->name, name, l))\n-\t\t    return(tmp->name);\n-\t    }\n+            if ((tmp->okey == skey) && (tmp->len == l)) {\n+                if (!memcmp(tmp->name, name, l))\n+                    return(tmp->name);\n+            }\n #else\n-\t    if ((tmp->okey == skey) && (tmp->len == l) &&\n-\t\t(!xmlStrncmp(tmp->name, name, l)))\n-\t\treturn(tmp->name);\n+            if ((tmp->okey == skey) && (tmp->len == l) && (!xmlStrncmp(tmp->name, name, l)))\n+                return(tmp->name);\n #endif\n-\t}\n-\tkey = okey % dict->size;\n+        }\n+        key = okey % dict->size;\n     }\n \n     ret = xmlDictAddString(dict, name, l);\n     if (ret == NULL)\n         return(NULL);\n     if (insert == NULL) {\n-\tentry = &(dict->dict[key]);\n+        entry = &(dict->dict[key]);\n     } else {\n-\tentry = xmlMalloc(sizeof(xmlDictEntry));\n-\tif (entry == NULL)\n-\t     return(NULL);\n+        entry = xmlMalloc(sizeof(xmlDictEntry));\n+        if (entry == NULL)\n+            return(NULL);\n     }\n     entry->name = ret;\n     entry->len = l;\n@@ -939,22 +939,21 @@\n     entry->valid = 1;\n     entry->okey = okey;\n \n-\n     if (insert != NULL)\n-\tinsert->next = entry;\n+        insert->next = entry;\n \n     dict->nbElems++;\n \n-    if ((nbi > MAX_HASH_LEN) &&\n-        (dict->size <= ((MAX_DICT_HASH / 2) / MAX_HASH_LEN))) {\n-\tif (xmlDictGrow(dict, MAX_HASH_LEN * 2 * dict->size) != 0)\n-\t    return(NULL);\n+    if ((nbi > MAX_HASH_LEN) && (dict->size <= ((MAX_DICT_HASH / 2) / MAX_HASH_LEN))) {\n+        if (xmlDictGrow(dict, MAX_HASH_LEN * 2 * dict->size) != 0)\n+            return(NULL);\n     }\n     /* Note that entry may have been freed at this point by xmlDictGrow */\n \n     return(ret);\n }\n \n+\n /**\n  * xmlDictExists:\n  * @dict: the dictionary\n', 'id': 26, 'location': '/data/vulnloc/libxml2/CVE-2016-1839/src/dict.c:844:5'}, {'diff': '@@ -825,6 +825,7 @@\n  *\n  * Returns the internal copy of the name or NULL in case of internal error\n  */\n+\n const xmlChar *\n xmlDictLookup(xmlDictPtr dict, const xmlChar *name, int len) {\n     unsigned long key, okey, nbi = 0;\n@@ -834,15 +835,17 @@\n     unsigned int l;\n \n     if ((dict == NULL) || (name == NULL))\n-\treturn(NULL);\n+        return(NULL);\n \n     if (len < 0)\n         l = strlen((const char *) name);\n     else\n         l = len;\n \n-    if (((dict->limit > 0) && (l >= dict->limit)) ||\n-        (l > INT_MAX / 2))\n+    if ((dict->limit > 0) && (l >= dict->limit))\n+        return(NULL);\n+\n+    if (l > INT_MAX / 2)\n         return(NULL);\n \n     /*\n@@ -851,31 +854,31 @@\n     okey = xmlDictComputeKey(dict, name, l);\n     key = okey % dict->size;\n     if (dict->dict[key].valid == 0) {\n-\tinsert = NULL;\n+        insert = NULL;\n     } else {\n-\tfor (insert = &(dict->dict[key]); insert->next != NULL;\n-\t     insert = insert->next) {\n+        for (insert = &(dict->dict[key]); insert->next != NULL;\n+             insert = insert->next) {\n #ifdef __GNUC__\n-\t    if ((insert->okey == okey) && (insert->len == l)) {\n-\t\tif (!memcmp(insert->name, name, l))\n-\t\t    return(insert->name);\n-\t    }\n+            if ((insert->okey == okey) && (insert->len == l)) {\n+                if (!memcmp(insert->name, name, l))\n+                    return(insert->name);\n+            }\n #else\n-\t    if ((insert->okey == okey) && (insert->len == l) &&\n-\t        (!xmlStrncmp(insert->name, name, l)))\n-\t\treturn(insert->name);\n+            if ((insert->okey == okey) && (insert->len == l) &&\n+                (!xmlStrncmp(insert->name, name, l)))\n+                return(insert->name);\n #endif\n-\t    nbi++;\n-\t}\n+            nbi++;\n+        }\n #ifdef __GNUC__\n-\tif ((insert->okey == okey) && (insert->len == l)) {\n-\t    if (!memcmp(insert->name, name, l))\n-\t\treturn(insert->name);\n-\t}\n+        if ((insert->okey == okey) && (insert->len == l)) {\n+            if (!memcmp(insert->name, name, l))\n+                return(insert->name);\n+        }\n #else\n-\tif ((insert->okey == okey) && (insert->len == l) &&\n-\t    (!xmlStrncmp(insert->name, name, l)))\n-\t    return(insert->name);\n+        if ((insert->okey == okey) && (insert->len == l) &&\n+            (!xmlStrncmp(insert->name, name, l)))\n+            return(insert->name);\n #endif\n     }\n \n@@ -884,54 +887,54 @@\n \n         /* we cannot always reuse the same okey for the subdict */\n         if (((dict->size == MIN_DICT_SIZE) &&\n-\t     (dict->subdict->size != MIN_DICT_SIZE)) ||\n+             (dict->subdict->size != MIN_DICT_SIZE)) ||\n             ((dict->size != MIN_DICT_SIZE) &&\n-\t     (dict->subdict->size == MIN_DICT_SIZE)))\n-\t    skey = xmlDictComputeKey(dict->subdict, name, l);\n-\telse\n-\t    skey = okey;\n-\n-\tkey = skey % dict->subdict->size;\n-\tif (dict->subdict->dict[key].valid != 0) {\n-\t    xmlDictEntryPtr tmp;\n+             (dict->subdict->size == MIN_DICT_SIZE)))\n+            skey = xmlDictComputeKey(dict->subdict, name, l);\n+        else\n+            skey = okey;\n+\n+        key = skey % dict->subdict->size;\n+        if (dict->subdict->dict[key].valid != 0) {\n+            xmlDictEntryPtr tmp;\n \n-\t    for (tmp = &(dict->subdict->dict[key]); tmp->next != NULL;\n-\t\t tmp = tmp->next) {\n+            for (tmp = &(dict->subdict->dict[key]); tmp->next != NULL;\n+                 tmp = tmp->next) {\n #ifdef __GNUC__\n-\t\tif ((tmp->okey == skey) && (tmp->len == l)) {\n-\t\t    if (!memcmp(tmp->name, name, l))\n-\t\t\treturn(tmp->name);\n-\t\t}\n+                if ((tmp->okey == skey) && (tmp->len == l)) {\n+                    if (!memcmp(tmp->name, name, l))\n+                        return(tmp->name);\n+                }\n #else\n-\t\tif ((tmp->okey == skey) && (tmp->len == l) &&\n-\t\t    (!xmlStrncmp(tmp->name, name, l)))\n-\t\t    return(tmp->name);\n+                if ((tmp->okey == skey) && (tmp->len == l) &&\n+                    (!xmlStrncmp(tmp->name, name, l)))\n+                    return(tmp->name);\n #endif\n-\t\tnbi++;\n-\t    }\n+                nbi++;\n+            }\n #ifdef __GNUC__\n-\t    if ((tmp->okey == skey) && (tmp->len == l)) {\n-\t\tif (!memcmp(tmp->name, name, l))\n-\t\t    return(tmp->name);\n-\t    }\n+            if ((tmp->okey == skey) && (tmp->len == l)) {\n+                if (!memcmp(tmp->name, name, l))\n+                    return(tmp->name);\n+            }\n #else\n-\t    if ((tmp->okey == skey) && (tmp->len == l) &&\n-\t\t(!xmlStrncmp(tmp->name, name, l)))\n-\t\treturn(tmp->name);\n+            if ((tmp->okey == skey) && (tmp->len == l) &&\n+                (!xmlStrncmp(tmp->name, name, l)))\n+                return(tmp->name);\n #endif\n-\t}\n-\tkey = okey % dict->size;\n+        }\n+        key = okey % dict->size;\n     }\n \n     ret = xmlDictAddString(dict, name, l);\n     if (ret == NULL)\n         return(NULL);\n     if (insert == NULL) {\n-\tentry = &(dict->dict[key]);\n+        entry = &(dict->dict[key]);\n     } else {\n-\tentry = xmlMalloc(sizeof(xmlDictEntry));\n-\tif (entry == NULL)\n-\t     return(NULL);\n+        entry = xmlMalloc(sizeof(xmlDictEntry));\n+        if (entry == NULL)\n+             return(NULL);\n     }\n     entry->name = ret;\n     entry->len = l;\n@@ -939,22 +942,22 @@\n     entry->valid = 1;\n     entry->okey = okey;\n \n-\n     if (insert != NULL)\n-\tinsert->next = entry;\n+        insert->next = entry;\n \n     dict->nbElems++;\n \n     if ((nbi > MAX_HASH_LEN) &&\n         (dict->size <= ((MAX_DICT_HASH / 2) / MAX_HASH_LEN))) {\n-\tif (xmlDictGrow(dict, MAX_HASH_LEN * 2 * dict->size) != 0)\n-\t    return(NULL);\n+        if (xmlDictGrow(dict, MAX_HASH_LEN * 2 * dict->size) != 0)\n+            return(NULL);\n     }\n     /* Note that entry may have been freed at this point by xmlDictGrow */\n \n     return(ret);\n }\n \n+\n /**\n  * xmlDictExists:\n  * @dict: the dictionary\n', 'id': 27, 'location': '/data/vulnloc/libxml2/CVE-2016-1839/src/dict.c:844:5'}, {'diff': '@@ -825,6 +825,7 @@\n  *\n  * Returns the internal copy of the name or NULL in case of internal error\n  */\n+\n const xmlChar *\n xmlDictLookup(xmlDictPtr dict, const xmlChar *name, int len) {\n     unsigned long key, okey, nbi = 0;\n@@ -834,16 +835,17 @@\n     unsigned int l;\n \n     if ((dict == NULL) || (name == NULL))\n-\treturn(NULL);\n+        return(NULL);\n \n     if (len < 0)\n         l = strlen((const char *) name);\n     else\n         l = len;\n \n-    if (((dict->limit > 0) && (l >= dict->limit)) ||\n-        (l > INT_MAX / 2))\n-        return(NULL);\n+    if (((dict->limit > 0) && (l >= dict->limit)) || (l > INT_MAX / 2)) {\n+        // Sanitize the length to prevent buffer overflows\n+        l = dict->limit > 0 ? dict->limit - 1 : INT_MAX / 2;\n+    }\n \n     /*\n      * Check for duplicate and insertion location.\n@@ -851,31 +853,31 @@\n     okey = xmlDictComputeKey(dict, name, l);\n     key = okey % dict->size;\n     if (dict->dict[key].valid == 0) {\n-\tinsert = NULL;\n+        insert = NULL;\n     } else {\n-\tfor (insert = &(dict->dict[key]); insert->next != NULL;\n-\t     insert = insert->next) {\n+        for (insert = &(dict->dict[key]); insert->next != NULL;\n+             insert = insert->next) {\n #ifdef __GNUC__\n-\t    if ((insert->okey == okey) && (insert->len == l)) {\n-\t\tif (!memcmp(insert->name, name, l))\n-\t\t    return(insert->name);\n-\t    }\n+            if ((insert->okey == okey) && (insert->len == l)) {\n+                if (!memcmp(insert->name, name, l))\n+                    return(insert->name);\n+            }\n #else\n-\t    if ((insert->okey == okey) && (insert->len == l) &&\n-\t        (!xmlStrncmp(insert->name, name, l)))\n-\t\treturn(insert->name);\n+            if ((insert->okey == okey) && (insert->len == l) &&\n+                (!xmlStrncmp(insert->name, name, l)))\n+                return(insert->name);\n #endif\n-\t    nbi++;\n-\t}\n+            nbi++;\n+        }\n #ifdef __GNUC__\n-\tif ((insert->okey == okey) && (insert->len == l)) {\n-\t    if (!memcmp(insert->name, name, l))\n-\t\treturn(insert->name);\n-\t}\n+        if ((insert->okey == okey) && (insert->len == l)) {\n+            if (!memcmp(insert->name, name, l))\n+                return(insert->name);\n+        }\n #else\n-\tif ((insert->okey == okey) && (insert->len == l) &&\n-\t    (!xmlStrncmp(insert->name, name, l)))\n-\t    return(insert->name);\n+        if ((insert->okey == okey) && (insert->len == l) &&\n+            (!xmlStrncmp(insert->name, name, l)))\n+            return(insert->name);\n #endif\n     }\n \n@@ -884,54 +886,54 @@\n \n         /* we cannot always reuse the same okey for the subdict */\n         if (((dict->size == MIN_DICT_SIZE) &&\n-\t     (dict->subdict->size != MIN_DICT_SIZE)) ||\n+            (dict->subdict->size != MIN_DICT_SIZE)) ||\n             ((dict->size != MIN_DICT_SIZE) &&\n-\t     (dict->subdict->size == MIN_DICT_SIZE)))\n-\t    skey = xmlDictComputeKey(dict->subdict, name, l);\n-\telse\n-\t    skey = okey;\n-\n-\tkey = skey % dict->subdict->size;\n-\tif (dict->subdict->dict[key].valid != 0) {\n-\t    xmlDictEntryPtr tmp;\n+            (dict->subdict->size == MIN_DICT_SIZE)))\n+            skey = xmlDictComputeKey(dict->subdict, name, l);\n+        else\n+            skey = okey;\n+\n+        key = skey % dict->subdict->size;\n+        if (dict->subdict->dict[key].valid != 0) {\n+            xmlDictEntryPtr tmp;\n \n-\t    for (tmp = &(dict->subdict->dict[key]); tmp->next != NULL;\n-\t\t tmp = tmp->next) {\n+            for (tmp = &(dict->subdict->dict[key]); tmp->next != NULL;\n+                 tmp = tmp->next) {\n #ifdef __GNUC__\n-\t\tif ((tmp->okey == skey) && (tmp->len == l)) {\n-\t\t    if (!memcmp(tmp->name, name, l))\n-\t\t\treturn(tmp->name);\n-\t\t}\n+                if ((tmp->okey == skey) && (tmp->len == l)) {\n+                    if (!memcmp(tmp->name, name, l))\n+                        return(tmp->name);\n+                }\n #else\n-\t\tif ((tmp->okey == skey) && (tmp->len == l) &&\n-\t\t    (!xmlStrncmp(tmp->name, name, l)))\n-\t\t    return(tmp->name);\n+                if ((tmp->okey == skey) && (tmp->len == l) &&\n+                    (!xmlStrncmp(tmp->name, name, l)))\n+                    return(tmp->name);\n #endif\n-\t\tnbi++;\n-\t    }\n+                nbi++;\n+            }\n #ifdef __GNUC__\n-\t    if ((tmp->okey == skey) && (tmp->len == l)) {\n-\t\tif (!memcmp(tmp->name, name, l))\n-\t\t    return(tmp->name);\n-\t    }\n+            if ((tmp->okey == skey) && (tmp->len == l)) {\n+                if (!memcmp(tmp->name, name, l))\n+                    return(tmp->name);\n+            }\n #else\n-\t    if ((tmp->okey == skey) && (tmp->len == l) &&\n-\t\t(!xmlStrncmp(tmp->name, name, l)))\n-\t\treturn(tmp->name);\n+            if ((tmp->okey == skey) && (tmp->len == l) &&\n+                (!xmlStrncmp(tmp->name, name, l)))\n+                return(tmp->name);\n #endif\n-\t}\n-\tkey = okey % dict->size;\n+        }\n+        key = okey % dict->size;\n     }\n \n     ret = xmlDictAddString(dict, name, l);\n     if (ret == NULL)\n         return(NULL);\n     if (insert == NULL) {\n-\tentry = &(dict->dict[key]);\n+        entry = &(dict->dict[key]);\n     } else {\n-\tentry = xmlMalloc(sizeof(xmlDictEntry));\n-\tif (entry == NULL)\n-\t     return(NULL);\n+        entry = xmlMalloc(sizeof(xmlDictEntry));\n+        if (entry == NULL)\n+            return(NULL);\n     }\n     entry->name = ret;\n     entry->len = l;\n@@ -939,22 +941,22 @@\n     entry->valid = 1;\n     entry->okey = okey;\n \n-\n     if (insert != NULL)\n-\tinsert->next = entry;\n+        insert->next = entry;\n \n     dict->nbElems++;\n \n     if ((nbi > MAX_HASH_LEN) &&\n         (dict->size <= ((MAX_DICT_HASH / 2) / MAX_HASH_LEN))) {\n-\tif (xmlDictGrow(dict, MAX_HASH_LEN * 2 * dict->size) != 0)\n-\t    return(NULL);\n+        if (xmlDictGrow(dict, MAX_HASH_LEN * 2 * dict->size) != 0)\n+            return(NULL);\n     }\n     /* Note that entry may have been freed at this point by xmlDictGrow */\n \n     return(ret);\n }\n \n+\n /**\n  * xmlDictExists:\n  * @dict: the dictionary\n', 'id': 28, 'location': '/data/vulnloc/libxml2/CVE-2016-1839/src/dict.c:844:5'}, {'diff': '@@ -825,6 +825,7 @@\n  *\n  * Returns the internal copy of the name or NULL in case of internal error\n  */\n+\n const xmlChar *\n xmlDictLookup(xmlDictPtr dict, const xmlChar *name, int len) {\n     unsigned long key, okey, nbi = 0;\n@@ -834,16 +835,17 @@\n     unsigned int l;\n \n     if ((dict == NULL) || (name == NULL))\n-\treturn(NULL);\n+        return(NULL);\n \n-    if (len < 0)\n+    if (len < 0) {\n         l = strlen((const char *) name);\n-    else\n+    } else {\n         l = len;\n+    }\n \n-    if (((dict->limit > 0) && (l >= dict->limit)) ||\n-        (l > INT_MAX / 2))\n+    if ((dict->limit > 0 && l >= dict->limit) || (len < 0 && l > INT_MAX / 2)) {\n         return(NULL);\n+    }\n \n     /*\n      * Check for duplicate and insertion location.\n@@ -851,31 +853,28 @@\n     okey = xmlDictComputeKey(dict, name, l);\n     key = okey % dict->size;\n     if (dict->dict[key].valid == 0) {\n-\tinsert = NULL;\n+        insert = NULL;\n     } else {\n-\tfor (insert = &(dict->dict[key]); insert->next != NULL;\n-\t     insert = insert->next) {\n+        for (insert = &(dict->dict[key]); insert->next != NULL; insert = insert->next) {\n #ifdef __GNUC__\n-\t    if ((insert->okey == okey) && (insert->len == l)) {\n-\t\tif (!memcmp(insert->name, name, l))\n-\t\t    return(insert->name);\n-\t    }\n+            if ((insert->okey == okey) && (insert->len == l)) {\n+                if (!memcmp(insert->name, name, l))\n+                    return(insert->name);\n+            }\n #else\n-\t    if ((insert->okey == okey) && (insert->len == l) &&\n-\t        (!xmlStrncmp(insert->name, name, l)))\n-\t\treturn(insert->name);\n+            if ((insert->okey == okey) && (insert->len == l) && (!xmlStrncmp(insert->name, name, l)))\n+                return(insert->name);\n #endif\n-\t    nbi++;\n-\t}\n+            nbi++;\n+        }\n #ifdef __GNUC__\n-\tif ((insert->okey == okey) && (insert->len == l)) {\n-\t    if (!memcmp(insert->name, name, l))\n-\t\treturn(insert->name);\n-\t}\n+        if ((insert->okey == okey) && (insert->len == l)) {\n+            if (!memcmp(insert->name, name, l))\n+                return(insert->name);\n+        }\n #else\n-\tif ((insert->okey == okey) && (insert->len == l) &&\n-\t    (!xmlStrncmp(insert->name, name, l)))\n-\t    return(insert->name);\n+        if ((insert->okey == okey) && (insert->len == l) && (!xmlStrncmp(insert->name, name, l)))\n+            return(insert->name);\n #endif\n     }\n \n@@ -883,55 +882,50 @@\n         unsigned long skey;\n \n         /* we cannot always reuse the same okey for the subdict */\n-        if (((dict->size == MIN_DICT_SIZE) &&\n-\t     (dict->subdict->size != MIN_DICT_SIZE)) ||\n-            ((dict->size != MIN_DICT_SIZE) &&\n-\t     (dict->subdict->size == MIN_DICT_SIZE)))\n-\t    skey = xmlDictComputeKey(dict->subdict, name, l);\n-\telse\n-\t    skey = okey;\n-\n-\tkey = skey % dict->subdict->size;\n-\tif (dict->subdict->dict[key].valid != 0) {\n-\t    xmlDictEntryPtr tmp;\n+        if (((dict->size == MIN_DICT_SIZE) && (dict->subdict->size != MIN_DICT_SIZE)) ||\n+            ((dict->size != MIN_DICT_SIZE) && (dict->subdict->size == MIN_DICT_SIZE)))\n+            skey = xmlDictComputeKey(dict->subdict, name, l);\n+        else\n+            skey = okey;\n+\n+        key = skey % dict->subdict->size;\n+        if (dict->subdict->dict[key].valid != 0) {\n+            xmlDictEntryPtr tmp;\n \n-\t    for (tmp = &(dict->subdict->dict[key]); tmp->next != NULL;\n-\t\t tmp = tmp->next) {\n+            for (tmp = &(dict->subdict->dict[key]); tmp->next != NULL; tmp = tmp->next) {\n #ifdef __GNUC__\n-\t\tif ((tmp->okey == skey) && (tmp->len == l)) {\n-\t\t    if (!memcmp(tmp->name, name, l))\n-\t\t\treturn(tmp->name);\n-\t\t}\n+                if ((tmp->okey == skey) && (tmp->len == l)) {\n+                    if (!memcmp(tmp->name, name, l))\n+                        return(tmp->name);\n+                }\n #else\n-\t\tif ((tmp->okey == skey) && (tmp->len == l) &&\n-\t\t    (!xmlStrncmp(tmp->name, name, l)))\n-\t\t    return(tmp->name);\n+                if ((tmp->okey == skey) && (tmp->len == l) && (!xmlStrncmp(tmp->name, name, l)))\n+                    return(tmp->name);\n #endif\n-\t\tnbi++;\n-\t    }\n+                nbi++;\n+            }\n #ifdef __GNUC__\n-\t    if ((tmp->okey == skey) && (tmp->len == l)) {\n-\t\tif (!memcmp(tmp->name, name, l))\n-\t\t    return(tmp->name);\n-\t    }\n+            if ((tmp->okey == skey) && (tmp->len == l)) {\n+                if (!memcmp(tmp->name, name, l))\n+                    return(tmp->name);\n+            }\n #else\n-\t    if ((tmp->okey == skey) && (tmp->len == l) &&\n-\t\t(!xmlStrncmp(tmp->name, name, l)))\n-\t\treturn(tmp->name);\n+            if ((tmp->okey == skey) && (tmp->len == l) && (!xmlStrncmp(tmp->name, name, l)))\n+                return(tmp->name);\n #endif\n-\t}\n-\tkey = okey % dict->size;\n+        }\n+        key = okey % dict->size;\n     }\n \n     ret = xmlDictAddString(dict, name, l);\n     if (ret == NULL)\n         return(NULL);\n     if (insert == NULL) {\n-\tentry = &(dict->dict[key]);\n+        entry = &(dict->dict[key]);\n     } else {\n-\tentry = xmlMalloc(sizeof(xmlDictEntry));\n-\tif (entry == NULL)\n-\t     return(NULL);\n+        entry = xmlMalloc(sizeof(xmlDictEntry));\n+        if (entry == NULL)\n+            return(NULL);\n     }\n     entry->name = ret;\n     entry->len = l;\n@@ -939,22 +933,21 @@\n     entry->valid = 1;\n     entry->okey = okey;\n \n-\n     if (insert != NULL)\n-\tinsert->next = entry;\n+        insert->next = entry;\n \n     dict->nbElems++;\n \n-    if ((nbi > MAX_HASH_LEN) &&\n-        (dict->size <= ((MAX_DICT_HASH / 2) / MAX_HASH_LEN))) {\n-\tif (xmlDictGrow(dict, MAX_HASH_LEN * 2 * dict->size) != 0)\n-\t    return(NULL);\n+    if ((nbi > MAX_HASH_LEN) && (dict->size <= ((MAX_DICT_HASH / 2) / MAX_HASH_LEN))) {\n+        if (xmlDictGrow(dict, MAX_HASH_LEN * 2 * dict->size) != 0)\n+            return(NULL);\n     }\n     /* Note that entry may have been freed at this point by xmlDictGrow */\n \n     return(ret);\n }\n \n+\n /**\n  * xmlDictExists:\n  * @dict: the dictionary\n', 'id': 29, 'location': '/data/vulnloc/libxml2/CVE-2016-1839/src/dict.c:844:5'}, {'diff': '@@ -825,6 +825,7 @@\n  *\n  * Returns the internal copy of the name or NULL in case of internal error\n  */\n+\n const xmlChar *\n xmlDictLookup(xmlDictPtr dict, const xmlChar *name, int len) {\n     unsigned long key, okey, nbi = 0;\n@@ -834,16 +835,17 @@\n     unsigned int l;\n \n     if ((dict == NULL) || (name == NULL))\n-\treturn(NULL);\n+        return(NULL);\n \n-    if (len < 0)\n+    if (len < 0) {\n         l = strlen((const char *) name);\n-    else\n+        if (l >= dict->limit || l > INT_MAX / 2)\n+            return(NULL);\n+    } else {\n         l = len;\n-\n-    if (((dict->limit > 0) && (l >= dict->limit)) ||\n-        (l > INT_MAX / 2))\n-        return(NULL);\n+        if (l >= dict->limit || l > INT_MAX / 2)\n+            return(NULL);\n+    }\n \n     /*\n      * Check for duplicate and insertion location.\n@@ -851,31 +853,31 @@\n     okey = xmlDictComputeKey(dict, name, l);\n     key = okey % dict->size;\n     if (dict->dict[key].valid == 0) {\n-\tinsert = NULL;\n+        insert = NULL;\n     } else {\n-\tfor (insert = &(dict->dict[key]); insert->next != NULL;\n-\t     insert = insert->next) {\n+        for (insert = &(dict->dict[key]); insert->next != NULL;\n+             insert = insert->next) {\n #ifdef __GNUC__\n-\t    if ((insert->okey == okey) && (insert->len == l)) {\n-\t\tif (!memcmp(insert->name, name, l))\n-\t\t    return(insert->name);\n-\t    }\n+            if ((insert->okey == okey) && (insert->len == l)) {\n+                if (!memcmp(insert->name, name, l))\n+                    return(insert->name);\n+            }\n #else\n-\t    if ((insert->okey == okey) && (insert->len == l) &&\n-\t        (!xmlStrncmp(insert->name, name, l)))\n-\t\treturn(insert->name);\n+            if ((insert->okey == okey) && (insert->len == l) &&\n+                (!xmlStrncmp(insert->name, name, l)))\n+                return(insert->name);\n #endif\n-\t    nbi++;\n-\t}\n+            nbi++;\n+        }\n #ifdef __GNUC__\n-\tif ((insert->okey == okey) && (insert->len == l)) {\n-\t    if (!memcmp(insert->name, name, l))\n-\t\treturn(insert->name);\n-\t}\n+        if ((insert->okey == okey) && (insert->len == l)) {\n+            if (!memcmp(insert->name, name, l))\n+                return(insert->name);\n+        }\n #else\n-\tif ((insert->okey == okey) && (insert->len == l) &&\n-\t    (!xmlStrncmp(insert->name, name, l)))\n-\t    return(insert->name);\n+        if ((insert->okey == okey) && (insert->len == l) &&\n+            (!xmlStrncmp(insert->name, name, l)))\n+            return(insert->name);\n #endif\n     }\n \n@@ -884,54 +886,54 @@\n \n         /* we cannot always reuse the same okey for the subdict */\n         if (((dict->size == MIN_DICT_SIZE) &&\n-\t     (dict->subdict->size != MIN_DICT_SIZE)) ||\n+             (dict->subdict->size != MIN_DICT_SIZE)) ||\n             ((dict->size != MIN_DICT_SIZE) &&\n-\t     (dict->subdict->size == MIN_DICT_SIZE)))\n-\t    skey = xmlDictComputeKey(dict->subdict, name, l);\n-\telse\n-\t    skey = okey;\n-\n-\tkey = skey % dict->subdict->size;\n-\tif (dict->subdict->dict[key].valid != 0) {\n-\t    xmlDictEntryPtr tmp;\n+             (dict->subdict->size == MIN_DICT_SIZE)))\n+            skey = xmlDictComputeKey(dict->subdict, name, l);\n+        else\n+            skey = okey;\n+\n+        key = skey % dict->subdict->size;\n+        if (dict->subdict->dict[key].valid != 0) {\n+            xmlDictEntryPtr tmp;\n \n-\t    for (tmp = &(dict->subdict->dict[key]); tmp->next != NULL;\n-\t\t tmp = tmp->next) {\n+            for (tmp = &(dict->subdict->dict[key]); tmp->next != NULL;\n+                 tmp = tmp->next) {\n #ifdef __GNUC__\n-\t\tif ((tmp->okey == skey) && (tmp->len == l)) {\n-\t\t    if (!memcmp(tmp->name, name, l))\n-\t\t\treturn(tmp->name);\n-\t\t}\n+                if ((tmp->okey == skey) && (tmp->len == l)) {\n+                    if (!memcmp(tmp->name, name, l))\n+                        return(tmp->name);\n+                }\n #else\n-\t\tif ((tmp->okey == skey) && (tmp->len == l) &&\n-\t\t    (!xmlStrncmp(tmp->name, name, l)))\n-\t\t    return(tmp->name);\n+                if ((tmp->okey == skey) && (tmp->len == l) &&\n+                    (!xmlStrncmp(tmp->name, name, l)))\n+                    return(tmp->name);\n #endif\n-\t\tnbi++;\n-\t    }\n+                nbi++;\n+            }\n #ifdef __GNUC__\n-\t    if ((tmp->okey == skey) && (tmp->len == l)) {\n-\t\tif (!memcmp(tmp->name, name, l))\n-\t\t    return(tmp->name);\n-\t    }\n+            if ((tmp->okey == skey) && (tmp->len == l)) {\n+                if (!memcmp(tmp->name, name, l))\n+                    return(tmp->name);\n+            }\n #else\n-\t    if ((tmp->okey == skey) && (tmp->len == l) &&\n-\t\t(!xmlStrncmp(tmp->name, name, l)))\n-\t\treturn(tmp->name);\n+            if ((tmp->okey == skey) && (tmp->len == l) &&\n+                (!xmlStrncmp(tmp->name, name, l)))\n+                return(tmp->name);\n #endif\n-\t}\n-\tkey = okey % dict->size;\n+        }\n+        key = okey % dict->size;\n     }\n \n     ret = xmlDictAddString(dict, name, l);\n     if (ret == NULL)\n         return(NULL);\n     if (insert == NULL) {\n-\tentry = &(dict->dict[key]);\n+        entry = &(dict->dict[key]);\n     } else {\n-\tentry = xmlMalloc(sizeof(xmlDictEntry));\n-\tif (entry == NULL)\n-\t     return(NULL);\n+        entry = xmlMalloc(sizeof(xmlDictEntry));\n+        if (entry == NULL)\n+            return(NULL);\n     }\n     entry->name = ret;\n     entry->len = l;\n@@ -941,20 +943,21 @@\n \n \n     if (insert != NULL)\n-\tinsert->next = entry;\n+        insert->next = entry;\n \n     dict->nbElems++;\n \n     if ((nbi > MAX_HASH_LEN) &&\n         (dict->size <= ((MAX_DICT_HASH / 2) / MAX_HASH_LEN))) {\n-\tif (xmlDictGrow(dict, MAX_HASH_LEN * 2 * dict->size) != 0)\n-\t    return(NULL);\n+        if (xmlDictGrow(dict, MAX_HASH_LEN * 2 * dict->size) != 0)\n+            return(NULL);\n     }\n     /* Note that entry may have been freed at this point by xmlDictGrow */\n \n     return(ret);\n }\n \n+\n /**\n  * xmlDictExists:\n  * @dict: the dictionary\n', 'id': 30, 'location': '/data/vulnloc/libxml2/CVE-2016-1839/src/dict.c:842:9'}, {'diff': '@@ -825,6 +825,7 @@\n  *\n  * Returns the internal copy of the name or NULL in case of internal error\n  */\n+\n const xmlChar *\n xmlDictLookup(xmlDictPtr dict, const xmlChar *name, int len) {\n     unsigned long key, okey, nbi = 0;\n@@ -834,16 +835,17 @@\n     unsigned int l;\n \n     if ((dict == NULL) || (name == NULL))\n-\treturn(NULL);\n+        return(NULL);\n \n-    if (len < 0)\n+    if (len < 0) {\n         l = strlen((const char *) name);\n-    else\n+        if (l >= dict->limit || l > INT_MAX / 2)  // Added limit check\n+            return(NULL);\n+    } else {\n         l = len;\n-\n-    if (((dict->limit > 0) && (l >= dict->limit)) ||\n-        (l > INT_MAX / 2))\n-        return(NULL);\n+        if (l >= dict->limit || l > INT_MAX / 2)  // Added limit check\n+            return(NULL);\n+    }\n \n     /*\n      * Check for duplicate and insertion location.\n@@ -851,31 +853,30 @@\n     okey = xmlDictComputeKey(dict, name, l);\n     key = okey % dict->size;\n     if (dict->dict[key].valid == 0) {\n-\tinsert = NULL;\n+        insert = NULL;\n     } else {\n-\tfor (insert = &(dict->dict[key]); insert->next != NULL;\n-\t     insert = insert->next) {\n+        for (insert = &(dict->dict[key]); insert->next != NULL; insert = insert->next) {\n #ifdef __GNUC__\n-\t    if ((insert->okey == okey) && (insert->len == l)) {\n-\t\tif (!memcmp(insert->name, name, l))\n-\t\t    return(insert->name);\n-\t    }\n+            if ((insert->okey == okey) && (insert->len == l)) {\n+                if (!memcmp(insert->name, name, l))\n+                    return(insert->name);\n+            }\n #else\n-\t    if ((insert->okey == okey) && (insert->len == l) &&\n-\t        (!xmlStrncmp(insert->name, name, l)))\n-\t\treturn(insert->name);\n+            if ((insert->okey == okey) && (insert->len == l) &&\n+                (!xmlStrncmp(insert->name, name, l)))\n+                return(insert->name);\n #endif\n-\t    nbi++;\n-\t}\n+            nbi++;\n+        }\n #ifdef __GNUC__\n-\tif ((insert->okey == okey) && (insert->len == l)) {\n-\t    if (!memcmp(insert->name, name, l))\n-\t\treturn(insert->name);\n-\t}\n+        if ((insert->okey == okey) && (insert->len == l)) {\n+            if (!memcmp(insert->name, name, l))\n+                return(insert->name);\n+        }\n #else\n-\tif ((insert->okey == okey) && (insert->len == l) &&\n-\t    (!xmlStrncmp(insert->name, name, l)))\n-\t    return(insert->name);\n+        if ((insert->okey == okey) && (insert->len == l) &&\n+            (!xmlStrncmp(insert->name, name, l)))\n+            return(insert->name);\n #endif\n     }\n \n@@ -883,55 +884,52 @@\n         unsigned long skey;\n \n         /* we cannot always reuse the same okey for the subdict */\n-        if (((dict->size == MIN_DICT_SIZE) &&\n-\t     (dict->subdict->size != MIN_DICT_SIZE)) ||\n-            ((dict->size != MIN_DICT_SIZE) &&\n-\t     (dict->subdict->size == MIN_DICT_SIZE)))\n-\t    skey = xmlDictComputeKey(dict->subdict, name, l);\n-\telse\n-\t    skey = okey;\n-\n-\tkey = skey % dict->subdict->size;\n-\tif (dict->subdict->dict[key].valid != 0) {\n-\t    xmlDictEntryPtr tmp;\n+        if (((dict->size == MIN_DICT_SIZE) && (dict->subdict->size != MIN_DICT_SIZE)) ||\n+            ((dict->size != MIN_DICT_SIZE) && (dict->subdict->size == MIN_DICT_SIZE)))\n+            skey = xmlDictComputeKey(dict->subdict, name, l);\n+        else\n+            skey = okey;\n+\n+        key = skey % dict->subdict->size;\n+        if (dict->subdict->dict[key].valid != 0) {\n+            xmlDictEntryPtr tmp;\n \n-\t    for (tmp = &(dict->subdict->dict[key]); tmp->next != NULL;\n-\t\t tmp = tmp->next) {\n+            for (tmp = &(dict->subdict->dict[key]); tmp->next != NULL; tmp = tmp->next) {\n #ifdef __GNUC__\n-\t\tif ((tmp->okey == skey) && (tmp->len == l)) {\n-\t\t    if (!memcmp(tmp->name, name, l))\n-\t\t\treturn(tmp->name);\n-\t\t}\n+                if ((tmp->okey == skey) && (tmp->len == l)) {\n+                    if (!memcmp(tmp->name, name, l))\n+                        return(tmp->name);\n+                }\n #else\n-\t\tif ((tmp->okey == skey) && (tmp->len == l) &&\n-\t\t    (!xmlStrncmp(tmp->name, name, l)))\n-\t\t    return(tmp->name);\n+                if ((tmp->okey == skey) && (tmp->len == l) &&\n+                    (!xmlStrncmp(tmp->name, name, l)))\n+                    return(tmp->name);\n #endif\n-\t\tnbi++;\n-\t    }\n+                nbi++;\n+            }\n #ifdef __GNUC__\n-\t    if ((tmp->okey == skey) && (tmp->len == l)) {\n-\t\tif (!memcmp(tmp->name, name, l))\n-\t\t    return(tmp->name);\n-\t    }\n+            if ((tmp->okey == skey) && (tmp->len == l)) {\n+                if (!memcmp(tmp->name, name, l))\n+                    return(tmp->name);\n+            }\n #else\n-\t    if ((tmp->okey == skey) && (tmp->len == l) &&\n-\t\t(!xmlStrncmp(tmp->name, name, l)))\n-\t\treturn(tmp->name);\n+            if ((tmp->okey == skey) && (tmp->len == l) &&\n+                (!xmlStrncmp(tmp->name, name, l)))\n+                return(tmp->name);\n #endif\n-\t}\n-\tkey = okey % dict->size;\n+        }\n+        key = okey % dict->size;\n     }\n \n     ret = xmlDictAddString(dict, name, l);\n     if (ret == NULL)\n         return(NULL);\n     if (insert == NULL) {\n-\tentry = &(dict->dict[key]);\n+        entry = &(dict->dict[key]);\n     } else {\n-\tentry = xmlMalloc(sizeof(xmlDictEntry));\n-\tif (entry == NULL)\n-\t     return(NULL);\n+        entry = xmlMalloc(sizeof(xmlDictEntry));\n+        if (entry == NULL)\n+             return(NULL);\n     }\n     entry->name = ret;\n     entry->len = l;\n@@ -939,22 +937,22 @@\n     entry->valid = 1;\n     entry->okey = okey;\n \n-\n     if (insert != NULL)\n-\tinsert->next = entry;\n+        insert->next = entry;\n \n     dict->nbElems++;\n \n     if ((nbi > MAX_HASH_LEN) &&\n         (dict->size <= ((MAX_DICT_HASH / 2) / MAX_HASH_LEN))) {\n-\tif (xmlDictGrow(dict, MAX_HASH_LEN * 2 * dict->size) != 0)\n-\t    return(NULL);\n+        if (xmlDictGrow(dict, MAX_HASH_LEN * 2 * dict->size) != 0)\n+            return(NULL);\n     }\n     /* Note that entry may have been freed at this point by xmlDictGrow */\n \n     return(ret);\n }\n \n+\n /**\n  * xmlDictExists:\n  * @dict: the dictionary\n', 'id': 31, 'location': '/data/vulnloc/libxml2/CVE-2016-1839/src/dict.c:842:9'}, {'diff': '@@ -825,6 +825,7 @@\n  *\n  * Returns the internal copy of the name or NULL in case of internal error\n  */\n+\n const xmlChar *\n xmlDictLookup(xmlDictPtr dict, const xmlChar *name, int len) {\n     unsigned long key, okey, nbi = 0;\n@@ -836,10 +837,15 @@\n     if ((dict == NULL) || (name == NULL))\n \treturn(NULL);\n \n-    if (len < 0)\n+    if (len < 0) {\n         l = strlen((const char *) name);\n-    else\n+        if (l >= dict->limit)\n+            return(NULL); // Validate length against limit\n+    } else {\n         l = len;\n+        if (l >= dict->limit)\n+            return(NULL); // Validate length against limit\n+    }\n \n     if (((dict->limit > 0) && (l >= dict->limit)) ||\n         (l > INT_MAX / 2))\n@@ -955,6 +961,7 @@\n     return(ret);\n }\n \n+\n /**\n  * xmlDictExists:\n  * @dict: the dictionary\n', 'id': 32, 'location': '/data/vulnloc/libxml2/CVE-2016-1839/src/dict.c:842:9'}, {'diff': '@@ -825,6 +825,7 @@\n  *\n  * Returns the internal copy of the name or NULL in case of internal error\n  */\n+\n const xmlChar *\n xmlDictLookup(xmlDictPtr dict, const xmlChar *name, int len) {\n     unsigned long key, okey, nbi = 0;\n@@ -836,10 +837,15 @@\n     if ((dict == NULL) || (name == NULL))\n \treturn(NULL);\n \n-    if (len < 0)\n+    if (len < 0) {\n         l = strlen((const char *) name);\n-    else\n+        if (l < 0 || l >= dict->limit) // Check for invalid length\n+            return(NULL);\n+    } else {\n         l = len;\n+        if (l >= dict->limit) // Check for invalid length\n+            return(NULL);\n+    }\n \n     if (((dict->limit > 0) && (l >= dict->limit)) ||\n         (l > INT_MAX / 2))\n@@ -939,7 +945,6 @@\n     entry->valid = 1;\n     entry->okey = okey;\n \n-\n     if (insert != NULL)\n \tinsert->next = entry;\n \n@@ -955,6 +960,7 @@\n     return(ret);\n }\n \n+\n /**\n  * xmlDictExists:\n  * @dict: the dictionary\n', 'id': 33, 'location': '/data/vulnloc/libxml2/CVE-2016-1839/src/dict.c:842:9'}, {'diff': '@@ -825,6 +825,7 @@\n  *\n  * Returns the internal copy of the name or NULL in case of internal error\n  */\n+\n const xmlChar *\n xmlDictLookup(xmlDictPtr dict, const xmlChar *name, int len) {\n     unsigned long key, okey, nbi = 0;\n@@ -834,12 +835,17 @@\n     unsigned int l;\n \n     if ((dict == NULL) || (name == NULL))\n-\treturn(NULL);\n+        return(NULL);\n \n-    if (len < 0)\n+    if (len < 0) {\n         l = strlen((const char *) name);\n-    else\n+        if (l >= dict->limit)\n+            return(NULL);\n+    } else {\n         l = len;\n+        if (l >= dict->limit)\n+            return(NULL);\n+    }\n \n     if (((dict->limit > 0) && (l >= dict->limit)) ||\n         (l > INT_MAX / 2))\n@@ -851,31 +857,31 @@\n     okey = xmlDictComputeKey(dict, name, l);\n     key = okey % dict->size;\n     if (dict->dict[key].valid == 0) {\n-\tinsert = NULL;\n+        insert = NULL;\n     } else {\n-\tfor (insert = &(dict->dict[key]); insert->next != NULL;\n-\t     insert = insert->next) {\n+        for (insert = &(dict->dict[key]); insert->next != NULL;\n+             insert = insert->next) {\n #ifdef __GNUC__\n-\t    if ((insert->okey == okey) && (insert->len == l)) {\n-\t\tif (!memcmp(insert->name, name, l))\n-\t\t    return(insert->name);\n-\t    }\n+            if ((insert->okey == okey) && (insert->len == l)) {\n+                if (!memcmp(insert->name, name, l))\n+                    return(insert->name);\n+            }\n #else\n-\t    if ((insert->okey == okey) && (insert->len == l) &&\n-\t        (!xmlStrncmp(insert->name, name, l)))\n-\t\treturn(insert->name);\n+            if ((insert->okey == okey) && (insert->len == l) &&\n+                (!xmlStrncmp(insert->name, name, l)))\n+                return(insert->name);\n #endif\n-\t    nbi++;\n-\t}\n+            nbi++;\n+        }\n #ifdef __GNUC__\n-\tif ((insert->okey == okey) && (insert->len == l)) {\n-\t    if (!memcmp(insert->name, name, l))\n-\t\treturn(insert->name);\n-\t}\n+        if ((insert->okey == okey) && (insert->len == l)) {\n+            if (!memcmp(insert->name, name, l))\n+                return(insert->name);\n+        }\n #else\n-\tif ((insert->okey == okey) && (insert->len == l) &&\n-\t    (!xmlStrncmp(insert->name, name, l)))\n-\t    return(insert->name);\n+        if ((insert->okey == okey) && (insert->len == l) &&\n+            (!xmlStrncmp(insert->name, name, l)))\n+            return(insert->name);\n #endif\n     }\n \n@@ -884,54 +890,54 @@\n \n         /* we cannot always reuse the same okey for the subdict */\n         if (((dict->size == MIN_DICT_SIZE) &&\n-\t     (dict->subdict->size != MIN_DICT_SIZE)) ||\n+             (dict->subdict->size != MIN_DICT_SIZE)) ||\n             ((dict->size != MIN_DICT_SIZE) &&\n-\t     (dict->subdict->size == MIN_DICT_SIZE)))\n-\t    skey = xmlDictComputeKey(dict->subdict, name, l);\n-\telse\n-\t    skey = okey;\n-\n-\tkey = skey % dict->subdict->size;\n-\tif (dict->subdict->dict[key].valid != 0) {\n-\t    xmlDictEntryPtr tmp;\n+             (dict->subdict->size == MIN_DICT_SIZE)))\n+            skey = xmlDictComputeKey(dict->subdict, name, l);\n+        else\n+            skey = okey;\n+\n+        key = skey % dict->subdict->size;\n+        if (dict->subdict->dict[key].valid != 0) {\n+            xmlDictEntryPtr tmp;\n \n-\t    for (tmp = &(dict->subdict->dict[key]); tmp->next != NULL;\n-\t\t tmp = tmp->next) {\n+            for (tmp = &(dict->subdict->dict[key]); tmp->next != NULL;\n+                 tmp = tmp->next) {\n #ifdef __GNUC__\n-\t\tif ((tmp->okey == skey) && (tmp->len == l)) {\n-\t\t    if (!memcmp(tmp->name, name, l))\n-\t\t\treturn(tmp->name);\n-\t\t}\n+                if ((tmp->okey == skey) && (tmp->len == l)) {\n+                    if (!memcmp(tmp->name, name, l))\n+                        return(tmp->name);\n+                }\n #else\n-\t\tif ((tmp->okey == skey) && (tmp->len == l) &&\n-\t\t    (!xmlStrncmp(tmp->name, name, l)))\n-\t\t    return(tmp->name);\n+                if ((tmp->okey == skey) && (tmp->len == l) &&\n+                    (!xmlStrncmp(tmp->name, name, l)))\n+                    return(tmp->name);\n #endif\n-\t\tnbi++;\n-\t    }\n+                nbi++;\n+            }\n #ifdef __GNUC__\n-\t    if ((tmp->okey == skey) && (tmp->len == l)) {\n-\t\tif (!memcmp(tmp->name, name, l))\n-\t\t    return(tmp->name);\n-\t    }\n+            if ((tmp->okey == skey) && (tmp->len == l)) {\n+                if (!memcmp(tmp->name, name, l))\n+                    return(tmp->name);\n+            }\n #else\n-\t    if ((tmp->okey == skey) && (tmp->len == l) &&\n-\t\t(!xmlStrncmp(tmp->name, name, l)))\n-\t\treturn(tmp->name);\n+            if ((tmp->okey == skey) && (tmp->len == l) &&\n+                (!xmlStrncmp(tmp->name, name, l)))\n+                return(tmp->name);\n #endif\n-\t}\n-\tkey = okey % dict->size;\n+        }\n+        key = okey % dict->size;\n     }\n \n     ret = xmlDictAddString(dict, name, l);\n     if (ret == NULL)\n         return(NULL);\n     if (insert == NULL) {\n-\tentry = &(dict->dict[key]);\n+        entry = &(dict->dict[key]);\n     } else {\n-\tentry = xmlMalloc(sizeof(xmlDictEntry));\n-\tif (entry == NULL)\n-\t     return(NULL);\n+        entry = xmlMalloc(sizeof(xmlDictEntry));\n+        if (entry == NULL)\n+            return(NULL);\n     }\n     entry->name = ret;\n     entry->len = l;\n@@ -941,20 +947,21 @@\n \n \n     if (insert != NULL)\n-\tinsert->next = entry;\n+        insert->next = entry;\n \n     dict->nbElems++;\n \n     if ((nbi > MAX_HASH_LEN) &&\n         (dict->size <= ((MAX_DICT_HASH / 2) / MAX_HASH_LEN))) {\n-\tif (xmlDictGrow(dict, MAX_HASH_LEN * 2 * dict->size) != 0)\n-\t    return(NULL);\n+        if (xmlDictGrow(dict, MAX_HASH_LEN * 2 * dict->size) != 0)\n+            return(NULL);\n     }\n     /* Note that entry may have been freed at this point by xmlDictGrow */\n \n     return(ret);\n }\n \n+\n /**\n  * xmlDictExists:\n  * @dict: the dictionary\n', 'id': 34, 'location': '/data/vulnloc/libxml2/CVE-2016-1839/src/dict.c:842:9'}, {'diff': '@@ -825,6 +825,7 @@\n  *\n  * Returns the internal copy of the name or NULL in case of internal error\n  */\n+\n const xmlChar *\n xmlDictLookup(xmlDictPtr dict, const xmlChar *name, int len) {\n     unsigned long key, okey, nbi = 0;\n@@ -834,12 +835,14 @@\n     unsigned int l;\n \n     if ((dict == NULL) || (name == NULL))\n-\treturn(NULL);\n+        return(NULL);\n \n-    if (len < 0)\n-        l = strlen((const char *) name);\n-    else\n+    if (len < 0) {\n+        // Ensure that len is non-negative before using it\n+        return(NULL);\n+    } else {\n         l = len;\n+    }\n \n     if (((dict->limit > 0) && (l >= dict->limit)) ||\n         (l > INT_MAX / 2))\n@@ -851,31 +854,31 @@\n     okey = xmlDictComputeKey(dict, name, l);\n     key = okey % dict->size;\n     if (dict->dict[key].valid == 0) {\n-\tinsert = NULL;\n+        insert = NULL;\n     } else {\n-\tfor (insert = &(dict->dict[key]); insert->next != NULL;\n-\t     insert = insert->next) {\n+        for (insert = &(dict->dict[key]); insert->next != NULL;\n+             insert = insert->next) {\n #ifdef __GNUC__\n-\t    if ((insert->okey == okey) && (insert->len == l)) {\n-\t\tif (!memcmp(insert->name, name, l))\n-\t\t    return(insert->name);\n-\t    }\n+            if ((insert->okey == okey) && (insert->len == l)) {\n+                if (!memcmp(insert->name, name, l))\n+                    return(insert->name);\n+            }\n #else\n-\t    if ((insert->okey == okey) && (insert->len == l) &&\n-\t        (!xmlStrncmp(insert->name, name, l)))\n-\t\treturn(insert->name);\n+            if ((insert->okey == okey) && (insert->len == l) &&\n+                (!xmlStrncmp(insert->name, name, l)))\n+                return(insert->name);\n #endif\n-\t    nbi++;\n-\t}\n+            nbi++;\n+        }\n #ifdef __GNUC__\n-\tif ((insert->okey == okey) && (insert->len == l)) {\n-\t    if (!memcmp(insert->name, name, l))\n-\t\treturn(insert->name);\n-\t}\n+        if ((insert->okey == okey) && (insert->len == l)) {\n+            if (!memcmp(insert->name, name, l))\n+                return(insert->name);\n+        }\n #else\n-\tif ((insert->okey == okey) && (insert->len == l) &&\n-\t    (!xmlStrncmp(insert->name, name, l)))\n-\t    return(insert->name);\n+        if ((insert->okey == okey) && (insert->len == l) &&\n+            (!xmlStrncmp(insert->name, name, l)))\n+            return(insert->name);\n #endif\n     }\n \n@@ -884,54 +887,54 @@\n \n         /* we cannot always reuse the same okey for the subdict */\n         if (((dict->size == MIN_DICT_SIZE) &&\n-\t     (dict->subdict->size != MIN_DICT_SIZE)) ||\n+             (dict->subdict->size != MIN_DICT_SIZE)) ||\n             ((dict->size != MIN_DICT_SIZE) &&\n-\t     (dict->subdict->size == MIN_DICT_SIZE)))\n-\t    skey = xmlDictComputeKey(dict->subdict, name, l);\n-\telse\n-\t    skey = okey;\n-\n-\tkey = skey % dict->subdict->size;\n-\tif (dict->subdict->dict[key].valid != 0) {\n-\t    xmlDictEntryPtr tmp;\n+             (dict->subdict->size == MIN_DICT_SIZE)))\n+            skey = xmlDictComputeKey(dict->subdict, name, l);\n+        else\n+            skey = okey;\n+\n+        key = skey % dict->subdict->size;\n+        if (dict->subdict->dict[key].valid != 0) {\n+            xmlDictEntryPtr tmp;\n \n-\t    for (tmp = &(dict->subdict->dict[key]); tmp->next != NULL;\n-\t\t tmp = tmp->next) {\n+            for (tmp = &(dict->subdict->dict[key]); tmp->next != NULL;\n+                 tmp = tmp->next) {\n #ifdef __GNUC__\n-\t\tif ((tmp->okey == skey) && (tmp->len == l)) {\n-\t\t    if (!memcmp(tmp->name, name, l))\n-\t\t\treturn(tmp->name);\n-\t\t}\n+                if ((tmp->okey == skey) && (tmp->len == l)) {\n+                    if (!memcmp(tmp->name, name, l))\n+                        return(tmp->name);\n+                }\n #else\n-\t\tif ((tmp->okey == skey) && (tmp->len == l) &&\n-\t\t    (!xmlStrncmp(tmp->name, name, l)))\n-\t\t    return(tmp->name);\n+                if ((tmp->okey == skey) && (tmp->len == l) &&\n+                    (!xmlStrncmp(tmp->name, name, l)))\n+                    return(tmp->name);\n #endif\n-\t\tnbi++;\n-\t    }\n+                nbi++;\n+            }\n #ifdef __GNUC__\n-\t    if ((tmp->okey == skey) && (tmp->len == l)) {\n-\t\tif (!memcmp(tmp->name, name, l))\n-\t\t    return(tmp->name);\n-\t    }\n+            if ((tmp->okey == skey) && (tmp->len == l)) {\n+                if (!memcmp(tmp->name, name, l))\n+                    return(tmp->name);\n+            }\n #else\n-\t    if ((tmp->okey == skey) && (tmp->len == l) &&\n-\t\t(!xmlStrncmp(tmp->name, name, l)))\n-\t\treturn(tmp->name);\n+            if ((tmp->okey == skey) && (tmp->len == l) &&\n+                (!xmlStrncmp(tmp->name, name, l)))\n+                return(tmp->name);\n #endif\n-\t}\n-\tkey = okey % dict->size;\n+        }\n+        key = okey % dict->size;\n     }\n \n     ret = xmlDictAddString(dict, name, l);\n     if (ret == NULL)\n         return(NULL);\n     if (insert == NULL) {\n-\tentry = &(dict->dict[key]);\n+        entry = &(dict->dict[key]);\n     } else {\n-\tentry = xmlMalloc(sizeof(xmlDictEntry));\n-\tif (entry == NULL)\n-\t     return(NULL);\n+        entry = xmlMalloc(sizeof(xmlDictEntry));\n+        if (entry == NULL)\n+             return(NULL);\n     }\n     entry->name = ret;\n     entry->len = l;\n@@ -939,22 +942,22 @@\n     entry->valid = 1;\n     entry->okey = okey;\n \n-\n     if (insert != NULL)\n-\tinsert->next = entry;\n+        insert->next = entry;\n \n     dict->nbElems++;\n \n     if ((nbi > MAX_HASH_LEN) &&\n         (dict->size <= ((MAX_DICT_HASH / 2) / MAX_HASH_LEN))) {\n-\tif (xmlDictGrow(dict, MAX_HASH_LEN * 2 * dict->size) != 0)\n-\t    return(NULL);\n+        if (xmlDictGrow(dict, MAX_HASH_LEN * 2 * dict->size) != 0)\n+            return(NULL);\n     }\n     /* Note that entry may have been freed at this point by xmlDictGrow */\n \n     return(ret);\n }\n \n+\n /**\n  * xmlDictExists:\n  * @dict: the dictionary\n', 'id': 35, 'location': '/data/vulnloc/libxml2/CVE-2016-1839/src/dict.c:839:5'}, {'diff': '@@ -825,6 +825,7 @@\n  *\n  * Returns the internal copy of the name or NULL in case of internal error\n  */\n+\n const xmlChar *\n xmlDictLookup(xmlDictPtr dict, const xmlChar *name, int len) {\n     unsigned long key, okey, nbi = 0;\n@@ -836,10 +837,11 @@\n     if ((dict == NULL) || (name == NULL))\n \treturn(NULL);\n \n-    if (len < 0)\n-        l = strlen((const char *) name);\n-    else\n+    if (len < 0) {\n+        return(NULL); // Added check to avoid invalid lengths\n+    } else {\n         l = len;\n+    }\n \n     if (((dict->limit > 0) && (l >= dict->limit)) ||\n         (l > INT_MAX / 2))\n@@ -939,7 +941,6 @@\n     entry->valid = 1;\n     entry->okey = okey;\n \n-\n     if (insert != NULL)\n \tinsert->next = entry;\n \n@@ -955,6 +956,7 @@\n     return(ret);\n }\n \n+\n /**\n  * xmlDictExists:\n  * @dict: the dictionary\n', 'id': 36, 'location': '/data/vulnloc/libxml2/CVE-2016-1839/src/dict.c:839:5'}, {'diff': '@@ -825,6 +825,7 @@\n  *\n  * Returns the internal copy of the name or NULL in case of internal error\n  */\n+\n const xmlChar *\n xmlDictLookup(xmlDictPtr dict, const xmlChar *name, int len) {\n     unsigned long key, okey, nbi = 0;\n@@ -836,10 +837,11 @@\n     if ((dict == NULL) || (name == NULL))\n \treturn(NULL);\n \n-    if (len < 0)\n-        l = strlen((const char *) name);\n-    else\n+    if (len < 0) {\n+        return(NULL); // Modified to handle negative length case\n+    } else {\n         l = len;\n+    }\n \n     if (((dict->limit > 0) && (l >= dict->limit)) ||\n         (l > INT_MAX / 2))\n@@ -955,6 +957,7 @@\n     return(ret);\n }\n \n+\n /**\n  * xmlDictExists:\n  * @dict: the dictionary\n', 'id': 37, 'location': '/data/vulnloc/libxml2/CVE-2016-1839/src/dict.c:839:5'}, {'diff': '@@ -825,6 +825,7 @@\n  *\n  * Returns the internal copy of the name or NULL in case of internal error\n  */\n+\n const xmlChar *\n xmlDictLookup(xmlDictPtr dict, const xmlChar *name, int len) {\n     unsigned long key, okey, nbi = 0;\n@@ -834,12 +835,12 @@\n     unsigned int l;\n \n     if ((dict == NULL) || (name == NULL))\n-\treturn(NULL);\n+        return(NULL);\n \n-    if (len < 0)\n-        l = strlen((const char *) name);\n-    else\n-        l = len;\n+    if (len < 0 || len > INT_MAX) // Modified condition to prevent negative length and enforce a maximum length condition\n+        return(NULL);\n+    \n+    l = (len < 0) ? strlen((const char *) name) : len;\n \n     if (((dict->limit > 0) && (l >= dict->limit)) ||\n         (l > INT_MAX / 2))\n@@ -851,31 +852,31 @@\n     okey = xmlDictComputeKey(dict, name, l);\n     key = okey % dict->size;\n     if (dict->dict[key].valid == 0) {\n-\tinsert = NULL;\n+        insert = NULL;\n     } else {\n-\tfor (insert = &(dict->dict[key]); insert->next != NULL;\n-\t     insert = insert->next) {\n+        for (insert = &(dict->dict[key]); insert->next != NULL;\n+             insert = insert->next) {\n #ifdef __GNUC__\n-\t    if ((insert->okey == okey) && (insert->len == l)) {\n-\t\tif (!memcmp(insert->name, name, l))\n-\t\t    return(insert->name);\n-\t    }\n+            if ((insert->okey == okey) && (insert->len == l)) {\n+                if (!memcmp(insert->name, name, l))\n+                    return(insert->name);\n+            }\n #else\n-\t    if ((insert->okey == okey) && (insert->len == l) &&\n-\t        (!xmlStrncmp(insert->name, name, l)))\n-\t\treturn(insert->name);\n+            if ((insert->okey == okey) && (insert->len == l) &&\n+                (!xmlStrncmp(insert->name, name, l)))\n+                return(insert->name);\n #endif\n-\t    nbi++;\n-\t}\n+            nbi++;\n+        }\n #ifdef __GNUC__\n-\tif ((insert->okey == okey) && (insert->len == l)) {\n-\t    if (!memcmp(insert->name, name, l))\n-\t\treturn(insert->name);\n-\t}\n+        if ((insert->okey == okey) && (insert->len == l)) {\n+            if (!memcmp(insert->name, name, l))\n+                return(insert->name);\n+        }\n #else\n-\tif ((insert->okey == okey) && (insert->len == l) &&\n-\t    (!xmlStrncmp(insert->name, name, l)))\n-\t    return(insert->name);\n+        if ((insert->okey == okey) && (insert->len == l) &&\n+            (!xmlStrncmp(insert->name, name, l)))\n+            return(insert->name);\n #endif\n     }\n \n@@ -884,54 +885,54 @@\n \n         /* we cannot always reuse the same okey for the subdict */\n         if (((dict->size == MIN_DICT_SIZE) &&\n-\t     (dict->subdict->size != MIN_DICT_SIZE)) ||\n+             (dict->subdict->size != MIN_DICT_SIZE)) ||\n             ((dict->size != MIN_DICT_SIZE) &&\n-\t     (dict->subdict->size == MIN_DICT_SIZE)))\n-\t    skey = xmlDictComputeKey(dict->subdict, name, l);\n-\telse\n-\t    skey = okey;\n-\n-\tkey = skey % dict->subdict->size;\n-\tif (dict->subdict->dict[key].valid != 0) {\n-\t    xmlDictEntryPtr tmp;\n+             (dict->subdict->size == MIN_DICT_SIZE)))\n+            skey = xmlDictComputeKey(dict->subdict, name, l);\n+        else\n+            skey = okey;\n+\n+        key = skey % dict->subdict->size;\n+        if (dict->subdict->dict[key].valid != 0) {\n+            xmlDictEntryPtr tmp;\n \n-\t    for (tmp = &(dict->subdict->dict[key]); tmp->next != NULL;\n-\t\t tmp = tmp->next) {\n+            for (tmp = &(dict->subdict->dict[key]); tmp->next != NULL;\n+                 tmp = tmp->next) {\n #ifdef __GNUC__\n-\t\tif ((tmp->okey == skey) && (tmp->len == l)) {\n-\t\t    if (!memcmp(tmp->name, name, l))\n-\t\t\treturn(tmp->name);\n-\t\t}\n+                if ((tmp->okey == skey) && (tmp->len == l)) {\n+                    if (!memcmp(tmp->name, name, l))\n+                        return(tmp->name);\n+                }\n #else\n-\t\tif ((tmp->okey == skey) && (tmp->len == l) &&\n-\t\t    (!xmlStrncmp(tmp->name, name, l)))\n-\t\t    return(tmp->name);\n+                if ((tmp->okey == skey) && (tmp->len == l) &&\n+                    (!xmlStrncmp(tmp->name, name, l)))\n+                    return(tmp->name);\n #endif\n-\t\tnbi++;\n-\t    }\n+                nbi++;\n+            }\n #ifdef __GNUC__\n-\t    if ((tmp->okey == skey) && (tmp->len == l)) {\n-\t\tif (!memcmp(tmp->name, name, l))\n-\t\t    return(tmp->name);\n-\t    }\n+            if ((tmp->okey == skey) && (tmp->len == l)) {\n+                if (!memcmp(tmp->name, name, l))\n+                    return(tmp->name);\n+            }\n #else\n-\t    if ((tmp->okey == skey) && (tmp->len == l) &&\n-\t\t(!xmlStrncmp(tmp->name, name, l)))\n-\t\treturn(tmp->name);\n+            if ((tmp->okey == skey) && (tmp->len == l) &&\n+                (!xmlStrncmp(tmp->name, name, l)))\n+                return(tmp->name);\n #endif\n-\t}\n-\tkey = okey % dict->size;\n+        }\n+        key = okey % dict->size;\n     }\n \n     ret = xmlDictAddString(dict, name, l);\n     if (ret == NULL)\n         return(NULL);\n     if (insert == NULL) {\n-\tentry = &(dict->dict[key]);\n+        entry = &(dict->dict[key]);\n     } else {\n-\tentry = xmlMalloc(sizeof(xmlDictEntry));\n-\tif (entry == NULL)\n-\t     return(NULL);\n+        entry = xmlMalloc(sizeof(xmlDictEntry));\n+        if (entry == NULL)\n+            return(NULL);\n     }\n     entry->name = ret;\n     entry->len = l;\n@@ -939,22 +940,22 @@\n     entry->valid = 1;\n     entry->okey = okey;\n \n-\n     if (insert != NULL)\n-\tinsert->next = entry;\n+        insert->next = entry;\n \n     dict->nbElems++;\n \n     if ((nbi > MAX_HASH_LEN) &&\n         (dict->size <= ((MAX_DICT_HASH / 2) / MAX_HASH_LEN))) {\n-\tif (xmlDictGrow(dict, MAX_HASH_LEN * 2 * dict->size) != 0)\n-\t    return(NULL);\n+        if (xmlDictGrow(dict, MAX_HASH_LEN * 2 * dict->size) != 0)\n+            return(NULL);\n     }\n     /* Note that entry may have been freed at this point by xmlDictGrow */\n \n     return(ret);\n }\n \n+\n /**\n  * xmlDictExists:\n  * @dict: the dictionary\n', 'id': 38, 'location': '/data/vulnloc/libxml2/CVE-2016-1839/src/dict.c:839:5'}, {'diff': '@@ -825,6 +825,7 @@\n  *\n  * Returns the internal copy of the name or NULL in case of internal error\n  */\n+\n const xmlChar *\n xmlDictLookup(xmlDictPtr dict, const xmlChar *name, int len) {\n     unsigned long key, okey, nbi = 0;\n@@ -836,10 +837,10 @@\n     if ((dict == NULL) || (name == NULL))\n \treturn(NULL);\n \n-    if (len < 0)\n-        l = strlen((const char *) name);\n-    else\n-        l = len;\n+    if (len < 0 || (len > INT_MAX / 2))\n+        return(NULL);\n+    \n+    l = (len < 0) ? strlen((const char *) name) : len;\n \n     if (((dict->limit > 0) && (l >= dict->limit)) ||\n         (l > INT_MAX / 2))\n@@ -955,6 +956,7 @@\n     return(ret);\n }\n \n+\n /**\n  * xmlDictExists:\n  * @dict: the dictionary\n', 'id': 39, 'location': '/data/vulnloc/libxml2/CVE-2016-1839/src/dict.c:839:5'}, {'diff': '@@ -825,16 +825,18 @@\n  *\n  * Returns the internal copy of the name or NULL in case of internal error\n  */\n+\n const xmlChar *\n xmlDictLookup(xmlDictPtr dict, const xmlChar *name, int len) {\n-    unsigned long key, okey, nbi = 0;\n+    unsigned long key, okey;\n     xmlDictEntryPtr entry;\n     xmlDictEntryPtr insert;\n     const xmlChar *ret;\n     unsigned int l;\n+    unsigned long nbi = 0; // Moved this variable declaration to maintain clarity\n \n     if ((dict == NULL) || (name == NULL))\n-\treturn(NULL);\n+        return(NULL);\n \n     if (len < 0)\n         l = strlen((const char *) name);\n@@ -851,31 +853,31 @@\n     okey = xmlDictComputeKey(dict, name, l);\n     key = okey % dict->size;\n     if (dict->dict[key].valid == 0) {\n-\tinsert = NULL;\n+        insert = NULL;\n     } else {\n-\tfor (insert = &(dict->dict[key]); insert->next != NULL;\n-\t     insert = insert->next) {\n+        for (insert = &(dict->dict[key]); insert->next != NULL;\n+             insert = insert->next) {\n #ifdef __GNUC__\n-\t    if ((insert->okey == okey) && (insert->len == l)) {\n-\t\tif (!memcmp(insert->name, name, l))\n-\t\t    return(insert->name);\n-\t    }\n+            if ((insert->okey == okey) && (insert->len == l)) {\n+                if (!memcmp(insert->name, name, l))\n+                    return(insert->name);\n+            }\n #else\n-\t    if ((insert->okey == okey) && (insert->len == l) &&\n-\t        (!xmlStrncmp(insert->name, name, l)))\n-\t\treturn(insert->name);\n+            if ((insert->okey == okey) && (insert->len == l) &&\n+                (!xmlStrncmp(insert->name, name, l)))\n+                return(insert->name);\n #endif\n-\t    nbi++;\n-\t}\n+            nbi++;\n+        }\n #ifdef __GNUC__\n-\tif ((insert->okey == okey) && (insert->len == l)) {\n-\t    if (!memcmp(insert->name, name, l))\n-\t\treturn(insert->name);\n-\t}\n+        if ((insert->okey == okey) && (insert->len == l)) {\n+            if (!memcmp(insert->name, name, l))\n+                return(insert->name);\n+        }\n #else\n-\tif ((insert->okey == okey) && (insert->len == l) &&\n-\t    (!xmlStrncmp(insert->name, name, l)))\n-\t    return(insert->name);\n+        if ((insert->okey == okey) && (insert->len == l) &&\n+            (!xmlStrncmp(insert->name, name, l)))\n+            return(insert->name);\n #endif\n     }\n \n@@ -884,54 +886,54 @@\n \n         /* we cannot always reuse the same okey for the subdict */\n         if (((dict->size == MIN_DICT_SIZE) &&\n-\t     (dict->subdict->size != MIN_DICT_SIZE)) ||\n+             (dict->subdict->size != MIN_DICT_SIZE)) ||\n             ((dict->size != MIN_DICT_SIZE) &&\n-\t     (dict->subdict->size == MIN_DICT_SIZE)))\n-\t    skey = xmlDictComputeKey(dict->subdict, name, l);\n-\telse\n-\t    skey = okey;\n-\n-\tkey = skey % dict->subdict->size;\n-\tif (dict->subdict->dict[key].valid != 0) {\n-\t    xmlDictEntryPtr tmp;\n+             (dict->subdict->size == MIN_DICT_SIZE)))\n+            skey = xmlDictComputeKey(dict->subdict, name, l);\n+        else\n+            skey = okey;\n+\n+        key = skey % dict->subdict->size;\n+        if (dict->subdict->dict[key].valid != 0) {\n+            xmlDictEntryPtr tmp;\n \n-\t    for (tmp = &(dict->subdict->dict[key]); tmp->next != NULL;\n-\t\t tmp = tmp->next) {\n+            for (tmp = &(dict->subdict->dict[key]); tmp->next != NULL;\n+                 tmp = tmp->next) {\n #ifdef __GNUC__\n-\t\tif ((tmp->okey == skey) && (tmp->len == l)) {\n-\t\t    if (!memcmp(tmp->name, name, l))\n-\t\t\treturn(tmp->name);\n-\t\t}\n+                if ((tmp->okey == skey) && (tmp->len == l)) {\n+                    if (!memcmp(tmp->name, name, l))\n+                        return(tmp->name);\n+                }\n #else\n-\t\tif ((tmp->okey == skey) && (tmp->len == l) &&\n-\t\t    (!xmlStrncmp(tmp->name, name, l)))\n-\t\t    return(tmp->name);\n+                if ((tmp->okey == skey) && (tmp->len == l) &&\n+                    (!xmlStrncmp(tmp->name, name, l)))\n+                    return(tmp->name);\n #endif\n-\t\tnbi++;\n-\t    }\n+                nbi++;\n+            }\n #ifdef __GNUC__\n-\t    if ((tmp->okey == skey) && (tmp->len == l)) {\n-\t\tif (!memcmp(tmp->name, name, l))\n-\t\t    return(tmp->name);\n-\t    }\n+            if ((tmp->okey == skey) && (tmp->len == l)) {\n+                if (!memcmp(tmp->name, name, l))\n+                    return(tmp->name);\n+            }\n #else\n-\t    if ((tmp->okey == skey) && (tmp->len == l) &&\n-\t\t(!xmlStrncmp(tmp->name, name, l)))\n-\t\treturn(tmp->name);\n+            if ((tmp->okey == skey) && (tmp->len == l) &&\n+                (!xmlStrncmp(tmp->name, name, l)))\n+                return(tmp->name);\n #endif\n-\t}\n-\tkey = okey % dict->size;\n+        }\n+        key = okey % dict->size;\n     }\n \n     ret = xmlDictAddString(dict, name, l);\n     if (ret == NULL)\n         return(NULL);\n     if (insert == NULL) {\n-\tentry = &(dict->dict[key]);\n+        entry = &(dict->dict[key]);\n     } else {\n-\tentry = xmlMalloc(sizeof(xmlDictEntry));\n-\tif (entry == NULL)\n-\t     return(NULL);\n+        entry = xmlMalloc(sizeof(xmlDictEntry));\n+        if (entry == NULL)\n+            return(NULL);\n     }\n     entry->name = ret;\n     entry->len = l;\n@@ -939,22 +941,22 @@\n     entry->valid = 1;\n     entry->okey = okey;\n \n-\n     if (insert != NULL)\n-\tinsert->next = entry;\n+        insert->next = entry;\n \n     dict->nbElems++;\n \n     if ((nbi > MAX_HASH_LEN) &&\n         (dict->size <= ((MAX_DICT_HASH / 2) / MAX_HASH_LEN))) {\n-\tif (xmlDictGrow(dict, MAX_HASH_LEN * 2 * dict->size) != 0)\n-\t    return(NULL);\n+        if (xmlDictGrow(dict, MAX_HASH_LEN * 2 * dict->size) != 0)\n+            return(NULL);\n     }\n     /* Note that entry may have been freed at this point by xmlDictGrow */\n \n     return(ret);\n }\n \n+\n /**\n  * xmlDictExists:\n  * @dict: the dictionary\n', 'id': 40, 'location': '/data/vulnloc/libxml2/CVE-2016-1839/src/dict.c:830:5'}, {'diff': '@@ -825,16 +825,17 @@\n  *\n  * Returns the internal copy of the name or NULL in case of internal error\n  */\n+\n const xmlChar *\n xmlDictLookup(xmlDictPtr dict, const xmlChar *name, int len) {\n-    unsigned long key, okey, nbi = 0;\n+    unsigned long okey, nbi = 0;\n     xmlDictEntryPtr entry;\n     xmlDictEntryPtr insert;\n     const xmlChar *ret;\n     unsigned int l;\n \n     if ((dict == NULL) || (name == NULL))\n-\treturn(NULL);\n+        return(NULL);\n \n     if (len < 0)\n         l = strlen((const char *) name);\n@@ -849,33 +850,33 @@\n      * Check for duplicate and insertion location.\n      */\n     okey = xmlDictComputeKey(dict, name, l);\n-    key = okey % dict->size;\n+    unsigned long key = okey % dict->size; // Changed declaration to localize key\n     if (dict->dict[key].valid == 0) {\n-\tinsert = NULL;\n+        insert = NULL;\n     } else {\n-\tfor (insert = &(dict->dict[key]); insert->next != NULL;\n-\t     insert = insert->next) {\n+        for (insert = &(dict->dict[key]); insert->next != NULL;\n+             insert = insert->next) {\n #ifdef __GNUC__\n-\t    if ((insert->okey == okey) && (insert->len == l)) {\n-\t\tif (!memcmp(insert->name, name, l))\n-\t\t    return(insert->name);\n-\t    }\n+            if ((insert->okey == okey) && (insert->len == l)) {\n+                if (!memcmp(insert->name, name, l))\n+                    return(insert->name);\n+            }\n #else\n-\t    if ((insert->okey == okey) && (insert->len == l) &&\n-\t        (!xmlStrncmp(insert->name, name, l)))\n-\t\treturn(insert->name);\n+            if ((insert->okey == okey) && (insert->len == l) &&\n+                (!xmlStrncmp(insert->name, name, l)))\n+                return(insert->name);\n #endif\n-\t    nbi++;\n-\t}\n+            nbi++;\n+        }\n #ifdef __GNUC__\n-\tif ((insert->okey == okey) && (insert->len == l)) {\n-\t    if (!memcmp(insert->name, name, l))\n-\t\treturn(insert->name);\n-\t}\n+        if ((insert->okey == okey) && (insert->len == l)) {\n+            if (!memcmp(insert->name, name, l))\n+                return(insert->name);\n+        }\n #else\n-\tif ((insert->okey == okey) && (insert->len == l) &&\n-\t    (!xmlStrncmp(insert->name, name, l)))\n-\t    return(insert->name);\n+        if ((insert->okey == okey) && (insert->len == l) &&\n+            (!xmlStrncmp(insert->name, name, l)))\n+            return(insert->name);\n #endif\n     }\n \n@@ -884,54 +885,54 @@\n \n         /* we cannot always reuse the same okey for the subdict */\n         if (((dict->size == MIN_DICT_SIZE) &&\n-\t     (dict->subdict->size != MIN_DICT_SIZE)) ||\n+             (dict->subdict->size != MIN_DICT_SIZE)) ||\n             ((dict->size != MIN_DICT_SIZE) &&\n-\t     (dict->subdict->size == MIN_DICT_SIZE)))\n-\t    skey = xmlDictComputeKey(dict->subdict, name, l);\n-\telse\n-\t    skey = okey;\n-\n-\tkey = skey % dict->subdict->size;\n-\tif (dict->subdict->dict[key].valid != 0) {\n-\t    xmlDictEntryPtr tmp;\n+             (dict->subdict->size == MIN_DICT_SIZE)))\n+            skey = xmlDictComputeKey(dict->subdict, name, l);\n+        else\n+            skey = okey;\n+\n+        key = skey % dict->subdict->size;\n+        if (dict->subdict->dict[key].valid != 0) {\n+            xmlDictEntryPtr tmp;\n \n-\t    for (tmp = &(dict->subdict->dict[key]); tmp->next != NULL;\n-\t\t tmp = tmp->next) {\n+            for (tmp = &(dict->subdict->dict[key]); tmp->next != NULL;\n+                 tmp = tmp->next) {\n #ifdef __GNUC__\n-\t\tif ((tmp->okey == skey) && (tmp->len == l)) {\n-\t\t    if (!memcmp(tmp->name, name, l))\n-\t\t\treturn(tmp->name);\n-\t\t}\n+                if ((tmp->okey == skey) && (tmp->len == l)) {\n+                    if (!memcmp(tmp->name, name, l))\n+                        return(tmp->name);\n+                }\n #else\n-\t\tif ((tmp->okey == skey) && (tmp->len == l) &&\n-\t\t    (!xmlStrncmp(tmp->name, name, l)))\n-\t\t    return(tmp->name);\n+                if ((tmp->okey == skey) && (tmp->len == l) &&\n+                    (!xmlStrncmp(tmp->name, name, l)))\n+                    return(tmp->name);\n #endif\n-\t\tnbi++;\n-\t    }\n+                nbi++;\n+            }\n #ifdef __GNUC__\n-\t    if ((tmp->okey == skey) && (tmp->len == l)) {\n-\t\tif (!memcmp(tmp->name, name, l))\n-\t\t    return(tmp->name);\n-\t    }\n+            if ((tmp->okey == skey) && (tmp->len == l)) {\n+                if (!memcmp(tmp->name, name, l))\n+                    return(tmp->name);\n+            }\n #else\n-\t    if ((tmp->okey == skey) && (tmp->len == l) &&\n-\t\t(!xmlStrncmp(tmp->name, name, l)))\n-\t\treturn(tmp->name);\n+            if ((tmp->okey == skey) && (tmp->len == l) &&\n+                (!xmlStrncmp(tmp->name, name, l)))\n+                return(tmp->name);\n #endif\n-\t}\n-\tkey = okey % dict->size;\n+        }\n+        key = okey % dict->size;\n     }\n \n     ret = xmlDictAddString(dict, name, l);\n     if (ret == NULL)\n         return(NULL);\n     if (insert == NULL) {\n-\tentry = &(dict->dict[key]);\n+        entry = &(dict->dict[key]);\n     } else {\n-\tentry = xmlMalloc(sizeof(xmlDictEntry));\n-\tif (entry == NULL)\n-\t     return(NULL);\n+        entry = xmlMalloc(sizeof(xmlDictEntry));\n+        if (entry == NULL)\n+            return(NULL);\n     }\n     entry->name = ret;\n     entry->len = l;\n@@ -941,20 +942,21 @@\n \n \n     if (insert != NULL)\n-\tinsert->next = entry;\n+        insert->next = entry;\n \n     dict->nbElems++;\n \n     if ((nbi > MAX_HASH_LEN) &&\n         (dict->size <= ((MAX_DICT_HASH / 2) / MAX_HASH_LEN))) {\n-\tif (xmlDictGrow(dict, MAX_HASH_LEN * 2 * dict->size) != 0)\n-\t    return(NULL);\n+        if (xmlDictGrow(dict, MAX_HASH_LEN * 2 * dict->size) != 0)\n+            return(NULL);\n     }\n     /* Note that entry may have been freed at this point by xmlDictGrow */\n \n     return(ret);\n }\n \n+\n /**\n  * xmlDictExists:\n  * @dict: the dictionary\n', 'id': 41, 'location': '/data/vulnloc/libxml2/CVE-2016-1839/src/dict.c:830:5'}, {'diff': '@@ -825,6 +825,7 @@\n  *\n  * Returns the internal copy of the name or NULL in case of internal error\n  */\n+\n const xmlChar *\n xmlDictLookup(xmlDictPtr dict, const xmlChar *name, int len) {\n     unsigned long key, okey, nbi = 0;\n@@ -834,7 +835,7 @@\n     unsigned int l;\n \n     if ((dict == NULL) || (name == NULL))\n-\treturn(NULL);\n+        return(NULL);\n \n     if (len < 0)\n         l = strlen((const char *) name);\n@@ -851,31 +852,31 @@\n     okey = xmlDictComputeKey(dict, name, l);\n     key = okey % dict->size;\n     if (dict->dict[key].valid == 0) {\n-\tinsert = NULL;\n+        insert = NULL;\n     } else {\n-\tfor (insert = &(dict->dict[key]); insert->next != NULL;\n-\t     insert = insert->next) {\n+        for (insert = &(dict->dict[key]); insert->next != NULL;\n+             insert = insert->next) {\n #ifdef __GNUC__\n-\t    if ((insert->okey == okey) && (insert->len == l)) {\n-\t\tif (!memcmp(insert->name, name, l))\n-\t\t    return(insert->name);\n-\t    }\n+            if ((insert->okey == okey) && (insert->len == l)) {\n+                if (!memcmp(insert->name, name, l))\n+                    return(insert->name);\n+            }\n #else\n-\t    if ((insert->okey == okey) && (insert->len == l) &&\n-\t        (!xmlStrncmp(insert->name, name, l)))\n-\t\treturn(insert->name);\n+            if ((insert->okey == okey) && (insert->len == l) &&\n+                (!xmlStrncmp(insert->name, name, l)))\n+                return(insert->name);\n #endif\n-\t    nbi++;\n-\t}\n+            nbi++;\n+        }\n #ifdef __GNUC__\n-\tif ((insert->okey == okey) && (insert->len == l)) {\n-\t    if (!memcmp(insert->name, name, l))\n-\t\treturn(insert->name);\n-\t}\n+        if ((insert->okey == okey) && (insert->len == l)) {\n+            if (!memcmp(insert->name, name, l))\n+                return(insert->name);\n+        }\n #else\n-\tif ((insert->okey == okey) && (insert->len == l) &&\n-\t    (!xmlStrncmp(insert->name, name, l)))\n-\t    return(insert->name);\n+        if ((insert->okey == okey) && (insert->len == l) &&\n+            (!xmlStrncmp(insert->name, name, l)))\n+            return(insert->name);\n #endif\n     }\n \n@@ -884,54 +885,54 @@\n \n         /* we cannot always reuse the same okey for the subdict */\n         if (((dict->size == MIN_DICT_SIZE) &&\n-\t     (dict->subdict->size != MIN_DICT_SIZE)) ||\n+             (dict->subdict->size != MIN_DICT_SIZE)) ||\n             ((dict->size != MIN_DICT_SIZE) &&\n-\t     (dict->subdict->size == MIN_DICT_SIZE)))\n-\t    skey = xmlDictComputeKey(dict->subdict, name, l);\n-\telse\n-\t    skey = okey;\n-\n-\tkey = skey % dict->subdict->size;\n-\tif (dict->subdict->dict[key].valid != 0) {\n-\t    xmlDictEntryPtr tmp;\n+             (dict->subdict->size == MIN_DICT_SIZE)))\n+            skey = xmlDictComputeKey(dict->subdict, name, l);\n+        else\n+            skey = okey;\n+\n+        key = skey % dict->subdict->size;\n+        if (dict->subdict->dict[key].valid != 0) {\n+            xmlDictEntryPtr tmp;\n \n-\t    for (tmp = &(dict->subdict->dict[key]); tmp->next != NULL;\n-\t\t tmp = tmp->next) {\n+            for (tmp = &(dict->subdict->dict[key]); tmp->next != NULL;\n+                 tmp = tmp->next) {\n #ifdef __GNUC__\n-\t\tif ((tmp->okey == skey) && (tmp->len == l)) {\n-\t\t    if (!memcmp(tmp->name, name, l))\n-\t\t\treturn(tmp->name);\n-\t\t}\n+                if ((tmp->okey == skey) && (tmp->len == l)) {\n+                    if (!memcmp(tmp->name, name, l))\n+                        return(tmp->name);\n+                }\n #else\n-\t\tif ((tmp->okey == skey) && (tmp->len == l) &&\n-\t\t    (!xmlStrncmp(tmp->name, name, l)))\n-\t\t    return(tmp->name);\n+                if ((tmp->okey == skey) && (tmp->len == l) &&\n+                    (!xmlStrncmp(tmp->name, name, l)))\n+                    return(tmp->name);\n #endif\n-\t\tnbi++;\n-\t    }\n+                nbi++;\n+            }\n #ifdef __GNUC__\n-\t    if ((tmp->okey == skey) && (tmp->len == l)) {\n-\t\tif (!memcmp(tmp->name, name, l))\n-\t\t    return(tmp->name);\n-\t    }\n+            if ((tmp->okey == skey) && (tmp->len == l)) {\n+                if (!memcmp(tmp->name, name, l))\n+                    return(tmp->name);\n+            }\n #else\n-\t    if ((tmp->okey == skey) && (tmp->len == l) &&\n-\t\t(!xmlStrncmp(tmp->name, name, l)))\n-\t\treturn(tmp->name);\n+            if ((tmp->okey == skey) && (tmp->len == l) &&\n+                (!xmlStrncmp(tmp->name, name, l)))\n+                return(tmp->name);\n #endif\n-\t}\n-\tkey = okey % dict->size;\n+        }\n+        key = okey % dict->size;\n     }\n \n     ret = xmlDictAddString(dict, name, l);\n     if (ret == NULL)\n         return(NULL);\n     if (insert == NULL) {\n-\tentry = &(dict->dict[key]);\n+        entry = &(dict->dict[key]);\n     } else {\n-\tentry = xmlMalloc(sizeof(xmlDictEntry));\n-\tif (entry == NULL)\n-\t     return(NULL);\n+        entry = xmlMalloc(sizeof(xmlDictEntry));\n+        if (entry == NULL)\n+            return(NULL);\n     }\n     entry->name = ret;\n     entry->len = l;\n@@ -939,22 +940,22 @@\n     entry->valid = 1;\n     entry->okey = okey;\n \n-\n     if (insert != NULL)\n-\tinsert->next = entry;\n+        insert->next = entry;\n \n     dict->nbElems++;\n \n     if ((nbi > MAX_HASH_LEN) &&\n         (dict->size <= ((MAX_DICT_HASH / 2) / MAX_HASH_LEN))) {\n-\tif (xmlDictGrow(dict, MAX_HASH_LEN * 2 * dict->size) != 0)\n-\t    return(NULL);\n+        if (xmlDictGrow(dict, MAX_HASH_LEN * 2 * dict->size) != 0)\n+            return(NULL);\n     }\n     /* Note that entry may have been freed at this point by xmlDictGrow */\n \n     return(ret);\n }\n \n+\n /**\n  * xmlDictExists:\n  * @dict: the dictionary\n', 'id': 42, 'location': '/data/vulnloc/libxml2/CVE-2016-1839/src/dict.c:830:5'}, {'diff': '@@ -825,16 +825,18 @@\n  *\n  * Returns the internal copy of the name or NULL in case of internal error\n  */\n+\n const xmlChar *\n xmlDictLookup(xmlDictPtr dict, const xmlChar *name, int len) {\n-    unsigned long key, okey, nbi = 0;\n+    unsigned long key, okey;\n+    unsigned long nbi = 0; // Move this declaration to avoid potential misuse\n     xmlDictEntryPtr entry;\n     xmlDictEntryPtr insert;\n     const xmlChar *ret;\n     unsigned int l;\n \n     if ((dict == NULL) || (name == NULL))\n-\treturn(NULL);\n+        return(NULL);\n \n     if (len < 0)\n         l = strlen((const char *) name);\n@@ -851,31 +853,31 @@\n     okey = xmlDictComputeKey(dict, name, l);\n     key = okey % dict->size;\n     if (dict->dict[key].valid == 0) {\n-\tinsert = NULL;\n+        insert = NULL;\n     } else {\n-\tfor (insert = &(dict->dict[key]); insert->next != NULL;\n-\t     insert = insert->next) {\n+        for (insert = &(dict->dict[key]); insert->next != NULL;\n+             insert = insert->next) {\n #ifdef __GNUC__\n-\t    if ((insert->okey == okey) && (insert->len == l)) {\n-\t\tif (!memcmp(insert->name, name, l))\n-\t\t    return(insert->name);\n-\t    }\n+            if ((insert->okey == okey) && (insert->len == l)) {\n+                if (!memcmp(insert->name, name, l))\n+                    return(insert->name);\n+            }\n #else\n-\t    if ((insert->okey == okey) && (insert->len == l) &&\n-\t        (!xmlStrncmp(insert->name, name, l)))\n-\t\treturn(insert->name);\n+            if ((insert->okey == okey) && (insert->len == l) &&\n+                (!xmlStrncmp(insert->name, name, l)))\n+                return(insert->name);\n #endif\n-\t    nbi++;\n-\t}\n+            nbi++;\n+        }\n #ifdef __GNUC__\n-\tif ((insert->okey == okey) && (insert->len == l)) {\n-\t    if (!memcmp(insert->name, name, l))\n-\t\treturn(insert->name);\n-\t}\n+        if ((insert->okey == okey) && (insert->len == l)) {\n+            if (!memcmp(insert->name, name, l))\n+                return(insert->name);\n+        }\n #else\n-\tif ((insert->okey == okey) && (insert->len == l) &&\n-\t    (!xmlStrncmp(insert->name, name, l)))\n-\t    return(insert->name);\n+        if ((insert->okey == okey) && (insert->len == l) &&\n+            (!xmlStrncmp(insert->name, name, l)))\n+            return(insert->name);\n #endif\n     }\n \n@@ -884,54 +886,54 @@\n \n         /* we cannot always reuse the same okey for the subdict */\n         if (((dict->size == MIN_DICT_SIZE) &&\n-\t     (dict->subdict->size != MIN_DICT_SIZE)) ||\n+            (dict->subdict->size != MIN_DICT_SIZE)) ||\n             ((dict->size != MIN_DICT_SIZE) &&\n-\t     (dict->subdict->size == MIN_DICT_SIZE)))\n-\t    skey = xmlDictComputeKey(dict->subdict, name, l);\n-\telse\n-\t    skey = okey;\n-\n-\tkey = skey % dict->subdict->size;\n-\tif (dict->subdict->dict[key].valid != 0) {\n-\t    xmlDictEntryPtr tmp;\n+            (dict->subdict->size == MIN_DICT_SIZE)))\n+            skey = xmlDictComputeKey(dict->subdict, name, l);\n+        else\n+            skey = okey;\n+\n+        key = skey % dict->subdict->size;\n+        if (dict->subdict->dict[key].valid != 0) {\n+            xmlDictEntryPtr tmp;\n \n-\t    for (tmp = &(dict->subdict->dict[key]); tmp->next != NULL;\n-\t\t tmp = tmp->next) {\n+            for (tmp = &(dict->subdict->dict[key]); tmp->next != NULL;\n+                 tmp = tmp->next) {\n #ifdef __GNUC__\n-\t\tif ((tmp->okey == skey) && (tmp->len == l)) {\n-\t\t    if (!memcmp(tmp->name, name, l))\n-\t\t\treturn(tmp->name);\n-\t\t}\n+                if ((tmp->okey == skey) && (tmp->len == l)) {\n+                    if (!memcmp(tmp->name, name, l))\n+                        return(tmp->name);\n+                }\n #else\n-\t\tif ((tmp->okey == skey) && (tmp->len == l) &&\n-\t\t    (!xmlStrncmp(tmp->name, name, l)))\n-\t\t    return(tmp->name);\n+                if ((tmp->okey == skey) && (tmp->len == l) &&\n+                    (!xmlStrncmp(tmp->name, name, l)))\n+                    return(tmp->name);\n #endif\n-\t\tnbi++;\n-\t    }\n+                nbi++;\n+            }\n #ifdef __GNUC__\n-\t    if ((tmp->okey == skey) && (tmp->len == l)) {\n-\t\tif (!memcmp(tmp->name, name, l))\n-\t\t    return(tmp->name);\n-\t    }\n+            if ((tmp->okey == skey) && (tmp->len == l)) {\n+                if (!memcmp(tmp->name, name, l))\n+                    return(tmp->name);\n+            }\n #else\n-\t    if ((tmp->okey == skey) && (tmp->len == l) &&\n-\t\t(!xmlStrncmp(tmp->name, name, l)))\n-\t\treturn(tmp->name);\n+            if ((tmp->okey == skey) && (tmp->len == l) &&\n+                (!xmlStrncmp(tmp->name, name, l)))\n+                return(tmp->name);\n #endif\n-\t}\n-\tkey = okey % dict->size;\n+        }\n+        key = okey % dict->size;\n     }\n \n     ret = xmlDictAddString(dict, name, l);\n     if (ret == NULL)\n         return(NULL);\n     if (insert == NULL) {\n-\tentry = &(dict->dict[key]);\n+        entry = &(dict->dict[key]);\n     } else {\n-\tentry = xmlMalloc(sizeof(xmlDictEntry));\n-\tif (entry == NULL)\n-\t     return(NULL);\n+        entry = xmlMalloc(sizeof(xmlDictEntry));\n+        if (entry == NULL)\n+            return(NULL);\n     }\n     entry->name = ret;\n     entry->len = l;\n@@ -939,22 +941,22 @@\n     entry->valid = 1;\n     entry->okey = okey;\n \n-\n     if (insert != NULL)\n-\tinsert->next = entry;\n+        insert->next = entry;\n \n     dict->nbElems++;\n \n     if ((nbi > MAX_HASH_LEN) &&\n         (dict->size <= ((MAX_DICT_HASH / 2) / MAX_HASH_LEN))) {\n-\tif (xmlDictGrow(dict, MAX_HASH_LEN * 2 * dict->size) != 0)\n-\t    return(NULL);\n+        if (xmlDictGrow(dict, MAX_HASH_LEN * 2 * dict->size) != 0)\n+            return(NULL);\n     }\n     /* Note that entry may have been freed at this point by xmlDictGrow */\n \n     return(ret);\n }\n \n+\n /**\n  * xmlDictExists:\n  * @dict: the dictionary\n', 'id': 43, 'location': '/data/vulnloc/libxml2/CVE-2016-1839/src/dict.c:830:5'}, {'diff': '@@ -825,17 +825,19 @@\n  *\n  * Returns the internal copy of the name or NULL in case of internal error\n  */\n+\n const xmlChar *\n xmlDictLookup(xmlDictPtr dict, const xmlChar *name, int len) {\n-    unsigned long key, okey, nbi = 0;\n+    if ((dict == NULL) || (name == NULL))\n+        return(NULL);\n+\n+    unsigned long key = 0, okey = 0;  // Initialize to prevent potential undefined behavior\n+    unsigned long nbi = 0; \n     xmlDictEntryPtr entry;\n     xmlDictEntryPtr insert;\n     const xmlChar *ret;\n     unsigned int l;\n \n-    if ((dict == NULL) || (name == NULL))\n-\treturn(NULL);\n-\n     if (len < 0)\n         l = strlen((const char *) name);\n     else\n@@ -851,31 +853,31 @@\n     okey = xmlDictComputeKey(dict, name, l);\n     key = okey % dict->size;\n     if (dict->dict[key].valid == 0) {\n-\tinsert = NULL;\n+        insert = NULL;\n     } else {\n-\tfor (insert = &(dict->dict[key]); insert->next != NULL;\n-\t     insert = insert->next) {\n+        for (insert = &(dict->dict[key]); insert->next != NULL;\n+             insert = insert->next) {\n #ifdef __GNUC__\n-\t    if ((insert->okey == okey) && (insert->len == l)) {\n-\t\tif (!memcmp(insert->name, name, l))\n-\t\t    return(insert->name);\n-\t    }\n+            if ((insert->okey == okey) && (insert->len == l)) {\n+                if (!memcmp(insert->name, name, l))\n+                    return(insert->name);\n+            }\n #else\n-\t    if ((insert->okey == okey) && (insert->len == l) &&\n-\t        (!xmlStrncmp(insert->name, name, l)))\n-\t\treturn(insert->name);\n+            if ((insert->okey == okey) && (insert->len == l) &&\n+                (!xmlStrncmp(insert->name, name, l)))\n+                return(insert->name);\n #endif\n-\t    nbi++;\n-\t}\n+            nbi++;\n+        }\n #ifdef __GNUC__\n-\tif ((insert->okey == okey) && (insert->len == l)) {\n-\t    if (!memcmp(insert->name, name, l))\n-\t\treturn(insert->name);\n-\t}\n+        if ((insert->okey == okey) && (insert->len == l)) {\n+            if (!memcmp(insert->name, name, l))\n+                return(insert->name);\n+        }\n #else\n-\tif ((insert->okey == okey) && (insert->len == l) &&\n-\t    (!xmlStrncmp(insert->name, name, l)))\n-\t    return(insert->name);\n+        if ((insert->okey == okey) && (insert->len == l) &&\n+            (!xmlStrncmp(insert->name, name, l)))\n+            return(insert->name);\n #endif\n     }\n \n@@ -884,54 +886,54 @@\n \n         /* we cannot always reuse the same okey for the subdict */\n         if (((dict->size == MIN_DICT_SIZE) &&\n-\t     (dict->subdict->size != MIN_DICT_SIZE)) ||\n+            (dict->subdict->size != MIN_DICT_SIZE)) ||\n             ((dict->size != MIN_DICT_SIZE) &&\n-\t     (dict->subdict->size == MIN_DICT_SIZE)))\n-\t    skey = xmlDictComputeKey(dict->subdict, name, l);\n-\telse\n-\t    skey = okey;\n-\n-\tkey = skey % dict->subdict->size;\n-\tif (dict->subdict->dict[key].valid != 0) {\n-\t    xmlDictEntryPtr tmp;\n+            (dict->subdict->size == MIN_DICT_SIZE)))\n+            skey = xmlDictComputeKey(dict->subdict, name, l);\n+        else\n+            skey = okey;\n+\n+        key = skey % dict->subdict->size;\n+        if (dict->subdict->dict[key].valid != 0) {\n+            xmlDictEntryPtr tmp;\n \n-\t    for (tmp = &(dict->subdict->dict[key]); tmp->next != NULL;\n-\t\t tmp = tmp->next) {\n+            for (tmp = &(dict->subdict->dict[key]); tmp->next != NULL;\n+                 tmp = tmp->next) {\n #ifdef __GNUC__\n-\t\tif ((tmp->okey == skey) && (tmp->len == l)) {\n-\t\t    if (!memcmp(tmp->name, name, l))\n-\t\t\treturn(tmp->name);\n-\t\t}\n+                if ((tmp->okey == skey) && (tmp->len == l)) {\n+                    if (!memcmp(tmp->name, name, l))\n+                        return(tmp->name);\n+                }\n #else\n-\t\tif ((tmp->okey == skey) && (tmp->len == l) &&\n-\t\t    (!xmlStrncmp(tmp->name, name, l)))\n-\t\t    return(tmp->name);\n+                if ((tmp->okey == skey) && (tmp->len == l) &&\n+                    (!xmlStrncmp(tmp->name, name, l)))\n+                    return(tmp->name);\n #endif\n-\t\tnbi++;\n-\t    }\n+                nbi++;\n+            }\n #ifdef __GNUC__\n-\t    if ((tmp->okey == skey) && (tmp->len == l)) {\n-\t\tif (!memcmp(tmp->name, name, l))\n-\t\t    return(tmp->name);\n-\t    }\n+            if ((tmp->okey == skey) && (tmp->len == l)) {\n+                if (!memcmp(tmp->name, name, l))\n+                    return(tmp->name);\n+            }\n #else\n-\t    if ((tmp->okey == skey) && (tmp->len == l) &&\n-\t\t(!xmlStrncmp(tmp->name, name, l)))\n-\t\treturn(tmp->name);\n+            if ((tmp->okey == skey) && (tmp->len == l) &&\n+                (!xmlStrncmp(tmp->name, name, l)))\n+                return(tmp->name);\n #endif\n-\t}\n-\tkey = okey % dict->size;\n+        }\n+        key = okey % dict->size;\n     }\n \n     ret = xmlDictAddString(dict, name, l);\n     if (ret == NULL)\n         return(NULL);\n     if (insert == NULL) {\n-\tentry = &(dict->dict[key]);\n+        entry = &(dict->dict[key]);\n     } else {\n-\tentry = xmlMalloc(sizeof(xmlDictEntry));\n-\tif (entry == NULL)\n-\t     return(NULL);\n+        entry = xmlMalloc(sizeof(xmlDictEntry));\n+        if (entry == NULL)\n+            return(NULL);\n     }\n     entry->name = ret;\n     entry->len = l;\n@@ -939,22 +941,22 @@\n     entry->valid = 1;\n     entry->okey = okey;\n \n-\n     if (insert != NULL)\n-\tinsert->next = entry;\n+        insert->next = entry;\n \n     dict->nbElems++;\n \n     if ((nbi > MAX_HASH_LEN) &&\n         (dict->size <= ((MAX_DICT_HASH / 2) / MAX_HASH_LEN))) {\n-\tif (xmlDictGrow(dict, MAX_HASH_LEN * 2 * dict->size) != 0)\n-\t    return(NULL);\n+        if (xmlDictGrow(dict, MAX_HASH_LEN * 2 * dict->size) != 0)\n+            return(NULL);\n     }\n     /* Note that entry may have been freed at this point by xmlDictGrow */\n \n     return(ret);\n }\n \n+\n /**\n  * xmlDictExists:\n  * @dict: the dictionary\n', 'id': 44, 'location': '/data/vulnloc/libxml2/CVE-2016-1839/src/dict.c:830:5'}, {'diff': "@@ -2483,15 +2483,13 @@\n     return(htmlParseNameComplex(ctxt));\n }\n \n+\n static const xmlChar *\n htmlParseNameComplex(xmlParserCtxtPtr ctxt) {\n     int len = 0, l;\n     int c;\n     int count = 0;\n \n-    /*\n-     * Handler for more complex cases\n-     */\n     GROW;\n     c = CUR_CHAR(l);\n     if ((c == ' ') || (c == '>') || (c == '/') || /* accelerators */\n@@ -2514,10 +2512,16 @@\n \tNEXTL(l);\n \tc = CUR_CHAR(l);\n     }\n+\n+    if (len == 0) { // Ensure length is not zero before lookup\n+        return(NULL);\n+    }\n+    \n     return(xmlDictLookup(ctxt->dict, ctxt->input->cur - len, len));\n }\n \n \n+\n /**\n  * htmlParseHTMLAttribute:\n  * @ctxt:  an HTML parser context\n", 'id': 45, 'location': '/data/vulnloc/libxml2/CVE-2016-1839/src/HTMLparser.c:2517:12'}, {'diff': '@@ -2483,6 +2483,7 @@\n     return(htmlParseNameComplex(ctxt));\n }\n \n+\n static const xmlChar *\n htmlParseNameComplex(xmlParserCtxtPtr ctxt) {\n     int len = 0, l;\n@@ -2514,10 +2515,16 @@\n \tNEXTL(l);\n \tc = CUR_CHAR(l);\n     }\n+    \n+    if (len <= 0) { // Ensure the length is positive before using it\n+        return(NULL);\n+    }\n+    \n     return(xmlDictLookup(ctxt->dict, ctxt->input->cur - len, len));\n }\n \n \n+\n /**\n  * htmlParseHTMLAttribute:\n  * @ctxt:  an HTML parser context\n', 'id': 46, 'location': '/data/vulnloc/libxml2/CVE-2016-1839/src/HTMLparser.c:2517:12'}, {'diff': '@@ -2483,6 +2483,7 @@\n     return(htmlParseNameComplex(ctxt));\n }\n \n+\n static const xmlChar *\n htmlParseNameComplex(xmlParserCtxtPtr ctxt) {\n     int len = 0, l;\n@@ -2514,10 +2515,17 @@\n \tNEXTL(l);\n \tc = CUR_CHAR(l);\n     }\n-    return(xmlDictLookup(ctxt->dict, ctxt->input->cur - len, len));\n+    \n+    // Check for valid length before using it to avoid potential out-of-bounds issues\n+    if (len > 0 && ctxt->input->cur - len >= ctxt->input->base) {\n+        return(xmlDictLookup(ctxt->dict, ctxt->input->cur - len, len));\n+    }\n+    \n+    return NULL; // Return NULL in case of invalid length\n }\n \n \n+\n /**\n  * htmlParseHTMLAttribute:\n  * @ctxt:  an HTML parser context\n', 'id': 47, 'location': '/data/vulnloc/libxml2/CVE-2016-1839/src/HTMLparser.c:2517:12'}, {'diff': '@@ -2483,6 +2483,7 @@\n     return(htmlParseNameComplex(ctxt));\n }\n \n+\n static const xmlChar *\n htmlParseNameComplex(xmlParserCtxtPtr ctxt) {\n     int len = 0, l;\n@@ -2514,10 +2515,16 @@\n \tNEXTL(l);\n \tc = CUR_CHAR(l);\n     }\n+    \n+    if (len == 0) {\n+        return(NULL);\n+    }\n+\n     return(xmlDictLookup(ctxt->dict, ctxt->input->cur - len, len));\n }\n \n \n+\n /**\n  * htmlParseHTMLAttribute:\n  * @ctxt:  an HTML parser context\n', 'id': 48, 'location': '/data/vulnloc/libxml2/CVE-2016-1839/src/HTMLparser.c:2517:12'}, {'diff': '@@ -2483,6 +2483,7 @@\n     return(htmlParseNameComplex(ctxt));\n }\n \n+\n static const xmlChar *\n htmlParseNameComplex(xmlParserCtxtPtr ctxt) {\n     int len = 0, l;\n@@ -2514,10 +2515,17 @@\n \tNEXTL(l);\n \tc = CUR_CHAR(l);\n     }\n+    \n+    // Check for negative length to prevent underflow\n+    if (len < 0) {\n+        return NULL;\n+    }\n+\n     return(xmlDictLookup(ctxt->dict, ctxt->input->cur - len, len));\n }\n \n \n+\n /**\n  * htmlParseHTMLAttribute:\n  * @ctxt:  an HTML parser context\n', 'id': 49, 'location': '/data/vulnloc/libxml2/CVE-2016-1839/src/HTMLparser.c:2517:12'}]2025-02-02 13:31:40.195 | INFO     | scenario:validate:475 - beginning candidate patch evaluation with time limit: 45 minutes
2025-02-02 13:31:40.195 | DEBUG    | scenario:rebuild:369 - original environment: environ({'CONDA_SHLVL': '2', 'LC_ALL': 'C.UTF-8', 'LS_COLORS': 'rs=0:di=01;34:ln=01;36:mh=00:pi=40;33:so=01;35:do=01;35:bd=40;33;01:cd=40;33;01:or=40;31;01:mi=00:su=37;41:sg=30;43:ca=30;41:tw=30;42:ow=34;42:st=37;44:ex=01;32:*.tar=01;31:*.tgz=01;31:*.arc=01;31:*.arj=01;31:*.taz=01;31:*.lha=01;31:*.lz4=01;31:*.lzh=01;31:*.lzma=01;31:*.tlz=01;31:*.txz=01;31:*.tzo=01;31:*.t7z=01;31:*.zip=01;31:*.z=01;31:*.Z=01;31:*.dz=01;31:*.gz=01;31:*.lrz=01;31:*.lz=01;31:*.lzo=01;31:*.xz=01;31:*.zst=01;31:*.tzst=01;31:*.bz2=01;31:*.bz=01;31:*.tbz=01;31:*.tbz2=01;31:*.tz=01;31:*.deb=01;31:*.rpm=01;31:*.jar=01;31:*.war=01;31:*.ear=01;31:*.sar=01;31:*.rar=01;31:*.alz=01;31:*.ace=01;31:*.zoo=01;31:*.cpio=01;31:*.7z=01;31:*.rz=01;31:*.cab=01;31:*.wim=01;31:*.swm=01;31:*.dwm=01;31:*.esd=01;31:*.jpg=01;35:*.jpeg=01;35:*.mjpg=01;35:*.mjpeg=01;35:*.gif=01;35:*.bmp=01;35:*.pbm=01;35:*.pgm=01;35:*.ppm=01;35:*.tga=01;35:*.xbm=01;35:*.xpm=01;35:*.tif=01;35:*.tiff=01;35:*.png=01;35:*.svg=01;35:*.svgz=01;35:*.mng=01;35:*.pcx=01;35:*.mov=01;35:*.mpg=01;35:*.mpeg=01;35:*.m2v=01;35:*.mkv=01;35:*.webm=01;35:*.ogm=01;35:*.mp4=01;35:*.m4v=01;35:*.mp4v=01;35:*.vob=01;35:*.qt=01;35:*.nuv=01;35:*.wmv=01;35:*.asf=01;35:*.rm=01;35:*.rmvb=01;35:*.flc=01;35:*.avi=01;35:*.fli=01;35:*.flv=01;35:*.gl=01;35:*.dl=01;35:*.xcf=01;35:*.xwd=01;35:*.yuv=01;35:*.cgm=01;35:*.emf=01;35:*.ogv=01;35:*.ogx=01;35:*.aac=00;36:*.au=00;36:*.flac=00;36:*.m4a=00;36:*.mid=00;36:*.midi=00;36:*.mka=00;36:*.mp3=00;36:*.mpc=00;36:*.ogg=00;36:*.ra=00;36:*.wav=00;36:*.oga=00;36:*.opus=00;36:*.spx=00;36:*.xspf=00;36:', 'LD_LIBRARY_PATH': '/opt/crashrepair/lib:/CrashRepair/lib:/klee/build/lib:', 'CONDA_EXE': '/root/anaconda3/bin/conda', 'LANG': 'C.UTF-8', 'TZ': 'Asia/Shanghai', 'HOSTNAME': 'fea22102047d', 'OLDPWD': '/orchestrator', 'CONDA_PREFIX': '/root/anaconda3/envs/CrashRepair', '_CE_M': '', 'CC': 'crepair-cc', 'LLVM_COMPILER': 'clang', 'CONDA_PREFIX_1': '/root/anaconda3', 'PWD': '/orchestrator/crashrepair', 'HOME': '/root', 'CONDA_PYTHON_EXE': '/root/anaconda3/bin/python', '_CE_CONDA': '', 'CONDA_PROMPT_MODIFIER': '(CrashRepair) ', 'CXX': 'crepair-cxx', 'TERM': 'xterm', 'SHLVL': '2', 'PYTHONPATH': '/usr/lib/python3.8/site-packages:', 'PATH': '/root/anaconda3/envs/CrashRepair/bin:/root/anaconda3/condabin:~/anaconda3/bin:/opt/crashrepair/bin:/CrashRepair/compiler:/klee/build/bin:/opt/llvm-6/bin:/klee/build/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', 'CONDA_DEFAULT_ENV': 'CrashRepair', '_': '/root/anaconda3/envs/CrashRepair/bin/python'})
2025-02-02 13:31:40.195 | DEBUG    | scenario:rebuild:382 - injecting ghost function into CFLAGS during build: -lcrepair_ghost
2025-02-02 13:31:40.195 | DEBUG    | scenario:rebuild:398 - using environment: {'INJECT_CFLAGS': '-g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address', 'INJECT_CXXFLAGS': '-g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address', 'INJECT_LDFLAGS': '-g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address'}
2025-02-02 13:31:40.196 | DEBUG    | shell:__call__:41 - executing: make clean
Making clean in include
make[1]: Entering directory '/data/vulnloc/libxml2/CVE-2016-1839/src/include'
Making clean in libxml
make[2]: Entering directory '/data/vulnloc/libxml2/CVE-2016-1839/src/include/libxml'
rm -rf .libs _libs
rm -f *.lo
make[2]: Leaving directory '/data/vulnloc/libxml2/CVE-2016-1839/src/include/libxml'
make[2]: Entering directory '/data/vulnloc/libxml2/CVE-2016-1839/src/include'
rm -rf .libs _libs
rm -f *.lo
make[2]: Leaving directory '/data/vulnloc/libxml2/CVE-2016-1839/src/include'
make[1]: Leaving directory '/data/vulnloc/libxml2/CVE-2016-1839/src/include'
Making clean in .
make[1]: Entering directory '/data/vulnloc/libxml2/CVE-2016-1839/src'
 rm -f xmllint xmlcatalog
test -z "runxmlconf.log test.out xml2Conf.sh *.gcda *.gcno *.res" || rm -f runxmlconf.log test.out xml2Conf.sh *.gcda *.gcno *.res
test -z "libxml2.la" || rm -f libxml2.la
rm -f ./so_locations
rm -rf .libs _libs
test -z "testdso.la" || rm -f testdso.la
rm -f ./so_locations
 rm -f testSchemas testRelax testSAX testHTML testXPath testURI testThreads testC14N testAutomata testRegexp testReader testapi testModule runtest runsuite testchar testdict runxmlconf testrecurse testlimits
rm -f *.o
rm -f *.lo
make[1]: Leaving directory '/data/vulnloc/libxml2/CVE-2016-1839/src'
Making clean in doc
make[1]: Entering directory '/data/vulnloc/libxml2/CVE-2016-1839/src/doc'
Making clean in .
make[2]: Entering directory '/data/vulnloc/libxml2/CVE-2016-1839/src/doc'
rm -rf .libs _libs
rm -f *~ *.bak *.hierarchy *.signals *-unused.txt
rm -f *.lo
make[2]: Leaving directory '/data/vulnloc/libxml2/CVE-2016-1839/src/doc'
Making clean in devhelp
make[2]: Entering directory '/data/vulnloc/libxml2/CVE-2016-1839/src/doc/devhelp'
rm -rf .libs _libs
rm -f *.lo
make[2]: Leaving directory '/data/vulnloc/libxml2/CVE-2016-1839/src/doc/devhelp'
Making clean in examples
make[2]: Entering directory '/data/vulnloc/libxml2/CVE-2016-1839/src/doc/examples'
test -z "*.tmp" || rm -f *.tmp
rm -rf .libs _libs
test -f Makefile.am || rm -f test?.xml
 rm -f io1 io2 parse1 parse2 parse3 parse4 reader1 reader2 reader3 reader4 testWriter tree1 tree2 xpath1 xpath2
rm -f *.o
rm -f *.lo
make[2]: Leaving directory '/data/vulnloc/libxml2/CVE-2016-1839/src/doc/examples'
make[1]: Leaving directory '/data/vulnloc/libxml2/CVE-2016-1839/src/doc'
Making clean in example
make[1]: Entering directory '/data/vulnloc/libxml2/CVE-2016-1839/src/example'
rm -rf .libs _libs
 rm -f gjobread
rm -f *.o
rm -f *.lo
make[1]: Leaving directory '/data/vulnloc/libxml2/CVE-2016-1839/src/example'
Making clean in xstc
make[1]: Entering directory '/data/vulnloc/libxml2/CVE-2016-1839/src/xstc'
test -z "nist-test.py ms-test.py sun-test.py test.log" || rm -f nist-test.py ms-test.py sun-test.py test.log
rm -rf .libs _libs
rm -f *.lo
make[1]: Leaving directory '/data/vulnloc/libxml2/CVE-2016-1839/src/xstc'
Making clean in python
make[1]: Entering directory '/data/vulnloc/libxml2/CVE-2016-1839/src/python'
Making clean in .
make[2]: Entering directory '/data/vulnloc/libxml2/CVE-2016-1839/src/python'
test -z "*.pyc" || rm -f *.pyc
rm -rf .libs _libs
test -z "libxml2mod.la" || rm -f libxml2mod.la
rm -f ./so_locations
rm -f *.o
rm -f *.lo
make[2]: Leaving directory '/data/vulnloc/libxml2/CVE-2016-1839/src/python'
Making clean in tests
make[2]: Entering directory '/data/vulnloc/libxml2/CVE-2016-1839/src/python/tests'
test -z "core tmp.xml *.pyc" || rm -f core tmp.xml *.pyc
rm -rf .libs _libs
rm -f *.lo
make[2]: Leaving directory '/data/vulnloc/libxml2/CVE-2016-1839/src/python/tests'
make[1]: Leaving directory '/data/vulnloc/libxml2/CVE-2016-1839/src/python'
2025-02-02 13:31:40.292 | DEBUG    | shell:__call__:41 - executing: make CFLAGS="${INJECT_CFLAGS}" CXXFLAGS="${INJECT_CXXFLAGS}" LDFLAGS="${INJECT_LDFLAGS}" xmllint
  CC       xmllint.o
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_ghost: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
  CC       SAX.lo
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_ghost: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
  CC       entities.lo
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_ghost: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
  CC       encoding.lo
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_ghost: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
  CC       error.lo
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_ghost: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
  CC       parserInternals.lo
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_ghost: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
  CC       parser.lo
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_ghost: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
  CC       tree.lo
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_ghost: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
  CC       hash.lo
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_ghost: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
  CC       list.lo
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_ghost: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
  CC       xmlIO.lo
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_ghost: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
  CC       xmlmemory.lo
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_ghost: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
  CC       uri.lo
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_ghost: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
  CC       valid.lo
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_ghost: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
  CC       xlink.lo
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_ghost: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
  CC       HTMLparser.lo
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_ghost: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
  CC       HTMLtree.lo
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_ghost: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
  CC       debugXML.lo
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_ghost: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
  CC       xpath.lo
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_ghost: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
xpath.c:3146:23: warning: implicit declaration of function 'fabs_crepair' is invalid in C99 [-Wimplicit-function-declaration]
            absolute_value = fabs_crepair(number);
                             ^
xpath.c:12409:28: warning: comparison of two values with different enumeration types ('xmlElementType' and 'xmlXPathTypeVal') [-Wenum-compare]
                    } else if (cur->type == type) {
                               ~~~~~~~~~ ^  ~~~~
2 warnings generated.
xpath.c:3146:23: warning: implicit declaration of function 'fabs_crepair' is invalid in C99 [-Wimplicit-function-declaration]
            absolute_value = fabs_crepair(number);
                             ^
xpath.c:12409:28: warning: comparison of two values with different enumeration types ('xmlElementType' and 'xmlXPathTypeVal') [-Wenum-compare]
                    } else if (cur->type == type) {
                               ~~~~~~~~~ ^  ~~~~
2 warnings generated.
  CC       xpointer.lo
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_ghost: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
  CC       xinclude.lo
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_ghost: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
  CC       nanohttp.lo
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_ghost: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
nanohttp.c:1002:67: warning: passing 'int *' to parameter of type 'socklen_t *' (aka 'unsigned int *') converts between pointers to integer types with different sign [-Wpointer-sign]
        if (getsockopt(s, SOL_SOCKET, SO_ERROR, (char *) &status, &len) <
                                                                  ^~~~
/usr/include/x86_64-linux-gnu/sys/socket.h:210:32: note: passing argument to parameter '__optlen' here
                       socklen_t *__restrict __optlen) __THROW;
                                             ^
nanohttp.c:1537:38: warning: while loop has empty body [-Wempty-body]
        while ( xmlNanoHTTPRecv(ctxt) > 0 ) ;
                                            ^
nanohttp.c:1537:38: note: put the semicolon on a separate line to silence this warning
2 warnings generated.
nanohttp.c:1002:67: warning: passing 'int *' to parameter of type 'socklen_t *' (aka 'unsigned int *') converts between pointers to integer types with different sign [-Wpointer-sign]
        if (getsockopt(s, SOL_SOCKET, SO_ERROR, (char *) &status, &len) <
                                                                  ^~~~
/usr/include/x86_64-linux-gnu/sys/socket.h:210:32: note: passing argument to parameter '__optlen' here
                       socklen_t *__restrict __optlen) __THROW;
                                             ^
nanohttp.c:1537:38: warning: while loop has empty body [-Wempty-body]
        while ( xmlNanoHTTPRecv(ctxt) > 0 ) ;
                                            ^
nanohttp.c:1537:38: note: put the semicolon on a separate line to silence this warning
2 warnings generated.
  CC       nanoftp.lo
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_ghost: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
nanoftp.c:1479:66: warning: passing 'int *' to parameter of type 'socklen_t *' (aka 'unsigned int *') converts between pointers to integer types with different sign [-Wpointer-sign]
        getsockname(ctxt->dataFd, (struct sockaddr *) &dataAddr, &dataAddrLen);
                                                                 ^~~~~~~~~~~~
/usr/include/x86_64-linux-gnu/sys/socket.h:117:26: note: passing argument to parameter '__len' here
                        socklen_t *__restrict __len) __THROW;
                                              ^
nanoftp.c:1492:66: warning: passing 'int *' to parameter of type 'socklen_t *' (aka 'unsigned int *') converts between pointers to integer types with different sign [-Wpointer-sign]
        getsockname(ctxt->dataFd, (struct sockaddr *) &dataAddr, &dataAddrLen);
                                                                 ^~~~~~~~~~~~
/usr/include/x86_64-linux-gnu/sys/socket.h:117:26: note: passing argument to parameter '__len' here
                        socklen_t *__restrict __len) __THROW;
                                              ^
2 warnings generated.
nanoftp.c:1479:66: warning: passing 'int *' to parameter of type 'socklen_t *' (aka 'unsigned int *') converts between pointers to integer types with different sign [-Wpointer-sign]
        getsockname(ctxt->dataFd, (struct sockaddr *) &dataAddr, &dataAddrLen);
                                                                 ^~~~~~~~~~~~
/usr/include/x86_64-linux-gnu/sys/socket.h:117:26: note: passing argument to parameter '__len' here
                        socklen_t *__restrict __len) __THROW;
                                              ^
nanoftp.c:1492:66: warning: passing 'int *' to parameter of type 'socklen_t *' (aka 'unsigned int *') converts between pointers to integer types with different sign [-Wpointer-sign]
        getsockname(ctxt->dataFd, (struct sockaddr *) &dataAddr, &dataAddrLen);
                                                                 ^~~~~~~~~~~~
/usr/include/x86_64-linux-gnu/sys/socket.h:117:26: note: passing argument to parameter '__len' here
                        socklen_t *__restrict __len) __THROW;
                                              ^
2 warnings generated.
  CC       catalog.lo
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_ghost: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
  CC       globals.lo
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_ghost: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
  CC       threads.lo
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_ghost: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
  CC       c14n.lo
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_ghost: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
  CC       xmlstring.lo
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_ghost: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
  CC       buf.lo
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_ghost: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
  CC       xmlregexp.lo
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_ghost: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
  CC       xmlschemas.lo
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_ghost: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
  CC       xmlschemastypes.lo
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_ghost: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
xmlschemastypes.c:5879:35: warning: implicit declaration of function 'fabs_crepair' is invalid in C99 [-Wimplicit-function-declaration]
                day = (unsigned long) FQUOTIENT(fabs_crepair(val->value.dur.sec), 86400);
                                                ^
1 warning generated.
xmlschemastypes.c:5879:35: warning: implicit declaration of function 'fabs_crepair' is invalid in C99 [-Wimplicit-function-declaration]
                day = (unsigned long) FQUOTIENT(fabs_crepair(val->value.dur.sec), 86400);
                                                ^
1 warning generated.
  CC       xmlunicode.lo
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_ghost: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
  CC       xmlreader.lo
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_ghost: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
  CC       relaxng.lo
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_ghost: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
  CC       dict.lo
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_ghost: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
  CC       SAX2.lo
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_ghost: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
  CC       xmlwriter.lo
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_ghost: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
  CC       legacy.lo
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_ghost: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
  CC       chvalid.lo
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_ghost: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
  CC       pattern.lo
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_ghost: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
  CC       xmlsave.lo
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_ghost: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
  CC       xmlmodule.lo
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_ghost: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
  CC       schematron.lo
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_ghost: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
  CC       xzlib.lo
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_ghost: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
  CCLD     libxml2.la
ar: `u' modifier ignored since `D' is the default (see `U')
  CCLD     xmllint
2025-02-02 13:31:49.316 | INFO     | scenario:evaluate:635 - evaluating candidate patch #0:
@@ -440,11 +440,12 @@
  * Calculate a hash key using a fast hash function that works well
  * for low hash table fill.
  */
+
 static unsigned long
 xmlDictComputeFastKey(const xmlChar *name, int namelen, int seed) {
     unsigned long value = seed;
 
-    if (name == NULL) return(0);
+    if (name == NULL || namelen < 0) return(0);
     value = *name;
     value <<= 5;
     if (namelen > 10) {
@@ -452,20 +453,21 @@
         namelen = 10;
     }
     switch (namelen) {
-        case 10: value += name[9];
-        case 9: value += name[8];
-        case 8: value += name[7];
-        case 7: value += name[6];
-        case 6: value += name[5];
-        case 5: value += name[4];
-        case 4: value += name[3];
-        case 3: value += name[2];
-        case 2: value += name[1];
+        case 10: value += name[9]; // fall through
+        case 9: value += name[8];  // fall through
+        case 8: value += name[7];  // fall through
+        case 7: value += name[6];  // fall through
+        case 6: value += name[5];  // fall through
+        case 5: value += name[4];  // fall through
+        case 4: value += name[3];  // fall through
+        case 3: value += name[2];  // fall through
+        case 2: value += name[1];  // fall through
         default: break;
     }
     return(value);
 }
 
+
 /*
  * xmlDictComputeFastQKey:
  *

2025-02-02 13:31:49.326 | DEBUG    | scenario:rebuild:369 - original environment: environ({'CONDA_SHLVL': '2', 'LC_ALL': 'C.UTF-8', 'LS_COLORS': 'rs=0:di=01;34:ln=01;36:mh=00:pi=40;33:so=01;35:do=01;35:bd=40;33;01:cd=40;33;01:or=40;31;01:mi=00:su=37;41:sg=30;43:ca=30;41:tw=30;42:ow=34;42:st=37;44:ex=01;32:*.tar=01;31:*.tgz=01;31:*.arc=01;31:*.arj=01;31:*.taz=01;31:*.lha=01;31:*.lz4=01;31:*.lzh=01;31:*.lzma=01;31:*.tlz=01;31:*.txz=01;31:*.tzo=01;31:*.t7z=01;31:*.zip=01;31:*.z=01;31:*.Z=01;31:*.dz=01;31:*.gz=01;31:*.lrz=01;31:*.lz=01;31:*.lzo=01;31:*.xz=01;31:*.zst=01;31:*.tzst=01;31:*.bz2=01;31:*.bz=01;31:*.tbz=01;31:*.tbz2=01;31:*.tz=01;31:*.deb=01;31:*.rpm=01;31:*.jar=01;31:*.war=01;31:*.ear=01;31:*.sar=01;31:*.rar=01;31:*.alz=01;31:*.ace=01;31:*.zoo=01;31:*.cpio=01;31:*.7z=01;31:*.rz=01;31:*.cab=01;31:*.wim=01;31:*.swm=01;31:*.dwm=01;31:*.esd=01;31:*.jpg=01;35:*.jpeg=01;35:*.mjpg=01;35:*.mjpeg=01;35:*.gif=01;35:*.bmp=01;35:*.pbm=01;35:*.pgm=01;35:*.ppm=01;35:*.tga=01;35:*.xbm=01;35:*.xpm=01;35:*.tif=01;35:*.tiff=01;35:*.png=01;35:*.svg=01;35:*.svgz=01;35:*.mng=01;35:*.pcx=01;35:*.mov=01;35:*.mpg=01;35:*.mpeg=01;35:*.m2v=01;35:*.mkv=01;35:*.webm=01;35:*.ogm=01;35:*.mp4=01;35:*.m4v=01;35:*.mp4v=01;35:*.vob=01;35:*.qt=01;35:*.nuv=01;35:*.wmv=01;35:*.asf=01;35:*.rm=01;35:*.rmvb=01;35:*.flc=01;35:*.avi=01;35:*.fli=01;35:*.flv=01;35:*.gl=01;35:*.dl=01;35:*.xcf=01;35:*.xwd=01;35:*.yuv=01;35:*.cgm=01;35:*.emf=01;35:*.ogv=01;35:*.ogx=01;35:*.aac=00;36:*.au=00;36:*.flac=00;36:*.m4a=00;36:*.mid=00;36:*.midi=00;36:*.mka=00;36:*.mp3=00;36:*.mpc=00;36:*.ogg=00;36:*.ra=00;36:*.wav=00;36:*.oga=00;36:*.opus=00;36:*.spx=00;36:*.xspf=00;36:', 'LD_LIBRARY_PATH': '/opt/crashrepair/lib:/CrashRepair/lib:/klee/build/lib:', 'CONDA_EXE': '/root/anaconda3/bin/conda', 'LANG': 'C.UTF-8', 'TZ': 'Asia/Shanghai', 'HOSTNAME': 'fea22102047d', 'OLDPWD': '/orchestrator', 'CONDA_PREFIX': '/root/anaconda3/envs/CrashRepair', '_CE_M': '', 'CC': 'crepair-cc', 'LLVM_COMPILER': 'clang', 'CONDA_PREFIX_1': '/root/anaconda3', 'PWD': '/orchestrator/crashrepair', 'HOME': '/root', 'CONDA_PYTHON_EXE': '/root/anaconda3/bin/python', '_CE_CONDA': '', 'CONDA_PROMPT_MODIFIER': '(CrashRepair) ', 'CXX': 'crepair-cxx', 'TERM': 'xterm', 'SHLVL': '2', 'PYTHONPATH': '/usr/lib/python3.8/site-packages:', 'PATH': '/root/anaconda3/envs/CrashRepair/bin:/root/anaconda3/condabin:~/anaconda3/bin:/opt/crashrepair/bin:/CrashRepair/compiler:/klee/build/bin:/opt/llvm-6/bin:/klee/build/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', 'CONDA_DEFAULT_ENV': 'CrashRepair', '_': '/root/anaconda3/envs/CrashRepair/bin/python'})
2025-02-02 13:31:49.327 | DEBUG    | scenario:rebuild:382 - injecting ghost function into CFLAGS during build: -lcrepair_ghost
2025-02-02 13:31:49.327 | DEBUG    | scenario:rebuild:398 - using environment: {'INJECT_CFLAGS': '-g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address', 'INJECT_CXXFLAGS': '-g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address', 'INJECT_LDFLAGS': '-g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address'}
2025-02-02 13:31:49.327 | DEBUG    | shell:__call__:41 - executing: make CFLAGS="${INJECT_CFLAGS}" CXXFLAGS="${INJECT_CXXFLAGS}" LDFLAGS="${INJECT_LDFLAGS}" xmllint
  CC       dict.lo
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_ghost: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
  CCLD     libxml2.la
ar: `u' modifier ignored since `D' is the default (see `U')
  CCLD     xmllint
2025-02-02 13:31:49.706 | DEBUG    | scenario:evaluate:655 - testing candidate #0 against test #crash...
2025-02-02 13:31:49.707 | DEBUG    | shell:__call__:41 - executing: /data//vulnloc/libxml2/CVE-2016-1839/src/xmllint -html /CrashRepair/experiments/vulnloc/libxml2/CVE-2016-1839/tests/1.txt
2025-02-02 13:31:49.711 | INFO     | scenario:evaluate:659 - candidate #0 passes test #crash
2025-02-02 13:31:49.711 | INFO     | scenario:evaluate:674 - repair found! candidate #0 passes all tests
2025-02-02 13:31:49.717 | INFO     | scenario:validate:513 - saving successful patch #0...
2025-02-02 13:31:49.718 | INFO     | scenario:validate:520 - stopping search: patch was found

