2025-02-02 15:49:29.120 | INFO     | scenario:build:265 - loaded bug scenario: Scenario(subject='libxml2', name='CVE-2017-5969', directory='/data/vulnloc/libxml2/CVE-2017-5969', build_directory='/data/vulnloc/libxml2/CVE-2017-5969/src', source_directory='/data/vulnloc/libxml2/CVE-2017-5969/src', tag_id='libxml2_CVE-2017-5969', binary_path='/data//vulnloc/libxml2/CVE-2017-5969/src/xmllint', clean_command='make clean', prebuild_command='exit 0', build_command='make CFLAGS="${INJECT_CFLAGS}" CXXFLAGS="${INJECT_CXXFLAGS}" LDFLAGS="${INJECT_LDFLAGS}" xmllint', crashing_command='--recover $POC', crashing_input='/CrashRepair/experiments/vulnloc/libxml2/CVE-2017-5969/tests/1.xml', shell=Shell(cwd='/data/vulnloc/libxml2/CVE-2017-5969'), crash_test=Test(name='crash', command='/data//vulnloc/libxml2/CVE-2017-5969/src/xmllint --recover /CrashRepair/experiments/vulnloc/libxml2/CVE-2017-5969/tests/1.xml', expected_exit_code=0, expected_stdout=None, bad_output='SUMMARY: AddressSanitizer:', asan_options=None, ubsan_options=None), sanitizer_flags='-fsanitize=address', additional_klee_flags='', expected_exit_code_for_crashing_input=0, should_terminate_early=True, fuzzer_tests=[], fuzzer=None, time_limit_minutes_validation=None, time_limit_seconds_single_test=30, time_limit_minutes_analysis=3600, halt_on_error=True, rebuild_for_validation=False, asan_options=None, ubsan_options=None, use_ghost_functions=True, acceptable_patch_limit=None)
2025-02-02 15:49:29.120 | INFO     | scenario:fuzz:426 - skipping fuzzing: fuzzer disabled
2025-02-02 15:49:29.120 | INFO     | analyzer:run:114 - running analysis with timeout: 60 minutes
2025-02-02 15:49:29.120 | DEBUG    | analyzer:write_config_to_file:88 - generated analyzer config:

dir_exp:/data/vulnloc/libxml2/CVE-2017-5969
tag_id:libxml2_CVE-2017-5969
src_directory:/data/vulnloc/libxml2/CVE-2017-5969/src
binary_path:/data//vulnloc/libxml2/CVE-2017-5969/src/xmllint
config_command:exit 0
build_command:make CFLAGS="${INJECT_CFLAGS}" CXXFLAGS="${INJECT_CXXFLAGS}" LDFLAGS="${INJECT_LDFLAGS}" xmllint
test_input_list:--recover $POC
poc_list:/CrashRepair/experiments/vulnloc/libxml2/CVE-2017-5969/tests/1.xml
klee_flags:--link-llvm-lib=/CrashRepair/lib/libcrepair_proxy.bca 

2025-02-02 15:49:29.120 | DEBUG    | analyzer:run:124 - wrote analyzer config file to: /tmp/tmp0ywsgnce
2025-02-02 15:49:29.120 | DEBUG    | shell:__call__:41 - executing: crepair --conf=/tmp/tmp0ywsgnce
[K[1;36m
====================================================================================================

	Starting CRepair (C Crash Repair) 
====================================================================================================
[0m
[K[1;36m
	Loading Configurations
	__________________________________________________________________________________________
[0m
[K	[1;34mreading configuration values from arguments[0m
[K	[1;34mreading configuration values form configuration file[0m
[K	[1;37m	[file] /tmp/tmp0ywsgnce[0m
[K	[1;34mupdating configuration values[0m
[K	[1;34mreading test configuration[0m
[K	[1;34mreading seed information[0m
[K	[1;37m	[config] stack size: 15000[0m
[K	[1;37m	[config] collecting stats: False[0m
[K	[1;37m	[config] number of tests: 1[0m
[K	[1;37m	[config] number of cores: 8[0m
[K	[1;37m	[config] klee concrete execution timeout: 600[0m
[K	[1;37m	[config] klee concolic execution timeout: 1200[0m
[K	[1;37m	[config] synthesize subset expressions: True[0m
[K	[1;37m	[config] window size for taint locations: 500[0m
[K	[1;37m	[config] window size for taint values: 500000[0m
[K[1;36m

	Analyzing Program
====================================================================================================
[0m
[K[1;36m
	Test Case #1
	__________________________________________________________________________________________
[0m
[K[1;36m
		Running Concrete Execution
		------------------------------------------------------------------------------------------
[0m
[K	[1;37m	[0m[K     [1;37mUsing Arguments: ['--recover', '$POC'][0m
[K	[1;37m	[0m[K     [1;37mUsing Input File: /CrashRepair/experiments/vulnloc/libxml2/CVE-2017-5969/tests/1.xml[0m
[K	[1;34m	building program[0m
[K	[1;34m		setting environment variables[0m
[K	[1;34m		cleaning files[0m
[K	[1;34m		configuring program[0m
[K	[1;34m		compiling program[0m
[K	[1;37m	[0m[K     [1;37mUsing Binary: /data//vulnloc/libxml2/CVE-2017-5969/src/xmllint[0m
[K	[1;34m	extracting bytecode[0m
[K	[1;34m	executing klee in concrete mode[0m
[K	[1;34m	extracting instruction trace[0m
[K	[1;37m		[note] program crashed[0m
[K	[1;34m	collecting tainted expressions[0m
[K	[1;34m	collecting tainted concrete values[0m
[K	[1;34m	collecting memory allocations/de-allocations[0m
[K	[1;34m	collecting pointer mapping[0m
[K	[1;34m	extracting crash information[0m
[K	[1;37m		[0m[K     [1;37m[info] crash type: memory read from null pointer[0m
[K	[1;37m		[0m[K     [1;37m[info] crash location: /data/vulnloc/libxml2/CVE-2017-5969/src/valid.c:1181:23[0m
[K	[1;37m		[0m[K     [1;37m[info] crash function: xmlDumpElementContent[0m
[K	[1;37m		[0m[K     [1;37m[info] crash address: 389303[0m
[K	[1;37m		[0m[K     [1;37m[info] crash free constraint: (@var(pointer, content->c2) != NULL)[0m
[K	[1;37m		[0m[K     [1;37m[info] crash inducing variables: content->c2[0m
[K	[1;37m			[info] identified crash type: memory read from null pointer[0m
[K[1;36m
		Running Concolic Execution
		------------------------------------------------------------------------------------------
[0m
[K	[1;37m	[0m[K     [1;37mUsing Arguments: ['--recover', '$POC'][0m
[K	[1;37m	[0m[K     [1;37mUsing Input File: /CrashRepair/experiments/vulnloc/libxml2/CVE-2017-5969/tests/1.xml[0m
[K	[1;34m	building program[0m
[K	[1;34m		setting environment variables[0m
[K	[1;34m		cleaning files[0m
[K	[1;34m		configuring program[0m
[K	[1;34m		compiling program[0m
[K	[1;34m	extracting bytecode[0m
[K	[1;34m	generating ktest file[0m
[K	[1;34m	executing klee in concolic mode[0m
[K	[1;34m	extracting largest symbolic path[0m
[K	[1;34m	extracting instruction trace[0m
[K	[1;37m		[note] program crashed[0m
[K	[1;34m	collecting tainted expressions[0m
[K	[1;34m	collecting memory allocations/de-allocations[0m
[K	[1;34m	collecting pointer mapping[0m
[K	[1;37m		[0m[K     [1;37m[info] Symbolic Mapping: content->c2 -> [bv0][0m
[K[1;36m

	Fix Localization
====================================================================================================
[0m
[K[1;36m
	Generating Fix Locations
	__________________________________________________________________________________________
[0m
[K	[1;34m	generating taint map[0m
[K	[1;37m		[0m[K     [1;37m[info] found 19827 tainted locations[0m
[K	[1;34m		starting parallel computing[0m
[K	[1;34m		waiting for thread completion[0m
[K	[1;37m		[0m[K     [1;37m[info] found 4 source files[0m
[K	[1;37m		[0m[K     [1;37m[info] found 13 executed functions[0m
[K	[1;34m	generating possible fix locations[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] xmlDumpElementContent,
                             /data/vulnloc/libxml2/CVE-2017-5969/src/valid.c:1177:37[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] xmlDumpElementContent,
                             /data/vulnloc/libxml2/CVE-2017-5969/src/valid.c:1177:28[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] xmlDumpElementContent,
                             /data/vulnloc/libxml2/CVE-2017-5969/src/valid.c:1177:23[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] xmlDumpElementContent,
                             /data/vulnloc/libxml2/CVE-2017-5969/src/valid.c:1219:24[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] xmlDumpElementContent,
                             /data/vulnloc/libxml2/CVE-2017-5969/src/valid.c:1213:24[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] xmlDumpElementContent,
                             /data/vulnloc/libxml2/CVE-2017-5969/src/valid.c:1183:21[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] xmlDumpElementContent,
                             /data/vulnloc/libxml2/CVE-2017-5969/src/valid.c:1183:16[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] xmlDumpElementContent,
                             /data/vulnloc/libxml2/CVE-2017-5969/src/valid.c:1183:12[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] xmlDumpElementContent,
                             /data/vulnloc/libxml2/CVE-2017-5969/src/valid.c:1183:3[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] xmlDumpElementContent,
                             /data/vulnloc/libxml2/CVE-2017-5969/src/valid.c:1197:21[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] xmlDumpElementContent,
                             /data/vulnloc/libxml2/CVE-2017-5969/src/valid.c:1197:16[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] xmlDumpElementContent,
                             /data/vulnloc/libxml2/CVE-2017-5969/src/valid.c:1197:12[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] xmlDumpElementContent,
                             /data/vulnloc/libxml2/CVE-2017-5969/src/valid.c:1197:3[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] xmlNodeDumpOutputInternal,
                             /data/vulnloc/libxml2/CVE-2017-5969/src/xmlsave.c:989:6[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] xmlNodeDumpOutputInternal,
                             /data/vulnloc/libxml2/CVE-2017-5969/src/xmlsave.c:989:27[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] xmlNodeDumpOutputInternal,
                             /data/vulnloc/libxml2/CVE-2017-5969/src/xmlsave.c:988:6[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] xmlNodeDumpOutputInternal,
                             /data/vulnloc/libxml2/CVE-2017-5969/src/xmlsave.c:988:57[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] xmlNodeDumpOutputInternal,
                             /data/vulnloc/libxml2/CVE-2017-5969/src/xmlsave.c:988:52[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] xmlNodeDumpOutputInternal,
                             /data/vulnloc/libxml2/CVE-2017-5969/src/xmlsave.c:988:33[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] xmlNodeDumpOutputInternal,
                             /data/vulnloc/libxml2/CVE-2017-5969/src/xmlsave.c:987:6[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] xmlDumpElementDecl,
                             /data/vulnloc/libxml2/CVE-2017-5969/src/valid.c:1687:24[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] xmlDumpElementDecl,
                             /data/vulnloc/libxml2/CVE-2017-5969/src/valid.c:1686:35[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] xmlDumpElementDecl,
                             /data/vulnloc/libxml2/CVE-2017-5969/src/valid.c:1686:29[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] xmlDumpElementDecl,
                             /data/vulnloc/libxml2/CVE-2017-5969/src/valid.c:1686:24[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] xmlDumpElementDecl,
                             /data/vulnloc/libxml2/CVE-2017-5969/src/valid.c:1682:22[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] xmlDumpElementDecl,
                             /data/vulnloc/libxml2/CVE-2017-5969/src/valid.c:1682:15[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] xmlDumpElementDecl, /data/vulnloc/libxml2/CVE-2017-5969/src/valid.c:1682:9[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] xmlDumpElementDecl,
                             /data/vulnloc/libxml2/CVE-2017-5969/src/valid.c:1681:24[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] xmlDumpElementDecl,
                             /data/vulnloc/libxml2/CVE-2017-5969/src/valid.c:1698:24[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] xmlDumpElementContent,
                             /data/vulnloc/libxml2/CVE-2017-5969/src/valid.c:1216:24[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] xmlDumpElementContent,
                             /data/vulnloc/libxml2/CVE-2017-5969/src/valid.c:1200:37[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] xmlDumpElementContent,
                             /data/vulnloc/libxml2/CVE-2017-5969/src/valid.c:1200:28[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] xmlDumpElementContent,
                             /data/vulnloc/libxml2/CVE-2017-5969/src/valid.c:1200:23[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] xmlDumpElementContent,
                             /data/vulnloc/libxml2/CVE-2017-5969/src/valid.c:1196:29[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] xmlDumpElementContent,
                             /data/vulnloc/libxml2/CVE-2017-5969/src/valid.c:1196:24[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] xmlDumpElementContent,
                             /data/vulnloc/libxml2/CVE-2017-5969/src/valid.c:1196:20[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] xmlDumpElementContent,
                             /data/vulnloc/libxml2/CVE-2017-5969/src/valid.c:1196:11[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] xmlDumpElementContent,
                             /data/vulnloc/libxml2/CVE-2017-5969/src/valid.c:1195:28[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] xmlDumpElementContent,
                             /data/vulnloc/libxml2/CVE-2017-5969/src/valid.c:1195:23[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] xmlDumpElementContent,
                             /data/vulnloc/libxml2/CVE-2017-5969/src/valid.c:1195:19[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] xmlDumpElementContent,
                             /data/vulnloc/libxml2/CVE-2017-5969/src/valid.c:1195:10[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] xmlDumpElementContent,
                             /data/vulnloc/libxml2/CVE-2017-5969/src/valid.c:1194:32[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] xmlDumpElementContent,
                             /data/vulnloc/libxml2/CVE-2017-5969/src/valid.c:1165:32[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] xmlDumpElementContent,
                             /data/vulnloc/libxml2/CVE-2017-5969/src/valid.c:1193:37[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] xmlDumpElementContent,
                             /data/vulnloc/libxml2/CVE-2017-5969/src/valid.c:1193:28[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] xmlDumpElementContent,
                             /data/vulnloc/libxml2/CVE-2017-5969/src/valid.c:1193:23[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] xmlDumpElementContent,
                             /data/vulnloc/libxml2/CVE-2017-5969/src/valid.c:1190:28[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] xmlDumpElementContent,
                             /data/vulnloc/libxml2/CVE-2017-5969/src/valid.c:1190:23[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] xmlDumpElementContent,
                             /data/vulnloc/libxml2/CVE-2017-5969/src/valid.c:1190:19[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] xmlDumpElementContent,
                             /data/vulnloc/libxml2/CVE-2017-5969/src/valid.c:1190:10[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] xmlDumpElementContent,
                             /data/vulnloc/libxml2/CVE-2017-5969/src/valid.c:1189:28[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] xmlDumpElementContent,
                             /data/vulnloc/libxml2/CVE-2017-5969/src/valid.c:1189:23[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] xmlDumpElementContent,
                             /data/vulnloc/libxml2/CVE-2017-5969/src/valid.c:1189:19[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] xmlDumpElementContent,
                             /data/vulnloc/libxml2/CVE-2017-5969/src/valid.c:1189:10[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] xmlDumpElementDecl,
                             /data/vulnloc/libxml2/CVE-2017-5969/src/valid.c:1697:38[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] xmlDumpElementDecl,
                             /data/vulnloc/libxml2/CVE-2017-5969/src/valid.c:1697:32[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] xmlDumpElementDecl,
                             /data/vulnloc/libxml2/CVE-2017-5969/src/valid.c:1697:27[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] xmlDumpElementDecl,
                             /data/vulnloc/libxml2/CVE-2017-5969/src/valid.c:1696:24[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] xmlDumpElementDecl,
                             /data/vulnloc/libxml2/CVE-2017-5969/src/valid.c:1695:35[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] xmlDumpElementDecl,
                             /data/vulnloc/libxml2/CVE-2017-5969/src/valid.c:1695:29[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] xmlDumpElementDecl,
                             /data/vulnloc/libxml2/CVE-2017-5969/src/valid.c:1695:24[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] xmlDumpElementDecl,
                             /data/vulnloc/libxml2/CVE-2017-5969/src/valid.c:1691:22[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] xmlDumpElementDecl,
                             /data/vulnloc/libxml2/CVE-2017-5969/src/valid.c:1691:15[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] xmlDumpElementDecl, /data/vulnloc/libxml2/CVE-2017-5969/src/valid.c:1691:9[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] xmlDumpElementDecl,
                             /data/vulnloc/libxml2/CVE-2017-5969/src/valid.c:1690:24[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] xmlDumpElementDecl,
                             /data/vulnloc/libxml2/CVE-2017-5969/src/valid.c:1678:24[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] xmlDumpElementDecl,
                             /data/vulnloc/libxml2/CVE-2017-5969/src/valid.c:1677:35[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] xmlDumpElementDecl,
                             /data/vulnloc/libxml2/CVE-2017-5969/src/valid.c:1677:29[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] xmlDumpElementDecl,
                             /data/vulnloc/libxml2/CVE-2017-5969/src/valid.c:1677:24[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] xmlDumpElementDecl,
                             /data/vulnloc/libxml2/CVE-2017-5969/src/valid.c:1673:22[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] xmlDumpElementDecl,
                             /data/vulnloc/libxml2/CVE-2017-5969/src/valid.c:1673:15[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] xmlDumpElementDecl, /data/vulnloc/libxml2/CVE-2017-5969/src/valid.c:1673:9[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] xmlNodeListDumpOutput,
                             /data/vulnloc/libxml2/CVE-2017-5969/src/xmlsave.c:829:6[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] xmlNodeListDumpOutput,
                             /data/vulnloc/libxml2/CVE-2017-5969/src/xmlsave.c:829:13[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] xmlNodeListDumpOutput,
                             /data/vulnloc/libxml2/CVE-2017-5969/src/xmlsave.c:829:8[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] xmlNodeListDumpOutput,
                             /data/vulnloc/libxml2/CVE-2017-5969/src/xmlsave.c:826:19[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] xmlNodeListDumpOutput,
                             /data/vulnloc/libxml2/CVE-2017-5969/src/xmlsave.c:826:12[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] xmlNodeListDumpOutput,
                             /data/vulnloc/libxml2/CVE-2017-5969/src/xmlsave.c:826:6[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] xmlBufDumpElementDecl,
                             /data/vulnloc/libxml2/CVE-2017-5969/src/xmlsave.c:502:5[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] xmlBufMergeBuffer, /data/vulnloc/libxml2/CVE-2017-5969/src/buf.c:1271:1[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] xmlBufMergeBuffer, /data/vulnloc/libxml2/CVE-2017-5969/src/buf.c:1270:5[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] xmlBufMergeBuffer, /data/vulnloc/libxml2/CVE-2017-5969/src/buf.c:1270:12[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] xmlBufMergeBuffer, /data/vulnloc/libxml2/CVE-2017-5969/src/buf.c:1269:19[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] xmlBufMergeBuffer, /data/vulnloc/libxml2/CVE-2017-5969/src/buf.c:1267:13[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] xmlBufMergeBuffer, /data/vulnloc/libxml2/CVE-2017-5969/src/buf.c:1267:15[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] xmlBufMergeBuffer, /data/vulnloc/libxml2/CVE-2017-5969/src/buf.c:1267:55[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] xmlBufMergeBuffer, /data/vulnloc/libxml2/CVE-2017-5969/src/buf.c:1267:47[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] xmlBufMergeBuffer, /data/vulnloc/libxml2/CVE-2017-5969/src/buf.c:1267:38[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] xmlBufMergeBuffer, /data/vulnloc/libxml2/CVE-2017-5969/src/buf.c:1267:30[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] xmlBufMergeBuffer, /data/vulnloc/libxml2/CVE-2017-5969/src/buf.c:1267:25[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] xmlBufMergeBuffer, /data/vulnloc/libxml2/CVE-2017-5969/src/buf.c:1266:27[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] xmlBufMergeBuffer, /data/vulnloc/libxml2/CVE-2017-5969/src/buf.c:1266:23[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] xmlBufMergeBuffer, /data/vulnloc/libxml2/CVE-2017-5969/src/buf.c:1266:15[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] xmlBufMergeBuffer, /data/vulnloc/libxml2/CVE-2017-5969/src/buf.c:1265:46[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] xmlBufMergeBuffer, /data/vulnloc/libxml2/CVE-2017-5969/src/buf.c:1265:38[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] xmlBufMergeBuffer, /data/vulnloc/libxml2/CVE-2017-5969/src/buf.c:1265:30[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] xmlBufMergeBuffer, /data/vulnloc/libxml2/CVE-2017-5969/src/buf.c:1265:17[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] xmlBufMergeBuffer, /data/vulnloc/libxml2/CVE-2017-5969/src/buf.c:1265:10[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] xmlBufMergeBuffer, /data/vulnloc/libxml2/CVE-2017-5969/src/buf.c:1264:5[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] xmlBufMergeBuffer, /data/vulnloc/libxml2/CVE-2017-5969/src/buf.c:1260:26[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] xmlBufMergeBuffer, /data/vulnloc/libxml2/CVE-2017-5969/src/buf.c:1260:32[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] xmlBufMergeBuffer, /data/vulnloc/libxml2/CVE-2017-5969/src/buf.c:1260:27[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] xmlBufMergeBuffer, /data/vulnloc/libxml2/CVE-2017-5969/src/buf.c:1260:14[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] xmlBufMergeBuffer, /data/vulnloc/libxml2/CVE-2017-5969/src/buf.c:1260:10[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] xmlBufMergeBuffer, /data/vulnloc/libxml2/CVE-2017-5969/src/buf.c:1258:9[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] xmlDumpElementDecl,
                             /data/vulnloc/libxml2/CVE-2017-5969/src/valid.c:1709:24[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] xmlDumpElementContent,
                             /data/vulnloc/libxml2/CVE-2017-5969/src/valid.c:1208:28[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] xmlDumpElementContent,
                             /data/vulnloc/libxml2/CVE-2017-5969/src/valid.c:1186:37[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] xmlDumpElementContent,
                             /data/vulnloc/libxml2/CVE-2017-5969/src/valid.c:1186:28[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] xmlDumpElementContent,
                             /data/vulnloc/libxml2/CVE-2017-5969/src/valid.c:1186:23[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] xmlDumpElementContent,
                             /data/vulnloc/libxml2/CVE-2017-5969/src/valid.c:1182:29[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] xmlDumpElementContent,
                             /data/vulnloc/libxml2/CVE-2017-5969/src/valid.c:1182:24[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] xmlDumpElementContent,
                             /data/vulnloc/libxml2/CVE-2017-5969/src/valid.c:1182:20[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] xmlDumpElementContent,
                             /data/vulnloc/libxml2/CVE-2017-5969/src/valid.c:1182:11[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] xmlDumpElementContent,
                             /data/vulnloc/libxml2/CVE-2017-5969/src/valid.c:1181:28[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] xmlDumpElementContent,
                             /data/vulnloc/libxml2/CVE-2017-5969/src/valid.c:1181:23[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] xmlDumpElementContent,
                             /data/vulnloc/libxml2/CVE-2017-5969/src/valid.c:1181:19[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] xmlDumpElementContent,
                             /data/vulnloc/libxml2/CVE-2017-5969/src/valid.c:1181:10[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] xmlDumpElementContent,
                             /data/vulnloc/libxml2/CVE-2017-5969/src/valid.c:1180:32[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] xmlDumpElementContent,
                             /data/vulnloc/libxml2/CVE-2017-5969/src/valid.c:1209:22[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] xmlDumpElementContent,
                             /data/vulnloc/libxml2/CVE-2017-5969/src/valid.c:1209:13[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] xmlDumpElementContent,
                             /data/vulnloc/libxml2/CVE-2017-5969/src/valid.c:1207:9[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] xmlDumpElementContent,
                             /data/vulnloc/libxml2/CVE-2017-5969/src/valid.c:1172:38[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] xmlDumpElementContent,
                             /data/vulnloc/libxml2/CVE-2017-5969/src/valid.c:1172:29[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] xmlDumpElementContent,
                             /data/vulnloc/libxml2/CVE-2017-5969/src/valid.c:1172:24[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] xmlDumpElementContent,
                             /data/vulnloc/libxml2/CVE-2017-5969/src/valid.c:1168:25[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] xmlDumpElementContent,
                             /data/vulnloc/libxml2/CVE-2017-5969/src/valid.c:1168:18[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] xmlDumpElementContent,
                             /data/vulnloc/libxml2/CVE-2017-5969/src/valid.c:1168:9[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] xmlDumpElementContent,
                             /data/vulnloc/libxml2/CVE-2017-5969/src/valid.c:1179:37[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] xmlDumpElementContent,
                             /data/vulnloc/libxml2/CVE-2017-5969/src/valid.c:1179:28[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] xmlDumpElementContent,
                             /data/vulnloc/libxml2/CVE-2017-5969/src/valid.c:1179:23[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] xmlDumpElementContent,
                             /data/vulnloc/libxml2/CVE-2017-5969/src/valid.c:1176:28[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] xmlDumpElementContent,
                             /data/vulnloc/libxml2/CVE-2017-5969/src/valid.c:1176:23[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] xmlDumpElementContent,
                             /data/vulnloc/libxml2/CVE-2017-5969/src/valid.c:1176:19[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] xmlDumpElementContent,
                             /data/vulnloc/libxml2/CVE-2017-5969/src/valid.c:1176:10[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] xmlDumpElementContent,
                             /data/vulnloc/libxml2/CVE-2017-5969/src/valid.c:1175:28[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] xmlDumpElementContent,
                             /data/vulnloc/libxml2/CVE-2017-5969/src/valid.c:1175:23[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] xmlDumpElementContent,
                             /data/vulnloc/libxml2/CVE-2017-5969/src/valid.c:1175:19[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] xmlDumpElementContent,
                             /data/vulnloc/libxml2/CVE-2017-5969/src/valid.c:1175:10[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] xmlDumpElementContent,
                             /data/vulnloc/libxml2/CVE-2017-5969/src/valid.c:1163:22[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] xmlDumpElementContent,
                             /data/vulnloc/libxml2/CVE-2017-5969/src/valid.c:1163:13[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] xmlDumpElementContent,
                             /data/vulnloc/libxml2/CVE-2017-5969/src/valid.c:1162:34[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] xmlDumpElementContent,
                             /data/vulnloc/libxml2/CVE-2017-5969/src/valid.c:1162:9[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] xmlDumpElementContent,
                             /data/vulnloc/libxml2/CVE-2017-5969/src/valid.c:1160:17[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] xmlDumpElementContent,
                             /data/vulnloc/libxml2/CVE-2017-5969/src/valid.c:1160:9[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] xmlDumpElementContent,
                             /data/vulnloc/libxml2/CVE-2017-5969/src/valid.c:1159:2[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] xmlDumpElementDecl,
                             /data/vulnloc/libxml2/CVE-2017-5969/src/valid.c:1708:38[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] xmlDumpElementDecl,
                             /data/vulnloc/libxml2/CVE-2017-5969/src/valid.c:1708:32[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] xmlDumpElementDecl,
                             /data/vulnloc/libxml2/CVE-2017-5969/src/valid.c:1708:27[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] xmlDumpElementDecl,
                             /data/vulnloc/libxml2/CVE-2017-5969/src/valid.c:1707:24[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] xmlBufferWriteCHAR, /data/vulnloc/libxml2/CVE-2017-5969/src/tree.c:7665:5[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] xmlBufferCat, /data/vulnloc/libxml2/CVE-2017-5969/src/tree.c:7613:1[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] xmlBufferCat, /data/vulnloc/libxml2/CVE-2017-5969/src/tree.c:7612:5[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] xmlBufferCat, /data/vulnloc/libxml2/CVE-2017-5969/src/tree.c:7612:12[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] xmlBufferAdd, /data/vulnloc/libxml2/CVE-2017-5969/src/tree.c:7525:1[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] xmlBufferAdd, /data/vulnloc/libxml2/CVE-2017-5969/src/tree.c:7524:5[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] xmlBufferAdd, /data/vulnloc/libxml2/CVE-2017-5969/src/tree.c:7523:28[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] xmlBufferAdd, /data/vulnloc/libxml2/CVE-2017-5969/src/tree.c:7523:5[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] xmlBufferCat, /data/vulnloc/libxml2/CVE-2017-5969/src/tree.c:7612:30[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] xmlBufferCat, /data/vulnloc/libxml2/CVE-2017-5969/src/tree.c:7612:25[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] xmlDumpElementDecl,
                             /data/vulnloc/libxml2/CVE-2017-5969/src/valid.c:1706:35[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] xmlDumpElementDecl,
                             /data/vulnloc/libxml2/CVE-2017-5969/src/valid.c:1706:29[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] xmlDumpElementDecl,
                             /data/vulnloc/libxml2/CVE-2017-5969/src/valid.c:1706:24[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] xmlDumpElementDecl,
                             /data/vulnloc/libxml2/CVE-2017-5969/src/valid.c:1702:22[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] xmlDumpElementDecl,
                             /data/vulnloc/libxml2/CVE-2017-5969/src/valid.c:1702:15[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] xmlDumpElementDecl, /data/vulnloc/libxml2/CVE-2017-5969/src/valid.c:1702:9[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] xmlBufferWriteChar, /data/vulnloc/libxml2/CVE-2017-5969/src/tree.c:7681:5[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] xmlBufferCCat, /data/vulnloc/libxml2/CVE-2017-5969/src/tree.c:7650:1[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] xmlBufferCCat, /data/vulnloc/libxml2/CVE-2017-5969/src/tree.c:7649:5[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] xmlBufferCCat, /data/vulnloc/libxml2/CVE-2017-5969/src/tree.c:7648:28[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] xmlBufferCCat, /data/vulnloc/libxml2/CVE-2017-5969/src/tree.c:7648:5[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] xmlBufferCCat, /data/vulnloc/libxml2/CVE-2017-5969/src/tree.c:7648:23[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] xmlBufferCCat, /data/vulnloc/libxml2/CVE-2017-5969/src/tree.c:7648:18[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] xmlBufferCCat, /data/vulnloc/libxml2/CVE-2017-5969/src/tree.c:7648:10[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] xmlBufferCCat, /data/vulnloc/libxml2/CVE-2017-5969/src/tree.c:7639:33[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] xmlBufferCCat, /data/vulnloc/libxml2/CVE-2017-5969/src/tree.c:7646:34[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] xmlBufferCCat, /data/vulnloc/libxml2/CVE-2017-5969/src/tree.c:7646:9[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] xmlBufferCCat, /data/vulnloc/libxml2/CVE-2017-5969/src/tree.c:7646:30[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] xmlBufferCCat, /data/vulnloc/libxml2/CVE-2017-5969/src/tree.c:7646:27[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] xmlBufferCCat, /data/vulnloc/libxml2/CVE-2017-5969/src/tree.c:7646:22[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] xmlBufferCCat, /data/vulnloc/libxml2/CVE-2017-5969/src/tree.c:7646:14[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] xmlBufferCCat, /data/vulnloc/libxml2/CVE-2017-5969/src/tree.c:7646:36[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] xmlBufferCCat, /data/vulnloc/libxml2/CVE-2017-5969/src/tree.c:7646:37[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] xmlBufferCCat, /data/vulnloc/libxml2/CVE-2017-5969/src/tree.c:7640:28[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] xmlBufferCCat, /data/vulnloc/libxml2/CVE-2017-5969/src/tree.c:7640:36[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] xmlBufferCCat, /data/vulnloc/libxml2/CVE-2017-5969/src/tree.c:7640:31[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] xmlBufferCCat, /data/vulnloc/libxml2/CVE-2017-5969/src/tree.c:7640:23[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] xmlBufferCCat, /data/vulnloc/libxml2/CVE-2017-5969/src/tree.c:7640:18[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] xmlBufferCCat, /data/vulnloc/libxml2/CVE-2017-5969/src/tree.c:7640:13[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] xmlBufferCCat, /data/vulnloc/libxml2/CVE-2017-5969/src/tree.c:7639:25[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] xmlBufferCCat, /data/vulnloc/libxml2/CVE-2017-5969/src/tree.c:7639:20[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] xmlBufferCCat, /data/vulnloc/libxml2/CVE-2017-5969/src/tree.c:7639:21[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] xmlDumpElementDecl,
                             /data/vulnloc/libxml2/CVE-2017-5969/src/valid.c:1701:24[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] xmlBufferCreate, /data/vulnloc/libxml2/CVE-2017-5969/src/tree.c:7029:1[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] xmlBufferCreate, /data/vulnloc/libxml2/CVE-2017-5969/src/tree.c:7028:5[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] xmlBufferCreate, /data/vulnloc/libxml2/CVE-2017-5969/src/tree.c:7028:12[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] xmlBufferCreate, /data/vulnloc/libxml2/CVE-2017-5969/src/tree.c:7027:20[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] xmlBufferCreate, /data/vulnloc/libxml2/CVE-2017-5969/src/tree.c:7027:10[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] xmlBufferCreate, /data/vulnloc/libxml2/CVE-2017-5969/src/tree.c:7027:5[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] xmlBufferCreate, /data/vulnloc/libxml2/CVE-2017-5969/src/tree.c:7026:21[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] xmlBufferCreate, /data/vulnloc/libxml2/CVE-2017-5969/src/tree.c:7026:5[0m
[K[1;36m
	Localizing Constraints
	__________________________________________________________________________________________
[0m
[K[1;36m
		[fix-loc] /data/vulnloc/libxml2/CVE-2017-5969/src/valid.c:1168:5
		------------------------------------------------------------------------------------------
[0m
[K	[1;37m	[0m[K     [1;37m[constraint] (@var(pointer, content->prefix) != NULL)[0m
[K[1;36m
		[fix-loc] /data/vulnloc/libxml2/CVE-2017-5969/src/valid.c:1177:1
		------------------------------------------------------------------------------------------
[0m
[K	[1;37m	[0m[K     [1;37m[constraint] (@var(pointer, content->prefix) != NULL)[0m
[K[1;36m
		[fix-loc] /data/vulnloc/libxml2/CVE-2017-5969/src/valid.c:1181:5
		------------------------------------------------------------------------------------------
[0m
[K	[1;37m	[0m[K     [1;37m[constraint] (@var(pointer, content->c2) != NULL)[0m
[K[1;36m
		[fix-loc] /data/vulnloc/libxml2/CVE-2017-5969/src/valid.c:1219:5
		------------------------------------------------------------------------------------------
[0m
[K	[1;37m	[0m[K     [1;37m[constraint] (@var(pointer, content->c2) != NULL)[0m
[K[1;36m
		[fix-loc] /data/vulnloc/libxml2/CVE-2017-5969/src/valid.c:1213:5
		------------------------------------------------------------------------------------------
[0m
[K	[1;37m	[0m[K     [1;37m[constraint] (@var(pointer, content->c2) != NULL)[0m
[K[1;36m
		[fix-loc] /data/vulnloc/libxml2/CVE-2017-5969/src/valid.c:1195:5
		------------------------------------------------------------------------------------------
[0m
[K	[1;37m	[0m[K     [1;37m[constraint] (@var(pointer, content->c2) != NULL)[0m
[K[1;36m
		[fix-loc] /data/vulnloc/libxml2/CVE-2017-5969/src/valid.c:1673:5
		------------------------------------------------------------------------------------------
[0m
[K	[1;37m	[0m[K     [1;37m[constraint] (@var(pointer, elem->prefix) != NULL)[0m
[K[1;36m
		[fix-loc] /data/vulnloc/libxml2/CVE-2017-5969/src/valid.c:1682:5
		------------------------------------------------------------------------------------------
[0m
[K	[1;37m	[0m[K     [1;37m[constraint] (@var(pointer, elem->prefix) != NULL)[0m
[K[1;36m
		[fix-loc] /data/vulnloc/libxml2/CVE-2017-5969/src/valid.c:1687:5
		------------------------------------------------------------------------------------------
[0m
[K	[1;37m	[0m[K     [1;37m[constraint] (@var(pointer, elem->prefix) != NULL)[0m
[K[1;36m
		[fix-loc] /data/vulnloc/libxml2/CVE-2017-5969/src/valid.c:1686:5
		------------------------------------------------------------------------------------------
[0m
[K	[1;37m	[0m[K     [1;37m[constraint] (@var(pointer, elem->prefix) != NULL)[0m
[K[1;36m
		[fix-loc] /data/vulnloc/libxml2/CVE-2017-5969/src/valid.c:1681:5
		------------------------------------------------------------------------------------------
[0m
[K	[1;37m	[0m[K     [1;37m[constraint] (@var(pointer, elem->prefix) != NULL)[0m
[K[1;36m
		[fix-loc] /data/vulnloc/libxml2/CVE-2017-5969/src/valid.c:1691:5
		------------------------------------------------------------------------------------------
[0m
[K	[1;37m	[0m[K     [1;37m[constraint] (@var(pointer, elem->prefix) != NULL)[0m
[K[1;36m
		[fix-loc] /data/vulnloc/libxml2/CVE-2017-5969/src/valid.c:1698:5
		------------------------------------------------------------------------------------------
[0m
[K	[1;37m	[0m[K     [1;37m[constraint] (@var(pointer, elem->prefix) != NULL)[0m
[K[1;36m
		[fix-loc] /data/vulnloc/libxml2/CVE-2017-5969/src/valid.c:1216:5
		------------------------------------------------------------------------------------------
[0m
[K	[1;37m	[0m[K     [1;37m[constraint] (@var(pointer, content->c2) != NULL)[0m
[K[1;36m
		[fix-loc] /data/vulnloc/libxml2/CVE-2017-5969/src/valid.c:1200:1
		------------------------------------------------------------------------------------------
[0m
[K	[1;37m	[0m[K     [1;37m[constraint] (@var(pointer, content->c2) != NULL)[0m
[K[1;36m
		[fix-loc] /data/vulnloc/libxml2/CVE-2017-5969/src/valid.c:1194:13
		------------------------------------------------------------------------------------------
[0m
[K	[1;37m	[0m[K     [1;37m[constraint] (@var(pointer, content->c2) != NULL)[0m
[K[1;36m
		[fix-loc] /data/vulnloc/libxml2/CVE-2017-5969/src/valid.c:1193:1
		------------------------------------------------------------------------------------------
[0m
[K	[1;37m	[0m[K     [1;37m[constraint] (@var(pointer, content->c2) != NULL)[0m
[K[1;36m
		[fix-loc] /data/vulnloc/libxml2/CVE-2017-5969/src/valid.c:1189:5
		------------------------------------------------------------------------------------------
[0m
[K	[1;37m	[0m[K     [1;37m[constraint] (@var(pointer, content->c2) != NULL)[0m
[K[1;32m
	localization information saved at /CrashRepair/output/libxml2_CVE-2017-5969/localization.json[0m
[K[1;32m
	state values saved at /CrashRepair/output/libxml2_CVE-2017-5969/values/[0m
[K	[1;37m
Run time statistics:
-----------------------
[0m
[K	[1;37mStartup: 0.000 minutes[0m
[K	[1;37mBuild: 0 minutes[0m
[K	[1;37mConcrete Analysis: 0.883 minutes[0m
[K	[1;37mConcolic Analysis: 1.094 minutes[0m
[K	[1;37mTotal Analysis: 2.174 minutes[0m
[K	[1;37mLocalization: 1.533 minutes[0m
[K[1;32m
CRepair finished successfully after 4.163 minutes 
[0m
2025-02-02 15:53:40.492 | WARNING  | analyzer:run:143 - analysis output directory does not exist [/data/vulnloc/libxml2/CVE-2017-5969/analysis]: creating...
2025-02-02 15:53:42.374 | INFO     | scenario:generate:454 - generating candidate repairs in implicated files: {'/data/vulnloc/libxml2/CVE-2017-5969/src/valid.c'}
total_candidates:[{'diff': '@@ -1155,6 +1155,7 @@\n  *\n  * This will dump the content of the element table as an XML DTD definition\n  */\n+\n static void\n xmlDumpElementContent(xmlBufferPtr buf, xmlElementContentPtr content, int glob) {\n     if (content == NULL) return;\n@@ -1163,64 +1164,67 @@\n     switch (content->type) {\n         case XML_ELEMENT_CONTENT_PCDATA:\n             xmlBufferWriteChar(buf, "#PCDATA");\n-    break;\n-case XML_ELEMENT_CONTENT_ELEMENT:\n-    if (content->prefix != NULL) {\n-xmlBufferWriteCHAR(buf, content->prefix);\n-xmlBufferWriteChar(buf, ":");\n-    }\n-    xmlBufferWriteCHAR(buf, content->name);\n-    break;\n-case XML_ELEMENT_CONTENT_SEQ:\n-    if ((content->c1->type == XML_ELEMENT_CONTENT_OR) ||\n-        (content->c1->type == XML_ELEMENT_CONTENT_SEQ))\n-xmlDumpElementContent(buf, content->c1, 1);\n-    else\n-xmlDumpElementContent(buf, content->c1, 0);\n+            break;\n+        case XML_ELEMENT_CONTENT_ELEMENT:\n+            if (content->prefix != NULL && content->name != NULL) {\n+                xmlBufferWriteCHAR(buf, content->prefix);\n+                xmlBufferWriteChar(buf, ":");\n+            }\n+            if (content->name != NULL) {\n+                xmlBufferWriteCHAR(buf, content->name);\n+            }\n+            break;\n+        case XML_ELEMENT_CONTENT_SEQ:\n+            if ((content->c1->type == XML_ELEMENT_CONTENT_OR) ||\n+                (content->c1->type == XML_ELEMENT_CONTENT_SEQ))\n+                xmlDumpElementContent(buf, content->c1, 1);\n+            else\n+                xmlDumpElementContent(buf, content->c1, 0);\n             xmlBufferWriteChar(buf, " , ");\n-    if ((content->c2->type == XML_ELEMENT_CONTENT_OR) ||\n-        ((content->c2->type == XML_ELEMENT_CONTENT_SEQ) &&\n- (content->c2->ocur != XML_ELEMENT_CONTENT_ONCE)))\n-xmlDumpElementContent(buf, content->c2, 1);\n-    else\n-xmlDumpElementContent(buf, content->c2, 0);\n-    break;\n-case XML_ELEMENT_CONTENT_OR:\n-    if ((content->c1->type == XML_ELEMENT_CONTENT_OR) ||\n-        (content->c1->type == XML_ELEMENT_CONTENT_SEQ))\n-xmlDumpElementContent(buf, content->c1, 1);\n-    else\n-xmlDumpElementContent(buf, content->c1, 0);\n+            if ((content->c2->type == XML_ELEMENT_CONTENT_OR) ||\n+                ((content->c2->type == XML_ELEMENT_CONTENT_SEQ) &&\n+                (content->c2->ocur != XML_ELEMENT_CONTENT_ONCE)))\n+                xmlDumpElementContent(buf, content->c2, 1);\n+            else\n+                xmlDumpElementContent(buf, content->c2, 0);\n+            break;\n+        case XML_ELEMENT_CONTENT_OR:\n+            if ((content->c1->type == XML_ELEMENT_CONTENT_OR) ||\n+                (content->c1->type == XML_ELEMENT_CONTENT_SEQ))\n+                xmlDumpElementContent(buf, content->c1, 1);\n+            else\n+                xmlDumpElementContent(buf, content->c1, 0);\n             xmlBufferWriteChar(buf, " | ");\n-    if ((content->c2->type == XML_ELEMENT_CONTENT_SEQ) ||\n-        ((content->c2->type == XML_ELEMENT_CONTENT_OR) &&\n- (content->c2->ocur != XML_ELEMENT_CONTENT_ONCE)))\n-xmlDumpElementContent(buf, content->c2, 1);\n-    else\n-xmlDumpElementContent(buf, content->c2, 0);\n-    break;\n-default:\n-    xmlErrValid(NULL, XML_ERR_INTERNAL_ERROR,\n-    "Internal: ELEMENT content corrupted invalid type\\n",\n-    NULL);\n+            if ((content->c2->type == XML_ELEMENT_CONTENT_SEQ) ||\n+                ((content->c2->type == XML_ELEMENT_CONTENT_OR) &&\n+                (content->c2->ocur != XML_ELEMENT_CONTENT_ONCE)))\n+                xmlDumpElementContent(buf, content->c2, 1);\n+            else\n+                xmlDumpElementContent(buf, content->c2, 0);\n+            break;\n+        default:\n+            xmlErrValid(NULL, XML_ERR_INTERNAL_ERROR,\n+                "Internal: ELEMENT content corrupted invalid type\\n",\n+                NULL);\n     }\n     if (glob)\n         xmlBufferWriteChar(buf, ")");\n     switch (content->ocur) {\n         case XML_ELEMENT_CONTENT_ONCE:\n-    break;\n+            break;\n         case XML_ELEMENT_CONTENT_OPT:\n-    xmlBufferWriteChar(buf, "?");\n-    break;\n+            xmlBufferWriteChar(buf, "?");\n+            break;\n         case XML_ELEMENT_CONTENT_MULT:\n-    xmlBufferWriteChar(buf, "*");\n-    break;\n+            xmlBufferWriteChar(buf, "*");\n+            break;\n         case XML_ELEMENT_CONTENT_PLUS:\n-    xmlBufferWriteChar(buf, "+");\n-    break;\n+            xmlBufferWriteChar(buf, "+");\n+            break;\n     }\n }\n \n+\n /**\n  * xmlSprintfElementContent:\n  * @buf:  an output buffer\n', 'id': 0, 'location': '/data/vulnloc/libxml2/CVE-2017-5969/src/valid.c:1168:5'}, {'diff': '@@ -1155,6 +1155,7 @@\n  *\n  * This will dump the content of the element table as an XML DTD definition\n  */\n+\n static void\n xmlDumpElementContent(xmlBufferPtr buf, xmlElementContentPtr content, int glob) {\n     if (content == NULL) return;\n@@ -1163,64 +1164,67 @@\n     switch (content->type) {\n         case XML_ELEMENT_CONTENT_PCDATA:\n             xmlBufferWriteChar(buf, "#PCDATA");\n-    break;\n-case XML_ELEMENT_CONTENT_ELEMENT:\n-    if (content->prefix != NULL) {\n-xmlBufferWriteCHAR(buf, content->prefix);\n-xmlBufferWriteChar(buf, ":");\n-    }\n-    xmlBufferWriteCHAR(buf, content->name);\n-    break;\n-case XML_ELEMENT_CONTENT_SEQ:\n-    if ((content->c1->type == XML_ELEMENT_CONTENT_OR) ||\n-        (content->c1->type == XML_ELEMENT_CONTENT_SEQ))\n-xmlDumpElementContent(buf, content->c1, 1);\n-    else\n-xmlDumpElementContent(buf, content->c1, 0);\n+            break;\n+        case XML_ELEMENT_CONTENT_ELEMENT:\n+            if (content->prefix != NULL && content->name != NULL) {\n+                xmlBufferWriteCHAR(buf, content->prefix);\n+                xmlBufferWriteChar(buf, ":");\n+                xmlBufferWriteCHAR(buf, content->name);\n+            } else if (content->name != NULL) {\n+                xmlBufferWriteCHAR(buf, content->name);\n+            }\n+            break;\n+        case XML_ELEMENT_CONTENT_SEQ:\n+            if ((content->c1->type == XML_ELEMENT_CONTENT_OR) ||\n+                (content->c1->type == XML_ELEMENT_CONTENT_SEQ))\n+                xmlDumpElementContent(buf, content->c1, 1);\n+            else\n+                xmlDumpElementContent(buf, content->c1, 0);\n             xmlBufferWriteChar(buf, " , ");\n-    if ((content->c2->type == XML_ELEMENT_CONTENT_OR) ||\n-        ((content->c2->type == XML_ELEMENT_CONTENT_SEQ) &&\n- (content->c2->ocur != XML_ELEMENT_CONTENT_ONCE)))\n-xmlDumpElementContent(buf, content->c2, 1);\n-    else\n-xmlDumpElementContent(buf, content->c2, 0);\n-    break;\n-case XML_ELEMENT_CONTENT_OR:\n-    if ((content->c1->type == XML_ELEMENT_CONTENT_OR) ||\n-        (content->c1->type == XML_ELEMENT_CONTENT_SEQ))\n-xmlDumpElementContent(buf, content->c1, 1);\n-    else\n-xmlDumpElementContent(buf, content->c1, 0);\n+            if ((content->c2->type == XML_ELEMENT_CONTENT_OR) ||\n+                ((content->c2->type == XML_ELEMENT_CONTENT_SEQ) &&\n+                (content->c2->ocur != XML_ELEMENT_CONTENT_ONCE)))\n+                xmlDumpElementContent(buf, content->c2, 1);\n+            else\n+                xmlDumpElementContent(buf, content->c2, 0);\n+            break;\n+        case XML_ELEMENT_CONTENT_OR:\n+            if ((content->c1->type == XML_ELEMENT_CONTENT_OR) ||\n+                (content->c1->type == XML_ELEMENT_CONTENT_SEQ))\n+                xmlDumpElementContent(buf, content->c1, 1);\n+            else\n+                xmlDumpElementContent(buf, content->c1, 0);\n             xmlBufferWriteChar(buf, " | ");\n-    if ((content->c2->type == XML_ELEMENT_CONTENT_SEQ) ||\n-        ((content->c2->type == XML_ELEMENT_CONTENT_OR) &&\n- (content->c2->ocur != XML_ELEMENT_CONTENT_ONCE)))\n-xmlDumpElementContent(buf, content->c2, 1);\n-    else\n-xmlDumpElementContent(buf, content->c2, 0);\n-    break;\n-default:\n-    xmlErrValid(NULL, XML_ERR_INTERNAL_ERROR,\n-    "Internal: ELEMENT content corrupted invalid type\\n",\n-    NULL);\n+            if ((content->c2->type == XML_ELEMENT_CONTENT_SEQ) ||\n+                ((content->c2->type == XML_ELEMENT_CONTENT_OR) &&\n+                (content->c2->ocur != XML_ELEMENT_CONTENT_ONCE)))\n+                xmlDumpElementContent(buf, content->c2, 1);\n+            else\n+                xmlDumpElementContent(buf, content->c2, 0);\n+            break;\n+        default:\n+            xmlErrValid(NULL, XML_ERR_INTERNAL_ERROR,\n+            "Internal: ELEMENT content corrupted invalid type\\n",\n+            NULL);\n     }\n     if (glob)\n         xmlBufferWriteChar(buf, ")");\n     switch (content->ocur) {\n         case XML_ELEMENT_CONTENT_ONCE:\n-    break;\n+            break;\n         case XML_ELEMENT_CONTENT_OPT:\n-    xmlBufferWriteChar(buf, "?");\n-    break;\n+            xmlBufferWriteChar(buf, "?");\n+            break;\n         case XML_ELEMENT_CONTENT_MULT:\n-    xmlBufferWriteChar(buf, "*");\n-    break;\n+            xmlBufferWriteChar(buf, "*");\n+            break;\n         case XML_ELEMENT_CONTENT_PLUS:\n-    xmlBufferWriteChar(buf, "+");\n-    break;\n+            xmlBufferWriteChar(buf, "+");\n+            break;\n     }\n }\n \n+\n /**\n  * xmlSprintfElementContent:\n  * @buf:  an output buffer\n', 'id': 1, 'location': '/data/vulnloc/libxml2/CVE-2017-5969/src/valid.c:1168:5'}, {'diff': '@@ -1155,6 +1155,7 @@\n  *\n  * This will dump the content of the element table as an XML DTD definition\n  */\n+\n static void\n xmlDumpElementContent(xmlBufferPtr buf, xmlElementContentPtr content, int glob) {\n     if (content == NULL) return;\n@@ -1163,64 +1164,67 @@\n     switch (content->type) {\n         case XML_ELEMENT_CONTENT_PCDATA:\n             xmlBufferWriteChar(buf, "#PCDATA");\n-    break;\n-case XML_ELEMENT_CONTENT_ELEMENT:\n-    if (content->prefix != NULL) {\n-xmlBufferWriteCHAR(buf, content->prefix);\n-xmlBufferWriteChar(buf, ":");\n-    }\n-    xmlBufferWriteCHAR(buf, content->name);\n-    break;\n-case XML_ELEMENT_CONTENT_SEQ:\n-    if ((content->c1->type == XML_ELEMENT_CONTENT_OR) ||\n-        (content->c1->type == XML_ELEMENT_CONTENT_SEQ))\n-xmlDumpElementContent(buf, content->c1, 1);\n-    else\n-xmlDumpElementContent(buf, content->c1, 0);\n+            break;\n+        case XML_ELEMENT_CONTENT_ELEMENT:\n+            if (content->name != NULL) {\n+                if (content->prefix != NULL) {\n+                    xmlBufferWriteCHAR(buf, content->prefix);\n+                    xmlBufferWriteChar(buf, ":");\n+                }\n+                xmlBufferWriteCHAR(buf, content->name);\n+            }\n+            break;\n+        case XML_ELEMENT_CONTENT_SEQ:\n+            if ((content->c1->type == XML_ELEMENT_CONTENT_OR) ||\n+                (content->c1->type == XML_ELEMENT_CONTENT_SEQ))\n+                xmlDumpElementContent(buf, content->c1, 1);\n+            else\n+                xmlDumpElementContent(buf, content->c1, 0);\n             xmlBufferWriteChar(buf, " , ");\n-    if ((content->c2->type == XML_ELEMENT_CONTENT_OR) ||\n-        ((content->c2->type == XML_ELEMENT_CONTENT_SEQ) &&\n- (content->c2->ocur != XML_ELEMENT_CONTENT_ONCE)))\n-xmlDumpElementContent(buf, content->c2, 1);\n-    else\n-xmlDumpElementContent(buf, content->c2, 0);\n-    break;\n-case XML_ELEMENT_CONTENT_OR:\n-    if ((content->c1->type == XML_ELEMENT_CONTENT_OR) ||\n-        (content->c1->type == XML_ELEMENT_CONTENT_SEQ))\n-xmlDumpElementContent(buf, content->c1, 1);\n-    else\n-xmlDumpElementContent(buf, content->c1, 0);\n+            if ((content->c2->type == XML_ELEMENT_CONTENT_OR) ||\n+                ((content->c2->type == XML_ELEMENT_CONTENT_SEQ) &&\n+                (content->c2->ocur != XML_ELEMENT_CONTENT_ONCE)))\n+                xmlDumpElementContent(buf, content->c2, 1);\n+            else\n+                xmlDumpElementContent(buf, content->c2, 0);\n+            break;\n+        case XML_ELEMENT_CONTENT_OR:\n+            if ((content->c1->type == XML_ELEMENT_CONTENT_OR) ||\n+                (content->c1->type == XML_ELEMENT_CONTENT_SEQ))\n+                xmlDumpElementContent(buf, content->c1, 1);\n+            else\n+                xmlDumpElementContent(buf, content->c1, 0);\n             xmlBufferWriteChar(buf, " | ");\n-    if ((content->c2->type == XML_ELEMENT_CONTENT_SEQ) ||\n-        ((content->c2->type == XML_ELEMENT_CONTENT_OR) &&\n- (content->c2->ocur != XML_ELEMENT_CONTENT_ONCE)))\n-xmlDumpElementContent(buf, content->c2, 1);\n-    else\n-xmlDumpElementContent(buf, content->c2, 0);\n-    break;\n-default:\n-    xmlErrValid(NULL, XML_ERR_INTERNAL_ERROR,\n-    "Internal: ELEMENT content corrupted invalid type\\n",\n-    NULL);\n+            if ((content->c2->type == XML_ELEMENT_CONTENT_SEQ) ||\n+                ((content->c2->type == XML_ELEMENT_CONTENT_OR) &&\n+                (content->c2->ocur != XML_ELEMENT_CONTENT_ONCE)))\n+                xmlDumpElementContent(buf, content->c2, 1);\n+            else\n+                xmlDumpElementContent(buf, content->c2, 0);\n+            break;\n+        default:\n+            xmlErrValid(NULL, XML_ERR_INTERNAL_ERROR,\n+            "Internal: ELEMENT content corrupted invalid type\\n",\n+            NULL);\n     }\n     if (glob)\n         xmlBufferWriteChar(buf, ")");\n     switch (content->ocur) {\n         case XML_ELEMENT_CONTENT_ONCE:\n-    break;\n+            break;\n         case XML_ELEMENT_CONTENT_OPT:\n-    xmlBufferWriteChar(buf, "?");\n-    break;\n+            xmlBufferWriteChar(buf, "?");\n+            break;\n         case XML_ELEMENT_CONTENT_MULT:\n-    xmlBufferWriteChar(buf, "*");\n-    break;\n+            xmlBufferWriteChar(buf, "*");\n+            break;\n         case XML_ELEMENT_CONTENT_PLUS:\n-    xmlBufferWriteChar(buf, "+");\n-    break;\n+            xmlBufferWriteChar(buf, "+");\n+            break;\n     }\n }\n \n+\n /**\n  * xmlSprintfElementContent:\n  * @buf:  an output buffer\n', 'id': 2, 'location': '/data/vulnloc/libxml2/CVE-2017-5969/src/valid.c:1168:5'}, {'diff': '@@ -1155,6 +1155,7 @@\n  *\n  * This will dump the content of the element table as an XML DTD definition\n  */\n+\n static void\n xmlDumpElementContent(xmlBufferPtr buf, xmlElementContentPtr content, int glob) {\n     if (content == NULL) return;\n@@ -1163,64 +1164,65 @@\n     switch (content->type) {\n         case XML_ELEMENT_CONTENT_PCDATA:\n             xmlBufferWriteChar(buf, "#PCDATA");\n-    break;\n-case XML_ELEMENT_CONTENT_ELEMENT:\n-    if (content->prefix != NULL) {\n-xmlBufferWriteCHAR(buf, content->prefix);\n-xmlBufferWriteChar(buf, ":");\n-    }\n-    xmlBufferWriteCHAR(buf, content->name);\n-    break;\n-case XML_ELEMENT_CONTENT_SEQ:\n-    if ((content->c1->type == XML_ELEMENT_CONTENT_OR) ||\n-        (content->c1->type == XML_ELEMENT_CONTENT_SEQ))\n-xmlDumpElementContent(buf, content->c1, 1);\n-    else\n-xmlDumpElementContent(buf, content->c1, 0);\n+            break;\n+        case XML_ELEMENT_CONTENT_ELEMENT:\n+            if (content->prefix != NULL && content->prefix->type == XML_ELEMENT_CONTENT_PREFIX) {\n+                xmlBufferWriteCHAR(buf, content->prefix);\n+                xmlBufferWriteChar(buf, ":");\n+            }\n+            xmlBufferWriteCHAR(buf, content->name);\n+            break;\n+        case XML_ELEMENT_CONTENT_SEQ:\n+            if ((content->c1->type == XML_ELEMENT_CONTENT_OR) ||\n+                (content->c1->type == XML_ELEMENT_CONTENT_SEQ))\n+                xmlDumpElementContent(buf, content->c1, 1);\n+            else\n+                xmlDumpElementContent(buf, content->c1, 0);\n             xmlBufferWriteChar(buf, " , ");\n-    if ((content->c2->type == XML_ELEMENT_CONTENT_OR) ||\n-        ((content->c2->type == XML_ELEMENT_CONTENT_SEQ) &&\n- (content->c2->ocur != XML_ELEMENT_CONTENT_ONCE)))\n-xmlDumpElementContent(buf, content->c2, 1);\n-    else\n-xmlDumpElementContent(buf, content->c2, 0);\n-    break;\n-case XML_ELEMENT_CONTENT_OR:\n-    if ((content->c1->type == XML_ELEMENT_CONTENT_OR) ||\n-        (content->c1->type == XML_ELEMENT_CONTENT_SEQ))\n-xmlDumpElementContent(buf, content->c1, 1);\n-    else\n-xmlDumpElementContent(buf, content->c1, 0);\n+            if ((content->c2->type == XML_ELEMENT_CONTENT_OR) ||\n+                ((content->c2->type == XML_ELEMENT_CONTENT_SEQ) &&\n+                (content->c2->ocur != XML_ELEMENT_CONTENT_ONCE)))\n+                xmlDumpElementContent(buf, content->c2, 1);\n+            else\n+                xmlDumpElementContent(buf, content->c2, 0);\n+            break;\n+        case XML_ELEMENT_CONTENT_OR:\n+            if ((content->c1->type == XML_ELEMENT_CONTENT_OR) ||\n+                (content->c1->type == XML_ELEMENT_CONTENT_SEQ))\n+                xmlDumpElementContent(buf, content->c1, 1);\n+            else\n+                xmlDumpElementContent(buf, content->c1, 0);\n             xmlBufferWriteChar(buf, " | ");\n-    if ((content->c2->type == XML_ELEMENT_CONTENT_SEQ) ||\n-        ((content->c2->type == XML_ELEMENT_CONTENT_OR) &&\n- (content->c2->ocur != XML_ELEMENT_CONTENT_ONCE)))\n-xmlDumpElementContent(buf, content->c2, 1);\n-    else\n-xmlDumpElementContent(buf, content->c2, 0);\n-    break;\n-default:\n-    xmlErrValid(NULL, XML_ERR_INTERNAL_ERROR,\n-    "Internal: ELEMENT content corrupted invalid type\\n",\n-    NULL);\n+            if ((content->c2->type == XML_ELEMENT_CONTENT_SEQ) ||\n+                ((content->c2->type == XML_ELEMENT_CONTENT_OR) &&\n+                (content->c2->ocur != XML_ELEMENT_CONTENT_ONCE)))\n+                xmlDumpElementContent(buf, content->c2, 1);\n+            else\n+                xmlDumpElementContent(buf, content->c2, 0);\n+            break;\n+        default:\n+            xmlErrValid(NULL, XML_ERR_INTERNAL_ERROR,\n+            "Internal: ELEMENT content corrupted invalid type\\n",\n+            NULL);\n     }\n     if (glob)\n         xmlBufferWriteChar(buf, ")");\n     switch (content->ocur) {\n         case XML_ELEMENT_CONTENT_ONCE:\n-    break;\n+            break;\n         case XML_ELEMENT_CONTENT_OPT:\n-    xmlBufferWriteChar(buf, "?");\n-    break;\n+            xmlBufferWriteChar(buf, "?");\n+            break;\n         case XML_ELEMENT_CONTENT_MULT:\n-    xmlBufferWriteChar(buf, "*");\n-    break;\n+            xmlBufferWriteChar(buf, "*");\n+            break;\n         case XML_ELEMENT_CONTENT_PLUS:\n-    xmlBufferWriteChar(buf, "+");\n-    break;\n+            xmlBufferWriteChar(buf, "+");\n+            break;\n     }\n }\n \n+\n /**\n  * xmlSprintfElementContent:\n  * @buf:  an output buffer\n', 'id': 3, 'location': '/data/vulnloc/libxml2/CVE-2017-5969/src/valid.c:1168:5'}, {'diff': '@@ -1155,6 +1155,7 @@\n  *\n  * This will dump the content of the element table as an XML DTD definition\n  */\n+\n static void\n xmlDumpElementContent(xmlBufferPtr buf, xmlElementContentPtr content, int glob) {\n     if (content == NULL) return;\n@@ -1163,64 +1164,67 @@\n     switch (content->type) {\n         case XML_ELEMENT_CONTENT_PCDATA:\n             xmlBufferWriteChar(buf, "#PCDATA");\n-    break;\n-case XML_ELEMENT_CONTENT_ELEMENT:\n-    if (content->prefix != NULL) {\n-xmlBufferWriteCHAR(buf, content->prefix);\n-xmlBufferWriteChar(buf, ":");\n-    }\n-    xmlBufferWriteCHAR(buf, content->name);\n-    break;\n-case XML_ELEMENT_CONTENT_SEQ:\n-    if ((content->c1->type == XML_ELEMENT_CONTENT_OR) ||\n-        (content->c1->type == XML_ELEMENT_CONTENT_SEQ))\n-xmlDumpElementContent(buf, content->c1, 1);\n-    else\n-xmlDumpElementContent(buf, content->c1, 0);\n+            break;\n+        case XML_ELEMENT_CONTENT_ELEMENT:\n+            if (content->prefix != NULL && content->name != NULL) {\n+                xmlBufferWriteCHAR(buf, content->prefix);\n+                xmlBufferWriteChar(buf, ":");\n+            }\n+            if (content->name != NULL) {\n+                xmlBufferWriteCHAR(buf, content->name);\n+            }\n+            break;\n+        case XML_ELEMENT_CONTENT_SEQ:\n+            if ((content->c1->type == XML_ELEMENT_CONTENT_OR) ||\n+                (content->c1->type == XML_ELEMENT_CONTENT_SEQ))\n+                xmlDumpElementContent(buf, content->c1, 1);\n+            else\n+                xmlDumpElementContent(buf, content->c1, 0);\n             xmlBufferWriteChar(buf, " , ");\n-    if ((content->c2->type == XML_ELEMENT_CONTENT_OR) ||\n-        ((content->c2->type == XML_ELEMENT_CONTENT_SEQ) &&\n- (content->c2->ocur != XML_ELEMENT_CONTENT_ONCE)))\n-xmlDumpElementContent(buf, content->c2, 1);\n-    else\n-xmlDumpElementContent(buf, content->c2, 0);\n-    break;\n-case XML_ELEMENT_CONTENT_OR:\n-    if ((content->c1->type == XML_ELEMENT_CONTENT_OR) ||\n-        (content->c1->type == XML_ELEMENT_CONTENT_SEQ))\n-xmlDumpElementContent(buf, content->c1, 1);\n-    else\n-xmlDumpElementContent(buf, content->c1, 0);\n+            if ((content->c2->type == XML_ELEMENT_CONTENT_OR) ||\n+                ((content->c2->type == XML_ELEMENT_CONTENT_SEQ) &&\n+                 (content->c2->ocur != XML_ELEMENT_CONTENT_ONCE)))\n+                xmlDumpElementContent(buf, content->c2, 1);\n+            else\n+                xmlDumpElementContent(buf, content->c2, 0);\n+            break;\n+        case XML_ELEMENT_CONTENT_OR:\n+            if ((content->c1->type == XML_ELEMENT_CONTENT_OR) ||\n+                (content->c1->type == XML_ELEMENT_CONTENT_SEQ))\n+                xmlDumpElementContent(buf, content->c1, 1);\n+            else\n+                xmlDumpElementContent(buf, content->c1, 0);\n             xmlBufferWriteChar(buf, " | ");\n-    if ((content->c2->type == XML_ELEMENT_CONTENT_SEQ) ||\n-        ((content->c2->type == XML_ELEMENT_CONTENT_OR) &&\n- (content->c2->ocur != XML_ELEMENT_CONTENT_ONCE)))\n-xmlDumpElementContent(buf, content->c2, 1);\n-    else\n-xmlDumpElementContent(buf, content->c2, 0);\n-    break;\n-default:\n-    xmlErrValid(NULL, XML_ERR_INTERNAL_ERROR,\n-    "Internal: ELEMENT content corrupted invalid type\\n",\n-    NULL);\n+            if ((content->c2->type == XML_ELEMENT_CONTENT_SEQ) ||\n+                ((content->c2->type == XML_ELEMENT_CONTENT_OR) &&\n+                 (content->c2->ocur != XML_ELEMENT_CONTENT_ONCE)))\n+                xmlDumpElementContent(buf, content->c2, 1);\n+            else\n+                xmlDumpElementContent(buf, content->c2, 0);\n+            break;\n+        default:\n+            xmlErrValid(NULL, XML_ERR_INTERNAL_ERROR,\n+                         "Internal: ELEMENT content corrupted invalid type\\n",\n+                         NULL);\n     }\n     if (glob)\n         xmlBufferWriteChar(buf, ")");\n     switch (content->ocur) {\n         case XML_ELEMENT_CONTENT_ONCE:\n-    break;\n+            break;\n         case XML_ELEMENT_CONTENT_OPT:\n-    xmlBufferWriteChar(buf, "?");\n-    break;\n+            xmlBufferWriteChar(buf, "?");\n+            break;\n         case XML_ELEMENT_CONTENT_MULT:\n-    xmlBufferWriteChar(buf, "*");\n-    break;\n+            xmlBufferWriteChar(buf, "*");\n+            break;\n         case XML_ELEMENT_CONTENT_PLUS:\n-    xmlBufferWriteChar(buf, "+");\n-    break;\n+            xmlBufferWriteChar(buf, "+");\n+            break;\n     }\n }\n \n+\n /**\n  * xmlSprintfElementContent:\n  * @buf:  an output buffer\n', 'id': 4, 'location': '/data/vulnloc/libxml2/CVE-2017-5969/src/valid.c:1168:5'}, {'diff': '@@ -1155,6 +1155,7 @@\n  *\n  * This will dump the content of the element table as an XML DTD definition\n  */\n+\n static void\n xmlDumpElementContent(xmlBufferPtr buf, xmlElementContentPtr content, int glob) {\n     if (content == NULL) return;\n@@ -1163,64 +1164,69 @@\n     switch (content->type) {\n         case XML_ELEMENT_CONTENT_PCDATA:\n             xmlBufferWriteChar(buf, "#PCDATA");\n-    break;\n-case XML_ELEMENT_CONTENT_ELEMENT:\n-    if (content->prefix != NULL) {\n-xmlBufferWriteCHAR(buf, content->prefix);\n-xmlBufferWriteChar(buf, ":");\n-    }\n-    xmlBufferWriteCHAR(buf, content->name);\n-    break;\n-case XML_ELEMENT_CONTENT_SEQ:\n-    if ((content->c1->type == XML_ELEMENT_CONTENT_OR) ||\n-        (content->c1->type == XML_ELEMENT_CONTENT_SEQ))\n-xmlDumpElementContent(buf, content->c1, 1);\n-    else\n-xmlDumpElementContent(buf, content->c1, 0);\n+            break;\n+        case XML_ELEMENT_CONTENT_ELEMENT:\n+            if (content->prefix != NULL) {\n+                xmlBufferWriteCHAR(buf, content->prefix);\n+                xmlBufferWriteChar(buf, ":");\n+            }\n+            xmlBufferWriteCHAR(buf, content->name);\n+            break;\n+        case XML_ELEMENT_CONTENT_SEQ:\n+            if ((content->c1->type == XML_ELEMENT_CONTENT_OR) ||\n+                (content->c1->type == XML_ELEMENT_CONTENT_SEQ)) {\n+                xmlDumpElementContent(buf, content->c1, 1);\n+            } else {\n+                xmlDumpElementContent(buf, content->c1, 0);\n+            }\n             xmlBufferWriteChar(buf, " , ");\n-    if ((content->c2->type == XML_ELEMENT_CONTENT_OR) ||\n-        ((content->c2->type == XML_ELEMENT_CONTENT_SEQ) &&\n- (content->c2->ocur != XML_ELEMENT_CONTENT_ONCE)))\n-xmlDumpElementContent(buf, content->c2, 1);\n-    else\n-xmlDumpElementContent(buf, content->c2, 0);\n-    break;\n-case XML_ELEMENT_CONTENT_OR:\n-    if ((content->c1->type == XML_ELEMENT_CONTENT_OR) ||\n-        (content->c1->type == XML_ELEMENT_CONTENT_SEQ))\n-xmlDumpElementContent(buf, content->c1, 1);\n-    else\n-xmlDumpElementContent(buf, content->c1, 0);\n+            if ((content->c2->type == XML_ELEMENT_CONTENT_OR) ||\n+                ((content->c2->type == XML_ELEMENT_CONTENT_SEQ) &&\n+                 (content->c2->ocur != XML_ELEMENT_CONTENT_ONCE))) {\n+                xmlDumpElementContent(buf, content->c2, 1);\n+            } else {\n+                xmlDumpElementContent(buf, content->c2, 0);\n+            }\n+            break;\n+        case XML_ELEMENT_CONTENT_OR:\n+            if ((content->c1->type == XML_ELEMENT_CONTENT_OR) ||\n+                (content->c1->type == XML_ELEMENT_CONTENT_SEQ)) {\n+                xmlDumpElementContent(buf, content->c1, 1);\n+            } else {\n+                xmlDumpElementContent(buf, content->c1, 0);\n+            }\n             xmlBufferWriteChar(buf, " | ");\n-    if ((content->c2->type == XML_ELEMENT_CONTENT_SEQ) ||\n-        ((content->c2->type == XML_ELEMENT_CONTENT_OR) &&\n- (content->c2->ocur != XML_ELEMENT_CONTENT_ONCE)))\n-xmlDumpElementContent(buf, content->c2, 1);\n-    else\n-xmlDumpElementContent(buf, content->c2, 0);\n-    break;\n-default:\n-    xmlErrValid(NULL, XML_ERR_INTERNAL_ERROR,\n-    "Internal: ELEMENT content corrupted invalid type\\n",\n-    NULL);\n+            if ((content->c2->type == XML_ELEMENT_CONTENT_SEQ) ||\n+                ((content->c2->type == XML_ELEMENT_CONTENT_OR) &&\n+                 (content->c2->ocur != XML_ELEMENT_CONTENT_ONCE))) {\n+                xmlDumpElementContent(buf, content->c2, 1);\n+            } else {\n+                xmlDumpElementContent(buf, content->c2, 0);\n+            }\n+            break;\n+        default:\n+            xmlErrValid(NULL, XML_ERR_INTERNAL_ERROR,\n+                        "Internal: ELEMENT content corrupted invalid type\\n",\n+                        NULL);\n     }\n     if (glob)\n         xmlBufferWriteChar(buf, ")");\n     switch (content->ocur) {\n         case XML_ELEMENT_CONTENT_ONCE:\n-    break;\n+            break;\n         case XML_ELEMENT_CONTENT_OPT:\n-    xmlBufferWriteChar(buf, "?");\n-    break;\n+            xmlBufferWriteChar(buf, "?");\n+            break;\n         case XML_ELEMENT_CONTENT_MULT:\n-    xmlBufferWriteChar(buf, "*");\n-    break;\n+            xmlBufferWriteChar(buf, "*");\n+            break;\n         case XML_ELEMENT_CONTENT_PLUS:\n-    xmlBufferWriteChar(buf, "+");\n-    break;\n+            xmlBufferWriteChar(buf, "+");\n+            break;\n     }\n }\n \n+\n /**\n  * xmlSprintfElementContent:\n  * @buf:  an output buffer\n', 'id': 5, 'location': '/data/vulnloc/libxml2/CVE-2017-5969/src/valid.c:1177:1'}, {'diff': '@@ -1155,6 +1155,7 @@\n  *\n  * This will dump the content of the element table as an XML DTD definition\n  */\n+\n static void\n xmlDumpElementContent(xmlBufferPtr buf, xmlElementContentPtr content, int glob) {\n     if (content == NULL) return;\n@@ -1163,64 +1164,65 @@\n     switch (content->type) {\n         case XML_ELEMENT_CONTENT_PCDATA:\n             xmlBufferWriteChar(buf, "#PCDATA");\n-    break;\n-case XML_ELEMENT_CONTENT_ELEMENT:\n-    if (content->prefix != NULL) {\n-xmlBufferWriteCHAR(buf, content->prefix);\n-xmlBufferWriteChar(buf, ":");\n-    }\n-    xmlBufferWriteCHAR(buf, content->name);\n-    break;\n-case XML_ELEMENT_CONTENT_SEQ:\n-    if ((content->c1->type == XML_ELEMENT_CONTENT_OR) ||\n-        (content->c1->type == XML_ELEMENT_CONTENT_SEQ))\n-xmlDumpElementContent(buf, content->c1, 1);\n-    else\n-xmlDumpElementContent(buf, content->c1, 0);\n+            break;\n+        case XML_ELEMENT_CONTENT_ELEMENT:\n+            if (content->prefix != NULL) {\n+                xmlBufferWriteCHAR(buf, content->prefix);\n+                xmlBufferWriteChar(buf, ":");\n+            }\n+            xmlBufferWriteCHAR(buf, content->name);\n+            break;\n+        case XML_ELEMENT_CONTENT_SEQ:\n+            if ((content->c1->type == XML_ELEMENT_CONTENT_OR) ||\n+                (content->c1->type == XML_ELEMENT_CONTENT_SEQ))\n+                xmlDumpElementContent(buf, content->c1, 1);\n+            else\n+                xmlDumpElementContent(buf, content->c1, 0);\n             xmlBufferWriteChar(buf, " , ");\n-    if ((content->c2->type == XML_ELEMENT_CONTENT_OR) ||\n-        ((content->c2->type == XML_ELEMENT_CONTENT_SEQ) &&\n- (content->c2->ocur != XML_ELEMENT_CONTENT_ONCE)))\n-xmlDumpElementContent(buf, content->c2, 1);\n-    else\n-xmlDumpElementContent(buf, content->c2, 0);\n-    break;\n-case XML_ELEMENT_CONTENT_OR:\n-    if ((content->c1->type == XML_ELEMENT_CONTENT_OR) ||\n-        (content->c1->type == XML_ELEMENT_CONTENT_SEQ))\n-xmlDumpElementContent(buf, content->c1, 1);\n-    else\n-xmlDumpElementContent(buf, content->c1, 0);\n+            if ((content->c2->type == XML_ELEMENT_CONTENT_OR) ||\n+                ((content->c2->type == XML_ELEMENT_CONTENT_SEQ) &&\n+                 (content->c2->ocur != XML_ELEMENT_CONTENT_ONCE)))\n+                xmlDumpElementContent(buf, content->c2, 1);\n+            else\n+                xmlDumpElementContent(buf, content->c2, 0);\n+            break;\n+        case XML_ELEMENT_CONTENT_OR:\n+            if ((content->c1->type == XML_ELEMENT_CONTENT_OR) ||\n+                (content->c1->type == XML_ELEMENT_CONTENT_SEQ))\n+                xmlDumpElementContent(buf, content->c1, 1);\n+            else\n+                xmlDumpElementContent(buf, content->c1, 0);\n             xmlBufferWriteChar(buf, " | ");\n-    if ((content->c2->type == XML_ELEMENT_CONTENT_SEQ) ||\n-        ((content->c2->type == XML_ELEMENT_CONTENT_OR) &&\n- (content->c2->ocur != XML_ELEMENT_CONTENT_ONCE)))\n-xmlDumpElementContent(buf, content->c2, 1);\n-    else\n-xmlDumpElementContent(buf, content->c2, 0);\n-    break;\n-default:\n-    xmlErrValid(NULL, XML_ERR_INTERNAL_ERROR,\n-    "Internal: ELEMENT content corrupted invalid type\\n",\n-    NULL);\n+            if ((content->c2->type == XML_ELEMENT_CONTENT_SEQ) ||\n+                ((content->c2->type == XML_ELEMENT_CONTENT_OR) &&\n+                 (content->c2->ocur != XML_ELEMENT_CONTENT_ONCE)))\n+                xmlDumpElementContent(buf, content->c2, 1);\n+            else\n+                xmlDumpElementContent(buf, content->c2, 0);\n+            break;\n+        default:\n+            xmlErrValid(NULL, XML_ERR_INTERNAL_ERROR,\n+                        "Internal: ELEMENT content corrupted invalid type\\n",\n+                        NULL);\n     }\n     if (glob)\n         xmlBufferWriteChar(buf, ")");\n     switch (content->ocur) {\n         case XML_ELEMENT_CONTENT_ONCE:\n-    break;\n+            break;\n         case XML_ELEMENT_CONTENT_OPT:\n-    xmlBufferWriteChar(buf, "?");\n-    break;\n+            xmlBufferWriteChar(buf, "?");\n+            break;\n         case XML_ELEMENT_CONTENT_MULT:\n-    xmlBufferWriteChar(buf, "*");\n-    break;\n+            xmlBufferWriteChar(buf, "*");\n+            break;\n         case XML_ELEMENT_CONTENT_PLUS:\n-    xmlBufferWriteChar(buf, "+");\n-    break;\n+            xmlBufferWriteChar(buf, "+");\n+            break;\n     }\n }\n \n+\n /**\n  * xmlSprintfElementContent:\n  * @buf:  an output buffer\n', 'id': 6, 'location': '/data/vulnloc/libxml2/CVE-2017-5969/src/valid.c:1177:1'}, {'diff': '@@ -1155,6 +1155,7 @@\n  *\n  * This will dump the content of the element table as an XML DTD definition\n  */\n+\n static void\n xmlDumpElementContent(xmlBufferPtr buf, xmlElementContentPtr content, int glob) {\n     if (content == NULL) return;\n@@ -1163,64 +1164,69 @@\n     switch (content->type) {\n         case XML_ELEMENT_CONTENT_PCDATA:\n             xmlBufferWriteChar(buf, "#PCDATA");\n-    break;\n-case XML_ELEMENT_CONTENT_ELEMENT:\n-    if (content->prefix != NULL) {\n-xmlBufferWriteCHAR(buf, content->prefix);\n-xmlBufferWriteChar(buf, ":");\n-    }\n-    xmlBufferWriteCHAR(buf, content->name);\n-    break;\n-case XML_ELEMENT_CONTENT_SEQ:\n-    if ((content->c1->type == XML_ELEMENT_CONTENT_OR) ||\n-        (content->c1->type == XML_ELEMENT_CONTENT_SEQ))\n-xmlDumpElementContent(buf, content->c1, 1);\n-    else\n-xmlDumpElementContent(buf, content->c1, 0);\n+            break;\n+        case XML_ELEMENT_CONTENT_ELEMENT:\n+            if (content->prefix != NULL) {\n+                xmlBufferWriteCHAR(buf, content->prefix);\n+                xmlBufferWriteChar(buf, ":");\n+            }\n+            xmlBufferWriteCHAR(buf, content->name);\n+            break;\n+        case XML_ELEMENT_CONTENT_SEQ:\n+            if ((content->c1->type == XML_ELEMENT_CONTENT_OR) ||\n+                (content->c1->type == XML_ELEMENT_CONTENT_SEQ)) {\n+                xmlDumpElementContent(buf, content->c1, 1);\n+            } else {\n+                xmlDumpElementContent(buf, content->c1, 0);\n+            }\n             xmlBufferWriteChar(buf, " , ");\n-    if ((content->c2->type == XML_ELEMENT_CONTENT_OR) ||\n-        ((content->c2->type == XML_ELEMENT_CONTENT_SEQ) &&\n- (content->c2->ocur != XML_ELEMENT_CONTENT_ONCE)))\n-xmlDumpElementContent(buf, content->c2, 1);\n-    else\n-xmlDumpElementContent(buf, content->c2, 0);\n-    break;\n-case XML_ELEMENT_CONTENT_OR:\n-    if ((content->c1->type == XML_ELEMENT_CONTENT_OR) ||\n-        (content->c1->type == XML_ELEMENT_CONTENT_SEQ))\n-xmlDumpElementContent(buf, content->c1, 1);\n-    else\n-xmlDumpElementContent(buf, content->c1, 0);\n+            if ((content->c2->type == XML_ELEMENT_CONTENT_OR) ||\n+                ((content->c2->type == XML_ELEMENT_CONTENT_SEQ) &&\n+                (content->c2->ocur != XML_ELEMENT_CONTENT_ONCE))) {\n+                xmlDumpElementContent(buf, content->c2, 1);\n+            } else {\n+                xmlDumpElementContent(buf, content->c2, 0);\n+            }\n+            break;\n+        case XML_ELEMENT_CONTENT_OR:\n+            if ((content->c1->type == XML_ELEMENT_CONTENT_OR) ||\n+                (content->c1->type == XML_ELEMENT_CONTENT_SEQ)) {\n+                xmlDumpElementContent(buf, content->c1, 1);\n+            } else {\n+                xmlDumpElementContent(buf, content->c1, 0);\n+            }\n             xmlBufferWriteChar(buf, " | ");\n-    if ((content->c2->type == XML_ELEMENT_CONTENT_SEQ) ||\n-        ((content->c2->type == XML_ELEMENT_CONTENT_OR) &&\n- (content->c2->ocur != XML_ELEMENT_CONTENT_ONCE)))\n-xmlDumpElementContent(buf, content->c2, 1);\n-    else\n-xmlDumpElementContent(buf, content->c2, 0);\n-    break;\n-default:\n-    xmlErrValid(NULL, XML_ERR_INTERNAL_ERROR,\n-    "Internal: ELEMENT content corrupted invalid type\\n",\n-    NULL);\n+            if ((content->c2->type == XML_ELEMENT_CONTENT_SEQ) ||\n+                ((content->c2->type == XML_ELEMENT_CONTENT_OR) &&\n+                (content->c2->ocur != XML_ELEMENT_CONTENT_ONCE))) {\n+                xmlDumpElementContent(buf, content->c2, 1);\n+            } else {\n+                xmlDumpElementContent(buf, content->c2, 0);\n+            }\n+            break;\n+        default:\n+            xmlErrValid(NULL, XML_ERR_INTERNAL_ERROR,\n+            "Internal: ELEMENT content corrupted invalid type\\n",\n+            NULL);\n     }\n     if (glob)\n         xmlBufferWriteChar(buf, ")");\n     switch (content->ocur) {\n         case XML_ELEMENT_CONTENT_ONCE:\n-    break;\n+            break;\n         case XML_ELEMENT_CONTENT_OPT:\n-    xmlBufferWriteChar(buf, "?");\n-    break;\n+            xmlBufferWriteChar(buf, "?");\n+            break;\n         case XML_ELEMENT_CONTENT_MULT:\n-    xmlBufferWriteChar(buf, "*");\n-    break;\n+            xmlBufferWriteChar(buf, "*");\n+            break;\n         case XML_ELEMENT_CONTENT_PLUS:\n-    xmlBufferWriteChar(buf, "+");\n-    break;\n+            xmlBufferWriteChar(buf, "+");\n+            break;\n     }\n }\n \n+\n /**\n  * xmlSprintfElementContent:\n  * @buf:  an output buffer\n', 'id': 7, 'location': '/data/vulnloc/libxml2/CVE-2017-5969/src/valid.c:1177:1'}, {'diff': '@@ -1155,6 +1155,7 @@\n  *\n  * This will dump the content of the element table as an XML DTD definition\n  */\n+\n static void\n xmlDumpElementContent(xmlBufferPtr buf, xmlElementContentPtr content, int glob) {\n     if (content == NULL) return;\n@@ -1163,64 +1164,65 @@\n     switch (content->type) {\n         case XML_ELEMENT_CONTENT_PCDATA:\n             xmlBufferWriteChar(buf, "#PCDATA");\n-    break;\n-case XML_ELEMENT_CONTENT_ELEMENT:\n-    if (content->prefix != NULL) {\n-xmlBufferWriteCHAR(buf, content->prefix);\n-xmlBufferWriteChar(buf, ":");\n-    }\n-    xmlBufferWriteCHAR(buf, content->name);\n-    break;\n-case XML_ELEMENT_CONTENT_SEQ:\n-    if ((content->c1->type == XML_ELEMENT_CONTENT_OR) ||\n-        (content->c1->type == XML_ELEMENT_CONTENT_SEQ))\n-xmlDumpElementContent(buf, content->c1, 1);\n-    else\n-xmlDumpElementContent(buf, content->c1, 0);\n+            break;\n+        case XML_ELEMENT_CONTENT_ELEMENT:\n+            if (content->prefix != NULL) {\n+                xmlBufferWriteCHAR(buf, content->prefix);\n+                xmlBufferWriteChar(buf, ":");\n+            }\n+            xmlBufferWriteCHAR(buf, content->name);\n+            break;\n+        case XML_ELEMENT_CONTENT_SEQ:\n+            if ((content->c1->type == XML_ELEMENT_CONTENT_OR) ||\n+                (content->c1->type == XML_ELEMENT_CONTENT_SEQ))\n+                xmlDumpElementContent(buf, content->c1, 1);\n+            else\n+                xmlDumpElementContent(buf, content->c1, 0);\n             xmlBufferWriteChar(buf, " , ");\n-    if ((content->c2->type == XML_ELEMENT_CONTENT_OR) ||\n-        ((content->c2->type == XML_ELEMENT_CONTENT_SEQ) &&\n- (content->c2->ocur != XML_ELEMENT_CONTENT_ONCE)))\n-xmlDumpElementContent(buf, content->c2, 1);\n-    else\n-xmlDumpElementContent(buf, content->c2, 0);\n-    break;\n-case XML_ELEMENT_CONTENT_OR:\n-    if ((content->c1->type == XML_ELEMENT_CONTENT_OR) ||\n-        (content->c1->type == XML_ELEMENT_CONTENT_SEQ))\n-xmlDumpElementContent(buf, content->c1, 1);\n-    else\n-xmlDumpElementContent(buf, content->c1, 0);\n+            if ((content->c2->type == XML_ELEMENT_CONTENT_OR) ||\n+                ((content->c2->type == XML_ELEMENT_CONTENT_SEQ) &&\n+                 (content->c2->ocur != XML_ELEMENT_CONTENT_ONCE)))\n+                xmlDumpElementContent(buf, content->c2, 1);\n+            else\n+                xmlDumpElementContent(buf, content->c2, 0);\n+            break;\n+        case XML_ELEMENT_CONTENT_OR:\n+            if ((content->c1->type == XML_ELEMENT_CONTENT_OR) ||\n+                (content->c1->type == XML_ELEMENT_CONTENT_SEQ))\n+                xmlDumpElementContent(buf, content->c1, 1);\n+            else\n+                xmlDumpElementContent(buf, content->c1, 0);\n             xmlBufferWriteChar(buf, " | ");\n-    if ((content->c2->type == XML_ELEMENT_CONTENT_SEQ) ||\n-        ((content->c2->type == XML_ELEMENT_CONTENT_OR) &&\n- (content->c2->ocur != XML_ELEMENT_CONTENT_ONCE)))\n-xmlDumpElementContent(buf, content->c2, 1);\n-    else\n-xmlDumpElementContent(buf, content->c2, 0);\n-    break;\n-default:\n-    xmlErrValid(NULL, XML_ERR_INTERNAL_ERROR,\n-    "Internal: ELEMENT content corrupted invalid type\\n",\n-    NULL);\n+            if ((content->c2->type == XML_ELEMENT_CONTENT_SEQ) ||\n+                ((content->c2->type == XML_ELEMENT_CONTENT_OR) &&\n+                 (content->c2->ocur != XML_ELEMENT_CONTENT_ONCE)))\n+                xmlDumpElementContent(buf, content->c2, 1);\n+            else\n+                xmlDumpElementContent(buf, content->c2, 0);\n+            break;\n+        default:\n+            xmlErrValid(NULL, XML_ERR_INTERNAL_ERROR,\n+                        "Internal: ELEMENT content corrupted invalid type\\n",\n+                        NULL);\n     }\n     if (glob)\n         xmlBufferWriteChar(buf, ")");\n     switch (content->ocur) {\n         case XML_ELEMENT_CONTENT_ONCE:\n-    break;\n+            break;\n         case XML_ELEMENT_CONTENT_OPT:\n-    xmlBufferWriteChar(buf, "?");\n-    break;\n+            xmlBufferWriteChar(buf, "?");\n+            break;\n         case XML_ELEMENT_CONTENT_MULT:\n-    xmlBufferWriteChar(buf, "*");\n-    break;\n+            xmlBufferWriteChar(buf, "*");\n+            break;\n         case XML_ELEMENT_CONTENT_PLUS:\n-    xmlBufferWriteChar(buf, "+");\n-    break;\n+            xmlBufferWriteChar(buf, "+");\n+            break;\n     }\n }\n \n+\n /**\n  * xmlSprintfElementContent:\n  * @buf:  an output buffer\n', 'id': 8, 'location': '/data/vulnloc/libxml2/CVE-2017-5969/src/valid.c:1177:1'}, {'diff': '@@ -1155,6 +1155,7 @@\n  *\n  * This will dump the content of the element table as an XML DTD definition\n  */\n+\n static void\n xmlDumpElementContent(xmlBufferPtr buf, xmlElementContentPtr content, int glob) {\n     if (content == NULL) return;\n@@ -1163,64 +1164,69 @@\n     switch (content->type) {\n         case XML_ELEMENT_CONTENT_PCDATA:\n             xmlBufferWriteChar(buf, "#PCDATA");\n-    break;\n-case XML_ELEMENT_CONTENT_ELEMENT:\n-    if (content->prefix != NULL) {\n-xmlBufferWriteCHAR(buf, content->prefix);\n-xmlBufferWriteChar(buf, ":");\n-    }\n-    xmlBufferWriteCHAR(buf, content->name);\n-    break;\n-case XML_ELEMENT_CONTENT_SEQ:\n-    if ((content->c1->type == XML_ELEMENT_CONTENT_OR) ||\n-        (content->c1->type == XML_ELEMENT_CONTENT_SEQ))\n-xmlDumpElementContent(buf, content->c1, 1);\n-    else\n-xmlDumpElementContent(buf, content->c1, 0);\n+            break;\n+        case XML_ELEMENT_CONTENT_ELEMENT:\n+            if (content->prefix != NULL) {\n+                xmlBufferWriteCHAR(buf, content->prefix);\n+                xmlBufferWriteChar(buf, ":");\n+            }\n+            xmlBufferWriteCHAR(buf, content->name);\n+            break;\n+        case XML_ELEMENT_CONTENT_SEQ:\n+            if ((content->c1->type == XML_ELEMENT_CONTENT_OR) ||\n+                (content->c1->type == XML_ELEMENT_CONTENT_SEQ)) {\n+                xmlDumpElementContent(buf, content->c1, 1);\n+            } else {\n+                xmlDumpElementContent(buf, content->c1, 0);\n+            }\n             xmlBufferWriteChar(buf, " , ");\n-    if ((content->c2->type == XML_ELEMENT_CONTENT_OR) ||\n-        ((content->c2->type == XML_ELEMENT_CONTENT_SEQ) &&\n- (content->c2->ocur != XML_ELEMENT_CONTENT_ONCE)))\n-xmlDumpElementContent(buf, content->c2, 1);\n-    else\n-xmlDumpElementContent(buf, content->c2, 0);\n-    break;\n-case XML_ELEMENT_CONTENT_OR:\n-    if ((content->c1->type == XML_ELEMENT_CONTENT_OR) ||\n-        (content->c1->type == XML_ELEMENT_CONTENT_SEQ))\n-xmlDumpElementContent(buf, content->c1, 1);\n-    else\n-xmlDumpElementContent(buf, content->c1, 0);\n+            if ((content->c2->type == XML_ELEMENT_CONTENT_OR) ||\n+                ((content->c2->type == XML_ELEMENT_CONTENT_SEQ) && \n+                (content->c2->ocur != XML_ELEMENT_CONTENT_ONCE))) {\n+                xmlDumpElementContent(buf, content->c2, 1);\n+            } else {\n+                xmlDumpElementContent(buf, content->c2, 0);\n+            }\n+            break;\n+        case XML_ELEMENT_CONTENT_OR:\n+            if ((content->c1->type == XML_ELEMENT_CONTENT_OR) ||\n+                (content->c1->type == XML_ELEMENT_CONTENT_SEQ)) {\n+                xmlDumpElementContent(buf, content->c1, 1);\n+            } else {\n+                xmlDumpElementContent(buf, content->c1, 0);\n+            }\n             xmlBufferWriteChar(buf, " | ");\n-    if ((content->c2->type == XML_ELEMENT_CONTENT_SEQ) ||\n-        ((content->c2->type == XML_ELEMENT_CONTENT_OR) &&\n- (content->c2->ocur != XML_ELEMENT_CONTENT_ONCE)))\n-xmlDumpElementContent(buf, content->c2, 1);\n-    else\n-xmlDumpElementContent(buf, content->c2, 0);\n-    break;\n-default:\n-    xmlErrValid(NULL, XML_ERR_INTERNAL_ERROR,\n-    "Internal: ELEMENT content corrupted invalid type\\n",\n-    NULL);\n+            if ((content->c2->type == XML_ELEMENT_CONTENT_SEQ) ||\n+                ((content->c2->type == XML_ELEMENT_CONTENT_OR) && \n+                (content->c2->ocur != XML_ELEMENT_CONTENT_ONCE))) {\n+                xmlDumpElementContent(buf, content->c2, 1);\n+            } else {\n+                xmlDumpElementContent(buf, content->c2, 0);\n+            }\n+            break;\n+        default:\n+            xmlErrValid(NULL, XML_ERR_INTERNAL_ERROR,\n+            "Internal: ELEMENT content corrupted invalid type\\n",\n+            NULL);\n     }\n     if (glob)\n         xmlBufferWriteChar(buf, ")");\n     switch (content->ocur) {\n         case XML_ELEMENT_CONTENT_ONCE:\n-    break;\n+            break;\n         case XML_ELEMENT_CONTENT_OPT:\n-    xmlBufferWriteChar(buf, "?");\n-    break;\n+            xmlBufferWriteChar(buf, "?");\n+            break;\n         case XML_ELEMENT_CONTENT_MULT:\n-    xmlBufferWriteChar(buf, "*");\n-    break;\n+            xmlBufferWriteChar(buf, "*");\n+            break;\n         case XML_ELEMENT_CONTENT_PLUS:\n-    xmlBufferWriteChar(buf, "+");\n-    break;\n+            xmlBufferWriteChar(buf, "+");\n+            break;\n     }\n }\n \n+\n /**\n  * xmlSprintfElementContent:\n  * @buf:  an output buffer\n', 'id': 9, 'location': '/data/vulnloc/libxml2/CVE-2017-5969/src/valid.c:1177:1'}, {'diff': '@@ -1155,6 +1155,7 @@\n  *\n  * This will dump the content of the element table as an XML DTD definition\n  */\n+\n static void\n xmlDumpElementContent(xmlBufferPtr buf, xmlElementContentPtr content, int glob) {\n     if (content == NULL) return;\n@@ -1163,64 +1164,69 @@\n     switch (content->type) {\n         case XML_ELEMENT_CONTENT_PCDATA:\n             xmlBufferWriteChar(buf, "#PCDATA");\n-    break;\n-case XML_ELEMENT_CONTENT_ELEMENT:\n-    if (content->prefix != NULL) {\n-xmlBufferWriteCHAR(buf, content->prefix);\n-xmlBufferWriteChar(buf, ":");\n-    }\n-    xmlBufferWriteCHAR(buf, content->name);\n-    break;\n-case XML_ELEMENT_CONTENT_SEQ:\n-    if ((content->c1->type == XML_ELEMENT_CONTENT_OR) ||\n-        (content->c1->type == XML_ELEMENT_CONTENT_SEQ))\n-xmlDumpElementContent(buf, content->c1, 1);\n-    else\n-xmlDumpElementContent(buf, content->c1, 0);\n+            break;\n+        case XML_ELEMENT_CONTENT_ELEMENT:\n+            if (content->prefix != NULL) {\n+                xmlBufferWriteCHAR(buf, content->prefix);\n+                xmlBufferWriteChar(buf, ":");\n+            }\n+            xmlBufferWriteCHAR(buf, content->name);\n+            break;\n+        case XML_ELEMENT_CONTENT_SEQ:\n+            if ((content->c1 != NULL) && \n+                ((content->c1->type == XML_ELEMENT_CONTENT_OR) ||\n+                 (content->c1->type == XML_ELEMENT_CONTENT_SEQ)))\n+                xmlDumpElementContent(buf, content->c1, 1);\n+            else\n+                xmlDumpElementContent(buf, content->c1, 0);\n             xmlBufferWriteChar(buf, " , ");\n-    if ((content->c2->type == XML_ELEMENT_CONTENT_OR) ||\n-        ((content->c2->type == XML_ELEMENT_CONTENT_SEQ) &&\n- (content->c2->ocur != XML_ELEMENT_CONTENT_ONCE)))\n-xmlDumpElementContent(buf, content->c2, 1);\n-    else\n-xmlDumpElementContent(buf, content->c2, 0);\n-    break;\n-case XML_ELEMENT_CONTENT_OR:\n-    if ((content->c1->type == XML_ELEMENT_CONTENT_OR) ||\n-        (content->c1->type == XML_ELEMENT_CONTENT_SEQ))\n-xmlDumpElementContent(buf, content->c1, 1);\n-    else\n-xmlDumpElementContent(buf, content->c1, 0);\n+            if ((content->c2 != NULL) && \n+                ((content->c2->type == XML_ELEMENT_CONTENT_OR) ||\n+                 ((content->c2->type == XML_ELEMENT_CONTENT_SEQ) &&\n+                  (content->c2->ocur != XML_ELEMENT_CONTENT_ONCE))))\n+                xmlDumpElementContent(buf, content->c2, 1);\n+            else\n+                xmlDumpElementContent(buf, content->c2, 0);\n+            break;\n+        case XML_ELEMENT_CONTENT_OR:\n+            if ((content->c1 != NULL) && \n+                ((content->c1->type == XML_ELEMENT_CONTENT_OR) ||\n+                 (content->c1->type == XML_ELEMENT_CONTENT_SEQ)))\n+                xmlDumpElementContent(buf, content->c1, 1);\n+            else\n+                xmlDumpElementContent(buf, content->c1, 0);\n             xmlBufferWriteChar(buf, " | ");\n-    if ((content->c2->type == XML_ELEMENT_CONTENT_SEQ) ||\n-        ((content->c2->type == XML_ELEMENT_CONTENT_OR) &&\n- (content->c2->ocur != XML_ELEMENT_CONTENT_ONCE)))\n-xmlDumpElementContent(buf, content->c2, 1);\n-    else\n-xmlDumpElementContent(buf, content->c2, 0);\n-    break;\n-default:\n-    xmlErrValid(NULL, XML_ERR_INTERNAL_ERROR,\n-    "Internal: ELEMENT content corrupted invalid type\\n",\n-    NULL);\n+            if ((content->c2 != NULL) && \n+                ((content->c2->type == XML_ELEMENT_CONTENT_SEQ) ||\n+                 ((content->c2->type == XML_ELEMENT_CONTENT_OR) &&\n+                  (content->c2->ocur != XML_ELEMENT_CONTENT_ONCE))))\n+                xmlDumpElementContent(buf, content->c2, 1);\n+            else\n+                xmlDumpElementContent(buf, content->c2, 0);\n+            break;\n+        default:\n+            xmlErrValid(NULL, XML_ERR_INTERNAL_ERROR,\n+                         "Internal: ELEMENT content corrupted invalid type\\n",\n+                         NULL);\n     }\n     if (glob)\n         xmlBufferWriteChar(buf, ")");\n     switch (content->ocur) {\n         case XML_ELEMENT_CONTENT_ONCE:\n-    break;\n+            break;\n         case XML_ELEMENT_CONTENT_OPT:\n-    xmlBufferWriteChar(buf, "?");\n-    break;\n+            xmlBufferWriteChar(buf, "?");\n+            break;\n         case XML_ELEMENT_CONTENT_MULT:\n-    xmlBufferWriteChar(buf, "*");\n-    break;\n+            xmlBufferWriteChar(buf, "*");\n+            break;\n         case XML_ELEMENT_CONTENT_PLUS:\n-    xmlBufferWriteChar(buf, "+");\n-    break;\n+            xmlBufferWriteChar(buf, "+");\n+            break;\n     }\n }\n \n+\n /**\n  * xmlSprintfElementContent:\n  * @buf:  an output buffer\n', 'id': 10, 'location': '/data/vulnloc/libxml2/CVE-2017-5969/src/valid.c:1181:5'}, {'diff': '@@ -1155,6 +1155,7 @@\n  *\n  * This will dump the content of the element table as an XML DTD definition\n  */\n+\n static void\n xmlDumpElementContent(xmlBufferPtr buf, xmlElementContentPtr content, int glob) {\n     if (content == NULL) return;\n@@ -1163,64 +1164,67 @@\n     switch (content->type) {\n         case XML_ELEMENT_CONTENT_PCDATA:\n             xmlBufferWriteChar(buf, "#PCDATA");\n-    break;\n-case XML_ELEMENT_CONTENT_ELEMENT:\n-    if (content->prefix != NULL) {\n-xmlBufferWriteCHAR(buf, content->prefix);\n-xmlBufferWriteChar(buf, ":");\n-    }\n-    xmlBufferWriteCHAR(buf, content->name);\n-    break;\n-case XML_ELEMENT_CONTENT_SEQ:\n-    if ((content->c1->type == XML_ELEMENT_CONTENT_OR) ||\n-        (content->c1->type == XML_ELEMENT_CONTENT_SEQ))\n-xmlDumpElementContent(buf, content->c1, 1);\n-    else\n-xmlDumpElementContent(buf, content->c1, 0);\n+            break;\n+        case XML_ELEMENT_CONTENT_ELEMENT:\n+            if (content->prefix != NULL) {\n+                xmlBufferWriteCHAR(buf, content->prefix);\n+                xmlBufferWriteChar(buf, ":");\n+            }\n+            xmlBufferWriteCHAR(buf, content->name);\n+            break;\n+        case XML_ELEMENT_CONTENT_SEQ:\n+            if ((content->c1->type == XML_ELEMENT_CONTENT_OR) ||\n+                (content->c1->type == XML_ELEMENT_CONTENT_SEQ))\n+                xmlDumpElementContent(buf, content->c1, 1);\n+            else\n+                xmlDumpElementContent(buf, content->c1, 0);\n             xmlBufferWriteChar(buf, " , ");\n-    if ((content->c2->type == XML_ELEMENT_CONTENT_OR) ||\n-        ((content->c2->type == XML_ELEMENT_CONTENT_SEQ) &&\n- (content->c2->ocur != XML_ELEMENT_CONTENT_ONCE)))\n-xmlDumpElementContent(buf, content->c2, 1);\n-    else\n-xmlDumpElementContent(buf, content->c2, 0);\n-    break;\n-case XML_ELEMENT_CONTENT_OR:\n-    if ((content->c1->type == XML_ELEMENT_CONTENT_OR) ||\n-        (content->c1->type == XML_ELEMENT_CONTENT_SEQ))\n-xmlDumpElementContent(buf, content->c1, 1);\n-    else\n-xmlDumpElementContent(buf, content->c1, 0);\n+            if (content->c2 != NULL && \n+                ((content->c2->type == XML_ELEMENT_CONTENT_OR) ||\n+                ((content->c2->type == XML_ELEMENT_CONTENT_SEQ) &&\n+                (content->c2->ocur != XML_ELEMENT_CONTENT_ONCE))))\n+                xmlDumpElementContent(buf, content->c2, 1);\n+            else if (content->c2 != NULL)\n+                xmlDumpElementContent(buf, content->c2, 0);\n+            break;\n+        case XML_ELEMENT_CONTENT_OR:\n+            if ((content->c1->type == XML_ELEMENT_CONTENT_OR) ||\n+                (content->c1->type == XML_ELEMENT_CONTENT_SEQ))\n+                xmlDumpElementContent(buf, content->c1, 1);\n+            else\n+                xmlDumpElementContent(buf, content->c1, 0);\n             xmlBufferWriteChar(buf, " | ");\n-    if ((content->c2->type == XML_ELEMENT_CONTENT_SEQ) ||\n-        ((content->c2->type == XML_ELEMENT_CONTENT_OR) &&\n- (content->c2->ocur != XML_ELEMENT_CONTENT_ONCE)))\n-xmlDumpElementContent(buf, content->c2, 1);\n-    else\n-xmlDumpElementContent(buf, content->c2, 0);\n-    break;\n-default:\n-    xmlErrValid(NULL, XML_ERR_INTERNAL_ERROR,\n-    "Internal: ELEMENT content corrupted invalid type\\n",\n-    NULL);\n+            if (content->c2 != NULL && \n+                ((content->c2->type == XML_ELEMENT_CONTENT_SEQ) ||\n+                ((content->c2->type == XML_ELEMENT_CONTENT_OR) &&\n+                (content->c2->ocur != XML_ELEMENT_CONTENT_ONCE))))\n+                xmlDumpElementContent(buf, content->c2, 1);\n+            else if (content->c2 != NULL)\n+                xmlDumpElementContent(buf, content->c2, 0);\n+            break;\n+        default:\n+            xmlErrValid(NULL, XML_ERR_INTERNAL_ERROR,\n+            "Internal: ELEMENT content corrupted invalid type\\n",\n+            NULL);\n     }\n     if (glob)\n         xmlBufferWriteChar(buf, ")");\n     switch (content->ocur) {\n         case XML_ELEMENT_CONTENT_ONCE:\n-    break;\n+            break;\n         case XML_ELEMENT_CONTENT_OPT:\n-    xmlBufferWriteChar(buf, "?");\n-    break;\n+            xmlBufferWriteChar(buf, "?");\n+            break;\n         case XML_ELEMENT_CONTENT_MULT:\n-    xmlBufferWriteChar(buf, "*");\n-    break;\n+            xmlBufferWriteChar(buf, "*");\n+            break;\n         case XML_ELEMENT_CONTENT_PLUS:\n-    xmlBufferWriteChar(buf, "+");\n-    break;\n+            xmlBufferWriteChar(buf, "+");\n+            break;\n     }\n }\n \n+\n /**\n  * xmlSprintfElementContent:\n  * @buf:  an output buffer\n', 'id': 11, 'location': '/data/vulnloc/libxml2/CVE-2017-5969/src/valid.c:1181:5'}, {'diff': '@@ -1155,6 +1155,7 @@\n  *\n  * This will dump the content of the element table as an XML DTD definition\n  */\n+\n static void\n xmlDumpElementContent(xmlBufferPtr buf, xmlElementContentPtr content, int glob) {\n     if (content == NULL) return;\n@@ -1163,64 +1164,65 @@\n     switch (content->type) {\n         case XML_ELEMENT_CONTENT_PCDATA:\n             xmlBufferWriteChar(buf, "#PCDATA");\n-    break;\n-case XML_ELEMENT_CONTENT_ELEMENT:\n-    if (content->prefix != NULL) {\n-xmlBufferWriteCHAR(buf, content->prefix);\n-xmlBufferWriteChar(buf, ":");\n-    }\n-    xmlBufferWriteCHAR(buf, content->name);\n-    break;\n-case XML_ELEMENT_CONTENT_SEQ:\n-    if ((content->c1->type == XML_ELEMENT_CONTENT_OR) ||\n-        (content->c1->type == XML_ELEMENT_CONTENT_SEQ))\n-xmlDumpElementContent(buf, content->c1, 1);\n-    else\n-xmlDumpElementContent(buf, content->c1, 0);\n+            break;\n+        case XML_ELEMENT_CONTENT_ELEMENT:\n+            if (content->prefix != NULL) {\n+                xmlBufferWriteCHAR(buf, content->prefix);\n+                xmlBufferWriteChar(buf, ":");\n+            }\n+            xmlBufferWriteCHAR(buf, content->name);\n+            break;\n+        case XML_ELEMENT_CONTENT_SEQ:\n+            if ((content->c1 != NULL) && ((content->c1->type == XML_ELEMENT_CONTENT_OR) ||\n+                (content->c1->type == XML_ELEMENT_CONTENT_SEQ)))\n+                xmlDumpElementContent(buf, content->c1, 1);\n+            else if (content->c1 != NULL)\n+                xmlDumpElementContent(buf, content->c1, 0);\n             xmlBufferWriteChar(buf, " , ");\n-    if ((content->c2->type == XML_ELEMENT_CONTENT_OR) ||\n-        ((content->c2->type == XML_ELEMENT_CONTENT_SEQ) &&\n- (content->c2->ocur != XML_ELEMENT_CONTENT_ONCE)))\n-xmlDumpElementContent(buf, content->c2, 1);\n-    else\n-xmlDumpElementContent(buf, content->c2, 0);\n-    break;\n-case XML_ELEMENT_CONTENT_OR:\n-    if ((content->c1->type == XML_ELEMENT_CONTENT_OR) ||\n-        (content->c1->type == XML_ELEMENT_CONTENT_SEQ))\n-xmlDumpElementContent(buf, content->c1, 1);\n-    else\n-xmlDumpElementContent(buf, content->c1, 0);\n+            if ((content->c2 != NULL) && ((content->c2->type == XML_ELEMENT_CONTENT_OR) ||\n+                ((content->c2->type == XML_ELEMENT_CONTENT_SEQ) &&\n+                 (content->c2->ocur != XML_ELEMENT_CONTENT_ONCE))))\n+                xmlDumpElementContent(buf, content->c2, 1);\n+            else if (content->c2 != NULL)\n+                xmlDumpElementContent(buf, content->c2, 0);\n+            break;\n+        case XML_ELEMENT_CONTENT_OR:\n+            if ((content->c1 != NULL) && ((content->c1->type == XML_ELEMENT_CONTENT_OR) ||\n+                (content->c1->type == XML_ELEMENT_CONTENT_SEQ)))\n+                xmlDumpElementContent(buf, content->c1, 1);\n+            else if (content->c1 != NULL)\n+                xmlDumpElementContent(buf, content->c1, 0);\n             xmlBufferWriteChar(buf, " | ");\n-    if ((content->c2->type == XML_ELEMENT_CONTENT_SEQ) ||\n-        ((content->c2->type == XML_ELEMENT_CONTENT_OR) &&\n- (content->c2->ocur != XML_ELEMENT_CONTENT_ONCE)))\n-xmlDumpElementContent(buf, content->c2, 1);\n-    else\n-xmlDumpElementContent(buf, content->c2, 0);\n-    break;\n-default:\n-    xmlErrValid(NULL, XML_ERR_INTERNAL_ERROR,\n-    "Internal: ELEMENT content corrupted invalid type\\n",\n-    NULL);\n+            if ((content->c2 != NULL) && ((content->c2->type == XML_ELEMENT_CONTENT_SEQ) ||\n+                ((content->c2->type == XML_ELEMENT_CONTENT_OR) &&\n+                 (content->c2->ocur != XML_ELEMENT_CONTENT_ONCE))))\n+                xmlDumpElementContent(buf, content->c2, 1);\n+            else if (content->c2 != NULL)\n+                xmlDumpElementContent(buf, content->c2, 0);\n+            break;\n+        default:\n+            xmlErrValid(NULL, XML_ERR_INTERNAL_ERROR,\n+                "Internal: ELEMENT content corrupted invalid type\\n",\n+                NULL);\n     }\n     if (glob)\n         xmlBufferWriteChar(buf, ")");\n     switch (content->ocur) {\n         case XML_ELEMENT_CONTENT_ONCE:\n-    break;\n+            break;\n         case XML_ELEMENT_CONTENT_OPT:\n-    xmlBufferWriteChar(buf, "?");\n-    break;\n+            xmlBufferWriteChar(buf, "?");\n+            break;\n         case XML_ELEMENT_CONTENT_MULT:\n-    xmlBufferWriteChar(buf, "*");\n-    break;\n+            xmlBufferWriteChar(buf, "*");\n+            break;\n         case XML_ELEMENT_CONTENT_PLUS:\n-    xmlBufferWriteChar(buf, "+");\n-    break;\n+            xmlBufferWriteChar(buf, "+");\n+            break;\n     }\n }\n \n+\n /**\n  * xmlSprintfElementContent:\n  * @buf:  an output buffer\n', 'id': 12, 'location': '/data/vulnloc/libxml2/CVE-2017-5969/src/valid.c:1181:5'}, {'diff': '@@ -1155,6 +1155,7 @@\n  *\n  * This will dump the content of the element table as an XML DTD definition\n  */\n+\n static void\n xmlDumpElementContent(xmlBufferPtr buf, xmlElementContentPtr content, int glob) {\n     if (content == NULL) return;\n@@ -1163,64 +1164,72 @@\n     switch (content->type) {\n         case XML_ELEMENT_CONTENT_PCDATA:\n             xmlBufferWriteChar(buf, "#PCDATA");\n-    break;\n-case XML_ELEMENT_CONTENT_ELEMENT:\n-    if (content->prefix != NULL) {\n-xmlBufferWriteCHAR(buf, content->prefix);\n-xmlBufferWriteChar(buf, ":");\n-    }\n-    xmlBufferWriteCHAR(buf, content->name);\n-    break;\n-case XML_ELEMENT_CONTENT_SEQ:\n-    if ((content->c1->type == XML_ELEMENT_CONTENT_OR) ||\n-        (content->c1->type == XML_ELEMENT_CONTENT_SEQ))\n-xmlDumpElementContent(buf, content->c1, 1);\n-    else\n-xmlDumpElementContent(buf, content->c1, 0);\n+            break;\n+        case XML_ELEMENT_CONTENT_ELEMENT:\n+            if (content->prefix != NULL) {\n+                xmlBufferWriteCHAR(buf, content->prefix);\n+                xmlBufferWriteChar(buf, ":");\n+            }\n+            xmlBufferWriteCHAR(buf, content->name);\n+            break;\n+        case XML_ELEMENT_CONTENT_SEQ:\n+            if ((content->c1->type == XML_ELEMENT_CONTENT_OR) ||\n+                (content->c1->type == XML_ELEMENT_CONTENT_SEQ)) {\n+                xmlDumpElementContent(buf, content->c1, 1);\n+            } else {\n+                xmlDumpElementContent(buf, content->c1, 0);\n+            }\n             xmlBufferWriteChar(buf, " , ");\n-    if ((content->c2->type == XML_ELEMENT_CONTENT_OR) ||\n-        ((content->c2->type == XML_ELEMENT_CONTENT_SEQ) &&\n- (content->c2->ocur != XML_ELEMENT_CONTENT_ONCE)))\n-xmlDumpElementContent(buf, content->c2, 1);\n-    else\n-xmlDumpElementContent(buf, content->c2, 0);\n-    break;\n-case XML_ELEMENT_CONTENT_OR:\n-    if ((content->c1->type == XML_ELEMENT_CONTENT_OR) ||\n-        (content->c1->type == XML_ELEMENT_CONTENT_SEQ))\n-xmlDumpElementContent(buf, content->c1, 1);\n-    else\n-xmlDumpElementContent(buf, content->c1, 0);\n+            if (content->c2 != NULL && \n+                ((content->c2->type == XML_ELEMENT_CONTENT_OR) ||\n+                ((content->c2->type == XML_ELEMENT_CONTENT_SEQ) &&\n+                (content->c2->ocur != XML_ELEMENT_CONTENT_ONCE)))) {\n+                xmlDumpElementContent(buf, content->c2, 1);\n+            } else if (content->c2 != NULL) {\n+                xmlDumpElementContent(buf, content->c2, 0);\n+            }\n+            break;\n+        case XML_ELEMENT_CONTENT_OR:\n+            if ((content->c1->type == XML_ELEMENT_CONTENT_OR) ||\n+                (content->c1->type == XML_ELEMENT_CONTENT_SEQ)) {\n+                xmlDumpElementContent(buf, content->c1, 1);\n+            } else {\n+                xmlDumpElementContent(buf, content->c1, 0);\n+            }\n             xmlBufferWriteChar(buf, " | ");\n-    if ((content->c2->type == XML_ELEMENT_CONTENT_SEQ) ||\n-        ((content->c2->type == XML_ELEMENT_CONTENT_OR) &&\n- (content->c2->ocur != XML_ELEMENT_CONTENT_ONCE)))\n-xmlDumpElementContent(buf, content->c2, 1);\n-    else\n-xmlDumpElementContent(buf, content->c2, 0);\n-    break;\n-default:\n-    xmlErrValid(NULL, XML_ERR_INTERNAL_ERROR,\n-    "Internal: ELEMENT content corrupted invalid type\\n",\n-    NULL);\n+            if (content->c2 != NULL && \n+                ((content->c2->type == XML_ELEMENT_CONTENT_SEQ) ||\n+                ((content->c2->type == XML_ELEMENT_CONTENT_OR) &&\n+                (content->c2->ocur != XML_ELEMENT_CONTENT_ONCE)))) {\n+                xmlDumpElementContent(buf, content->c2, 1);\n+            } else if (content->c2 != NULL) {\n+                xmlDumpElementContent(buf, content->c2, 0);\n+            }\n+            break;\n+        default:\n+            xmlErrValid(NULL, XML_ERR_INTERNAL_ERROR,\n+            "Internal: ELEMENT content corrupted invalid type\\n",\n+            NULL);\n+            break;\n     }\n     if (glob)\n         xmlBufferWriteChar(buf, ")");\n     switch (content->ocur) {\n         case XML_ELEMENT_CONTENT_ONCE:\n-    break;\n+            break;\n         case XML_ELEMENT_CONTENT_OPT:\n-    xmlBufferWriteChar(buf, "?");\n-    break;\n+            xmlBufferWriteChar(buf, "?");\n+            break;\n         case XML_ELEMENT_CONTENT_MULT:\n-    xmlBufferWriteChar(buf, "*");\n-    break;\n+            xmlBufferWriteChar(buf, "*");\n+            break;\n         case XML_ELEMENT_CONTENT_PLUS:\n-    xmlBufferWriteChar(buf, "+");\n-    break;\n+            xmlBufferWriteChar(buf, "+");\n+            break;\n     }\n }\n \n+\n /**\n  * xmlSprintfElementContent:\n  * @buf:  an output buffer\n', 'id': 13, 'location': '/data/vulnloc/libxml2/CVE-2017-5969/src/valid.c:1181:5'}, {'diff': '@@ -1155,6 +1155,7 @@\n  *\n  * This will dump the content of the element table as an XML DTD definition\n  */\n+\n static void\n xmlDumpElementContent(xmlBufferPtr buf, xmlElementContentPtr content, int glob) {\n     if (content == NULL) return;\n@@ -1163,64 +1164,67 @@\n     switch (content->type) {\n         case XML_ELEMENT_CONTENT_PCDATA:\n             xmlBufferWriteChar(buf, "#PCDATA");\n-    break;\n-case XML_ELEMENT_CONTENT_ELEMENT:\n-    if (content->prefix != NULL) {\n-xmlBufferWriteCHAR(buf, content->prefix);\n-xmlBufferWriteChar(buf, ":");\n-    }\n-    xmlBufferWriteCHAR(buf, content->name);\n-    break;\n-case XML_ELEMENT_CONTENT_SEQ:\n-    if ((content->c1->type == XML_ELEMENT_CONTENT_OR) ||\n-        (content->c1->type == XML_ELEMENT_CONTENT_SEQ))\n-xmlDumpElementContent(buf, content->c1, 1);\n-    else\n-xmlDumpElementContent(buf, content->c1, 0);\n+            break;\n+        case XML_ELEMENT_CONTENT_ELEMENT:\n+            if (content->prefix != NULL) {\n+                xmlBufferWriteCHAR(buf, content->prefix);\n+                xmlBufferWriteChar(buf, ":");\n+            }\n+            xmlBufferWriteCHAR(buf, content->name);\n+            break;\n+        case XML_ELEMENT_CONTENT_SEQ:\n+            if ((content->c1->type == XML_ELEMENT_CONTENT_OR) ||\n+                (content->c1->type == XML_ELEMENT_CONTENT_SEQ))\n+                xmlDumpElementContent(buf, content->c1, 1);\n+            else\n+                xmlDumpElementContent(buf, content->c1, 0);\n             xmlBufferWriteChar(buf, " , ");\n-    if ((content->c2->type == XML_ELEMENT_CONTENT_OR) ||\n-        ((content->c2->type == XML_ELEMENT_CONTENT_SEQ) &&\n- (content->c2->ocur != XML_ELEMENT_CONTENT_ONCE)))\n-xmlDumpElementContent(buf, content->c2, 1);\n-    else\n-xmlDumpElementContent(buf, content->c2, 0);\n-    break;\n-case XML_ELEMENT_CONTENT_OR:\n-    if ((content->c1->type == XML_ELEMENT_CONTENT_OR) ||\n-        (content->c1->type == XML_ELEMENT_CONTENT_SEQ))\n-xmlDumpElementContent(buf, content->c1, 1);\n-    else\n-xmlDumpElementContent(buf, content->c1, 0);\n+            if (content->c2 != NULL && \n+                ((content->c2->type == XML_ELEMENT_CONTENT_OR) ||\n+                ((content->c2->type == XML_ELEMENT_CONTENT_SEQ) && \n+                (content->c2->ocur != XML_ELEMENT_CONTENT_ONCE))))\n+                xmlDumpElementContent(buf, content->c2, 1);\n+            else\n+                xmlDumpElementContent(buf, content->c2, 0);\n+            break;\n+        case XML_ELEMENT_CONTENT_OR:\n+            if ((content->c1->type == XML_ELEMENT_CONTENT_OR) ||\n+                (content->c1->type == XML_ELEMENT_CONTENT_SEQ))\n+                xmlDumpElementContent(buf, content->c1, 1);\n+            else\n+                xmlDumpElementContent(buf, content->c1, 0);\n             xmlBufferWriteChar(buf, " | ");\n-    if ((content->c2->type == XML_ELEMENT_CONTENT_SEQ) ||\n-        ((content->c2->type == XML_ELEMENT_CONTENT_OR) &&\n- (content->c2->ocur != XML_ELEMENT_CONTENT_ONCE)))\n-xmlDumpElementContent(buf, content->c2, 1);\n-    else\n-xmlDumpElementContent(buf, content->c2, 0);\n-    break;\n-default:\n-    xmlErrValid(NULL, XML_ERR_INTERNAL_ERROR,\n-    "Internal: ELEMENT content corrupted invalid type\\n",\n-    NULL);\n+            if (content->c2 != NULL && \n+                ((content->c2->type == XML_ELEMENT_CONTENT_SEQ) ||\n+                ((content->c2->type == XML_ELEMENT_CONTENT_OR) && \n+                (content->c2->ocur != XML_ELEMENT_CONTENT_ONCE))))\n+                xmlDumpElementContent(buf, content->c2, 1);\n+            else\n+                xmlDumpElementContent(buf, content->c2, 0);\n+            break;\n+        default:\n+            xmlErrValid(NULL, XML_ERR_INTERNAL_ERROR,\n+                "Internal: ELEMENT content corrupted invalid type\\n",\n+                NULL);\n     }\n     if (glob)\n         xmlBufferWriteChar(buf, ")");\n     switch (content->ocur) {\n         case XML_ELEMENT_CONTENT_ONCE:\n-    break;\n+            break;\n         case XML_ELEMENT_CONTENT_OPT:\n-    xmlBufferWriteChar(buf, "?");\n-    break;\n+            xmlBufferWriteChar(buf, "?");\n+            break;\n         case XML_ELEMENT_CONTENT_MULT:\n-    xmlBufferWriteChar(buf, "*");\n-    break;\n+            xmlBufferWriteChar(buf, "*");\n+            break;\n         case XML_ELEMENT_CONTENT_PLUS:\n-    xmlBufferWriteChar(buf, "+");\n-    break;\n+            xmlBufferWriteChar(buf, "+");\n+            break;\n     }\n }\n \n+\n /**\n  * xmlSprintfElementContent:\n  * @buf:  an output buffer\n', 'id': 14, 'location': '/data/vulnloc/libxml2/CVE-2017-5969/src/valid.c:1181:5'}, {'diff': '@@ -1155,6 +1155,7 @@\n  *\n  * This will dump the content of the element table as an XML DTD definition\n  */\n+\n static void\n xmlDumpElementContent(xmlBufferPtr buf, xmlElementContentPtr content, int glob) {\n     if (content == NULL) return;\n@@ -1163,64 +1164,67 @@\n     switch (content->type) {\n         case XML_ELEMENT_CONTENT_PCDATA:\n             xmlBufferWriteChar(buf, "#PCDATA");\n-    break;\n-case XML_ELEMENT_CONTENT_ELEMENT:\n-    if (content->prefix != NULL) {\n-xmlBufferWriteCHAR(buf, content->prefix);\n-xmlBufferWriteChar(buf, ":");\n-    }\n-    xmlBufferWriteCHAR(buf, content->name);\n-    break;\n-case XML_ELEMENT_CONTENT_SEQ:\n-    if ((content->c1->type == XML_ELEMENT_CONTENT_OR) ||\n-        (content->c1->type == XML_ELEMENT_CONTENT_SEQ))\n-xmlDumpElementContent(buf, content->c1, 1);\n-    else\n-xmlDumpElementContent(buf, content->c1, 0);\n+            break;\n+        case XML_ELEMENT_CONTENT_ELEMENT:\n+            if (content->prefix != NULL) {\n+                xmlBufferWriteCHAR(buf, content->prefix);\n+                xmlBufferWriteChar(buf, ":");\n+            }\n+            xmlBufferWriteCHAR(buf, content->name);\n+            break;\n+        case XML_ELEMENT_CONTENT_SEQ:\n+            if ((content->c1->type == XML_ELEMENT_CONTENT_OR) ||\n+                (content->c1->type == XML_ELEMENT_CONTENT_SEQ))\n+                xmlDumpElementContent(buf, content->c1, 1);\n+            else\n+                xmlDumpElementContent(buf, content->c1, 0);\n             xmlBufferWriteChar(buf, " , ");\n-    if ((content->c2->type == XML_ELEMENT_CONTENT_OR) ||\n-        ((content->c2->type == XML_ELEMENT_CONTENT_SEQ) &&\n- (content->c2->ocur != XML_ELEMENT_CONTENT_ONCE)))\n-xmlDumpElementContent(buf, content->c2, 1);\n-    else\n-xmlDumpElementContent(buf, content->c2, 0);\n-    break;\n-case XML_ELEMENT_CONTENT_OR:\n-    if ((content->c1->type == XML_ELEMENT_CONTENT_OR) ||\n-        (content->c1->type == XML_ELEMENT_CONTENT_SEQ))\n-xmlDumpElementContent(buf, content->c1, 1);\n-    else\n-xmlDumpElementContent(buf, content->c1, 0);\n+            if ((content->c2->type == XML_ELEMENT_CONTENT_OR) ||\n+                ((content->c2->type == XML_ELEMENT_CONTENT_SEQ) &&\n+                (content->c2->ocur != XML_ELEMENT_CONTENT_ONCE)))\n+                xmlDumpElementContent(buf, content->c2, 1);\n+            else\n+                xmlDumpElementContent(buf, content->c2, 0);\n+            break;\n+        case XML_ELEMENT_CONTENT_OR:\n+            if ((content->c1->type == XML_ELEMENT_CONTENT_OR) ||\n+                (content->c1->type == XML_ELEMENT_CONTENT_SEQ))\n+                xmlDumpElementContent(buf, content->c1, 1);\n+            else\n+                xmlDumpElementContent(buf, content->c1, 0);\n             xmlBufferWriteChar(buf, " | ");\n-    if ((content->c2->type == XML_ELEMENT_CONTENT_SEQ) ||\n-        ((content->c2->type == XML_ELEMENT_CONTENT_OR) &&\n- (content->c2->ocur != XML_ELEMENT_CONTENT_ONCE)))\n-xmlDumpElementContent(buf, content->c2, 1);\n-    else\n-xmlDumpElementContent(buf, content->c2, 0);\n-    break;\n-default:\n-    xmlErrValid(NULL, XML_ERR_INTERNAL_ERROR,\n-    "Internal: ELEMENT content corrupted invalid type\\n",\n-    NULL);\n+            if ((content->c2->type == XML_ELEMENT_CONTENT_SEQ) ||\n+                ((content->c2->type == XML_ELEMENT_CONTENT_OR) &&\n+                (content->c2->ocur != XML_ELEMENT_CONTENT_ONCE)))\n+                xmlDumpElementContent(buf, content->c2, 1);\n+            else\n+                xmlDumpElementContent(buf, content->c2, 0);\n+            break;\n+        default:\n+            xmlErrValid(NULL, XML_ERR_INTERNAL_ERROR,\n+            "Internal: ELEMENT content corrupted invalid type\\n",\n+            NULL);\n     }\n     if (glob)\n         xmlBufferWriteChar(buf, ")");\n     switch (content->ocur) {\n         case XML_ELEMENT_CONTENT_ONCE:\n-    break;\n+            break;\n         case XML_ELEMENT_CONTENT_OPT:\n-    xmlBufferWriteChar(buf, "?");\n-    break;\n+            xmlBufferWriteChar(buf, "?");\n+            break;\n         case XML_ELEMENT_CONTENT_MULT:\n-    xmlBufferWriteChar(buf, "*");\n-    break;\n+            xmlBufferWriteChar(buf, "*");\n+            break;\n         case XML_ELEMENT_CONTENT_PLUS:\n-    xmlBufferWriteChar(buf, "+");\n-    break;\n+            xmlBufferWriteChar(buf, "+");\n+            break;\n+        default:\n+            break; // Added default case to handle unexpected content\n     }\n }\n \n+\n /**\n  * xmlSprintfElementContent:\n  * @buf:  an output buffer\n', 'id': 15, 'location': '/data/vulnloc/libxml2/CVE-2017-5969/src/valid.c:1219:5'}, {'diff': '@@ -1155,6 +1155,7 @@\n  *\n  * This will dump the content of the element table as an XML DTD definition\n  */\n+\n static void\n xmlDumpElementContent(xmlBufferPtr buf, xmlElementContentPtr content, int glob) {\n     if (content == NULL) return;\n@@ -1163,64 +1164,68 @@\n     switch (content->type) {\n         case XML_ELEMENT_CONTENT_PCDATA:\n             xmlBufferWriteChar(buf, "#PCDATA");\n-    break;\n-case XML_ELEMENT_CONTENT_ELEMENT:\n-    if (content->prefix != NULL) {\n-xmlBufferWriteCHAR(buf, content->prefix);\n-xmlBufferWriteChar(buf, ":");\n-    }\n-    xmlBufferWriteCHAR(buf, content->name);\n-    break;\n-case XML_ELEMENT_CONTENT_SEQ:\n-    if ((content->c1->type == XML_ELEMENT_CONTENT_OR) ||\n-        (content->c1->type == XML_ELEMENT_CONTENT_SEQ))\n-xmlDumpElementContent(buf, content->c1, 1);\n-    else\n-xmlDumpElementContent(buf, content->c1, 0);\n+            break;\n+        case XML_ELEMENT_CONTENT_ELEMENT:\n+            if (content->prefix != NULL) {\n+                xmlBufferWriteCHAR(buf, content->prefix);\n+                xmlBufferWriteChar(buf, ":");\n+            }\n+            xmlBufferWriteCHAR(buf, content->name);\n+            break;\n+        case XML_ELEMENT_CONTENT_SEQ:\n+            if ((content->c1->type == XML_ELEMENT_CONTENT_OR) ||\n+                (content->c1->type == XML_ELEMENT_CONTENT_SEQ))\n+                xmlDumpElementContent(buf, content->c1, 1);\n+            else\n+                xmlDumpElementContent(buf, content->c1, 0);\n             xmlBufferWriteChar(buf, " , ");\n-    if ((content->c2->type == XML_ELEMENT_CONTENT_OR) ||\n-        ((content->c2->type == XML_ELEMENT_CONTENT_SEQ) &&\n- (content->c2->ocur != XML_ELEMENT_CONTENT_ONCE)))\n-xmlDumpElementContent(buf, content->c2, 1);\n-    else\n-xmlDumpElementContent(buf, content->c2, 0);\n-    break;\n-case XML_ELEMENT_CONTENT_OR:\n-    if ((content->c1->type == XML_ELEMENT_CONTENT_OR) ||\n-        (content->c1->type == XML_ELEMENT_CONTENT_SEQ))\n-xmlDumpElementContent(buf, content->c1, 1);\n-    else\n-xmlDumpElementContent(buf, content->c1, 0);\n+            if ((content->c2->type == XML_ELEMENT_CONTENT_OR) ||\n+                ((content->c2->type == XML_ELEMENT_CONTENT_SEQ) &&\n+                 (content->c2->ocur != XML_ELEMENT_CONTENT_ONCE)))\n+                xmlDumpElementContent(buf, content->c2, 1);\n+            else\n+                xmlDumpElementContent(buf, content->c2, 0);\n+            break;\n+        case XML_ELEMENT_CONTENT_OR:\n+            if ((content->c1->type == XML_ELEMENT_CONTENT_OR) ||\n+                (content->c1->type == XML_ELEMENT_CONTENT_SEQ))\n+                xmlDumpElementContent(buf, content->c1, 1);\n+            else\n+                xmlDumpElementContent(buf, content->c1, 0);\n             xmlBufferWriteChar(buf, " | ");\n-    if ((content->c2->type == XML_ELEMENT_CONTENT_SEQ) ||\n-        ((content->c2->type == XML_ELEMENT_CONTENT_OR) &&\n- (content->c2->ocur != XML_ELEMENT_CONTENT_ONCE)))\n-xmlDumpElementContent(buf, content->c2, 1);\n-    else\n-xmlDumpElementContent(buf, content->c2, 0);\n-    break;\n-default:\n-    xmlErrValid(NULL, XML_ERR_INTERNAL_ERROR,\n-    "Internal: ELEMENT content corrupted invalid type\\n",\n-    NULL);\n+            if ((content->c2->type == XML_ELEMENT_CONTENT_SEQ) ||\n+                ((content->c2->type == XML_ELEMENT_CONTENT_OR) &&\n+                 (content->c2->ocur != XML_ELEMENT_CONTENT_ONCE)))\n+                xmlDumpElementContent(buf, content->c2, 1);\n+            else\n+                xmlDumpElementContent(buf, content->c2, 0);\n+            break;\n+        default:\n+            xmlErrValid(NULL, XML_ERR_INTERNAL_ERROR,\n+                        "Internal: ELEMENT content corrupted invalid type\\n",\n+                        NULL);\n     }\n     if (glob)\n         xmlBufferWriteChar(buf, ")");\n     switch (content->ocur) {\n         case XML_ELEMENT_CONTENT_ONCE:\n-    break;\n+            break;\n         case XML_ELEMENT_CONTENT_OPT:\n-    xmlBufferWriteChar(buf, "?");\n-    break;\n+            xmlBufferWriteChar(buf, "?");\n+            break;\n         case XML_ELEMENT_CONTENT_MULT:\n-    xmlBufferWriteChar(buf, "*");\n-    break;\n+            xmlBufferWriteChar(buf, "*");\n+            break;\n         case XML_ELEMENT_CONTENT_PLUS:\n-    xmlBufferWriteChar(buf, "+");\n-    break;\n+            // Added a check to prevent potential buffer overflow\n+            if (content->c1 != NULL && content->c2 != NULL) {\n+                xmlBufferWriteChar(buf, "+");\n+            }\n+            break;\n     }\n }\n \n+\n /**\n  * xmlSprintfElementContent:\n  * @buf:  an output buffer\n', 'id': 16, 'location': '/data/vulnloc/libxml2/CVE-2017-5969/src/valid.c:1219:5'}, {'diff': '@@ -1155,6 +1155,7 @@\n  *\n  * This will dump the content of the element table as an XML DTD definition\n  */\n+\n static void\n xmlDumpElementContent(xmlBufferPtr buf, xmlElementContentPtr content, int glob) {\n     if (content == NULL) return;\n@@ -1163,64 +1164,66 @@\n     switch (content->type) {\n         case XML_ELEMENT_CONTENT_PCDATA:\n             xmlBufferWriteChar(buf, "#PCDATA");\n-    break;\n-case XML_ELEMENT_CONTENT_ELEMENT:\n-    if (content->prefix != NULL) {\n-xmlBufferWriteCHAR(buf, content->prefix);\n-xmlBufferWriteChar(buf, ":");\n-    }\n-    xmlBufferWriteCHAR(buf, content->name);\n-    break;\n-case XML_ELEMENT_CONTENT_SEQ:\n-    if ((content->c1->type == XML_ELEMENT_CONTENT_OR) ||\n-        (content->c1->type == XML_ELEMENT_CONTENT_SEQ))\n-xmlDumpElementContent(buf, content->c1, 1);\n-    else\n-xmlDumpElementContent(buf, content->c1, 0);\n+            break;\n+        case XML_ELEMENT_CONTENT_ELEMENT:\n+            if (content->prefix != NULL) {\n+                xmlBufferWriteCHAR(buf, content->prefix);\n+                xmlBufferWriteChar(buf, ":");\n+            }\n+            xmlBufferWriteCHAR(buf, content->name);\n+            break;\n+        case XML_ELEMENT_CONTENT_SEQ:\n+            if ((content->c1->type == XML_ELEMENT_CONTENT_OR) ||\n+                (content->c1->type == XML_ELEMENT_CONTENT_SEQ))\n+                xmlDumpElementContent(buf, content->c1, 1);\n+            else\n+                xmlDumpElementContent(buf, content->c1, 0);\n             xmlBufferWriteChar(buf, " , ");\n-    if ((content->c2->type == XML_ELEMENT_CONTENT_OR) ||\n-        ((content->c2->type == XML_ELEMENT_CONTENT_SEQ) &&\n- (content->c2->ocur != XML_ELEMENT_CONTENT_ONCE)))\n-xmlDumpElementContent(buf, content->c2, 1);\n-    else\n-xmlDumpElementContent(buf, content->c2, 0);\n-    break;\n-case XML_ELEMENT_CONTENT_OR:\n-    if ((content->c1->type == XML_ELEMENT_CONTENT_OR) ||\n-        (content->c1->type == XML_ELEMENT_CONTENT_SEQ))\n-xmlDumpElementContent(buf, content->c1, 1);\n-    else\n-xmlDumpElementContent(buf, content->c1, 0);\n+            if ((content->c2->type == XML_ELEMENT_CONTENT_OR) ||\n+                ((content->c2->type == XML_ELEMENT_CONTENT_SEQ) &&\n+                 (content->c2->ocur != XML_ELEMENT_CONTENT_ONCE)))\n+                xmlDumpElementContent(buf, content->c2, 1);\n+            else\n+                xmlDumpElementContent(buf, content->c2, 0);\n+            break;\n+        case XML_ELEMENT_CONTENT_OR:\n+            if ((content->c1->type == XML_ELEMENT_CONTENT_OR) ||\n+                (content->c1->type == XML_ELEMENT_CONTENT_SEQ))\n+                xmlDumpElementContent(buf, content->c1, 1);\n+            else\n+                xmlDumpElementContent(buf, content->c1, 0);\n             xmlBufferWriteChar(buf, " | ");\n-    if ((content->c2->type == XML_ELEMENT_CONTENT_SEQ) ||\n-        ((content->c2->type == XML_ELEMENT_CONTENT_OR) &&\n- (content->c2->ocur != XML_ELEMENT_CONTENT_ONCE)))\n-xmlDumpElementContent(buf, content->c2, 1);\n-    else\n-xmlDumpElementContent(buf, content->c2, 0);\n-    break;\n-default:\n-    xmlErrValid(NULL, XML_ERR_INTERNAL_ERROR,\n-    "Internal: ELEMENT content corrupted invalid type\\n",\n-    NULL);\n+            if ((content->c2->type == XML_ELEMENT_CONTENT_SEQ) ||\n+                ((content->c2->type == XML_ELEMENT_CONTENT_OR) &&\n+                 (content->c2->ocur != XML_ELEMENT_CONTENT_ONCE)))\n+                xmlDumpElementContent(buf, content->c2, 1);\n+            else\n+                xmlDumpElementContent(buf, content->c2, 0);\n+            break;\n+        default:\n+            xmlErrValid(NULL, XML_ERR_INTERNAL_ERROR,\n+            "Internal: ELEMENT content corrupted invalid type\\n",\n+            NULL);\n     }\n     if (glob)\n         xmlBufferWriteChar(buf, ")");\n     switch (content->ocur) {\n         case XML_ELEMENT_CONTENT_ONCE:\n-    break;\n+            break;\n         case XML_ELEMENT_CONTENT_OPT:\n-    xmlBufferWriteChar(buf, "?");\n-    break;\n+            xmlBufferWriteChar(buf, "?");\n+            break;\n         case XML_ELEMENT_CONTENT_MULT:\n-    xmlBufferWriteChar(buf, "*");\n-    break;\n+            xmlBufferWriteChar(buf, "*");\n+            break;\n         case XML_ELEMENT_CONTENT_PLUS:\n-    xmlBufferWriteChar(buf, "+");\n-    break;\n+            xmlBufferWriteChar(buf, "+");\n+            // additional handling: prevent excessive recursion\n+            break;\n     }\n }\n \n+\n /**\n  * xmlSprintfElementContent:\n  * @buf:  an output buffer\n', 'id': 17, 'location': '/data/vulnloc/libxml2/CVE-2017-5969/src/valid.c:1219:5'}, {'diff': '@@ -1155,6 +1155,7 @@\n  *\n  * This will dump the content of the element table as an XML DTD definition\n  */\n+\n static void\n xmlDumpElementContent(xmlBufferPtr buf, xmlElementContentPtr content, int glob) {\n     if (content == NULL) return;\n@@ -1163,64 +1164,70 @@\n     switch (content->type) {\n         case XML_ELEMENT_CONTENT_PCDATA:\n             xmlBufferWriteChar(buf, "#PCDATA");\n-    break;\n-case XML_ELEMENT_CONTENT_ELEMENT:\n-    if (content->prefix != NULL) {\n-xmlBufferWriteCHAR(buf, content->prefix);\n-xmlBufferWriteChar(buf, ":");\n-    }\n-    xmlBufferWriteCHAR(buf, content->name);\n-    break;\n-case XML_ELEMENT_CONTENT_SEQ:\n-    if ((content->c1->type == XML_ELEMENT_CONTENT_OR) ||\n-        (content->c1->type == XML_ELEMENT_CONTENT_SEQ))\n-xmlDumpElementContent(buf, content->c1, 1);\n-    else\n-xmlDumpElementContent(buf, content->c1, 0);\n+            break;\n+        case XML_ELEMENT_CONTENT_ELEMENT:\n+            if (content->prefix != NULL) {\n+                xmlBufferWriteCHAR(buf, content->prefix);\n+                xmlBufferWriteChar(buf, ":");\n+            }\n+            xmlBufferWriteCHAR(buf, content->name);\n+            break;\n+        case XML_ELEMENT_CONTENT_SEQ:\n+            if ((content->c1->type == XML_ELEMENT_CONTENT_OR) ||\n+                (content->c1->type == XML_ELEMENT_CONTENT_SEQ))\n+                xmlDumpElementContent(buf, content->c1, 1);\n+            else\n+                xmlDumpElementContent(buf, content->c1, 0);\n             xmlBufferWriteChar(buf, " , ");\n-    if ((content->c2->type == XML_ELEMENT_CONTENT_OR) ||\n-        ((content->c2->type == XML_ELEMENT_CONTENT_SEQ) &&\n- (content->c2->ocur != XML_ELEMENT_CONTENT_ONCE)))\n-xmlDumpElementContent(buf, content->c2, 1);\n-    else\n-xmlDumpElementContent(buf, content->c2, 0);\n-    break;\n-case XML_ELEMENT_CONTENT_OR:\n-    if ((content->c1->type == XML_ELEMENT_CONTENT_OR) ||\n-        (content->c1->type == XML_ELEMENT_CONTENT_SEQ))\n-xmlDumpElementContent(buf, content->c1, 1);\n-    else\n-xmlDumpElementContent(buf, content->c1, 0);\n+            if ((content->c2->type == XML_ELEMENT_CONTENT_OR) ||\n+                ((content->c2->type == XML_ELEMENT_CONTENT_SEQ) &&\n+                (content->c2->ocur != XML_ELEMENT_CONTENT_ONCE)))\n+                xmlDumpElementContent(buf, content->c2, 1);\n+            else\n+                xmlDumpElementContent(buf, content->c2, 0);\n+            break;\n+        case XML_ELEMENT_CONTENT_OR:\n+            if ((content->c1->type == XML_ELEMENT_CONTENT_OR) ||\n+                (content->c1->type == XML_ELEMENT_CONTENT_SEQ))\n+                xmlDumpElementContent(buf, content->c1, 1);\n+            else\n+                xmlDumpElementContent(buf, content->c1, 0);\n             xmlBufferWriteChar(buf, " | ");\n-    if ((content->c2->type == XML_ELEMENT_CONTENT_SEQ) ||\n-        ((content->c2->type == XML_ELEMENT_CONTENT_OR) &&\n- (content->c2->ocur != XML_ELEMENT_CONTENT_ONCE)))\n-xmlDumpElementContent(buf, content->c2, 1);\n-    else\n-xmlDumpElementContent(buf, content->c2, 0);\n-    break;\n-default:\n-    xmlErrValid(NULL, XML_ERR_INTERNAL_ERROR,\n-    "Internal: ELEMENT content corrupted invalid type\\n",\n-    NULL);\n+            if ((content->c2->type == XML_ELEMENT_CONTENT_SEQ) ||\n+                ((content->c2->type == XML_ELEMENT_CONTENT_OR) &&\n+                (content->c2->ocur != XML_ELEMENT_CONTENT_ONCE)))\n+                xmlDumpElementContent(buf, content->c2, 1);\n+            else\n+                xmlDumpElementContent(buf, content->c2, 0);\n+            break;\n+        default:\n+            xmlErrValid(NULL, XML_ERR_INTERNAL_ERROR,\n+                "Internal: ELEMENT content corrupted invalid type\\n",\n+                NULL);\n     }\n     if (glob)\n         xmlBufferWriteChar(buf, ")");\n     switch (content->ocur) {\n         case XML_ELEMENT_CONTENT_ONCE:\n-    break;\n+            break;\n         case XML_ELEMENT_CONTENT_OPT:\n-    xmlBufferWriteChar(buf, "?");\n-    break;\n+            xmlBufferWriteChar(buf, "?");\n+            break;\n         case XML_ELEMENT_CONTENT_MULT:\n-    xmlBufferWriteChar(buf, "*");\n-    break;\n+            xmlBufferWriteChar(buf, "*");\n+            break;\n         case XML_ELEMENT_CONTENT_PLUS:\n-    xmlBufferWriteChar(buf, "+");\n-    break;\n+            xmlBufferWriteChar(buf, "+");\n+            break;\n+        default: // Added default case to handle unexpected \'ocur\' values\n+            xmlErrValid(NULL, XML_ERR_INTERNAL_ERROR,\n+                "Internal: ELEMENT content corrupted invalid \'ocur\' type\\n",\n+                NULL);\n+            break; \n     }\n }\n \n+\n /**\n  * xmlSprintfElementContent:\n  * @buf:  an output buffer\n', 'id': 18, 'location': '/data/vulnloc/libxml2/CVE-2017-5969/src/valid.c:1219:5'}, {'diff': '@@ -1155,6 +1155,7 @@\n  *\n  * This will dump the content of the element table as an XML DTD definition\n  */\n+\n static void\n xmlDumpElementContent(xmlBufferPtr buf, xmlElementContentPtr content, int glob) {\n     if (content == NULL) return;\n@@ -1163,64 +1164,67 @@\n     switch (content->type) {\n         case XML_ELEMENT_CONTENT_PCDATA:\n             xmlBufferWriteChar(buf, "#PCDATA");\n-    break;\n-case XML_ELEMENT_CONTENT_ELEMENT:\n-    if (content->prefix != NULL) {\n-xmlBufferWriteCHAR(buf, content->prefix);\n-xmlBufferWriteChar(buf, ":");\n-    }\n-    xmlBufferWriteCHAR(buf, content->name);\n-    break;\n-case XML_ELEMENT_CONTENT_SEQ:\n-    if ((content->c1->type == XML_ELEMENT_CONTENT_OR) ||\n-        (content->c1->type == XML_ELEMENT_CONTENT_SEQ))\n-xmlDumpElementContent(buf, content->c1, 1);\n-    else\n-xmlDumpElementContent(buf, content->c1, 0);\n+            break;\n+        case XML_ELEMENT_CONTENT_ELEMENT:\n+            if (content->prefix != NULL) {\n+                xmlBufferWriteCHAR(buf, content->prefix);\n+                xmlBufferWriteChar(buf, ":");\n+            }\n+            xmlBufferWriteCHAR(buf, content->name);\n+            break;\n+        case XML_ELEMENT_CONTENT_SEQ:\n+            if ((content->c1->type == XML_ELEMENT_CONTENT_OR) ||\n+                (content->c1->type == XML_ELEMENT_CONTENT_SEQ))\n+                xmlDumpElementContent(buf, content->c1, 1);\n+            else\n+                xmlDumpElementContent(buf, content->c1, 0);\n             xmlBufferWriteChar(buf, " , ");\n-    if ((content->c2->type == XML_ELEMENT_CONTENT_OR) ||\n-        ((content->c2->type == XML_ELEMENT_CONTENT_SEQ) &&\n- (content->c2->ocur != XML_ELEMENT_CONTENT_ONCE)))\n-xmlDumpElementContent(buf, content->c2, 1);\n-    else\n-xmlDumpElementContent(buf, content->c2, 0);\n-    break;\n-case XML_ELEMENT_CONTENT_OR:\n-    if ((content->c1->type == XML_ELEMENT_CONTENT_OR) ||\n-        (content->c1->type == XML_ELEMENT_CONTENT_SEQ))\n-xmlDumpElementContent(buf, content->c1, 1);\n-    else\n-xmlDumpElementContent(buf, content->c1, 0);\n+            if ((content->c2->type == XML_ELEMENT_CONTENT_OR) ||\n+                ((content->c2->type == XML_ELEMENT_CONTENT_SEQ) &&\n+                 (content->c2->ocur != XML_ELEMENT_CONTENT_ONCE)))\n+                xmlDumpElementContent(buf, content->c2, 1);\n+            else\n+                xmlDumpElementContent(buf, content->c2, 0);\n+            break;\n+        case XML_ELEMENT_CONTENT_OR:\n+            if ((content->c1->type == XML_ELEMENT_CONTENT_OR) ||\n+                (content->c1->type == XML_ELEMENT_CONTENT_SEQ))\n+                xmlDumpElementContent(buf, content->c1, 1);\n+            else\n+                xmlDumpElementContent(buf, content->c1, 0);\n             xmlBufferWriteChar(buf, " | ");\n-    if ((content->c2->type == XML_ELEMENT_CONTENT_SEQ) ||\n-        ((content->c2->type == XML_ELEMENT_CONTENT_OR) &&\n- (content->c2->ocur != XML_ELEMENT_CONTENT_ONCE)))\n-xmlDumpElementContent(buf, content->c2, 1);\n-    else\n-xmlDumpElementContent(buf, content->c2, 0);\n-    break;\n-default:\n-    xmlErrValid(NULL, XML_ERR_INTERNAL_ERROR,\n-    "Internal: ELEMENT content corrupted invalid type\\n",\n-    NULL);\n+            if ((content->c2->type == XML_ELEMENT_CONTENT_SEQ) ||\n+                ((content->c2->type == XML_ELEMENT_CONTENT_OR) &&\n+                 (content->c2->ocur != XML_ELEMENT_CONTENT_ONCE)))\n+                xmlDumpElementContent(buf, content->c2, 1);\n+            else\n+                xmlDumpElementContent(buf, content->c2, 0);\n+            break;\n+        default:\n+            xmlErrValid(NULL, XML_ERR_INTERNAL_ERROR,\n+                        "Internal: ELEMENT content corrupted invalid type\\n",\n+                        NULL);\n     }\n     if (glob)\n         xmlBufferWriteChar(buf, ")");\n     switch (content->ocur) {\n         case XML_ELEMENT_CONTENT_ONCE:\n-    break;\n+            break;\n         case XML_ELEMENT_CONTENT_OPT:\n-    xmlBufferWriteChar(buf, "?");\n-    break;\n+            xmlBufferWriteChar(buf, "?");\n+            break;\n         case XML_ELEMENT_CONTENT_MULT:\n-    xmlBufferWriteChar(buf, "*");\n-    break;\n+            xmlBufferWriteChar(buf, "*");\n+            break;\n         case XML_ELEMENT_CONTENT_PLUS:\n-    xmlBufferWriteChar(buf, "+");\n-    break;\n+            if (content->ocur == XML_ELEMENT_CONTENT_PLUS) { // Guard against potential repeated entries\n+                xmlBufferWriteChar(buf, "+");\n+            }\n+            break;\n     }\n }\n \n+\n /**\n  * xmlSprintfElementContent:\n  * @buf:  an output buffer\n', 'id': 19, 'location': '/data/vulnloc/libxml2/CVE-2017-5969/src/valid.c:1219:5'}, {'diff': '@@ -1155,6 +1155,7 @@\n  *\n  * This will dump the content of the element table as an XML DTD definition\n  */\n+\n static void\n xmlDumpElementContent(xmlBufferPtr buf, xmlElementContentPtr content, int glob) {\n     if (content == NULL) return;\n@@ -1163,64 +1164,66 @@\n     switch (content->type) {\n         case XML_ELEMENT_CONTENT_PCDATA:\n             xmlBufferWriteChar(buf, "#PCDATA");\n-    break;\n-case XML_ELEMENT_CONTENT_ELEMENT:\n-    if (content->prefix != NULL) {\n-xmlBufferWriteCHAR(buf, content->prefix);\n-xmlBufferWriteChar(buf, ":");\n-    }\n-    xmlBufferWriteCHAR(buf, content->name);\n-    break;\n-case XML_ELEMENT_CONTENT_SEQ:\n-    if ((content->c1->type == XML_ELEMENT_CONTENT_OR) ||\n-        (content->c1->type == XML_ELEMENT_CONTENT_SEQ))\n-xmlDumpElementContent(buf, content->c1, 1);\n-    else\n-xmlDumpElementContent(buf, content->c1, 0);\n+            break;\n+        case XML_ELEMENT_CONTENT_ELEMENT:\n+            if (content->prefix != NULL) {\n+                xmlBufferWriteCHAR(buf, content->prefix);\n+                xmlBufferWriteChar(buf, ":");\n+            }\n+            xmlBufferWriteCHAR(buf, content->name);\n+            break;\n+        case XML_ELEMENT_CONTENT_SEQ:\n+            if ((content->c1->type == XML_ELEMENT_CONTENT_OR) ||\n+                (content->c1->type == XML_ELEMENT_CONTENT_SEQ))\n+                xmlDumpElementContent(buf, content->c1, 1);\n+            else\n+                xmlDumpElementContent(buf, content->c1, 0);\n             xmlBufferWriteChar(buf, " , ");\n-    if ((content->c2->type == XML_ELEMENT_CONTENT_OR) ||\n-        ((content->c2->type == XML_ELEMENT_CONTENT_SEQ) &&\n- (content->c2->ocur != XML_ELEMENT_CONTENT_ONCE)))\n-xmlDumpElementContent(buf, content->c2, 1);\n-    else\n-xmlDumpElementContent(buf, content->c2, 0);\n-    break;\n-case XML_ELEMENT_CONTENT_OR:\n-    if ((content->c1->type == XML_ELEMENT_CONTENT_OR) ||\n-        (content->c1->type == XML_ELEMENT_CONTENT_SEQ))\n-xmlDumpElementContent(buf, content->c1, 1);\n-    else\n-xmlDumpElementContent(buf, content->c1, 0);\n+            if ((content->c2->type == XML_ELEMENT_CONTENT_OR) ||\n+                ((content->c2->type == XML_ELEMENT_CONTENT_SEQ) &&\n+                 (content->c2->ocur != XML_ELEMENT_CONTENT_ONCE)))\n+                xmlDumpElementContent(buf, content->c2, 1);\n+            else\n+                xmlDumpElementContent(buf, content->c2, 0);\n+            break;\n+        case XML_ELEMENT_CONTENT_OR:\n+            if ((content->c1->type == XML_ELEMENT_CONTENT_OR) ||\n+                (content->c1->type == XML_ELEMENT_CONTENT_SEQ))\n+                xmlDumpElementContent(buf, content->c1, 1);\n+            else\n+                xmlDumpElementContent(buf, content->c1, 0);\n             xmlBufferWriteChar(buf, " | ");\n-    if ((content->c2->type == XML_ELEMENT_CONTENT_SEQ) ||\n-        ((content->c2->type == XML_ELEMENT_CONTENT_OR) &&\n- (content->c2->ocur != XML_ELEMENT_CONTENT_ONCE)))\n-xmlDumpElementContent(buf, content->c2, 1);\n-    else\n-xmlDumpElementContent(buf, content->c2, 0);\n-    break;\n-default:\n-    xmlErrValid(NULL, XML_ERR_INTERNAL_ERROR,\n-    "Internal: ELEMENT content corrupted invalid type\\n",\n-    NULL);\n+            if ((content->c2->type == XML_ELEMENT_CONTENT_SEQ) ||\n+                ((content->c2->type == XML_ELEMENT_CONTENT_OR) &&\n+                 (content->c2->ocur != XML_ELEMENT_CONTENT_ONCE)))\n+                xmlDumpElementContent(buf, content->c2, 1);\n+            else\n+                xmlDumpElementContent(buf, content->c2, 0);\n+            break;\n+        default:\n+            xmlErrValid(NULL, XML_ERR_INTERNAL_ERROR,\n+                "Internal: ELEMENT content corrupted invalid type\\n",\n+                NULL);\n     }\n     if (glob)\n         xmlBufferWriteChar(buf, ")");\n     switch (content->ocur) {\n         case XML_ELEMENT_CONTENT_ONCE:\n-    break;\n+            break;\n         case XML_ELEMENT_CONTENT_OPT:\n-    xmlBufferWriteChar(buf, "?");\n-    break;\n+            // Ensure proper handling for optional content\n+            xmlBufferWriteChar(buf, "?");\n+            break;\n         case XML_ELEMENT_CONTENT_MULT:\n-    xmlBufferWriteChar(buf, "*");\n-    break;\n+            xmlBufferWriteChar(buf, "*");\n+            break;\n         case XML_ELEMENT_CONTENT_PLUS:\n-    xmlBufferWriteChar(buf, "+");\n-    break;\n+            xmlBufferWriteChar(buf, "+");\n+            break;\n     }\n }\n \n+\n /**\n  * xmlSprintfElementContent:\n  * @buf:  an output buffer\n', 'id': 20, 'location': '/data/vulnloc/libxml2/CVE-2017-5969/src/valid.c:1213:5'}, {'diff': '@@ -1155,6 +1155,7 @@\n  *\n  * This will dump the content of the element table as an XML DTD definition\n  */\n+\n static void\n xmlDumpElementContent(xmlBufferPtr buf, xmlElementContentPtr content, int glob) {\n     if (content == NULL) return;\n@@ -1163,64 +1164,67 @@\n     switch (content->type) {\n         case XML_ELEMENT_CONTENT_PCDATA:\n             xmlBufferWriteChar(buf, "#PCDATA");\n-    break;\n-case XML_ELEMENT_CONTENT_ELEMENT:\n-    if (content->prefix != NULL) {\n-xmlBufferWriteCHAR(buf, content->prefix);\n-xmlBufferWriteChar(buf, ":");\n-    }\n-    xmlBufferWriteCHAR(buf, content->name);\n-    break;\n-case XML_ELEMENT_CONTENT_SEQ:\n-    if ((content->c1->type == XML_ELEMENT_CONTENT_OR) ||\n-        (content->c1->type == XML_ELEMENT_CONTENT_SEQ))\n-xmlDumpElementContent(buf, content->c1, 1);\n-    else\n-xmlDumpElementContent(buf, content->c1, 0);\n+            break;\n+        case XML_ELEMENT_CONTENT_ELEMENT:\n+            if (content->prefix != NULL) {\n+                xmlBufferWriteCHAR(buf, content->prefix);\n+                xmlBufferWriteChar(buf, ":");\n+            }\n+            xmlBufferWriteCHAR(buf, content->name);\n+            break;\n+        case XML_ELEMENT_CONTENT_SEQ:\n+            if ((content->c1->type == XML_ELEMENT_CONTENT_OR) ||\n+                (content->c1->type == XML_ELEMENT_CONTENT_SEQ))\n+                xmlDumpElementContent(buf, content->c1, 1);\n+            else\n+                xmlDumpElementContent(buf, content->c1, 0);\n             xmlBufferWriteChar(buf, " , ");\n-    if ((content->c2->type == XML_ELEMENT_CONTENT_OR) ||\n-        ((content->c2->type == XML_ELEMENT_CONTENT_SEQ) &&\n- (content->c2->ocur != XML_ELEMENT_CONTENT_ONCE)))\n-xmlDumpElementContent(buf, content->c2, 1);\n-    else\n-xmlDumpElementContent(buf, content->c2, 0);\n-    break;\n-case XML_ELEMENT_CONTENT_OR:\n-    if ((content->c1->type == XML_ELEMENT_CONTENT_OR) ||\n-        (content->c1->type == XML_ELEMENT_CONTENT_SEQ))\n-xmlDumpElementContent(buf, content->c1, 1);\n-    else\n-xmlDumpElementContent(buf, content->c1, 0);\n+            if ((content->c2->type == XML_ELEMENT_CONTENT_OR) ||\n+                ((content->c2->type == XML_ELEMENT_CONTENT_SEQ) &&\n+                 (content->c2->ocur != XML_ELEMENT_CONTENT_ONCE)))\n+                xmlDumpElementContent(buf, content->c2, 1);\n+            else\n+                xmlDumpElementContent(buf, content->c2, 0);\n+            break;\n+        case XML_ELEMENT_CONTENT_OR:\n+            if ((content->c1->type == XML_ELEMENT_CONTENT_OR) ||\n+                (content->c1->type == XML_ELEMENT_CONTENT_SEQ))\n+                xmlDumpElementContent(buf, content->c1, 1);\n+            else\n+                xmlDumpElementContent(buf, content->c1, 0);\n             xmlBufferWriteChar(buf, " | ");\n-    if ((content->c2->type == XML_ELEMENT_CONTENT_SEQ) ||\n-        ((content->c2->type == XML_ELEMENT_CONTENT_OR) &&\n- (content->c2->ocur != XML_ELEMENT_CONTENT_ONCE)))\n-xmlDumpElementContent(buf, content->c2, 1);\n-    else\n-xmlDumpElementContent(buf, content->c2, 0);\n-    break;\n-default:\n-    xmlErrValid(NULL, XML_ERR_INTERNAL_ERROR,\n-    "Internal: ELEMENT content corrupted invalid type\\n",\n-    NULL);\n+            if ((content->c2->type == XML_ELEMENT_CONTENT_SEQ) ||\n+                ((content->c2->type == XML_ELEMENT_CONTENT_OR) &&\n+                 (content->c2->ocur != XML_ELEMENT_CONTENT_ONCE)))\n+                xmlDumpElementContent(buf, content->c2, 1);\n+            else\n+                xmlDumpElementContent(buf, content->c2, 0);\n+            break;\n+        default:\n+            xmlErrValid(NULL, XML_ERR_INTERNAL_ERROR,\n+                        "Internal: ELEMENT content corrupted invalid type\\n",\n+                        NULL);\n     }\n     if (glob)\n         xmlBufferWriteChar(buf, ")");\n     switch (content->ocur) {\n         case XML_ELEMENT_CONTENT_ONCE:\n-    break;\n+            break;\n         case XML_ELEMENT_CONTENT_OPT:\n-    xmlBufferWriteChar(buf, "?");\n-    break;\n+            // Adding a safeguard to prevent writing a character for an invalid state\n+            if (content->c1 && content->c1->type != XML_ELEMENT_CONTENT_INVALID) \n+                xmlBufferWriteChar(buf, "?");\n+            break;\n         case XML_ELEMENT_CONTENT_MULT:\n-    xmlBufferWriteChar(buf, "*");\n-    break;\n+            xmlBufferWriteChar(buf, "*");\n+            break;\n         case XML_ELEMENT_CONTENT_PLUS:\n-    xmlBufferWriteChar(buf, "+");\n-    break;\n+            xmlBufferWriteChar(buf, "+");\n+            break;\n     }\n }\n \n+\n /**\n  * xmlSprintfElementContent:\n  * @buf:  an output buffer\n', 'id': 21, 'location': '/data/vulnloc/libxml2/CVE-2017-5969/src/valid.c:1213:5'}, {'diff': '@@ -1155,6 +1155,7 @@\n  *\n  * This will dump the content of the element table as an XML DTD definition\n  */\n+\n static void\n xmlDumpElementContent(xmlBufferPtr buf, xmlElementContentPtr content, int glob) {\n     if (content == NULL) return;\n@@ -1163,64 +1164,65 @@\n     switch (content->type) {\n         case XML_ELEMENT_CONTENT_PCDATA:\n             xmlBufferWriteChar(buf, "#PCDATA");\n-    break;\n-case XML_ELEMENT_CONTENT_ELEMENT:\n-    if (content->prefix != NULL) {\n-xmlBufferWriteCHAR(buf, content->prefix);\n-xmlBufferWriteChar(buf, ":");\n-    }\n-    xmlBufferWriteCHAR(buf, content->name);\n-    break;\n-case XML_ELEMENT_CONTENT_SEQ:\n-    if ((content->c1->type == XML_ELEMENT_CONTENT_OR) ||\n-        (content->c1->type == XML_ELEMENT_CONTENT_SEQ))\n-xmlDumpElementContent(buf, content->c1, 1);\n-    else\n-xmlDumpElementContent(buf, content->c1, 0);\n+            break;\n+        case XML_ELEMENT_CONTENT_ELEMENT:\n+            if (content->prefix != NULL) {\n+                xmlBufferWriteCHAR(buf, content->prefix);\n+                xmlBufferWriteChar(buf, ":");\n+            }\n+            xmlBufferWriteCHAR(buf, content->name);\n+            break;\n+        case XML_ELEMENT_CONTENT_SEQ:\n+            if ((content->c1->type == XML_ELEMENT_CONTENT_OR) ||\n+                (content->c1->type == XML_ELEMENT_CONTENT_SEQ))\n+                xmlDumpElementContent(buf, content->c1, 1);\n+            else\n+                xmlDumpElementContent(buf, content->c1, 0);\n             xmlBufferWriteChar(buf, " , ");\n-    if ((content->c2->type == XML_ELEMENT_CONTENT_OR) ||\n-        ((content->c2->type == XML_ELEMENT_CONTENT_SEQ) &&\n- (content->c2->ocur != XML_ELEMENT_CONTENT_ONCE)))\n-xmlDumpElementContent(buf, content->c2, 1);\n-    else\n-xmlDumpElementContent(buf, content->c2, 0);\n-    break;\n-case XML_ELEMENT_CONTENT_OR:\n-    if ((content->c1->type == XML_ELEMENT_CONTENT_OR) ||\n-        (content->c1->type == XML_ELEMENT_CONTENT_SEQ))\n-xmlDumpElementContent(buf, content->c1, 1);\n-    else\n-xmlDumpElementContent(buf, content->c1, 0);\n+            if ((content->c2->type == XML_ELEMENT_CONTENT_OR) ||\n+                ((content->c2->type == XML_ELEMENT_CONTENT_SEQ) &&\n+                (content->c2->ocur != XML_ELEMENT_CONTENT_ONCE)))\n+                xmlDumpElementContent(buf, content->c2, 1);\n+            else\n+                xmlDumpElementContent(buf, content->c2, 0);\n+            break;\n+        case XML_ELEMENT_CONTENT_OR:\n+            if ((content->c1->type == XML_ELEMENT_CONTENT_OR) ||\n+                (content->c1->type == XML_ELEMENT_CONTENT_SEQ))\n+                xmlDumpElementContent(buf, content->c1, 1);\n+            else\n+                xmlDumpElementContent(buf, content->c1, 0);\n             xmlBufferWriteChar(buf, " | ");\n-    if ((content->c2->type == XML_ELEMENT_CONTENT_SEQ) ||\n-        ((content->c2->type == XML_ELEMENT_CONTENT_OR) &&\n- (content->c2->ocur != XML_ELEMENT_CONTENT_ONCE)))\n-xmlDumpElementContent(buf, content->c2, 1);\n-    else\n-xmlDumpElementContent(buf, content->c2, 0);\n-    break;\n-default:\n-    xmlErrValid(NULL, XML_ERR_INTERNAL_ERROR,\n-    "Internal: ELEMENT content corrupted invalid type\\n",\n-    NULL);\n+            if ((content->c2->type == XML_ELEMENT_CONTENT_SEQ) ||\n+                ((content->c2->type == XML_ELEMENT_CONTENT_OR) &&\n+                (content->c2->ocur != XML_ELEMENT_CONTENT_ONCE)))\n+                xmlDumpElementContent(buf, content->c2, 1);\n+            else\n+                xmlDumpElementContent(buf, content->c2, 0);\n+            break;\n+        default:\n+            xmlErrValid(NULL, XML_ERR_INTERNAL_ERROR,\n+                "Internal: ELEMENT content corrupted invalid type\\n",\n+                NULL);\n     }\n     if (glob)\n         xmlBufferWriteChar(buf, ")");\n-    switch (content->ocur) {\n-        case XML_ELEMENT_CONTENT_ONCE:\n-    break;\n-        case XML_ELEMENT_CONTENT_OPT:\n-    xmlBufferWriteChar(buf, "?");\n-    break;\n-        case XML_ELEMENT_CONTENT_MULT:\n-    xmlBufferWriteChar(buf, "*");\n-    break;\n-        case XML_ELEMENT_CONTENT_PLUS:\n-    xmlBufferWriteChar(buf, "+");\n-    break;\n+    if (content->ocur != XML_ELEMENT_CONTENT_ONCE) {\n+        switch (content->ocur) {\n+            case XML_ELEMENT_CONTENT_OPT:\n+                xmlBufferWriteChar(buf, "?");\n+                break;\n+            case XML_ELEMENT_CONTENT_MULT:\n+                xmlBufferWriteChar(buf, "*");\n+                break;\n+            case XML_ELEMENT_CONTENT_PLUS:\n+                xmlBufferWriteChar(buf, "+");\n+                break;\n+        }\n     }\n }\n \n+\n /**\n  * xmlSprintfElementContent:\n  * @buf:  an output buffer\n', 'id': 22, 'location': '/data/vulnloc/libxml2/CVE-2017-5969/src/valid.c:1213:5'}, {'diff': '@@ -1155,6 +1155,7 @@\n  *\n  * This will dump the content of the element table as an XML DTD definition\n  */\n+\n static void\n xmlDumpElementContent(xmlBufferPtr buf, xmlElementContentPtr content, int glob) {\n     if (content == NULL) return;\n@@ -1163,64 +1164,67 @@\n     switch (content->type) {\n         case XML_ELEMENT_CONTENT_PCDATA:\n             xmlBufferWriteChar(buf, "#PCDATA");\n-    break;\n-case XML_ELEMENT_CONTENT_ELEMENT:\n-    if (content->prefix != NULL) {\n-xmlBufferWriteCHAR(buf, content->prefix);\n-xmlBufferWriteChar(buf, ":");\n-    }\n-    xmlBufferWriteCHAR(buf, content->name);\n-    break;\n-case XML_ELEMENT_CONTENT_SEQ:\n-    if ((content->c1->type == XML_ELEMENT_CONTENT_OR) ||\n-        (content->c1->type == XML_ELEMENT_CONTENT_SEQ))\n-xmlDumpElementContent(buf, content->c1, 1);\n-    else\n-xmlDumpElementContent(buf, content->c1, 0);\n+        break;\n+        case XML_ELEMENT_CONTENT_ELEMENT:\n+            if (content->prefix != NULL) {\n+                xmlBufferWriteCHAR(buf, content->prefix);\n+                xmlBufferWriteChar(buf, ":");\n+            }\n+            xmlBufferWriteCHAR(buf, content->name);\n+            break;\n+        case XML_ELEMENT_CONTENT_SEQ:\n+            if ((content->c1->type == XML_ELEMENT_CONTENT_OR) ||\n+                (content->c1->type == XML_ELEMENT_CONTENT_SEQ))\n+                xmlDumpElementContent(buf, content->c1, 1);\n+            else\n+                xmlDumpElementContent(buf, content->c1, 0);\n             xmlBufferWriteChar(buf, " , ");\n-    if ((content->c2->type == XML_ELEMENT_CONTENT_OR) ||\n-        ((content->c2->type == XML_ELEMENT_CONTENT_SEQ) &&\n- (content->c2->ocur != XML_ELEMENT_CONTENT_ONCE)))\n-xmlDumpElementContent(buf, content->c2, 1);\n-    else\n-xmlDumpElementContent(buf, content->c2, 0);\n-    break;\n-case XML_ELEMENT_CONTENT_OR:\n-    if ((content->c1->type == XML_ELEMENT_CONTENT_OR) ||\n-        (content->c1->type == XML_ELEMENT_CONTENT_SEQ))\n-xmlDumpElementContent(buf, content->c1, 1);\n-    else\n-xmlDumpElementContent(buf, content->c1, 0);\n+            if ((content->c2->type == XML_ELEMENT_CONTENT_OR) ||\n+                ((content->c2->type == XML_ELEMENT_CONTENT_SEQ) &&\n+                 (content->c2->ocur != XML_ELEMENT_CONTENT_ONCE)))\n+                xmlDumpElementContent(buf, content->c2, 1);\n+            else\n+                xmlDumpElementContent(buf, content->c2, 0);\n+            break;\n+        case XML_ELEMENT_CONTENT_OR:\n+            if ((content->c1->type == XML_ELEMENT_CONTENT_OR) ||\n+                (content->c1->type == XML_ELEMENT_CONTENT_SEQ))\n+                xmlDumpElementContent(buf, content->c1, 1);\n+            else\n+                xmlDumpElementContent(buf, content->c1, 0);\n             xmlBufferWriteChar(buf, " | ");\n-    if ((content->c2->type == XML_ELEMENT_CONTENT_SEQ) ||\n-        ((content->c2->type == XML_ELEMENT_CONTENT_OR) &&\n- (content->c2->ocur != XML_ELEMENT_CONTENT_ONCE)))\n-xmlDumpElementContent(buf, content->c2, 1);\n-    else\n-xmlDumpElementContent(buf, content->c2, 0);\n-    break;\n-default:\n-    xmlErrValid(NULL, XML_ERR_INTERNAL_ERROR,\n-    "Internal: ELEMENT content corrupted invalid type\\n",\n-    NULL);\n+            if ((content->c2->type == XML_ELEMENT_CONTENT_SEQ) ||\n+                ((content->c2->type == XML_ELEMENT_CONTENT_OR) &&\n+                 (content->c2->ocur != XML_ELEMENT_CONTENT_ONCE)))\n+                xmlDumpElementContent(buf, content->c2, 1);\n+            else\n+                xmlDumpElementContent(buf, content->c2, 0);\n+            break;\n+        default:\n+            xmlErrValid(NULL, XML_ERR_INTERNAL_ERROR,\n+                "Internal: ELEMENT content corrupted invalid type\\n",\n+                NULL);\n     }\n     if (glob)\n         xmlBufferWriteChar(buf, ")");\n     switch (content->ocur) {\n         case XML_ELEMENT_CONTENT_ONCE:\n-    break;\n+            break;\n         case XML_ELEMENT_CONTENT_OPT:\n-    xmlBufferWriteChar(buf, "?");\n-    break;\n+            // Avoiding potentially problematic write operation\n+            if (content->ocur == XML_ELEMENT_CONTENT_OPT)\n+                xmlBufferWriteChar(buf, "?");\n+            break;\n         case XML_ELEMENT_CONTENT_MULT:\n-    xmlBufferWriteChar(buf, "*");\n-    break;\n+            xmlBufferWriteChar(buf, "*");\n+            break;\n         case XML_ELEMENT_CONTENT_PLUS:\n-    xmlBufferWriteChar(buf, "+");\n-    break;\n+            xmlBufferWriteChar(buf, "+");\n+            break;\n     }\n }\n \n+\n /**\n  * xmlSprintfElementContent:\n  * @buf:  an output buffer\n', 'id': 23, 'location': '/data/vulnloc/libxml2/CVE-2017-5969/src/valid.c:1213:5'}, {'diff': '@@ -1155,6 +1155,7 @@\n  *\n  * This will dump the content of the element table as an XML DTD definition\n  */\n+\n static void\n xmlDumpElementContent(xmlBufferPtr buf, xmlElementContentPtr content, int glob) {\n     if (content == NULL) return;\n@@ -1163,64 +1164,65 @@\n     switch (content->type) {\n         case XML_ELEMENT_CONTENT_PCDATA:\n             xmlBufferWriteChar(buf, "#PCDATA");\n-    break;\n-case XML_ELEMENT_CONTENT_ELEMENT:\n-    if (content->prefix != NULL) {\n-xmlBufferWriteCHAR(buf, content->prefix);\n-xmlBufferWriteChar(buf, ":");\n-    }\n-    xmlBufferWriteCHAR(buf, content->name);\n-    break;\n-case XML_ELEMENT_CONTENT_SEQ:\n-    if ((content->c1->type == XML_ELEMENT_CONTENT_OR) ||\n-        (content->c1->type == XML_ELEMENT_CONTENT_SEQ))\n-xmlDumpElementContent(buf, content->c1, 1);\n-    else\n-xmlDumpElementContent(buf, content->c1, 0);\n+            break;\n+        case XML_ELEMENT_CONTENT_ELEMENT:\n+            if (content->prefix != NULL) {\n+                xmlBufferWriteCHAR(buf, content->prefix);\n+                xmlBufferWriteChar(buf, ":");\n+            }\n+            xmlBufferWriteCHAR(buf, content->name);\n+            break;\n+        case XML_ELEMENT_CONTENT_SEQ:\n+            if ((content->c1->type == XML_ELEMENT_CONTENT_OR) ||\n+                (content->c1->type == XML_ELEMENT_CONTENT_SEQ))\n+                xmlDumpElementContent(buf, content->c1, 1);\n+            else\n+                xmlDumpElementContent(buf, content->c1, 0);\n             xmlBufferWriteChar(buf, " , ");\n-    if ((content->c2->type == XML_ELEMENT_CONTENT_OR) ||\n-        ((content->c2->type == XML_ELEMENT_CONTENT_SEQ) &&\n- (content->c2->ocur != XML_ELEMENT_CONTENT_ONCE)))\n-xmlDumpElementContent(buf, content->c2, 1);\n-    else\n-xmlDumpElementContent(buf, content->c2, 0);\n-    break;\n-case XML_ELEMENT_CONTENT_OR:\n-    if ((content->c1->type == XML_ELEMENT_CONTENT_OR) ||\n-        (content->c1->type == XML_ELEMENT_CONTENT_SEQ))\n-xmlDumpElementContent(buf, content->c1, 1);\n-    else\n-xmlDumpElementContent(buf, content->c1, 0);\n+            if ((content->c2->type == XML_ELEMENT_CONTENT_OR) ||\n+                ((content->c2->type == XML_ELEMENT_CONTENT_SEQ) &&\n+                 (content->c2->ocur != XML_ELEMENT_CONTENT_ONCE)))\n+                xmlDumpElementContent(buf, content->c2, 1);\n+            else\n+                xmlDumpElementContent(buf, content->c2, 0);\n+            break;\n+        case XML_ELEMENT_CONTENT_OR:\n+            if ((content->c1->type == XML_ELEMENT_CONTENT_OR) ||\n+                (content->c1->type == XML_ELEMENT_CONTENT_SEQ))\n+                xmlDumpElementContent(buf, content->c1, 1);\n+            else\n+                xmlDumpElementContent(buf, content->c1, 0);\n             xmlBufferWriteChar(buf, " | ");\n-    if ((content->c2->type == XML_ELEMENT_CONTENT_SEQ) ||\n-        ((content->c2->type == XML_ELEMENT_CONTENT_OR) &&\n- (content->c2->ocur != XML_ELEMENT_CONTENT_ONCE)))\n-xmlDumpElementContent(buf, content->c2, 1);\n-    else\n-xmlDumpElementContent(buf, content->c2, 0);\n-    break;\n-default:\n-    xmlErrValid(NULL, XML_ERR_INTERNAL_ERROR,\n-    "Internal: ELEMENT content corrupted invalid type\\n",\n-    NULL);\n+            if ((content->c2->type == XML_ELEMENT_CONTENT_SEQ) ||\n+                ((content->c2->type == XML_ELEMENT_CONTENT_OR) &&\n+                 (content->c2->ocur != XML_ELEMENT_CONTENT_ONCE)))\n+                xmlDumpElementContent(buf, content->c2, 1);\n+            else\n+                xmlDumpElementContent(buf, content->c2, 0);\n+            break;\n+        default:\n+            xmlErrValid(NULL, XML_ERR_INTERNAL_ERROR,\n+                        "Internal: ELEMENT content corrupted invalid type\\n",\n+                        NULL);\n     }\n     if (glob)\n         xmlBufferWriteChar(buf, ")");\n-    switch (content->ocur) {\n-        case XML_ELEMENT_CONTENT_ONCE:\n-    break;\n-        case XML_ELEMENT_CONTENT_OPT:\n-    xmlBufferWriteChar(buf, "?");\n-    break;\n-        case XML_ELEMENT_CONTENT_MULT:\n-    xmlBufferWriteChar(buf, "*");\n-    break;\n-        case XML_ELEMENT_CONTENT_PLUS:\n-    xmlBufferWriteChar(buf, "+");\n-    break;\n+    if (content->ocur != XML_ELEMENT_CONTENT_ONCE) { // Adjusting the conditions to avoid vulnerability\n+        switch (content->ocur) {\n+            case XML_ELEMENT_CONTENT_OPT:\n+                xmlBufferWriteChar(buf, "?");\n+                break;\n+            case XML_ELEMENT_CONTENT_MULT:\n+                xmlBufferWriteChar(buf, "*");\n+                break;\n+            case XML_ELEMENT_CONTENT_PLUS:\n+                xmlBufferWriteChar(buf, "+");\n+                break;\n+        }\n     }\n }\n \n+\n /**\n  * xmlSprintfElementContent:\n  * @buf:  an output buffer\n', 'id': 24, 'location': '/data/vulnloc/libxml2/CVE-2017-5969/src/valid.c:1213:5'}, {'diff': '@@ -1155,6 +1155,7 @@\n  *\n  * This will dump the content of the element table as an XML DTD definition\n  */\n+\n static void\n xmlDumpElementContent(xmlBufferPtr buf, xmlElementContentPtr content, int glob) {\n     if (content == NULL) return;\n@@ -1163,64 +1164,67 @@\n     switch (content->type) {\n         case XML_ELEMENT_CONTENT_PCDATA:\n             xmlBufferWriteChar(buf, "#PCDATA");\n-    break;\n-case XML_ELEMENT_CONTENT_ELEMENT:\n-    if (content->prefix != NULL) {\n-xmlBufferWriteCHAR(buf, content->prefix);\n-xmlBufferWriteChar(buf, ":");\n-    }\n-    xmlBufferWriteCHAR(buf, content->name);\n-    break;\n-case XML_ELEMENT_CONTENT_SEQ:\n-    if ((content->c1->type == XML_ELEMENT_CONTENT_OR) ||\n-        (content->c1->type == XML_ELEMENT_CONTENT_SEQ))\n-xmlDumpElementContent(buf, content->c1, 1);\n-    else\n-xmlDumpElementContent(buf, content->c1, 0);\n+            break;\n+        case XML_ELEMENT_CONTENT_ELEMENT:\n+            if (content->prefix != NULL) {\n+                xmlBufferWriteCHAR(buf, content->prefix);\n+                xmlBufferWriteChar(buf, ":");\n+            }\n+            xmlBufferWriteCHAR(buf, content->name);\n+            break;\n+        case XML_ELEMENT_CONTENT_SEQ:\n+            if ((content->c1->type == XML_ELEMENT_CONTENT_OR) ||\n+                (content->c1->type == XML_ELEMENT_CONTENT_SEQ))\n+                xmlDumpElementContent(buf, content->c1, 1);\n+            else\n+                xmlDumpElementContent(buf, content->c1, 0);\n             xmlBufferWriteChar(buf, " , ");\n-    if ((content->c2->type == XML_ELEMENT_CONTENT_OR) ||\n-        ((content->c2->type == XML_ELEMENT_CONTENT_SEQ) &&\n- (content->c2->ocur != XML_ELEMENT_CONTENT_ONCE)))\n-xmlDumpElementContent(buf, content->c2, 1);\n-    else\n-xmlDumpElementContent(buf, content->c2, 0);\n-    break;\n-case XML_ELEMENT_CONTENT_OR:\n-    if ((content->c1->type == XML_ELEMENT_CONTENT_OR) ||\n-        (content->c1->type == XML_ELEMENT_CONTENT_SEQ))\n-xmlDumpElementContent(buf, content->c1, 1);\n-    else\n-xmlDumpElementContent(buf, content->c1, 0);\n+            if (content->c2 != NULL && \n+                ((content->c2->type == XML_ELEMENT_CONTENT_OR) ||\n+                ((content->c2->type == XML_ELEMENT_CONTENT_SEQ) &&\n+                (content->c2->ocur != XML_ELEMENT_CONTENT_ONCE))))\n+                xmlDumpElementContent(buf, content->c2, 1);\n+            else\n+                xmlDumpElementContent(buf, content->c2, 0);\n+            break;\n+        case XML_ELEMENT_CONTENT_OR:\n+            if ((content->c1->type == XML_ELEMENT_CONTENT_OR) ||\n+                (content->c1->type == XML_ELEMENT_CONTENT_SEQ))\n+                xmlDumpElementContent(buf, content->c1, 1);\n+            else\n+                xmlDumpElementContent(buf, content->c1, 0);\n             xmlBufferWriteChar(buf, " | ");\n-    if ((content->c2->type == XML_ELEMENT_CONTENT_SEQ) ||\n-        ((content->c2->type == XML_ELEMENT_CONTENT_OR) &&\n- (content->c2->ocur != XML_ELEMENT_CONTENT_ONCE)))\n-xmlDumpElementContent(buf, content->c2, 1);\n-    else\n-xmlDumpElementContent(buf, content->c2, 0);\n-    break;\n-default:\n-    xmlErrValid(NULL, XML_ERR_INTERNAL_ERROR,\n-    "Internal: ELEMENT content corrupted invalid type\\n",\n-    NULL);\n+            if (content->c2 != NULL && \n+                ((content->c2->type == XML_ELEMENT_CONTENT_SEQ) ||\n+                ((content->c2->type == XML_ELEMENT_CONTENT_OR) &&\n+                (content->c2->ocur != XML_ELEMENT_CONTENT_ONCE))))\n+                xmlDumpElementContent(buf, content->c2, 1);\n+            else\n+                xmlDumpElementContent(buf, content->c2, 0);\n+            break;\n+        default:\n+            xmlErrValid(NULL, XML_ERR_INTERNAL_ERROR,\n+            "Internal: ELEMENT content corrupted invalid type\\n",\n+            NULL);\n     }\n     if (glob)\n         xmlBufferWriteChar(buf, ")");\n     switch (content->ocur) {\n         case XML_ELEMENT_CONTENT_ONCE:\n-    break;\n+            break;\n         case XML_ELEMENT_CONTENT_OPT:\n-    xmlBufferWriteChar(buf, "?");\n-    break;\n+            xmlBufferWriteChar(buf, "?");\n+            break;\n         case XML_ELEMENT_CONTENT_MULT:\n-    xmlBufferWriteChar(buf, "*");\n-    break;\n+            xmlBufferWriteChar(buf, "*");\n+            break;\n         case XML_ELEMENT_CONTENT_PLUS:\n-    xmlBufferWriteChar(buf, "+");\n-    break;\n+            xmlBufferWriteChar(buf, "+");\n+            break;\n     }\n }\n \n+\n /**\n  * xmlSprintfElementContent:\n  * @buf:  an output buffer\n', 'id': 25, 'location': '/data/vulnloc/libxml2/CVE-2017-5969/src/valid.c:1195:5'}, {'diff': '@@ -1155,6 +1155,7 @@\n  *\n  * This will dump the content of the element table as an XML DTD definition\n  */\n+\n static void\n xmlDumpElementContent(xmlBufferPtr buf, xmlElementContentPtr content, int glob) {\n     if (content == NULL) return;\n@@ -1163,64 +1164,73 @@\n     switch (content->type) {\n         case XML_ELEMENT_CONTENT_PCDATA:\n             xmlBufferWriteChar(buf, "#PCDATA");\n-    break;\n-case XML_ELEMENT_CONTENT_ELEMENT:\n-    if (content->prefix != NULL) {\n-xmlBufferWriteCHAR(buf, content->prefix);\n-xmlBufferWriteChar(buf, ":");\n-    }\n-    xmlBufferWriteCHAR(buf, content->name);\n-    break;\n-case XML_ELEMENT_CONTENT_SEQ:\n-    if ((content->c1->type == XML_ELEMENT_CONTENT_OR) ||\n-        (content->c1->type == XML_ELEMENT_CONTENT_SEQ))\n-xmlDumpElementContent(buf, content->c1, 1);\n-    else\n-xmlDumpElementContent(buf, content->c1, 0);\n-            xmlBufferWriteChar(buf, " , ");\n-    if ((content->c2->type == XML_ELEMENT_CONTENT_OR) ||\n-        ((content->c2->type == XML_ELEMENT_CONTENT_SEQ) &&\n- (content->c2->ocur != XML_ELEMENT_CONTENT_ONCE)))\n-xmlDumpElementContent(buf, content->c2, 1);\n-    else\n-xmlDumpElementContent(buf, content->c2, 0);\n-    break;\n-case XML_ELEMENT_CONTENT_OR:\n-    if ((content->c1->type == XML_ELEMENT_CONTENT_OR) ||\n-        (content->c1->type == XML_ELEMENT_CONTENT_SEQ))\n-xmlDumpElementContent(buf, content->c1, 1);\n-    else\n-xmlDumpElementContent(buf, content->c1, 0);\n-            xmlBufferWriteChar(buf, " | ");\n-    if ((content->c2->type == XML_ELEMENT_CONTENT_SEQ) ||\n-        ((content->c2->type == XML_ELEMENT_CONTENT_OR) &&\n- (content->c2->ocur != XML_ELEMENT_CONTENT_ONCE)))\n-xmlDumpElementContent(buf, content->c2, 1);\n-    else\n-xmlDumpElementContent(buf, content->c2, 0);\n-    break;\n-default:\n-    xmlErrValid(NULL, XML_ERR_INTERNAL_ERROR,\n-    "Internal: ELEMENT content corrupted invalid type\\n",\n-    NULL);\n+            break;\n+        case XML_ELEMENT_CONTENT_ELEMENT:\n+            if (content->prefix != NULL) {\n+                xmlBufferWriteCHAR(buf, content->prefix);\n+                xmlBufferWriteChar(buf, ":");\n+            }\n+            xmlBufferWriteCHAR(buf, content->name);\n+            break;\n+        case XML_ELEMENT_CONTENT_SEQ:\n+            if (content->c1) {\n+                if ((content->c1->type == XML_ELEMENT_CONTENT_OR) ||\n+                    (content->c1->type == XML_ELEMENT_CONTENT_SEQ))\n+                    xmlDumpElementContent(buf, content->c1, 1);\n+                else\n+                    xmlDumpElementContent(buf, content->c1, 0);\n+                xmlBufferWriteChar(buf, " , ");\n+            }\n+            if (content->c2) {\n+                if ((content->c2->type == XML_ELEMENT_CONTENT_OR) ||\n+                    ((content->c2->type == XML_ELEMENT_CONTENT_SEQ) &&\n+                     (content->c2->ocur != XML_ELEMENT_CONTENT_ONCE)))\n+                    xmlDumpElementContent(buf, content->c2, 1);\n+                else\n+                    xmlDumpElementContent(buf, content->c2, 0);\n+            }\n+            break;\n+        case XML_ELEMENT_CONTENT_OR:\n+            if (content->c1) {\n+                if ((content->c1->type == XML_ELEMENT_CONTENT_OR) ||\n+                    (content->c1->type == XML_ELEMENT_CONTENT_SEQ))\n+                    xmlDumpElementContent(buf, content->c1, 1);\n+                else\n+                    xmlDumpElementContent(buf, content->c1, 0);\n+                xmlBufferWriteChar(buf, " | ");\n+            }\n+            if (content->c2) {\n+                if ((content->c2->type == XML_ELEMENT_CONTENT_SEQ) ||\n+                    ((content->c2->type == XML_ELEMENT_CONTENT_OR) &&\n+                     (content->c2->ocur != XML_ELEMENT_CONTENT_ONCE)))\n+                    xmlDumpElementContent(buf, content->c2, 1);\n+                else\n+                    xmlDumpElementContent(buf, content->c2, 0);\n+            }\n+            break;\n+        default:\n+            xmlErrValid(NULL, XML_ERR_INTERNAL_ERROR,\n+                        "Internal: ELEMENT content corrupted invalid type\\n",\n+                        NULL);\n     }\n     if (glob)\n         xmlBufferWriteChar(buf, ")");\n     switch (content->ocur) {\n         case XML_ELEMENT_CONTENT_ONCE:\n-    break;\n+            break;\n         case XML_ELEMENT_CONTENT_OPT:\n-    xmlBufferWriteChar(buf, "?");\n-    break;\n+            xmlBufferWriteChar(buf, "?");\n+            break;\n         case XML_ELEMENT_CONTENT_MULT:\n-    xmlBufferWriteChar(buf, "*");\n-    break;\n+            xmlBufferWriteChar(buf, "*");\n+            break;\n         case XML_ELEMENT_CONTENT_PLUS:\n-    xmlBufferWriteChar(buf, "+");\n-    break;\n+            xmlBufferWriteChar(buf, "+");\n+            break;\n     }\n }\n \n+\n /**\n  * xmlSprintfElementContent:\n  * @buf:  an output buffer\n', 'id': 26, 'location': '/data/vulnloc/libxml2/CVE-2017-5969/src/valid.c:1195:5'}, {'diff': '@@ -1155,6 +1155,7 @@\n  *\n  * This will dump the content of the element table as an XML DTD definition\n  */\n+\n static void\n xmlDumpElementContent(xmlBufferPtr buf, xmlElementContentPtr content, int glob) {\n     if (content == NULL) return;\n@@ -1163,64 +1164,73 @@\n     switch (content->type) {\n         case XML_ELEMENT_CONTENT_PCDATA:\n             xmlBufferWriteChar(buf, "#PCDATA");\n-    break;\n-case XML_ELEMENT_CONTENT_ELEMENT:\n-    if (content->prefix != NULL) {\n-xmlBufferWriteCHAR(buf, content->prefix);\n-xmlBufferWriteChar(buf, ":");\n-    }\n-    xmlBufferWriteCHAR(buf, content->name);\n-    break;\n-case XML_ELEMENT_CONTENT_SEQ:\n-    if ((content->c1->type == XML_ELEMENT_CONTENT_OR) ||\n-        (content->c1->type == XML_ELEMENT_CONTENT_SEQ))\n-xmlDumpElementContent(buf, content->c1, 1);\n-    else\n-xmlDumpElementContent(buf, content->c1, 0);\n-            xmlBufferWriteChar(buf, " , ");\n-    if ((content->c2->type == XML_ELEMENT_CONTENT_OR) ||\n-        ((content->c2->type == XML_ELEMENT_CONTENT_SEQ) &&\n- (content->c2->ocur != XML_ELEMENT_CONTENT_ONCE)))\n-xmlDumpElementContent(buf, content->c2, 1);\n-    else\n-xmlDumpElementContent(buf, content->c2, 0);\n-    break;\n-case XML_ELEMENT_CONTENT_OR:\n-    if ((content->c1->type == XML_ELEMENT_CONTENT_OR) ||\n-        (content->c1->type == XML_ELEMENT_CONTENT_SEQ))\n-xmlDumpElementContent(buf, content->c1, 1);\n-    else\n-xmlDumpElementContent(buf, content->c1, 0);\n-            xmlBufferWriteChar(buf, " | ");\n-    if ((content->c2->type == XML_ELEMENT_CONTENT_SEQ) ||\n-        ((content->c2->type == XML_ELEMENT_CONTENT_OR) &&\n- (content->c2->ocur != XML_ELEMENT_CONTENT_ONCE)))\n-xmlDumpElementContent(buf, content->c2, 1);\n-    else\n-xmlDumpElementContent(buf, content->c2, 0);\n-    break;\n-default:\n-    xmlErrValid(NULL, XML_ERR_INTERNAL_ERROR,\n-    "Internal: ELEMENT content corrupted invalid type\\n",\n-    NULL);\n+            break;\n+        case XML_ELEMENT_CONTENT_ELEMENT:\n+            if (content->prefix != NULL) {\n+                xmlBufferWriteCHAR(buf, content->prefix);\n+                xmlBufferWriteChar(buf, ":");\n+            }\n+            xmlBufferWriteCHAR(buf, content->name);\n+            break;\n+        case XML_ELEMENT_CONTENT_SEQ:\n+            if (content->c1 != NULL) {\n+                if ((content->c1->type == XML_ELEMENT_CONTENT_OR) ||\n+                    (content->c1->type == XML_ELEMENT_CONTENT_SEQ))\n+                    xmlDumpElementContent(buf, content->c1, 1);\n+                else\n+                    xmlDumpElementContent(buf, content->c1, 0);\n+                xmlBufferWriteChar(buf, " , ");\n+            }\n+            if (content->c2 != NULL) {\n+                if ((content->c2->type == XML_ELEMENT_CONTENT_OR) ||\n+                    ((content->c2->type == XML_ELEMENT_CONTENT_SEQ) &&\n+                     (content->c2->ocur != XML_ELEMENT_CONTENT_ONCE)))\n+                    xmlDumpElementContent(buf, content->c2, 1);\n+                else\n+                    xmlDumpElementContent(buf, content->c2, 0);\n+            }\n+            break;\n+        case XML_ELEMENT_CONTENT_OR:\n+            if (content->c1 != NULL) {\n+                if ((content->c1->type == XML_ELEMENT_CONTENT_OR) ||\n+                    (content->c1->type == XML_ELEMENT_CONTENT_SEQ))\n+                    xmlDumpElementContent(buf, content->c1, 1);\n+                else\n+                    xmlDumpElementContent(buf, content->c1, 0);\n+                xmlBufferWriteChar(buf, " | ");\n+            }\n+            if (content->c2 != NULL) {\n+                if ((content->c2->type == XML_ELEMENT_CONTENT_SEQ) ||\n+                    ((content->c2->type == XML_ELEMENT_CONTENT_OR) &&\n+                     (content->c2->ocur != XML_ELEMENT_CONTENT_ONCE)))\n+                    xmlDumpElementContent(buf, content->c2, 1);\n+                else\n+                    xmlDumpElementContent(buf, content->c2, 0);\n+            }\n+            break;\n+        default:\n+            xmlErrValid(NULL, XML_ERR_INTERNAL_ERROR,\n+                        "Internal: ELEMENT content corrupted invalid type\\n",\n+                        NULL);\n     }\n     if (glob)\n         xmlBufferWriteChar(buf, ")");\n     switch (content->ocur) {\n         case XML_ELEMENT_CONTENT_ONCE:\n-    break;\n+            break;\n         case XML_ELEMENT_CONTENT_OPT:\n-    xmlBufferWriteChar(buf, "?");\n-    break;\n+            xmlBufferWriteChar(buf, "?");\n+            break;\n         case XML_ELEMENT_CONTENT_MULT:\n-    xmlBufferWriteChar(buf, "*");\n-    break;\n+            xmlBufferWriteChar(buf, "*");\n+            break;\n         case XML_ELEMENT_CONTENT_PLUS:\n-    xmlBufferWriteChar(buf, "+");\n-    break;\n+            xmlBufferWriteChar(buf, "+");\n+            break;\n     }\n }\n \n+\n /**\n  * xmlSprintfElementContent:\n  * @buf:  an output buffer\n', 'id': 27, 'location': '/data/vulnloc/libxml2/CVE-2017-5969/src/valid.c:1195:5'}, {'diff': '@@ -1155,6 +1155,7 @@\n  *\n  * This will dump the content of the element table as an XML DTD definition\n  */\n+\n static void\n xmlDumpElementContent(xmlBufferPtr buf, xmlElementContentPtr content, int glob) {\n     if (content == NULL) return;\n@@ -1163,64 +1164,73 @@\n     switch (content->type) {\n         case XML_ELEMENT_CONTENT_PCDATA:\n             xmlBufferWriteChar(buf, "#PCDATA");\n-    break;\n-case XML_ELEMENT_CONTENT_ELEMENT:\n-    if (content->prefix != NULL) {\n-xmlBufferWriteCHAR(buf, content->prefix);\n-xmlBufferWriteChar(buf, ":");\n-    }\n-    xmlBufferWriteCHAR(buf, content->name);\n-    break;\n-case XML_ELEMENT_CONTENT_SEQ:\n-    if ((content->c1->type == XML_ELEMENT_CONTENT_OR) ||\n-        (content->c1->type == XML_ELEMENT_CONTENT_SEQ))\n-xmlDumpElementContent(buf, content->c1, 1);\n-    else\n-xmlDumpElementContent(buf, content->c1, 0);\n+            break;\n+        case XML_ELEMENT_CONTENT_ELEMENT:\n+            if (content->prefix != NULL) {\n+                xmlBufferWriteCHAR(buf, content->prefix);\n+                xmlBufferWriteChar(buf, ":");\n+            }\n+            xmlBufferWriteCHAR(buf, content->name);\n+            break;\n+        case XML_ELEMENT_CONTENT_SEQ:\n+            if (content->c1 != NULL) {\n+                if ((content->c1->type == XML_ELEMENT_CONTENT_OR) ||\n+                    (content->c1->type == XML_ELEMENT_CONTENT_SEQ))\n+                    xmlDumpElementContent(buf, content->c1, 1);\n+                else\n+                    xmlDumpElementContent(buf, content->c1, 0);\n+            }\n             xmlBufferWriteChar(buf, " , ");\n-    if ((content->c2->type == XML_ELEMENT_CONTENT_OR) ||\n-        ((content->c2->type == XML_ELEMENT_CONTENT_SEQ) &&\n- (content->c2->ocur != XML_ELEMENT_CONTENT_ONCE)))\n-xmlDumpElementContent(buf, content->c2, 1);\n-    else\n-xmlDumpElementContent(buf, content->c2, 0);\n-    break;\n-case XML_ELEMENT_CONTENT_OR:\n-    if ((content->c1->type == XML_ELEMENT_CONTENT_OR) ||\n-        (content->c1->type == XML_ELEMENT_CONTENT_SEQ))\n-xmlDumpElementContent(buf, content->c1, 1);\n-    else\n-xmlDumpElementContent(buf, content->c1, 0);\n+            if (content->c2 != NULL) {\n+                if ((content->c2->type == XML_ELEMENT_CONTENT_OR) ||\n+                    ((content->c2->type == XML_ELEMENT_CONTENT_SEQ) &&\n+                    (content->c2->ocur != XML_ELEMENT_CONTENT_ONCE)))\n+                    xmlDumpElementContent(buf, content->c2, 1);\n+                else\n+                    xmlDumpElementContent(buf, content->c2, 0);\n+            }\n+            break;\n+        case XML_ELEMENT_CONTENT_OR:\n+            if (content->c1 != NULL) {\n+                if ((content->c1->type == XML_ELEMENT_CONTENT_OR) ||\n+                    (content->c1->type == XML_ELEMENT_CONTENT_SEQ))\n+                    xmlDumpElementContent(buf, content->c1, 1);\n+                else\n+                    xmlDumpElementContent(buf, content->c1, 0);\n+            }\n             xmlBufferWriteChar(buf, " | ");\n-    if ((content->c2->type == XML_ELEMENT_CONTENT_SEQ) ||\n-        ((content->c2->type == XML_ELEMENT_CONTENT_OR) &&\n- (content->c2->ocur != XML_ELEMENT_CONTENT_ONCE)))\n-xmlDumpElementContent(buf, content->c2, 1);\n-    else\n-xmlDumpElementContent(buf, content->c2, 0);\n-    break;\n-default:\n-    xmlErrValid(NULL, XML_ERR_INTERNAL_ERROR,\n-    "Internal: ELEMENT content corrupted invalid type\\n",\n-    NULL);\n+            if (content->c2 != NULL) {\n+                if ((content->c2->type == XML_ELEMENT_CONTENT_SEQ) ||\n+                    ((content->c2->type == XML_ELEMENT_CONTENT_OR) &&\n+                    (content->c2->ocur != XML_ELEMENT_CONTENT_ONCE)))\n+                    xmlDumpElementContent(buf, content->c2, 1);\n+                else\n+                    xmlDumpElementContent(buf, content->c2, 0);\n+            }\n+            break;\n+        default:\n+            xmlErrValid(NULL, XML_ERR_INTERNAL_ERROR,\n+            "Internal: ELEMENT content corrupted invalid type\\n",\n+            NULL);\n     }\n     if (glob)\n         xmlBufferWriteChar(buf, ")");\n     switch (content->ocur) {\n         case XML_ELEMENT_CONTENT_ONCE:\n-    break;\n+            break;\n         case XML_ELEMENT_CONTENT_OPT:\n-    xmlBufferWriteChar(buf, "?");\n-    break;\n+            xmlBufferWriteChar(buf, "?");\n+            break;\n         case XML_ELEMENT_CONTENT_MULT:\n-    xmlBufferWriteChar(buf, "*");\n-    break;\n+            xmlBufferWriteChar(buf, "*");\n+            break;\n         case XML_ELEMENT_CONTENT_PLUS:\n-    xmlBufferWriteChar(buf, "+");\n-    break;\n+            xmlBufferWriteChar(buf, "+");\n+            break;\n     }\n }\n \n+\n /**\n  * xmlSprintfElementContent:\n  * @buf:  an output buffer\n', 'id': 28, 'location': '/data/vulnloc/libxml2/CVE-2017-5969/src/valid.c:1195:5'}, {'diff': '@@ -1155,6 +1155,7 @@\n  *\n  * This will dump the content of the element table as an XML DTD definition\n  */\n+\n static void\n xmlDumpElementContent(xmlBufferPtr buf, xmlElementContentPtr content, int glob) {\n     if (content == NULL) return;\n@@ -1163,64 +1164,73 @@\n     switch (content->type) {\n         case XML_ELEMENT_CONTENT_PCDATA:\n             xmlBufferWriteChar(buf, "#PCDATA");\n-    break;\n-case XML_ELEMENT_CONTENT_ELEMENT:\n-    if (content->prefix != NULL) {\n-xmlBufferWriteCHAR(buf, content->prefix);\n-xmlBufferWriteChar(buf, ":");\n-    }\n-    xmlBufferWriteCHAR(buf, content->name);\n-    break;\n-case XML_ELEMENT_CONTENT_SEQ:\n-    if ((content->c1->type == XML_ELEMENT_CONTENT_OR) ||\n-        (content->c1->type == XML_ELEMENT_CONTENT_SEQ))\n-xmlDumpElementContent(buf, content->c1, 1);\n-    else\n-xmlDumpElementContent(buf, content->c1, 0);\n-            xmlBufferWriteChar(buf, " , ");\n-    if ((content->c2->type == XML_ELEMENT_CONTENT_OR) ||\n-        ((content->c2->type == XML_ELEMENT_CONTENT_SEQ) &&\n- (content->c2->ocur != XML_ELEMENT_CONTENT_ONCE)))\n-xmlDumpElementContent(buf, content->c2, 1);\n-    else\n-xmlDumpElementContent(buf, content->c2, 0);\n-    break;\n-case XML_ELEMENT_CONTENT_OR:\n-    if ((content->c1->type == XML_ELEMENT_CONTENT_OR) ||\n-        (content->c1->type == XML_ELEMENT_CONTENT_SEQ))\n-xmlDumpElementContent(buf, content->c1, 1);\n-    else\n-xmlDumpElementContent(buf, content->c1, 0);\n-            xmlBufferWriteChar(buf, " | ");\n-    if ((content->c2->type == XML_ELEMENT_CONTENT_SEQ) ||\n-        ((content->c2->type == XML_ELEMENT_CONTENT_OR) &&\n- (content->c2->ocur != XML_ELEMENT_CONTENT_ONCE)))\n-xmlDumpElementContent(buf, content->c2, 1);\n-    else\n-xmlDumpElementContent(buf, content->c2, 0);\n-    break;\n-default:\n-    xmlErrValid(NULL, XML_ERR_INTERNAL_ERROR,\n-    "Internal: ELEMENT content corrupted invalid type\\n",\n-    NULL);\n+            break;\n+        case XML_ELEMENT_CONTENT_ELEMENT:\n+            if (content->prefix != NULL) {\n+                xmlBufferWriteCHAR(buf, content->prefix);\n+                xmlBufferWriteChar(buf, ":");\n+            }\n+            xmlBufferWriteCHAR(buf, content->name);\n+            break;\n+        case XML_ELEMENT_CONTENT_SEQ:\n+            if (content->c1 != NULL) {\n+                if ((content->c1->type == XML_ELEMENT_CONTENT_OR) ||\n+                    (content->c1->type == XML_ELEMENT_CONTENT_SEQ))\n+                    xmlDumpElementContent(buf, content->c1, 1);\n+                else\n+                    xmlDumpElementContent(buf, content->c1, 0);\n+                xmlBufferWriteChar(buf, " , ");\n+            }\n+            if (content->c2 != NULL) {\n+                if ((content->c2->type == XML_ELEMENT_CONTENT_OR) ||\n+                    ((content->c2->type == XML_ELEMENT_CONTENT_SEQ) &&\n+                     (content->c2->ocur != XML_ELEMENT_CONTENT_ONCE)))\n+                    xmlDumpElementContent(buf, content->c2, 1);\n+                else\n+                    xmlDumpElementContent(buf, content->c2, 0);\n+            }\n+            break;\n+        case XML_ELEMENT_CONTENT_OR:\n+            if (content->c1 != NULL) {\n+                if ((content->c1->type == XML_ELEMENT_CONTENT_OR) ||\n+                    (content->c1->type == XML_ELEMENT_CONTENT_SEQ))\n+                    xmlDumpElementContent(buf, content->c1, 1);\n+                else\n+                    xmlDumpElementContent(buf, content->c1, 0);\n+                xmlBufferWriteChar(buf, " | ");\n+            }\n+            if (content->c2 != NULL) {\n+                if ((content->c2->type == XML_ELEMENT_CONTENT_SEQ) ||\n+                    ((content->c2->type == XML_ELEMENT_CONTENT_OR) &&\n+                     (content->c2->ocur != XML_ELEMENT_CONTENT_ONCE)))\n+                    xmlDumpElementContent(buf, content->c2, 1);\n+                else\n+                    xmlDumpElementContent(buf, content->c2, 0);\n+            }\n+            break;\n+        default:\n+            xmlErrValid(NULL, XML_ERR_INTERNAL_ERROR,\n+                        "Internal: ELEMENT content corrupted invalid type\\n",\n+                        NULL);\n     }\n     if (glob)\n         xmlBufferWriteChar(buf, ")");\n     switch (content->ocur) {\n         case XML_ELEMENT_CONTENT_ONCE:\n-    break;\n+            break;\n         case XML_ELEMENT_CONTENT_OPT:\n-    xmlBufferWriteChar(buf, "?");\n-    break;\n+            xmlBufferWriteChar(buf, "?");\n+            break;\n         case XML_ELEMENT_CONTENT_MULT:\n-    xmlBufferWriteChar(buf, "*");\n-    break;\n+            xmlBufferWriteChar(buf, "*");\n+            break;\n         case XML_ELEMENT_CONTENT_PLUS:\n-    xmlBufferWriteChar(buf, "+");\n-    break;\n+            xmlBufferWriteChar(buf, "+");\n+            break;\n     }\n }\n \n+\n /**\n  * xmlSprintfElementContent:\n  * @buf:  an output buffer\n', 'id': 29, 'location': '/data/vulnloc/libxml2/CVE-2017-5969/src/valid.c:1195:5'}, {'diff': '@@ -1663,6 +1663,7 @@\n  * This will dump the content of the element declaration as an XML\n  * DTD definition\n  */\n+\n void\n xmlDumpElementDecl(xmlBufferPtr buf, xmlElementPtr elem) {\n     if ((buf == NULL) || (elem == NULL))\n@@ -1670,27 +1671,27 @@\n     switch (elem->etype) {\n case XML_ELEMENT_TYPE_EMPTY:\n     xmlBufferWriteChar(buf, "<!ELEMENT ");\n-    if (elem->prefix != NULL) {\n-xmlBufferWriteCHAR(buf, elem->prefix);\n-xmlBufferWriteChar(buf, ":");\n+    if (elem->prefix != NULL && elem->prefix != NULL) { // Added NULL check for prefix\n+        xmlBufferWriteCHAR(buf, elem->prefix);\n+        xmlBufferWriteChar(buf, ":");\n     }\n     xmlBufferWriteCHAR(buf, elem->name);\n     xmlBufferWriteChar(buf, " EMPTY>\\n");\n     break;\n case XML_ELEMENT_TYPE_ANY:\n     xmlBufferWriteChar(buf, "<!ELEMENT ");\n-    if (elem->prefix != NULL) {\n-xmlBufferWriteCHAR(buf, elem->prefix);\n-xmlBufferWriteChar(buf, ":");\n+    if (elem->prefix != NULL && elem->prefix != NULL) { // Added NULL check for prefix\n+        xmlBufferWriteCHAR(buf, elem->prefix);\n+        xmlBufferWriteChar(buf, ":");\n     }\n     xmlBufferWriteCHAR(buf, elem->name);\n     xmlBufferWriteChar(buf, " ANY>\\n");\n     break;\n case XML_ELEMENT_TYPE_MIXED:\n     xmlBufferWriteChar(buf, "<!ELEMENT ");\n-    if (elem->prefix != NULL) {\n-xmlBufferWriteCHAR(buf, elem->prefix);\n-xmlBufferWriteChar(buf, ":");\n+    if (elem->prefix != NULL && elem->prefix != NULL) { // Added NULL check for prefix\n+        xmlBufferWriteCHAR(buf, elem->prefix);\n+        xmlBufferWriteChar(buf, ":");\n     }\n     xmlBufferWriteCHAR(buf, elem->name);\n     xmlBufferWriteChar(buf, " ");\n@@ -1699,9 +1700,9 @@\n     break;\n case XML_ELEMENT_TYPE_ELEMENT:\n     xmlBufferWriteChar(buf, "<!ELEMENT ");\n-    if (elem->prefix != NULL) {\n-xmlBufferWriteCHAR(buf, elem->prefix);\n-xmlBufferWriteChar(buf, ":");\n+    if (elem->prefix != NULL && elem->prefix != NULL) { // Added NULL check for prefix\n+        xmlBufferWriteCHAR(buf, elem->prefix);\n+        xmlBufferWriteChar(buf, ":");\n     }\n     xmlBufferWriteCHAR(buf, elem->name);\n     xmlBufferWriteChar(buf, " ");\n@@ -1715,6 +1716,7 @@\n     }\n }\n \n+\n /**\n  * xmlDumpElementDeclScan:\n  * @elem:  An element table\n', 'id': 30, 'location': '/data/vulnloc/libxml2/CVE-2017-5969/src/valid.c:1673:5'}, {'diff': '@@ -1663,58 +1663,59 @@\n  * This will dump the content of the element declaration as an XML\n  * DTD definition\n  */\n+\n void\n xmlDumpElementDecl(xmlBufferPtr buf, xmlElementPtr elem) {\n     if ((buf == NULL) || (elem == NULL))\n         return;\n-    switch (elem->etype) {\n-case XML_ELEMENT_TYPE_EMPTY:\n-    xmlBufferWriteChar(buf, "<!ELEMENT ");\n-    if (elem->prefix != NULL) {\n-xmlBufferWriteCHAR(buf, elem->prefix);\n-xmlBufferWriteChar(buf, ":");\n-    }\n-    xmlBufferWriteCHAR(buf, elem->name);\n-    xmlBufferWriteChar(buf, " EMPTY>\\n");\n-    break;\n-case XML_ELEMENT_TYPE_ANY:\n-    xmlBufferWriteChar(buf, "<!ELEMENT ");\n-    if (elem->prefix != NULL) {\n-xmlBufferWriteCHAR(buf, elem->prefix);\n-xmlBufferWriteChar(buf, ":");\n-    }\n-    xmlBufferWriteCHAR(buf, elem->name);\n-    xmlBufferWriteChar(buf, " ANY>\\n");\n-    break;\n-case XML_ELEMENT_TYPE_MIXED:\n-    xmlBufferWriteChar(buf, "<!ELEMENT ");\n-    if (elem->prefix != NULL) {\n-xmlBufferWriteCHAR(buf, elem->prefix);\n-xmlBufferWriteChar(buf, ":");\n-    }\n-    xmlBufferWriteCHAR(buf, elem->name);\n-    xmlBufferWriteChar(buf, " ");\n-    xmlDumpElementContent(buf, elem->content, 1);\n-    xmlBufferWriteChar(buf, ">\\n");\n-    break;\n-case XML_ELEMENT_TYPE_ELEMENT:\n-    xmlBufferWriteChar(buf, "<!ELEMENT ");\n-    if (elem->prefix != NULL) {\n-xmlBufferWriteCHAR(buf, elem->prefix);\n-xmlBufferWriteChar(buf, ":");\n-    }\n-    xmlBufferWriteCHAR(buf, elem->name);\n-    xmlBufferWriteChar(buf, " ");\n-    xmlDumpElementContent(buf, elem->content, 1);\n-    xmlBufferWriteChar(buf, ">\\n");\n-    break;\n-default:\n-    xmlErrValid(NULL, XML_ERR_INTERNAL_ERROR,\n-    "Internal: ELEMENT struct corrupted invalid type\\n",\n-    NULL);\n+    \n+    if (elem->prefix != NULL && elem->prefix->type == VALID_PREFIX_TYPE) { // Add check for valid prefix type\n+        switch (elem->etype) {\n+            case XML_ELEMENT_TYPE_EMPTY:\n+                xmlBufferWriteChar(buf, "<!ELEMENT ");\n+                xmlBufferWriteCHAR(buf, elem->prefix);\n+                xmlBufferWriteChar(buf, ":");\n+                xmlBufferWriteCHAR(buf, elem->name);\n+                xmlBufferWriteChar(buf, " EMPTY>\\n");\n+                break;\n+            case XML_ELEMENT_TYPE_ANY:\n+                xmlBufferWriteChar(buf, "<!ELEMENT ");\n+                xmlBufferWriteCHAR(buf, elem->prefix);\n+                xmlBufferWriteChar(buf, ":");\n+                xmlBufferWriteCHAR(buf, elem->name);\n+                xmlBufferWriteChar(buf, " ANY>\\n");\n+                break;\n+            case XML_ELEMENT_TYPE_MIXED:\n+                xmlBufferWriteChar(buf, "<!ELEMENT ");\n+                xmlBufferWriteCHAR(buf, elem->prefix);\n+                xmlBufferWriteChar(buf, ":");\n+                xmlBufferWriteCHAR(buf, elem->name);\n+                xmlBufferWriteChar(buf, " ");\n+                xmlDumpElementContent(buf, elem->content, 1);\n+                xmlBufferWriteChar(buf, ">\\n");\n+                break;\n+            case XML_ELEMENT_TYPE_ELEMENT:\n+                xmlBufferWriteChar(buf, "<!ELEMENT ");\n+                xmlBufferWriteCHAR(buf, elem->prefix);\n+                xmlBufferWriteChar(buf, ":");\n+                xmlBufferWriteCHAR(buf, elem->name);\n+                xmlBufferWriteChar(buf, " ");\n+                xmlDumpElementContent(buf, elem->content, 1);\n+                xmlBufferWriteChar(buf, ">\\n");\n+                break;\n+            default:\n+                xmlErrValid(NULL, XML_ERR_INTERNAL_ERROR,\n+                "Internal: ELEMENT struct corrupted invalid type\\n",\n+                NULL);\n+        }\n+    } else {\n+        xmlErrValid(NULL, XML_ERR_INTERNAL_ERROR,\n+        "Internal: ELEMENT prefix is invalid or NULL\\n",\n+        NULL); // Handle case where prefix is NULL or invalid\n     }\n }\n \n+\n /**\n  * xmlDumpElementDeclScan:\n  * @elem:  An element table\n', 'id': 31, 'location': '/data/vulnloc/libxml2/CVE-2017-5969/src/valid.c:1673:5'}, {'diff': '@@ -1663,6 +1663,7 @@\n  * This will dump the content of the element declaration as an XML\n  * DTD definition\n  */\n+\n void\n xmlDumpElementDecl(xmlBufferPtr buf, xmlElementPtr elem) {\n     if ((buf == NULL) || (elem == NULL))\n@@ -1670,27 +1671,27 @@\n     switch (elem->etype) {\n case XML_ELEMENT_TYPE_EMPTY:\n     xmlBufferWriteChar(buf, "<!ELEMENT ");\n-    if (elem->prefix != NULL) {\n-xmlBufferWriteCHAR(buf, elem->prefix);\n-xmlBufferWriteChar(buf, ":");\n+    if (elem->prefix != NULL && xmlStrlen(elem->prefix) > 0) {\n+        xmlBufferWriteCHAR(buf, elem->prefix);\n+        xmlBufferWriteChar(buf, ":");\n     }\n     xmlBufferWriteCHAR(buf, elem->name);\n     xmlBufferWriteChar(buf, " EMPTY>\\n");\n     break;\n case XML_ELEMENT_TYPE_ANY:\n     xmlBufferWriteChar(buf, "<!ELEMENT ");\n-    if (elem->prefix != NULL) {\n-xmlBufferWriteCHAR(buf, elem->prefix);\n-xmlBufferWriteChar(buf, ":");\n+    if (elem->prefix != NULL && xmlStrlen(elem->prefix) > 0) {\n+        xmlBufferWriteCHAR(buf, elem->prefix);\n+        xmlBufferWriteChar(buf, ":");\n     }\n     xmlBufferWriteCHAR(buf, elem->name);\n     xmlBufferWriteChar(buf, " ANY>\\n");\n     break;\n case XML_ELEMENT_TYPE_MIXED:\n     xmlBufferWriteChar(buf, "<!ELEMENT ");\n-    if (elem->prefix != NULL) {\n-xmlBufferWriteCHAR(buf, elem->prefix);\n-xmlBufferWriteChar(buf, ":");\n+    if (elem->prefix != NULL && xmlStrlen(elem->prefix) > 0) {\n+        xmlBufferWriteCHAR(buf, elem->prefix);\n+        xmlBufferWriteChar(buf, ":");\n     }\n     xmlBufferWriteCHAR(buf, elem->name);\n     xmlBufferWriteChar(buf, " ");\n@@ -1699,9 +1700,9 @@\n     break;\n case XML_ELEMENT_TYPE_ELEMENT:\n     xmlBufferWriteChar(buf, "<!ELEMENT ");\n-    if (elem->prefix != NULL) {\n-xmlBufferWriteCHAR(buf, elem->prefix);\n-xmlBufferWriteChar(buf, ":");\n+    if (elem->prefix != NULL && xmlStrlen(elem->prefix) > 0) {\n+        xmlBufferWriteCHAR(buf, elem->prefix);\n+        xmlBufferWriteChar(buf, ":");\n     }\n     xmlBufferWriteCHAR(buf, elem->name);\n     xmlBufferWriteChar(buf, " ");\n@@ -1715,6 +1716,7 @@\n     }\n }\n \n+\n /**\n  * xmlDumpElementDeclScan:\n  * @elem:  An element table\n', 'id': 32, 'location': '/data/vulnloc/libxml2/CVE-2017-5969/src/valid.c:1673:5'}, {'diff': '@@ -1663,58 +1663,60 @@\n  * This will dump the content of the element declaration as an XML\n  * DTD definition\n  */\n+\n void\n xmlDumpElementDecl(xmlBufferPtr buf, xmlElementPtr elem) {\n     if ((buf == NULL) || (elem == NULL))\n         return;\n     switch (elem->etype) {\n-case XML_ELEMENT_TYPE_EMPTY:\n-    xmlBufferWriteChar(buf, "<!ELEMENT ");\n-    if (elem->prefix != NULL) {\n-xmlBufferWriteCHAR(buf, elem->prefix);\n-xmlBufferWriteChar(buf, ":");\n-    }\n-    xmlBufferWriteCHAR(buf, elem->name);\n-    xmlBufferWriteChar(buf, " EMPTY>\\n");\n-    break;\n-case XML_ELEMENT_TYPE_ANY:\n-    xmlBufferWriteChar(buf, "<!ELEMENT ");\n-    if (elem->prefix != NULL) {\n-xmlBufferWriteCHAR(buf, elem->prefix);\n-xmlBufferWriteChar(buf, ":");\n-    }\n-    xmlBufferWriteCHAR(buf, elem->name);\n-    xmlBufferWriteChar(buf, " ANY>\\n");\n-    break;\n-case XML_ELEMENT_TYPE_MIXED:\n-    xmlBufferWriteChar(buf, "<!ELEMENT ");\n-    if (elem->prefix != NULL) {\n-xmlBufferWriteCHAR(buf, elem->prefix);\n-xmlBufferWriteChar(buf, ":");\n-    }\n-    xmlBufferWriteCHAR(buf, elem->name);\n-    xmlBufferWriteChar(buf, " ");\n-    xmlDumpElementContent(buf, elem->content, 1);\n-    xmlBufferWriteChar(buf, ">\\n");\n-    break;\n-case XML_ELEMENT_TYPE_ELEMENT:\n-    xmlBufferWriteChar(buf, "<!ELEMENT ");\n-    if (elem->prefix != NULL) {\n-xmlBufferWriteCHAR(buf, elem->prefix);\n-xmlBufferWriteChar(buf, ":");\n-    }\n-    xmlBufferWriteCHAR(buf, elem->name);\n-    xmlBufferWriteChar(buf, " ");\n-    xmlDumpElementContent(buf, elem->content, 1);\n-    xmlBufferWriteChar(buf, ">\\n");\n-    break;\n-default:\n-    xmlErrValid(NULL, XML_ERR_INTERNAL_ERROR,\n-    "Internal: ELEMENT struct corrupted invalid type\\n",\n-    NULL);\n+    case XML_ELEMENT_TYPE_EMPTY:\n+        xmlBufferWriteChar(buf, "<!ELEMENT ");\n+        if (elem->prefix != NULL && !xmlIsBadNode((xmlNodePtr)elem->prefix)) {\n+            xmlBufferWriteCHAR(buf, elem->prefix);\n+            xmlBufferWriteChar(buf, ":");\n+        }\n+        xmlBufferWriteCHAR(buf, elem->name);\n+        xmlBufferWriteChar(buf, " EMPTY>\\n");\n+        break;\n+    case XML_ELEMENT_TYPE_ANY:\n+        xmlBufferWriteChar(buf, "<!ELEMENT ");\n+        if (elem->prefix != NULL && !xmlIsBadNode((xmlNodePtr)elem->prefix)) {\n+            xmlBufferWriteCHAR(buf, elem->prefix);\n+            xmlBufferWriteChar(buf, ":");\n+        }\n+        xmlBufferWriteCHAR(buf, elem->name);\n+        xmlBufferWriteChar(buf, " ANY>\\n");\n+        break;\n+    case XML_ELEMENT_TYPE_MIXED:\n+        xmlBufferWriteChar(buf, "<!ELEMENT ");\n+        if (elem->prefix != NULL && !xmlIsBadNode((xmlNodePtr)elem->prefix)) {\n+            xmlBufferWriteCHAR(buf, elem->prefix);\n+            xmlBufferWriteChar(buf, ":");\n+        }\n+        xmlBufferWriteCHAR(buf, elem->name);\n+        xmlBufferWriteChar(buf, " ");\n+        xmlDumpElementContent(buf, elem->content, 1);\n+        xmlBufferWriteChar(buf, ">\\n");\n+        break;\n+    case XML_ELEMENT_TYPE_ELEMENT:\n+        xmlBufferWriteChar(buf, "<!ELEMENT ");\n+        if (elem->prefix != NULL && !xmlIsBadNode((xmlNodePtr)elem->prefix)) {\n+            xmlBufferWriteCHAR(buf, elem->prefix);\n+            xmlBufferWriteChar(buf, ":");\n+        }\n+        xmlBufferWriteCHAR(buf, elem->name);\n+        xmlBufferWriteChar(buf, " ");\n+        xmlDumpElementContent(buf, elem->content, 1);\n+        xmlBufferWriteChar(buf, ">\\n");\n+        break;\n+    default:\n+        xmlErrValid(NULL, XML_ERR_INTERNAL_ERROR,\n+        "Internal: ELEMENT struct corrupted invalid type\\n",\n+        NULL);\n     }\n }\n \n+\n /**\n  * xmlDumpElementDeclScan:\n  * @elem:  An element table\n', 'id': 33, 'location': '/data/vulnloc/libxml2/CVE-2017-5969/src/valid.c:1673:5'}, {'diff': '@@ -1663,58 +1663,60 @@\n  * This will dump the content of the element declaration as an XML\n  * DTD definition\n  */\n+\n void\n xmlDumpElementDecl(xmlBufferPtr buf, xmlElementPtr elem) {\n     if ((buf == NULL) || (elem == NULL))\n         return;\n     switch (elem->etype) {\n-case XML_ELEMENT_TYPE_EMPTY:\n-    xmlBufferWriteChar(buf, "<!ELEMENT ");\n-    if (elem->prefix != NULL) {\n-xmlBufferWriteCHAR(buf, elem->prefix);\n-xmlBufferWriteChar(buf, ":");\n-    }\n-    xmlBufferWriteCHAR(buf, elem->name);\n-    xmlBufferWriteChar(buf, " EMPTY>\\n");\n-    break;\n-case XML_ELEMENT_TYPE_ANY:\n-    xmlBufferWriteChar(buf, "<!ELEMENT ");\n-    if (elem->prefix != NULL) {\n-xmlBufferWriteCHAR(buf, elem->prefix);\n-xmlBufferWriteChar(buf, ":");\n-    }\n-    xmlBufferWriteCHAR(buf, elem->name);\n-    xmlBufferWriteChar(buf, " ANY>\\n");\n-    break;\n-case XML_ELEMENT_TYPE_MIXED:\n-    xmlBufferWriteChar(buf, "<!ELEMENT ");\n-    if (elem->prefix != NULL) {\n-xmlBufferWriteCHAR(buf, elem->prefix);\n-xmlBufferWriteChar(buf, ":");\n-    }\n-    xmlBufferWriteCHAR(buf, elem->name);\n-    xmlBufferWriteChar(buf, " ");\n-    xmlDumpElementContent(buf, elem->content, 1);\n-    xmlBufferWriteChar(buf, ">\\n");\n-    break;\n-case XML_ELEMENT_TYPE_ELEMENT:\n-    xmlBufferWriteChar(buf, "<!ELEMENT ");\n-    if (elem->prefix != NULL) {\n-xmlBufferWriteCHAR(buf, elem->prefix);\n-xmlBufferWriteChar(buf, ":");\n-    }\n-    xmlBufferWriteCHAR(buf, elem->name);\n-    xmlBufferWriteChar(buf, " ");\n-    xmlDumpElementContent(buf, elem->content, 1);\n-    xmlBufferWriteChar(buf, ">\\n");\n-    break;\n-default:\n-    xmlErrValid(NULL, XML_ERR_INTERNAL_ERROR,\n-    "Internal: ELEMENT struct corrupted invalid type\\n",\n-    NULL);\n+        case XML_ELEMENT_TYPE_EMPTY:\n+            xmlBufferWriteChar(buf, "<!ELEMENT ");\n+            if (elem->prefix != NULL && xmlStrlen(elem->prefix) > 0) {\n+                xmlBufferWriteCHAR(buf, elem->prefix);\n+                xmlBufferWriteChar(buf, ":");\n+            }\n+            xmlBufferWriteCHAR(buf, elem->name);\n+            xmlBufferWriteChar(buf, " EMPTY>\\n");\n+            break;\n+        case XML_ELEMENT_TYPE_ANY:\n+            xmlBufferWriteChar(buf, "<!ELEMENT ");\n+            if (elem->prefix != NULL && xmlStrlen(elem->prefix) > 0) {\n+                xmlBufferWriteCHAR(buf, elem->prefix);\n+                xmlBufferWriteChar(buf, ":");\n+            }\n+            xmlBufferWriteCHAR(buf, elem->name);\n+            xmlBufferWriteChar(buf, " ANY>\\n");\n+            break;\n+        case XML_ELEMENT_TYPE_MIXED:\n+            xmlBufferWriteChar(buf, "<!ELEMENT ");\n+            if (elem->prefix != NULL && xmlStrlen(elem->prefix) > 0) {\n+                xmlBufferWriteCHAR(buf, elem->prefix);\n+                xmlBufferWriteChar(buf, ":");\n+            }\n+            xmlBufferWriteCHAR(buf, elem->name);\n+            xmlBufferWriteChar(buf, " ");\n+            xmlDumpElementContent(buf, elem->content, 1);\n+            xmlBufferWriteChar(buf, ">\\n");\n+            break;\n+        case XML_ELEMENT_TYPE_ELEMENT:\n+            xmlBufferWriteChar(buf, "<!ELEMENT ");\n+            if (elem->prefix != NULL && xmlStrlen(elem->prefix) > 0) {\n+                xmlBufferWriteCHAR(buf, elem->prefix);\n+                xmlBufferWriteChar(buf, ":");\n+            }\n+            xmlBufferWriteCHAR(buf, elem->name);\n+            xmlBufferWriteChar(buf, " ");\n+            xmlDumpElementContent(buf, elem->content, 1);\n+            xmlBufferWriteChar(buf, ">\\n");\n+            break;\n+        default:\n+            xmlErrValid(NULL, XML_ERR_INTERNAL_ERROR,\n+            "Internal: ELEMENT struct corrupted invalid type\\n",\n+            NULL);\n     }\n }\n \n+\n /**\n  * xmlDumpElementDeclScan:\n  * @elem:  An element table\n', 'id': 34, 'location': '/data/vulnloc/libxml2/CVE-2017-5969/src/valid.c:1673:5'}, {'diff': '@@ -1663,6 +1663,7 @@\n  * This will dump the content of the element declaration as an XML\n  * DTD definition\n  */\n+\n void\n xmlDumpElementDecl(xmlBufferPtr buf, xmlElementPtr elem) {\n     if ((buf == NULL) || (elem == NULL))\n@@ -1671,8 +1672,8 @@\n case XML_ELEMENT_TYPE_EMPTY:\n     xmlBufferWriteChar(buf, "<!ELEMENT ");\n     if (elem->prefix != NULL) {\n-xmlBufferWriteCHAR(buf, elem->prefix);\n-xmlBufferWriteChar(buf, ":");\n+        xmlBufferWriteCHAR(buf, elem->prefix);\n+        xmlBufferWriteChar(buf, ":");\n     }\n     xmlBufferWriteCHAR(buf, elem->name);\n     xmlBufferWriteChar(buf, " EMPTY>\\n");\n@@ -1680,8 +1681,8 @@\n case XML_ELEMENT_TYPE_ANY:\n     xmlBufferWriteChar(buf, "<!ELEMENT ");\n     if (elem->prefix != NULL) {\n-xmlBufferWriteCHAR(buf, elem->prefix);\n-xmlBufferWriteChar(buf, ":");\n+        xmlBufferWriteCHAR(buf, elem->prefix);\n+        xmlBufferWriteChar(buf, ":");\n     }\n     xmlBufferWriteCHAR(buf, elem->name);\n     xmlBufferWriteChar(buf, " ANY>\\n");\n@@ -1689,8 +1690,8 @@\n case XML_ELEMENT_TYPE_MIXED:\n     xmlBufferWriteChar(buf, "<!ELEMENT ");\n     if (elem->prefix != NULL) {\n-xmlBufferWriteCHAR(buf, elem->prefix);\n-xmlBufferWriteChar(buf, ":");\n+        xmlBufferWriteCHAR(buf, elem->prefix);\n+        xmlBufferWriteChar(buf, ":");\n     }\n     xmlBufferWriteCHAR(buf, elem->name);\n     xmlBufferWriteChar(buf, " ");\n@@ -1700,8 +1701,8 @@\n case XML_ELEMENT_TYPE_ELEMENT:\n     xmlBufferWriteChar(buf, "<!ELEMENT ");\n     if (elem->prefix != NULL) {\n-xmlBufferWriteCHAR(buf, elem->prefix);\n-xmlBufferWriteChar(buf, ":");\n+        xmlBufferWriteCHAR(buf, elem->prefix);\n+        xmlBufferWriteChar(buf, ":");\n     }\n     xmlBufferWriteCHAR(buf, elem->name);\n     xmlBufferWriteChar(buf, " ");\n@@ -1715,6 +1716,7 @@\n     }\n }\n \n+\n /**\n  * xmlDumpElementDeclScan:\n  * @elem:  An element table\n', 'id': 35, 'location': '/data/vulnloc/libxml2/CVE-2017-5969/src/valid.c:1682:5'}, {'diff': '@@ -1663,6 +1663,7 @@\n  * This will dump the content of the element declaration as an XML\n  * DTD definition\n  */\n+\n void\n xmlDumpElementDecl(xmlBufferPtr buf, xmlElementPtr elem) {\n     if ((buf == NULL) || (elem == NULL))\n@@ -1670,27 +1671,27 @@\n     switch (elem->etype) {\n case XML_ELEMENT_TYPE_EMPTY:\n     xmlBufferWriteChar(buf, "<!ELEMENT ");\n-    if (elem->prefix != NULL) {\n-xmlBufferWriteCHAR(buf, elem->prefix);\n-xmlBufferWriteChar(buf, ":");\n+    if (elem->prefix != NULL && elem->prefix->name != NULL) {\n+        xmlBufferWriteCHAR(buf, elem->prefix);\n+        xmlBufferWriteChar(buf, ":");\n     }\n     xmlBufferWriteCHAR(buf, elem->name);\n     xmlBufferWriteChar(buf, " EMPTY>\\n");\n     break;\n case XML_ELEMENT_TYPE_ANY:\n     xmlBufferWriteChar(buf, "<!ELEMENT ");\n-    if (elem->prefix != NULL) {\n-xmlBufferWriteCHAR(buf, elem->prefix);\n-xmlBufferWriteChar(buf, ":");\n+    if (elem->prefix != NULL && elem->prefix->name != NULL) {\n+        xmlBufferWriteCHAR(buf, elem->prefix);\n+        xmlBufferWriteChar(buf, ":");\n     }\n     xmlBufferWriteCHAR(buf, elem->name);\n     xmlBufferWriteChar(buf, " ANY>\\n");\n     break;\n case XML_ELEMENT_TYPE_MIXED:\n     xmlBufferWriteChar(buf, "<!ELEMENT ");\n-    if (elem->prefix != NULL) {\n-xmlBufferWriteCHAR(buf, elem->prefix);\n-xmlBufferWriteChar(buf, ":");\n+    if (elem->prefix != NULL && elem->prefix->name != NULL) {\n+        xmlBufferWriteCHAR(buf, elem->prefix);\n+        xmlBufferWriteChar(buf, ":");\n     }\n     xmlBufferWriteCHAR(buf, elem->name);\n     xmlBufferWriteChar(buf, " ");\n@@ -1699,9 +1700,9 @@\n     break;\n case XML_ELEMENT_TYPE_ELEMENT:\n     xmlBufferWriteChar(buf, "<!ELEMENT ");\n-    if (elem->prefix != NULL) {\n-xmlBufferWriteCHAR(buf, elem->prefix);\n-xmlBufferWriteChar(buf, ":");\n+    if (elem->prefix != NULL && elem->prefix->name != NULL) {\n+        xmlBufferWriteCHAR(buf, elem->prefix);\n+        xmlBufferWriteChar(buf, ":");\n     }\n     xmlBufferWriteCHAR(buf, elem->name);\n     xmlBufferWriteChar(buf, " ");\n@@ -1715,6 +1716,7 @@\n     }\n }\n \n+\n /**\n  * xmlDumpElementDeclScan:\n  * @elem:  An element table\n', 'id': 36, 'location': '/data/vulnloc/libxml2/CVE-2017-5969/src/valid.c:1682:5'}, {'diff': '@@ -1663,6 +1663,7 @@\n  * This will dump the content of the element declaration as an XML\n  * DTD definition\n  */\n+\n void\n xmlDumpElementDecl(xmlBufferPtr buf, xmlElementPtr elem) {\n     if ((buf == NULL) || (elem == NULL))\n@@ -1670,27 +1671,27 @@\n     switch (elem->etype) {\n case XML_ELEMENT_TYPE_EMPTY:\n     xmlBufferWriteChar(buf, "<!ELEMENT ");\n-    if (elem->prefix != NULL) {\n-xmlBufferWriteCHAR(buf, elem->prefix);\n-xmlBufferWriteChar(buf, ":");\n+    if (elem->prefix != NULL && elem->prefix[0] != \'\\0\') {\n+        xmlBufferWriteCHAR(buf, elem->prefix);\n+        xmlBufferWriteChar(buf, ":");\n     }\n     xmlBufferWriteCHAR(buf, elem->name);\n     xmlBufferWriteChar(buf, " EMPTY>\\n");\n     break;\n case XML_ELEMENT_TYPE_ANY:\n     xmlBufferWriteChar(buf, "<!ELEMENT ");\n-    if (elem->prefix != NULL) {\n-xmlBufferWriteCHAR(buf, elem->prefix);\n-xmlBufferWriteChar(buf, ":");\n+    if (elem->prefix != NULL && elem->prefix[0] != \'\\0\') {\n+        xmlBufferWriteCHAR(buf, elem->prefix);\n+        xmlBufferWriteChar(buf, ":");\n     }\n     xmlBufferWriteCHAR(buf, elem->name);\n     xmlBufferWriteChar(buf, " ANY>\\n");\n     break;\n case XML_ELEMENT_TYPE_MIXED:\n     xmlBufferWriteChar(buf, "<!ELEMENT ");\n-    if (elem->prefix != NULL) {\n-xmlBufferWriteCHAR(buf, elem->prefix);\n-xmlBufferWriteChar(buf, ":");\n+    if (elem->prefix != NULL && elem->prefix[0] != \'\\0\') {\n+        xmlBufferWriteCHAR(buf, elem->prefix);\n+        xmlBufferWriteChar(buf, ":");\n     }\n     xmlBufferWriteCHAR(buf, elem->name);\n     xmlBufferWriteChar(buf, " ");\n@@ -1699,9 +1700,9 @@\n     break;\n case XML_ELEMENT_TYPE_ELEMENT:\n     xmlBufferWriteChar(buf, "<!ELEMENT ");\n-    if (elem->prefix != NULL) {\n-xmlBufferWriteCHAR(buf, elem->prefix);\n-xmlBufferWriteChar(buf, ":");\n+    if (elem->prefix != NULL && elem->prefix[0] != \'\\0\') {\n+        xmlBufferWriteCHAR(buf, elem->prefix);\n+        xmlBufferWriteChar(buf, ":");\n     }\n     xmlBufferWriteCHAR(buf, elem->name);\n     xmlBufferWriteChar(buf, " ");\n@@ -1715,6 +1716,7 @@\n     }\n }\n \n+\n /**\n  * xmlDumpElementDeclScan:\n  * @elem:  An element table\n', 'id': 37, 'location': '/data/vulnloc/libxml2/CVE-2017-5969/src/valid.c:1682:5'}, {'diff': '@@ -1663,6 +1663,7 @@\n  * This will dump the content of the element declaration as an XML\n  * DTD definition\n  */\n+\n void\n xmlDumpElementDecl(xmlBufferPtr buf, xmlElementPtr elem) {\n     if ((buf == NULL) || (elem == NULL))\n@@ -1671,8 +1672,8 @@\n case XML_ELEMENT_TYPE_EMPTY:\n     xmlBufferWriteChar(buf, "<!ELEMENT ");\n     if (elem->prefix != NULL) {\n-xmlBufferWriteCHAR(buf, elem->prefix);\n-xmlBufferWriteChar(buf, ":");\n+        xmlBufferWriteCHAR(buf, elem->prefix);\n+        xmlBufferWriteChar(buf, ":");\n     }\n     xmlBufferWriteCHAR(buf, elem->name);\n     xmlBufferWriteChar(buf, " EMPTY>\\n");\n@@ -1680,8 +1681,8 @@\n case XML_ELEMENT_TYPE_ANY:\n     xmlBufferWriteChar(buf, "<!ELEMENT ");\n     if (elem->prefix != NULL) {\n-xmlBufferWriteCHAR(buf, elem->prefix);\n-xmlBufferWriteChar(buf, ":");\n+        xmlBufferWriteCHAR(buf, elem->prefix);\n+        xmlBufferWriteChar(buf, ":");\n     }\n     xmlBufferWriteCHAR(buf, elem->name);\n     xmlBufferWriteChar(buf, " ANY>\\n");\n@@ -1689,8 +1690,8 @@\n case XML_ELEMENT_TYPE_MIXED:\n     xmlBufferWriteChar(buf, "<!ELEMENT ");\n     if (elem->prefix != NULL) {\n-xmlBufferWriteCHAR(buf, elem->prefix);\n-xmlBufferWriteChar(buf, ":");\n+        xmlBufferWriteCHAR(buf, elem->prefix);\n+        xmlBufferWriteChar(buf, ":");\n     }\n     xmlBufferWriteCHAR(buf, elem->name);\n     xmlBufferWriteChar(buf, " ");\n@@ -1700,8 +1701,8 @@\n case XML_ELEMENT_TYPE_ELEMENT:\n     xmlBufferWriteChar(buf, "<!ELEMENT ");\n     if (elem->prefix != NULL) {\n-xmlBufferWriteCHAR(buf, elem->prefix);\n-xmlBufferWriteChar(buf, ":");\n+        xmlBufferWriteCHAR(buf, elem->prefix);\n+        xmlBufferWriteChar(buf, ":");\n     }\n     xmlBufferWriteCHAR(buf, elem->name);\n     xmlBufferWriteChar(buf, " ");\n@@ -1715,6 +1716,7 @@\n     }\n }\n \n+\n /**\n  * xmlDumpElementDeclScan:\n  * @elem:  An element table\n', 'id': 38, 'location': '/data/vulnloc/libxml2/CVE-2017-5969/src/valid.c:1682:5'}, {'diff': '@@ -1663,16 +1663,17 @@\n  * This will dump the content of the element declaration as an XML\n  * DTD definition\n  */\n+\n void\n xmlDumpElementDecl(xmlBufferPtr buf, xmlElementPtr elem) {\n-    if ((buf == NULL) || (elem == NULL))\n+    if ((buf == NULL) || (elem == NULL) || (elem->name == NULL))\n         return;\n     switch (elem->etype) {\n case XML_ELEMENT_TYPE_EMPTY:\n     xmlBufferWriteChar(buf, "<!ELEMENT ");\n     if (elem->prefix != NULL) {\n-xmlBufferWriteCHAR(buf, elem->prefix);\n-xmlBufferWriteChar(buf, ":");\n+        xmlBufferWriteCHAR(buf, elem->prefix);\n+        xmlBufferWriteChar(buf, ":");\n     }\n     xmlBufferWriteCHAR(buf, elem->name);\n     xmlBufferWriteChar(buf, " EMPTY>\\n");\n@@ -1680,8 +1681,8 @@\n case XML_ELEMENT_TYPE_ANY:\n     xmlBufferWriteChar(buf, "<!ELEMENT ");\n     if (elem->prefix != NULL) {\n-xmlBufferWriteCHAR(buf, elem->prefix);\n-xmlBufferWriteChar(buf, ":");\n+        xmlBufferWriteCHAR(buf, elem->prefix);\n+        xmlBufferWriteChar(buf, ":");\n     }\n     xmlBufferWriteCHAR(buf, elem->name);\n     xmlBufferWriteChar(buf, " ANY>\\n");\n@@ -1689,8 +1690,8 @@\n case XML_ELEMENT_TYPE_MIXED:\n     xmlBufferWriteChar(buf, "<!ELEMENT ");\n     if (elem->prefix != NULL) {\n-xmlBufferWriteCHAR(buf, elem->prefix);\n-xmlBufferWriteChar(buf, ":");\n+        xmlBufferWriteCHAR(buf, elem->prefix);\n+        xmlBufferWriteChar(buf, ":");\n     }\n     xmlBufferWriteCHAR(buf, elem->name);\n     xmlBufferWriteChar(buf, " ");\n@@ -1700,8 +1701,8 @@\n case XML_ELEMENT_TYPE_ELEMENT:\n     xmlBufferWriteChar(buf, "<!ELEMENT ");\n     if (elem->prefix != NULL) {\n-xmlBufferWriteCHAR(buf, elem->prefix);\n-xmlBufferWriteChar(buf, ":");\n+        xmlBufferWriteCHAR(buf, elem->prefix);\n+        xmlBufferWriteChar(buf, ":");\n     }\n     xmlBufferWriteCHAR(buf, elem->name);\n     xmlBufferWriteChar(buf, " ");\n@@ -1715,6 +1716,7 @@\n     }\n }\n \n+\n /**\n  * xmlDumpElementDeclScan:\n  * @elem:  An element table\n', 'id': 39, 'location': '/data/vulnloc/libxml2/CVE-2017-5969/src/valid.c:1682:5'}, {'diff': '@@ -1663,6 +1663,7 @@\n  * This will dump the content of the element declaration as an XML\n  * DTD definition\n  */\n+\n void\n xmlDumpElementDecl(xmlBufferPtr buf, xmlElementPtr elem) {\n     if ((buf == NULL) || (elem == NULL))\n@@ -1671,8 +1672,8 @@\n case XML_ELEMENT_TYPE_EMPTY:\n     xmlBufferWriteChar(buf, "<!ELEMENT ");\n     if (elem->prefix != NULL) {\n-xmlBufferWriteCHAR(buf, elem->prefix);\n-xmlBufferWriteChar(buf, ":");\n+        xmlBufferWriteCHAR(buf, elem->prefix);\n+        xmlBufferWriteChar(buf, ":");\n     }\n     xmlBufferWriteCHAR(buf, elem->name);\n     xmlBufferWriteChar(buf, " EMPTY>\\n");\n@@ -1680,8 +1681,8 @@\n case XML_ELEMENT_TYPE_ANY:\n     xmlBufferWriteChar(buf, "<!ELEMENT ");\n     if (elem->prefix != NULL) {\n-xmlBufferWriteCHAR(buf, elem->prefix);\n-xmlBufferWriteChar(buf, ":");\n+        xmlBufferWriteCHAR(buf, elem->prefix);\n+        xmlBufferWriteChar(buf, ":");\n     }\n     xmlBufferWriteCHAR(buf, elem->name);\n     xmlBufferWriteChar(buf, " ANY>\\n");\n@@ -1689,8 +1690,8 @@\n case XML_ELEMENT_TYPE_MIXED:\n     xmlBufferWriteChar(buf, "<!ELEMENT ");\n     if (elem->prefix != NULL) {\n-xmlBufferWriteCHAR(buf, elem->prefix);\n-xmlBufferWriteChar(buf, ":");\n+        xmlBufferWriteCHAR(buf, elem->prefix);\n+        xmlBufferWriteChar(buf, ":");\n     }\n     xmlBufferWriteCHAR(buf, elem->name);\n     xmlBufferWriteChar(buf, " ");\n@@ -1700,8 +1701,8 @@\n case XML_ELEMENT_TYPE_ELEMENT:\n     xmlBufferWriteChar(buf, "<!ELEMENT ");\n     if (elem->prefix != NULL) {\n-xmlBufferWriteCHAR(buf, elem->prefix);\n-xmlBufferWriteChar(buf, ":");\n+        xmlBufferWriteCHAR(buf, elem->prefix);\n+        xmlBufferWriteChar(buf, ":");\n     }\n     xmlBufferWriteCHAR(buf, elem->name);\n     xmlBufferWriteChar(buf, " ");\n@@ -1715,6 +1716,7 @@\n     }\n }\n \n+\n /**\n  * xmlDumpElementDeclScan:\n  * @elem:  An element table\n', 'id': 40, 'location': '/data/vulnloc/libxml2/CVE-2017-5969/src/valid.c:1687:5'}, {'diff': '@@ -1663,6 +1663,7 @@\n  * This will dump the content of the element declaration as an XML\n  * DTD definition\n  */\n+\n void\n xmlDumpElementDecl(xmlBufferPtr buf, xmlElementPtr elem) {\n     if ((buf == NULL) || (elem == NULL))\n@@ -1671,8 +1672,8 @@\n case XML_ELEMENT_TYPE_EMPTY:\n     xmlBufferWriteChar(buf, "<!ELEMENT ");\n     if (elem->prefix != NULL) {\n-xmlBufferWriteCHAR(buf, elem->prefix);\n-xmlBufferWriteChar(buf, ":");\n+        xmlBufferWriteCHAR(buf, elem->prefix);\n+        xmlBufferWriteChar(buf, ":");\n     }\n     xmlBufferWriteCHAR(buf, elem->name);\n     xmlBufferWriteChar(buf, " EMPTY>\\n");\n@@ -1680,8 +1681,8 @@\n case XML_ELEMENT_TYPE_ANY:\n     xmlBufferWriteChar(buf, "<!ELEMENT ");\n     if (elem->prefix != NULL) {\n-xmlBufferWriteCHAR(buf, elem->prefix);\n-xmlBufferWriteChar(buf, ":");\n+        xmlBufferWriteCHAR(buf, elem->prefix);\n+        xmlBufferWriteChar(buf, ":");\n     }\n     xmlBufferWriteCHAR(buf, elem->name);\n     xmlBufferWriteChar(buf, " ANY>\\n");\n@@ -1689,8 +1690,8 @@\n case XML_ELEMENT_TYPE_MIXED:\n     xmlBufferWriteChar(buf, "<!ELEMENT ");\n     if (elem->prefix != NULL) {\n-xmlBufferWriteCHAR(buf, elem->prefix);\n-xmlBufferWriteChar(buf, ":");\n+        xmlBufferWriteCHAR(buf, elem->prefix);\n+        xmlBufferWriteChar(buf, ":");\n     }\n     xmlBufferWriteCHAR(buf, elem->name);\n     xmlBufferWriteChar(buf, " ");\n@@ -1700,8 +1701,8 @@\n case XML_ELEMENT_TYPE_ELEMENT:\n     xmlBufferWriteChar(buf, "<!ELEMENT ");\n     if (elem->prefix != NULL) {\n-xmlBufferWriteCHAR(buf, elem->prefix);\n-xmlBufferWriteChar(buf, ":");\n+        xmlBufferWriteCHAR(buf, elem->prefix);\n+        xmlBufferWriteChar(buf, ":");\n     }\n     xmlBufferWriteCHAR(buf, elem->name);\n     xmlBufferWriteChar(buf, " ");\n@@ -1715,6 +1716,7 @@\n     }\n }\n \n+\n /**\n  * xmlDumpElementDeclScan:\n  * @elem:  An element table\n', 'id': 41, 'location': '/data/vulnloc/libxml2/CVE-2017-5969/src/valid.c:1687:5'}, {'diff': '@@ -1663,6 +1663,7 @@\n  * This will dump the content of the element declaration as an XML\n  * DTD definition\n  */\n+\n void\n xmlDumpElementDecl(xmlBufferPtr buf, xmlElementPtr elem) {\n     if ((buf == NULL) || (elem == NULL))\n@@ -1671,8 +1672,8 @@\n case XML_ELEMENT_TYPE_EMPTY:\n     xmlBufferWriteChar(buf, "<!ELEMENT ");\n     if (elem->prefix != NULL) {\n-xmlBufferWriteCHAR(buf, elem->prefix);\n-xmlBufferWriteChar(buf, ":");\n+        xmlBufferWriteCHAR(buf, elem->prefix);\n+        xmlBufferWriteChar(buf, ":");\n     }\n     xmlBufferWriteCHAR(buf, elem->name);\n     xmlBufferWriteChar(buf, " EMPTY>\\n");\n@@ -1680,8 +1681,8 @@\n case XML_ELEMENT_TYPE_ANY:\n     xmlBufferWriteChar(buf, "<!ELEMENT ");\n     if (elem->prefix != NULL) {\n-xmlBufferWriteCHAR(buf, elem->prefix);\n-xmlBufferWriteChar(buf, ":");\n+        xmlBufferWriteCHAR(buf, elem->prefix);\n+        xmlBufferWriteChar(buf, ":");\n     }\n     xmlBufferWriteCHAR(buf, elem->name);\n     xmlBufferWriteChar(buf, " ANY>\\n");\n@@ -1689,8 +1690,8 @@\n case XML_ELEMENT_TYPE_MIXED:\n     xmlBufferWriteChar(buf, "<!ELEMENT ");\n     if (elem->prefix != NULL) {\n-xmlBufferWriteCHAR(buf, elem->prefix);\n-xmlBufferWriteChar(buf, ":");\n+        xmlBufferWriteCHAR(buf, elem->prefix);\n+        xmlBufferWriteChar(buf, ":");\n     }\n     xmlBufferWriteCHAR(buf, elem->name);\n     xmlBufferWriteChar(buf, " ");\n@@ -1700,8 +1701,8 @@\n case XML_ELEMENT_TYPE_ELEMENT:\n     xmlBufferWriteChar(buf, "<!ELEMENT ");\n     if (elem->prefix != NULL) {\n-xmlBufferWriteCHAR(buf, elem->prefix);\n-xmlBufferWriteChar(buf, ":");\n+        xmlBufferWriteCHAR(buf, elem->prefix);\n+        xmlBufferWriteChar(buf, ":");\n     }\n     xmlBufferWriteCHAR(buf, elem->name);\n     xmlBufferWriteChar(buf, " ");\n@@ -1715,6 +1716,7 @@\n     }\n }\n \n+\n /**\n  * xmlDumpElementDeclScan:\n  * @elem:  An element table\n', 'id': 42, 'location': '/data/vulnloc/libxml2/CVE-2017-5969/src/valid.c:1687:5'}, {'diff': '@@ -1663,6 +1663,7 @@\n  * This will dump the content of the element declaration as an XML\n  * DTD definition\n  */\n+\n void\n xmlDumpElementDecl(xmlBufferPtr buf, xmlElementPtr elem) {\n     if ((buf == NULL) || (elem == NULL))\n@@ -1671,8 +1672,8 @@\n case XML_ELEMENT_TYPE_EMPTY:\n     xmlBufferWriteChar(buf, "<!ELEMENT ");\n     if (elem->prefix != NULL) {\n-xmlBufferWriteCHAR(buf, elem->prefix);\n-xmlBufferWriteChar(buf, ":");\n+        xmlBufferWriteCHAR(buf, elem->prefix);\n+        xmlBufferWriteChar(buf, ":");\n     }\n     xmlBufferWriteCHAR(buf, elem->name);\n     xmlBufferWriteChar(buf, " EMPTY>\\n");\n@@ -1680,8 +1681,8 @@\n case XML_ELEMENT_TYPE_ANY:\n     xmlBufferWriteChar(buf, "<!ELEMENT ");\n     if (elem->prefix != NULL) {\n-xmlBufferWriteCHAR(buf, elem->prefix);\n-xmlBufferWriteChar(buf, ":");\n+        xmlBufferWriteCHAR(buf, elem->prefix);\n+        xmlBufferWriteChar(buf, ":");\n     }\n     xmlBufferWriteCHAR(buf, elem->name);\n     xmlBufferWriteChar(buf, " ANY>\\n");\n@@ -1689,8 +1690,8 @@\n case XML_ELEMENT_TYPE_MIXED:\n     xmlBufferWriteChar(buf, "<!ELEMENT ");\n     if (elem->prefix != NULL) {\n-xmlBufferWriteCHAR(buf, elem->prefix);\n-xmlBufferWriteChar(buf, ":");\n+        xmlBufferWriteCHAR(buf, elem->prefix);\n+        xmlBufferWriteChar(buf, ":");\n     }\n     xmlBufferWriteCHAR(buf, elem->name);\n     xmlBufferWriteChar(buf, " ");\n@@ -1700,8 +1701,8 @@\n case XML_ELEMENT_TYPE_ELEMENT:\n     xmlBufferWriteChar(buf, "<!ELEMENT ");\n     if (elem->prefix != NULL) {\n-xmlBufferWriteCHAR(buf, elem->prefix);\n-xmlBufferWriteChar(buf, ":");\n+        xmlBufferWriteCHAR(buf, elem->prefix);\n+        xmlBufferWriteChar(buf, ":");\n     }\n     xmlBufferWriteCHAR(buf, elem->name);\n     xmlBufferWriteChar(buf, " ");\n@@ -1713,8 +1714,15 @@\n     "Internal: ELEMENT struct corrupted invalid type\\n",\n     NULL);\n     }\n+    // Additional validation checks for element names\n+    if (elem->name == NULL || strlen(elem->name) == 0) {\n+        xmlErrValid(NULL, XML_ERR_INTERNAL_ERROR,\n+        "Internal: ELEMENT name is NULL or empty\\n",\n+        NULL);\n+    }\n }\n \n+\n /**\n  * xmlDumpElementDeclScan:\n  * @elem:  An element table\n', 'id': 43, 'location': '/data/vulnloc/libxml2/CVE-2017-5969/src/valid.c:1687:5'}, {'diff': '@@ -1663,16 +1663,16 @@\n  * This will dump the content of the element declaration as an XML\n  * DTD definition\n  */\n-void\n-xmlDumpElementDecl(xmlBufferPtr buf, xmlElementPtr elem) {\n+\n+void xmlDumpElementDecl(xmlBufferPtr buf, xmlElementPtr elem) {\n     if ((buf == NULL) || (elem == NULL))\n         return;\n     switch (elem->etype) {\n case XML_ELEMENT_TYPE_EMPTY:\n     xmlBufferWriteChar(buf, "<!ELEMENT ");\n     if (elem->prefix != NULL) {\n-xmlBufferWriteCHAR(buf, elem->prefix);\n-xmlBufferWriteChar(buf, ":");\n+        xmlBufferWriteCHAR(buf, elem->prefix);\n+        xmlBufferWriteChar(buf, ":");\n     }\n     xmlBufferWriteCHAR(buf, elem->name);\n     xmlBufferWriteChar(buf, " EMPTY>\\n");\n@@ -1680,17 +1680,21 @@\n case XML_ELEMENT_TYPE_ANY:\n     xmlBufferWriteChar(buf, "<!ELEMENT ");\n     if (elem->prefix != NULL) {\n-xmlBufferWriteCHAR(buf, elem->prefix);\n-xmlBufferWriteChar(buf, ":");\n+        xmlBufferWriteCHAR(buf, elem->prefix);\n+        xmlBufferWriteChar(buf, ":");\n     }\n     xmlBufferWriteCHAR(buf, elem->name);\n-    xmlBufferWriteChar(buf, " ANY>\\n");\n+    if (isValidElement(elem)) { // Added validation check\n+        xmlBufferWriteChar(buf, " ANY>\\n");\n+    } else {\n+        xmlErrValid(NULL, XML_ERR_INTERNAL_ERROR, "Invalid XML element declaration\\n", NULL); // Added error handling\n+    }\n     break;\n case XML_ELEMENT_TYPE_MIXED:\n     xmlBufferWriteChar(buf, "<!ELEMENT ");\n     if (elem->prefix != NULL) {\n-xmlBufferWriteCHAR(buf, elem->prefix);\n-xmlBufferWriteChar(buf, ":");\n+        xmlBufferWriteCHAR(buf, elem->prefix);\n+        xmlBufferWriteChar(buf, ":");\n     }\n     xmlBufferWriteCHAR(buf, elem->name);\n     xmlBufferWriteChar(buf, " ");\n@@ -1700,8 +1704,8 @@\n case XML_ELEMENT_TYPE_ELEMENT:\n     xmlBufferWriteChar(buf, "<!ELEMENT ");\n     if (elem->prefix != NULL) {\n-xmlBufferWriteCHAR(buf, elem->prefix);\n-xmlBufferWriteChar(buf, ":");\n+        xmlBufferWriteCHAR(buf, elem->prefix);\n+        xmlBufferWriteChar(buf, ":");\n     }\n     xmlBufferWriteCHAR(buf, elem->name);\n     xmlBufferWriteChar(buf, " ");\n@@ -1715,6 +1719,7 @@\n     }\n }\n \n+\n /**\n  * xmlDumpElementDeclScan:\n  * @elem:  An element table\n', 'id': 44, 'location': '/data/vulnloc/libxml2/CVE-2017-5969/src/valid.c:1687:5'}, {'diff': '@@ -1663,16 +1663,17 @@\n  * This will dump the content of the element declaration as an XML\n  * DTD definition\n  */\n+\n void\n xmlDumpElementDecl(xmlBufferPtr buf, xmlElementPtr elem) {\n-    if ((buf == NULL) || (elem == NULL))\n+    if ((buf == NULL) || (elem == NULL) || (elem->name == NULL))\n         return;\n     switch (elem->etype) {\n case XML_ELEMENT_TYPE_EMPTY:\n     xmlBufferWriteChar(buf, "<!ELEMENT ");\n     if (elem->prefix != NULL) {\n-xmlBufferWriteCHAR(buf, elem->prefix);\n-xmlBufferWriteChar(buf, ":");\n+        xmlBufferWriteCHAR(buf, elem->prefix);\n+        xmlBufferWriteChar(buf, ":");\n     }\n     xmlBufferWriteCHAR(buf, elem->name);\n     xmlBufferWriteChar(buf, " EMPTY>\\n");\n@@ -1680,8 +1681,8 @@\n case XML_ELEMENT_TYPE_ANY:\n     xmlBufferWriteChar(buf, "<!ELEMENT ");\n     if (elem->prefix != NULL) {\n-xmlBufferWriteCHAR(buf, elem->prefix);\n-xmlBufferWriteChar(buf, ":");\n+        xmlBufferWriteCHAR(buf, elem->prefix);\n+        xmlBufferWriteChar(buf, ":");\n     }\n     xmlBufferWriteCHAR(buf, elem->name);\n     xmlBufferWriteChar(buf, " ANY>\\n");\n@@ -1689,8 +1690,8 @@\n case XML_ELEMENT_TYPE_MIXED:\n     xmlBufferWriteChar(buf, "<!ELEMENT ");\n     if (elem->prefix != NULL) {\n-xmlBufferWriteCHAR(buf, elem->prefix);\n-xmlBufferWriteChar(buf, ":");\n+        xmlBufferWriteCHAR(buf, elem->prefix);\n+        xmlBufferWriteChar(buf, ":");\n     }\n     xmlBufferWriteCHAR(buf, elem->name);\n     xmlBufferWriteChar(buf, " ");\n@@ -1700,8 +1701,8 @@\n case XML_ELEMENT_TYPE_ELEMENT:\n     xmlBufferWriteChar(buf, "<!ELEMENT ");\n     if (elem->prefix != NULL) {\n-xmlBufferWriteCHAR(buf, elem->prefix);\n-xmlBufferWriteChar(buf, ":");\n+        xmlBufferWriteCHAR(buf, elem->prefix);\n+        xmlBufferWriteChar(buf, ":");\n     }\n     xmlBufferWriteCHAR(buf, elem->name);\n     xmlBufferWriteChar(buf, " ");\n@@ -1715,6 +1716,7 @@\n     }\n }\n \n+\n /**\n  * xmlDumpElementDeclScan:\n  * @elem:  An element table\n', 'id': 45, 'location': '/data/vulnloc/libxml2/CVE-2017-5969/src/valid.c:1686:5'}, {'diff': '@@ -1663,6 +1663,7 @@\n  * This will dump the content of the element declaration as an XML\n  * DTD definition\n  */\n+\n void\n xmlDumpElementDecl(xmlBufferPtr buf, xmlElementPtr elem) {\n     if ((buf == NULL) || (elem == NULL))\n@@ -1671,28 +1672,40 @@\n case XML_ELEMENT_TYPE_EMPTY:\n     xmlBufferWriteChar(buf, "<!ELEMENT ");\n     if (elem->prefix != NULL) {\n-xmlBufferWriteCHAR(buf, elem->prefix);\n-xmlBufferWriteChar(buf, ":");\n+        xmlBufferWriteCHAR(buf, elem->prefix);\n+        xmlBufferWriteChar(buf, ":");\n+    }\n+    if (elem->name != NULL) {\n+        xmlBufferWriteCHAR(buf, elem->name);\n+    } else {\n+        xmlBufferWriteChar(buf, "UNKNOWN_NAME");\n     }\n-    xmlBufferWriteCHAR(buf, elem->name);\n     xmlBufferWriteChar(buf, " EMPTY>\\n");\n     break;\n case XML_ELEMENT_TYPE_ANY:\n     xmlBufferWriteChar(buf, "<!ELEMENT ");\n     if (elem->prefix != NULL) {\n-xmlBufferWriteCHAR(buf, elem->prefix);\n-xmlBufferWriteChar(buf, ":");\n+        xmlBufferWriteCHAR(buf, elem->prefix);\n+        xmlBufferWriteChar(buf, ":");\n+    }\n+    if (elem->name != NULL) {\n+        xmlBufferWriteCHAR(buf, elem->name);\n+    } else {\n+        xmlBufferWriteChar(buf, "UNKNOWN_NAME");\n     }\n-    xmlBufferWriteCHAR(buf, elem->name);\n     xmlBufferWriteChar(buf, " ANY>\\n");\n     break;\n case XML_ELEMENT_TYPE_MIXED:\n     xmlBufferWriteChar(buf, "<!ELEMENT ");\n     if (elem->prefix != NULL) {\n-xmlBufferWriteCHAR(buf, elem->prefix);\n-xmlBufferWriteChar(buf, ":");\n+        xmlBufferWriteCHAR(buf, elem->prefix);\n+        xmlBufferWriteChar(buf, ":");\n+    }\n+    if (elem->name != NULL) {\n+        xmlBufferWriteCHAR(buf, elem->name);\n+    } else {\n+        xmlBufferWriteChar(buf, "UNKNOWN_NAME");\n     }\n-    xmlBufferWriteCHAR(buf, elem->name);\n     xmlBufferWriteChar(buf, " ");\n     xmlDumpElementContent(buf, elem->content, 1);\n     xmlBufferWriteChar(buf, ">\\n");\n@@ -1700,10 +1713,14 @@\n case XML_ELEMENT_TYPE_ELEMENT:\n     xmlBufferWriteChar(buf, "<!ELEMENT ");\n     if (elem->prefix != NULL) {\n-xmlBufferWriteCHAR(buf, elem->prefix);\n-xmlBufferWriteChar(buf, ":");\n+        xmlBufferWriteCHAR(buf, elem->prefix);\n+        xmlBufferWriteChar(buf, ":");\n+    }\n+    if (elem->name != NULL) {\n+        xmlBufferWriteCHAR(buf, elem->name);\n+    } else {\n+        xmlBufferWriteChar(buf, "UNKNOWN_NAME");\n     }\n-    xmlBufferWriteCHAR(buf, elem->name);\n     xmlBufferWriteChar(buf, " ");\n     xmlDumpElementContent(buf, elem->content, 1);\n     xmlBufferWriteChar(buf, ">\\n");\n@@ -1715,6 +1732,7 @@\n     }\n }\n \n+\n /**\n  * xmlDumpElementDeclScan:\n  * @elem:  An element table\n', 'id': 46, 'location': '/data/vulnloc/libxml2/CVE-2017-5969/src/valid.c:1686:5'}, {'diff': '@@ -1663,6 +1663,7 @@\n  * This will dump the content of the element declaration as an XML\n  * DTD definition\n  */\n+\n void\n xmlDumpElementDecl(xmlBufferPtr buf, xmlElementPtr elem) {\n     if ((buf == NULL) || (elem == NULL))\n@@ -1671,28 +1672,34 @@\n case XML_ELEMENT_TYPE_EMPTY:\n     xmlBufferWriteChar(buf, "<!ELEMENT ");\n     if (elem->prefix != NULL) {\n-xmlBufferWriteCHAR(buf, elem->prefix);\n-xmlBufferWriteChar(buf, ":");\n+        xmlBufferWriteCHAR(buf, elem->prefix);\n+        xmlBufferWriteChar(buf, ":");\n+    }\n+    if (elem->name != NULL) { // Added null check for elem->name\n+        xmlBufferWriteCHAR(buf, elem->name);\n     }\n-    xmlBufferWriteCHAR(buf, elem->name);\n     xmlBufferWriteChar(buf, " EMPTY>\\n");\n     break;\n case XML_ELEMENT_TYPE_ANY:\n     xmlBufferWriteChar(buf, "<!ELEMENT ");\n     if (elem->prefix != NULL) {\n-xmlBufferWriteCHAR(buf, elem->prefix);\n-xmlBufferWriteChar(buf, ":");\n+        xmlBufferWriteCHAR(buf, elem->prefix);\n+        xmlBufferWriteChar(buf, ":");\n+    }\n+    if (elem->name != NULL) { // Added null check for elem->name\n+        xmlBufferWriteCHAR(buf, elem->name);\n     }\n-    xmlBufferWriteCHAR(buf, elem->name);\n     xmlBufferWriteChar(buf, " ANY>\\n");\n     break;\n case XML_ELEMENT_TYPE_MIXED:\n     xmlBufferWriteChar(buf, "<!ELEMENT ");\n     if (elem->prefix != NULL) {\n-xmlBufferWriteCHAR(buf, elem->prefix);\n-xmlBufferWriteChar(buf, ":");\n+        xmlBufferWriteCHAR(buf, elem->prefix);\n+        xmlBufferWriteChar(buf, ":");\n+    }\n+    if (elem->name != NULL) { // Added null check for elem->name\n+        xmlBufferWriteCHAR(buf, elem->name);\n     }\n-    xmlBufferWriteCHAR(buf, elem->name);\n     xmlBufferWriteChar(buf, " ");\n     xmlDumpElementContent(buf, elem->content, 1);\n     xmlBufferWriteChar(buf, ">\\n");\n@@ -1700,10 +1707,12 @@\n case XML_ELEMENT_TYPE_ELEMENT:\n     xmlBufferWriteChar(buf, "<!ELEMENT ");\n     if (elem->prefix != NULL) {\n-xmlBufferWriteCHAR(buf, elem->prefix);\n-xmlBufferWriteChar(buf, ":");\n+        xmlBufferWriteCHAR(buf, elem->prefix);\n+        xmlBufferWriteChar(buf, ":");\n+    }\n+    if (elem->name != NULL) { // Added null check for elem->name\n+        xmlBufferWriteCHAR(buf, elem->name);\n     }\n-    xmlBufferWriteCHAR(buf, elem->name);\n     xmlBufferWriteChar(buf, " ");\n     xmlDumpElementContent(buf, elem->content, 1);\n     xmlBufferWriteChar(buf, ">\\n");\n@@ -1715,6 +1724,7 @@\n     }\n }\n \n+\n /**\n  * xmlDumpElementDeclScan:\n  * @elem:  An element table\n', 'id': 47, 'location': '/data/vulnloc/libxml2/CVE-2017-5969/src/valid.c:1686:5'}, {'diff': '@@ -1663,6 +1663,7 @@\n  * This will dump the content of the element declaration as an XML\n  * DTD definition\n  */\n+\n void\n xmlDumpElementDecl(xmlBufferPtr buf, xmlElementPtr elem) {\n     if ((buf == NULL) || (elem == NULL))\n@@ -1671,28 +1672,46 @@\n case XML_ELEMENT_TYPE_EMPTY:\n     xmlBufferWriteChar(buf, "<!ELEMENT ");\n     if (elem->prefix != NULL) {\n-xmlBufferWriteCHAR(buf, elem->prefix);\n-xmlBufferWriteChar(buf, ":");\n+        xmlBufferWriteCHAR(buf, elem->prefix);\n+        xmlBufferWriteChar(buf, ":");\n+    }\n+    if (elem->name != NULL) {\n+        xmlBufferWriteCHAR(buf, elem->name);\n+    } else {\n+        xmlErrValid(NULL, XML_ERR_INTERNAL_ERROR,\n+        "Internal: ELEMENT name is NULL\\n", NULL);\n+        return;\n     }\n-    xmlBufferWriteCHAR(buf, elem->name);\n     xmlBufferWriteChar(buf, " EMPTY>\\n");\n     break;\n case XML_ELEMENT_TYPE_ANY:\n     xmlBufferWriteChar(buf, "<!ELEMENT ");\n     if (elem->prefix != NULL) {\n-xmlBufferWriteCHAR(buf, elem->prefix);\n-xmlBufferWriteChar(buf, ":");\n+        xmlBufferWriteCHAR(buf, elem->prefix);\n+        xmlBufferWriteChar(buf, ":");\n+    }\n+    if (elem->name != NULL) {\n+        xmlBufferWriteCHAR(buf, elem->name);\n+    } else {\n+        xmlErrValid(NULL, XML_ERR_INTERNAL_ERROR,\n+        "Internal: ELEMENT name is NULL\\n", NULL);\n+        return;\n     }\n-    xmlBufferWriteCHAR(buf, elem->name);\n     xmlBufferWriteChar(buf, " ANY>\\n");\n     break;\n case XML_ELEMENT_TYPE_MIXED:\n     xmlBufferWriteChar(buf, "<!ELEMENT ");\n     if (elem->prefix != NULL) {\n-xmlBufferWriteCHAR(buf, elem->prefix);\n-xmlBufferWriteChar(buf, ":");\n+        xmlBufferWriteCHAR(buf, elem->prefix);\n+        xmlBufferWriteChar(buf, ":");\n+    }\n+    if (elem->name != NULL) {\n+        xmlBufferWriteCHAR(buf, elem->name);\n+    } else {\n+        xmlErrValid(NULL, XML_ERR_INTERNAL_ERROR,\n+        "Internal: ELEMENT name is NULL\\n", NULL);\n+        return;\n     }\n-    xmlBufferWriteCHAR(buf, elem->name);\n     xmlBufferWriteChar(buf, " ");\n     xmlDumpElementContent(buf, elem->content, 1);\n     xmlBufferWriteChar(buf, ">\\n");\n@@ -1700,10 +1719,16 @@\n case XML_ELEMENT_TYPE_ELEMENT:\n     xmlBufferWriteChar(buf, "<!ELEMENT ");\n     if (elem->prefix != NULL) {\n-xmlBufferWriteCHAR(buf, elem->prefix);\n-xmlBufferWriteChar(buf, ":");\n+        xmlBufferWriteCHAR(buf, elem->prefix);\n+        xmlBufferWriteChar(buf, ":");\n+    }\n+    if (elem->name != NULL) {\n+        xmlBufferWriteCHAR(buf, elem->name);\n+    } else {\n+        xmlErrValid(NULL, XML_ERR_INTERNAL_ERROR,\n+        "Internal: ELEMENT name is NULL\\n", NULL);\n+        return;\n     }\n-    xmlBufferWriteCHAR(buf, elem->name);\n     xmlBufferWriteChar(buf, " ");\n     xmlDumpElementContent(buf, elem->content, 1);\n     xmlBufferWriteChar(buf, ">\\n");\n@@ -1715,6 +1740,7 @@\n     }\n }\n \n+\n /**\n  * xmlDumpElementDeclScan:\n  * @elem:  An element table\n', 'id': 48, 'location': '/data/vulnloc/libxml2/CVE-2017-5969/src/valid.c:1686:5'}, {'diff': '@@ -1663,6 +1663,7 @@\n  * This will dump the content of the element declaration as an XML\n  * DTD definition\n  */\n+\n void\n xmlDumpElementDecl(xmlBufferPtr buf, xmlElementPtr elem) {\n     if ((buf == NULL) || (elem == NULL))\n@@ -1671,28 +1672,40 @@\n case XML_ELEMENT_TYPE_EMPTY:\n     xmlBufferWriteChar(buf, "<!ELEMENT ");\n     if (elem->prefix != NULL) {\n-xmlBufferWriteCHAR(buf, elem->prefix);\n-xmlBufferWriteChar(buf, ":");\n+        xmlBufferWriteCHAR(buf, elem->prefix);\n+        xmlBufferWriteChar(buf, ":");\n+    }\n+    if (elem->name != NULL) {\n+        xmlBufferWriteCHAR(buf, elem->name);\n+    } else {\n+        xmlBufferWriteCHAR(buf, "UnnamedElement");\n     }\n-    xmlBufferWriteCHAR(buf, elem->name);\n     xmlBufferWriteChar(buf, " EMPTY>\\n");\n     break;\n case XML_ELEMENT_TYPE_ANY:\n     xmlBufferWriteChar(buf, "<!ELEMENT ");\n     if (elem->prefix != NULL) {\n-xmlBufferWriteCHAR(buf, elem->prefix);\n-xmlBufferWriteChar(buf, ":");\n+        xmlBufferWriteCHAR(buf, elem->prefix);\n+        xmlBufferWriteChar(buf, ":");\n+    }\n+    if (elem->name != NULL) {\n+        xmlBufferWriteCHAR(buf, elem->name);\n+    } else {\n+        xmlBufferWriteCHAR(buf, "UnnamedElement");\n     }\n-    xmlBufferWriteCHAR(buf, elem->name);\n     xmlBufferWriteChar(buf, " ANY>\\n");\n     break;\n case XML_ELEMENT_TYPE_MIXED:\n     xmlBufferWriteChar(buf, "<!ELEMENT ");\n     if (elem->prefix != NULL) {\n-xmlBufferWriteCHAR(buf, elem->prefix);\n-xmlBufferWriteChar(buf, ":");\n+        xmlBufferWriteCHAR(buf, elem->prefix);\n+        xmlBufferWriteChar(buf, ":");\n+    }\n+    if (elem->name != NULL) {\n+        xmlBufferWriteCHAR(buf, elem->name);\n+    } else {\n+        xmlBufferWriteCHAR(buf, "UnnamedElement");\n     }\n-    xmlBufferWriteCHAR(buf, elem->name);\n     xmlBufferWriteChar(buf, " ");\n     xmlDumpElementContent(buf, elem->content, 1);\n     xmlBufferWriteChar(buf, ">\\n");\n@@ -1700,10 +1713,14 @@\n case XML_ELEMENT_TYPE_ELEMENT:\n     xmlBufferWriteChar(buf, "<!ELEMENT ");\n     if (elem->prefix != NULL) {\n-xmlBufferWriteCHAR(buf, elem->prefix);\n-xmlBufferWriteChar(buf, ":");\n+        xmlBufferWriteCHAR(buf, elem->prefix);\n+        xmlBufferWriteChar(buf, ":");\n+    }\n+    if (elem->name != NULL) {\n+        xmlBufferWriteCHAR(buf, elem->name);\n+    } else {\n+        xmlBufferWriteCHAR(buf, "UnnamedElement");\n     }\n-    xmlBufferWriteCHAR(buf, elem->name);\n     xmlBufferWriteChar(buf, " ");\n     xmlDumpElementContent(buf, elem->content, 1);\n     xmlBufferWriteChar(buf, ">\\n");\n@@ -1715,6 +1732,7 @@\n     }\n }\n \n+\n /**\n  * xmlDumpElementDeclScan:\n  * @elem:  An element table\n', 'id': 49, 'location': '/data/vulnloc/libxml2/CVE-2017-5969/src/valid.c:1686:5'}, {'diff': '@@ -1663,6 +1663,7 @@\n  * This will dump the content of the element declaration as an XML\n  * DTD definition\n  */\n+\n void\n xmlDumpElementDecl(xmlBufferPtr buf, xmlElementPtr elem) {\n     if ((buf == NULL) || (elem == NULL))\n@@ -1671,28 +1672,40 @@\n case XML_ELEMENT_TYPE_EMPTY:\n     xmlBufferWriteChar(buf, "<!ELEMENT ");\n     if (elem->prefix != NULL) {\n-xmlBufferWriteCHAR(buf, elem->prefix);\n-xmlBufferWriteChar(buf, ":");\n+        xmlBufferWriteCHAR(buf, elem->prefix);\n+        xmlBufferWriteChar(buf, ":");\n+    }\n+    if (elem->name != NULL) {\n+        xmlBufferWriteCHAR(buf, elem->name);\n+    } else {\n+        xmlBufferWriteChar(buf, "UNKNOWN");\n     }\n-    xmlBufferWriteCHAR(buf, elem->name);\n     xmlBufferWriteChar(buf, " EMPTY>\\n");\n     break;\n case XML_ELEMENT_TYPE_ANY:\n     xmlBufferWriteChar(buf, "<!ELEMENT ");\n     if (elem->prefix != NULL) {\n-xmlBufferWriteCHAR(buf, elem->prefix);\n-xmlBufferWriteChar(buf, ":");\n+        xmlBufferWriteCHAR(buf, elem->prefix);\n+        xmlBufferWriteChar(buf, ":");\n+    }\n+    if (elem->name != NULL) {\n+        xmlBufferWriteCHAR(buf, elem->name);\n+    } else {\n+        xmlBufferWriteChar(buf, "UNKNOWN");\n     }\n-    xmlBufferWriteCHAR(buf, elem->name);\n     xmlBufferWriteChar(buf, " ANY>\\n");\n     break;\n case XML_ELEMENT_TYPE_MIXED:\n     xmlBufferWriteChar(buf, "<!ELEMENT ");\n     if (elem->prefix != NULL) {\n-xmlBufferWriteCHAR(buf, elem->prefix);\n-xmlBufferWriteChar(buf, ":");\n+        xmlBufferWriteCHAR(buf, elem->prefix);\n+        xmlBufferWriteChar(buf, ":");\n+    }\n+    if (elem->name != NULL) {\n+        xmlBufferWriteCHAR(buf, elem->name);\n+    } else {\n+        xmlBufferWriteChar(buf, "UNKNOWN");\n     }\n-    xmlBufferWriteCHAR(buf, elem->name);\n     xmlBufferWriteChar(buf, " ");\n     xmlDumpElementContent(buf, elem->content, 1);\n     xmlBufferWriteChar(buf, ">\\n");\n@@ -1700,10 +1713,14 @@\n case XML_ELEMENT_TYPE_ELEMENT:\n     xmlBufferWriteChar(buf, "<!ELEMENT ");\n     if (elem->prefix != NULL) {\n-xmlBufferWriteCHAR(buf, elem->prefix);\n-xmlBufferWriteChar(buf, ":");\n+        xmlBufferWriteCHAR(buf, elem->prefix);\n+        xmlBufferWriteChar(buf, ":");\n+    }\n+    if (elem->name != NULL) {\n+        xmlBufferWriteCHAR(buf, elem->name);\n+    } else {\n+        xmlBufferWriteChar(buf, "UNKNOWN");\n     }\n-    xmlBufferWriteCHAR(buf, elem->name);\n     xmlBufferWriteChar(buf, " ");\n     xmlDumpElementContent(buf, elem->content, 1);\n     xmlBufferWriteChar(buf, ">\\n");\n@@ -1715,6 +1732,7 @@\n     }\n }\n \n+\n /**\n  * xmlDumpElementDeclScan:\n  * @elem:  An element table\n', 'id': 50, 'location': '/data/vulnloc/libxml2/CVE-2017-5969/src/valid.c:1681:5'}, {'diff': '@@ -1663,6 +1663,7 @@\n  * This will dump the content of the element declaration as an XML\n  * DTD definition\n  */\n+\n void\n xmlDumpElementDecl(xmlBufferPtr buf, xmlElementPtr elem) {\n     if ((buf == NULL) || (elem == NULL))\n@@ -1671,8 +1672,8 @@\n case XML_ELEMENT_TYPE_EMPTY:\n     xmlBufferWriteChar(buf, "<!ELEMENT ");\n     if (elem->prefix != NULL) {\n-xmlBufferWriteCHAR(buf, elem->prefix);\n-xmlBufferWriteChar(buf, ":");\n+        xmlBufferWriteCHAR(buf, elem->prefix);\n+        xmlBufferWriteChar(buf, ":");\n     }\n     xmlBufferWriteCHAR(buf, elem->name);\n     xmlBufferWriteChar(buf, " EMPTY>\\n");\n@@ -1680,8 +1681,8 @@\n case XML_ELEMENT_TYPE_ANY:\n     xmlBufferWriteChar(buf, "<!ELEMENT ");\n     if (elem->prefix != NULL) {\n-xmlBufferWriteCHAR(buf, elem->prefix);\n-xmlBufferWriteChar(buf, ":");\n+        xmlBufferWriteCHAR(buf, elem->prefix);\n+        xmlBufferWriteChar(buf, ":");\n     }\n     xmlBufferWriteCHAR(buf, elem->name);\n     xmlBufferWriteChar(buf, " ANY>\\n");\n@@ -1689,8 +1690,8 @@\n case XML_ELEMENT_TYPE_MIXED:\n     xmlBufferWriteChar(buf, "<!ELEMENT ");\n     if (elem->prefix != NULL) {\n-xmlBufferWriteCHAR(buf, elem->prefix);\n-xmlBufferWriteChar(buf, ":");\n+        xmlBufferWriteCHAR(buf, elem->prefix);\n+        xmlBufferWriteChar(buf, ":");\n     }\n     xmlBufferWriteCHAR(buf, elem->name);\n     xmlBufferWriteChar(buf, " ");\n@@ -1700,8 +1701,8 @@\n case XML_ELEMENT_TYPE_ELEMENT:\n     xmlBufferWriteChar(buf, "<!ELEMENT ");\n     if (elem->prefix != NULL) {\n-xmlBufferWriteCHAR(buf, elem->prefix);\n-xmlBufferWriteChar(buf, ":");\n+        xmlBufferWriteCHAR(buf, elem->prefix);\n+        xmlBufferWriteChar(buf, ":");\n     }\n     xmlBufferWriteCHAR(buf, elem->name);\n     xmlBufferWriteChar(buf, " ");\n@@ -1715,6 +1716,7 @@\n     }\n }\n \n+\n /**\n  * xmlDumpElementDeclScan:\n  * @elem:  An element table\n', 'id': 51, 'location': '/data/vulnloc/libxml2/CVE-2017-5969/src/valid.c:1681:5'}, {'diff': '@@ -1663,6 +1663,7 @@\n  * This will dump the content of the element declaration as an XML\n  * DTD definition\n  */\n+\n void\n xmlDumpElementDecl(xmlBufferPtr buf, xmlElementPtr elem) {\n     if ((buf == NULL) || (elem == NULL))\n@@ -1671,8 +1672,8 @@\n case XML_ELEMENT_TYPE_EMPTY:\n     xmlBufferWriteChar(buf, "<!ELEMENT ");\n     if (elem->prefix != NULL) {\n-xmlBufferWriteCHAR(buf, elem->prefix);\n-xmlBufferWriteChar(buf, ":");\n+        xmlBufferWriteCHAR(buf, elem->prefix);\n+        xmlBufferWriteChar(buf, ":");\n     }\n     xmlBufferWriteCHAR(buf, elem->name);\n     xmlBufferWriteChar(buf, " EMPTY>\\n");\n@@ -1680,8 +1681,8 @@\n case XML_ELEMENT_TYPE_ANY:\n     xmlBufferWriteChar(buf, "<!ELEMENT ");\n     if (elem->prefix != NULL) {\n-xmlBufferWriteCHAR(buf, elem->prefix);\n-xmlBufferWriteChar(buf, ":");\n+        xmlBufferWriteCHAR(buf, elem->prefix);\n+        xmlBufferWriteChar(buf, ":");\n     }\n     xmlBufferWriteCHAR(buf, elem->name);\n     xmlBufferWriteChar(buf, " ANY>\\n");\n@@ -1689,8 +1690,8 @@\n case XML_ELEMENT_TYPE_MIXED:\n     xmlBufferWriteChar(buf, "<!ELEMENT ");\n     if (elem->prefix != NULL) {\n-xmlBufferWriteCHAR(buf, elem->prefix);\n-xmlBufferWriteChar(buf, ":");\n+        xmlBufferWriteCHAR(buf, elem->prefix);\n+        xmlBufferWriteChar(buf, ":");\n     }\n     xmlBufferWriteCHAR(buf, elem->name);\n     xmlBufferWriteChar(buf, " ");\n@@ -1700,8 +1701,8 @@\n case XML_ELEMENT_TYPE_ELEMENT:\n     xmlBufferWriteChar(buf, "<!ELEMENT ");\n     if (elem->prefix != NULL) {\n-xmlBufferWriteCHAR(buf, elem->prefix);\n-xmlBufferWriteChar(buf, ":");\n+        xmlBufferWriteCHAR(buf, elem->prefix);\n+        xmlBufferWriteChar(buf, ":");\n     }\n     xmlBufferWriteCHAR(buf, elem->name);\n     xmlBufferWriteChar(buf, " ");\n@@ -1715,6 +1716,7 @@\n     }\n }\n \n+\n /**\n  * xmlDumpElementDeclScan:\n  * @elem:  An element table\n', 'id': 52, 'location': '/data/vulnloc/libxml2/CVE-2017-5969/src/valid.c:1681:5'}, {'diff': '@@ -1663,6 +1663,7 @@\n  * This will dump the content of the element declaration as an XML\n  * DTD definition\n  */\n+\n void\n xmlDumpElementDecl(xmlBufferPtr buf, xmlElementPtr elem) {\n     if ((buf == NULL) || (elem == NULL))\n@@ -1671,8 +1672,8 @@\n case XML_ELEMENT_TYPE_EMPTY:\n     xmlBufferWriteChar(buf, "<!ELEMENT ");\n     if (elem->prefix != NULL) {\n-xmlBufferWriteCHAR(buf, elem->prefix);\n-xmlBufferWriteChar(buf, ":");\n+        xmlBufferWriteCHAR(buf, elem->prefix);\n+        xmlBufferWriteChar(buf, ":");\n     }\n     xmlBufferWriteCHAR(buf, elem->name);\n     xmlBufferWriteChar(buf, " EMPTY>\\n");\n@@ -1680,8 +1681,8 @@\n case XML_ELEMENT_TYPE_ANY:\n     xmlBufferWriteChar(buf, "<!ELEMENT ");\n     if (elem->prefix != NULL) {\n-xmlBufferWriteCHAR(buf, elem->prefix);\n-xmlBufferWriteChar(buf, ":");\n+        xmlBufferWriteCHAR(buf, elem->prefix);\n+        xmlBufferWriteChar(buf, ":");\n     }\n     xmlBufferWriteCHAR(buf, elem->name);\n     xmlBufferWriteChar(buf, " ANY>\\n");\n@@ -1689,8 +1690,8 @@\n case XML_ELEMENT_TYPE_MIXED:\n     xmlBufferWriteChar(buf, "<!ELEMENT ");\n     if (elem->prefix != NULL) {\n-xmlBufferWriteCHAR(buf, elem->prefix);\n-xmlBufferWriteChar(buf, ":");\n+        xmlBufferWriteCHAR(buf, elem->prefix);\n+        xmlBufferWriteChar(buf, ":");\n     }\n     xmlBufferWriteCHAR(buf, elem->name);\n     xmlBufferWriteChar(buf, " ");\n@@ -1700,8 +1701,8 @@\n case XML_ELEMENT_TYPE_ELEMENT:\n     xmlBufferWriteChar(buf, "<!ELEMENT ");\n     if (elem->prefix != NULL) {\n-xmlBufferWriteCHAR(buf, elem->prefix);\n-xmlBufferWriteChar(buf, ":");\n+        xmlBufferWriteCHAR(buf, elem->prefix);\n+        xmlBufferWriteChar(buf, ":");\n     }\n     xmlBufferWriteCHAR(buf, elem->name);\n     xmlBufferWriteChar(buf, " ");\n@@ -1715,6 +1716,7 @@\n     }\n }\n \n+\n /**\n  * xmlDumpElementDeclScan:\n  * @elem:  An element table\n', 'id': 53, 'location': '/data/vulnloc/libxml2/CVE-2017-5969/src/valid.c:1681:5'}, {'diff': '@@ -1663,6 +1663,7 @@\n  * This will dump the content of the element declaration as an XML\n  * DTD definition\n  */\n+\n void\n xmlDumpElementDecl(xmlBufferPtr buf, xmlElementPtr elem) {\n     if ((buf == NULL) || (elem == NULL))\n@@ -1671,8 +1672,8 @@\n case XML_ELEMENT_TYPE_EMPTY:\n     xmlBufferWriteChar(buf, "<!ELEMENT ");\n     if (elem->prefix != NULL) {\n-xmlBufferWriteCHAR(buf, elem->prefix);\n-xmlBufferWriteChar(buf, ":");\n+        xmlBufferWriteCHAR(buf, elem->prefix);\n+        xmlBufferWriteChar(buf, ":");\n     }\n     xmlBufferWriteCHAR(buf, elem->name);\n     xmlBufferWriteChar(buf, " EMPTY>\\n");\n@@ -1680,8 +1681,8 @@\n case XML_ELEMENT_TYPE_ANY:\n     xmlBufferWriteChar(buf, "<!ELEMENT ");\n     if (elem->prefix != NULL) {\n-xmlBufferWriteCHAR(buf, elem->prefix);\n-xmlBufferWriteChar(buf, ":");\n+        xmlBufferWriteCHAR(buf, elem->prefix);\n+        xmlBufferWriteChar(buf, ":");\n     }\n     xmlBufferWriteCHAR(buf, elem->name);\n     xmlBufferWriteChar(buf, " ANY>\\n");\n@@ -1689,23 +1690,29 @@\n case XML_ELEMENT_TYPE_MIXED:\n     xmlBufferWriteChar(buf, "<!ELEMENT ");\n     if (elem->prefix != NULL) {\n-xmlBufferWriteCHAR(buf, elem->prefix);\n-xmlBufferWriteChar(buf, ":");\n+        xmlBufferWriteCHAR(buf, elem->prefix);\n+        xmlBufferWriteChar(buf, ":");\n     }\n     xmlBufferWriteCHAR(buf, elem->name);\n     xmlBufferWriteChar(buf, " ");\n-    xmlDumpElementContent(buf, elem->content, 1);\n+    // Ensure content is not NULL before dumping\n+    if (elem->content != NULL) {\n+        xmlDumpElementContent(buf, elem->content, 1);\n+    }\n     xmlBufferWriteChar(buf, ">\\n");\n     break;\n case XML_ELEMENT_TYPE_ELEMENT:\n     xmlBufferWriteChar(buf, "<!ELEMENT ");\n     if (elem->prefix != NULL) {\n-xmlBufferWriteCHAR(buf, elem->prefix);\n-xmlBufferWriteChar(buf, ":");\n+        xmlBufferWriteCHAR(buf, elem->prefix);\n+        xmlBufferWriteChar(buf, ":");\n     }\n     xmlBufferWriteCHAR(buf, elem->name);\n     xmlBufferWriteChar(buf, " ");\n-    xmlDumpElementContent(buf, elem->content, 1);\n+    // Ensure content is not NULL before dumping\n+    if (elem->content != NULL) {\n+        xmlDumpElementContent(buf, elem->content, 1);\n+    }\n     xmlBufferWriteChar(buf, ">\\n");\n     break;\n default:\n@@ -1715,6 +1722,7 @@\n     }\n }\n \n+\n /**\n  * xmlDumpElementDeclScan:\n  * @elem:  An element table\n', 'id': 54, 'location': '/data/vulnloc/libxml2/CVE-2017-5969/src/valid.c:1681:5'}, {'diff': '@@ -1663,6 +1663,7 @@\n  * This will dump the content of the element declaration as an XML\n  * DTD definition\n  */\n+\n void\n xmlDumpElementDecl(xmlBufferPtr buf, xmlElementPtr elem) {\n     if ((buf == NULL) || (elem == NULL))\n@@ -1670,27 +1671,27 @@\n     switch (elem->etype) {\n case XML_ELEMENT_TYPE_EMPTY:\n     xmlBufferWriteChar(buf, "<!ELEMENT ");\n-    if (elem->prefix != NULL) {\n-xmlBufferWriteCHAR(buf, elem->prefix);\n-xmlBufferWriteChar(buf, ":");\n+    if (elem->prefix != NULL && elem->prefix->value != NULL) {\n+        xmlBufferWriteCHAR(buf, elem->prefix);\n+        xmlBufferWriteChar(buf, ":");\n     }\n     xmlBufferWriteCHAR(buf, elem->name);\n     xmlBufferWriteChar(buf, " EMPTY>\\n");\n     break;\n case XML_ELEMENT_TYPE_ANY:\n     xmlBufferWriteChar(buf, "<!ELEMENT ");\n-    if (elem->prefix != NULL) {\n-xmlBufferWriteCHAR(buf, elem->prefix);\n-xmlBufferWriteChar(buf, ":");\n+    if (elem->prefix != NULL && elem->prefix->value != NULL) {\n+        xmlBufferWriteCHAR(buf, elem->prefix);\n+        xmlBufferWriteChar(buf, ":");\n     }\n     xmlBufferWriteCHAR(buf, elem->name);\n     xmlBufferWriteChar(buf, " ANY>\\n");\n     break;\n case XML_ELEMENT_TYPE_MIXED:\n     xmlBufferWriteChar(buf, "<!ELEMENT ");\n-    if (elem->prefix != NULL) {\n-xmlBufferWriteCHAR(buf, elem->prefix);\n-xmlBufferWriteChar(buf, ":");\n+    if (elem->prefix != NULL && elem->prefix->value != NULL) {\n+        xmlBufferWriteCHAR(buf, elem->prefix);\n+        xmlBufferWriteChar(buf, ":");\n     }\n     xmlBufferWriteCHAR(buf, elem->name);\n     xmlBufferWriteChar(buf, " ");\n@@ -1699,9 +1700,9 @@\n     break;\n case XML_ELEMENT_TYPE_ELEMENT:\n     xmlBufferWriteChar(buf, "<!ELEMENT ");\n-    if (elem->prefix != NULL) {\n-xmlBufferWriteCHAR(buf, elem->prefix);\n-xmlBufferWriteChar(buf, ":");\n+    if (elem->prefix != NULL && elem->prefix->value != NULL) {\n+        xmlBufferWriteCHAR(buf, elem->prefix);\n+        xmlBufferWriteChar(buf, ":");\n     }\n     xmlBufferWriteCHAR(buf, elem->name);\n     xmlBufferWriteChar(buf, " ");\n@@ -1715,6 +1716,7 @@\n     }\n }\n \n+\n /**\n  * xmlDumpElementDeclScan:\n  * @elem:  An element table\n', 'id': 55, 'location': '/data/vulnloc/libxml2/CVE-2017-5969/src/valid.c:1691:5'}, {'diff': '@@ -1663,6 +1663,7 @@\n  * This will dump the content of the element declaration as an XML\n  * DTD definition\n  */\n+\n void\n xmlDumpElementDecl(xmlBufferPtr buf, xmlElementPtr elem) {\n     if ((buf == NULL) || (elem == NULL))\n@@ -1671,8 +1672,10 @@\n case XML_ELEMENT_TYPE_EMPTY:\n     xmlBufferWriteChar(buf, "<!ELEMENT ");\n     if (elem->prefix != NULL) {\n-xmlBufferWriteCHAR(buf, elem->prefix);\n-xmlBufferWriteChar(buf, ":");\n+        if (xmlStrlen(elem->prefix) < 100) { // Example length check\n+            xmlBufferWriteCHAR(buf, elem->prefix);\n+            xmlBufferWriteChar(buf, ":");\n+        }\n     }\n     xmlBufferWriteCHAR(buf, elem->name);\n     xmlBufferWriteChar(buf, " EMPTY>\\n");\n@@ -1680,8 +1683,10 @@\n case XML_ELEMENT_TYPE_ANY:\n     xmlBufferWriteChar(buf, "<!ELEMENT ");\n     if (elem->prefix != NULL) {\n-xmlBufferWriteCHAR(buf, elem->prefix);\n-xmlBufferWriteChar(buf, ":");\n+        if (xmlStrlen(elem->prefix) < 100) { // Example length check\n+            xmlBufferWriteCHAR(buf, elem->prefix);\n+            xmlBufferWriteChar(buf, ":");\n+        }\n     }\n     xmlBufferWriteCHAR(buf, elem->name);\n     xmlBufferWriteChar(buf, " ANY>\\n");\n@@ -1689,8 +1694,10 @@\n case XML_ELEMENT_TYPE_MIXED:\n     xmlBufferWriteChar(buf, "<!ELEMENT ");\n     if (elem->prefix != NULL) {\n-xmlBufferWriteCHAR(buf, elem->prefix);\n-xmlBufferWriteChar(buf, ":");\n+        if (xmlStrlen(elem->prefix) < 100) { // Example length check\n+            xmlBufferWriteCHAR(buf, elem->prefix);\n+            xmlBufferWriteChar(buf, ":");\n+        }\n     }\n     xmlBufferWriteCHAR(buf, elem->name);\n     xmlBufferWriteChar(buf, " ");\n@@ -1700,8 +1707,10 @@\n case XML_ELEMENT_TYPE_ELEMENT:\n     xmlBufferWriteChar(buf, "<!ELEMENT ");\n     if (elem->prefix != NULL) {\n-xmlBufferWriteCHAR(buf, elem->prefix);\n-xmlBufferWriteChar(buf, ":");\n+        if (xmlStrlen(elem->prefix) < 100) { // Example length check\n+            xmlBufferWriteCHAR(buf, elem->prefix);\n+            xmlBufferWriteChar(buf, ":");\n+        }\n     }\n     xmlBufferWriteCHAR(buf, elem->name);\n     xmlBufferWriteChar(buf, " ");\n@@ -1715,6 +1724,7 @@\n     }\n }\n \n+\n /**\n  * xmlDumpElementDeclScan:\n  * @elem:  An element table\n', 'id': 56, 'location': '/data/vulnloc/libxml2/CVE-2017-5969/src/valid.c:1691:5'}, {'diff': '@@ -1663,6 +1663,7 @@\n  * This will dump the content of the element declaration as an XML\n  * DTD definition\n  */\n+\n void\n xmlDumpElementDecl(xmlBufferPtr buf, xmlElementPtr elem) {\n     if ((buf == NULL) || (elem == NULL))\n@@ -1670,27 +1671,27 @@\n     switch (elem->etype) {\n case XML_ELEMENT_TYPE_EMPTY:\n     xmlBufferWriteChar(buf, "<!ELEMENT ");\n-    if (elem->prefix != NULL) {\n-xmlBufferWriteCHAR(buf, elem->prefix);\n-xmlBufferWriteChar(buf, ":");\n+    if (elem->prefix != NULL && elem->prefix->content != NULL) {\n+        xmlBufferWriteCHAR(buf, elem->prefix);\n+        xmlBufferWriteChar(buf, ":");\n     }\n     xmlBufferWriteCHAR(buf, elem->name);\n     xmlBufferWriteChar(buf, " EMPTY>\\n");\n     break;\n case XML_ELEMENT_TYPE_ANY:\n     xmlBufferWriteChar(buf, "<!ELEMENT ");\n-    if (elem->prefix != NULL) {\n-xmlBufferWriteCHAR(buf, elem->prefix);\n-xmlBufferWriteChar(buf, ":");\n+    if (elem->prefix != NULL && elem->prefix->content != NULL) {\n+        xmlBufferWriteCHAR(buf, elem->prefix);\n+        xmlBufferWriteChar(buf, ":");\n     }\n     xmlBufferWriteCHAR(buf, elem->name);\n     xmlBufferWriteChar(buf, " ANY>\\n");\n     break;\n case XML_ELEMENT_TYPE_MIXED:\n     xmlBufferWriteChar(buf, "<!ELEMENT ");\n-    if (elem->prefix != NULL) {\n-xmlBufferWriteCHAR(buf, elem->prefix);\n-xmlBufferWriteChar(buf, ":");\n+    if (elem->prefix != NULL && elem->prefix->content != NULL) {\n+        xmlBufferWriteCHAR(buf, elem->prefix);\n+        xmlBufferWriteChar(buf, ":");\n     }\n     xmlBufferWriteCHAR(buf, elem->name);\n     xmlBufferWriteChar(buf, " ");\n@@ -1699,9 +1700,9 @@\n     break;\n case XML_ELEMENT_TYPE_ELEMENT:\n     xmlBufferWriteChar(buf, "<!ELEMENT ");\n-    if (elem->prefix != NULL) {\n-xmlBufferWriteCHAR(buf, elem->prefix);\n-xmlBufferWriteChar(buf, ":");\n+    if (elem->prefix != NULL && elem->prefix->content != NULL) {\n+        xmlBufferWriteCHAR(buf, elem->prefix);\n+        xmlBufferWriteChar(buf, ":");\n     }\n     xmlBufferWriteCHAR(buf, elem->name);\n     xmlBufferWriteChar(buf, " ");\n@@ -1715,6 +1716,7 @@\n     }\n }\n \n+\n /**\n  * xmlDumpElementDeclScan:\n  * @elem:  An element table\n', 'id': 57, 'location': '/data/vulnloc/libxml2/CVE-2017-5969/src/valid.c:1691:5'}, {'diff': '@@ -1663,6 +1663,7 @@\n  * This will dump the content of the element declaration as an XML\n  * DTD definition\n  */\n+\n void\n xmlDumpElementDecl(xmlBufferPtr buf, xmlElementPtr elem) {\n     if ((buf == NULL) || (elem == NULL))\n@@ -1670,27 +1671,27 @@\n     switch (elem->etype) {\n case XML_ELEMENT_TYPE_EMPTY:\n     xmlBufferWriteChar(buf, "<!ELEMENT ");\n-    if (elem->prefix != NULL) {\n-xmlBufferWriteCHAR(buf, elem->prefix);\n-xmlBufferWriteChar(buf, ":");\n+    if (elem->prefix != NULL && elem->prefix != (const char *)-1) {\n+        xmlBufferWriteCHAR(buf, elem->prefix);\n+        xmlBufferWriteChar(buf, ":");\n     }\n     xmlBufferWriteCHAR(buf, elem->name);\n     xmlBufferWriteChar(buf, " EMPTY>\\n");\n     break;\n case XML_ELEMENT_TYPE_ANY:\n     xmlBufferWriteChar(buf, "<!ELEMENT ");\n-    if (elem->prefix != NULL) {\n-xmlBufferWriteCHAR(buf, elem->prefix);\n-xmlBufferWriteChar(buf, ":");\n+    if (elem->prefix != NULL && elem->prefix != (const char *)-1) {\n+        xmlBufferWriteCHAR(buf, elem->prefix);\n+        xmlBufferWriteChar(buf, ":");\n     }\n     xmlBufferWriteCHAR(buf, elem->name);\n     xmlBufferWriteChar(buf, " ANY>\\n");\n     break;\n case XML_ELEMENT_TYPE_MIXED:\n     xmlBufferWriteChar(buf, "<!ELEMENT ");\n-    if (elem->prefix != NULL) {\n-xmlBufferWriteCHAR(buf, elem->prefix);\n-xmlBufferWriteChar(buf, ":");\n+    if (elem->prefix != NULL && elem->prefix != (const char *)-1) {\n+        xmlBufferWriteCHAR(buf, elem->prefix);\n+        xmlBufferWriteChar(buf, ":");\n     }\n     xmlBufferWriteCHAR(buf, elem->name);\n     xmlBufferWriteChar(buf, " ");\n@@ -1699,9 +1700,9 @@\n     break;\n case XML_ELEMENT_TYPE_ELEMENT:\n     xmlBufferWriteChar(buf, "<!ELEMENT ");\n-    if (elem->prefix != NULL) {\n-xmlBufferWriteCHAR(buf, elem->prefix);\n-xmlBufferWriteChar(buf, ":");\n+    if (elem->prefix != NULL && elem->prefix != (const char *)-1) {\n+        xmlBufferWriteCHAR(buf, elem->prefix);\n+        xmlBufferWriteChar(buf, ":");\n     }\n     xmlBufferWriteCHAR(buf, elem->name);\n     xmlBufferWriteChar(buf, " ");\n@@ -1715,6 +1716,7 @@\n     }\n }\n \n+\n /**\n  * xmlDumpElementDeclScan:\n  * @elem:  An element table\n', 'id': 58, 'location': '/data/vulnloc/libxml2/CVE-2017-5969/src/valid.c:1691:5'}, {'diff': '@@ -1663,58 +1663,61 @@\n  * This will dump the content of the element declaration as an XML\n  * DTD definition\n  */\n+\n void\n xmlDumpElementDecl(xmlBufferPtr buf, xmlElementPtr elem) {\n     if ((buf == NULL) || (elem == NULL))\n         return;\n+\n     switch (elem->etype) {\n-case XML_ELEMENT_TYPE_EMPTY:\n-    xmlBufferWriteChar(buf, "<!ELEMENT ");\n-    if (elem->prefix != NULL) {\n-xmlBufferWriteCHAR(buf, elem->prefix);\n-xmlBufferWriteChar(buf, ":");\n-    }\n-    xmlBufferWriteCHAR(buf, elem->name);\n-    xmlBufferWriteChar(buf, " EMPTY>\\n");\n-    break;\n-case XML_ELEMENT_TYPE_ANY:\n-    xmlBufferWriteChar(buf, "<!ELEMENT ");\n-    if (elem->prefix != NULL) {\n-xmlBufferWriteCHAR(buf, elem->prefix);\n-xmlBufferWriteChar(buf, ":");\n-    }\n-    xmlBufferWriteCHAR(buf, elem->name);\n-    xmlBufferWriteChar(buf, " ANY>\\n");\n-    break;\n-case XML_ELEMENT_TYPE_MIXED:\n-    xmlBufferWriteChar(buf, "<!ELEMENT ");\n-    if (elem->prefix != NULL) {\n-xmlBufferWriteCHAR(buf, elem->prefix);\n-xmlBufferWriteChar(buf, ":");\n-    }\n-    xmlBufferWriteCHAR(buf, elem->name);\n-    xmlBufferWriteChar(buf, " ");\n-    xmlDumpElementContent(buf, elem->content, 1);\n-    xmlBufferWriteChar(buf, ">\\n");\n-    break;\n-case XML_ELEMENT_TYPE_ELEMENT:\n-    xmlBufferWriteChar(buf, "<!ELEMENT ");\n-    if (elem->prefix != NULL) {\n-xmlBufferWriteCHAR(buf, elem->prefix);\n-xmlBufferWriteChar(buf, ":");\n-    }\n-    xmlBufferWriteCHAR(buf, elem->name);\n-    xmlBufferWriteChar(buf, " ");\n-    xmlDumpElementContent(buf, elem->content, 1);\n-    xmlBufferWriteChar(buf, ">\\n");\n-    break;\n-default:\n-    xmlErrValid(NULL, XML_ERR_INTERNAL_ERROR,\n-    "Internal: ELEMENT struct corrupted invalid type\\n",\n-    NULL);\n+        case XML_ELEMENT_TYPE_EMPTY:\n+            xmlBufferWriteChar(buf, "<!ELEMENT ");\n+            if (elem->prefix != NULL) {\n+                xmlBufferWriteCHAR(buf, elem->prefix);\n+                xmlBufferWriteChar(buf, ":");\n+            }\n+            xmlBufferWriteCHAR(buf, elem->name);\n+            xmlBufferWriteChar(buf, " EMPTY>\\n");\n+            break;\n+        case XML_ELEMENT_TYPE_ANY:\n+            xmlBufferWriteChar(buf, "<!ELEMENT ");\n+            if (elem->prefix != NULL) {\n+                xmlBufferWriteCHAR(buf, elem->prefix);\n+                xmlBufferWriteChar(buf, ":");\n+            }\n+            xmlBufferWriteCHAR(buf, elem->name);\n+            xmlBufferWriteChar(buf, " ANY>\\n");\n+            break;\n+        case XML_ELEMENT_TYPE_MIXED:\n+            xmlBufferWriteChar(buf, "<!ELEMENT ");\n+            if (elem->prefix != NULL) {\n+                xmlBufferWriteCHAR(buf, elem->prefix);\n+                xmlBufferWriteChar(buf, ":");\n+            }\n+            xmlBufferWriteCHAR(buf, elem->name);\n+            xmlBufferWriteChar(buf, " ");\n+            xmlDumpElementContent(buf, elem->content, 1);\n+            xmlBufferWriteChar(buf, ">\\n");\n+            break;\n+        case XML_ELEMENT_TYPE_ELEMENT:\n+            xmlBufferWriteChar(buf, "<!ELEMENT ");\n+            if (elem->prefix != NULL) {\n+                xmlBufferWriteCHAR(buf, elem->prefix);\n+                xmlBufferWriteChar(buf, ":");\n+            }\n+            xmlBufferWriteCHAR(buf, elem->name);\n+            xmlBufferWriteChar(buf, " ");\n+            xmlDumpElementContent(buf, elem->content, 1);\n+            xmlBufferWriteChar(buf, ">\\n");\n+            break;\n+        default:\n+            xmlErrValid(NULL, XML_ERR_INTERNAL_ERROR,\n+            "Internal: ELEMENT struct corrupted invalid type\\n",\n+            NULL);\n     }\n }\n \n+\n /**\n  * xmlDumpElementDeclScan:\n  * @elem:  An element table\n', 'id': 59, 'location': '/data/vulnloc/libxml2/CVE-2017-5969/src/valid.c:1691:5'}, {'diff': '@@ -1663,6 +1663,7 @@\n  * This will dump the content of the element declaration as an XML\n  * DTD definition\n  */\n+\n void\n xmlDumpElementDecl(xmlBufferPtr buf, xmlElementPtr elem) {\n     if ((buf == NULL) || (elem == NULL))\n@@ -1671,8 +1672,8 @@\n case XML_ELEMENT_TYPE_EMPTY:\n     xmlBufferWriteChar(buf, "<!ELEMENT ");\n     if (elem->prefix != NULL) {\n-xmlBufferWriteCHAR(buf, elem->prefix);\n-xmlBufferWriteChar(buf, ":");\n+        xmlBufferWriteCHAR(buf, elem->prefix);\n+        xmlBufferWriteChar(buf, ":");\n     }\n     xmlBufferWriteCHAR(buf, elem->name);\n     xmlBufferWriteChar(buf, " EMPTY>\\n");\n@@ -1680,8 +1681,8 @@\n case XML_ELEMENT_TYPE_ANY:\n     xmlBufferWriteChar(buf, "<!ELEMENT ");\n     if (elem->prefix != NULL) {\n-xmlBufferWriteCHAR(buf, elem->prefix);\n-xmlBufferWriteChar(buf, ":");\n+        xmlBufferWriteCHAR(buf, elem->prefix);\n+        xmlBufferWriteChar(buf, ":");\n     }\n     xmlBufferWriteCHAR(buf, elem->name);\n     xmlBufferWriteChar(buf, " ANY>\\n");\n@@ -1689,24 +1690,26 @@\n case XML_ELEMENT_TYPE_MIXED:\n     xmlBufferWriteChar(buf, "<!ELEMENT ");\n     if (elem->prefix != NULL) {\n-xmlBufferWriteCHAR(buf, elem->prefix);\n-xmlBufferWriteChar(buf, ":");\n+        xmlBufferWriteCHAR(buf, elem->prefix);\n+        xmlBufferWriteChar(buf, ":");\n     }\n     xmlBufferWriteCHAR(buf, elem->name);\n     xmlBufferWriteChar(buf, " ");\n     xmlDumpElementContent(buf, elem->content, 1);\n-    xmlBufferWriteChar(buf, ">\\n");\n+    xmlBufferWriteChar(buf, ">");\n+    xmlBufferWriteChar(buf, "\\n");\n     break;\n case XML_ELEMENT_TYPE_ELEMENT:\n     xmlBufferWriteChar(buf, "<!ELEMENT ");\n     if (elem->prefix != NULL) {\n-xmlBufferWriteCHAR(buf, elem->prefix);\n-xmlBufferWriteChar(buf, ":");\n+        xmlBufferWriteCHAR(buf, elem->prefix);\n+        xmlBufferWriteChar(buf, ":");\n     }\n     xmlBufferWriteCHAR(buf, elem->name);\n     xmlBufferWriteChar(buf, " ");\n     xmlDumpElementContent(buf, elem->content, 1);\n-    xmlBufferWriteChar(buf, ">\\n");\n+    xmlBufferWriteChar(buf, ">");\n+    xmlBufferWriteChar(buf, "\\n");\n     break;\n default:\n     xmlErrValid(NULL, XML_ERR_INTERNAL_ERROR,\n@@ -1715,6 +1718,7 @@\n     }\n }\n \n+\n /**\n  * xmlDumpElementDeclScan:\n  * @elem:  An element table\n', 'id': 60, 'location': '/data/vulnloc/libxml2/CVE-2017-5969/src/valid.c:1698:5'}, {'diff': '@@ -1663,6 +1663,7 @@\n  * This will dump the content of the element declaration as an XML\n  * DTD definition\n  */\n+\n void\n xmlDumpElementDecl(xmlBufferPtr buf, xmlElementPtr elem) {\n     if ((buf == NULL) || (elem == NULL))\n@@ -1671,8 +1672,8 @@\n case XML_ELEMENT_TYPE_EMPTY:\n     xmlBufferWriteChar(buf, "<!ELEMENT ");\n     if (elem->prefix != NULL) {\n-xmlBufferWriteCHAR(buf, elem->prefix);\n-xmlBufferWriteChar(buf, ":");\n+        xmlBufferWriteCHAR(buf, elem->prefix);\n+        xmlBufferWriteChar(buf, ":");\n     }\n     xmlBufferWriteCHAR(buf, elem->name);\n     xmlBufferWriteChar(buf, " EMPTY>\\n");\n@@ -1680,8 +1681,8 @@\n case XML_ELEMENT_TYPE_ANY:\n     xmlBufferWriteChar(buf, "<!ELEMENT ");\n     if (elem->prefix != NULL) {\n-xmlBufferWriteCHAR(buf, elem->prefix);\n-xmlBufferWriteChar(buf, ":");\n+        xmlBufferWriteCHAR(buf, elem->prefix);\n+        xmlBufferWriteChar(buf, ":");\n     }\n     xmlBufferWriteCHAR(buf, elem->name);\n     xmlBufferWriteChar(buf, " ANY>\\n");\n@@ -1689,24 +1690,32 @@\n case XML_ELEMENT_TYPE_MIXED:\n     xmlBufferWriteChar(buf, "<!ELEMENT ");\n     if (elem->prefix != NULL) {\n-xmlBufferWriteCHAR(buf, elem->prefix);\n-xmlBufferWriteChar(buf, ":");\n+        xmlBufferWriteCHAR(buf, elem->prefix);\n+        xmlBufferWriteChar(buf, ":");\n     }\n     xmlBufferWriteCHAR(buf, elem->name);\n     xmlBufferWriteChar(buf, " ");\n     xmlDumpElementContent(buf, elem->content, 1);\n-    xmlBufferWriteChar(buf, ">\\n");\n+    if (elem->content != NULL) {\n+        xmlBufferWriteChar(buf, ">\\n");\n+    } else {\n+        xmlBufferWriteChar(buf, "> <!-- No content defined -->\\n");\n+    }\n     break;\n case XML_ELEMENT_TYPE_ELEMENT:\n     xmlBufferWriteChar(buf, "<!ELEMENT ");\n     if (elem->prefix != NULL) {\n-xmlBufferWriteCHAR(buf, elem->prefix);\n-xmlBufferWriteChar(buf, ":");\n+        xmlBufferWriteCHAR(buf, elem->prefix);\n+        xmlBufferWriteChar(buf, ":");\n     }\n     xmlBufferWriteCHAR(buf, elem->name);\n     xmlBufferWriteChar(buf, " ");\n     xmlDumpElementContent(buf, elem->content, 1);\n-    xmlBufferWriteChar(buf, ">\\n");\n+    if (elem->content != NULL) {\n+        xmlBufferWriteChar(buf, ">\\n");\n+    } else {\n+        xmlBufferWriteChar(buf, "> <!-- No content defined -->\\n");\n+    }\n     break;\n default:\n     xmlErrValid(NULL, XML_ERR_INTERNAL_ERROR,\n@@ -1715,6 +1724,7 @@\n     }\n }\n \n+\n /**\n  * xmlDumpElementDeclScan:\n  * @elem:  An element table\n', 'id': 61, 'location': '/data/vulnloc/libxml2/CVE-2017-5969/src/valid.c:1698:5'}, {'diff': '@@ -1663,6 +1663,7 @@\n  * This will dump the content of the element declaration as an XML\n  * DTD definition\n  */\n+\n void\n xmlDumpElementDecl(xmlBufferPtr buf, xmlElementPtr elem) {\n     if ((buf == NULL) || (elem == NULL))\n@@ -1671,8 +1672,8 @@\n case XML_ELEMENT_TYPE_EMPTY:\n     xmlBufferWriteChar(buf, "<!ELEMENT ");\n     if (elem->prefix != NULL) {\n-xmlBufferWriteCHAR(buf, elem->prefix);\n-xmlBufferWriteChar(buf, ":");\n+        xmlBufferWriteCHAR(buf, elem->prefix);\n+        xmlBufferWriteChar(buf, ":");\n     }\n     xmlBufferWriteCHAR(buf, elem->name);\n     xmlBufferWriteChar(buf, " EMPTY>\\n");\n@@ -1680,8 +1681,8 @@\n case XML_ELEMENT_TYPE_ANY:\n     xmlBufferWriteChar(buf, "<!ELEMENT ");\n     if (elem->prefix != NULL) {\n-xmlBufferWriteCHAR(buf, elem->prefix);\n-xmlBufferWriteChar(buf, ":");\n+        xmlBufferWriteCHAR(buf, elem->prefix);\n+        xmlBufferWriteChar(buf, ":");\n     }\n     xmlBufferWriteCHAR(buf, elem->name);\n     xmlBufferWriteChar(buf, " ANY>\\n");\n@@ -1689,24 +1690,32 @@\n case XML_ELEMENT_TYPE_MIXED:\n     xmlBufferWriteChar(buf, "<!ELEMENT ");\n     if (elem->prefix != NULL) {\n-xmlBufferWriteCHAR(buf, elem->prefix);\n-xmlBufferWriteChar(buf, ":");\n+        xmlBufferWriteCHAR(buf, elem->prefix);\n+        xmlBufferWriteChar(buf, ":");\n     }\n     xmlBufferWriteCHAR(buf, elem->name);\n     xmlBufferWriteChar(buf, " ");\n     xmlDumpElementContent(buf, elem->content, 1);\n-    xmlBufferWriteChar(buf, ">\\n");\n+    if (elem->content != NULL) { // Added check to ensure proper handling\n+        xmlBufferWriteChar(buf, ">\\n");\n+    } else {\n+        xmlBufferWriteChar(buf, ">\\n"); // Make sure to handle this case safely\n+    }\n     break;\n case XML_ELEMENT_TYPE_ELEMENT:\n     xmlBufferWriteChar(buf, "<!ELEMENT ");\n     if (elem->prefix != NULL) {\n-xmlBufferWriteCHAR(buf, elem->prefix);\n-xmlBufferWriteChar(buf, ":");\n+        xmlBufferWriteCHAR(buf, elem->prefix);\n+        xmlBufferWriteChar(buf, ":");\n     }\n     xmlBufferWriteCHAR(buf, elem->name);\n     xmlBufferWriteChar(buf, " ");\n     xmlDumpElementContent(buf, elem->content, 1);\n-    xmlBufferWriteChar(buf, ">\\n");\n+    if (elem->content != NULL) { // Added check to ensure proper handling\n+        xmlBufferWriteChar(buf, ">\\n");\n+    } else {\n+        xmlBufferWriteChar(buf, ">\\n"); // Make sure to handle this case safely\n+    }\n     break;\n default:\n     xmlErrValid(NULL, XML_ERR_INTERNAL_ERROR,\n@@ -1715,6 +1724,7 @@\n     }\n }\n \n+\n /**\n  * xmlDumpElementDeclScan:\n  * @elem:  An element table\n', 'id': 62, 'location': '/data/vulnloc/libxml2/CVE-2017-5969/src/valid.c:1698:5'}, {'diff': '@@ -1663,6 +1663,7 @@\n  * This will dump the content of the element declaration as an XML\n  * DTD definition\n  */\n+\n void\n xmlDumpElementDecl(xmlBufferPtr buf, xmlElementPtr elem) {\n     if ((buf == NULL) || (elem == NULL))\n@@ -1671,8 +1672,8 @@\n case XML_ELEMENT_TYPE_EMPTY:\n     xmlBufferWriteChar(buf, "<!ELEMENT ");\n     if (elem->prefix != NULL) {\n-xmlBufferWriteCHAR(buf, elem->prefix);\n-xmlBufferWriteChar(buf, ":");\n+        xmlBufferWriteCHAR(buf, elem->prefix);\n+        xmlBufferWriteChar(buf, ":");\n     }\n     xmlBufferWriteCHAR(buf, elem->name);\n     xmlBufferWriteChar(buf, " EMPTY>\\n");\n@@ -1680,8 +1681,8 @@\n case XML_ELEMENT_TYPE_ANY:\n     xmlBufferWriteChar(buf, "<!ELEMENT ");\n     if (elem->prefix != NULL) {\n-xmlBufferWriteCHAR(buf, elem->prefix);\n-xmlBufferWriteChar(buf, ":");\n+        xmlBufferWriteCHAR(buf, elem->prefix);\n+        xmlBufferWriteChar(buf, ":");\n     }\n     xmlBufferWriteCHAR(buf, elem->name);\n     xmlBufferWriteChar(buf, " ANY>\\n");\n@@ -1689,8 +1690,8 @@\n case XML_ELEMENT_TYPE_MIXED:\n     xmlBufferWriteChar(buf, "<!ELEMENT ");\n     if (elem->prefix != NULL) {\n-xmlBufferWriteCHAR(buf, elem->prefix);\n-xmlBufferWriteChar(buf, ":");\n+        xmlBufferWriteCHAR(buf, elem->prefix);\n+        xmlBufferWriteChar(buf, ":");\n     }\n     xmlBufferWriteCHAR(buf, elem->name);\n     xmlBufferWriteChar(buf, " ");\n@@ -1700,13 +1701,17 @@\n case XML_ELEMENT_TYPE_ELEMENT:\n     xmlBufferWriteChar(buf, "<!ELEMENT ");\n     if (elem->prefix != NULL) {\n-xmlBufferWriteCHAR(buf, elem->prefix);\n-xmlBufferWriteChar(buf, ":");\n+        xmlBufferWriteCHAR(buf, elem->prefix);\n+        xmlBufferWriteChar(buf, ":");\n     }\n     xmlBufferWriteCHAR(buf, elem->name);\n     xmlBufferWriteChar(buf, " ");\n     xmlDumpElementContent(buf, elem->content, 1);\n-    xmlBufferWriteChar(buf, ">\\n");\n+    if (elem->content != NULL) {\n+        xmlBufferWriteChar(buf, ">\\n");\n+    } else {\n+        xmlBufferWriteChar(buf, ">\\n");\n+    }\n     break;\n default:\n     xmlErrValid(NULL, XML_ERR_INTERNAL_ERROR,\n@@ -1715,6 +1720,7 @@\n     }\n }\n \n+\n /**\n  * xmlDumpElementDeclScan:\n  * @elem:  An element table\n', 'id': 63, 'location': '/data/vulnloc/libxml2/CVE-2017-5969/src/valid.c:1698:5'}, {'diff': '@@ -1663,6 +1663,7 @@\n  * This will dump the content of the element declaration as an XML\n  * DTD definition\n  */\n+\n void\n xmlDumpElementDecl(xmlBufferPtr buf, xmlElementPtr elem) {\n     if ((buf == NULL) || (elem == NULL))\n@@ -1671,8 +1672,8 @@\n case XML_ELEMENT_TYPE_EMPTY:\n     xmlBufferWriteChar(buf, "<!ELEMENT ");\n     if (elem->prefix != NULL) {\n-xmlBufferWriteCHAR(buf, elem->prefix);\n-xmlBufferWriteChar(buf, ":");\n+        xmlBufferWriteCHAR(buf, elem->prefix);\n+        xmlBufferWriteChar(buf, ":");\n     }\n     xmlBufferWriteCHAR(buf, elem->name);\n     xmlBufferWriteChar(buf, " EMPTY>\\n");\n@@ -1680,8 +1681,8 @@\n case XML_ELEMENT_TYPE_ANY:\n     xmlBufferWriteChar(buf, "<!ELEMENT ");\n     if (elem->prefix != NULL) {\n-xmlBufferWriteCHAR(buf, elem->prefix);\n-xmlBufferWriteChar(buf, ":");\n+        xmlBufferWriteCHAR(buf, elem->prefix);\n+        xmlBufferWriteChar(buf, ":");\n     }\n     xmlBufferWriteCHAR(buf, elem->name);\n     xmlBufferWriteChar(buf, " ANY>\\n");\n@@ -1689,8 +1690,8 @@\n case XML_ELEMENT_TYPE_MIXED:\n     xmlBufferWriteChar(buf, "<!ELEMENT ");\n     if (elem->prefix != NULL) {\n-xmlBufferWriteCHAR(buf, elem->prefix);\n-xmlBufferWriteChar(buf, ":");\n+        xmlBufferWriteCHAR(buf, elem->prefix);\n+        xmlBufferWriteChar(buf, ":");\n     }\n     xmlBufferWriteCHAR(buf, elem->name);\n     xmlBufferWriteChar(buf, " ");\n@@ -1700,13 +1701,17 @@\n case XML_ELEMENT_TYPE_ELEMENT:\n     xmlBufferWriteChar(buf, "<!ELEMENT ");\n     if (elem->prefix != NULL) {\n-xmlBufferWriteCHAR(buf, elem->prefix);\n-xmlBufferWriteChar(buf, ":");\n+        xmlBufferWriteCHAR(buf, elem->prefix);\n+        xmlBufferWriteChar(buf, ":");\n     }\n     xmlBufferWriteCHAR(buf, elem->name);\n     xmlBufferWriteChar(buf, " ");\n     xmlDumpElementContent(buf, elem->content, 1);\n-    xmlBufferWriteChar(buf, ">\\n");\n+    if (elem->content != NULL) {\n+        xmlBufferWriteChar(buf, ">\\n");\n+    } else {\n+        xmlBufferWriteChar(buf, ">\\n");  // Avoiding NULL dereference\n+    }\n     break;\n default:\n     xmlErrValid(NULL, XML_ERR_INTERNAL_ERROR,\n@@ -1715,6 +1720,7 @@\n     }\n }\n \n+\n /**\n  * xmlDumpElementDeclScan:\n  * @elem:  An element table\n', 'id': 64, 'location': '/data/vulnloc/libxml2/CVE-2017-5969/src/valid.c:1698:5'}, {'diff': '@@ -1155,6 +1155,7 @@\n  *\n  * This will dump the content of the element table as an XML DTD definition\n  */\n+\n static void\n xmlDumpElementContent(xmlBufferPtr buf, xmlElementContentPtr content, int glob) {\n     if (content == NULL) return;\n@@ -1163,64 +1164,65 @@\n     switch (content->type) {\n         case XML_ELEMENT_CONTENT_PCDATA:\n             xmlBufferWriteChar(buf, "#PCDATA");\n-    break;\n-case XML_ELEMENT_CONTENT_ELEMENT:\n-    if (content->prefix != NULL) {\n-xmlBufferWriteCHAR(buf, content->prefix);\n-xmlBufferWriteChar(buf, ":");\n-    }\n-    xmlBufferWriteCHAR(buf, content->name);\n-    break;\n-case XML_ELEMENT_CONTENT_SEQ:\n-    if ((content->c1->type == XML_ELEMENT_CONTENT_OR) ||\n-        (content->c1->type == XML_ELEMENT_CONTENT_SEQ))\n-xmlDumpElementContent(buf, content->c1, 1);\n-    else\n-xmlDumpElementContent(buf, content->c1, 0);\n+        break;\n+        case XML_ELEMENT_CONTENT_ELEMENT:\n+            if (content->prefix != NULL) {\n+                xmlBufferWriteCHAR(buf, content->prefix);\n+                xmlBufferWriteChar(buf, ":");\n+            }\n+            xmlBufferWriteCHAR(buf, content->name);\n+            break;\n+        case XML_ELEMENT_CONTENT_SEQ:\n+            if ((content->c1->type == XML_ELEMENT_CONTENT_OR) ||\n+                (content->c1->type == XML_ELEMENT_CONTENT_SEQ))\n+                xmlDumpElementContent(buf, content->c1, 1);\n+            else\n+                xmlDumpElementContent(buf, content->c1, 0);\n             xmlBufferWriteChar(buf, " , ");\n-    if ((content->c2->type == XML_ELEMENT_CONTENT_OR) ||\n-        ((content->c2->type == XML_ELEMENT_CONTENT_SEQ) &&\n- (content->c2->ocur != XML_ELEMENT_CONTENT_ONCE)))\n-xmlDumpElementContent(buf, content->c2, 1);\n-    else\n-xmlDumpElementContent(buf, content->c2, 0);\n-    break;\n-case XML_ELEMENT_CONTENT_OR:\n-    if ((content->c1->type == XML_ELEMENT_CONTENT_OR) ||\n-        (content->c1->type == XML_ELEMENT_CONTENT_SEQ))\n-xmlDumpElementContent(buf, content->c1, 1);\n-    else\n-xmlDumpElementContent(buf, content->c1, 0);\n+            if ((content->c2->type == XML_ELEMENT_CONTENT_OR) ||\n+                ((content->c2->type == XML_ELEMENT_CONTENT_SEQ) &&\n+                (content->c2->ocur != XML_ELEMENT_CONTENT_ONCE)))\n+                xmlDumpElementContent(buf, content->c2, 1);\n+            else\n+                xmlDumpElementContent(buf, content->c2, 0);\n+            break;\n+        case XML_ELEMENT_CONTENT_OR:\n+            if ((content->c1->type == XML_ELEMENT_CONTENT_OR) ||\n+                (content->c1->type == XML_ELEMENT_CONTENT_SEQ))\n+                xmlDumpElementContent(buf, content->c1, 1);\n+            else\n+                xmlDumpElementContent(buf, content->c1, 0);\n             xmlBufferWriteChar(buf, " | ");\n-    if ((content->c2->type == XML_ELEMENT_CONTENT_SEQ) ||\n-        ((content->c2->type == XML_ELEMENT_CONTENT_OR) &&\n- (content->c2->ocur != XML_ELEMENT_CONTENT_ONCE)))\n-xmlDumpElementContent(buf, content->c2, 1);\n-    else\n-xmlDumpElementContent(buf, content->c2, 0);\n-    break;\n-default:\n-    xmlErrValid(NULL, XML_ERR_INTERNAL_ERROR,\n-    "Internal: ELEMENT content corrupted invalid type\\n",\n-    NULL);\n+            if ((content->c2->type == XML_ELEMENT_CONTENT_SEQ) ||\n+                ((content->c2->type == XML_ELEMENT_CONTENT_OR) &&\n+                (content->c2->ocur != XML_ELEMENT_CONTENT_ONCE)))\n+                xmlDumpElementContent(buf, content->c2, 1);\n+            else\n+                xmlDumpElementContent(buf, content->c2, 0);\n+            break;\n+        default:\n+            xmlErrValid(NULL, XML_ERR_INTERNAL_ERROR,\n+                "Internal: ELEMENT content corrupted invalid type\\n",\n+                NULL);\n     }\n     if (glob)\n         xmlBufferWriteChar(buf, ")");\n     switch (content->ocur) {\n         case XML_ELEMENT_CONTENT_ONCE:\n-    break;\n+            break;\n         case XML_ELEMENT_CONTENT_OPT:\n-    xmlBufferWriteChar(buf, "?");\n-    break;\n+            xmlBufferWriteChar(buf, "?");\n+            break;\n         case XML_ELEMENT_CONTENT_MULT:\n-    xmlBufferWriteChar(buf, "*");\n-    break;\n+            xmlBufferWriteChar(buf, "*");\n+            break;\n         case XML_ELEMENT_CONTENT_PLUS:\n-    xmlBufferWriteChar(buf, "+");\n-    break;\n+            xmlBufferWriteChar(buf, "+");\n+            break;\n     }\n }\n \n+\n /**\n  * xmlSprintfElementContent:\n  * @buf:  an output buffer\n', 'id': 65, 'location': '/data/vulnloc/libxml2/CVE-2017-5969/src/valid.c:1216:5'}, {'diff': '@@ -1155,6 +1155,7 @@\n  *\n  * This will dump the content of the element table as an XML DTD definition\n  */\n+\n static void\n xmlDumpElementContent(xmlBufferPtr buf, xmlElementContentPtr content, int glob) {\n     if (content == NULL) return;\n@@ -1163,64 +1164,65 @@\n     switch (content->type) {\n         case XML_ELEMENT_CONTENT_PCDATA:\n             xmlBufferWriteChar(buf, "#PCDATA");\n-    break;\n-case XML_ELEMENT_CONTENT_ELEMENT:\n-    if (content->prefix != NULL) {\n-xmlBufferWriteCHAR(buf, content->prefix);\n-xmlBufferWriteChar(buf, ":");\n-    }\n-    xmlBufferWriteCHAR(buf, content->name);\n-    break;\n-case XML_ELEMENT_CONTENT_SEQ:\n-    if ((content->c1->type == XML_ELEMENT_CONTENT_OR) ||\n-        (content->c1->type == XML_ELEMENT_CONTENT_SEQ))\n-xmlDumpElementContent(buf, content->c1, 1);\n-    else\n-xmlDumpElementContent(buf, content->c1, 0);\n+            break;\n+        case XML_ELEMENT_CONTENT_ELEMENT:\n+            if (content->prefix != NULL) {\n+                xmlBufferWriteCHAR(buf, content->prefix);\n+                xmlBufferWriteChar(buf, ":");\n+            }\n+            xmlBufferWriteCHAR(buf, content->name);\n+            break;\n+        case XML_ELEMENT_CONTENT_SEQ:\n+            if ((content->c1->type == XML_ELEMENT_CONTENT_OR) ||\n+                (content->c1->type == XML_ELEMENT_CONTENT_SEQ))\n+                xmlDumpElementContent(buf, content->c1, 1);\n+            else\n+                xmlDumpElementContent(buf, content->c1, 0);\n             xmlBufferWriteChar(buf, " , ");\n-    if ((content->c2->type == XML_ELEMENT_CONTENT_OR) ||\n-        ((content->c2->type == XML_ELEMENT_CONTENT_SEQ) &&\n- (content->c2->ocur != XML_ELEMENT_CONTENT_ONCE)))\n-xmlDumpElementContent(buf, content->c2, 1);\n-    else\n-xmlDumpElementContent(buf, content->c2, 0);\n-    break;\n-case XML_ELEMENT_CONTENT_OR:\n-    if ((content->c1->type == XML_ELEMENT_CONTENT_OR) ||\n-        (content->c1->type == XML_ELEMENT_CONTENT_SEQ))\n-xmlDumpElementContent(buf, content->c1, 1);\n-    else\n-xmlDumpElementContent(buf, content->c1, 0);\n+            if ((content->c2->type == XML_ELEMENT_CONTENT_OR) ||\n+                ((content->c2->type == XML_ELEMENT_CONTENT_SEQ) &&\n+                 (content->c2->ocur != XML_ELEMENT_CONTENT_ONCE)))\n+                xmlDumpElementContent(buf, content->c2, 1);\n+            else\n+                xmlDumpElementContent(buf, content->c2, 0);\n+            break;\n+        case XML_ELEMENT_CONTENT_OR:\n+            if ((content->c1->type == XML_ELEMENT_CONTENT_OR) ||\n+                (content->c1->type == XML_ELEMENT_CONTENT_SEQ))\n+                xmlDumpElementContent(buf, content->c1, 1);\n+            else\n+                xmlDumpElementContent(buf, content->c1, 0);\n             xmlBufferWriteChar(buf, " | ");\n-    if ((content->c2->type == XML_ELEMENT_CONTENT_SEQ) ||\n-        ((content->c2->type == XML_ELEMENT_CONTENT_OR) &&\n- (content->c2->ocur != XML_ELEMENT_CONTENT_ONCE)))\n-xmlDumpElementContent(buf, content->c2, 1);\n-    else\n-xmlDumpElementContent(buf, content->c2, 0);\n-    break;\n-default:\n-    xmlErrValid(NULL, XML_ERR_INTERNAL_ERROR,\n-    "Internal: ELEMENT content corrupted invalid type\\n",\n-    NULL);\n+            if ((content->c2->type == XML_ELEMENT_CONTENT_SEQ) ||\n+                ((content->c2->type == XML_ELEMENT_CONTENT_OR) &&\n+                 (content->c2->ocur != XML_ELEMENT_CONTENT_ONCE)))\n+                xmlDumpElementContent(buf, content->c2, 1);\n+            else\n+                xmlDumpElementContent(buf, content->c2, 0);\n+            break;\n+        default:\n+            xmlErrValid(NULL, XML_ERR_INTERNAL_ERROR,\n+                        "Internal: ELEMENT content corrupted invalid type\\n",\n+                        NULL);\n     }\n     if (glob)\n         xmlBufferWriteChar(buf, ")");\n     switch (content->ocur) {\n         case XML_ELEMENT_CONTENT_ONCE:\n-    break;\n+            break;\n         case XML_ELEMENT_CONTENT_OPT:\n-    xmlBufferWriteChar(buf, "?");\n-    break;\n+            xmlBufferWriteChar(buf, "?");\n+            break;\n         case XML_ELEMENT_CONTENT_MULT:\n-    xmlBufferWriteChar(buf, "*");\n-    break;\n+            xmlBufferWriteChar(buf, "*");\n+            break;\n         case XML_ELEMENT_CONTENT_PLUS:\n-    xmlBufferWriteChar(buf, "+");\n-    break;\n+            xmlBufferWriteChar(buf, "+");\n+            break;\n     }\n }\n \n+\n /**\n  * xmlSprintfElementContent:\n  * @buf:  an output buffer\n', 'id': 66, 'location': '/data/vulnloc/libxml2/CVE-2017-5969/src/valid.c:1216:5'}, {'diff': '@@ -1155,6 +1155,7 @@\n  *\n  * This will dump the content of the element table as an XML DTD definition\n  */\n+\n static void\n xmlDumpElementContent(xmlBufferPtr buf, xmlElementContentPtr content, int glob) {\n     if (content == NULL) return;\n@@ -1163,64 +1164,65 @@\n     switch (content->type) {\n         case XML_ELEMENT_CONTENT_PCDATA:\n             xmlBufferWriteChar(buf, "#PCDATA");\n-    break;\n-case XML_ELEMENT_CONTENT_ELEMENT:\n-    if (content->prefix != NULL) {\n-xmlBufferWriteCHAR(buf, content->prefix);\n-xmlBufferWriteChar(buf, ":");\n-    }\n-    xmlBufferWriteCHAR(buf, content->name);\n-    break;\n-case XML_ELEMENT_CONTENT_SEQ:\n-    if ((content->c1->type == XML_ELEMENT_CONTENT_OR) ||\n-        (content->c1->type == XML_ELEMENT_CONTENT_SEQ))\n-xmlDumpElementContent(buf, content->c1, 1);\n-    else\n-xmlDumpElementContent(buf, content->c1, 0);\n+            break;\n+        case XML_ELEMENT_CONTENT_ELEMENT:\n+            if (content->prefix != NULL) {\n+                xmlBufferWriteCHAR(buf, content->prefix);\n+                xmlBufferWriteChar(buf, ":");\n+            }\n+            xmlBufferWriteCHAR(buf, content->name);\n+            break;\n+        case XML_ELEMENT_CONTENT_SEQ:\n+            if ((content->c1->type == XML_ELEMENT_CONTENT_OR) ||\n+                (content->c1->type == XML_ELEMENT_CONTENT_SEQ))\n+                xmlDumpElementContent(buf, content->c1, 1);\n+            else\n+                xmlDumpElementContent(buf, content->c1, 0);\n             xmlBufferWriteChar(buf, " , ");\n-    if ((content->c2->type == XML_ELEMENT_CONTENT_OR) ||\n-        ((content->c2->type == XML_ELEMENT_CONTENT_SEQ) &&\n- (content->c2->ocur != XML_ELEMENT_CONTENT_ONCE)))\n-xmlDumpElementContent(buf, content->c2, 1);\n-    else\n-xmlDumpElementContent(buf, content->c2, 0);\n-    break;\n-case XML_ELEMENT_CONTENT_OR:\n-    if ((content->c1->type == XML_ELEMENT_CONTENT_OR) ||\n-        (content->c1->type == XML_ELEMENT_CONTENT_SEQ))\n-xmlDumpElementContent(buf, content->c1, 1);\n-    else\n-xmlDumpElementContent(buf, content->c1, 0);\n+            if ((content->c2->type == XML_ELEMENT_CONTENT_OR) ||\n+                ((content->c2->type == XML_ELEMENT_CONTENT_SEQ) &&\n+                (content->c2->ocur != XML_ELEMENT_CONTENT_ONCE)))\n+                xmlDumpElementContent(buf, content->c2, 1);\n+            else\n+                xmlDumpElementContent(buf, content->c2, 0);\n+            break;\n+        case XML_ELEMENT_CONTENT_OR:\n+            if ((content->c1->type == XML_ELEMENT_CONTENT_OR) ||\n+                (content->c1->type == XML_ELEMENT_CONTENT_SEQ))\n+                xmlDumpElementContent(buf, content->c1, 1);\n+            else\n+                xmlDumpElementContent(buf, content->c1, 0);\n             xmlBufferWriteChar(buf, " | ");\n-    if ((content->c2->type == XML_ELEMENT_CONTENT_SEQ) ||\n-        ((content->c2->type == XML_ELEMENT_CONTENT_OR) &&\n- (content->c2->ocur != XML_ELEMENT_CONTENT_ONCE)))\n-xmlDumpElementContent(buf, content->c2, 1);\n-    else\n-xmlDumpElementContent(buf, content->c2, 0);\n-    break;\n-default:\n-    xmlErrValid(NULL, XML_ERR_INTERNAL_ERROR,\n-    "Internal: ELEMENT content corrupted invalid type\\n",\n-    NULL);\n+            if ((content->c2->type == XML_ELEMENT_CONTENT_SEQ) ||\n+                ((content->c2->type == XML_ELEMENT_CONTENT_OR) &&\n+                (content->c2->ocur != XML_ELEMENT_CONTENT_ONCE)))\n+                xmlDumpElementContent(buf, content->c2, 1);\n+            else\n+                xmlDumpElementContent(buf, content->c2, 0);\n+            break;\n+        default:\n+            xmlErrValid(NULL, XML_ERR_INTERNAL_ERROR,\n+            "Internal: ELEMENT content corrupted invalid type\\n",\n+            NULL);\n     }\n     if (glob)\n         xmlBufferWriteChar(buf, ")");\n     switch (content->ocur) {\n         case XML_ELEMENT_CONTENT_ONCE:\n-    break;\n+            break;\n         case XML_ELEMENT_CONTENT_OPT:\n-    xmlBufferWriteChar(buf, "?");\n-    break;\n+            xmlBufferWriteChar(buf, "?");\n+            break;\n         case XML_ELEMENT_CONTENT_MULT:\n-    xmlBufferWriteChar(buf, "*");\n-    break;\n+            xmlBufferWriteChar(buf, "*");\n+            break;\n         case XML_ELEMENT_CONTENT_PLUS:\n-    xmlBufferWriteChar(buf, "+");\n-    break;\n+            xmlBufferWriteChar(buf, "+");\n+            break;\n     }\n }\n \n+\n /**\n  * xmlSprintfElementContent:\n  * @buf:  an output buffer\n', 'id': 67, 'location': '/data/vulnloc/libxml2/CVE-2017-5969/src/valid.c:1216:5'}, {'diff': '@@ -1155,6 +1155,7 @@\n  *\n  * This will dump the content of the element table as an XML DTD definition\n  */\n+\n static void\n xmlDumpElementContent(xmlBufferPtr buf, xmlElementContentPtr content, int glob) {\n     if (content == NULL) return;\n@@ -1163,64 +1164,65 @@\n     switch (content->type) {\n         case XML_ELEMENT_CONTENT_PCDATA:\n             xmlBufferWriteChar(buf, "#PCDATA");\n-    break;\n-case XML_ELEMENT_CONTENT_ELEMENT:\n-    if (content->prefix != NULL) {\n-xmlBufferWriteCHAR(buf, content->prefix);\n-xmlBufferWriteChar(buf, ":");\n-    }\n-    xmlBufferWriteCHAR(buf, content->name);\n-    break;\n-case XML_ELEMENT_CONTENT_SEQ:\n-    if ((content->c1->type == XML_ELEMENT_CONTENT_OR) ||\n-        (content->c1->type == XML_ELEMENT_CONTENT_SEQ))\n-xmlDumpElementContent(buf, content->c1, 1);\n-    else\n-xmlDumpElementContent(buf, content->c1, 0);\n+            break;\n+        case XML_ELEMENT_CONTENT_ELEMENT:\n+            if (content->prefix != NULL) {\n+                xmlBufferWriteCHAR(buf, content->prefix);\n+                xmlBufferWriteChar(buf, ":");\n+            }\n+            xmlBufferWriteCHAR(buf, content->name);\n+            break;\n+        case XML_ELEMENT_CONTENT_SEQ:\n+            if ((content->c1->type == XML_ELEMENT_CONTENT_OR) ||\n+                (content->c1->type == XML_ELEMENT_CONTENT_SEQ))\n+                xmlDumpElementContent(buf, content->c1, 1);\n+            else\n+                xmlDumpElementContent(buf, content->c1, 0);\n             xmlBufferWriteChar(buf, " , ");\n-    if ((content->c2->type == XML_ELEMENT_CONTENT_OR) ||\n-        ((content->c2->type == XML_ELEMENT_CONTENT_SEQ) &&\n- (content->c2->ocur != XML_ELEMENT_CONTENT_ONCE)))\n-xmlDumpElementContent(buf, content->c2, 1);\n-    else\n-xmlDumpElementContent(buf, content->c2, 0);\n-    break;\n-case XML_ELEMENT_CONTENT_OR:\n-    if ((content->c1->type == XML_ELEMENT_CONTENT_OR) ||\n-        (content->c1->type == XML_ELEMENT_CONTENT_SEQ))\n-xmlDumpElementContent(buf, content->c1, 1);\n-    else\n-xmlDumpElementContent(buf, content->c1, 0);\n+            if ((content->c2->type == XML_ELEMENT_CONTENT_OR) ||\n+                ((content->c2->type == XML_ELEMENT_CONTENT_SEQ) &&\n+                (content->c2->ocur != XML_ELEMENT_CONTENT_ONCE)))\n+                xmlDumpElementContent(buf, content->c2, 1);\n+            else\n+                xmlDumpElementContent(buf, content->c2, 0);\n+            break;\n+        case XML_ELEMENT_CONTENT_OR:\n+            if ((content->c1->type == XML_ELEMENT_CONTENT_OR) ||\n+                (content->c1->type == XML_ELEMENT_CONTENT_SEQ))\n+                xmlDumpElementContent(buf, content->c1, 1);\n+            else\n+                xmlDumpElementContent(buf, content->c1, 0);\n             xmlBufferWriteChar(buf, " | ");\n-    if ((content->c2->type == XML_ELEMENT_CONTENT_SEQ) ||\n-        ((content->c2->type == XML_ELEMENT_CONTENT_OR) &&\n- (content->c2->ocur != XML_ELEMENT_CONTENT_ONCE)))\n-xmlDumpElementContent(buf, content->c2, 1);\n-    else\n-xmlDumpElementContent(buf, content->c2, 0);\n-    break;\n-default:\n-    xmlErrValid(NULL, XML_ERR_INTERNAL_ERROR,\n-    "Internal: ELEMENT content corrupted invalid type\\n",\n-    NULL);\n+            if ((content->c2->type == XML_ELEMENT_CONTENT_SEQ) ||\n+                ((content->c2->type == XML_ELEMENT_CONTENT_OR) &&\n+                (content->c2->ocur != XML_ELEMENT_CONTENT_ONCE)))\n+                xmlDumpElementContent(buf, content->c2, 1);\n+            else\n+                xmlDumpElementContent(buf, content->c2, 0);\n+            break;\n+        default:\n+            xmlErrValid(NULL, XML_ERR_INTERNAL_ERROR,\n+            "Internal: ELEMENT content corrupted invalid type\\n",\n+            NULL);\n     }\n     if (glob)\n         xmlBufferWriteChar(buf, ")");\n     switch (content->ocur) {\n         case XML_ELEMENT_CONTENT_ONCE:\n-    break;\n+            break;\n         case XML_ELEMENT_CONTENT_OPT:\n-    xmlBufferWriteChar(buf, "?");\n-    break;\n+            xmlBufferWriteChar(buf, "?");\n+            break;\n         case XML_ELEMENT_CONTENT_MULT:\n-    xmlBufferWriteChar(buf, "*");\n-    break;\n+            xmlBufferWriteChar(buf, "*");\n+            break;\n         case XML_ELEMENT_CONTENT_PLUS:\n-    xmlBufferWriteChar(buf, "+");\n-    break;\n+            xmlBufferWriteChar(buf, "+");\n+            break;\n     }\n }\n \n+\n /**\n  * xmlSprintfElementContent:\n  * @buf:  an output buffer\n', 'id': 68, 'location': '/data/vulnloc/libxml2/CVE-2017-5969/src/valid.c:1216:5'}, {'diff': '@@ -1155,6 +1155,7 @@\n  *\n  * This will dump the content of the element table as an XML DTD definition\n  */\n+\n static void\n xmlDumpElementContent(xmlBufferPtr buf, xmlElementContentPtr content, int glob) {\n     if (content == NULL) return;\n@@ -1163,64 +1164,66 @@\n     switch (content->type) {\n         case XML_ELEMENT_CONTENT_PCDATA:\n             xmlBufferWriteChar(buf, "#PCDATA");\n-    break;\n-case XML_ELEMENT_CONTENT_ELEMENT:\n-    if (content->prefix != NULL) {\n-xmlBufferWriteCHAR(buf, content->prefix);\n-xmlBufferWriteChar(buf, ":");\n-    }\n-    xmlBufferWriteCHAR(buf, content->name);\n-    break;\n-case XML_ELEMENT_CONTENT_SEQ:\n-    if ((content->c1->type == XML_ELEMENT_CONTENT_OR) ||\n-        (content->c1->type == XML_ELEMENT_CONTENT_SEQ))\n-xmlDumpElementContent(buf, content->c1, 1);\n-    else\n-xmlDumpElementContent(buf, content->c1, 0);\n+            break;\n+        case XML_ELEMENT_CONTENT_ELEMENT:\n+            if (content->prefix != NULL) {\n+                xmlBufferWriteCHAR(buf, content->prefix);\n+                xmlBufferWriteChar(buf, ":");\n+            }\n+            xmlBufferWriteCHAR(buf, content->name);\n+            break;\n+        case XML_ELEMENT_CONTENT_SEQ:\n+            if ((content->c1->type == XML_ELEMENT_CONTENT_OR) ||\n+                (content->c1->type == XML_ELEMENT_CONTENT_SEQ))\n+                xmlDumpElementContent(buf, content->c1, 1);\n+            else\n+                xmlDumpElementContent(buf, content->c1, 0);\n             xmlBufferWriteChar(buf, " , ");\n-    if ((content->c2->type == XML_ELEMENT_CONTENT_OR) ||\n-        ((content->c2->type == XML_ELEMENT_CONTENT_SEQ) &&\n- (content->c2->ocur != XML_ELEMENT_CONTENT_ONCE)))\n-xmlDumpElementContent(buf, content->c2, 1);\n-    else\n-xmlDumpElementContent(buf, content->c2, 0);\n-    break;\n-case XML_ELEMENT_CONTENT_OR:\n-    if ((content->c1->type == XML_ELEMENT_CONTENT_OR) ||\n-        (content->c1->type == XML_ELEMENT_CONTENT_SEQ))\n-xmlDumpElementContent(buf, content->c1, 1);\n-    else\n-xmlDumpElementContent(buf, content->c1, 0);\n+            if ((content->c2->type == XML_ELEMENT_CONTENT_OR) ||\n+                ((content->c2->type == XML_ELEMENT_CONTENT_SEQ) &&\n+                (content->c2->ocur != XML_ELEMENT_CONTENT_ONCE)))\n+                xmlDumpElementContent(buf, content->c2, 1);\n+            else\n+                xmlDumpElementContent(buf, content->c2, 0);\n+            break;\n+        case XML_ELEMENT_CONTENT_OR:\n+            if ((content->c1->type == XML_ELEMENT_CONTENT_OR) ||\n+                (content->c1->type == XML_ELEMENT_CONTENT_SEQ))\n+                xmlDumpElementContent(buf, content->c1, 1);\n+            else\n+                xmlDumpElementContent(buf, content->c1, 0);\n             xmlBufferWriteChar(buf, " | ");\n-    if ((content->c2->type == XML_ELEMENT_CONTENT_SEQ) ||\n-        ((content->c2->type == XML_ELEMENT_CONTENT_OR) &&\n- (content->c2->ocur != XML_ELEMENT_CONTENT_ONCE)))\n-xmlDumpElementContent(buf, content->c2, 1);\n-    else\n-xmlDumpElementContent(buf, content->c2, 0);\n-    break;\n-default:\n-    xmlErrValid(NULL, XML_ERR_INTERNAL_ERROR,\n-    "Internal: ELEMENT content corrupted invalid type\\n",\n-    NULL);\n+            if ((content->c2->type == XML_ELEMENT_CONTENT_SEQ) ||\n+                ((content->c2->type == XML_ELEMENT_CONTENT_OR) &&\n+                (content->c2->ocur != XML_ELEMENT_CONTENT_ONCE)))\n+                xmlDumpElementContent(buf, content->c2, 1);\n+            else\n+                xmlDumpElementContent(buf, content->c2, 0);\n+            break;\n+        default:\n+            xmlErrValid(NULL, XML_ERR_INTERNAL_ERROR,\n+            "Internal: ELEMENT content corrupted invalid type\\n",\n+            NULL);\n     }\n     if (glob)\n         xmlBufferWriteChar(buf, ")");\n     switch (content->ocur) {\n         case XML_ELEMENT_CONTENT_ONCE:\n-    break;\n+            break;\n         case XML_ELEMENT_CONTENT_OPT:\n-    xmlBufferWriteChar(buf, "?");\n-    break;\n+            xmlBufferWriteChar(buf, "?");\n+            break;\n         case XML_ELEMENT_CONTENT_MULT:\n-    xmlBufferWriteChar(buf, "*");\n-    break;\n+            if (content->c1->type == XML_ELEMENT_CONTENT_PCDATA) // Ensure valid type before writing\n+                xmlBufferWriteChar(buf, "*");\n+            break;\n         case XML_ELEMENT_CONTENT_PLUS:\n-    xmlBufferWriteChar(buf, "+");\n-    break;\n+            xmlBufferWriteChar(buf, "+");\n+            break;\n     }\n }\n \n+\n /**\n  * xmlSprintfElementContent:\n  * @buf:  an output buffer\n', 'id': 69, 'location': '/data/vulnloc/libxml2/CVE-2017-5969/src/valid.c:1216:5'}, {'diff': '@@ -1155,6 +1155,7 @@\n  *\n  * This will dump the content of the element table as an XML DTD definition\n  */\n+\n static void\n xmlDumpElementContent(xmlBufferPtr buf, xmlElementContentPtr content, int glob) {\n     if (content == NULL) return;\n@@ -1163,64 +1164,69 @@\n     switch (content->type) {\n         case XML_ELEMENT_CONTENT_PCDATA:\n             xmlBufferWriteChar(buf, "#PCDATA");\n-    break;\n-case XML_ELEMENT_CONTENT_ELEMENT:\n-    if (content->prefix != NULL) {\n-xmlBufferWriteCHAR(buf, content->prefix);\n-xmlBufferWriteChar(buf, ":");\n-    }\n-    xmlBufferWriteCHAR(buf, content->name);\n-    break;\n-case XML_ELEMENT_CONTENT_SEQ:\n-    if ((content->c1->type == XML_ELEMENT_CONTENT_OR) ||\n-        (content->c1->type == XML_ELEMENT_CONTENT_SEQ))\n-xmlDumpElementContent(buf, content->c1, 1);\n-    else\n-xmlDumpElementContent(buf, content->c1, 0);\n+            break;\n+        case XML_ELEMENT_CONTENT_ELEMENT:\n+            if (content->prefix != NULL) {\n+                xmlBufferWriteCHAR(buf, content->prefix);\n+                xmlBufferWriteChar(buf, ":");\n+            }\n+            xmlBufferWriteCHAR(buf, content->name);\n+            break;\n+        case XML_ELEMENT_CONTENT_SEQ:\n+            if ((content->c1->type == XML_ELEMENT_CONTENT_OR) ||\n+                (content->c1->type == XML_ELEMENT_CONTENT_SEQ)) {\n+                xmlDumpElementContent(buf, content->c1, 1);\n+            } else {\n+                xmlDumpElementContent(buf, content->c1, 0);\n+            }\n             xmlBufferWriteChar(buf, " , ");\n-    if ((content->c2->type == XML_ELEMENT_CONTENT_OR) ||\n-        ((content->c2->type == XML_ELEMENT_CONTENT_SEQ) &&\n- (content->c2->ocur != XML_ELEMENT_CONTENT_ONCE)))\n-xmlDumpElementContent(buf, content->c2, 1);\n-    else\n-xmlDumpElementContent(buf, content->c2, 0);\n-    break;\n-case XML_ELEMENT_CONTENT_OR:\n-    if ((content->c1->type == XML_ELEMENT_CONTENT_OR) ||\n-        (content->c1->type == XML_ELEMENT_CONTENT_SEQ))\n-xmlDumpElementContent(buf, content->c1, 1);\n-    else\n-xmlDumpElementContent(buf, content->c1, 0);\n+            if ((content->c2->type == XML_ELEMENT_CONTENT_OR) ||\n+                ((content->c2->type == XML_ELEMENT_CONTENT_SEQ) &&\n+                (content->c2->ocur != XML_ELEMENT_CONTENT_ONCE))) {\n+                xmlDumpElementContent(buf, content->c2, 1);\n+            } else if (content->c2 != NULL) {\n+                xmlDumpElementContent(buf, content->c2, 0);\n+            }\n+            break;\n+        case XML_ELEMENT_CONTENT_OR:\n+            if ((content->c1->type == XML_ELEMENT_CONTENT_OR) ||\n+                (content->c1->type == XML_ELEMENT_CONTENT_SEQ)) {\n+                xmlDumpElementContent(buf, content->c1, 1);\n+            } else {\n+                xmlDumpElementContent(buf, content->c1, 0);\n+            }\n             xmlBufferWriteChar(buf, " | ");\n-    if ((content->c2->type == XML_ELEMENT_CONTENT_SEQ) ||\n-        ((content->c2->type == XML_ELEMENT_CONTENT_OR) &&\n- (content->c2->ocur != XML_ELEMENT_CONTENT_ONCE)))\n-xmlDumpElementContent(buf, content->c2, 1);\n-    else\n-xmlDumpElementContent(buf, content->c2, 0);\n-    break;\n-default:\n-    xmlErrValid(NULL, XML_ERR_INTERNAL_ERROR,\n-    "Internal: ELEMENT content corrupted invalid type\\n",\n-    NULL);\n+            if ((content->c2->type == XML_ELEMENT_CONTENT_SEQ) ||\n+                ((content->c2->type == XML_ELEMENT_CONTENT_OR) &&\n+                (content->c2->ocur != XML_ELEMENT_CONTENT_ONCE))) {\n+                xmlDumpElementContent(buf, content->c2, 1);\n+            } else if (content->c2 != NULL) {\n+                xmlDumpElementContent(buf, content->c2, 0);\n+            }\n+            break;\n+        default:\n+            xmlErrValid(NULL, XML_ERR_INTERNAL_ERROR,\n+                "Internal: ELEMENT content corrupted invalid type\\n",\n+                NULL);\n     }\n     if (glob)\n         xmlBufferWriteChar(buf, ")");\n     switch (content->ocur) {\n         case XML_ELEMENT_CONTENT_ONCE:\n-    break;\n+            break;\n         case XML_ELEMENT_CONTENT_OPT:\n-    xmlBufferWriteChar(buf, "?");\n-    break;\n+            xmlBufferWriteChar(buf, "?");\n+            break;\n         case XML_ELEMENT_CONTENT_MULT:\n-    xmlBufferWriteChar(buf, "*");\n-    break;\n+            xmlBufferWriteChar(buf, "*");\n+            break;\n         case XML_ELEMENT_CONTENT_PLUS:\n-    xmlBufferWriteChar(buf, "+");\n-    break;\n+            xmlBufferWriteChar(buf, "+");\n+            break;\n     }\n }\n \n+\n /**\n  * xmlSprintfElementContent:\n  * @buf:  an output buffer\n', 'id': 70, 'location': '/data/vulnloc/libxml2/CVE-2017-5969/src/valid.c:1200:1'}, {'diff': '@@ -1155,6 +1155,7 @@\n  *\n  * This will dump the content of the element table as an XML DTD definition\n  */\n+\n static void\n xmlDumpElementContent(xmlBufferPtr buf, xmlElementContentPtr content, int glob) {\n     if (content == NULL) return;\n@@ -1163,64 +1164,65 @@\n     switch (content->type) {\n         case XML_ELEMENT_CONTENT_PCDATA:\n             xmlBufferWriteChar(buf, "#PCDATA");\n-    break;\n-case XML_ELEMENT_CONTENT_ELEMENT:\n-    if (content->prefix != NULL) {\n-xmlBufferWriteCHAR(buf, content->prefix);\n-xmlBufferWriteChar(buf, ":");\n-    }\n-    xmlBufferWriteCHAR(buf, content->name);\n-    break;\n-case XML_ELEMENT_CONTENT_SEQ:\n-    if ((content->c1->type == XML_ELEMENT_CONTENT_OR) ||\n-        (content->c1->type == XML_ELEMENT_CONTENT_SEQ))\n-xmlDumpElementContent(buf, content->c1, 1);\n-    else\n-xmlDumpElementContent(buf, content->c1, 0);\n+            break;\n+        case XML_ELEMENT_CONTENT_ELEMENT:\n+            if (content->prefix != NULL) {\n+                xmlBufferWriteCHAR(buf, content->prefix);\n+                xmlBufferWriteChar(buf, ":");\n+            }\n+            xmlBufferWriteCHAR(buf, content->name);\n+            break;\n+        case XML_ELEMENT_CONTENT_SEQ:\n+            if ((content->c1->type == XML_ELEMENT_CONTENT_OR) ||\n+                (content->c1->type == XML_ELEMENT_CONTENT_SEQ))\n+                xmlDumpElementContent(buf, content->c1, 1);\n+            else\n+                xmlDumpElementContent(buf, content->c1, 0);\n             xmlBufferWriteChar(buf, " , ");\n-    if ((content->c2->type == XML_ELEMENT_CONTENT_OR) ||\n-        ((content->c2->type == XML_ELEMENT_CONTENT_SEQ) &&\n- (content->c2->ocur != XML_ELEMENT_CONTENT_ONCE)))\n-xmlDumpElementContent(buf, content->c2, 1);\n-    else\n-xmlDumpElementContent(buf, content->c2, 0);\n-    break;\n-case XML_ELEMENT_CONTENT_OR:\n-    if ((content->c1->type == XML_ELEMENT_CONTENT_OR) ||\n-        (content->c1->type == XML_ELEMENT_CONTENT_SEQ))\n-xmlDumpElementContent(buf, content->c1, 1);\n-    else\n-xmlDumpElementContent(buf, content->c1, 0);\n+            if ((content->c2->type == XML_ELEMENT_CONTENT_OR) ||\n+                ((content->c2->type == XML_ELEMENT_CONTENT_SEQ) &&\n+                 (content->c2->ocur != XML_ELEMENT_CONTENT_ONCE)))\n+                xmlDumpElementContent(buf, content->c2, 1);\n+            else if (content->c2 != NULL)  // Added check for NULL\n+                xmlDumpElementContent(buf, content->c2, 0);\n+            break;\n+        case XML_ELEMENT_CONTENT_OR:\n+            if ((content->c1->type == XML_ELEMENT_CONTENT_OR) ||\n+                (content->c1->type == XML_ELEMENT_CONTENT_SEQ))\n+                xmlDumpElementContent(buf, content->c1, 1);\n+            else\n+                xmlDumpElementContent(buf, content->c1, 0);\n             xmlBufferWriteChar(buf, " | ");\n-    if ((content->c2->type == XML_ELEMENT_CONTENT_SEQ) ||\n-        ((content->c2->type == XML_ELEMENT_CONTENT_OR) &&\n- (content->c2->ocur != XML_ELEMENT_CONTENT_ONCE)))\n-xmlDumpElementContent(buf, content->c2, 1);\n-    else\n-xmlDumpElementContent(buf, content->c2, 0);\n-    break;\n-default:\n-    xmlErrValid(NULL, XML_ERR_INTERNAL_ERROR,\n-    "Internal: ELEMENT content corrupted invalid type\\n",\n-    NULL);\n+            if ((content->c2->type == XML_ELEMENT_CONTENT_SEQ) ||\n+                ((content->c2->type == XML_ELEMENT_CONTENT_OR) &&\n+                 (content->c2->ocur != XML_ELEMENT_CONTENT_ONCE)))\n+                xmlDumpElementContent(buf, content->c2, 1);\n+            else if (content->c2 != NULL)  // Added check for NULL\n+                xmlDumpElementContent(buf, content->c2, 0);\n+            break;\n+        default:\n+            xmlErrValid(NULL, XML_ERR_INTERNAL_ERROR,\n+                        "Internal: ELEMENT content corrupted invalid type\\n",\n+                        NULL);\n     }\n     if (glob)\n         xmlBufferWriteChar(buf, ")");\n     switch (content->ocur) {\n         case XML_ELEMENT_CONTENT_ONCE:\n-    break;\n+            break;\n         case XML_ELEMENT_CONTENT_OPT:\n-    xmlBufferWriteChar(buf, "?");\n-    break;\n+            xmlBufferWriteChar(buf, "?");\n+            break;\n         case XML_ELEMENT_CONTENT_MULT:\n-    xmlBufferWriteChar(buf, "*");\n-    break;\n+            xmlBufferWriteChar(buf, "*");\n+            break;\n         case XML_ELEMENT_CONTENT_PLUS:\n-    xmlBufferWriteChar(buf, "+");\n-    break;\n+            xmlBufferWriteChar(buf, "+");\n+            break;\n     }\n }\n \n+\n /**\n  * xmlSprintfElementContent:\n  * @buf:  an output buffer\n', 'id': 71, 'location': '/data/vulnloc/libxml2/CVE-2017-5969/src/valid.c:1200:1'}, {'diff': '@@ -1155,6 +1155,7 @@\n  *\n  * This will dump the content of the element table as an XML DTD definition\n  */\n+\n static void\n xmlDumpElementContent(xmlBufferPtr buf, xmlElementContentPtr content, int glob) {\n     if (content == NULL) return;\n@@ -1163,64 +1164,69 @@\n     switch (content->type) {\n         case XML_ELEMENT_CONTENT_PCDATA:\n             xmlBufferWriteChar(buf, "#PCDATA");\n-    break;\n-case XML_ELEMENT_CONTENT_ELEMENT:\n-    if (content->prefix != NULL) {\n-xmlBufferWriteCHAR(buf, content->prefix);\n-xmlBufferWriteChar(buf, ":");\n-    }\n-    xmlBufferWriteCHAR(buf, content->name);\n-    break;\n-case XML_ELEMENT_CONTENT_SEQ:\n-    if ((content->c1->type == XML_ELEMENT_CONTENT_OR) ||\n-        (content->c1->type == XML_ELEMENT_CONTENT_SEQ))\n-xmlDumpElementContent(buf, content->c1, 1);\n-    else\n-xmlDumpElementContent(buf, content->c1, 0);\n+            break;\n+        case XML_ELEMENT_CONTENT_ELEMENT:\n+            if (content->prefix != NULL) {\n+                xmlBufferWriteCHAR(buf, content->prefix);\n+                xmlBufferWriteChar(buf, ":");\n+            }\n+            xmlBufferWriteCHAR(buf, content->name);\n+            break;\n+        case XML_ELEMENT_CONTENT_SEQ:\n+            if ((content->c1->type == XML_ELEMENT_CONTENT_OR) ||\n+                (content->c1->type == XML_ELEMENT_CONTENT_SEQ)) {\n+                xmlDumpElementContent(buf, content->c1, 1);\n+            } else {\n+                xmlDumpElementContent(buf, content->c1, 0);\n+            }\n             xmlBufferWriteChar(buf, " , ");\n-    if ((content->c2->type == XML_ELEMENT_CONTENT_OR) ||\n-        ((content->c2->type == XML_ELEMENT_CONTENT_SEQ) &&\n- (content->c2->ocur != XML_ELEMENT_CONTENT_ONCE)))\n-xmlDumpElementContent(buf, content->c2, 1);\n-    else\n-xmlDumpElementContent(buf, content->c2, 0);\n-    break;\n-case XML_ELEMENT_CONTENT_OR:\n-    if ((content->c1->type == XML_ELEMENT_CONTENT_OR) ||\n-        (content->c1->type == XML_ELEMENT_CONTENT_SEQ))\n-xmlDumpElementContent(buf, content->c1, 1);\n-    else\n-xmlDumpElementContent(buf, content->c1, 0);\n+            if ((content->c2->type == XML_ELEMENT_CONTENT_OR) ||\n+                ((content->c2->type == XML_ELEMENT_CONTENT_SEQ) &&\n+                (content->c2->ocur != XML_ELEMENT_CONTENT_ONCE))) {\n+                xmlDumpElementContent(buf, content->c2, 1);\n+            } else {\n+                xmlDumpElementContent(buf, content->c2, 0);\n+            }\n+            break;\n+        case XML_ELEMENT_CONTENT_OR:\n+            if ((content->c1->type == XML_ELEMENT_CONTENT_OR) ||\n+                (content->c1->type == XML_ELEMENT_CONTENT_SEQ)) {\n+                xmlDumpElementContent(buf, content->c1, 1);\n+            } else {\n+                xmlDumpElementContent(buf, content->c1, 0);\n+            }\n             xmlBufferWriteChar(buf, " | ");\n-    if ((content->c2->type == XML_ELEMENT_CONTENT_SEQ) ||\n-        ((content->c2->type == XML_ELEMENT_CONTENT_OR) &&\n- (content->c2->ocur != XML_ELEMENT_CONTENT_ONCE)))\n-xmlDumpElementContent(buf, content->c2, 1);\n-    else\n-xmlDumpElementContent(buf, content->c2, 0);\n-    break;\n-default:\n-    xmlErrValid(NULL, XML_ERR_INTERNAL_ERROR,\n-    "Internal: ELEMENT content corrupted invalid type\\n",\n-    NULL);\n+            if ((content->c2->type == XML_ELEMENT_CONTENT_SEQ) ||\n+                ((content->c2->type == XML_ELEMENT_CONTENT_OR) &&\n+                (content->c2->ocur != XML_ELEMENT_CONTENT_ONCE))) {\n+                xmlDumpElementContent(buf, content->c2, 1);\n+            } else {\n+                xmlDumpElementContent(buf, content->c2, 0);\n+            }\n+            break;\n+        default:\n+            xmlErrValid(NULL, XML_ERR_INTERNAL_ERROR,\n+                        "Internal: ELEMENT content corrupted invalid type\\n",\n+                        NULL);\n     }\n     if (glob)\n         xmlBufferWriteChar(buf, ")");\n     switch (content->ocur) {\n         case XML_ELEMENT_CONTENT_ONCE:\n-    break;\n+            break;\n         case XML_ELEMENT_CONTENT_OPT:\n-    xmlBufferWriteChar(buf, "?");\n-    break;\n+            xmlBufferWriteChar(buf, "?");\n+            break;\n         case XML_ELEMENT_CONTENT_MULT:\n-    xmlBufferWriteChar(buf, "*");\n-    break;\n+            xmlBufferWriteChar(buf, "*");\n+            break;\n         case XML_ELEMENT_CONTENT_PLUS:\n-    xmlBufferWriteChar(buf, "+");\n-    break;\n+            xmlBufferWriteChar(buf, "+");\n+            break;\n     }\n }\n \n+\n /**\n  * xmlSprintfElementContent:\n  * @buf:  an output buffer\n', 'id': 72, 'location': '/data/vulnloc/libxml2/CVE-2017-5969/src/valid.c:1200:1'}, {'diff': '@@ -1155,6 +1155,7 @@\n  *\n  * This will dump the content of the element table as an XML DTD definition\n  */\n+\n static void\n xmlDumpElementContent(xmlBufferPtr buf, xmlElementContentPtr content, int glob) {\n     if (content == NULL) return;\n@@ -1163,64 +1164,65 @@\n     switch (content->type) {\n         case XML_ELEMENT_CONTENT_PCDATA:\n             xmlBufferWriteChar(buf, "#PCDATA");\n-    break;\n-case XML_ELEMENT_CONTENT_ELEMENT:\n-    if (content->prefix != NULL) {\n-xmlBufferWriteCHAR(buf, content->prefix);\n-xmlBufferWriteChar(buf, ":");\n-    }\n-    xmlBufferWriteCHAR(buf, content->name);\n-    break;\n-case XML_ELEMENT_CONTENT_SEQ:\n-    if ((content->c1->type == XML_ELEMENT_CONTENT_OR) ||\n-        (content->c1->type == XML_ELEMENT_CONTENT_SEQ))\n-xmlDumpElementContent(buf, content->c1, 1);\n-    else\n-xmlDumpElementContent(buf, content->c1, 0);\n+            break;\n+        case XML_ELEMENT_CONTENT_ELEMENT:\n+            if (content->prefix != NULL) {\n+                xmlBufferWriteCHAR(buf, content->prefix);\n+                xmlBufferWriteChar(buf, ":");\n+            }\n+            xmlBufferWriteCHAR(buf, content->name);\n+            break;\n+        case XML_ELEMENT_CONTENT_SEQ:\n+            if ((content->c1->type == XML_ELEMENT_CONTENT_OR) ||\n+                (content->c1->type == XML_ELEMENT_CONTENT_SEQ))\n+                xmlDumpElementContent(buf, content->c1, 1);\n+            else\n+                xmlDumpElementContent(buf, content->c1, 0);\n             xmlBufferWriteChar(buf, " , ");\n-    if ((content->c2->type == XML_ELEMENT_CONTENT_OR) ||\n-        ((content->c2->type == XML_ELEMENT_CONTENT_SEQ) &&\n- (content->c2->ocur != XML_ELEMENT_CONTENT_ONCE)))\n-xmlDumpElementContent(buf, content->c2, 1);\n-    else\n-xmlDumpElementContent(buf, content->c2, 0);\n-    break;\n-case XML_ELEMENT_CONTENT_OR:\n-    if ((content->c1->type == XML_ELEMENT_CONTENT_OR) ||\n-        (content->c1->type == XML_ELEMENT_CONTENT_SEQ))\n-xmlDumpElementContent(buf, content->c1, 1);\n-    else\n-xmlDumpElementContent(buf, content->c1, 0);\n+            if ((content->c2->type == XML_ELEMENT_CONTENT_OR) ||\n+                ((content->c2->type == XML_ELEMENT_CONTENT_SEQ) &&\n+                (content->c2->ocur != XML_ELEMENT_CONTENT_ONCE)))\n+                xmlDumpElementContent(buf, content->c2, 1);\n+            else \n+                xmlDumpElementContent(buf, content->c2, 0);\n+            break;\n+        case XML_ELEMENT_CONTENT_OR:\n+            if ((content->c1->type == XML_ELEMENT_CONTENT_OR) ||\n+                (content->c1->type == XML_ELEMENT_CONTENT_SEQ))\n+                xmlDumpElementContent(buf, content->c1, 1);\n+            else\n+                xmlDumpElementContent(buf, content->c1, 0);\n             xmlBufferWriteChar(buf, " | ");\n-    if ((content->c2->type == XML_ELEMENT_CONTENT_SEQ) ||\n-        ((content->c2->type == XML_ELEMENT_CONTENT_OR) &&\n- (content->c2->ocur != XML_ELEMENT_CONTENT_ONCE)))\n-xmlDumpElementContent(buf, content->c2, 1);\n-    else\n-xmlDumpElementContent(buf, content->c2, 0);\n-    break;\n-default:\n-    xmlErrValid(NULL, XML_ERR_INTERNAL_ERROR,\n-    "Internal: ELEMENT content corrupted invalid type\\n",\n-    NULL);\n+            if ((content->c2->type == XML_ELEMENT_CONTENT_SEQ) ||\n+                ((content->c2->type == XML_ELEMENT_CONTENT_OR) &&\n+                (content->c2->ocur != XML_ELEMENT_CONTENT_ONCE)))\n+                xmlDumpElementContent(buf, content->c2, 1);\n+            else\n+                xmlDumpElementContent(buf, content->c2, 0);\n+            break;\n+        default:\n+            xmlErrValid(NULL, XML_ERR_INTERNAL_ERROR,\n+            "Internal: ELEMENT content corrupted invalid type\\n",\n+            NULL);\n     }\n     if (glob)\n         xmlBufferWriteChar(buf, ")");\n     switch (content->ocur) {\n         case XML_ELEMENT_CONTENT_ONCE:\n-    break;\n+            break;\n         case XML_ELEMENT_CONTENT_OPT:\n-    xmlBufferWriteChar(buf, "?");\n-    break;\n+            xmlBufferWriteChar(buf, "?");\n+            break;\n         case XML_ELEMENT_CONTENT_MULT:\n-    xmlBufferWriteChar(buf, "*");\n-    break;\n+            xmlBufferWriteChar(buf, "*");\n+            break;\n         case XML_ELEMENT_CONTENT_PLUS:\n-    xmlBufferWriteChar(buf, "+");\n-    break;\n+            xmlBufferWriteChar(buf, "+");\n+            break;\n     }\n }\n \n+\n /**\n  * xmlSprintfElementContent:\n  * @buf:  an output buffer\n', 'id': 73, 'location': '/data/vulnloc/libxml2/CVE-2017-5969/src/valid.c:1200:1'}, {'diff': '@@ -1155,6 +1155,7 @@\n  *\n  * This will dump the content of the element table as an XML DTD definition\n  */\n+\n static void\n xmlDumpElementContent(xmlBufferPtr buf, xmlElementContentPtr content, int glob) {\n     if (content == NULL) return;\n@@ -1163,64 +1164,69 @@\n     switch (content->type) {\n         case XML_ELEMENT_CONTENT_PCDATA:\n             xmlBufferWriteChar(buf, "#PCDATA");\n-    break;\n-case XML_ELEMENT_CONTENT_ELEMENT:\n-    if (content->prefix != NULL) {\n-xmlBufferWriteCHAR(buf, content->prefix);\n-xmlBufferWriteChar(buf, ":");\n-    }\n-    xmlBufferWriteCHAR(buf, content->name);\n-    break;\n-case XML_ELEMENT_CONTENT_SEQ:\n-    if ((content->c1->type == XML_ELEMENT_CONTENT_OR) ||\n-        (content->c1->type == XML_ELEMENT_CONTENT_SEQ))\n-xmlDumpElementContent(buf, content->c1, 1);\n-    else\n-xmlDumpElementContent(buf, content->c1, 0);\n+            break;\n+        case XML_ELEMENT_CONTENT_ELEMENT:\n+            if (content->prefix != NULL) {\n+                xmlBufferWriteCHAR(buf, content->prefix);\n+                xmlBufferWriteChar(buf, ":");\n+            }\n+            xmlBufferWriteCHAR(buf, content->name);\n+            break;\n+        case XML_ELEMENT_CONTENT_SEQ:\n+            if ((content->c1->type == XML_ELEMENT_CONTENT_OR) ||\n+                (content->c1->type == XML_ELEMENT_CONTENT_SEQ)) {\n+                xmlDumpElementContent(buf, content->c1, 1);\n+            } else {\n+                xmlDumpElementContent(buf, content->c1, 0);\n+            }\n             xmlBufferWriteChar(buf, " , ");\n-    if ((content->c2->type == XML_ELEMENT_CONTENT_OR) ||\n-        ((content->c2->type == XML_ELEMENT_CONTENT_SEQ) &&\n- (content->c2->ocur != XML_ELEMENT_CONTENT_ONCE)))\n-xmlDumpElementContent(buf, content->c2, 1);\n-    else\n-xmlDumpElementContent(buf, content->c2, 0);\n-    break;\n-case XML_ELEMENT_CONTENT_OR:\n-    if ((content->c1->type == XML_ELEMENT_CONTENT_OR) ||\n-        (content->c1->type == XML_ELEMENT_CONTENT_SEQ))\n-xmlDumpElementContent(buf, content->c1, 1);\n-    else\n-xmlDumpElementContent(buf, content->c1, 0);\n+            if ((content->c2->type == XML_ELEMENT_CONTENT_OR) ||\n+                ((content->c2->type == XML_ELEMENT_CONTENT_SEQ) &&\n+                (content->c2->ocur != XML_ELEMENT_CONTENT_ONCE))) {\n+                xmlDumpElementContent(buf, content->c2, 1);\n+            } else {\n+                xmlDumpElementContent(buf, content->c2, 0);\n+            }\n+            break;\n+        case XML_ELEMENT_CONTENT_OR:\n+            if ((content->c1->type == XML_ELEMENT_CONTENT_OR) ||\n+                (content->c1->type == XML_ELEMENT_CONTENT_SEQ)) {\n+                xmlDumpElementContent(buf, content->c1, 1);\n+            } else {\n+                xmlDumpElementContent(buf, content->c1, 0);\n+            }\n             xmlBufferWriteChar(buf, " | ");\n-    if ((content->c2->type == XML_ELEMENT_CONTENT_SEQ) ||\n-        ((content->c2->type == XML_ELEMENT_CONTENT_OR) &&\n- (content->c2->ocur != XML_ELEMENT_CONTENT_ONCE)))\n-xmlDumpElementContent(buf, content->c2, 1);\n-    else\n-xmlDumpElementContent(buf, content->c2, 0);\n-    break;\n-default:\n-    xmlErrValid(NULL, XML_ERR_INTERNAL_ERROR,\n-    "Internal: ELEMENT content corrupted invalid type\\n",\n-    NULL);\n+            if ((content->c2->type == XML_ELEMENT_CONTENT_SEQ) ||\n+                ((content->c2->type == XML_ELEMENT_CONTENT_OR) &&\n+                (content->c2->ocur != XML_ELEMENT_CONTENT_ONCE))) {\n+                xmlDumpElementContent(buf, content->c2, 1);\n+            } else {\n+                xmlDumpElementContent(buf, content->c2, 0);\n+            }\n+            break;\n+        default:\n+            xmlErrValid(NULL, XML_ERR_INTERNAL_ERROR,\n+            "Internal: ELEMENT content corrupted invalid type\\n",\n+            NULL);\n     }\n     if (glob)\n         xmlBufferWriteChar(buf, ")");\n     switch (content->ocur) {\n         case XML_ELEMENT_CONTENT_ONCE:\n-    break;\n+            break;\n         case XML_ELEMENT_CONTENT_OPT:\n-    xmlBufferWriteChar(buf, "?");\n-    break;\n+            xmlBufferWriteChar(buf, "?");\n+            break;\n         case XML_ELEMENT_CONTENT_MULT:\n-    xmlBufferWriteChar(buf, "*");\n-    break;\n+            xmlBufferWriteChar(buf, "*");\n+            break;\n         case XML_ELEMENT_CONTENT_PLUS:\n-    xmlBufferWriteChar(buf, "+");\n-    break;\n+            xmlBufferWriteChar(buf, "+");\n+            break;\n     }\n }\n \n+\n /**\n  * xmlSprintfElementContent:\n  * @buf:  an output buffer\n', 'id': 74, 'location': '/data/vulnloc/libxml2/CVE-2017-5969/src/valid.c:1200:1'}, {'diff': '@@ -1155,6 +1155,7 @@\n  *\n  * This will dump the content of the element table as an XML DTD definition\n  */\n+\n static void\n xmlDumpElementContent(xmlBufferPtr buf, xmlElementContentPtr content, int glob) {\n     if (content == NULL) return;\n@@ -1163,64 +1164,67 @@\n     switch (content->type) {\n         case XML_ELEMENT_CONTENT_PCDATA:\n             xmlBufferWriteChar(buf, "#PCDATA");\n-    break;\n-case XML_ELEMENT_CONTENT_ELEMENT:\n-    if (content->prefix != NULL) {\n-xmlBufferWriteCHAR(buf, content->prefix);\n-xmlBufferWriteChar(buf, ":");\n-    }\n-    xmlBufferWriteCHAR(buf, content->name);\n-    break;\n-case XML_ELEMENT_CONTENT_SEQ:\n-    if ((content->c1->type == XML_ELEMENT_CONTENT_OR) ||\n-        (content->c1->type == XML_ELEMENT_CONTENT_SEQ))\n-xmlDumpElementContent(buf, content->c1, 1);\n-    else\n-xmlDumpElementContent(buf, content->c1, 0);\n+            break;\n+        case XML_ELEMENT_CONTENT_ELEMENT:\n+            if (content->prefix != NULL) {\n+                xmlBufferWriteCHAR(buf, content->prefix);\n+                xmlBufferWriteChar(buf, ":");\n+            }\n+            xmlBufferWriteCHAR(buf, content->name);\n+            break;\n+        case XML_ELEMENT_CONTENT_SEQ:\n+            if ((content->c1->type == XML_ELEMENT_CONTENT_OR) ||\n+                (content->c1->type == XML_ELEMENT_CONTENT_SEQ))\n+                xmlDumpElementContent(buf, content->c1, 1);\n+            else\n+                xmlDumpElementContent(buf, content->c1, 0);\n             xmlBufferWriteChar(buf, " , ");\n-    if ((content->c2->type == XML_ELEMENT_CONTENT_OR) ||\n-        ((content->c2->type == XML_ELEMENT_CONTENT_SEQ) &&\n- (content->c2->ocur != XML_ELEMENT_CONTENT_ONCE)))\n-xmlDumpElementContent(buf, content->c2, 1);\n-    else\n-xmlDumpElementContent(buf, content->c2, 0);\n-    break;\n-case XML_ELEMENT_CONTENT_OR:\n-    if ((content->c1->type == XML_ELEMENT_CONTENT_OR) ||\n-        (content->c1->type == XML_ELEMENT_CONTENT_SEQ))\n-xmlDumpElementContent(buf, content->c1, 1);\n-    else\n-xmlDumpElementContent(buf, content->c1, 0);\n-            xmlBufferWriteChar(buf, " | ");\n-    if ((content->c2->type == XML_ELEMENT_CONTENT_SEQ) ||\n-        ((content->c2->type == XML_ELEMENT_CONTENT_OR) &&\n- (content->c2->ocur != XML_ELEMENT_CONTENT_ONCE)))\n-xmlDumpElementContent(buf, content->c2, 1);\n-    else\n-xmlDumpElementContent(buf, content->c2, 0);\n-    break;\n-default:\n-    xmlErrValid(NULL, XML_ERR_INTERNAL_ERROR,\n-    "Internal: ELEMENT content corrupted invalid type\\n",\n-    NULL);\n+            if ((content->c2->type == XML_ELEMENT_CONTENT_OR) ||\n+                ((content->c2->type == XML_ELEMENT_CONTENT_SEQ) &&\n+                (content->c2->ocur != XML_ELEMENT_CONTENT_ONCE)))\n+                xmlDumpElementContent(buf, content->c2, 1);\n+            else\n+                xmlDumpElementContent(buf, content->c2, 0);\n+            break;\n+        case XML_ELEMENT_CONTENT_OR:\n+            if ((content->c1->type == XML_ELEMENT_CONTENT_OR) ||\n+                (content->c1->type == XML_ELEMENT_CONTENT_SEQ))\n+                xmlDumpElementContent(buf, content->c1, 1);\n+            else\n+                xmlDumpElementContent(buf, content->c1, 0);\n+            if (content->c2 != NULL) {\n+                xmlBufferWriteChar(buf, " | ");\n+            }\n+            if ((content->c2->type == XML_ELEMENT_CONTENT_SEQ) ||\n+                ((content->c2->type == XML_ELEMENT_CONTENT_OR) &&\n+                (content->c2->ocur != XML_ELEMENT_CONTENT_ONCE)))\n+                xmlDumpElementContent(buf, content->c2, 1);\n+            else\n+                xmlDumpElementContent(buf, content->c2, 0);\n+            break;\n+        default:\n+            xmlErrValid(NULL, XML_ERR_INTERNAL_ERROR,\n+                "Internal: ELEMENT content corrupted invalid type\\n",\n+                NULL);\n     }\n     if (glob)\n         xmlBufferWriteChar(buf, ")");\n     switch (content->ocur) {\n         case XML_ELEMENT_CONTENT_ONCE:\n-    break;\n+            break;\n         case XML_ELEMENT_CONTENT_OPT:\n-    xmlBufferWriteChar(buf, "?");\n-    break;\n+            xmlBufferWriteChar(buf, "?");\n+            break;\n         case XML_ELEMENT_CONTENT_MULT:\n-    xmlBufferWriteChar(buf, "*");\n-    break;\n+            xmlBufferWriteChar(buf, "*");\n+            break;\n         case XML_ELEMENT_CONTENT_PLUS:\n-    xmlBufferWriteChar(buf, "+");\n-    break;\n+            xmlBufferWriteChar(buf, "+");\n+            break;\n     }\n }\n \n+\n /**\n  * xmlSprintfElementContent:\n  * @buf:  an output buffer\n', 'id': 75, 'location': '/data/vulnloc/libxml2/CVE-2017-5969/src/valid.c:1194:13'}, {'diff': '@@ -1155,6 +1155,7 @@\n  *\n  * This will dump the content of the element table as an XML DTD definition\n  */\n+\n static void\n xmlDumpElementContent(xmlBufferPtr buf, xmlElementContentPtr content, int glob) {\n     if (content == NULL) return;\n@@ -1163,64 +1164,67 @@\n     switch (content->type) {\n         case XML_ELEMENT_CONTENT_PCDATA:\n             xmlBufferWriteChar(buf, "#PCDATA");\n-    break;\n-case XML_ELEMENT_CONTENT_ELEMENT:\n-    if (content->prefix != NULL) {\n-xmlBufferWriteCHAR(buf, content->prefix);\n-xmlBufferWriteChar(buf, ":");\n-    }\n-    xmlBufferWriteCHAR(buf, content->name);\n-    break;\n-case XML_ELEMENT_CONTENT_SEQ:\n-    if ((content->c1->type == XML_ELEMENT_CONTENT_OR) ||\n-        (content->c1->type == XML_ELEMENT_CONTENT_SEQ))\n-xmlDumpElementContent(buf, content->c1, 1);\n-    else\n-xmlDumpElementContent(buf, content->c1, 0);\n+            break;\n+        case XML_ELEMENT_CONTENT_ELEMENT:\n+            if (content->prefix != NULL) {\n+                xmlBufferWriteCHAR(buf, content->prefix);\n+                xmlBufferWriteChar(buf, ":");\n+            }\n+            xmlBufferWriteCHAR(buf, content->name);\n+            break;\n+        case XML_ELEMENT_CONTENT_SEQ:\n+            if ((content->c1->type == XML_ELEMENT_CONTENT_OR) ||\n+                (content->c1->type == XML_ELEMENT_CONTENT_SEQ))\n+                xmlDumpElementContent(buf, content->c1, 1);\n+            else\n+                xmlDumpElementContent(buf, content->c1, 0);\n             xmlBufferWriteChar(buf, " , ");\n-    if ((content->c2->type == XML_ELEMENT_CONTENT_OR) ||\n-        ((content->c2->type == XML_ELEMENT_CONTENT_SEQ) &&\n- (content->c2->ocur != XML_ELEMENT_CONTENT_ONCE)))\n-xmlDumpElementContent(buf, content->c2, 1);\n-    else\n-xmlDumpElementContent(buf, content->c2, 0);\n-    break;\n-case XML_ELEMENT_CONTENT_OR:\n-    if ((content->c1->type == XML_ELEMENT_CONTENT_OR) ||\n-        (content->c1->type == XML_ELEMENT_CONTENT_SEQ))\n-xmlDumpElementContent(buf, content->c1, 1);\n-    else\n-xmlDumpElementContent(buf, content->c1, 0);\n-            xmlBufferWriteChar(buf, " | ");\n-    if ((content->c2->type == XML_ELEMENT_CONTENT_SEQ) ||\n-        ((content->c2->type == XML_ELEMENT_CONTENT_OR) &&\n- (content->c2->ocur != XML_ELEMENT_CONTENT_ONCE)))\n-xmlDumpElementContent(buf, content->c2, 1);\n-    else\n-xmlDumpElementContent(buf, content->c2, 0);\n-    break;\n-default:\n-    xmlErrValid(NULL, XML_ERR_INTERNAL_ERROR,\n-    "Internal: ELEMENT content corrupted invalid type\\n",\n-    NULL);\n+            if ((content->c2->type == XML_ELEMENT_CONTENT_OR) ||\n+                ((content->c2->type == XML_ELEMENT_CONTENT_SEQ) &&\n+                (content->c2->ocur != XML_ELEMENT_CONTENT_ONCE)))\n+                xmlDumpElementContent(buf, content->c2, 1);\n+            else\n+                xmlDumpElementContent(buf, content->c2, 0);\n+            break;\n+        case XML_ELEMENT_CONTENT_OR:\n+            if ((content->c1->type == XML_ELEMENT_CONTENT_OR) ||\n+                (content->c1->type == XML_ELEMENT_CONTENT_SEQ))\n+                xmlDumpElementContent(buf, content->c1, 1);\n+            else\n+                xmlDumpElementContent(buf, content->c1, 0);\n+            if (content->c2 != NULL) {\n+                xmlBufferWriteChar(buf, " | ");\n+                if ((content->c2->type == XML_ELEMENT_CONTENT_SEQ) ||\n+                    ((content->c2->type == XML_ELEMENT_CONTENT_OR) &&\n+                    (content->c2->ocur != XML_ELEMENT_CONTENT_ONCE)))\n+                    xmlDumpElementContent(buf, content->c2, 1);\n+                else\n+                    xmlDumpElementContent(buf, content->c2, 0);\n+            }\n+            break;\n+        default:\n+            xmlErrValid(NULL, XML_ERR_INTERNAL_ERROR,\n+                "Internal: ELEMENT content corrupted invalid type\\n",\n+                NULL);\n     }\n     if (glob)\n         xmlBufferWriteChar(buf, ")");\n     switch (content->ocur) {\n         case XML_ELEMENT_CONTENT_ONCE:\n-    break;\n+            break;\n         case XML_ELEMENT_CONTENT_OPT:\n-    xmlBufferWriteChar(buf, "?");\n-    break;\n+            xmlBufferWriteChar(buf, "?");\n+            break;\n         case XML_ELEMENT_CONTENT_MULT:\n-    xmlBufferWriteChar(buf, "*");\n-    break;\n+            xmlBufferWriteChar(buf, "*");\n+            break;\n         case XML_ELEMENT_CONTENT_PLUS:\n-    xmlBufferWriteChar(buf, "+");\n-    break;\n+            xmlBufferWriteChar(buf, "+");\n+            break;\n     }\n }\n \n+\n /**\n  * xmlSprintfElementContent:\n  * @buf:  an output buffer\n', 'id': 76, 'location': '/data/vulnloc/libxml2/CVE-2017-5969/src/valid.c:1194:13'}, {'diff': '@@ -1155,6 +1155,7 @@\n  *\n  * This will dump the content of the element table as an XML DTD definition\n  */\n+\n static void\n xmlDumpElementContent(xmlBufferPtr buf, xmlElementContentPtr content, int glob) {\n     if (content == NULL) return;\n@@ -1163,64 +1164,66 @@\n     switch (content->type) {\n         case XML_ELEMENT_CONTENT_PCDATA:\n             xmlBufferWriteChar(buf, "#PCDATA");\n-    break;\n-case XML_ELEMENT_CONTENT_ELEMENT:\n-    if (content->prefix != NULL) {\n-xmlBufferWriteCHAR(buf, content->prefix);\n-xmlBufferWriteChar(buf, ":");\n-    }\n-    xmlBufferWriteCHAR(buf, content->name);\n-    break;\n-case XML_ELEMENT_CONTENT_SEQ:\n-    if ((content->c1->type == XML_ELEMENT_CONTENT_OR) ||\n-        (content->c1->type == XML_ELEMENT_CONTENT_SEQ))\n-xmlDumpElementContent(buf, content->c1, 1);\n-    else\n-xmlDumpElementContent(buf, content->c1, 0);\n+            break;\n+        case XML_ELEMENT_CONTENT_ELEMENT:\n+            if (content->prefix != NULL) {\n+                xmlBufferWriteCHAR(buf, content->prefix);\n+                xmlBufferWriteChar(buf, ":");\n+            }\n+            xmlBufferWriteCHAR(buf, content->name);\n+            break;\n+        case XML_ELEMENT_CONTENT_SEQ:\n+            if ((content->c1->type == XML_ELEMENT_CONTENT_OR) ||\n+                (content->c1->type == XML_ELEMENT_CONTENT_SEQ))\n+                xmlDumpElementContent(buf, content->c1, 1);\n+            else\n+                xmlDumpElementContent(buf, content->c1, 0);\n             xmlBufferWriteChar(buf, " , ");\n-    if ((content->c2->type == XML_ELEMENT_CONTENT_OR) ||\n-        ((content->c2->type == XML_ELEMENT_CONTENT_SEQ) &&\n- (content->c2->ocur != XML_ELEMENT_CONTENT_ONCE)))\n-xmlDumpElementContent(buf, content->c2, 1);\n-    else\n-xmlDumpElementContent(buf, content->c2, 0);\n-    break;\n-case XML_ELEMENT_CONTENT_OR:\n-    if ((content->c1->type == XML_ELEMENT_CONTENT_OR) ||\n-        (content->c1->type == XML_ELEMENT_CONTENT_SEQ))\n-xmlDumpElementContent(buf, content->c1, 1);\n-    else\n-xmlDumpElementContent(buf, content->c1, 0);\n-            xmlBufferWriteChar(buf, " | ");\n-    if ((content->c2->type == XML_ELEMENT_CONTENT_SEQ) ||\n-        ((content->c2->type == XML_ELEMENT_CONTENT_OR) &&\n- (content->c2->ocur != XML_ELEMENT_CONTENT_ONCE)))\n-xmlDumpElementContent(buf, content->c2, 1);\n-    else\n-xmlDumpElementContent(buf, content->c2, 0);\n-    break;\n-default:\n-    xmlErrValid(NULL, XML_ERR_INTERNAL_ERROR,\n-    "Internal: ELEMENT content corrupted invalid type\\n",\n-    NULL);\n+            if ((content->c2->type == XML_ELEMENT_CONTENT_OR) ||\n+                ((content->c2->type == XML_ELEMENT_CONTENT_SEQ) &&\n+                (content->c2->ocur != XML_ELEMENT_CONTENT_ONCE)))\n+                xmlDumpElementContent(buf, content->c2, 1);\n+            else\n+                xmlDumpElementContent(buf, content->c2, 0);\n+            break;\n+        case XML_ELEMENT_CONTENT_OR:\n+            if ((content->c1->type == XML_ELEMENT_CONTENT_OR) ||\n+                (content->c1->type == XML_ELEMENT_CONTENT_SEQ))\n+                xmlDumpElementContent(buf, content->c1, 1);\n+            else\n+                xmlDumpElementContent(buf, content->c1, 0);\n+            if ((content->c2->type == XML_ELEMENT_CONTENT_SEQ) ||\n+                ((content->c2->type == XML_ELEMENT_CONTENT_OR) &&\n+                (content->c2->ocur != XML_ELEMENT_CONTENT_ONCE))) {\n+                xmlBufferWriteChar(buf, " | ");\n+                xmlDumpElementContent(buf, content->c2, 1);\n+            } else {\n+                xmlDumpElementContent(buf, content->c2, 0);\n+            }\n+            break;\n+        default:\n+            xmlErrValid(NULL, XML_ERR_INTERNAL_ERROR,\n+            "Internal: ELEMENT content corrupted invalid type\\n",\n+            NULL);\n     }\n     if (glob)\n         xmlBufferWriteChar(buf, ")");\n     switch (content->ocur) {\n         case XML_ELEMENT_CONTENT_ONCE:\n-    break;\n+            break;\n         case XML_ELEMENT_CONTENT_OPT:\n-    xmlBufferWriteChar(buf, "?");\n-    break;\n+            xmlBufferWriteChar(buf, "?");\n+            break;\n         case XML_ELEMENT_CONTENT_MULT:\n-    xmlBufferWriteChar(buf, "*");\n-    break;\n+            xmlBufferWriteChar(buf, "*");\n+            break;\n         case XML_ELEMENT_CONTENT_PLUS:\n-    xmlBufferWriteChar(buf, "+");\n-    break;\n+            xmlBufferWriteChar(buf, "+");\n+            break;\n     }\n }\n \n+\n /**\n  * xmlSprintfElementContent:\n  * @buf:  an output buffer\n', 'id': 77, 'location': '/data/vulnloc/libxml2/CVE-2017-5969/src/valid.c:1194:13'}, {'diff': '@@ -1155,6 +1155,7 @@\n  *\n  * This will dump the content of the element table as an XML DTD definition\n  */\n+\n static void\n xmlDumpElementContent(xmlBufferPtr buf, xmlElementContentPtr content, int glob) {\n     if (content == NULL) return;\n@@ -1163,64 +1164,66 @@\n     switch (content->type) {\n         case XML_ELEMENT_CONTENT_PCDATA:\n             xmlBufferWriteChar(buf, "#PCDATA");\n-    break;\n-case XML_ELEMENT_CONTENT_ELEMENT:\n-    if (content->prefix != NULL) {\n-xmlBufferWriteCHAR(buf, content->prefix);\n-xmlBufferWriteChar(buf, ":");\n-    }\n-    xmlBufferWriteCHAR(buf, content->name);\n-    break;\n-case XML_ELEMENT_CONTENT_SEQ:\n-    if ((content->c1->type == XML_ELEMENT_CONTENT_OR) ||\n-        (content->c1->type == XML_ELEMENT_CONTENT_SEQ))\n-xmlDumpElementContent(buf, content->c1, 1);\n-    else\n-xmlDumpElementContent(buf, content->c1, 0);\n+            break;\n+        case XML_ELEMENT_CONTENT_ELEMENT:\n+            if (content->prefix != NULL) {\n+                xmlBufferWriteCHAR(buf, content->prefix);\n+                xmlBufferWriteChar(buf, ":");\n+            }\n+            xmlBufferWriteCHAR(buf, content->name);\n+            break;\n+        case XML_ELEMENT_CONTENT_SEQ:\n+            if ((content->c1->type == XML_ELEMENT_CONTENT_OR) ||\n+                (content->c1->type == XML_ELEMENT_CONTENT_SEQ))\n+                xmlDumpElementContent(buf, content->c1, 1);\n+            else\n+                xmlDumpElementContent(buf, content->c1, 0);\n             xmlBufferWriteChar(buf, " , ");\n-    if ((content->c2->type == XML_ELEMENT_CONTENT_OR) ||\n-        ((content->c2->type == XML_ELEMENT_CONTENT_SEQ) &&\n- (content->c2->ocur != XML_ELEMENT_CONTENT_ONCE)))\n-xmlDumpElementContent(buf, content->c2, 1);\n-    else\n-xmlDumpElementContent(buf, content->c2, 0);\n-    break;\n-case XML_ELEMENT_CONTENT_OR:\n-    if ((content->c1->type == XML_ELEMENT_CONTENT_OR) ||\n-        (content->c1->type == XML_ELEMENT_CONTENT_SEQ))\n-xmlDumpElementContent(buf, content->c1, 1);\n-    else\n-xmlDumpElementContent(buf, content->c1, 0);\n-            xmlBufferWriteChar(buf, " | ");\n-    if ((content->c2->type == XML_ELEMENT_CONTENT_SEQ) ||\n-        ((content->c2->type == XML_ELEMENT_CONTENT_OR) &&\n- (content->c2->ocur != XML_ELEMENT_CONTENT_ONCE)))\n-xmlDumpElementContent(buf, content->c2, 1);\n-    else\n-xmlDumpElementContent(buf, content->c2, 0);\n-    break;\n-default:\n-    xmlErrValid(NULL, XML_ERR_INTERNAL_ERROR,\n-    "Internal: ELEMENT content corrupted invalid type\\n",\n-    NULL);\n+            if ((content->c2->type == XML_ELEMENT_CONTENT_OR) ||\n+                ((content->c2->type == XML_ELEMENT_CONTENT_SEQ) &&\n+                (content->c2->ocur != XML_ELEMENT_CONTENT_ONCE)))\n+                xmlDumpElementContent(buf, content->c2, 1);\n+            else\n+                xmlDumpElementContent(buf, content->c2, 0);\n+            break;\n+        case XML_ELEMENT_CONTENT_OR:\n+            if ((content->c1->type == XML_ELEMENT_CONTENT_OR) ||\n+                (content->c1->type == XML_ELEMENT_CONTENT_SEQ))\n+                xmlDumpElementContent(buf, content->c1, 1);\n+            else\n+                xmlDumpElementContent(buf, content->c1, 0);\n+            if ((content->c2->type == XML_ELEMENT_CONTENT_SEQ) ||\n+                ((content->c2->type == XML_ELEMENT_CONTENT_OR) &&\n+                (content->c2->ocur != XML_ELEMENT_CONTENT_ONCE))) {\n+                xmlBufferWriteChar(buf, " | ");\n+                xmlDumpElementContent(buf, content->c2, 1);\n+            } else {\n+                xmlDumpElementContent(buf, content->c2, 0);\n+            }\n+            break;\n+        default:\n+            xmlErrValid(NULL, XML_ERR_INTERNAL_ERROR,\n+            "Internal: ELEMENT content corrupted invalid type\\n",\n+            NULL);\n     }\n     if (glob)\n         xmlBufferWriteChar(buf, ")");\n     switch (content->ocur) {\n         case XML_ELEMENT_CONTENT_ONCE:\n-    break;\n+            break;\n         case XML_ELEMENT_CONTENT_OPT:\n-    xmlBufferWriteChar(buf, "?");\n-    break;\n+            xmlBufferWriteChar(buf, "?");\n+            break;\n         case XML_ELEMENT_CONTENT_MULT:\n-    xmlBufferWriteChar(buf, "*");\n-    break;\n+            xmlBufferWriteChar(buf, "*");\n+            break;\n         case XML_ELEMENT_CONTENT_PLUS:\n-    xmlBufferWriteChar(buf, "+");\n-    break;\n+            xmlBufferWriteChar(buf, "+");\n+            break;\n     }\n }\n \n+\n /**\n  * xmlSprintfElementContent:\n  * @buf:  an output buffer\n', 'id': 78, 'location': '/data/vulnloc/libxml2/CVE-2017-5969/src/valid.c:1194:13'}, {'diff': '@@ -1155,6 +1155,7 @@\n  *\n  * This will dump the content of the element table as an XML DTD definition\n  */\n+\n static void\n xmlDumpElementContent(xmlBufferPtr buf, xmlElementContentPtr content, int glob) {\n     if (content == NULL) return;\n@@ -1163,64 +1164,67 @@\n     switch (content->type) {\n         case XML_ELEMENT_CONTENT_PCDATA:\n             xmlBufferWriteChar(buf, "#PCDATA");\n-    break;\n-case XML_ELEMENT_CONTENT_ELEMENT:\n-    if (content->prefix != NULL) {\n-xmlBufferWriteCHAR(buf, content->prefix);\n-xmlBufferWriteChar(buf, ":");\n-    }\n-    xmlBufferWriteCHAR(buf, content->name);\n-    break;\n-case XML_ELEMENT_CONTENT_SEQ:\n-    if ((content->c1->type == XML_ELEMENT_CONTENT_OR) ||\n-        (content->c1->type == XML_ELEMENT_CONTENT_SEQ))\n-xmlDumpElementContent(buf, content->c1, 1);\n-    else\n-xmlDumpElementContent(buf, content->c1, 0);\n+            break;\n+        case XML_ELEMENT_CONTENT_ELEMENT:\n+            if (content->prefix != NULL) {\n+                xmlBufferWriteCHAR(buf, content->prefix);\n+                xmlBufferWriteChar(buf, ":");\n+            }\n+            xmlBufferWriteCHAR(buf, content->name);\n+            break;\n+        case XML_ELEMENT_CONTENT_SEQ:\n+            if ((content->c1->type == XML_ELEMENT_CONTENT_OR) ||\n+                (content->c1->type == XML_ELEMENT_CONTENT_SEQ))\n+                xmlDumpElementContent(buf, content->c1, 1);\n+            else\n+                xmlDumpElementContent(buf, content->c1, 0);\n             xmlBufferWriteChar(buf, " , ");\n-    if ((content->c2->type == XML_ELEMENT_CONTENT_OR) ||\n-        ((content->c2->type == XML_ELEMENT_CONTENT_SEQ) &&\n- (content->c2->ocur != XML_ELEMENT_CONTENT_ONCE)))\n-xmlDumpElementContent(buf, content->c2, 1);\n-    else\n-xmlDumpElementContent(buf, content->c2, 0);\n-    break;\n-case XML_ELEMENT_CONTENT_OR:\n-    if ((content->c1->type == XML_ELEMENT_CONTENT_OR) ||\n-        (content->c1->type == XML_ELEMENT_CONTENT_SEQ))\n-xmlDumpElementContent(buf, content->c1, 1);\n-    else\n-xmlDumpElementContent(buf, content->c1, 0);\n-            xmlBufferWriteChar(buf, " | ");\n-    if ((content->c2->type == XML_ELEMENT_CONTENT_SEQ) ||\n-        ((content->c2->type == XML_ELEMENT_CONTENT_OR) &&\n- (content->c2->ocur != XML_ELEMENT_CONTENT_ONCE)))\n-xmlDumpElementContent(buf, content->c2, 1);\n-    else\n-xmlDumpElementContent(buf, content->c2, 0);\n-    break;\n-default:\n-    xmlErrValid(NULL, XML_ERR_INTERNAL_ERROR,\n-    "Internal: ELEMENT content corrupted invalid type\\n",\n-    NULL);\n+            if ((content->c2->type == XML_ELEMENT_CONTENT_OR) ||\n+                ((content->c2->type == XML_ELEMENT_CONTENT_SEQ) &&\n+                (content->c2->ocur != XML_ELEMENT_CONTENT_ONCE)))\n+                xmlDumpElementContent(buf, content->c2, 1);\n+            else\n+                xmlDumpElementContent(buf, content->c2, 0);\n+            break;\n+        case XML_ELEMENT_CONTENT_OR:\n+            if ((content->c1->type == XML_ELEMENT_CONTENT_OR) ||\n+                (content->c1->type == XML_ELEMENT_CONTENT_SEQ))\n+                xmlDumpElementContent(buf, content->c1, 1);\n+            else\n+                xmlDumpElementContent(buf, content->c1, 0);\n+            if (content->c2 != NULL) {\n+                xmlBufferWriteChar(buf, " | ");\n+                if ((content->c2->type == XML_ELEMENT_CONTENT_SEQ) ||\n+                    ((content->c2->type == XML_ELEMENT_CONTENT_OR) &&\n+                    (content->c2->ocur != XML_ELEMENT_CONTENT_ONCE)))\n+                    xmlDumpElementContent(buf, content->c2, 1);\n+                else\n+                    xmlDumpElementContent(buf, content->c2, 0);\n+            }\n+            break;\n+        default:\n+            xmlErrValid(NULL, XML_ERR_INTERNAL_ERROR,\n+            "Internal: ELEMENT content corrupted invalid type\\n",\n+            NULL);\n     }\n     if (glob)\n         xmlBufferWriteChar(buf, ")");\n     switch (content->ocur) {\n         case XML_ELEMENT_CONTENT_ONCE:\n-    break;\n+            break;\n         case XML_ELEMENT_CONTENT_OPT:\n-    xmlBufferWriteChar(buf, "?");\n-    break;\n+            xmlBufferWriteChar(buf, "?");\n+            break;\n         case XML_ELEMENT_CONTENT_MULT:\n-    xmlBufferWriteChar(buf, "*");\n-    break;\n+            xmlBufferWriteChar(buf, "*");\n+            break;\n         case XML_ELEMENT_CONTENT_PLUS:\n-    xmlBufferWriteChar(buf, "+");\n-    break;\n+            xmlBufferWriteChar(buf, "+");\n+            break;\n     }\n }\n \n+\n /**\n  * xmlSprintfElementContent:\n  * @buf:  an output buffer\n', 'id': 79, 'location': '/data/vulnloc/libxml2/CVE-2017-5969/src/valid.c:1194:13'}, {'diff': '@@ -1155,6 +1155,7 @@\n  *\n  * This will dump the content of the element table as an XML DTD definition\n  */\n+\n static void\n xmlDumpElementContent(xmlBufferPtr buf, xmlElementContentPtr content, int glob) {\n     if (content == NULL) return;\n@@ -1163,64 +1164,65 @@\n     switch (content->type) {\n         case XML_ELEMENT_CONTENT_PCDATA:\n             xmlBufferWriteChar(buf, "#PCDATA");\n-    break;\n-case XML_ELEMENT_CONTENT_ELEMENT:\n-    if (content->prefix != NULL) {\n-xmlBufferWriteCHAR(buf, content->prefix);\n-xmlBufferWriteChar(buf, ":");\n-    }\n-    xmlBufferWriteCHAR(buf, content->name);\n-    break;\n-case XML_ELEMENT_CONTENT_SEQ:\n-    if ((content->c1->type == XML_ELEMENT_CONTENT_OR) ||\n-        (content->c1->type == XML_ELEMENT_CONTENT_SEQ))\n-xmlDumpElementContent(buf, content->c1, 1);\n-    else\n-xmlDumpElementContent(buf, content->c1, 0);\n+            break;\n+        case XML_ELEMENT_CONTENT_ELEMENT:\n+            if (content->prefix != NULL) {\n+                xmlBufferWriteCHAR(buf, content->prefix);\n+                xmlBufferWriteChar(buf, ":");\n+            }\n+            xmlBufferWriteCHAR(buf, content->name);\n+            break;\n+        case XML_ELEMENT_CONTENT_SEQ:\n+            if ((content->c1->type == XML_ELEMENT_CONTENT_OR) ||\n+                (content->c1->type == XML_ELEMENT_CONTENT_SEQ))\n+                xmlDumpElementContent(buf, content->c1, 1);\n+            else\n+                xmlDumpElementContent(buf, content->c1, 0);\n             xmlBufferWriteChar(buf, " , ");\n-    if ((content->c2->type == XML_ELEMENT_CONTENT_OR) ||\n-        ((content->c2->type == XML_ELEMENT_CONTENT_SEQ) &&\n- (content->c2->ocur != XML_ELEMENT_CONTENT_ONCE)))\n-xmlDumpElementContent(buf, content->c2, 1);\n-    else\n-xmlDumpElementContent(buf, content->c2, 0);\n-    break;\n-case XML_ELEMENT_CONTENT_OR:\n-    if ((content->c1->type == XML_ELEMENT_CONTENT_OR) ||\n-        (content->c1->type == XML_ELEMENT_CONTENT_SEQ))\n-xmlDumpElementContent(buf, content->c1, 1);\n-    else\n-xmlDumpElementContent(buf, content->c1, 0);\n+            if ((content->c2->type == XML_ELEMENT_CONTENT_OR) ||\n+                ((content->c2->type == XML_ELEMENT_CONTENT_SEQ) &&\n+                 (content->c2->ocur != XML_ELEMENT_CONTENT_ONCE)))\n+                xmlDumpElementContent(buf, content->c2, 1);\n+            else\n+                xmlDumpElementContent(buf, content->c2, 0);\n+            break;\n+        case XML_ELEMENT_CONTENT_OR:\n+            if ((content->c1->type == XML_ELEMENT_CONTENT_OR) ||\n+                (content->c1->type == XML_ELEMENT_CONTENT_SEQ))\n+                xmlDumpElementContent(buf, content->c1, 1);\n+            else\n+                xmlDumpElementContent(buf, content->c1, 0);\n             xmlBufferWriteChar(buf, " | ");\n-    if ((content->c2->type == XML_ELEMENT_CONTENT_SEQ) ||\n-        ((content->c2->type == XML_ELEMENT_CONTENT_OR) &&\n- (content->c2->ocur != XML_ELEMENT_CONTENT_ONCE)))\n-xmlDumpElementContent(buf, content->c2, 1);\n-    else\n-xmlDumpElementContent(buf, content->c2, 0);\n-    break;\n-default:\n-    xmlErrValid(NULL, XML_ERR_INTERNAL_ERROR,\n-    "Internal: ELEMENT content corrupted invalid type\\n",\n-    NULL);\n+            if ((content->c2->type == XML_ELEMENT_CONTENT_SEQ) ||\n+                ((content->c2->type == XML_ELEMENT_CONTENT_OR) &&\n+                 (content->c2->ocur != XML_ELEMENT_CONTENT_ONCE)))\n+                xmlDumpElementContent(buf, content->c2, 1);\n+            else\n+                xmlDumpElementContent(buf, content->c2, 0);\n+            break;\n+        default:\n+            xmlErrValid(NULL, XML_ERR_INTERNAL_ERROR,\n+                        "Internal: ELEMENT content corrupted invalid type\\n",\n+                        NULL);\n     }\n     if (glob)\n         xmlBufferWriteChar(buf, ")");\n     switch (content->ocur) {\n         case XML_ELEMENT_CONTENT_ONCE:\n-    break;\n+            break;\n         case XML_ELEMENT_CONTENT_OPT:\n-    xmlBufferWriteChar(buf, "?");\n-    break;\n+            xmlBufferWriteChar(buf, "?");\n+            break;\n         case XML_ELEMENT_CONTENT_MULT:\n-    xmlBufferWriteChar(buf, "*");\n-    break;\n+            xmlBufferWriteChar(buf, "*");\n+            break;\n         case XML_ELEMENT_CONTENT_PLUS:\n-    xmlBufferWriteChar(buf, "+");\n-    break;\n+            xmlBufferWriteChar(buf, "+");\n+            break;\n     }\n }\n \n+\n /**\n  * xmlSprintfElementContent:\n  * @buf:  an output buffer\n', 'id': 80, 'location': '/data/vulnloc/libxml2/CVE-2017-5969/src/valid.c:1193:1'}, {'diff': '@@ -1155,6 +1155,7 @@\n  *\n  * This will dump the content of the element table as an XML DTD definition\n  */\n+\n static void\n xmlDumpElementContent(xmlBufferPtr buf, xmlElementContentPtr content, int glob) {\n     if (content == NULL) return;\n@@ -1163,64 +1164,69 @@\n     switch (content->type) {\n         case XML_ELEMENT_CONTENT_PCDATA:\n             xmlBufferWriteChar(buf, "#PCDATA");\n-    break;\n-case XML_ELEMENT_CONTENT_ELEMENT:\n-    if (content->prefix != NULL) {\n-xmlBufferWriteCHAR(buf, content->prefix);\n-xmlBufferWriteChar(buf, ":");\n-    }\n-    xmlBufferWriteCHAR(buf, content->name);\n-    break;\n-case XML_ELEMENT_CONTENT_SEQ:\n-    if ((content->c1->type == XML_ELEMENT_CONTENT_OR) ||\n-        (content->c1->type == XML_ELEMENT_CONTENT_SEQ))\n-xmlDumpElementContent(buf, content->c1, 1);\n-    else\n-xmlDumpElementContent(buf, content->c1, 0);\n+            break;\n+        case XML_ELEMENT_CONTENT_ELEMENT:\n+            if (content->prefix != NULL) {\n+                xmlBufferWriteCHAR(buf, content->prefix);\n+                xmlBufferWriteChar(buf, ":");\n+            }\n+            xmlBufferWriteCHAR(buf, content->name);\n+            break;\n+        case XML_ELEMENT_CONTENT_SEQ:\n+            if ((content->c1->type == XML_ELEMENT_CONTENT_OR) ||\n+                (content->c1->type == XML_ELEMENT_CONTENT_SEQ)) {\n+                xmlDumpElementContent(buf, content->c1, 1);\n+            } else {\n+                xmlDumpElementContent(buf, content->c1, 0);\n+            }\n             xmlBufferWriteChar(buf, " , ");\n-    if ((content->c2->type == XML_ELEMENT_CONTENT_OR) ||\n-        ((content->c2->type == XML_ELEMENT_CONTENT_SEQ) &&\n- (content->c2->ocur != XML_ELEMENT_CONTENT_ONCE)))\n-xmlDumpElementContent(buf, content->c2, 1);\n-    else\n-xmlDumpElementContent(buf, content->c2, 0);\n-    break;\n-case XML_ELEMENT_CONTENT_OR:\n-    if ((content->c1->type == XML_ELEMENT_CONTENT_OR) ||\n-        (content->c1->type == XML_ELEMENT_CONTENT_SEQ))\n-xmlDumpElementContent(buf, content->c1, 1);\n-    else\n-xmlDumpElementContent(buf, content->c1, 0);\n+            if ((content->c2->type == XML_ELEMENT_CONTENT_OR) ||\n+                ((content->c2->type == XML_ELEMENT_CONTENT_SEQ) &&\n+                (content->c2->ocur != XML_ELEMENT_CONTENT_ONCE))) {\n+                xmlDumpElementContent(buf, content->c2, 1);\n+            } else {\n+                xmlDumpElementContent(buf, content->c2, 0);\n+            }\n+            break;\n+        case XML_ELEMENT_CONTENT_OR:\n+            if ((content->c1->type == XML_ELEMENT_CONTENT_OR) ||\n+                (content->c1->type == XML_ELEMENT_CONTENT_SEQ)) {\n+                xmlDumpElementContent(buf, content->c1, 1);\n+            } else {\n+                xmlDumpElementContent(buf, content->c1, 0);\n+            }\n             xmlBufferWriteChar(buf, " | ");\n-    if ((content->c2->type == XML_ELEMENT_CONTENT_SEQ) ||\n-        ((content->c2->type == XML_ELEMENT_CONTENT_OR) &&\n- (content->c2->ocur != XML_ELEMENT_CONTENT_ONCE)))\n-xmlDumpElementContent(buf, content->c2, 1);\n-    else\n-xmlDumpElementContent(buf, content->c2, 0);\n-    break;\n-default:\n-    xmlErrValid(NULL, XML_ERR_INTERNAL_ERROR,\n-    "Internal: ELEMENT content corrupted invalid type\\n",\n-    NULL);\n+            if ((content->c2->type == XML_ELEMENT_CONTENT_SEQ) ||\n+                ((content->c2->type == XML_ELEMENT_CONTENT_OR) &&\n+                (content->c2->ocur != XML_ELEMENT_CONTENT_ONCE))) {\n+                xmlDumpElementContent(buf, content->c2, 1);\n+            } else {\n+                xmlDumpElementContent(buf, content->c2, 0);\n+            }\n+            break;\n+        default:\n+            xmlErrValid(NULL, XML_ERR_INTERNAL_ERROR,\n+            "Internal: ELEMENT content corrupted invalid type\\n",\n+            NULL);\n     }\n     if (glob)\n         xmlBufferWriteChar(buf, ")");\n     switch (content->ocur) {\n         case XML_ELEMENT_CONTENT_ONCE:\n-    break;\n+            break;\n         case XML_ELEMENT_CONTENT_OPT:\n-    xmlBufferWriteChar(buf, "?");\n-    break;\n+            xmlBufferWriteChar(buf, "?");\n+            break;\n         case XML_ELEMENT_CONTENT_MULT:\n-    xmlBufferWriteChar(buf, "*");\n-    break;\n+            xmlBufferWriteChar(buf, "*");\n+            break;\n         case XML_ELEMENT_CONTENT_PLUS:\n-    xmlBufferWriteChar(buf, "+");\n-    break;\n+            xmlBufferWriteChar(buf, "+");\n+            break;\n     }\n }\n \n+\n /**\n  * xmlSprintfElementContent:\n  * @buf:  an output buffer\n', 'id': 81, 'location': '/data/vulnloc/libxml2/CVE-2017-5969/src/valid.c:1193:1'}, {'diff': '@@ -1155,6 +1155,7 @@\n  *\n  * This will dump the content of the element table as an XML DTD definition\n  */\n+\n static void\n xmlDumpElementContent(xmlBufferPtr buf, xmlElementContentPtr content, int glob) {\n     if (content == NULL) return;\n@@ -1163,64 +1164,65 @@\n     switch (content->type) {\n         case XML_ELEMENT_CONTENT_PCDATA:\n             xmlBufferWriteChar(buf, "#PCDATA");\n-    break;\n-case XML_ELEMENT_CONTENT_ELEMENT:\n-    if (content->prefix != NULL) {\n-xmlBufferWriteCHAR(buf, content->prefix);\n-xmlBufferWriteChar(buf, ":");\n-    }\n-    xmlBufferWriteCHAR(buf, content->name);\n-    break;\n-case XML_ELEMENT_CONTENT_SEQ:\n-    if ((content->c1->type == XML_ELEMENT_CONTENT_OR) ||\n-        (content->c1->type == XML_ELEMENT_CONTENT_SEQ))\n-xmlDumpElementContent(buf, content->c1, 1);\n-    else\n-xmlDumpElementContent(buf, content->c1, 0);\n+            break;\n+        case XML_ELEMENT_CONTENT_ELEMENT:\n+            if (content->prefix != NULL) {\n+                xmlBufferWriteCHAR(buf, content->prefix);\n+                xmlBufferWriteChar(buf, ":");\n+            }\n+            xmlBufferWriteCHAR(buf, content->name);\n+            break;\n+        case XML_ELEMENT_CONTENT_SEQ:\n+            if ((content->c1->type == XML_ELEMENT_CONTENT_OR) ||\n+                (content->c1->type == XML_ELEMENT_CONTENT_SEQ))\n+                xmlDumpElementContent(buf, content->c1, 1);\n+            else\n+                xmlDumpElementContent(buf, content->c1, 0);\n             xmlBufferWriteChar(buf, " , ");\n-    if ((content->c2->type == XML_ELEMENT_CONTENT_OR) ||\n-        ((content->c2->type == XML_ELEMENT_CONTENT_SEQ) &&\n- (content->c2->ocur != XML_ELEMENT_CONTENT_ONCE)))\n-xmlDumpElementContent(buf, content->c2, 1);\n-    else\n-xmlDumpElementContent(buf, content->c2, 0);\n-    break;\n-case XML_ELEMENT_CONTENT_OR:\n-    if ((content->c1->type == XML_ELEMENT_CONTENT_OR) ||\n-        (content->c1->type == XML_ELEMENT_CONTENT_SEQ))\n-xmlDumpElementContent(buf, content->c1, 1);\n-    else\n-xmlDumpElementContent(buf, content->c1, 0);\n+            if ((content->c2->type == XML_ELEMENT_CONTENT_OR) ||\n+                ((content->c2->type == XML_ELEMENT_CONTENT_SEQ) &&\n+                (content->c2->ocur != XML_ELEMENT_CONTENT_ONCE)))\n+                xmlDumpElementContent(buf, content->c2, 1);\n+            else\n+                xmlDumpElementContent(buf, content->c2, 0);\n+            break;\n+        case XML_ELEMENT_CONTENT_OR:\n+            if ((content->c1->type == XML_ELEMENT_CONTENT_OR) ||\n+                (content->c1->type == XML_ELEMENT_CONTENT_SEQ))\n+                xmlDumpElementContent(buf, content->c1, 1);\n+            else\n+                xmlDumpElementContent(buf, content->c1, 0);\n             xmlBufferWriteChar(buf, " | ");\n-    if ((content->c2->type == XML_ELEMENT_CONTENT_SEQ) ||\n-        ((content->c2->type == XML_ELEMENT_CONTENT_OR) &&\n- (content->c2->ocur != XML_ELEMENT_CONTENT_ONCE)))\n-xmlDumpElementContent(buf, content->c2, 1);\n-    else\n-xmlDumpElementContent(buf, content->c2, 0);\n-    break;\n-default:\n-    xmlErrValid(NULL, XML_ERR_INTERNAL_ERROR,\n-    "Internal: ELEMENT content corrupted invalid type\\n",\n-    NULL);\n+            if ((content->c2->type == XML_ELEMENT_CONTENT_SEQ) ||\n+                ((content->c2->type == XML_ELEMENT_CONTENT_OR) &&\n+                (content->c2->ocur != XML_ELEMENT_CONTENT_ONCE)))\n+                xmlDumpElementContent(buf, content->c2, 1);\n+            else\n+                xmlDumpElementContent(buf, content->c2, 0);\n+            break;\n+        default:\n+            xmlErrValid(NULL, XML_ERR_INTERNAL_ERROR,\n+                "Internal: ELEMENT content corrupted invalid type\\n",\n+                NULL);\n     }\n     if (glob)\n         xmlBufferWriteChar(buf, ")");\n     switch (content->ocur) {\n         case XML_ELEMENT_CONTENT_ONCE:\n-    break;\n+            break;\n         case XML_ELEMENT_CONTENT_OPT:\n-    xmlBufferWriteChar(buf, "?");\n-    break;\n+            xmlBufferWriteChar(buf, "?");\n+            break;\n         case XML_ELEMENT_CONTENT_MULT:\n-    xmlBufferWriteChar(buf, "*");\n-    break;\n+            xmlBufferWriteChar(buf, "*");\n+            break;\n         case XML_ELEMENT_CONTENT_PLUS:\n-    xmlBufferWriteChar(buf, "+");\n-    break;\n+            xmlBufferWriteChar(buf, "+");\n+            break;\n     }\n }\n \n+\n /**\n  * xmlSprintfElementContent:\n  * @buf:  an output buffer\n', 'id': 82, 'location': '/data/vulnloc/libxml2/CVE-2017-5969/src/valid.c:1193:1'}, {'diff': '@@ -1155,6 +1155,7 @@\n  *\n  * This will dump the content of the element table as an XML DTD definition\n  */\n+\n static void\n xmlDumpElementContent(xmlBufferPtr buf, xmlElementContentPtr content, int glob) {\n     if (content == NULL) return;\n@@ -1163,64 +1164,65 @@\n     switch (content->type) {\n         case XML_ELEMENT_CONTENT_PCDATA:\n             xmlBufferWriteChar(buf, "#PCDATA");\n-    break;\n-case XML_ELEMENT_CONTENT_ELEMENT:\n-    if (content->prefix != NULL) {\n-xmlBufferWriteCHAR(buf, content->prefix);\n-xmlBufferWriteChar(buf, ":");\n-    }\n-    xmlBufferWriteCHAR(buf, content->name);\n-    break;\n-case XML_ELEMENT_CONTENT_SEQ:\n-    if ((content->c1->type == XML_ELEMENT_CONTENT_OR) ||\n-        (content->c1->type == XML_ELEMENT_CONTENT_SEQ))\n-xmlDumpElementContent(buf, content->c1, 1);\n-    else\n-xmlDumpElementContent(buf, content->c1, 0);\n+            break;\n+        case XML_ELEMENT_CONTENT_ELEMENT:\n+            if (content->prefix != NULL) {\n+                xmlBufferWriteCHAR(buf, content->prefix);\n+                xmlBufferWriteChar(buf, ":");\n+            }\n+            xmlBufferWriteCHAR(buf, content->name);\n+            break;\n+        case XML_ELEMENT_CONTENT_SEQ:\n+            if ((content->c1->type == XML_ELEMENT_CONTENT_OR) ||\n+                (content->c1->type == XML_ELEMENT_CONTENT_SEQ))\n+                xmlDumpElementContent(buf, content->c1, 1);\n+            else\n+                xmlDumpElementContent(buf, content->c1, 0);\n             xmlBufferWriteChar(buf, " , ");\n-    if ((content->c2->type == XML_ELEMENT_CONTENT_OR) ||\n-        ((content->c2->type == XML_ELEMENT_CONTENT_SEQ) &&\n- (content->c2->ocur != XML_ELEMENT_CONTENT_ONCE)))\n-xmlDumpElementContent(buf, content->c2, 1);\n-    else\n-xmlDumpElementContent(buf, content->c2, 0);\n-    break;\n-case XML_ELEMENT_CONTENT_OR:\n-    if ((content->c1->type == XML_ELEMENT_CONTENT_OR) ||\n-        (content->c1->type == XML_ELEMENT_CONTENT_SEQ))\n-xmlDumpElementContent(buf, content->c1, 1);\n-    else\n-xmlDumpElementContent(buf, content->c1, 0);\n+            if ((content->c2->type == XML_ELEMENT_CONTENT_OR) ||\n+                ((content->c2->type == XML_ELEMENT_CONTENT_SEQ) &&\n+                (content->c2->ocur != XML_ELEMENT_CONTENT_ONCE)))\n+                xmlDumpElementContent(buf, content->c2, 1);\n+            else\n+                xmlDumpElementContent(buf, content->c2, 0);\n+            break;\n+        case XML_ELEMENT_CONTENT_OR:\n+            if ((content->c1->type == XML_ELEMENT_CONTENT_OR) ||\n+                (content->c1->type == XML_ELEMENT_CONTENT_SEQ))\n+                xmlDumpElementContent(buf, content->c1, 1);\n+            else\n+                xmlDumpElementContent(buf, content->c1, 0);\n             xmlBufferWriteChar(buf, " | ");\n-    if ((content->c2->type == XML_ELEMENT_CONTENT_SEQ) ||\n-        ((content->c2->type == XML_ELEMENT_CONTENT_OR) &&\n- (content->c2->ocur != XML_ELEMENT_CONTENT_ONCE)))\n-xmlDumpElementContent(buf, content->c2, 1);\n-    else\n-xmlDumpElementContent(buf, content->c2, 0);\n-    break;\n-default:\n-    xmlErrValid(NULL, XML_ERR_INTERNAL_ERROR,\n-    "Internal: ELEMENT content corrupted invalid type\\n",\n-    NULL);\n+            if ((content->c2->type == XML_ELEMENT_CONTENT_SEQ) ||\n+                ((content->c2->type == XML_ELEMENT_CONTENT_OR) &&\n+                (content->c2->ocur != XML_ELEMENT_CONTENT_ONCE)))\n+                xmlDumpElementContent(buf, content->c2, 1);\n+            else\n+                xmlDumpElementContent(buf, content->c2, 0);\n+            break;\n+        default:\n+            xmlErrValid(NULL, XML_ERR_INTERNAL_ERROR,\n+            "Internal: ELEMENT content corrupted invalid type\\n",\n+            NULL);\n     }\n     if (glob)\n         xmlBufferWriteChar(buf, ")");\n     switch (content->ocur) {\n         case XML_ELEMENT_CONTENT_ONCE:\n-    break;\n+            break;\n         case XML_ELEMENT_CONTENT_OPT:\n-    xmlBufferWriteChar(buf, "?");\n-    break;\n+            xmlBufferWriteChar(buf, "?");\n+            break;\n         case XML_ELEMENT_CONTENT_MULT:\n-    xmlBufferWriteChar(buf, "*");\n-    break;\n+            xmlBufferWriteChar(buf, "*");\n+            break;\n         case XML_ELEMENT_CONTENT_PLUS:\n-    xmlBufferWriteChar(buf, "+");\n-    break;\n+            xmlBufferWriteChar(buf, "+");\n+            break;\n     }\n }\n \n+\n /**\n  * xmlSprintfElementContent:\n  * @buf:  an output buffer\n', 'id': 83, 'location': '/data/vulnloc/libxml2/CVE-2017-5969/src/valid.c:1193:1'}, {'diff': '@@ -1155,6 +1155,7 @@\n  *\n  * This will dump the content of the element table as an XML DTD definition\n  */\n+\n static void\n xmlDumpElementContent(xmlBufferPtr buf, xmlElementContentPtr content, int glob) {\n     if (content == NULL) return;\n@@ -1163,64 +1164,65 @@\n     switch (content->type) {\n         case XML_ELEMENT_CONTENT_PCDATA:\n             xmlBufferWriteChar(buf, "#PCDATA");\n-    break;\n-case XML_ELEMENT_CONTENT_ELEMENT:\n-    if (content->prefix != NULL) {\n-xmlBufferWriteCHAR(buf, content->prefix);\n-xmlBufferWriteChar(buf, ":");\n-    }\n-    xmlBufferWriteCHAR(buf, content->name);\n-    break;\n-case XML_ELEMENT_CONTENT_SEQ:\n-    if ((content->c1->type == XML_ELEMENT_CONTENT_OR) ||\n-        (content->c1->type == XML_ELEMENT_CONTENT_SEQ))\n-xmlDumpElementContent(buf, content->c1, 1);\n-    else\n-xmlDumpElementContent(buf, content->c1, 0);\n+            break;\n+        case XML_ELEMENT_CONTENT_ELEMENT:\n+            if (content->prefix != NULL) {\n+                xmlBufferWriteCHAR(buf, content->prefix);\n+                xmlBufferWriteChar(buf, ":");\n+            }\n+            xmlBufferWriteCHAR(buf, content->name);\n+            break;\n+        case XML_ELEMENT_CONTENT_SEQ:\n+            if ((content->c1->type == XML_ELEMENT_CONTENT_OR) ||\n+                (content->c1->type == XML_ELEMENT_CONTENT_SEQ))\n+                xmlDumpElementContent(buf, content->c1, 1);\n+            else\n+                xmlDumpElementContent(buf, content->c1, 0);\n             xmlBufferWriteChar(buf, " , ");\n-    if ((content->c2->type == XML_ELEMENT_CONTENT_OR) ||\n-        ((content->c2->type == XML_ELEMENT_CONTENT_SEQ) &&\n- (content->c2->ocur != XML_ELEMENT_CONTENT_ONCE)))\n-xmlDumpElementContent(buf, content->c2, 1);\n-    else\n-xmlDumpElementContent(buf, content->c2, 0);\n-    break;\n-case XML_ELEMENT_CONTENT_OR:\n-    if ((content->c1->type == XML_ELEMENT_CONTENT_OR) ||\n-        (content->c1->type == XML_ELEMENT_CONTENT_SEQ))\n-xmlDumpElementContent(buf, content->c1, 1);\n-    else\n-xmlDumpElementContent(buf, content->c1, 0);\n+            if ((content->c2->type == XML_ELEMENT_CONTENT_OR) ||\n+                ((content->c2->type == XML_ELEMENT_CONTENT_SEQ) &&\n+                (content->c2->ocur != XML_ELEMENT_CONTENT_ONCE)))\n+                xmlDumpElementContent(buf, content->c2, 1);\n+            else\n+                xmlDumpElementContent(buf, content->c2, 0);\n+            break;\n+        case XML_ELEMENT_CONTENT_OR:\n+            if ((content->c1->type == XML_ELEMENT_CONTENT_OR) ||\n+                (content->c1->type == XML_ELEMENT_CONTENT_SEQ))\n+                xmlDumpElementContent(buf, content->c1, 1);\n+            else\n+                xmlDumpElementContent(buf, content->c1, 0);\n             xmlBufferWriteChar(buf, " | ");\n-    if ((content->c2->type == XML_ELEMENT_CONTENT_SEQ) ||\n-        ((content->c2->type == XML_ELEMENT_CONTENT_OR) &&\n- (content->c2->ocur != XML_ELEMENT_CONTENT_ONCE)))\n-xmlDumpElementContent(buf, content->c2, 1);\n-    else\n-xmlDumpElementContent(buf, content->c2, 0);\n-    break;\n-default:\n-    xmlErrValid(NULL, XML_ERR_INTERNAL_ERROR,\n-    "Internal: ELEMENT content corrupted invalid type\\n",\n-    NULL);\n+            if ((content->c2->type == XML_ELEMENT_CONTENT_SEQ) ||\n+                ((content->c2->type == XML_ELEMENT_CONTENT_OR) &&\n+                (content->c2->ocur != XML_ELEMENT_CONTENT_ONCE)))\n+                xmlDumpElementContent(buf, content->c2, 1);\n+            else\n+                xmlDumpElementContent(buf, content->c2, 0);\n+            break;\n+        default:\n+            xmlErrValid(NULL, XML_ERR_INTERNAL_ERROR,\n+            "Internal: ELEMENT content corrupted invalid type\\n",\n+            NULL);\n     }\n     if (glob)\n         xmlBufferWriteChar(buf, ")");\n     switch (content->ocur) {\n         case XML_ELEMENT_CONTENT_ONCE:\n-    break;\n+            break;\n         case XML_ELEMENT_CONTENT_OPT:\n-    xmlBufferWriteChar(buf, "?");\n-    break;\n+            xmlBufferWriteChar(buf, "?");\n+            break;\n         case XML_ELEMENT_CONTENT_MULT:\n-    xmlBufferWriteChar(buf, "*");\n-    break;\n+            xmlBufferWriteChar(buf, "*");\n+            break;\n         case XML_ELEMENT_CONTENT_PLUS:\n-    xmlBufferWriteChar(buf, "+");\n-    break;\n+            xmlBufferWriteChar(buf, "+");\n+            break;\n     }\n }\n \n+\n /**\n  * xmlSprintfElementContent:\n  * @buf:  an output buffer\n', 'id': 84, 'location': '/data/vulnloc/libxml2/CVE-2017-5969/src/valid.c:1193:1'}, {'diff': '@@ -1155,6 +1155,7 @@\n  *\n  * This will dump the content of the element table as an XML DTD definition\n  */\n+\n static void\n xmlDumpElementContent(xmlBufferPtr buf, xmlElementContentPtr content, int glob) {\n     if (content == NULL) return;\n@@ -1163,64 +1164,73 @@\n     switch (content->type) {\n         case XML_ELEMENT_CONTENT_PCDATA:\n             xmlBufferWriteChar(buf, "#PCDATA");\n-    break;\n-case XML_ELEMENT_CONTENT_ELEMENT:\n-    if (content->prefix != NULL) {\n-xmlBufferWriteCHAR(buf, content->prefix);\n-xmlBufferWriteChar(buf, ":");\n-    }\n-    xmlBufferWriteCHAR(buf, content->name);\n-    break;\n-case XML_ELEMENT_CONTENT_SEQ:\n-    if ((content->c1->type == XML_ELEMENT_CONTENT_OR) ||\n-        (content->c1->type == XML_ELEMENT_CONTENT_SEQ))\n-xmlDumpElementContent(buf, content->c1, 1);\n-    else\n-xmlDumpElementContent(buf, content->c1, 0);\n+            break;\n+        case XML_ELEMENT_CONTENT_ELEMENT:\n+            if (content->prefix != NULL) {\n+                xmlBufferWriteCHAR(buf, content->prefix);\n+                xmlBufferWriteChar(buf, ":");\n+            }\n+            xmlBufferWriteCHAR(buf, content->name);\n+            break;\n+        case XML_ELEMENT_CONTENT_SEQ:\n+            if (content->c1 != NULL) {\n+                if ((content->c1->type == XML_ELEMENT_CONTENT_OR) ||\n+                    (content->c1->type == XML_ELEMENT_CONTENT_SEQ))\n+                    xmlDumpElementContent(buf, content->c1, 1);\n+                else\n+                    xmlDumpElementContent(buf, content->c1, 0);\n+            }\n             xmlBufferWriteChar(buf, " , ");\n-    if ((content->c2->type == XML_ELEMENT_CONTENT_OR) ||\n-        ((content->c2->type == XML_ELEMENT_CONTENT_SEQ) &&\n- (content->c2->ocur != XML_ELEMENT_CONTENT_ONCE)))\n-xmlDumpElementContent(buf, content->c2, 1);\n-    else\n-xmlDumpElementContent(buf, content->c2, 0);\n-    break;\n-case XML_ELEMENT_CONTENT_OR:\n-    if ((content->c1->type == XML_ELEMENT_CONTENT_OR) ||\n-        (content->c1->type == XML_ELEMENT_CONTENT_SEQ))\n-xmlDumpElementContent(buf, content->c1, 1);\n-    else\n-xmlDumpElementContent(buf, content->c1, 0);\n+            if (content->c2 != NULL) {\n+                if ((content->c2->type == XML_ELEMENT_CONTENT_OR) ||\n+                    ((content->c2->type == XML_ELEMENT_CONTENT_SEQ) &&\n+                     (content->c2->ocur != XML_ELEMENT_CONTENT_ONCE)))\n+                    xmlDumpElementContent(buf, content->c2, 1);\n+                else\n+                    xmlDumpElementContent(buf, content->c2, 0);\n+            }\n+            break;\n+        case XML_ELEMENT_CONTENT_OR:\n+            if (content->c1 != NULL) {\n+                if ((content->c1->type == XML_ELEMENT_CONTENT_OR) ||\n+                    (content->c1->type == XML_ELEMENT_CONTENT_SEQ))\n+                    xmlDumpElementContent(buf, content->c1, 1);\n+                else\n+                    xmlDumpElementContent(buf, content->c1, 0);\n+            }\n             xmlBufferWriteChar(buf, " | ");\n-    if ((content->c2->type == XML_ELEMENT_CONTENT_SEQ) ||\n-        ((content->c2->type == XML_ELEMENT_CONTENT_OR) &&\n- (content->c2->ocur != XML_ELEMENT_CONTENT_ONCE)))\n-xmlDumpElementContent(buf, content->c2, 1);\n-    else\n-xmlDumpElementContent(buf, content->c2, 0);\n-    break;\n-default:\n-    xmlErrValid(NULL, XML_ERR_INTERNAL_ERROR,\n-    "Internal: ELEMENT content corrupted invalid type\\n",\n-    NULL);\n+            if (content->c2 != NULL) {\n+                if ((content->c2->type == XML_ELEMENT_CONTENT_SEQ) ||\n+                    ((content->c2->type == XML_ELEMENT_CONTENT_OR) &&\n+                     (content->c2->ocur != XML_ELEMENT_CONTENT_ONCE)))\n+                    xmlDumpElementContent(buf, content->c2, 1);\n+                else\n+                    xmlDumpElementContent(buf, content->c2, 0);\n+            }\n+            break;\n+        default:\n+            xmlErrValid(NULL, XML_ERR_INTERNAL_ERROR,\n+                        "Internal: ELEMENT content corrupted invalid type\\n",\n+                        NULL);\n     }\n     if (glob)\n         xmlBufferWriteChar(buf, ")");\n     switch (content->ocur) {\n         case XML_ELEMENT_CONTENT_ONCE:\n-    break;\n+            break;\n         case XML_ELEMENT_CONTENT_OPT:\n-    xmlBufferWriteChar(buf, "?");\n-    break;\n+            xmlBufferWriteChar(buf, "?");\n+            break;\n         case XML_ELEMENT_CONTENT_MULT:\n-    xmlBufferWriteChar(buf, "*");\n-    break;\n+            xmlBufferWriteChar(buf, "*");\n+            break;\n         case XML_ELEMENT_CONTENT_PLUS:\n-    xmlBufferWriteChar(buf, "+");\n-    break;\n+            xmlBufferWriteChar(buf, "+");\n+            break;\n     }\n }\n \n+\n /**\n  * xmlSprintfElementContent:\n  * @buf:  an output buffer\n', 'id': 85, 'location': '/data/vulnloc/libxml2/CVE-2017-5969/src/valid.c:1189:5'}, {'diff': '@@ -1155,6 +1155,7 @@\n  *\n  * This will dump the content of the element table as an XML DTD definition\n  */\n+\n static void\n xmlDumpElementContent(xmlBufferPtr buf, xmlElementContentPtr content, int glob) {\n     if (content == NULL) return;\n@@ -1163,64 +1164,73 @@\n     switch (content->type) {\n         case XML_ELEMENT_CONTENT_PCDATA:\n             xmlBufferWriteChar(buf, "#PCDATA");\n-    break;\n-case XML_ELEMENT_CONTENT_ELEMENT:\n-    if (content->prefix != NULL) {\n-xmlBufferWriteCHAR(buf, content->prefix);\n-xmlBufferWriteChar(buf, ":");\n-    }\n-    xmlBufferWriteCHAR(buf, content->name);\n-    break;\n-case XML_ELEMENT_CONTENT_SEQ:\n-    if ((content->c1->type == XML_ELEMENT_CONTENT_OR) ||\n-        (content->c1->type == XML_ELEMENT_CONTENT_SEQ))\n-xmlDumpElementContent(buf, content->c1, 1);\n-    else\n-xmlDumpElementContent(buf, content->c1, 0);\n+            break;\n+        case XML_ELEMENT_CONTENT_ELEMENT:\n+            if (content->prefix != NULL) {\n+                xmlBufferWriteCHAR(buf, content->prefix);\n+                xmlBufferWriteChar(buf, ":");\n+            }\n+            xmlBufferWriteCHAR(buf, content->name);\n+            break;\n+        case XML_ELEMENT_CONTENT_SEQ:\n+            if (content->c1) {\n+                if ((content->c1->type == XML_ELEMENT_CONTENT_OR) ||\n+                    (content->c1->type == XML_ELEMENT_CONTENT_SEQ))\n+                    xmlDumpElementContent(buf, content->c1, 1);\n+                else\n+                    xmlDumpElementContent(buf, content->c1, 0);\n+            }\n             xmlBufferWriteChar(buf, " , ");\n-    if ((content->c2->type == XML_ELEMENT_CONTENT_OR) ||\n-        ((content->c2->type == XML_ELEMENT_CONTENT_SEQ) &&\n- (content->c2->ocur != XML_ELEMENT_CONTENT_ONCE)))\n-xmlDumpElementContent(buf, content->c2, 1);\n-    else\n-xmlDumpElementContent(buf, content->c2, 0);\n-    break;\n-case XML_ELEMENT_CONTENT_OR:\n-    if ((content->c1->type == XML_ELEMENT_CONTENT_OR) ||\n-        (content->c1->type == XML_ELEMENT_CONTENT_SEQ))\n-xmlDumpElementContent(buf, content->c1, 1);\n-    else\n-xmlDumpElementContent(buf, content->c1, 0);\n+            if (content->c2) {\n+                if ((content->c2->type == XML_ELEMENT_CONTENT_OR) ||\n+                    ((content->c2->type == XML_ELEMENT_CONTENT_SEQ) &&\n+                     (content->c2->ocur != XML_ELEMENT_CONTENT_ONCE)))\n+                    xmlDumpElementContent(buf, content->c2, 1);\n+                else\n+                    xmlDumpElementContent(buf, content->c2, 0);\n+            }\n+            break;\n+        case XML_ELEMENT_CONTENT_OR:\n+            if (content->c1) {\n+                if ((content->c1->type == XML_ELEMENT_CONTENT_OR) ||\n+                    (content->c1->type == XML_ELEMENT_CONTENT_SEQ))\n+                    xmlDumpElementContent(buf, content->c1, 1);\n+                else\n+                    xmlDumpElementContent(buf, content->c1, 0);\n+            }\n             xmlBufferWriteChar(buf, " | ");\n-    if ((content->c2->type == XML_ELEMENT_CONTENT_SEQ) ||\n-        ((content->c2->type == XML_ELEMENT_CONTENT_OR) &&\n- (content->c2->ocur != XML_ELEMENT_CONTENT_ONCE)))\n-xmlDumpElementContent(buf, content->c2, 1);\n-    else\n-xmlDumpElementContent(buf, content->c2, 0);\n-    break;\n-default:\n-    xmlErrValid(NULL, XML_ERR_INTERNAL_ERROR,\n-    "Internal: ELEMENT content corrupted invalid type\\n",\n-    NULL);\n+            if (content->c2) {\n+                if ((content->c2->type == XML_ELEMENT_CONTENT_SEQ) ||\n+                    ((content->c2->type == XML_ELEMENT_CONTENT_OR) &&\n+                     (content->c2->ocur != XML_ELEMENT_CONTENT_ONCE)))\n+                    xmlDumpElementContent(buf, content->c2, 1);\n+                else\n+                    xmlDumpElementContent(buf, content->c2, 0);\n+            }\n+            break;\n+        default:\n+            xmlErrValid(NULL, XML_ERR_INTERNAL_ERROR,\n+                "Internal: ELEMENT content corrupted invalid type\\n",\n+                NULL);\n     }\n     if (glob)\n         xmlBufferWriteChar(buf, ")");\n     switch (content->ocur) {\n         case XML_ELEMENT_CONTENT_ONCE:\n-    break;\n+            break;\n         case XML_ELEMENT_CONTENT_OPT:\n-    xmlBufferWriteChar(buf, "?");\n-    break;\n+            xmlBufferWriteChar(buf, "?");\n+            break;\n         case XML_ELEMENT_CONTENT_MULT:\n-    xmlBufferWriteChar(buf, "*");\n-    break;\n+            xmlBufferWriteChar(buf, "*");\n+            break;\n         case XML_ELEMENT_CONTENT_PLUS:\n-    xmlBufferWriteChar(buf, "+");\n-    break;\n+            xmlBufferWriteChar(buf, "+");\n+            break;\n     }\n }\n \n+\n /**\n  * xmlSprintfElementContent:\n  * @buf:  an output buffer\n', 'id': 86, 'location': '/data/vulnloc/libxml2/CVE-2017-5969/src/valid.c:1189:5'}, {'diff': '@@ -1155,6 +1155,7 @@\n  *\n  * This will dump the content of the element table as an XML DTD definition\n  */\n+\n static void\n xmlDumpElementContent(xmlBufferPtr buf, xmlElementContentPtr content, int glob) {\n     if (content == NULL) return;\n@@ -1163,64 +1164,69 @@\n     switch (content->type) {\n         case XML_ELEMENT_CONTENT_PCDATA:\n             xmlBufferWriteChar(buf, "#PCDATA");\n-    break;\n-case XML_ELEMENT_CONTENT_ELEMENT:\n-    if (content->prefix != NULL) {\n-xmlBufferWriteCHAR(buf, content->prefix);\n-xmlBufferWriteChar(buf, ":");\n-    }\n-    xmlBufferWriteCHAR(buf, content->name);\n-    break;\n-case XML_ELEMENT_CONTENT_SEQ:\n-    if ((content->c1->type == XML_ELEMENT_CONTENT_OR) ||\n-        (content->c1->type == XML_ELEMENT_CONTENT_SEQ))\n-xmlDumpElementContent(buf, content->c1, 1);\n-    else\n-xmlDumpElementContent(buf, content->c1, 0);\n+            break;\n+        case XML_ELEMENT_CONTENT_ELEMENT:\n+            if (content->prefix != NULL) {\n+                xmlBufferWriteCHAR(buf, content->prefix);\n+                xmlBufferWriteChar(buf, ":");\n+            }\n+            xmlBufferWriteCHAR(buf, content->name);\n+            break;\n+        case XML_ELEMENT_CONTENT_SEQ:\n+            if (content->c1 != NULL && \n+                (content->c1->type == XML_ELEMENT_CONTENT_OR || \n+                content->c1->type == XML_ELEMENT_CONTENT_SEQ))\n+                xmlDumpElementContent(buf, content->c1, 1);\n+            else if (content->c1 != NULL)\n+                xmlDumpElementContent(buf, content->c1, 0);\n             xmlBufferWriteChar(buf, " , ");\n-    if ((content->c2->type == XML_ELEMENT_CONTENT_OR) ||\n-        ((content->c2->type == XML_ELEMENT_CONTENT_SEQ) &&\n- (content->c2->ocur != XML_ELEMENT_CONTENT_ONCE)))\n-xmlDumpElementContent(buf, content->c2, 1);\n-    else\n-xmlDumpElementContent(buf, content->c2, 0);\n-    break;\n-case XML_ELEMENT_CONTENT_OR:\n-    if ((content->c1->type == XML_ELEMENT_CONTENT_OR) ||\n-        (content->c1->type == XML_ELEMENT_CONTENT_SEQ))\n-xmlDumpElementContent(buf, content->c1, 1);\n-    else\n-xmlDumpElementContent(buf, content->c1, 0);\n+            if (content->c2 != NULL && \n+                (content->c2->type == XML_ELEMENT_CONTENT_OR || \n+                (content->c2->type == XML_ELEMENT_CONTENT_SEQ && \n+                 content->c2->ocur != XML_ELEMENT_CONTENT_ONCE)))\n+                xmlDumpElementContent(buf, content->c2, 1);\n+            else if (content->c2 != NULL)\n+                xmlDumpElementContent(buf, content->c2, 0);\n+            break;\n+        case XML_ELEMENT_CONTENT_OR:\n+            if (content->c1 != NULL && \n+                (content->c1->type == XML_ELEMENT_CONTENT_OR || \n+                content->c1->type == XML_ELEMENT_CONTENT_SEQ))\n+                xmlDumpElementContent(buf, content->c1, 1);\n+            else if (content->c1 != NULL)\n+                xmlDumpElementContent(buf, content->c1, 0);\n             xmlBufferWriteChar(buf, " | ");\n-    if ((content->c2->type == XML_ELEMENT_CONTENT_SEQ) ||\n-        ((content->c2->type == XML_ELEMENT_CONTENT_OR) &&\n- (content->c2->ocur != XML_ELEMENT_CONTENT_ONCE)))\n-xmlDumpElementContent(buf, content->c2, 1);\n-    else\n-xmlDumpElementContent(buf, content->c2, 0);\n-    break;\n-default:\n-    xmlErrValid(NULL, XML_ERR_INTERNAL_ERROR,\n-    "Internal: ELEMENT content corrupted invalid type\\n",\n-    NULL);\n+            if (content->c2 != NULL && \n+                (content->c2->type == XML_ELEMENT_CONTENT_SEQ || \n+                (content->c2->type == XML_ELEMENT_CONTENT_OR && \n+                 content->c2->ocur != XML_ELEMENT_CONTENT_ONCE)))\n+                xmlDumpElementContent(buf, content->c2, 1);\n+            else if (content->c2 != NULL)\n+                xmlDumpElementContent(buf, content->c2, 0);\n+            break;\n+        default:\n+            xmlErrValid(NULL, XML_ERR_INTERNAL_ERROR,\n+            "Internal: ELEMENT content corrupted invalid type\\n",\n+            NULL);\n     }\n     if (glob)\n         xmlBufferWriteChar(buf, ")");\n     switch (content->ocur) {\n         case XML_ELEMENT_CONTENT_ONCE:\n-    break;\n+            break;\n         case XML_ELEMENT_CONTENT_OPT:\n-    xmlBufferWriteChar(buf, "?");\n-    break;\n+            xmlBufferWriteChar(buf, "?");\n+            break;\n         case XML_ELEMENT_CONTENT_MULT:\n-    xmlBufferWriteChar(buf, "*");\n-    break;\n+            xmlBufferWriteChar(buf, "*");\n+            break;\n         case XML_ELEMENT_CONTENT_PLUS:\n-    xmlBufferWriteChar(buf, "+");\n-    break;\n+            xmlBufferWriteChar(buf, "+");\n+            break;\n     }\n }\n \n+\n /**\n  * xmlSprintfElementContent:\n  * @buf:  an output buffer\n', 'id': 87, 'location': '/data/vulnloc/libxml2/CVE-2017-5969/src/valid.c:1189:5'}, {'diff': '@@ -1155,6 +1155,7 @@\n  *\n  * This will dump the content of the element table as an XML DTD definition\n  */\n+\n static void\n xmlDumpElementContent(xmlBufferPtr buf, xmlElementContentPtr content, int glob) {\n     if (content == NULL) return;\n@@ -1163,64 +1164,73 @@\n     switch (content->type) {\n         case XML_ELEMENT_CONTENT_PCDATA:\n             xmlBufferWriteChar(buf, "#PCDATA");\n-    break;\n-case XML_ELEMENT_CONTENT_ELEMENT:\n-    if (content->prefix != NULL) {\n-xmlBufferWriteCHAR(buf, content->prefix);\n-xmlBufferWriteChar(buf, ":");\n-    }\n-    xmlBufferWriteCHAR(buf, content->name);\n-    break;\n-case XML_ELEMENT_CONTENT_SEQ:\n-    if ((content->c1->type == XML_ELEMENT_CONTENT_OR) ||\n-        (content->c1->type == XML_ELEMENT_CONTENT_SEQ))\n-xmlDumpElementContent(buf, content->c1, 1);\n-    else\n-xmlDumpElementContent(buf, content->c1, 0);\n-            xmlBufferWriteChar(buf, " , ");\n-    if ((content->c2->type == XML_ELEMENT_CONTENT_OR) ||\n-        ((content->c2->type == XML_ELEMENT_CONTENT_SEQ) &&\n- (content->c2->ocur != XML_ELEMENT_CONTENT_ONCE)))\n-xmlDumpElementContent(buf, content->c2, 1);\n-    else\n-xmlDumpElementContent(buf, content->c2, 0);\n-    break;\n-case XML_ELEMENT_CONTENT_OR:\n-    if ((content->c1->type == XML_ELEMENT_CONTENT_OR) ||\n-        (content->c1->type == XML_ELEMENT_CONTENT_SEQ))\n-xmlDumpElementContent(buf, content->c1, 1);\n-    else\n-xmlDumpElementContent(buf, content->c1, 0);\n-            xmlBufferWriteChar(buf, " | ");\n-    if ((content->c2->type == XML_ELEMENT_CONTENT_SEQ) ||\n-        ((content->c2->type == XML_ELEMENT_CONTENT_OR) &&\n- (content->c2->ocur != XML_ELEMENT_CONTENT_ONCE)))\n-xmlDumpElementContent(buf, content->c2, 1);\n-    else\n-xmlDumpElementContent(buf, content->c2, 0);\n-    break;\n-default:\n-    xmlErrValid(NULL, XML_ERR_INTERNAL_ERROR,\n-    "Internal: ELEMENT content corrupted invalid type\\n",\n-    NULL);\n+            break;\n+        case XML_ELEMENT_CONTENT_ELEMENT:\n+            if (content->prefix != NULL) {\n+                xmlBufferWriteCHAR(buf, content->prefix);\n+                xmlBufferWriteChar(buf, ":");\n+            }\n+            xmlBufferWriteCHAR(buf, content->name);\n+            break;\n+        case XML_ELEMENT_CONTENT_SEQ:\n+            if (content->c1) {\n+                if ((content->c1->type == XML_ELEMENT_CONTENT_OR) ||\n+                    (content->c1->type == XML_ELEMENT_CONTENT_SEQ))\n+                    xmlDumpElementContent(buf, content->c1, 1);\n+                else\n+                    xmlDumpElementContent(buf, content->c1, 0);\n+                xmlBufferWriteChar(buf, " , ");\n+            }\n+            if (content->c2) {\n+                if ((content->c2->type == XML_ELEMENT_CONTENT_OR) ||\n+                    ((content->c2->type == XML_ELEMENT_CONTENT_SEQ) &&\n+                    (content->c2->ocur != XML_ELEMENT_CONTENT_ONCE)))\n+                    xmlDumpElementContent(buf, content->c2, 1);\n+                else\n+                    xmlDumpElementContent(buf, content->c2, 0);\n+            }\n+            break;\n+        case XML_ELEMENT_CONTENT_OR:\n+            if (content->c1) {\n+                if ((content->c1->type == XML_ELEMENT_CONTENT_OR) ||\n+                    (content->c1->type == XML_ELEMENT_CONTENT_SEQ))\n+                    xmlDumpElementContent(buf, content->c1, 1);\n+                else\n+                    xmlDumpElementContent(buf, content->c1, 0);\n+                xmlBufferWriteChar(buf, " | ");\n+            }\n+            if (content->c2) {\n+                if ((content->c2->type == XML_ELEMENT_CONTENT_SEQ) ||\n+                    ((content->c2->type == XML_ELEMENT_CONTENT_OR) &&\n+                    (content->c2->ocur != XML_ELEMENT_CONTENT_ONCE)))\n+                    xmlDumpElementContent(buf, content->c2, 1);\n+                else\n+                    xmlDumpElementContent(buf, content->c2, 0);\n+            }\n+            break;\n+        default:\n+            xmlErrValid(NULL, XML_ERR_INTERNAL_ERROR,\n+            "Internal: ELEMENT content corrupted invalid type\\n",\n+            NULL);\n     }\n     if (glob)\n         xmlBufferWriteChar(buf, ")");\n     switch (content->ocur) {\n         case XML_ELEMENT_CONTENT_ONCE:\n-    break;\n+            break;\n         case XML_ELEMENT_CONTENT_OPT:\n-    xmlBufferWriteChar(buf, "?");\n-    break;\n+            xmlBufferWriteChar(buf, "?");\n+            break;\n         case XML_ELEMENT_CONTENT_MULT:\n-    xmlBufferWriteChar(buf, "*");\n-    break;\n+            xmlBufferWriteChar(buf, "*");\n+            break;\n         case XML_ELEMENT_CONTENT_PLUS:\n-    xmlBufferWriteChar(buf, "+");\n-    break;\n+            xmlBufferWriteChar(buf, "+");\n+            break;\n     }\n }\n \n+\n /**\n  * xmlSprintfElementContent:\n  * @buf:  an output buffer\n', 'id': 88, 'location': '/data/vulnloc/libxml2/CVE-2017-5969/src/valid.c:1189:5'}, {'diff': '@@ -1155,6 +1155,7 @@\n  *\n  * This will dump the content of the element table as an XML DTD definition\n  */\n+\n static void\n xmlDumpElementContent(xmlBufferPtr buf, xmlElementContentPtr content, int glob) {\n     if (content == NULL) return;\n@@ -1163,64 +1164,69 @@\n     switch (content->type) {\n         case XML_ELEMENT_CONTENT_PCDATA:\n             xmlBufferWriteChar(buf, "#PCDATA");\n-    break;\n-case XML_ELEMENT_CONTENT_ELEMENT:\n-    if (content->prefix != NULL) {\n-xmlBufferWriteCHAR(buf, content->prefix);\n-xmlBufferWriteChar(buf, ":");\n-    }\n-    xmlBufferWriteCHAR(buf, content->name);\n-    break;\n-case XML_ELEMENT_CONTENT_SEQ:\n-    if ((content->c1->type == XML_ELEMENT_CONTENT_OR) ||\n-        (content->c1->type == XML_ELEMENT_CONTENT_SEQ))\n-xmlDumpElementContent(buf, content->c1, 1);\n-    else\n-xmlDumpElementContent(buf, content->c1, 0);\n+            break;\n+        case XML_ELEMENT_CONTENT_ELEMENT:\n+            if (content->prefix != NULL) {\n+                xmlBufferWriteCHAR(buf, content->prefix);\n+                xmlBufferWriteChar(buf, ":");\n+            }\n+            xmlBufferWriteCHAR(buf, content->name);\n+            break;\n+        case XML_ELEMENT_CONTENT_SEQ:\n+            if (content->c1 != NULL && \n+                ((content->c1->type == XML_ELEMENT_CONTENT_OR) ||\n+                (content->c1->type == XML_ELEMENT_CONTENT_SEQ)))\n+                xmlDumpElementContent(buf, content->c1, 1);\n+            else if (content->c1 != NULL)\n+                xmlDumpElementContent(buf, content->c1, 0);\n             xmlBufferWriteChar(buf, " , ");\n-    if ((content->c2->type == XML_ELEMENT_CONTENT_OR) ||\n-        ((content->c2->type == XML_ELEMENT_CONTENT_SEQ) &&\n- (content->c2->ocur != XML_ELEMENT_CONTENT_ONCE)))\n-xmlDumpElementContent(buf, content->c2, 1);\n-    else\n-xmlDumpElementContent(buf, content->c2, 0);\n-    break;\n-case XML_ELEMENT_CONTENT_OR:\n-    if ((content->c1->type == XML_ELEMENT_CONTENT_OR) ||\n-        (content->c1->type == XML_ELEMENT_CONTENT_SEQ))\n-xmlDumpElementContent(buf, content->c1, 1);\n-    else\n-xmlDumpElementContent(buf, content->c1, 0);\n+            if (content->c2 != NULL && \n+                ((content->c2->type == XML_ELEMENT_CONTENT_OR) ||\n+                ((content->c2->type == XML_ELEMENT_CONTENT_SEQ) && \n+                (content->c2->ocur != XML_ELEMENT_CONTENT_ONCE))))\n+                xmlDumpElementContent(buf, content->c2, 1);\n+            else if (content->c2 != NULL)\n+                xmlDumpElementContent(buf, content->c2, 0);\n+            break;\n+        case XML_ELEMENT_CONTENT_OR:\n+            if (content->c1 != NULL && \n+                ((content->c1->type == XML_ELEMENT_CONTENT_OR) ||\n+                (content->c1->type == XML_ELEMENT_CONTENT_SEQ)))\n+                xmlDumpElementContent(buf, content->c1, 1);\n+            else if (content->c1 != NULL)\n+                xmlDumpElementContent(buf, content->c1, 0);\n             xmlBufferWriteChar(buf, " | ");\n-    if ((content->c2->type == XML_ELEMENT_CONTENT_SEQ) ||\n-        ((content->c2->type == XML_ELEMENT_CONTENT_OR) &&\n- (content->c2->ocur != XML_ELEMENT_CONTENT_ONCE)))\n-xmlDumpElementContent(buf, content->c2, 1);\n-    else\n-xmlDumpElementContent(buf, content->c2, 0);\n-    break;\n-default:\n-    xmlErrValid(NULL, XML_ERR_INTERNAL_ERROR,\n-    "Internal: ELEMENT content corrupted invalid type\\n",\n-    NULL);\n+            if (content->c2 != NULL && \n+                ((content->c2->type == XML_ELEMENT_CONTENT_SEQ) ||\n+                ((content->c2->type == XML_ELEMENT_CONTENT_OR) && \n+                (content->c2->ocur != XML_ELEMENT_CONTENT_ONCE))))\n+                xmlDumpElementContent(buf, content->c2, 1);\n+            else if (content->c2 != NULL)\n+                xmlDumpElementContent(buf, content->c2, 0);\n+            break;\n+        default:\n+            xmlErrValid(NULL, XML_ERR_INTERNAL_ERROR,\n+                "Internal: ELEMENT content corrupted invalid type\\n",\n+                NULL);\n     }\n     if (glob)\n         xmlBufferWriteChar(buf, ")");\n     switch (content->ocur) {\n         case XML_ELEMENT_CONTENT_ONCE:\n-    break;\n+            break;\n         case XML_ELEMENT_CONTENT_OPT:\n-    xmlBufferWriteChar(buf, "?");\n-    break;\n+            xmlBufferWriteChar(buf, "?");\n+            break;\n         case XML_ELEMENT_CONTENT_MULT:\n-    xmlBufferWriteChar(buf, "*");\n-    break;\n+            xmlBufferWriteChar(buf, "*");\n+            break;\n         case XML_ELEMENT_CONTENT_PLUS:\n-    xmlBufferWriteChar(buf, "+");\n-    break;\n+            xmlBufferWriteChar(buf, "+");\n+            break;\n     }\n }\n \n+\n /**\n  * xmlSprintfElementContent:\n  * @buf:  an output buffer\n', 'id': 89, 'location': '/data/vulnloc/libxml2/CVE-2017-5969/src/valid.c:1189:5'}]2025-02-02 16:01:11.338 | INFO     | scenario:validate:475 - beginning candidate patch evaluation with time limit: 45 minutes
2025-02-02 16:01:11.339 | DEBUG    | scenario:rebuild:369 - original environment: environ({'CONDA_SHLVL': '2', 'LC_ALL': 'C.UTF-8', 'LS_COLORS': 'rs=0:di=01;34:ln=01;36:mh=00:pi=40;33:so=01;35:do=01;35:bd=40;33;01:cd=40;33;01:or=40;31;01:mi=00:su=37;41:sg=30;43:ca=30;41:tw=30;42:ow=34;42:st=37;44:ex=01;32:*.tar=01;31:*.tgz=01;31:*.arc=01;31:*.arj=01;31:*.taz=01;31:*.lha=01;31:*.lz4=01;31:*.lzh=01;31:*.lzma=01;31:*.tlz=01;31:*.txz=01;31:*.tzo=01;31:*.t7z=01;31:*.zip=01;31:*.z=01;31:*.Z=01;31:*.dz=01;31:*.gz=01;31:*.lrz=01;31:*.lz=01;31:*.lzo=01;31:*.xz=01;31:*.zst=01;31:*.tzst=01;31:*.bz2=01;31:*.bz=01;31:*.tbz=01;31:*.tbz2=01;31:*.tz=01;31:*.deb=01;31:*.rpm=01;31:*.jar=01;31:*.war=01;31:*.ear=01;31:*.sar=01;31:*.rar=01;31:*.alz=01;31:*.ace=01;31:*.zoo=01;31:*.cpio=01;31:*.7z=01;31:*.rz=01;31:*.cab=01;31:*.wim=01;31:*.swm=01;31:*.dwm=01;31:*.esd=01;31:*.jpg=01;35:*.jpeg=01;35:*.mjpg=01;35:*.mjpeg=01;35:*.gif=01;35:*.bmp=01;35:*.pbm=01;35:*.pgm=01;35:*.ppm=01;35:*.tga=01;35:*.xbm=01;35:*.xpm=01;35:*.tif=01;35:*.tiff=01;35:*.png=01;35:*.svg=01;35:*.svgz=01;35:*.mng=01;35:*.pcx=01;35:*.mov=01;35:*.mpg=01;35:*.mpeg=01;35:*.m2v=01;35:*.mkv=01;35:*.webm=01;35:*.ogm=01;35:*.mp4=01;35:*.m4v=01;35:*.mp4v=01;35:*.vob=01;35:*.qt=01;35:*.nuv=01;35:*.wmv=01;35:*.asf=01;35:*.rm=01;35:*.rmvb=01;35:*.flc=01;35:*.avi=01;35:*.fli=01;35:*.flv=01;35:*.gl=01;35:*.dl=01;35:*.xcf=01;35:*.xwd=01;35:*.yuv=01;35:*.cgm=01;35:*.emf=01;35:*.ogv=01;35:*.ogx=01;35:*.aac=00;36:*.au=00;36:*.flac=00;36:*.m4a=00;36:*.mid=00;36:*.midi=00;36:*.mka=00;36:*.mp3=00;36:*.mpc=00;36:*.ogg=00;36:*.ra=00;36:*.wav=00;36:*.oga=00;36:*.opus=00;36:*.spx=00;36:*.xspf=00;36:', 'LD_LIBRARY_PATH': '/opt/crashrepair/lib:/CrashRepair/lib:/klee/build/lib:', 'CONDA_EXE': '/root/anaconda3/bin/conda', 'LANG': 'C.UTF-8', 'TZ': 'Asia/Shanghai', 'HOSTNAME': 'fea22102047d', 'OLDPWD': '/orchestrator', 'CONDA_PREFIX': '/root/anaconda3/envs/CrashRepair', '_CE_M': '', 'CC': 'crepair-cc', 'LLVM_COMPILER': 'clang', 'CONDA_PREFIX_1': '/root/anaconda3', 'PWD': '/orchestrator/crashrepair', 'HOME': '/root', 'CONDA_PYTHON_EXE': '/root/anaconda3/bin/python', '_CE_CONDA': '', 'CONDA_PROMPT_MODIFIER': '(CrashRepair) ', 'CXX': 'crepair-cxx', 'TERM': 'xterm', 'SHLVL': '2', 'PYTHONPATH': '/usr/lib/python3.8/site-packages:', 'PATH': '/root/anaconda3/envs/CrashRepair/bin:/root/anaconda3/condabin:~/anaconda3/bin:/opt/crashrepair/bin:/CrashRepair/compiler:/klee/build/bin:/opt/llvm-6/bin:/klee/build/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', 'CONDA_DEFAULT_ENV': 'CrashRepair', '_': '/root/anaconda3/envs/CrashRepair/bin/python'})
2025-02-02 16:01:11.339 | DEBUG    | scenario:rebuild:382 - injecting ghost function into CFLAGS during build: -lcrepair_ghost
2025-02-02 16:01:11.339 | DEBUG    | scenario:rebuild:398 - using environment: {'INJECT_CFLAGS': '-g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address', 'INJECT_CXXFLAGS': '-g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address', 'INJECT_LDFLAGS': '-g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address'}
2025-02-02 16:01:11.339 | DEBUG    | shell:__call__:41 - executing: make clean
Making clean in include
make[1]: Entering directory '/data/vulnloc/libxml2/CVE-2017-5969/src/include'
Making clean in libxml
make[2]: Entering directory '/data/vulnloc/libxml2/CVE-2017-5969/src/include/libxml'
rm -rf .libs _libs
rm -f *.lo
make[2]: Leaving directory '/data/vulnloc/libxml2/CVE-2017-5969/src/include/libxml'
make[2]: Entering directory '/data/vulnloc/libxml2/CVE-2017-5969/src/include'
rm -rf .libs _libs
rm -f *.lo
make[2]: Leaving directory '/data/vulnloc/libxml2/CVE-2017-5969/src/include'
make[1]: Leaving directory '/data/vulnloc/libxml2/CVE-2017-5969/src/include'
Making clean in .
make[1]: Entering directory '/data/vulnloc/libxml2/CVE-2017-5969/src'
 rm -f xmllint xmlcatalog
test -z "runxmlconf.log test.out xml2Conf.sh *.gcda *.gcno *.res" || rm -f runxmlconf.log test.out xml2Conf.sh *.gcda *.gcno *.res
test -z "libxml2.la" || rm -f libxml2.la
rm -f ./so_locations
rm -rf .libs _libs
test -z "testdso.la" || rm -f testdso.la
rm -f ./so_locations
 rm -f testSchemas testRelax testSAX testHTML testXPath testURI testThreads testC14N testAutomata testRegexp testReader testapi testModule runtest runsuite testchar testdict runxmlconf testrecurse testlimits
rm -f *.o
rm -f *.lo
make[1]: Leaving directory '/data/vulnloc/libxml2/CVE-2017-5969/src'
Making clean in doc
make[1]: Entering directory '/data/vulnloc/libxml2/CVE-2017-5969/src/doc'
Making clean in .
make[2]: Entering directory '/data/vulnloc/libxml2/CVE-2017-5969/src/doc'
rm -rf .libs _libs
rm -f *~ *.bak *.hierarchy *.signals *-unused.txt
rm -f *.lo
make[2]: Leaving directory '/data/vulnloc/libxml2/CVE-2017-5969/src/doc'
Making clean in devhelp
make[2]: Entering directory '/data/vulnloc/libxml2/CVE-2017-5969/src/doc/devhelp'
rm -rf .libs _libs
rm -f *.lo
make[2]: Leaving directory '/data/vulnloc/libxml2/CVE-2017-5969/src/doc/devhelp'
Making clean in examples
make[2]: Entering directory '/data/vulnloc/libxml2/CVE-2017-5969/src/doc/examples'
test -z "*.tmp" || rm -f *.tmp
rm -rf .libs _libs
test -f Makefile.am || rm -f test?.xml
 rm -f io1 io2 parse1 parse2 parse3 parse4 reader1 reader2 reader3 reader4 testWriter tree1 tree2 xpath1 xpath2
rm -f *.o
rm -f *.lo
make[2]: Leaving directory '/data/vulnloc/libxml2/CVE-2017-5969/src/doc/examples'
make[1]: Leaving directory '/data/vulnloc/libxml2/CVE-2017-5969/src/doc'
Making clean in example
make[1]: Entering directory '/data/vulnloc/libxml2/CVE-2017-5969/src/example'
rm -rf .libs _libs
 rm -f gjobread
rm -f *.o
rm -f *.lo
make[1]: Leaving directory '/data/vulnloc/libxml2/CVE-2017-5969/src/example'
Making clean in xstc
make[1]: Entering directory '/data/vulnloc/libxml2/CVE-2017-5969/src/xstc'
test -z "nist-test.py ms-test.py sun-test.py test.log" || rm -f nist-test.py ms-test.py sun-test.py test.log
rm -rf .libs _libs
rm -f *.lo
make[1]: Leaving directory '/data/vulnloc/libxml2/CVE-2017-5969/src/xstc'
Making clean in python
make[1]: Entering directory '/data/vulnloc/libxml2/CVE-2017-5969/src/python'
Making clean in .
make[2]: Entering directory '/data/vulnloc/libxml2/CVE-2017-5969/src/python'
test -z "*.pyc" || rm -f *.pyc
rm -rf .libs _libs
test -z "libxml2mod.la" || rm -f libxml2mod.la
rm -f ./so_locations
rm -f *.o
rm -f *.lo
make[2]: Leaving directory '/data/vulnloc/libxml2/CVE-2017-5969/src/python'
Making clean in tests
make[2]: Entering directory '/data/vulnloc/libxml2/CVE-2017-5969/src/python/tests'
test -z "core tmp.xml *.pyc" || rm -f core tmp.xml *.pyc
rm -rf .libs _libs
rm -f *.lo
make[2]: Leaving directory '/data/vulnloc/libxml2/CVE-2017-5969/src/python/tests'
make[1]: Leaving directory '/data/vulnloc/libxml2/CVE-2017-5969/src/python'
2025-02-02 16:01:11.459 | DEBUG    | shell:__call__:41 - executing: make CFLAGS="${INJECT_CFLAGS}" CXXFLAGS="${INJECT_CXXFLAGS}" LDFLAGS="${INJECT_LDFLAGS}" xmllint
  CC       xmllint.o
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_ghost: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
  CC       SAX.lo
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_ghost: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
  CC       entities.lo
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_ghost: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
  CC       encoding.lo
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_ghost: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
  CC       error.lo
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_ghost: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
  CC       parserInternals.lo
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_ghost: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
  CC       parser.lo
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_ghost: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
  CC       tree.lo
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_ghost: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
  CC       hash.lo
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_ghost: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
  CC       list.lo
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_ghost: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
  CC       xmlIO.lo
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_ghost: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
  CC       xmlmemory.lo
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_ghost: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
  CC       uri.lo
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_ghost: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
  CC       valid.lo
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_ghost: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
  CC       xlink.lo
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_ghost: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
  CC       HTMLparser.lo
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_ghost: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
  CC       HTMLtree.lo
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_ghost: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
  CC       debugXML.lo
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_ghost: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
  CC       xpath.lo
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_ghost: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
xpath.c:3148:23: warning: implicit declaration of function 'fabs_crepair' is invalid in C99 [-Wimplicit-function-declaration]
            absolute_value = fabs_crepair(number);
                             ^
xpath.c:12420:28: warning: comparison of two values with different enumeration types ('xmlElementType' and 'xmlXPathTypeVal') [-Wenum-compare]
                    } else if (cur->type == type) {
                               ~~~~~~~~~ ^  ~~~~
2 warnings generated.
xpath.c:3148:23: warning: implicit declaration of function 'fabs_crepair' is invalid in C99 [-Wimplicit-function-declaration]
            absolute_value = fabs_crepair(number);
                             ^
xpath.c:12420:28: warning: comparison of two values with different enumeration types ('xmlElementType' and 'xmlXPathTypeVal') [-Wenum-compare]
                    } else if (cur->type == type) {
                               ~~~~~~~~~ ^  ~~~~
2 warnings generated.
  CC       xpointer.lo
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_ghost: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
  CC       xinclude.lo
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_ghost: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
  CC       nanohttp.lo
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_ghost: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
nanohttp.c:1002:67: warning: passing 'int *' to parameter of type 'socklen_t *' (aka 'unsigned int *') converts between pointers to integer types with different sign [-Wpointer-sign]
        if (getsockopt(s, SOL_SOCKET, SO_ERROR, (char *) &status, &len) <
                                                                  ^~~~
/usr/include/x86_64-linux-gnu/sys/socket.h:210:32: note: passing argument to parameter '__optlen' here
                       socklen_t *__restrict __optlen) __THROW;
                                             ^
nanohttp.c:1537:38: warning: while loop has empty body [-Wempty-body]
        while ( xmlNanoHTTPRecv(ctxt) > 0 ) ;
                                            ^
nanohttp.c:1537:38: note: put the semicolon on a separate line to silence this warning
2 warnings generated.
nanohttp.c:1002:67: warning: passing 'int *' to parameter of type 'socklen_t *' (aka 'unsigned int *') converts between pointers to integer types with different sign [-Wpointer-sign]
        if (getsockopt(s, SOL_SOCKET, SO_ERROR, (char *) &status, &len) <
                                                                  ^~~~
/usr/include/x86_64-linux-gnu/sys/socket.h:210:32: note: passing argument to parameter '__optlen' here
                       socklen_t *__restrict __optlen) __THROW;
                                             ^
nanohttp.c:1537:38: warning: while loop has empty body [-Wempty-body]
        while ( xmlNanoHTTPRecv(ctxt) > 0 ) ;
                                            ^
nanohttp.c:1537:38: note: put the semicolon on a separate line to silence this warning
2 warnings generated.
  CC       nanoftp.lo
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_ghost: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
nanoftp.c:1479:66: warning: passing 'int *' to parameter of type 'socklen_t *' (aka 'unsigned int *') converts between pointers to integer types with different sign [-Wpointer-sign]
        getsockname(ctxt->dataFd, (struct sockaddr *) &dataAddr, &dataAddrLen);
                                                                 ^~~~~~~~~~~~
/usr/include/x86_64-linux-gnu/sys/socket.h:117:26: note: passing argument to parameter '__len' here
                        socklen_t *__restrict __len) __THROW;
                                              ^
nanoftp.c:1492:66: warning: passing 'int *' to parameter of type 'socklen_t *' (aka 'unsigned int *') converts between pointers to integer types with different sign [-Wpointer-sign]
        getsockname(ctxt->dataFd, (struct sockaddr *) &dataAddr, &dataAddrLen);
                                                                 ^~~~~~~~~~~~
/usr/include/x86_64-linux-gnu/sys/socket.h:117:26: note: passing argument to parameter '__len' here
                        socklen_t *__restrict __len) __THROW;
                                              ^
2 warnings generated.
nanoftp.c:1479:66: warning: passing 'int *' to parameter of type 'socklen_t *' (aka 'unsigned int *') converts between pointers to integer types with different sign [-Wpointer-sign]
        getsockname(ctxt->dataFd, (struct sockaddr *) &dataAddr, &dataAddrLen);
                                                                 ^~~~~~~~~~~~
/usr/include/x86_64-linux-gnu/sys/socket.h:117:26: note: passing argument to parameter '__len' here
                        socklen_t *__restrict __len) __THROW;
                                              ^
nanoftp.c:1492:66: warning: passing 'int *' to parameter of type 'socklen_t *' (aka 'unsigned int *') converts between pointers to integer types with different sign [-Wpointer-sign]
        getsockname(ctxt->dataFd, (struct sockaddr *) &dataAddr, &dataAddrLen);
                                                                 ^~~~~~~~~~~~
/usr/include/x86_64-linux-gnu/sys/socket.h:117:26: note: passing argument to parameter '__len' here
                        socklen_t *__restrict __len) __THROW;
                                              ^
2 warnings generated.
  CC       catalog.lo
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_ghost: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
  CC       globals.lo
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_ghost: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
  CC       threads.lo
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_ghost: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
  CC       c14n.lo
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_ghost: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
  CC       xmlstring.lo
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_ghost: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
  CC       buf.lo
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_ghost: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
  CC       xmlregexp.lo
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_ghost: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
  CC       xmlschemas.lo
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_ghost: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
  CC       xmlschemastypes.lo
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_ghost: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
xmlschemastypes.c:5879:35: warning: implicit declaration of function 'fabs_crepair' is invalid in C99 [-Wimplicit-function-declaration]
                day = (unsigned long) FQUOTIENT(fabs_crepair(val->value.dur.sec), 86400);
                                                ^
1 warning generated.
xmlschemastypes.c:5879:35: warning: implicit declaration of function 'fabs_crepair' is invalid in C99 [-Wimplicit-function-declaration]
                day = (unsigned long) FQUOTIENT(fabs_crepair(val->value.dur.sec), 86400);
                                                ^
1 warning generated.
  CC       xmlunicode.lo
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_ghost: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
  CC       xmlreader.lo
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_ghost: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
  CC       relaxng.lo
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_ghost: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
  CC       dict.lo
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_ghost: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
  CC       SAX2.lo
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_ghost: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
  CC       xmlwriter.lo
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_ghost: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
  CC       legacy.lo
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_ghost: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
  CC       chvalid.lo
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_ghost: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
  CC       pattern.lo
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_ghost: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
  CC       xmlsave.lo
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_ghost: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
  CC       xmlmodule.lo
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_ghost: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
  CC       schematron.lo
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_ghost: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
  CC       xzlib.lo
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_ghost: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
  CCLD     libxml2.la
ar: `u' modifier ignored since `D' is the default (see `U')
  CCLD     xmllint
2025-02-02 16:01:20.597 | INFO     | scenario:evaluate:635 - evaluating candidate patch #0:
@@ -1155,6 +1155,7 @@
  *
  * This will dump the content of the element table as an XML DTD definition
  */
+
 static void
 xmlDumpElementContent(xmlBufferPtr buf, xmlElementContentPtr content, int glob) {
     if (content == NULL) return;
@@ -1163,64 +1164,67 @@
     switch (content->type) {
         case XML_ELEMENT_CONTENT_PCDATA:
             xmlBufferWriteChar(buf, "#PCDATA");
-    break;
-case XML_ELEMENT_CONTENT_ELEMENT:
-    if (content->prefix != NULL) {
-xmlBufferWriteCHAR(buf, content->prefix);
-xmlBufferWriteChar(buf, ":");
-    }
-    xmlBufferWriteCHAR(buf, content->name);
-    break;
-case XML_ELEMENT_CONTENT_SEQ:
-    if ((content->c1->type == XML_ELEMENT_CONTENT_OR) ||
-        (content->c1->type == XML_ELEMENT_CONTENT_SEQ))
-xmlDumpElementContent(buf, content->c1, 1);
-    else
-xmlDumpElementContent(buf, content->c1, 0);
+            break;
+        case XML_ELEMENT_CONTENT_ELEMENT:
+            if (content->prefix != NULL && content->name != NULL) {
+                xmlBufferWriteCHAR(buf, content->prefix);
+                xmlBufferWriteChar(buf, ":");
+            }
+            if (content->name != NULL) {
+                xmlBufferWriteCHAR(buf, content->name);
+            }
+            break;
+        case XML_ELEMENT_CONTENT_SEQ:
+            if ((content->c1->type == XML_ELEMENT_CONTENT_OR) ||
+                (content->c1->type == XML_ELEMENT_CONTENT_SEQ))
+                xmlDumpElementContent(buf, content->c1, 1);
+            else
+                xmlDumpElementContent(buf, content->c1, 0);
             xmlBufferWriteChar(buf, " , ");
-    if ((content->c2->type == XML_ELEMENT_CONTENT_OR) ||
-        ((content->c2->type == XML_ELEMENT_CONTENT_SEQ) &&
- (content->c2->ocur != XML_ELEMENT_CONTENT_ONCE)))
-xmlDumpElementContent(buf, content->c2, 1);
-    else
-xmlDumpElementContent(buf, content->c2, 0);
-    break;
-case XML_ELEMENT_CONTENT_OR:
-    if ((content->c1->type == XML_ELEMENT_CONTENT_OR) ||
-        (content->c1->type == XML_ELEMENT_CONTENT_SEQ))
-xmlDumpElementContent(buf, content->c1, 1);
-    else
-xmlDumpElementContent(buf, content->c1, 0);
+            if ((content->c2->type == XML_ELEMENT_CONTENT_OR) ||
+                ((content->c2->type == XML_ELEMENT_CONTENT_SEQ) &&
+                (content->c2->ocur != XML_ELEMENT_CONTENT_ONCE)))
+                xmlDumpElementContent(buf, content->c2, 1);
+            else
+                xmlDumpElementContent(buf, content->c2, 0);
+            break;
+        case XML_ELEMENT_CONTENT_OR:
+            if ((content->c1->type == XML_ELEMENT_CONTENT_OR) ||
+                (content->c1->type == XML_ELEMENT_CONTENT_SEQ))
+                xmlDumpElementContent(buf, content->c1, 1);
+            else
+                xmlDumpElementContent(buf, content->c1, 0);
             xmlBufferWriteChar(buf, " | ");
-    if ((content->c2->type == XML_ELEMENT_CONTENT_SEQ) ||
-        ((content->c2->type == XML_ELEMENT_CONTENT_OR) &&
- (content->c2->ocur != XML_ELEMENT_CONTENT_ONCE)))
-xmlDumpElementContent(buf, content->c2, 1);
-    else
-xmlDumpElementContent(buf, content->c2, 0);
-    break;
-default:
-    xmlErrValid(NULL, XML_ERR_INTERNAL_ERROR,
-    "Internal: ELEMENT content corrupted invalid type\n",
-    NULL);
+            if ((content->c2->type == XML_ELEMENT_CONTENT_SEQ) ||
+                ((content->c2->type == XML_ELEMENT_CONTENT_OR) &&
+                (content->c2->ocur != XML_ELEMENT_CONTENT_ONCE)))
+                xmlDumpElementContent(buf, content->c2, 1);
+            else
+                xmlDumpElementContent(buf, content->c2, 0);
+            break;
+        default:
+            xmlErrValid(NULL, XML_ERR_INTERNAL_ERROR,
+                "Internal: ELEMENT content corrupted invalid type\n",
+                NULL);
     }
     if (glob)
         xmlBufferWriteChar(buf, ")");
     switch (content->ocur) {
         case XML_ELEMENT_CONTENT_ONCE:
-    break;
+            break;
         case XML_ELEMENT_CONTENT_OPT:
-    xmlBufferWriteChar(buf, "?");
-    break;
+            xmlBufferWriteChar(buf, "?");
+            break;
         case XML_ELEMENT_CONTENT_MULT:
-    xmlBufferWriteChar(buf, "*");
-    break;
+            xmlBufferWriteChar(buf, "*");
+            break;
         case XML_ELEMENT_CONTENT_PLUS:
-    xmlBufferWriteChar(buf, "+");
-    break;
+            xmlBufferWriteChar(buf, "+");
+            break;
     }
 }
 
+
 /**
  * xmlSprintfElementContent:
  * @buf:  an output buffer

2025-02-02 16:01:20.605 | DEBUG    | scenario:rebuild:369 - original environment: environ({'CONDA_SHLVL': '2', 'LC_ALL': 'C.UTF-8', 'LS_COLORS': 'rs=0:di=01;34:ln=01;36:mh=00:pi=40;33:so=01;35:do=01;35:bd=40;33;01:cd=40;33;01:or=40;31;01:mi=00:su=37;41:sg=30;43:ca=30;41:tw=30;42:ow=34;42:st=37;44:ex=01;32:*.tar=01;31:*.tgz=01;31:*.arc=01;31:*.arj=01;31:*.taz=01;31:*.lha=01;31:*.lz4=01;31:*.lzh=01;31:*.lzma=01;31:*.tlz=01;31:*.txz=01;31:*.tzo=01;31:*.t7z=01;31:*.zip=01;31:*.z=01;31:*.Z=01;31:*.dz=01;31:*.gz=01;31:*.lrz=01;31:*.lz=01;31:*.lzo=01;31:*.xz=01;31:*.zst=01;31:*.tzst=01;31:*.bz2=01;31:*.bz=01;31:*.tbz=01;31:*.tbz2=01;31:*.tz=01;31:*.deb=01;31:*.rpm=01;31:*.jar=01;31:*.war=01;31:*.ear=01;31:*.sar=01;31:*.rar=01;31:*.alz=01;31:*.ace=01;31:*.zoo=01;31:*.cpio=01;31:*.7z=01;31:*.rz=01;31:*.cab=01;31:*.wim=01;31:*.swm=01;31:*.dwm=01;31:*.esd=01;31:*.jpg=01;35:*.jpeg=01;35:*.mjpg=01;35:*.mjpeg=01;35:*.gif=01;35:*.bmp=01;35:*.pbm=01;35:*.pgm=01;35:*.ppm=01;35:*.tga=01;35:*.xbm=01;35:*.xpm=01;35:*.tif=01;35:*.tiff=01;35:*.png=01;35:*.svg=01;35:*.svgz=01;35:*.mng=01;35:*.pcx=01;35:*.mov=01;35:*.mpg=01;35:*.mpeg=01;35:*.m2v=01;35:*.mkv=01;35:*.webm=01;35:*.ogm=01;35:*.mp4=01;35:*.m4v=01;35:*.mp4v=01;35:*.vob=01;35:*.qt=01;35:*.nuv=01;35:*.wmv=01;35:*.asf=01;35:*.rm=01;35:*.rmvb=01;35:*.flc=01;35:*.avi=01;35:*.fli=01;35:*.flv=01;35:*.gl=01;35:*.dl=01;35:*.xcf=01;35:*.xwd=01;35:*.yuv=01;35:*.cgm=01;35:*.emf=01;35:*.ogv=01;35:*.ogx=01;35:*.aac=00;36:*.au=00;36:*.flac=00;36:*.m4a=00;36:*.mid=00;36:*.midi=00;36:*.mka=00;36:*.mp3=00;36:*.mpc=00;36:*.ogg=00;36:*.ra=00;36:*.wav=00;36:*.oga=00;36:*.opus=00;36:*.spx=00;36:*.xspf=00;36:', 'LD_LIBRARY_PATH': '/opt/crashrepair/lib:/CrashRepair/lib:/klee/build/lib:', 'CONDA_EXE': '/root/anaconda3/bin/conda', 'LANG': 'C.UTF-8', 'TZ': 'Asia/Shanghai', 'HOSTNAME': 'fea22102047d', 'OLDPWD': '/orchestrator', 'CONDA_PREFIX': '/root/anaconda3/envs/CrashRepair', '_CE_M': '', 'CC': 'crepair-cc', 'LLVM_COMPILER': 'clang', 'CONDA_PREFIX_1': '/root/anaconda3', 'PWD': '/orchestrator/crashrepair', 'HOME': '/root', 'CONDA_PYTHON_EXE': '/root/anaconda3/bin/python', '_CE_CONDA': '', 'CONDA_PROMPT_MODIFIER': '(CrashRepair) ', 'CXX': 'crepair-cxx', 'TERM': 'xterm', 'SHLVL': '2', 'PYTHONPATH': '/usr/lib/python3.8/site-packages:', 'PATH': '/root/anaconda3/envs/CrashRepair/bin:/root/anaconda3/condabin:~/anaconda3/bin:/opt/crashrepair/bin:/CrashRepair/compiler:/klee/build/bin:/opt/llvm-6/bin:/klee/build/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', 'CONDA_DEFAULT_ENV': 'CrashRepair', '_': '/root/anaconda3/envs/CrashRepair/bin/python'})
2025-02-02 16:01:20.605 | DEBUG    | scenario:rebuild:382 - injecting ghost function into CFLAGS during build: -lcrepair_ghost
2025-02-02 16:01:20.605 | DEBUG    | scenario:rebuild:398 - using environment: {'INJECT_CFLAGS': '-g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address', 'INJECT_CXXFLAGS': '-g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address', 'INJECT_LDFLAGS': '-g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address'}
2025-02-02 16:01:20.605 | DEBUG    | shell:__call__:41 - executing: make CFLAGS="${INJECT_CFLAGS}" CXXFLAGS="${INJECT_CXXFLAGS}" LDFLAGS="${INJECT_LDFLAGS}" xmllint
  CC       valid.lo
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_ghost: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
  CCLD     libxml2.la
ar: `u' modifier ignored since `D' is the default (see `U')
  CCLD     xmllint
2025-02-02 16:01:21.075 | DEBUG    | scenario:evaluate:655 - testing candidate #0 against test #crash...
2025-02-02 16:01:21.075 | DEBUG    | shell:__call__:41 - executing: /data//vulnloc/libxml2/CVE-2017-5969/src/xmllint --recover /CrashRepair/experiments/vulnloc/libxml2/CVE-2017-5969/tests/1.xml
2025-02-02 16:01:21.089 | DEBUG    | test:run:189 - test failed: unexpected exit code (actual: 139, expected: 0)
2025-02-02 16:01:21.089 | INFO     | scenario:evaluate:662 - candidate #0 fails test #crash
2025-02-02 16:01:21.096 | INFO     | scenario:evaluate:635 - evaluating candidate patch #1:
@@ -1155,6 +1155,7 @@
  *
  * This will dump the content of the element table as an XML DTD definition
  */
+
 static void
 xmlDumpElementContent(xmlBufferPtr buf, xmlElementContentPtr content, int glob) {
     if (content == NULL) return;
@@ -1163,64 +1164,67 @@
     switch (content->type) {
         case XML_ELEMENT_CONTENT_PCDATA:
             xmlBufferWriteChar(buf, "#PCDATA");
-    break;
-case XML_ELEMENT_CONTENT_ELEMENT:
-    if (content->prefix != NULL) {
-xmlBufferWriteCHAR(buf, content->prefix);
-xmlBufferWriteChar(buf, ":");
-    }
-    xmlBufferWriteCHAR(buf, content->name);
-    break;
-case XML_ELEMENT_CONTENT_SEQ:
-    if ((content->c1->type == XML_ELEMENT_CONTENT_OR) ||
-        (content->c1->type == XML_ELEMENT_CONTENT_SEQ))
-xmlDumpElementContent(buf, content->c1, 1);
-    else
-xmlDumpElementContent(buf, content->c1, 0);
+            break;
+        case XML_ELEMENT_CONTENT_ELEMENT:
+            if (content->prefix != NULL && content->name != NULL) {
+                xmlBufferWriteCHAR(buf, content->prefix);
+                xmlBufferWriteChar(buf, ":");
+                xmlBufferWriteCHAR(buf, content->name);
+            } else if (content->name != NULL) {
+                xmlBufferWriteCHAR(buf, content->name);
+            }
+            break;
+        case XML_ELEMENT_CONTENT_SEQ:
+            if ((content->c1->type == XML_ELEMENT_CONTENT_OR) ||
+                (content->c1->type == XML_ELEMENT_CONTENT_SEQ))
+                xmlDumpElementContent(buf, content->c1, 1);
+            else
+                xmlDumpElementContent(buf, content->c1, 0);
             xmlBufferWriteChar(buf, " , ");
-    if ((content->c2->type == XML_ELEMENT_CONTENT_OR) ||
-        ((content->c2->type == XML_ELEMENT_CONTENT_SEQ) &&
- (content->c2->ocur != XML_ELEMENT_CONTENT_ONCE)))
-xmlDumpElementContent(buf, content->c2, 1);
-    else
-xmlDumpElementContent(buf, content->c2, 0);
-    break;
-case XML_ELEMENT_CONTENT_OR:
-    if ((content->c1->type == XML_ELEMENT_CONTENT_OR) ||
-        (content->c1->type == XML_ELEMENT_CONTENT_SEQ))
-xmlDumpElementContent(buf, content->c1, 1);
-    else
-xmlDumpElementContent(buf, content->c1, 0);
+            if ((content->c2->type == XML_ELEMENT_CONTENT_OR) ||
+                ((content->c2->type == XML_ELEMENT_CONTENT_SEQ) &&
+                (content->c2->ocur != XML_ELEMENT_CONTENT_ONCE)))
+                xmlDumpElementContent(buf, content->c2, 1);
+            else
+                xmlDumpElementContent(buf, content->c2, 0);
+            break;
+        case XML_ELEMENT_CONTENT_OR:
+            if ((content->c1->type == XML_ELEMENT_CONTENT_OR) ||
+                (content->c1->type == XML_ELEMENT_CONTENT_SEQ))
+                xmlDumpElementContent(buf, content->c1, 1);
+            else
+                xmlDumpElementContent(buf, content->c1, 0);
             xmlBufferWriteChar(buf, " | ");
-    if ((content->c2->type == XML_ELEMENT_CONTENT_SEQ) ||
-        ((content->c2->type == XML_ELEMENT_CONTENT_OR) &&
- (content->c2->ocur != XML_ELEMENT_CONTENT_ONCE)))
-xmlDumpElementContent(buf, content->c2, 1);
-    else
-xmlDumpElementContent(buf, content->c2, 0);
-    break;
-default:
-    xmlErrValid(NULL, XML_ERR_INTERNAL_ERROR,
-    "Internal: ELEMENT content corrupted invalid type\n",
-    NULL);
+            if ((content->c2->type == XML_ELEMENT_CONTENT_SEQ) ||
+                ((content->c2->type == XML_ELEMENT_CONTENT_OR) &&
+                (content->c2->ocur != XML_ELEMENT_CONTENT_ONCE)))
+                xmlDumpElementContent(buf, content->c2, 1);
+            else
+                xmlDumpElementContent(buf, content->c2, 0);
+            break;
+        default:
+            xmlErrValid(NULL, XML_ERR_INTERNAL_ERROR,
+            "Internal: ELEMENT content corrupted invalid type\n",
+            NULL);
     }
     if (glob)
         xmlBufferWriteChar(buf, ")");
     switch (content->ocur) {
         case XML_ELEMENT_CONTENT_ONCE:
-    break;
+            break;
         case XML_ELEMENT_CONTENT_OPT:
-    xmlBufferWriteChar(buf, "?");
-    break;
+            xmlBufferWriteChar(buf, "?");
+            break;
         case XML_ELEMENT_CONTENT_MULT:
-    xmlBufferWriteChar(buf, "*");
-    break;
+            xmlBufferWriteChar(buf, "*");
+            break;
         case XML_ELEMENT_CONTENT_PLUS:
-    xmlBufferWriteChar(buf, "+");
-    break;
+            xmlBufferWriteChar(buf, "+");
+            break;
     }
 }
 
+
 /**
  * xmlSprintfElementContent:
  * @buf:  an output buffer

2025-02-02 16:01:21.103 | DEBUG    | scenario:rebuild:369 - original environment: environ({'CONDA_SHLVL': '2', 'LC_ALL': 'C.UTF-8', 'LS_COLORS': 'rs=0:di=01;34:ln=01;36:mh=00:pi=40;33:so=01;35:do=01;35:bd=40;33;01:cd=40;33;01:or=40;31;01:mi=00:su=37;41:sg=30;43:ca=30;41:tw=30;42:ow=34;42:st=37;44:ex=01;32:*.tar=01;31:*.tgz=01;31:*.arc=01;31:*.arj=01;31:*.taz=01;31:*.lha=01;31:*.lz4=01;31:*.lzh=01;31:*.lzma=01;31:*.tlz=01;31:*.txz=01;31:*.tzo=01;31:*.t7z=01;31:*.zip=01;31:*.z=01;31:*.Z=01;31:*.dz=01;31:*.gz=01;31:*.lrz=01;31:*.lz=01;31:*.lzo=01;31:*.xz=01;31:*.zst=01;31:*.tzst=01;31:*.bz2=01;31:*.bz=01;31:*.tbz=01;31:*.tbz2=01;31:*.tz=01;31:*.deb=01;31:*.rpm=01;31:*.jar=01;31:*.war=01;31:*.ear=01;31:*.sar=01;31:*.rar=01;31:*.alz=01;31:*.ace=01;31:*.zoo=01;31:*.cpio=01;31:*.7z=01;31:*.rz=01;31:*.cab=01;31:*.wim=01;31:*.swm=01;31:*.dwm=01;31:*.esd=01;31:*.jpg=01;35:*.jpeg=01;35:*.mjpg=01;35:*.mjpeg=01;35:*.gif=01;35:*.bmp=01;35:*.pbm=01;35:*.pgm=01;35:*.ppm=01;35:*.tga=01;35:*.xbm=01;35:*.xpm=01;35:*.tif=01;35:*.tiff=01;35:*.png=01;35:*.svg=01;35:*.svgz=01;35:*.mng=01;35:*.pcx=01;35:*.mov=01;35:*.mpg=01;35:*.mpeg=01;35:*.m2v=01;35:*.mkv=01;35:*.webm=01;35:*.ogm=01;35:*.mp4=01;35:*.m4v=01;35:*.mp4v=01;35:*.vob=01;35:*.qt=01;35:*.nuv=01;35:*.wmv=01;35:*.asf=01;35:*.rm=01;35:*.rmvb=01;35:*.flc=01;35:*.avi=01;35:*.fli=01;35:*.flv=01;35:*.gl=01;35:*.dl=01;35:*.xcf=01;35:*.xwd=01;35:*.yuv=01;35:*.cgm=01;35:*.emf=01;35:*.ogv=01;35:*.ogx=01;35:*.aac=00;36:*.au=00;36:*.flac=00;36:*.m4a=00;36:*.mid=00;36:*.midi=00;36:*.mka=00;36:*.mp3=00;36:*.mpc=00;36:*.ogg=00;36:*.ra=00;36:*.wav=00;36:*.oga=00;36:*.opus=00;36:*.spx=00;36:*.xspf=00;36:', 'LD_LIBRARY_PATH': '/opt/crashrepair/lib:/CrashRepair/lib:/klee/build/lib:', 'CONDA_EXE': '/root/anaconda3/bin/conda', 'LANG': 'C.UTF-8', 'TZ': 'Asia/Shanghai', 'HOSTNAME': 'fea22102047d', 'OLDPWD': '/orchestrator', 'CONDA_PREFIX': '/root/anaconda3/envs/CrashRepair', '_CE_M': '', 'CC': 'crepair-cc', 'LLVM_COMPILER': 'clang', 'CONDA_PREFIX_1': '/root/anaconda3', 'PWD': '/orchestrator/crashrepair', 'HOME': '/root', 'CONDA_PYTHON_EXE': '/root/anaconda3/bin/python', '_CE_CONDA': '', 'CONDA_PROMPT_MODIFIER': '(CrashRepair) ', 'CXX': 'crepair-cxx', 'TERM': 'xterm', 'SHLVL': '2', 'PYTHONPATH': '/usr/lib/python3.8/site-packages:', 'PATH': '/root/anaconda3/envs/CrashRepair/bin:/root/anaconda3/condabin:~/anaconda3/bin:/opt/crashrepair/bin:/CrashRepair/compiler:/klee/build/bin:/opt/llvm-6/bin:/klee/build/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', 'CONDA_DEFAULT_ENV': 'CrashRepair', '_': '/root/anaconda3/envs/CrashRepair/bin/python'})
2025-02-02 16:01:21.103 | DEBUG    | scenario:rebuild:382 - injecting ghost function into CFLAGS during build: -lcrepair_ghost
2025-02-02 16:01:21.103 | DEBUG    | scenario:rebuild:398 - using environment: {'INJECT_CFLAGS': '-g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address', 'INJECT_CXXFLAGS': '-g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address', 'INJECT_LDFLAGS': '-g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address'}
2025-02-02 16:01:21.103 | DEBUG    | shell:__call__:41 - executing: make CFLAGS="${INJECT_CFLAGS}" CXXFLAGS="${INJECT_CXXFLAGS}" LDFLAGS="${INJECT_LDFLAGS}" xmllint
  CC       valid.lo
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_ghost: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
  CCLD     libxml2.la
ar: `u' modifier ignored since `D' is the default (see `U')
  CCLD     xmllint
2025-02-02 16:01:21.586 | DEBUG    | scenario:evaluate:655 - testing candidate #1 against test #crash...
2025-02-02 16:01:21.586 | DEBUG    | shell:__call__:41 - executing: /data//vulnloc/libxml2/CVE-2017-5969/src/xmllint --recover /CrashRepair/experiments/vulnloc/libxml2/CVE-2017-5969/tests/1.xml
2025-02-02 16:01:21.595 | DEBUG    | test:run:189 - test failed: unexpected exit code (actual: 139, expected: 0)
2025-02-02 16:01:21.595 | INFO     | scenario:evaluate:662 - candidate #1 fails test #crash
2025-02-02 16:01:21.600 | INFO     | scenario:evaluate:635 - evaluating candidate patch #2:
@@ -1155,6 +1155,7 @@
  *
  * This will dump the content of the element table as an XML DTD definition
  */
+
 static void
 xmlDumpElementContent(xmlBufferPtr buf, xmlElementContentPtr content, int glob) {
     if (content == NULL) return;
@@ -1163,64 +1164,67 @@
     switch (content->type) {
         case XML_ELEMENT_CONTENT_PCDATA:
             xmlBufferWriteChar(buf, "#PCDATA");
-    break;
-case XML_ELEMENT_CONTENT_ELEMENT:
-    if (content->prefix != NULL) {
-xmlBufferWriteCHAR(buf, content->prefix);
-xmlBufferWriteChar(buf, ":");
-    }
-    xmlBufferWriteCHAR(buf, content->name);
-    break;
-case XML_ELEMENT_CONTENT_SEQ:
-    if ((content->c1->type == XML_ELEMENT_CONTENT_OR) ||
-        (content->c1->type == XML_ELEMENT_CONTENT_SEQ))
-xmlDumpElementContent(buf, content->c1, 1);
-    else
-xmlDumpElementContent(buf, content->c1, 0);
+            break;
+        case XML_ELEMENT_CONTENT_ELEMENT:
+            if (content->name != NULL) {
+                if (content->prefix != NULL) {
+                    xmlBufferWriteCHAR(buf, content->prefix);
+                    xmlBufferWriteChar(buf, ":");
+                }
+                xmlBufferWriteCHAR(buf, content->name);
+            }
+            break;
+        case XML_ELEMENT_CONTENT_SEQ:
+            if ((content->c1->type == XML_ELEMENT_CONTENT_OR) ||
+                (content->c1->type == XML_ELEMENT_CONTENT_SEQ))
+                xmlDumpElementContent(buf, content->c1, 1);
+            else
+                xmlDumpElementContent(buf, content->c1, 0);
             xmlBufferWriteChar(buf, " , ");
-    if ((content->c2->type == XML_ELEMENT_CONTENT_OR) ||
-        ((content->c2->type == XML_ELEMENT_CONTENT_SEQ) &&
- (content->c2->ocur != XML_ELEMENT_CONTENT_ONCE)))
-xmlDumpElementContent(buf, content->c2, 1);
-    else
-xmlDumpElementContent(buf, content->c2, 0);
-    break;
-case XML_ELEMENT_CONTENT_OR:
-    if ((content->c1->type == XML_ELEMENT_CONTENT_OR) ||
-        (content->c1->type == XML_ELEMENT_CONTENT_SEQ))
-xmlDumpElementContent(buf, content->c1, 1);
-    else
-xmlDumpElementContent(buf, content->c1, 0);
+            if ((content->c2->type == XML_ELEMENT_CONTENT_OR) ||
+                ((content->c2->type == XML_ELEMENT_CONTENT_SEQ) &&
+                (content->c2->ocur != XML_ELEMENT_CONTENT_ONCE)))
+                xmlDumpElementContent(buf, content->c2, 1);
+            else
+                xmlDumpElementContent(buf, content->c2, 0);
+            break;
+        case XML_ELEMENT_CONTENT_OR:
+            if ((content->c1->type == XML_ELEMENT_CONTENT_OR) ||
+                (content->c1->type == XML_ELEMENT_CONTENT_SEQ))
+                xmlDumpElementContent(buf, content->c1, 1);
+            else
+                xmlDumpElementContent(buf, content->c1, 0);
             xmlBufferWriteChar(buf, " | ");
-    if ((content->c2->type == XML_ELEMENT_CONTENT_SEQ) ||
-        ((content->c2->type == XML_ELEMENT_CONTENT_OR) &&
- (content->c2->ocur != XML_ELEMENT_CONTENT_ONCE)))
-xmlDumpElementContent(buf, content->c2, 1);
-    else
-xmlDumpElementContent(buf, content->c2, 0);
-    break;
-default:
-    xmlErrValid(NULL, XML_ERR_INTERNAL_ERROR,
-    "Internal: ELEMENT content corrupted invalid type\n",
-    NULL);
+            if ((content->c2->type == XML_ELEMENT_CONTENT_SEQ) ||
+                ((content->c2->type == XML_ELEMENT_CONTENT_OR) &&
+                (content->c2->ocur != XML_ELEMENT_CONTENT_ONCE)))
+                xmlDumpElementContent(buf, content->c2, 1);
+            else
+                xmlDumpElementContent(buf, content->c2, 0);
+            break;
+        default:
+            xmlErrValid(NULL, XML_ERR_INTERNAL_ERROR,
+            "Internal: ELEMENT content corrupted invalid type\n",
+            NULL);
     }
     if (glob)
         xmlBufferWriteChar(buf, ")");
     switch (content->ocur) {
         case XML_ELEMENT_CONTENT_ONCE:
-    break;
+            break;
         case XML_ELEMENT_CONTENT_OPT:
-    xmlBufferWriteChar(buf, "?");
-    break;
+            xmlBufferWriteChar(buf, "?");
+            break;
         case XML_ELEMENT_CONTENT_MULT:
-    xmlBufferWriteChar(buf, "*");
-    break;
+            xmlBufferWriteChar(buf, "*");
+            break;
         case XML_ELEMENT_CONTENT_PLUS:
-    xmlBufferWriteChar(buf, "+");
-    break;
+            xmlBufferWriteChar(buf, "+");
+            break;
     }
 }
 
+
 /**
  * xmlSprintfElementContent:
  * @buf:  an output buffer

2025-02-02 16:01:21.605 | DEBUG    | scenario:rebuild:369 - original environment: environ({'CONDA_SHLVL': '2', 'LC_ALL': 'C.UTF-8', 'LS_COLORS': 'rs=0:di=01;34:ln=01;36:mh=00:pi=40;33:so=01;35:do=01;35:bd=40;33;01:cd=40;33;01:or=40;31;01:mi=00:su=37;41:sg=30;43:ca=30;41:tw=30;42:ow=34;42:st=37;44:ex=01;32:*.tar=01;31:*.tgz=01;31:*.arc=01;31:*.arj=01;31:*.taz=01;31:*.lha=01;31:*.lz4=01;31:*.lzh=01;31:*.lzma=01;31:*.tlz=01;31:*.txz=01;31:*.tzo=01;31:*.t7z=01;31:*.zip=01;31:*.z=01;31:*.Z=01;31:*.dz=01;31:*.gz=01;31:*.lrz=01;31:*.lz=01;31:*.lzo=01;31:*.xz=01;31:*.zst=01;31:*.tzst=01;31:*.bz2=01;31:*.bz=01;31:*.tbz=01;31:*.tbz2=01;31:*.tz=01;31:*.deb=01;31:*.rpm=01;31:*.jar=01;31:*.war=01;31:*.ear=01;31:*.sar=01;31:*.rar=01;31:*.alz=01;31:*.ace=01;31:*.zoo=01;31:*.cpio=01;31:*.7z=01;31:*.rz=01;31:*.cab=01;31:*.wim=01;31:*.swm=01;31:*.dwm=01;31:*.esd=01;31:*.jpg=01;35:*.jpeg=01;35:*.mjpg=01;35:*.mjpeg=01;35:*.gif=01;35:*.bmp=01;35:*.pbm=01;35:*.pgm=01;35:*.ppm=01;35:*.tga=01;35:*.xbm=01;35:*.xpm=01;35:*.tif=01;35:*.tiff=01;35:*.png=01;35:*.svg=01;35:*.svgz=01;35:*.mng=01;35:*.pcx=01;35:*.mov=01;35:*.mpg=01;35:*.mpeg=01;35:*.m2v=01;35:*.mkv=01;35:*.webm=01;35:*.ogm=01;35:*.mp4=01;35:*.m4v=01;35:*.mp4v=01;35:*.vob=01;35:*.qt=01;35:*.nuv=01;35:*.wmv=01;35:*.asf=01;35:*.rm=01;35:*.rmvb=01;35:*.flc=01;35:*.avi=01;35:*.fli=01;35:*.flv=01;35:*.gl=01;35:*.dl=01;35:*.xcf=01;35:*.xwd=01;35:*.yuv=01;35:*.cgm=01;35:*.emf=01;35:*.ogv=01;35:*.ogx=01;35:*.aac=00;36:*.au=00;36:*.flac=00;36:*.m4a=00;36:*.mid=00;36:*.midi=00;36:*.mka=00;36:*.mp3=00;36:*.mpc=00;36:*.ogg=00;36:*.ra=00;36:*.wav=00;36:*.oga=00;36:*.opus=00;36:*.spx=00;36:*.xspf=00;36:', 'LD_LIBRARY_PATH': '/opt/crashrepair/lib:/CrashRepair/lib:/klee/build/lib:', 'CONDA_EXE': '/root/anaconda3/bin/conda', 'LANG': 'C.UTF-8', 'TZ': 'Asia/Shanghai', 'HOSTNAME': 'fea22102047d', 'OLDPWD': '/orchestrator', 'CONDA_PREFIX': '/root/anaconda3/envs/CrashRepair', '_CE_M': '', 'CC': 'crepair-cc', 'LLVM_COMPILER': 'clang', 'CONDA_PREFIX_1': '/root/anaconda3', 'PWD': '/orchestrator/crashrepair', 'HOME': '/root', 'CONDA_PYTHON_EXE': '/root/anaconda3/bin/python', '_CE_CONDA': '', 'CONDA_PROMPT_MODIFIER': '(CrashRepair) ', 'CXX': 'crepair-cxx', 'TERM': 'xterm', 'SHLVL': '2', 'PYTHONPATH': '/usr/lib/python3.8/site-packages:', 'PATH': '/root/anaconda3/envs/CrashRepair/bin:/root/anaconda3/condabin:~/anaconda3/bin:/opt/crashrepair/bin:/CrashRepair/compiler:/klee/build/bin:/opt/llvm-6/bin:/klee/build/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', 'CONDA_DEFAULT_ENV': 'CrashRepair', '_': '/root/anaconda3/envs/CrashRepair/bin/python'})
2025-02-02 16:01:21.605 | DEBUG    | scenario:rebuild:382 - injecting ghost function into CFLAGS during build: -lcrepair_ghost
2025-02-02 16:01:21.605 | DEBUG    | scenario:rebuild:398 - using environment: {'INJECT_CFLAGS': '-g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address', 'INJECT_CXXFLAGS': '-g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address', 'INJECT_LDFLAGS': '-g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address'}
2025-02-02 16:01:21.605 | DEBUG    | shell:__call__:41 - executing: make CFLAGS="${INJECT_CFLAGS}" CXXFLAGS="${INJECT_CXXFLAGS}" LDFLAGS="${INJECT_LDFLAGS}" xmllint
  CC       valid.lo
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_ghost: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
  CCLD     libxml2.la
ar: `u' modifier ignored since `D' is the default (see `U')
  CCLD     xmllint
2025-02-02 16:01:22.087 | DEBUG    | scenario:evaluate:655 - testing candidate #2 against test #crash...
2025-02-02 16:01:22.088 | DEBUG    | shell:__call__:41 - executing: /data//vulnloc/libxml2/CVE-2017-5969/src/xmllint --recover /CrashRepair/experiments/vulnloc/libxml2/CVE-2017-5969/tests/1.xml
2025-02-02 16:01:22.098 | DEBUG    | test:run:189 - test failed: unexpected exit code (actual: 139, expected: 0)
2025-02-02 16:01:22.098 | INFO     | scenario:evaluate:662 - candidate #2 fails test #crash
2025-02-02 16:01:22.103 | INFO     | scenario:evaluate:635 - evaluating candidate patch #3:
@@ -1155,6 +1155,7 @@
  *
  * This will dump the content of the element table as an XML DTD definition
  */
+
 static void
 xmlDumpElementContent(xmlBufferPtr buf, xmlElementContentPtr content, int glob) {
     if (content == NULL) return;
@@ -1163,64 +1164,65 @@
     switch (content->type) {
         case XML_ELEMENT_CONTENT_PCDATA:
             xmlBufferWriteChar(buf, "#PCDATA");
-    break;
-case XML_ELEMENT_CONTENT_ELEMENT:
-    if (content->prefix != NULL) {
-xmlBufferWriteCHAR(buf, content->prefix);
-xmlBufferWriteChar(buf, ":");
-    }
-    xmlBufferWriteCHAR(buf, content->name);
-    break;
-case XML_ELEMENT_CONTENT_SEQ:
-    if ((content->c1->type == XML_ELEMENT_CONTENT_OR) ||
-        (content->c1->type == XML_ELEMENT_CONTENT_SEQ))
-xmlDumpElementContent(buf, content->c1, 1);
-    else
-xmlDumpElementContent(buf, content->c1, 0);
+            break;
+        case XML_ELEMENT_CONTENT_ELEMENT:
+            if (content->prefix != NULL && content->prefix->type == XML_ELEMENT_CONTENT_PREFIX) {
+                xmlBufferWriteCHAR(buf, content->prefix);
+                xmlBufferWriteChar(buf, ":");
+            }
+            xmlBufferWriteCHAR(buf, content->name);
+            break;
+        case XML_ELEMENT_CONTENT_SEQ:
+            if ((content->c1->type == XML_ELEMENT_CONTENT_OR) ||
+                (content->c1->type == XML_ELEMENT_CONTENT_SEQ))
+                xmlDumpElementContent(buf, content->c1, 1);
+            else
+                xmlDumpElementContent(buf, content->c1, 0);
             xmlBufferWriteChar(buf, " , ");
-    if ((content->c2->type == XML_ELEMENT_CONTENT_OR) ||
-        ((content->c2->type == XML_ELEMENT_CONTENT_SEQ) &&
- (content->c2->ocur != XML_ELEMENT_CONTENT_ONCE)))
-xmlDumpElementContent(buf, content->c2, 1);
-    else
-xmlDumpElementContent(buf, content->c2, 0);
-    break;
-case XML_ELEMENT_CONTENT_OR:
-    if ((content->c1->type == XML_ELEMENT_CONTENT_OR) ||
-        (content->c1->type == XML_ELEMENT_CONTENT_SEQ))
-xmlDumpElementContent(buf, content->c1, 1);
-    else
-xmlDumpElementContent(buf, content->c1, 0);
+            if ((content->c2->type == XML_ELEMENT_CONTENT_OR) ||
+                ((content->c2->type == XML_ELEMENT_CONTENT_SEQ) &&
+                (content->c2->ocur != XML_ELEMENT_CONTENT_ONCE)))
+                xmlDumpElementContent(buf, content->c2, 1);
+            else
+                xmlDumpElementContent(buf, content->c2, 0);
+            break;
+        case XML_ELEMENT_CONTENT_OR:
+            if ((content->c1->type == XML_ELEMENT_CONTENT_OR) ||
+                (content->c1->type == XML_ELEMENT_CONTENT_SEQ))
+                xmlDumpElementContent(buf, content->c1, 1);
+            else
+                xmlDumpElementContent(buf, content->c1, 0);
             xmlBufferWriteChar(buf, " | ");
-    if ((content->c2->type == XML_ELEMENT_CONTENT_SEQ) ||
-        ((content->c2->type == XML_ELEMENT_CONTENT_OR) &&
- (content->c2->ocur != XML_ELEMENT_CONTENT_ONCE)))
-xmlDumpElementContent(buf, content->c2, 1);
-    else
-xmlDumpElementContent(buf, content->c2, 0);
-    break;
-default:
-    xmlErrValid(NULL, XML_ERR_INTERNAL_ERROR,
-    "Internal: ELEMENT content corrupted invalid type\n",
-    NULL);
+            if ((content->c2->type == XML_ELEMENT_CONTENT_SEQ) ||
+                ((content->c2->type == XML_ELEMENT_CONTENT_OR) &&
+                (content->c2->ocur != XML_ELEMENT_CONTENT_ONCE)))
+                xmlDumpElementContent(buf, content->c2, 1);
+            else
+                xmlDumpElementContent(buf, content->c2, 0);
+            break;
+        default:
+            xmlErrValid(NULL, XML_ERR_INTERNAL_ERROR,
+            "Internal: ELEMENT content corrupted invalid type\n",
+            NULL);
     }
     if (glob)
         xmlBufferWriteChar(buf, ")");
     switch (content->ocur) {
         case XML_ELEMENT_CONTENT_ONCE:
-    break;
+            break;
         case XML_ELEMENT_CONTENT_OPT:
-    xmlBufferWriteChar(buf, "?");
-    break;
+            xmlBufferWriteChar(buf, "?");
+            break;
         case XML_ELEMENT_CONTENT_MULT:
-    xmlBufferWriteChar(buf, "*");
-    break;
+            xmlBufferWriteChar(buf, "*");
+            break;
         case XML_ELEMENT_CONTENT_PLUS:
-    xmlBufferWriteChar(buf, "+");
-    break;
+            xmlBufferWriteChar(buf, "+");
+            break;
     }
 }
 
+
 /**
  * xmlSprintfElementContent:
  * @buf:  an output buffer

2025-02-02 16:01:22.110 | DEBUG    | scenario:rebuild:369 - original environment: environ({'CONDA_SHLVL': '2', 'LC_ALL': 'C.UTF-8', 'LS_COLORS': 'rs=0:di=01;34:ln=01;36:mh=00:pi=40;33:so=01;35:do=01;35:bd=40;33;01:cd=40;33;01:or=40;31;01:mi=00:su=37;41:sg=30;43:ca=30;41:tw=30;42:ow=34;42:st=37;44:ex=01;32:*.tar=01;31:*.tgz=01;31:*.arc=01;31:*.arj=01;31:*.taz=01;31:*.lha=01;31:*.lz4=01;31:*.lzh=01;31:*.lzma=01;31:*.tlz=01;31:*.txz=01;31:*.tzo=01;31:*.t7z=01;31:*.zip=01;31:*.z=01;31:*.Z=01;31:*.dz=01;31:*.gz=01;31:*.lrz=01;31:*.lz=01;31:*.lzo=01;31:*.xz=01;31:*.zst=01;31:*.tzst=01;31:*.bz2=01;31:*.bz=01;31:*.tbz=01;31:*.tbz2=01;31:*.tz=01;31:*.deb=01;31:*.rpm=01;31:*.jar=01;31:*.war=01;31:*.ear=01;31:*.sar=01;31:*.rar=01;31:*.alz=01;31:*.ace=01;31:*.zoo=01;31:*.cpio=01;31:*.7z=01;31:*.rz=01;31:*.cab=01;31:*.wim=01;31:*.swm=01;31:*.dwm=01;31:*.esd=01;31:*.jpg=01;35:*.jpeg=01;35:*.mjpg=01;35:*.mjpeg=01;35:*.gif=01;35:*.bmp=01;35:*.pbm=01;35:*.pgm=01;35:*.ppm=01;35:*.tga=01;35:*.xbm=01;35:*.xpm=01;35:*.tif=01;35:*.tiff=01;35:*.png=01;35:*.svg=01;35:*.svgz=01;35:*.mng=01;35:*.pcx=01;35:*.mov=01;35:*.mpg=01;35:*.mpeg=01;35:*.m2v=01;35:*.mkv=01;35:*.webm=01;35:*.ogm=01;35:*.mp4=01;35:*.m4v=01;35:*.mp4v=01;35:*.vob=01;35:*.qt=01;35:*.nuv=01;35:*.wmv=01;35:*.asf=01;35:*.rm=01;35:*.rmvb=01;35:*.flc=01;35:*.avi=01;35:*.fli=01;35:*.flv=01;35:*.gl=01;35:*.dl=01;35:*.xcf=01;35:*.xwd=01;35:*.yuv=01;35:*.cgm=01;35:*.emf=01;35:*.ogv=01;35:*.ogx=01;35:*.aac=00;36:*.au=00;36:*.flac=00;36:*.m4a=00;36:*.mid=00;36:*.midi=00;36:*.mka=00;36:*.mp3=00;36:*.mpc=00;36:*.ogg=00;36:*.ra=00;36:*.wav=00;36:*.oga=00;36:*.opus=00;36:*.spx=00;36:*.xspf=00;36:', 'LD_LIBRARY_PATH': '/opt/crashrepair/lib:/CrashRepair/lib:/klee/build/lib:', 'CONDA_EXE': '/root/anaconda3/bin/conda', 'LANG': 'C.UTF-8', 'TZ': 'Asia/Shanghai', 'HOSTNAME': 'fea22102047d', 'OLDPWD': '/orchestrator', 'CONDA_PREFIX': '/root/anaconda3/envs/CrashRepair', '_CE_M': '', 'CC': 'crepair-cc', 'LLVM_COMPILER': 'clang', 'CONDA_PREFIX_1': '/root/anaconda3', 'PWD': '/orchestrator/crashrepair', 'HOME': '/root', 'CONDA_PYTHON_EXE': '/root/anaconda3/bin/python', '_CE_CONDA': '', 'CONDA_PROMPT_MODIFIER': '(CrashRepair) ', 'CXX': 'crepair-cxx', 'TERM': 'xterm', 'SHLVL': '2', 'PYTHONPATH': '/usr/lib/python3.8/site-packages:', 'PATH': '/root/anaconda3/envs/CrashRepair/bin:/root/anaconda3/condabin:~/anaconda3/bin:/opt/crashrepair/bin:/CrashRepair/compiler:/klee/build/bin:/opt/llvm-6/bin:/klee/build/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', 'CONDA_DEFAULT_ENV': 'CrashRepair', '_': '/root/anaconda3/envs/CrashRepair/bin/python'})
2025-02-02 16:01:22.110 | DEBUG    | scenario:rebuild:382 - injecting ghost function into CFLAGS during build: -lcrepair_ghost
2025-02-02 16:01:22.110 | DEBUG    | scenario:rebuild:398 - using environment: {'INJECT_CFLAGS': '-g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address', 'INJECT_CXXFLAGS': '-g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address', 'INJECT_LDFLAGS': '-g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address'}
2025-02-02 16:01:22.110 | DEBUG    | shell:__call__:41 - executing: make CFLAGS="${INJECT_CFLAGS}" CXXFLAGS="${INJECT_CXXFLAGS}" LDFLAGS="${INJECT_LDFLAGS}" xmllint
  CC       valid.lo
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_ghost: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
valid.c:1169:59: error: member reference base type 'const xmlChar' (aka 'const unsigned char') is not a structure or union
            if (content->prefix != NULL && content->prefix->type == XML_ELEMENT_CONTENT_PREFIX) {
                                           ~~~~~~~~~~~~~~~^ ~~~~
valid.c:1169:69: error: use of undeclared identifier 'XML_ELEMENT_CONTENT_PREFIX'
            if (content->prefix != NULL && content->prefix->type == XML_ELEMENT_CONTENT_PREFIX) {
                                                                    ^
2 errors generated.
ERROR:Failed to compile using given arguments: [-g -O0 -include /CrashRepair/compiler/../lib/crepair_runtime.h -DHAVE_CONFIG_H -I. -I./include -I./include -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -MT valid.lo -MD -MP -MF .deps/valid.Tpo -c valid.c -o valid.o -L/CrashRepair/compiler/../lib/ -L/klee/build/lib/ -lcrepair_runtime -lcrepair_proxy -lkleeRuntest -fno-sanitize=address]
Makefile:1249: recipe for target 'valid.lo' failed
make: *** [valid.lo] Error 1
2025-02-02 16:01:22.211 | INFO     | scenario:evaluate:643 - candidate patch #3 failed to compile
2025-02-02 16:01:22.219 | INFO     | scenario:evaluate:635 - evaluating candidate patch #4:
@@ -1155,6 +1155,7 @@
  *
  * This will dump the content of the element table as an XML DTD definition
  */
+
 static void
 xmlDumpElementContent(xmlBufferPtr buf, xmlElementContentPtr content, int glob) {
     if (content == NULL) return;
@@ -1163,64 +1164,67 @@
     switch (content->type) {
         case XML_ELEMENT_CONTENT_PCDATA:
             xmlBufferWriteChar(buf, "#PCDATA");
-    break;
-case XML_ELEMENT_CONTENT_ELEMENT:
-    if (content->prefix != NULL) {
-xmlBufferWriteCHAR(buf, content->prefix);
-xmlBufferWriteChar(buf, ":");
-    }
-    xmlBufferWriteCHAR(buf, content->name);
-    break;
-case XML_ELEMENT_CONTENT_SEQ:
-    if ((content->c1->type == XML_ELEMENT_CONTENT_OR) ||
-        (content->c1->type == XML_ELEMENT_CONTENT_SEQ))
-xmlDumpElementContent(buf, content->c1, 1);
-    else
-xmlDumpElementContent(buf, content->c1, 0);
+            break;
+        case XML_ELEMENT_CONTENT_ELEMENT:
+            if (content->prefix != NULL && content->name != NULL) {
+                xmlBufferWriteCHAR(buf, content->prefix);
+                xmlBufferWriteChar(buf, ":");
+            }
+            if (content->name != NULL) {
+                xmlBufferWriteCHAR(buf, content->name);
+            }
+            break;
+        case XML_ELEMENT_CONTENT_SEQ:
+            if ((content->c1->type == XML_ELEMENT_CONTENT_OR) ||
+                (content->c1->type == XML_ELEMENT_CONTENT_SEQ))
+                xmlDumpElementContent(buf, content->c1, 1);
+            else
+                xmlDumpElementContent(buf, content->c1, 0);
             xmlBufferWriteChar(buf, " , ");
-    if ((content->c2->type == XML_ELEMENT_CONTENT_OR) ||
-        ((content->c2->type == XML_ELEMENT_CONTENT_SEQ) &&
- (content->c2->ocur != XML_ELEMENT_CONTENT_ONCE)))
-xmlDumpElementContent(buf, content->c2, 1);
-    else
-xmlDumpElementContent(buf, content->c2, 0);
-    break;
-case XML_ELEMENT_CONTENT_OR:
-    if ((content->c1->type == XML_ELEMENT_CONTENT_OR) ||
-        (content->c1->type == XML_ELEMENT_CONTENT_SEQ))
-xmlDumpElementContent(buf, content->c1, 1);
-    else
-xmlDumpElementContent(buf, content->c1, 0);
+            if ((content->c2->type == XML_ELEMENT_CONTENT_OR) ||
+                ((content->c2->type == XML_ELEMENT_CONTENT_SEQ) &&
+                 (content->c2->ocur != XML_ELEMENT_CONTENT_ONCE)))
+                xmlDumpElementContent(buf, content->c2, 1);
+            else
+                xmlDumpElementContent(buf, content->c2, 0);
+            break;
+        case XML_ELEMENT_CONTENT_OR:
+            if ((content->c1->type == XML_ELEMENT_CONTENT_OR) ||
+                (content->c1->type == XML_ELEMENT_CONTENT_SEQ))
+                xmlDumpElementContent(buf, content->c1, 1);
+            else
+                xmlDumpElementContent(buf, content->c1, 0);
             xmlBufferWriteChar(buf, " | ");
-    if ((content->c2->type == XML_ELEMENT_CONTENT_SEQ) ||
-        ((content->c2->type == XML_ELEMENT_CONTENT_OR) &&
- (content->c2->ocur != XML_ELEMENT_CONTENT_ONCE)))
-xmlDumpElementContent(buf, content->c2, 1);
-    else
-xmlDumpElementContent(buf, content->c2, 0);
-    break;
-default:
-    xmlErrValid(NULL, XML_ERR_INTERNAL_ERROR,
-    "Internal: ELEMENT content corrupted invalid type\n",
-    NULL);
+            if ((content->c2->type == XML_ELEMENT_CONTENT_SEQ) ||
+                ((content->c2->type == XML_ELEMENT_CONTENT_OR) &&
+                 (content->c2->ocur != XML_ELEMENT_CONTENT_ONCE)))
+                xmlDumpElementContent(buf, content->c2, 1);
+            else
+                xmlDumpElementContent(buf, content->c2, 0);
+            break;
+        default:
+            xmlErrValid(NULL, XML_ERR_INTERNAL_ERROR,
+                         "Internal: ELEMENT content corrupted invalid type\n",
+                         NULL);
     }
     if (glob)
         xmlBufferWriteChar(buf, ")");
     switch (content->ocur) {
         case XML_ELEMENT_CONTENT_ONCE:
-    break;
+            break;
         case XML_ELEMENT_CONTENT_OPT:
-    xmlBufferWriteChar(buf, "?");
-    break;
+            xmlBufferWriteChar(buf, "?");
+            break;
         case XML_ELEMENT_CONTENT_MULT:
-    xmlBufferWriteChar(buf, "*");
-    break;
+            xmlBufferWriteChar(buf, "*");
+            break;
         case XML_ELEMENT_CONTENT_PLUS:
-    xmlBufferWriteChar(buf, "+");
-    break;
+            xmlBufferWriteChar(buf, "+");
+            break;
     }
 }
 
+
 /**
  * xmlSprintfElementContent:
  * @buf:  an output buffer

2025-02-02 16:01:22.224 | DEBUG    | scenario:rebuild:369 - original environment: environ({'CONDA_SHLVL': '2', 'LC_ALL': 'C.UTF-8', 'LS_COLORS': 'rs=0:di=01;34:ln=01;36:mh=00:pi=40;33:so=01;35:do=01;35:bd=40;33;01:cd=40;33;01:or=40;31;01:mi=00:su=37;41:sg=30;43:ca=30;41:tw=30;42:ow=34;42:st=37;44:ex=01;32:*.tar=01;31:*.tgz=01;31:*.arc=01;31:*.arj=01;31:*.taz=01;31:*.lha=01;31:*.lz4=01;31:*.lzh=01;31:*.lzma=01;31:*.tlz=01;31:*.txz=01;31:*.tzo=01;31:*.t7z=01;31:*.zip=01;31:*.z=01;31:*.Z=01;31:*.dz=01;31:*.gz=01;31:*.lrz=01;31:*.lz=01;31:*.lzo=01;31:*.xz=01;31:*.zst=01;31:*.tzst=01;31:*.bz2=01;31:*.bz=01;31:*.tbz=01;31:*.tbz2=01;31:*.tz=01;31:*.deb=01;31:*.rpm=01;31:*.jar=01;31:*.war=01;31:*.ear=01;31:*.sar=01;31:*.rar=01;31:*.alz=01;31:*.ace=01;31:*.zoo=01;31:*.cpio=01;31:*.7z=01;31:*.rz=01;31:*.cab=01;31:*.wim=01;31:*.swm=01;31:*.dwm=01;31:*.esd=01;31:*.jpg=01;35:*.jpeg=01;35:*.mjpg=01;35:*.mjpeg=01;35:*.gif=01;35:*.bmp=01;35:*.pbm=01;35:*.pgm=01;35:*.ppm=01;35:*.tga=01;35:*.xbm=01;35:*.xpm=01;35:*.tif=01;35:*.tiff=01;35:*.png=01;35:*.svg=01;35:*.svgz=01;35:*.mng=01;35:*.pcx=01;35:*.mov=01;35:*.mpg=01;35:*.mpeg=01;35:*.m2v=01;35:*.mkv=01;35:*.webm=01;35:*.ogm=01;35:*.mp4=01;35:*.m4v=01;35:*.mp4v=01;35:*.vob=01;35:*.qt=01;35:*.nuv=01;35:*.wmv=01;35:*.asf=01;35:*.rm=01;35:*.rmvb=01;35:*.flc=01;35:*.avi=01;35:*.fli=01;35:*.flv=01;35:*.gl=01;35:*.dl=01;35:*.xcf=01;35:*.xwd=01;35:*.yuv=01;35:*.cgm=01;35:*.emf=01;35:*.ogv=01;35:*.ogx=01;35:*.aac=00;36:*.au=00;36:*.flac=00;36:*.m4a=00;36:*.mid=00;36:*.midi=00;36:*.mka=00;36:*.mp3=00;36:*.mpc=00;36:*.ogg=00;36:*.ra=00;36:*.wav=00;36:*.oga=00;36:*.opus=00;36:*.spx=00;36:*.xspf=00;36:', 'LD_LIBRARY_PATH': '/opt/crashrepair/lib:/CrashRepair/lib:/klee/build/lib:', 'CONDA_EXE': '/root/anaconda3/bin/conda', 'LANG': 'C.UTF-8', 'TZ': 'Asia/Shanghai', 'HOSTNAME': 'fea22102047d', 'OLDPWD': '/orchestrator', 'CONDA_PREFIX': '/root/anaconda3/envs/CrashRepair', '_CE_M': '', 'CC': 'crepair-cc', 'LLVM_COMPILER': 'clang', 'CONDA_PREFIX_1': '/root/anaconda3', 'PWD': '/orchestrator/crashrepair', 'HOME': '/root', 'CONDA_PYTHON_EXE': '/root/anaconda3/bin/python', '_CE_CONDA': '', 'CONDA_PROMPT_MODIFIER': '(CrashRepair) ', 'CXX': 'crepair-cxx', 'TERM': 'xterm', 'SHLVL': '2', 'PYTHONPATH': '/usr/lib/python3.8/site-packages:', 'PATH': '/root/anaconda3/envs/CrashRepair/bin:/root/anaconda3/condabin:~/anaconda3/bin:/opt/crashrepair/bin:/CrashRepair/compiler:/klee/build/bin:/opt/llvm-6/bin:/klee/build/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', 'CONDA_DEFAULT_ENV': 'CrashRepair', '_': '/root/anaconda3/envs/CrashRepair/bin/python'})
2025-02-02 16:01:22.224 | DEBUG    | scenario:rebuild:382 - injecting ghost function into CFLAGS during build: -lcrepair_ghost
2025-02-02 16:01:22.224 | DEBUG    | scenario:rebuild:398 - using environment: {'INJECT_CFLAGS': '-g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address', 'INJECT_CXXFLAGS': '-g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address', 'INJECT_LDFLAGS': '-g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address'}
2025-02-02 16:01:22.224 | DEBUG    | shell:__call__:41 - executing: make CFLAGS="${INJECT_CFLAGS}" CXXFLAGS="${INJECT_CXXFLAGS}" LDFLAGS="${INJECT_LDFLAGS}" xmllint
  CC       valid.lo
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_ghost: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
  CCLD     libxml2.la
ar: `u' modifier ignored since `D' is the default (see `U')
  CCLD     xmllint
2025-02-02 16:01:22.697 | DEBUG    | scenario:evaluate:655 - testing candidate #4 against test #crash...
2025-02-02 16:01:22.698 | DEBUG    | shell:__call__:41 - executing: /data//vulnloc/libxml2/CVE-2017-5969/src/xmllint --recover /CrashRepair/experiments/vulnloc/libxml2/CVE-2017-5969/tests/1.xml
2025-02-02 16:01:22.708 | DEBUG    | test:run:189 - test failed: unexpected exit code (actual: 139, expected: 0)
2025-02-02 16:01:22.708 | INFO     | scenario:evaluate:662 - candidate #4 fails test #crash
2025-02-02 16:01:22.714 | INFO     | scenario:evaluate:635 - evaluating candidate patch #5:
@@ -1155,6 +1155,7 @@
  *
  * This will dump the content of the element table as an XML DTD definition
  */
+
 static void
 xmlDumpElementContent(xmlBufferPtr buf, xmlElementContentPtr content, int glob) {
     if (content == NULL) return;
@@ -1163,64 +1164,69 @@
     switch (content->type) {
         case XML_ELEMENT_CONTENT_PCDATA:
             xmlBufferWriteChar(buf, "#PCDATA");
-    break;
-case XML_ELEMENT_CONTENT_ELEMENT:
-    if (content->prefix != NULL) {
-xmlBufferWriteCHAR(buf, content->prefix);
-xmlBufferWriteChar(buf, ":");
-    }
-    xmlBufferWriteCHAR(buf, content->name);
-    break;
-case XML_ELEMENT_CONTENT_SEQ:
-    if ((content->c1->type == XML_ELEMENT_CONTENT_OR) ||
-        (content->c1->type == XML_ELEMENT_CONTENT_SEQ))
-xmlDumpElementContent(buf, content->c1, 1);
-    else
-xmlDumpElementContent(buf, content->c1, 0);
+            break;
+        case XML_ELEMENT_CONTENT_ELEMENT:
+            if (content->prefix != NULL) {
+                xmlBufferWriteCHAR(buf, content->prefix);
+                xmlBufferWriteChar(buf, ":");
+            }
+            xmlBufferWriteCHAR(buf, content->name);
+            break;
+        case XML_ELEMENT_CONTENT_SEQ:
+            if ((content->c1->type == XML_ELEMENT_CONTENT_OR) ||
+                (content->c1->type == XML_ELEMENT_CONTENT_SEQ)) {
+                xmlDumpElementContent(buf, content->c1, 1);
+            } else {
+                xmlDumpElementContent(buf, content->c1, 0);
+            }
             xmlBufferWriteChar(buf, " , ");
-    if ((content->c2->type == XML_ELEMENT_CONTENT_OR) ||
-        ((content->c2->type == XML_ELEMENT_CONTENT_SEQ) &&
- (content->c2->ocur != XML_ELEMENT_CONTENT_ONCE)))
-xmlDumpElementContent(buf, content->c2, 1);
-    else
-xmlDumpElementContent(buf, content->c2, 0);
-    break;
-case XML_ELEMENT_CONTENT_OR:
-    if ((content->c1->type == XML_ELEMENT_CONTENT_OR) ||
-        (content->c1->type == XML_ELEMENT_CONTENT_SEQ))
-xmlDumpElementContent(buf, content->c1, 1);
-    else
-xmlDumpElementContent(buf, content->c1, 0);
+            if ((content->c2->type == XML_ELEMENT_CONTENT_OR) ||
+                ((content->c2->type == XML_ELEMENT_CONTENT_SEQ) &&
+                 (content->c2->ocur != XML_ELEMENT_CONTENT_ONCE))) {
+                xmlDumpElementContent(buf, content->c2, 1);
+            } else {
+                xmlDumpElementContent(buf, content->c2, 0);
+            }
+            break;
+        case XML_ELEMENT_CONTENT_OR:
+            if ((content->c1->type == XML_ELEMENT_CONTENT_OR) ||
+                (content->c1->type == XML_ELEMENT_CONTENT_SEQ)) {
+                xmlDumpElementContent(buf, content->c1, 1);
+            } else {
+                xmlDumpElementContent(buf, content->c1, 0);
+            }
             xmlBufferWriteChar(buf, " | ");
-    if ((content->c2->type == XML_ELEMENT_CONTENT_SEQ) ||
-        ((content->c2->type == XML_ELEMENT_CONTENT_OR) &&
- (content->c2->ocur != XML_ELEMENT_CONTENT_ONCE)))
-xmlDumpElementContent(buf, content->c2, 1);
-    else
-xmlDumpElementContent(buf, content->c2, 0);
-    break;
-default:
-    xmlErrValid(NULL, XML_ERR_INTERNAL_ERROR,
-    "Internal: ELEMENT content corrupted invalid type\n",
-    NULL);
+            if ((content->c2->type == XML_ELEMENT_CONTENT_SEQ) ||
+                ((content->c2->type == XML_ELEMENT_CONTENT_OR) &&
+                 (content->c2->ocur != XML_ELEMENT_CONTENT_ONCE))) {
+                xmlDumpElementContent(buf, content->c2, 1);
+            } else {
+                xmlDumpElementContent(buf, content->c2, 0);
+            }
+            break;
+        default:
+            xmlErrValid(NULL, XML_ERR_INTERNAL_ERROR,
+                        "Internal: ELEMENT content corrupted invalid type\n",
+                        NULL);
     }
     if (glob)
         xmlBufferWriteChar(buf, ")");
     switch (content->ocur) {
         case XML_ELEMENT_CONTENT_ONCE:
-    break;
+            break;
         case XML_ELEMENT_CONTENT_OPT:
-    xmlBufferWriteChar(buf, "?");
-    break;
+            xmlBufferWriteChar(buf, "?");
+            break;
         case XML_ELEMENT_CONTENT_MULT:
-    xmlBufferWriteChar(buf, "*");
-    break;
+            xmlBufferWriteChar(buf, "*");
+            break;
         case XML_ELEMENT_CONTENT_PLUS:
-    xmlBufferWriteChar(buf, "+");
-    break;
+            xmlBufferWriteChar(buf, "+");
+            break;
     }
 }
 
+
 /**
  * xmlSprintfElementContent:
  * @buf:  an output buffer

2025-02-02 16:01:22.721 | DEBUG    | scenario:rebuild:369 - original environment: environ({'CONDA_SHLVL': '2', 'LC_ALL': 'C.UTF-8', 'LS_COLORS': 'rs=0:di=01;34:ln=01;36:mh=00:pi=40;33:so=01;35:do=01;35:bd=40;33;01:cd=40;33;01:or=40;31;01:mi=00:su=37;41:sg=30;43:ca=30;41:tw=30;42:ow=34;42:st=37;44:ex=01;32:*.tar=01;31:*.tgz=01;31:*.arc=01;31:*.arj=01;31:*.taz=01;31:*.lha=01;31:*.lz4=01;31:*.lzh=01;31:*.lzma=01;31:*.tlz=01;31:*.txz=01;31:*.tzo=01;31:*.t7z=01;31:*.zip=01;31:*.z=01;31:*.Z=01;31:*.dz=01;31:*.gz=01;31:*.lrz=01;31:*.lz=01;31:*.lzo=01;31:*.xz=01;31:*.zst=01;31:*.tzst=01;31:*.bz2=01;31:*.bz=01;31:*.tbz=01;31:*.tbz2=01;31:*.tz=01;31:*.deb=01;31:*.rpm=01;31:*.jar=01;31:*.war=01;31:*.ear=01;31:*.sar=01;31:*.rar=01;31:*.alz=01;31:*.ace=01;31:*.zoo=01;31:*.cpio=01;31:*.7z=01;31:*.rz=01;31:*.cab=01;31:*.wim=01;31:*.swm=01;31:*.dwm=01;31:*.esd=01;31:*.jpg=01;35:*.jpeg=01;35:*.mjpg=01;35:*.mjpeg=01;35:*.gif=01;35:*.bmp=01;35:*.pbm=01;35:*.pgm=01;35:*.ppm=01;35:*.tga=01;35:*.xbm=01;35:*.xpm=01;35:*.tif=01;35:*.tiff=01;35:*.png=01;35:*.svg=01;35:*.svgz=01;35:*.mng=01;35:*.pcx=01;35:*.mov=01;35:*.mpg=01;35:*.mpeg=01;35:*.m2v=01;35:*.mkv=01;35:*.webm=01;35:*.ogm=01;35:*.mp4=01;35:*.m4v=01;35:*.mp4v=01;35:*.vob=01;35:*.qt=01;35:*.nuv=01;35:*.wmv=01;35:*.asf=01;35:*.rm=01;35:*.rmvb=01;35:*.flc=01;35:*.avi=01;35:*.fli=01;35:*.flv=01;35:*.gl=01;35:*.dl=01;35:*.xcf=01;35:*.xwd=01;35:*.yuv=01;35:*.cgm=01;35:*.emf=01;35:*.ogv=01;35:*.ogx=01;35:*.aac=00;36:*.au=00;36:*.flac=00;36:*.m4a=00;36:*.mid=00;36:*.midi=00;36:*.mka=00;36:*.mp3=00;36:*.mpc=00;36:*.ogg=00;36:*.ra=00;36:*.wav=00;36:*.oga=00;36:*.opus=00;36:*.spx=00;36:*.xspf=00;36:', 'LD_LIBRARY_PATH': '/opt/crashrepair/lib:/CrashRepair/lib:/klee/build/lib:', 'CONDA_EXE': '/root/anaconda3/bin/conda', 'LANG': 'C.UTF-8', 'TZ': 'Asia/Shanghai', 'HOSTNAME': 'fea22102047d', 'OLDPWD': '/orchestrator', 'CONDA_PREFIX': '/root/anaconda3/envs/CrashRepair', '_CE_M': '', 'CC': 'crepair-cc', 'LLVM_COMPILER': 'clang', 'CONDA_PREFIX_1': '/root/anaconda3', 'PWD': '/orchestrator/crashrepair', 'HOME': '/root', 'CONDA_PYTHON_EXE': '/root/anaconda3/bin/python', '_CE_CONDA': '', 'CONDA_PROMPT_MODIFIER': '(CrashRepair) ', 'CXX': 'crepair-cxx', 'TERM': 'xterm', 'SHLVL': '2', 'PYTHONPATH': '/usr/lib/python3.8/site-packages:', 'PATH': '/root/anaconda3/envs/CrashRepair/bin:/root/anaconda3/condabin:~/anaconda3/bin:/opt/crashrepair/bin:/CrashRepair/compiler:/klee/build/bin:/opt/llvm-6/bin:/klee/build/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', 'CONDA_DEFAULT_ENV': 'CrashRepair', '_': '/root/anaconda3/envs/CrashRepair/bin/python'})
2025-02-02 16:01:22.721 | DEBUG    | scenario:rebuild:382 - injecting ghost function into CFLAGS during build: -lcrepair_ghost
2025-02-02 16:01:22.721 | DEBUG    | scenario:rebuild:398 - using environment: {'INJECT_CFLAGS': '-g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address', 'INJECT_CXXFLAGS': '-g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address', 'INJECT_LDFLAGS': '-g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address'}
2025-02-02 16:01:22.721 | DEBUG    | shell:__call__:41 - executing: make CFLAGS="${INJECT_CFLAGS}" CXXFLAGS="${INJECT_CXXFLAGS}" LDFLAGS="${INJECT_LDFLAGS}" xmllint
  CC       valid.lo
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_ghost: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
  CCLD     libxml2.la
ar: `u' modifier ignored since `D' is the default (see `U')
  CCLD     xmllint
2025-02-02 16:01:23.206 | DEBUG    | scenario:evaluate:655 - testing candidate #5 against test #crash...
2025-02-02 16:01:23.207 | DEBUG    | shell:__call__:41 - executing: /data//vulnloc/libxml2/CVE-2017-5969/src/xmllint --recover /CrashRepair/experiments/vulnloc/libxml2/CVE-2017-5969/tests/1.xml
2025-02-02 16:01:23.216 | DEBUG    | test:run:189 - test failed: unexpected exit code (actual: 139, expected: 0)
2025-02-02 16:01:23.216 | INFO     | scenario:evaluate:662 - candidate #5 fails test #crash
2025-02-02 16:01:23.221 | INFO     | scenario:evaluate:635 - evaluating candidate patch #6:
@@ -1155,6 +1155,7 @@
  *
  * This will dump the content of the element table as an XML DTD definition
  */
+
 static void
 xmlDumpElementContent(xmlBufferPtr buf, xmlElementContentPtr content, int glob) {
     if (content == NULL) return;
@@ -1163,64 +1164,65 @@
     switch (content->type) {
         case XML_ELEMENT_CONTENT_PCDATA:
             xmlBufferWriteChar(buf, "#PCDATA");
-    break;
-case XML_ELEMENT_CONTENT_ELEMENT:
-    if (content->prefix != NULL) {
-xmlBufferWriteCHAR(buf, content->prefix);
-xmlBufferWriteChar(buf, ":");
-    }
-    xmlBufferWriteCHAR(buf, content->name);
-    break;
-case XML_ELEMENT_CONTENT_SEQ:
-    if ((content->c1->type == XML_ELEMENT_CONTENT_OR) ||
-        (content->c1->type == XML_ELEMENT_CONTENT_SEQ))
-xmlDumpElementContent(buf, content->c1, 1);
-    else
-xmlDumpElementContent(buf, content->c1, 0);
+            break;
+        case XML_ELEMENT_CONTENT_ELEMENT:
+            if (content->prefix != NULL) {
+                xmlBufferWriteCHAR(buf, content->prefix);
+                xmlBufferWriteChar(buf, ":");
+            }
+            xmlBufferWriteCHAR(buf, content->name);
+            break;
+        case XML_ELEMENT_CONTENT_SEQ:
+            if ((content->c1->type == XML_ELEMENT_CONTENT_OR) ||
+                (content->c1->type == XML_ELEMENT_CONTENT_SEQ))
+                xmlDumpElementContent(buf, content->c1, 1);
+            else
+                xmlDumpElementContent(buf, content->c1, 0);
             xmlBufferWriteChar(buf, " , ");
-    if ((content->c2->type == XML_ELEMENT_CONTENT_OR) ||
-        ((content->c2->type == XML_ELEMENT_CONTENT_SEQ) &&
- (content->c2->ocur != XML_ELEMENT_CONTENT_ONCE)))
-xmlDumpElementContent(buf, content->c2, 1);
-    else
-xmlDumpElementContent(buf, content->c2, 0);
-    break;
-case XML_ELEMENT_CONTENT_OR:
-    if ((content->c1->type == XML_ELEMENT_CONTENT_OR) ||
-        (content->c1->type == XML_ELEMENT_CONTENT_SEQ))
-xmlDumpElementContent(buf, content->c1, 1);
-    else
-xmlDumpElementContent(buf, content->c1, 0);
+            if ((content->c2->type == XML_ELEMENT_CONTENT_OR) ||
+                ((content->c2->type == XML_ELEMENT_CONTENT_SEQ) &&
+                 (content->c2->ocur != XML_ELEMENT_CONTENT_ONCE)))
+                xmlDumpElementContent(buf, content->c2, 1);
+            else
+                xmlDumpElementContent(buf, content->c2, 0);
+            break;
+        case XML_ELEMENT_CONTENT_OR:
+            if ((content->c1->type == XML_ELEMENT_CONTENT_OR) ||
+                (content->c1->type == XML_ELEMENT_CONTENT_SEQ))
+                xmlDumpElementContent(buf, content->c1, 1);
+            else
+                xmlDumpElementContent(buf, content->c1, 0);
             xmlBufferWriteChar(buf, " | ");
-    if ((content->c2->type == XML_ELEMENT_CONTENT_SEQ) ||
-        ((content->c2->type == XML_ELEMENT_CONTENT_OR) &&
- (content->c2->ocur != XML_ELEMENT_CONTENT_ONCE)))
-xmlDumpElementContent(buf, content->c2, 1);
-    else
-xmlDumpElementContent(buf, content->c2, 0);
-    break;
-default:
-    xmlErrValid(NULL, XML_ERR_INTERNAL_ERROR,
-    "Internal: ELEMENT content corrupted invalid type\n",
-    NULL);
+            if ((content->c2->type == XML_ELEMENT_CONTENT_SEQ) ||
+                ((content->c2->type == XML_ELEMENT_CONTENT_OR) &&
+                 (content->c2->ocur != XML_ELEMENT_CONTENT_ONCE)))
+                xmlDumpElementContent(buf, content->c2, 1);
+            else
+                xmlDumpElementContent(buf, content->c2, 0);
+            break;
+        default:
+            xmlErrValid(NULL, XML_ERR_INTERNAL_ERROR,
+                        "Internal: ELEMENT content corrupted invalid type\n",
+                        NULL);
     }
     if (glob)
         xmlBufferWriteChar(buf, ")");
     switch (content->ocur) {
         case XML_ELEMENT_CONTENT_ONCE:
-    break;
+            break;
         case XML_ELEMENT_CONTENT_OPT:
-    xmlBufferWriteChar(buf, "?");
-    break;
+            xmlBufferWriteChar(buf, "?");
+            break;
         case XML_ELEMENT_CONTENT_MULT:
-    xmlBufferWriteChar(buf, "*");
-    break;
+            xmlBufferWriteChar(buf, "*");
+            break;
         case XML_ELEMENT_CONTENT_PLUS:
-    xmlBufferWriteChar(buf, "+");
-    break;
+            xmlBufferWriteChar(buf, "+");
+            break;
     }
 }
 
+
 /**
  * xmlSprintfElementContent:
  * @buf:  an output buffer

2025-02-02 16:01:23.227 | DEBUG    | scenario:rebuild:369 - original environment: environ({'CONDA_SHLVL': '2', 'LC_ALL': 'C.UTF-8', 'LS_COLORS': 'rs=0:di=01;34:ln=01;36:mh=00:pi=40;33:so=01;35:do=01;35:bd=40;33;01:cd=40;33;01:or=40;31;01:mi=00:su=37;41:sg=30;43:ca=30;41:tw=30;42:ow=34;42:st=37;44:ex=01;32:*.tar=01;31:*.tgz=01;31:*.arc=01;31:*.arj=01;31:*.taz=01;31:*.lha=01;31:*.lz4=01;31:*.lzh=01;31:*.lzma=01;31:*.tlz=01;31:*.txz=01;31:*.tzo=01;31:*.t7z=01;31:*.zip=01;31:*.z=01;31:*.Z=01;31:*.dz=01;31:*.gz=01;31:*.lrz=01;31:*.lz=01;31:*.lzo=01;31:*.xz=01;31:*.zst=01;31:*.tzst=01;31:*.bz2=01;31:*.bz=01;31:*.tbz=01;31:*.tbz2=01;31:*.tz=01;31:*.deb=01;31:*.rpm=01;31:*.jar=01;31:*.war=01;31:*.ear=01;31:*.sar=01;31:*.rar=01;31:*.alz=01;31:*.ace=01;31:*.zoo=01;31:*.cpio=01;31:*.7z=01;31:*.rz=01;31:*.cab=01;31:*.wim=01;31:*.swm=01;31:*.dwm=01;31:*.esd=01;31:*.jpg=01;35:*.jpeg=01;35:*.mjpg=01;35:*.mjpeg=01;35:*.gif=01;35:*.bmp=01;35:*.pbm=01;35:*.pgm=01;35:*.ppm=01;35:*.tga=01;35:*.xbm=01;35:*.xpm=01;35:*.tif=01;35:*.tiff=01;35:*.png=01;35:*.svg=01;35:*.svgz=01;35:*.mng=01;35:*.pcx=01;35:*.mov=01;35:*.mpg=01;35:*.mpeg=01;35:*.m2v=01;35:*.mkv=01;35:*.webm=01;35:*.ogm=01;35:*.mp4=01;35:*.m4v=01;35:*.mp4v=01;35:*.vob=01;35:*.qt=01;35:*.nuv=01;35:*.wmv=01;35:*.asf=01;35:*.rm=01;35:*.rmvb=01;35:*.flc=01;35:*.avi=01;35:*.fli=01;35:*.flv=01;35:*.gl=01;35:*.dl=01;35:*.xcf=01;35:*.xwd=01;35:*.yuv=01;35:*.cgm=01;35:*.emf=01;35:*.ogv=01;35:*.ogx=01;35:*.aac=00;36:*.au=00;36:*.flac=00;36:*.m4a=00;36:*.mid=00;36:*.midi=00;36:*.mka=00;36:*.mp3=00;36:*.mpc=00;36:*.ogg=00;36:*.ra=00;36:*.wav=00;36:*.oga=00;36:*.opus=00;36:*.spx=00;36:*.xspf=00;36:', 'LD_LIBRARY_PATH': '/opt/crashrepair/lib:/CrashRepair/lib:/klee/build/lib:', 'CONDA_EXE': '/root/anaconda3/bin/conda', 'LANG': 'C.UTF-8', 'TZ': 'Asia/Shanghai', 'HOSTNAME': 'fea22102047d', 'OLDPWD': '/orchestrator', 'CONDA_PREFIX': '/root/anaconda3/envs/CrashRepair', '_CE_M': '', 'CC': 'crepair-cc', 'LLVM_COMPILER': 'clang', 'CONDA_PREFIX_1': '/root/anaconda3', 'PWD': '/orchestrator/crashrepair', 'HOME': '/root', 'CONDA_PYTHON_EXE': '/root/anaconda3/bin/python', '_CE_CONDA': '', 'CONDA_PROMPT_MODIFIER': '(CrashRepair) ', 'CXX': 'crepair-cxx', 'TERM': 'xterm', 'SHLVL': '2', 'PYTHONPATH': '/usr/lib/python3.8/site-packages:', 'PATH': '/root/anaconda3/envs/CrashRepair/bin:/root/anaconda3/condabin:~/anaconda3/bin:/opt/crashrepair/bin:/CrashRepair/compiler:/klee/build/bin:/opt/llvm-6/bin:/klee/build/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', 'CONDA_DEFAULT_ENV': 'CrashRepair', '_': '/root/anaconda3/envs/CrashRepair/bin/python'})
2025-02-02 16:01:23.227 | DEBUG    | scenario:rebuild:382 - injecting ghost function into CFLAGS during build: -lcrepair_ghost
2025-02-02 16:01:23.227 | DEBUG    | scenario:rebuild:398 - using environment: {'INJECT_CFLAGS': '-g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address', 'INJECT_CXXFLAGS': '-g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address', 'INJECT_LDFLAGS': '-g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address'}
2025-02-02 16:01:23.227 | DEBUG    | shell:__call__:41 - executing: make CFLAGS="${INJECT_CFLAGS}" CXXFLAGS="${INJECT_CXXFLAGS}" LDFLAGS="${INJECT_LDFLAGS}" xmllint
  CC       valid.lo
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_ghost: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
  CCLD     libxml2.la
ar: `u' modifier ignored since `D' is the default (see `U')
  CCLD     xmllint
2025-02-02 16:01:23.721 | DEBUG    | scenario:evaluate:655 - testing candidate #6 against test #crash...
2025-02-02 16:01:23.721 | DEBUG    | shell:__call__:41 - executing: /data//vulnloc/libxml2/CVE-2017-5969/src/xmllint --recover /CrashRepair/experiments/vulnloc/libxml2/CVE-2017-5969/tests/1.xml
2025-02-02 16:01:23.729 | DEBUG    | test:run:189 - test failed: unexpected exit code (actual: 139, expected: 0)
2025-02-02 16:01:23.729 | INFO     | scenario:evaluate:662 - candidate #6 fails test #crash
2025-02-02 16:01:23.734 | INFO     | scenario:evaluate:635 - evaluating candidate patch #7:
@@ -1155,6 +1155,7 @@
  *
  * This will dump the content of the element table as an XML DTD definition
  */
+
 static void
 xmlDumpElementContent(xmlBufferPtr buf, xmlElementContentPtr content, int glob) {
     if (content == NULL) return;
@@ -1163,64 +1164,69 @@
     switch (content->type) {
         case XML_ELEMENT_CONTENT_PCDATA:
             xmlBufferWriteChar(buf, "#PCDATA");
-    break;
-case XML_ELEMENT_CONTENT_ELEMENT:
-    if (content->prefix != NULL) {
-xmlBufferWriteCHAR(buf, content->prefix);
-xmlBufferWriteChar(buf, ":");
-    }
-    xmlBufferWriteCHAR(buf, content->name);
-    break;
-case XML_ELEMENT_CONTENT_SEQ:
-    if ((content->c1->type == XML_ELEMENT_CONTENT_OR) ||
-        (content->c1->type == XML_ELEMENT_CONTENT_SEQ))
-xmlDumpElementContent(buf, content->c1, 1);
-    else
-xmlDumpElementContent(buf, content->c1, 0);
+            break;
+        case XML_ELEMENT_CONTENT_ELEMENT:
+            if (content->prefix != NULL) {
+                xmlBufferWriteCHAR(buf, content->prefix);
+                xmlBufferWriteChar(buf, ":");
+            }
+            xmlBufferWriteCHAR(buf, content->name);
+            break;
+        case XML_ELEMENT_CONTENT_SEQ:
+            if ((content->c1->type == XML_ELEMENT_CONTENT_OR) ||
+                (content->c1->type == XML_ELEMENT_CONTENT_SEQ)) {
+                xmlDumpElementContent(buf, content->c1, 1);
+            } else {
+                xmlDumpElementContent(buf, content->c1, 0);
+            }
             xmlBufferWriteChar(buf, " , ");
-    if ((content->c2->type == XML_ELEMENT_CONTENT_OR) ||
-        ((content->c2->type == XML_ELEMENT_CONTENT_SEQ) &&
- (content->c2->ocur != XML_ELEMENT_CONTENT_ONCE)))
-xmlDumpElementContent(buf, content->c2, 1);
-    else
-xmlDumpElementContent(buf, content->c2, 0);
-    break;
-case XML_ELEMENT_CONTENT_OR:
-    if ((content->c1->type == XML_ELEMENT_CONTENT_OR) ||
-        (content->c1->type == XML_ELEMENT_CONTENT_SEQ))
-xmlDumpElementContent(buf, content->c1, 1);
-    else
-xmlDumpElementContent(buf, content->c1, 0);
+            if ((content->c2->type == XML_ELEMENT_CONTENT_OR) ||
+                ((content->c2->type == XML_ELEMENT_CONTENT_SEQ) &&
+                (content->c2->ocur != XML_ELEMENT_CONTENT_ONCE))) {
+                xmlDumpElementContent(buf, content->c2, 1);
+            } else {
+                xmlDumpElementContent(buf, content->c2, 0);
+            }
+            break;
+        case XML_ELEMENT_CONTENT_OR:
+            if ((content->c1->type == XML_ELEMENT_CONTENT_OR) ||
+                (content->c1->type == XML_ELEMENT_CONTENT_SEQ)) {
+                xmlDumpElementContent(buf, content->c1, 1);
+            } else {
+                xmlDumpElementContent(buf, content->c1, 0);
+            }
             xmlBufferWriteChar(buf, " | ");
-    if ((content->c2->type == XML_ELEMENT_CONTENT_SEQ) ||
-        ((content->c2->type == XML_ELEMENT_CONTENT_OR) &&
- (content->c2->ocur != XML_ELEMENT_CONTENT_ONCE)))
-xmlDumpElementContent(buf, content->c2, 1);
-    else
-xmlDumpElementContent(buf, content->c2, 0);
-    break;
-default:
-    xmlErrValid(NULL, XML_ERR_INTERNAL_ERROR,
-    "Internal: ELEMENT content corrupted invalid type\n",
-    NULL);
+            if ((content->c2->type == XML_ELEMENT_CONTENT_SEQ) ||
+                ((content->c2->type == XML_ELEMENT_CONTENT_OR) &&
+                (content->c2->ocur != XML_ELEMENT_CONTENT_ONCE))) {
+                xmlDumpElementContent(buf, content->c2, 1);
+            } else {
+                xmlDumpElementContent(buf, content->c2, 0);
+            }
+            break;
+        default:
+            xmlErrValid(NULL, XML_ERR_INTERNAL_ERROR,
+            "Internal: ELEMENT content corrupted invalid type\n",
+            NULL);
     }
     if (glob)
         xmlBufferWriteChar(buf, ")");
     switch (content->ocur) {
         case XML_ELEMENT_CONTENT_ONCE:
-    break;
+            break;
         case XML_ELEMENT_CONTENT_OPT:
-    xmlBufferWriteChar(buf, "?");
-    break;
+            xmlBufferWriteChar(buf, "?");
+            break;
         case XML_ELEMENT_CONTENT_MULT:
-    xmlBufferWriteChar(buf, "*");
-    break;
+            xmlBufferWriteChar(buf, "*");
+            break;
         case XML_ELEMENT_CONTENT_PLUS:
-    xmlBufferWriteChar(buf, "+");
-    break;
+            xmlBufferWriteChar(buf, "+");
+            break;
     }
 }
 
+
 /**
  * xmlSprintfElementContent:
  * @buf:  an output buffer

2025-02-02 16:01:23.740 | DEBUG    | scenario:rebuild:369 - original environment: environ({'CONDA_SHLVL': '2', 'LC_ALL': 'C.UTF-8', 'LS_COLORS': 'rs=0:di=01;34:ln=01;36:mh=00:pi=40;33:so=01;35:do=01;35:bd=40;33;01:cd=40;33;01:or=40;31;01:mi=00:su=37;41:sg=30;43:ca=30;41:tw=30;42:ow=34;42:st=37;44:ex=01;32:*.tar=01;31:*.tgz=01;31:*.arc=01;31:*.arj=01;31:*.taz=01;31:*.lha=01;31:*.lz4=01;31:*.lzh=01;31:*.lzma=01;31:*.tlz=01;31:*.txz=01;31:*.tzo=01;31:*.t7z=01;31:*.zip=01;31:*.z=01;31:*.Z=01;31:*.dz=01;31:*.gz=01;31:*.lrz=01;31:*.lz=01;31:*.lzo=01;31:*.xz=01;31:*.zst=01;31:*.tzst=01;31:*.bz2=01;31:*.bz=01;31:*.tbz=01;31:*.tbz2=01;31:*.tz=01;31:*.deb=01;31:*.rpm=01;31:*.jar=01;31:*.war=01;31:*.ear=01;31:*.sar=01;31:*.rar=01;31:*.alz=01;31:*.ace=01;31:*.zoo=01;31:*.cpio=01;31:*.7z=01;31:*.rz=01;31:*.cab=01;31:*.wim=01;31:*.swm=01;31:*.dwm=01;31:*.esd=01;31:*.jpg=01;35:*.jpeg=01;35:*.mjpg=01;35:*.mjpeg=01;35:*.gif=01;35:*.bmp=01;35:*.pbm=01;35:*.pgm=01;35:*.ppm=01;35:*.tga=01;35:*.xbm=01;35:*.xpm=01;35:*.tif=01;35:*.tiff=01;35:*.png=01;35:*.svg=01;35:*.svgz=01;35:*.mng=01;35:*.pcx=01;35:*.mov=01;35:*.mpg=01;35:*.mpeg=01;35:*.m2v=01;35:*.mkv=01;35:*.webm=01;35:*.ogm=01;35:*.mp4=01;35:*.m4v=01;35:*.mp4v=01;35:*.vob=01;35:*.qt=01;35:*.nuv=01;35:*.wmv=01;35:*.asf=01;35:*.rm=01;35:*.rmvb=01;35:*.flc=01;35:*.avi=01;35:*.fli=01;35:*.flv=01;35:*.gl=01;35:*.dl=01;35:*.xcf=01;35:*.xwd=01;35:*.yuv=01;35:*.cgm=01;35:*.emf=01;35:*.ogv=01;35:*.ogx=01;35:*.aac=00;36:*.au=00;36:*.flac=00;36:*.m4a=00;36:*.mid=00;36:*.midi=00;36:*.mka=00;36:*.mp3=00;36:*.mpc=00;36:*.ogg=00;36:*.ra=00;36:*.wav=00;36:*.oga=00;36:*.opus=00;36:*.spx=00;36:*.xspf=00;36:', 'LD_LIBRARY_PATH': '/opt/crashrepair/lib:/CrashRepair/lib:/klee/build/lib:', 'CONDA_EXE': '/root/anaconda3/bin/conda', 'LANG': 'C.UTF-8', 'TZ': 'Asia/Shanghai', 'HOSTNAME': 'fea22102047d', 'OLDPWD': '/orchestrator', 'CONDA_PREFIX': '/root/anaconda3/envs/CrashRepair', '_CE_M': '', 'CC': 'crepair-cc', 'LLVM_COMPILER': 'clang', 'CONDA_PREFIX_1': '/root/anaconda3', 'PWD': '/orchestrator/crashrepair', 'HOME': '/root', 'CONDA_PYTHON_EXE': '/root/anaconda3/bin/python', '_CE_CONDA': '', 'CONDA_PROMPT_MODIFIER': '(CrashRepair) ', 'CXX': 'crepair-cxx', 'TERM': 'xterm', 'SHLVL': '2', 'PYTHONPATH': '/usr/lib/python3.8/site-packages:', 'PATH': '/root/anaconda3/envs/CrashRepair/bin:/root/anaconda3/condabin:~/anaconda3/bin:/opt/crashrepair/bin:/CrashRepair/compiler:/klee/build/bin:/opt/llvm-6/bin:/klee/build/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', 'CONDA_DEFAULT_ENV': 'CrashRepair', '_': '/root/anaconda3/envs/CrashRepair/bin/python'})
2025-02-02 16:01:23.740 | DEBUG    | scenario:rebuild:382 - injecting ghost function into CFLAGS during build: -lcrepair_ghost
2025-02-02 16:01:23.740 | DEBUG    | scenario:rebuild:398 - using environment: {'INJECT_CFLAGS': '-g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address', 'INJECT_CXXFLAGS': '-g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address', 'INJECT_LDFLAGS': '-g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address'}
2025-02-02 16:01:23.740 | DEBUG    | shell:__call__:41 - executing: make CFLAGS="${INJECT_CFLAGS}" CXXFLAGS="${INJECT_CXXFLAGS}" LDFLAGS="${INJECT_LDFLAGS}" xmllint
  CC       valid.lo
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_ghost: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
  CCLD     libxml2.la
ar: `u' modifier ignored since `D' is the default (see `U')
  CCLD     xmllint
2025-02-02 16:01:24.212 | DEBUG    | scenario:evaluate:655 - testing candidate #7 against test #crash...
2025-02-02 16:01:24.212 | DEBUG    | shell:__call__:41 - executing: /data//vulnloc/libxml2/CVE-2017-5969/src/xmllint --recover /CrashRepair/experiments/vulnloc/libxml2/CVE-2017-5969/tests/1.xml
2025-02-02 16:01:24.221 | DEBUG    | test:run:189 - test failed: unexpected exit code (actual: 139, expected: 0)
2025-02-02 16:01:24.221 | INFO     | scenario:evaluate:662 - candidate #7 fails test #crash
2025-02-02 16:01:24.225 | INFO     | scenario:evaluate:635 - evaluating candidate patch #8:
@@ -1155,6 +1155,7 @@
  *
  * This will dump the content of the element table as an XML DTD definition
  */
+
 static void
 xmlDumpElementContent(xmlBufferPtr buf, xmlElementContentPtr content, int glob) {
     if (content == NULL) return;
@@ -1163,64 +1164,65 @@
     switch (content->type) {
         case XML_ELEMENT_CONTENT_PCDATA:
             xmlBufferWriteChar(buf, "#PCDATA");
-    break;
-case XML_ELEMENT_CONTENT_ELEMENT:
-    if (content->prefix != NULL) {
-xmlBufferWriteCHAR(buf, content->prefix);
-xmlBufferWriteChar(buf, ":");
-    }
-    xmlBufferWriteCHAR(buf, content->name);
-    break;
-case XML_ELEMENT_CONTENT_SEQ:
-    if ((content->c1->type == XML_ELEMENT_CONTENT_OR) ||
-        (content->c1->type == XML_ELEMENT_CONTENT_SEQ))
-xmlDumpElementContent(buf, content->c1, 1);
-    else
-xmlDumpElementContent(buf, content->c1, 0);
+            break;
+        case XML_ELEMENT_CONTENT_ELEMENT:
+            if (content->prefix != NULL) {
+                xmlBufferWriteCHAR(buf, content->prefix);
+                xmlBufferWriteChar(buf, ":");
+            }
+            xmlBufferWriteCHAR(buf, content->name);
+            break;
+        case XML_ELEMENT_CONTENT_SEQ:
+            if ((content->c1->type == XML_ELEMENT_CONTENT_OR) ||
+                (content->c1->type == XML_ELEMENT_CONTENT_SEQ))
+                xmlDumpElementContent(buf, content->c1, 1);
+            else
+                xmlDumpElementContent(buf, content->c1, 0);
             xmlBufferWriteChar(buf, " , ");
-    if ((content->c2->type == XML_ELEMENT_CONTENT_OR) ||
-        ((content->c2->type == XML_ELEMENT_CONTENT_SEQ) &&
- (content->c2->ocur != XML_ELEMENT_CONTENT_ONCE)))
-xmlDumpElementContent(buf, content->c2, 1);
-    else
-xmlDumpElementContent(buf, content->c2, 0);
-    break;
-case XML_ELEMENT_CONTENT_OR:
-    if ((content->c1->type == XML_ELEMENT_CONTENT_OR) ||
-        (content->c1->type == XML_ELEMENT_CONTENT_SEQ))
-xmlDumpElementContent(buf, content->c1, 1);
-    else
-xmlDumpElementContent(buf, content->c1, 0);
+            if ((content->c2->type == XML_ELEMENT_CONTENT_OR) ||
+                ((content->c2->type == XML_ELEMENT_CONTENT_SEQ) &&
+                 (content->c2->ocur != XML_ELEMENT_CONTENT_ONCE)))
+                xmlDumpElementContent(buf, content->c2, 1);
+            else
+                xmlDumpElementContent(buf, content->c2, 0);
+            break;
+        case XML_ELEMENT_CONTENT_OR:
+            if ((content->c1->type == XML_ELEMENT_CONTENT_OR) ||
+                (content->c1->type == XML_ELEMENT_CONTENT_SEQ))
+                xmlDumpElementContent(buf, content->c1, 1);
+            else
+                xmlDumpElementContent(buf, content->c1, 0);
             xmlBufferWriteChar(buf, " | ");
-    if ((content->c2->type == XML_ELEMENT_CONTENT_SEQ) ||
-        ((content->c2->type == XML_ELEMENT_CONTENT_OR) &&
- (content->c2->ocur != XML_ELEMENT_CONTENT_ONCE)))
-xmlDumpElementContent(buf, content->c2, 1);
-    else
-xmlDumpElementContent(buf, content->c2, 0);
-    break;
-default:
-    xmlErrValid(NULL, XML_ERR_INTERNAL_ERROR,
-    "Internal: ELEMENT content corrupted invalid type\n",
-    NULL);
+            if ((content->c2->type == XML_ELEMENT_CONTENT_SEQ) ||
+                ((content->c2->type == XML_ELEMENT_CONTENT_OR) &&
+                 (content->c2->ocur != XML_ELEMENT_CONTENT_ONCE)))
+                xmlDumpElementContent(buf, content->c2, 1);
+            else
+                xmlDumpElementContent(buf, content->c2, 0);
+            break;
+        default:
+            xmlErrValid(NULL, XML_ERR_INTERNAL_ERROR,
+                        "Internal: ELEMENT content corrupted invalid type\n",
+                        NULL);
     }
     if (glob)
         xmlBufferWriteChar(buf, ")");
     switch (content->ocur) {
         case XML_ELEMENT_CONTENT_ONCE:
-    break;
+            break;
         case XML_ELEMENT_CONTENT_OPT:
-    xmlBufferWriteChar(buf, "?");
-    break;
+            xmlBufferWriteChar(buf, "?");
+            break;
         case XML_ELEMENT_CONTENT_MULT:
-    xmlBufferWriteChar(buf, "*");
-    break;
+            xmlBufferWriteChar(buf, "*");
+            break;
         case XML_ELEMENT_CONTENT_PLUS:
-    xmlBufferWriteChar(buf, "+");
-    break;
+            xmlBufferWriteChar(buf, "+");
+            break;
     }
 }
 
+
 /**
  * xmlSprintfElementContent:
  * @buf:  an output buffer

2025-02-02 16:01:24.234 | DEBUG    | scenario:rebuild:369 - original environment: environ({'CONDA_SHLVL': '2', 'LC_ALL': 'C.UTF-8', 'LS_COLORS': 'rs=0:di=01;34:ln=01;36:mh=00:pi=40;33:so=01;35:do=01;35:bd=40;33;01:cd=40;33;01:or=40;31;01:mi=00:su=37;41:sg=30;43:ca=30;41:tw=30;42:ow=34;42:st=37;44:ex=01;32:*.tar=01;31:*.tgz=01;31:*.arc=01;31:*.arj=01;31:*.taz=01;31:*.lha=01;31:*.lz4=01;31:*.lzh=01;31:*.lzma=01;31:*.tlz=01;31:*.txz=01;31:*.tzo=01;31:*.t7z=01;31:*.zip=01;31:*.z=01;31:*.Z=01;31:*.dz=01;31:*.gz=01;31:*.lrz=01;31:*.lz=01;31:*.lzo=01;31:*.xz=01;31:*.zst=01;31:*.tzst=01;31:*.bz2=01;31:*.bz=01;31:*.tbz=01;31:*.tbz2=01;31:*.tz=01;31:*.deb=01;31:*.rpm=01;31:*.jar=01;31:*.war=01;31:*.ear=01;31:*.sar=01;31:*.rar=01;31:*.alz=01;31:*.ace=01;31:*.zoo=01;31:*.cpio=01;31:*.7z=01;31:*.rz=01;31:*.cab=01;31:*.wim=01;31:*.swm=01;31:*.dwm=01;31:*.esd=01;31:*.jpg=01;35:*.jpeg=01;35:*.mjpg=01;35:*.mjpeg=01;35:*.gif=01;35:*.bmp=01;35:*.pbm=01;35:*.pgm=01;35:*.ppm=01;35:*.tga=01;35:*.xbm=01;35:*.xpm=01;35:*.tif=01;35:*.tiff=01;35:*.png=01;35:*.svg=01;35:*.svgz=01;35:*.mng=01;35:*.pcx=01;35:*.mov=01;35:*.mpg=01;35:*.mpeg=01;35:*.m2v=01;35:*.mkv=01;35:*.webm=01;35:*.ogm=01;35:*.mp4=01;35:*.m4v=01;35:*.mp4v=01;35:*.vob=01;35:*.qt=01;35:*.nuv=01;35:*.wmv=01;35:*.asf=01;35:*.rm=01;35:*.rmvb=01;35:*.flc=01;35:*.avi=01;35:*.fli=01;35:*.flv=01;35:*.gl=01;35:*.dl=01;35:*.xcf=01;35:*.xwd=01;35:*.yuv=01;35:*.cgm=01;35:*.emf=01;35:*.ogv=01;35:*.ogx=01;35:*.aac=00;36:*.au=00;36:*.flac=00;36:*.m4a=00;36:*.mid=00;36:*.midi=00;36:*.mka=00;36:*.mp3=00;36:*.mpc=00;36:*.ogg=00;36:*.ra=00;36:*.wav=00;36:*.oga=00;36:*.opus=00;36:*.spx=00;36:*.xspf=00;36:', 'LD_LIBRARY_PATH': '/opt/crashrepair/lib:/CrashRepair/lib:/klee/build/lib:', 'CONDA_EXE': '/root/anaconda3/bin/conda', 'LANG': 'C.UTF-8', 'TZ': 'Asia/Shanghai', 'HOSTNAME': 'fea22102047d', 'OLDPWD': '/orchestrator', 'CONDA_PREFIX': '/root/anaconda3/envs/CrashRepair', '_CE_M': '', 'CC': 'crepair-cc', 'LLVM_COMPILER': 'clang', 'CONDA_PREFIX_1': '/root/anaconda3', 'PWD': '/orchestrator/crashrepair', 'HOME': '/root', 'CONDA_PYTHON_EXE': '/root/anaconda3/bin/python', '_CE_CONDA': '', 'CONDA_PROMPT_MODIFIER': '(CrashRepair) ', 'CXX': 'crepair-cxx', 'TERM': 'xterm', 'SHLVL': '2', 'PYTHONPATH': '/usr/lib/python3.8/site-packages:', 'PATH': '/root/anaconda3/envs/CrashRepair/bin:/root/anaconda3/condabin:~/anaconda3/bin:/opt/crashrepair/bin:/CrashRepair/compiler:/klee/build/bin:/opt/llvm-6/bin:/klee/build/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', 'CONDA_DEFAULT_ENV': 'CrashRepair', '_': '/root/anaconda3/envs/CrashRepair/bin/python'})
2025-02-02 16:01:24.234 | DEBUG    | scenario:rebuild:382 - injecting ghost function into CFLAGS during build: -lcrepair_ghost
2025-02-02 16:01:24.234 | DEBUG    | scenario:rebuild:398 - using environment: {'INJECT_CFLAGS': '-g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address', 'INJECT_CXXFLAGS': '-g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address', 'INJECT_LDFLAGS': '-g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address'}
2025-02-02 16:01:24.234 | DEBUG    | shell:__call__:41 - executing: make CFLAGS="${INJECT_CFLAGS}" CXXFLAGS="${INJECT_CXXFLAGS}" LDFLAGS="${INJECT_LDFLAGS}" xmllint
  CC       valid.lo
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_ghost: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
  CCLD     libxml2.la
ar: `u' modifier ignored since `D' is the default (see `U')
  CCLD     xmllint
2025-02-02 16:01:24.720 | DEBUG    | scenario:evaluate:655 - testing candidate #8 against test #crash...
2025-02-02 16:01:24.721 | DEBUG    | shell:__call__:41 - executing: /data//vulnloc/libxml2/CVE-2017-5969/src/xmllint --recover /CrashRepair/experiments/vulnloc/libxml2/CVE-2017-5969/tests/1.xml
2025-02-02 16:01:24.729 | DEBUG    | test:run:189 - test failed: unexpected exit code (actual: 139, expected: 0)
2025-02-02 16:01:24.729 | INFO     | scenario:evaluate:662 - candidate #8 fails test #crash
2025-02-02 16:01:24.733 | INFO     | scenario:evaluate:635 - evaluating candidate patch #9:
@@ -1155,6 +1155,7 @@
  *
  * This will dump the content of the element table as an XML DTD definition
  */
+
 static void
 xmlDumpElementContent(xmlBufferPtr buf, xmlElementContentPtr content, int glob) {
     if (content == NULL) return;
@@ -1163,64 +1164,69 @@
     switch (content->type) {
         case XML_ELEMENT_CONTENT_PCDATA:
             xmlBufferWriteChar(buf, "#PCDATA");
-    break;
-case XML_ELEMENT_CONTENT_ELEMENT:
-    if (content->prefix != NULL) {
-xmlBufferWriteCHAR(buf, content->prefix);
-xmlBufferWriteChar(buf, ":");
-    }
-    xmlBufferWriteCHAR(buf, content->name);
-    break;
-case XML_ELEMENT_CONTENT_SEQ:
-    if ((content->c1->type == XML_ELEMENT_CONTENT_OR) ||
-        (content->c1->type == XML_ELEMENT_CONTENT_SEQ))
-xmlDumpElementContent(buf, content->c1, 1);
-    else
-xmlDumpElementContent(buf, content->c1, 0);
+            break;
+        case XML_ELEMENT_CONTENT_ELEMENT:
+            if (content->prefix != NULL) {
+                xmlBufferWriteCHAR(buf, content->prefix);
+                xmlBufferWriteChar(buf, ":");
+            }
+            xmlBufferWriteCHAR(buf, content->name);
+            break;
+        case XML_ELEMENT_CONTENT_SEQ:
+            if ((content->c1->type == XML_ELEMENT_CONTENT_OR) ||
+                (content->c1->type == XML_ELEMENT_CONTENT_SEQ)) {
+                xmlDumpElementContent(buf, content->c1, 1);
+            } else {
+                xmlDumpElementContent(buf, content->c1, 0);
+            }
             xmlBufferWriteChar(buf, " , ");
-    if ((content->c2->type == XML_ELEMENT_CONTENT_OR) ||
-        ((content->c2->type == XML_ELEMENT_CONTENT_SEQ) &&
- (content->c2->ocur != XML_ELEMENT_CONTENT_ONCE)))
-xmlDumpElementContent(buf, content->c2, 1);
-    else
-xmlDumpElementContent(buf, content->c2, 0);
-    break;
-case XML_ELEMENT_CONTENT_OR:
-    if ((content->c1->type == XML_ELEMENT_CONTENT_OR) ||
-        (content->c1->type == XML_ELEMENT_CONTENT_SEQ))
-xmlDumpElementContent(buf, content->c1, 1);
-    else
-xmlDumpElementContent(buf, content->c1, 0);
+            if ((content->c2->type == XML_ELEMENT_CONTENT_OR) ||
+                ((content->c2->type == XML_ELEMENT_CONTENT_SEQ) && 
+                (content->c2->ocur != XML_ELEMENT_CONTENT_ONCE))) {
+                xmlDumpElementContent(buf, content->c2, 1);
+            } else {
+                xmlDumpElementContent(buf, content->c2, 0);
+            }
+            break;
+        case XML_ELEMENT_CONTENT_OR:
+            if ((content->c1->type == XML_ELEMENT_CONTENT_OR) ||
+                (content->c1->type == XML_ELEMENT_CONTENT_SEQ)) {
+                xmlDumpElementContent(buf, content->c1, 1);
+            } else {
+                xmlDumpElementContent(buf, content->c1, 0);
+            }
             xmlBufferWriteChar(buf, " | ");
-    if ((content->c2->type == XML_ELEMENT_CONTENT_SEQ) ||
-        ((content->c2->type == XML_ELEMENT_CONTENT_OR) &&
- (content->c2->ocur != XML_ELEMENT_CONTENT_ONCE)))
-xmlDumpElementContent(buf, content->c2, 1);
-    else
-xmlDumpElementContent(buf, content->c2, 0);
-    break;
-default:
-    xmlErrValid(NULL, XML_ERR_INTERNAL_ERROR,
-    "Internal: ELEMENT content corrupted invalid type\n",
-    NULL);
+            if ((content->c2->type == XML_ELEMENT_CONTENT_SEQ) ||
+                ((content->c2->type == XML_ELEMENT_CONTENT_OR) && 
+                (content->c2->ocur != XML_ELEMENT_CONTENT_ONCE))) {
+                xmlDumpElementContent(buf, content->c2, 1);
+            } else {
+                xmlDumpElementContent(buf, content->c2, 0);
+            }
+            break;
+        default:
+            xmlErrValid(NULL, XML_ERR_INTERNAL_ERROR,
+            "Internal: ELEMENT content corrupted invalid type\n",
+            NULL);
     }
     if (glob)
         xmlBufferWriteChar(buf, ")");
     switch (content->ocur) {
         case XML_ELEMENT_CONTENT_ONCE:
-    break;
+            break;
         case XML_ELEMENT_CONTENT_OPT:
-    xmlBufferWriteChar(buf, "?");
-    break;
+            xmlBufferWriteChar(buf, "?");
+            break;
         case XML_ELEMENT_CONTENT_MULT:
-    xmlBufferWriteChar(buf, "*");
-    break;
+            xmlBufferWriteChar(buf, "*");
+            break;
         case XML_ELEMENT_CONTENT_PLUS:
-    xmlBufferWriteChar(buf, "+");
-    break;
+            xmlBufferWriteChar(buf, "+");
+            break;
     }
 }
 
+
 /**
  * xmlSprintfElementContent:
  * @buf:  an output buffer

2025-02-02 16:01:24.739 | DEBUG    | scenario:rebuild:369 - original environment: environ({'CONDA_SHLVL': '2', 'LC_ALL': 'C.UTF-8', 'LS_COLORS': 'rs=0:di=01;34:ln=01;36:mh=00:pi=40;33:so=01;35:do=01;35:bd=40;33;01:cd=40;33;01:or=40;31;01:mi=00:su=37;41:sg=30;43:ca=30;41:tw=30;42:ow=34;42:st=37;44:ex=01;32:*.tar=01;31:*.tgz=01;31:*.arc=01;31:*.arj=01;31:*.taz=01;31:*.lha=01;31:*.lz4=01;31:*.lzh=01;31:*.lzma=01;31:*.tlz=01;31:*.txz=01;31:*.tzo=01;31:*.t7z=01;31:*.zip=01;31:*.z=01;31:*.Z=01;31:*.dz=01;31:*.gz=01;31:*.lrz=01;31:*.lz=01;31:*.lzo=01;31:*.xz=01;31:*.zst=01;31:*.tzst=01;31:*.bz2=01;31:*.bz=01;31:*.tbz=01;31:*.tbz2=01;31:*.tz=01;31:*.deb=01;31:*.rpm=01;31:*.jar=01;31:*.war=01;31:*.ear=01;31:*.sar=01;31:*.rar=01;31:*.alz=01;31:*.ace=01;31:*.zoo=01;31:*.cpio=01;31:*.7z=01;31:*.rz=01;31:*.cab=01;31:*.wim=01;31:*.swm=01;31:*.dwm=01;31:*.esd=01;31:*.jpg=01;35:*.jpeg=01;35:*.mjpg=01;35:*.mjpeg=01;35:*.gif=01;35:*.bmp=01;35:*.pbm=01;35:*.pgm=01;35:*.ppm=01;35:*.tga=01;35:*.xbm=01;35:*.xpm=01;35:*.tif=01;35:*.tiff=01;35:*.png=01;35:*.svg=01;35:*.svgz=01;35:*.mng=01;35:*.pcx=01;35:*.mov=01;35:*.mpg=01;35:*.mpeg=01;35:*.m2v=01;35:*.mkv=01;35:*.webm=01;35:*.ogm=01;35:*.mp4=01;35:*.m4v=01;35:*.mp4v=01;35:*.vob=01;35:*.qt=01;35:*.nuv=01;35:*.wmv=01;35:*.asf=01;35:*.rm=01;35:*.rmvb=01;35:*.flc=01;35:*.avi=01;35:*.fli=01;35:*.flv=01;35:*.gl=01;35:*.dl=01;35:*.xcf=01;35:*.xwd=01;35:*.yuv=01;35:*.cgm=01;35:*.emf=01;35:*.ogv=01;35:*.ogx=01;35:*.aac=00;36:*.au=00;36:*.flac=00;36:*.m4a=00;36:*.mid=00;36:*.midi=00;36:*.mka=00;36:*.mp3=00;36:*.mpc=00;36:*.ogg=00;36:*.ra=00;36:*.wav=00;36:*.oga=00;36:*.opus=00;36:*.spx=00;36:*.xspf=00;36:', 'LD_LIBRARY_PATH': '/opt/crashrepair/lib:/CrashRepair/lib:/klee/build/lib:', 'CONDA_EXE': '/root/anaconda3/bin/conda', 'LANG': 'C.UTF-8', 'TZ': 'Asia/Shanghai', 'HOSTNAME': 'fea22102047d', 'OLDPWD': '/orchestrator', 'CONDA_PREFIX': '/root/anaconda3/envs/CrashRepair', '_CE_M': '', 'CC': 'crepair-cc', 'LLVM_COMPILER': 'clang', 'CONDA_PREFIX_1': '/root/anaconda3', 'PWD': '/orchestrator/crashrepair', 'HOME': '/root', 'CONDA_PYTHON_EXE': '/root/anaconda3/bin/python', '_CE_CONDA': '', 'CONDA_PROMPT_MODIFIER': '(CrashRepair) ', 'CXX': 'crepair-cxx', 'TERM': 'xterm', 'SHLVL': '2', 'PYTHONPATH': '/usr/lib/python3.8/site-packages:', 'PATH': '/root/anaconda3/envs/CrashRepair/bin:/root/anaconda3/condabin:~/anaconda3/bin:/opt/crashrepair/bin:/CrashRepair/compiler:/klee/build/bin:/opt/llvm-6/bin:/klee/build/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', 'CONDA_DEFAULT_ENV': 'CrashRepair', '_': '/root/anaconda3/envs/CrashRepair/bin/python'})
2025-02-02 16:01:24.739 | DEBUG    | scenario:rebuild:382 - injecting ghost function into CFLAGS during build: -lcrepair_ghost
2025-02-02 16:01:24.739 | DEBUG    | scenario:rebuild:398 - using environment: {'INJECT_CFLAGS': '-g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address', 'INJECT_CXXFLAGS': '-g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address', 'INJECT_LDFLAGS': '-g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address'}
2025-02-02 16:01:24.739 | DEBUG    | shell:__call__:41 - executing: make CFLAGS="${INJECT_CFLAGS}" CXXFLAGS="${INJECT_CXXFLAGS}" LDFLAGS="${INJECT_LDFLAGS}" xmllint
  CC       valid.lo
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_ghost: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
  CCLD     libxml2.la
ar: `u' modifier ignored since `D' is the default (see `U')
  CCLD     xmllint
2025-02-02 16:01:25.222 | DEBUG    | scenario:evaluate:655 - testing candidate #9 against test #crash...
2025-02-02 16:01:25.222 | DEBUG    | shell:__call__:41 - executing: /data//vulnloc/libxml2/CVE-2017-5969/src/xmllint --recover /CrashRepair/experiments/vulnloc/libxml2/CVE-2017-5969/tests/1.xml
2025-02-02 16:01:25.231 | DEBUG    | test:run:189 - test failed: unexpected exit code (actual: 139, expected: 0)
2025-02-02 16:01:25.231 | INFO     | scenario:evaluate:662 - candidate #9 fails test #crash
2025-02-02 16:01:25.238 | INFO     | scenario:evaluate:635 - evaluating candidate patch #10:
@@ -1155,6 +1155,7 @@
  *
  * This will dump the content of the element table as an XML DTD definition
  */
+
 static void
 xmlDumpElementContent(xmlBufferPtr buf, xmlElementContentPtr content, int glob) {
     if (content == NULL) return;
@@ -1163,64 +1164,69 @@
     switch (content->type) {
         case XML_ELEMENT_CONTENT_PCDATA:
             xmlBufferWriteChar(buf, "#PCDATA");
-    break;
-case XML_ELEMENT_CONTENT_ELEMENT:
-    if (content->prefix != NULL) {
-xmlBufferWriteCHAR(buf, content->prefix);
-xmlBufferWriteChar(buf, ":");
-    }
-    xmlBufferWriteCHAR(buf, content->name);
-    break;
-case XML_ELEMENT_CONTENT_SEQ:
-    if ((content->c1->type == XML_ELEMENT_CONTENT_OR) ||
-        (content->c1->type == XML_ELEMENT_CONTENT_SEQ))
-xmlDumpElementContent(buf, content->c1, 1);
-    else
-xmlDumpElementContent(buf, content->c1, 0);
+            break;
+        case XML_ELEMENT_CONTENT_ELEMENT:
+            if (content->prefix != NULL) {
+                xmlBufferWriteCHAR(buf, content->prefix);
+                xmlBufferWriteChar(buf, ":");
+            }
+            xmlBufferWriteCHAR(buf, content->name);
+            break;
+        case XML_ELEMENT_CONTENT_SEQ:
+            if ((content->c1 != NULL) && 
+                ((content->c1->type == XML_ELEMENT_CONTENT_OR) ||
+                 (content->c1->type == XML_ELEMENT_CONTENT_SEQ)))
+                xmlDumpElementContent(buf, content->c1, 1);
+            else
+                xmlDumpElementContent(buf, content->c1, 0);
             xmlBufferWriteChar(buf, " , ");
-    if ((content->c2->type == XML_ELEMENT_CONTENT_OR) ||
-        ((content->c2->type == XML_ELEMENT_CONTENT_SEQ) &&
- (content->c2->ocur != XML_ELEMENT_CONTENT_ONCE)))
-xmlDumpElementContent(buf, content->c2, 1);
-    else
-xmlDumpElementContent(buf, content->c2, 0);
-    break;
-case XML_ELEMENT_CONTENT_OR:
-    if ((content->c1->type == XML_ELEMENT_CONTENT_OR) ||
-        (content->c1->type == XML_ELEMENT_CONTENT_SEQ))
-xmlDumpElementContent(buf, content->c1, 1);
-    else
-xmlDumpElementContent(buf, content->c1, 0);
+            if ((content->c2 != NULL) && 
+                ((content->c2->type == XML_ELEMENT_CONTENT_OR) ||
+                 ((content->c2->type == XML_ELEMENT_CONTENT_SEQ) &&
+                  (content->c2->ocur != XML_ELEMENT_CONTENT_ONCE))))
+                xmlDumpElementContent(buf, content->c2, 1);
+            else
+                xmlDumpElementContent(buf, content->c2, 0);
+            break;
+        case XML_ELEMENT_CONTENT_OR:
+            if ((content->c1 != NULL) && 
+                ((content->c1->type == XML_ELEMENT_CONTENT_OR) ||
+                 (content->c1->type == XML_ELEMENT_CONTENT_SEQ)))
+                xmlDumpElementContent(buf, content->c1, 1);
+            else
+                xmlDumpElementContent(buf, content->c1, 0);
             xmlBufferWriteChar(buf, " | ");
-    if ((content->c2->type == XML_ELEMENT_CONTENT_SEQ) ||
-        ((content->c2->type == XML_ELEMENT_CONTENT_OR) &&
- (content->c2->ocur != XML_ELEMENT_CONTENT_ONCE)))
-xmlDumpElementContent(buf, content->c2, 1);
-    else
-xmlDumpElementContent(buf, content->c2, 0);
-    break;
-default:
-    xmlErrValid(NULL, XML_ERR_INTERNAL_ERROR,
-    "Internal: ELEMENT content corrupted invalid type\n",
-    NULL);
+            if ((content->c2 != NULL) && 
+                ((content->c2->type == XML_ELEMENT_CONTENT_SEQ) ||
+                 ((content->c2->type == XML_ELEMENT_CONTENT_OR) &&
+                  (content->c2->ocur != XML_ELEMENT_CONTENT_ONCE))))
+                xmlDumpElementContent(buf, content->c2, 1);
+            else
+                xmlDumpElementContent(buf, content->c2, 0);
+            break;
+        default:
+            xmlErrValid(NULL, XML_ERR_INTERNAL_ERROR,
+                         "Internal: ELEMENT content corrupted invalid type\n",
+                         NULL);
     }
     if (glob)
         xmlBufferWriteChar(buf, ")");
     switch (content->ocur) {
         case XML_ELEMENT_CONTENT_ONCE:
-    break;
+            break;
         case XML_ELEMENT_CONTENT_OPT:
-    xmlBufferWriteChar(buf, "?");
-    break;
+            xmlBufferWriteChar(buf, "?");
+            break;
         case XML_ELEMENT_CONTENT_MULT:
-    xmlBufferWriteChar(buf, "*");
-    break;
+            xmlBufferWriteChar(buf, "*");
+            break;
         case XML_ELEMENT_CONTENT_PLUS:
-    xmlBufferWriteChar(buf, "+");
-    break;
+            xmlBufferWriteChar(buf, "+");
+            break;
     }
 }
 
+
 /**
  * xmlSprintfElementContent:
  * @buf:  an output buffer

2025-02-02 16:01:25.245 | DEBUG    | scenario:rebuild:369 - original environment: environ({'CONDA_SHLVL': '2', 'LC_ALL': 'C.UTF-8', 'LS_COLORS': 'rs=0:di=01;34:ln=01;36:mh=00:pi=40;33:so=01;35:do=01;35:bd=40;33;01:cd=40;33;01:or=40;31;01:mi=00:su=37;41:sg=30;43:ca=30;41:tw=30;42:ow=34;42:st=37;44:ex=01;32:*.tar=01;31:*.tgz=01;31:*.arc=01;31:*.arj=01;31:*.taz=01;31:*.lha=01;31:*.lz4=01;31:*.lzh=01;31:*.lzma=01;31:*.tlz=01;31:*.txz=01;31:*.tzo=01;31:*.t7z=01;31:*.zip=01;31:*.z=01;31:*.Z=01;31:*.dz=01;31:*.gz=01;31:*.lrz=01;31:*.lz=01;31:*.lzo=01;31:*.xz=01;31:*.zst=01;31:*.tzst=01;31:*.bz2=01;31:*.bz=01;31:*.tbz=01;31:*.tbz2=01;31:*.tz=01;31:*.deb=01;31:*.rpm=01;31:*.jar=01;31:*.war=01;31:*.ear=01;31:*.sar=01;31:*.rar=01;31:*.alz=01;31:*.ace=01;31:*.zoo=01;31:*.cpio=01;31:*.7z=01;31:*.rz=01;31:*.cab=01;31:*.wim=01;31:*.swm=01;31:*.dwm=01;31:*.esd=01;31:*.jpg=01;35:*.jpeg=01;35:*.mjpg=01;35:*.mjpeg=01;35:*.gif=01;35:*.bmp=01;35:*.pbm=01;35:*.pgm=01;35:*.ppm=01;35:*.tga=01;35:*.xbm=01;35:*.xpm=01;35:*.tif=01;35:*.tiff=01;35:*.png=01;35:*.svg=01;35:*.svgz=01;35:*.mng=01;35:*.pcx=01;35:*.mov=01;35:*.mpg=01;35:*.mpeg=01;35:*.m2v=01;35:*.mkv=01;35:*.webm=01;35:*.ogm=01;35:*.mp4=01;35:*.m4v=01;35:*.mp4v=01;35:*.vob=01;35:*.qt=01;35:*.nuv=01;35:*.wmv=01;35:*.asf=01;35:*.rm=01;35:*.rmvb=01;35:*.flc=01;35:*.avi=01;35:*.fli=01;35:*.flv=01;35:*.gl=01;35:*.dl=01;35:*.xcf=01;35:*.xwd=01;35:*.yuv=01;35:*.cgm=01;35:*.emf=01;35:*.ogv=01;35:*.ogx=01;35:*.aac=00;36:*.au=00;36:*.flac=00;36:*.m4a=00;36:*.mid=00;36:*.midi=00;36:*.mka=00;36:*.mp3=00;36:*.mpc=00;36:*.ogg=00;36:*.ra=00;36:*.wav=00;36:*.oga=00;36:*.opus=00;36:*.spx=00;36:*.xspf=00;36:', 'LD_LIBRARY_PATH': '/opt/crashrepair/lib:/CrashRepair/lib:/klee/build/lib:', 'CONDA_EXE': '/root/anaconda3/bin/conda', 'LANG': 'C.UTF-8', 'TZ': 'Asia/Shanghai', 'HOSTNAME': 'fea22102047d', 'OLDPWD': '/orchestrator', 'CONDA_PREFIX': '/root/anaconda3/envs/CrashRepair', '_CE_M': '', 'CC': 'crepair-cc', 'LLVM_COMPILER': 'clang', 'CONDA_PREFIX_1': '/root/anaconda3', 'PWD': '/orchestrator/crashrepair', 'HOME': '/root', 'CONDA_PYTHON_EXE': '/root/anaconda3/bin/python', '_CE_CONDA': '', 'CONDA_PROMPT_MODIFIER': '(CrashRepair) ', 'CXX': 'crepair-cxx', 'TERM': 'xterm', 'SHLVL': '2', 'PYTHONPATH': '/usr/lib/python3.8/site-packages:', 'PATH': '/root/anaconda3/envs/CrashRepair/bin:/root/anaconda3/condabin:~/anaconda3/bin:/opt/crashrepair/bin:/CrashRepair/compiler:/klee/build/bin:/opt/llvm-6/bin:/klee/build/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', 'CONDA_DEFAULT_ENV': 'CrashRepair', '_': '/root/anaconda3/envs/CrashRepair/bin/python'})
2025-02-02 16:01:25.245 | DEBUG    | scenario:rebuild:382 - injecting ghost function into CFLAGS during build: -lcrepair_ghost
2025-02-02 16:01:25.245 | DEBUG    | scenario:rebuild:398 - using environment: {'INJECT_CFLAGS': '-g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address', 'INJECT_CXXFLAGS': '-g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address', 'INJECT_LDFLAGS': '-g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address'}
2025-02-02 16:01:25.245 | DEBUG    | shell:__call__:41 - executing: make CFLAGS="${INJECT_CFLAGS}" CXXFLAGS="${INJECT_CXXFLAGS}" LDFLAGS="${INJECT_LDFLAGS}" xmllint
  CC       valid.lo
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_ghost: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
  CCLD     libxml2.la
ar: `u' modifier ignored since `D' is the default (see `U')
  CCLD     xmllint
2025-02-02 16:01:25.735 | DEBUG    | scenario:evaluate:655 - testing candidate #10 against test #crash...
2025-02-02 16:01:25.736 | DEBUG    | shell:__call__:41 - executing: /data//vulnloc/libxml2/CVE-2017-5969/src/xmllint --recover /CrashRepair/experiments/vulnloc/libxml2/CVE-2017-5969/tests/1.xml
2025-02-02 16:01:25.739 | INFO     | scenario:evaluate:659 - candidate #10 passes test #crash
2025-02-02 16:01:25.740 | INFO     | scenario:evaluate:674 - repair found! candidate #10 passes all tests
2025-02-02 16:01:25.745 | INFO     | scenario:validate:513 - saving successful patch #10...
2025-02-02 16:01:25.745 | INFO     | scenario:validate:520 - stopping search: patch was found

