2025-02-03 21:50:20.338 | INFO     | scenario:build:265 - loaded bug scenario: Scenario(subject='libtiff', name='CVE-2016-5321', directory='/data/vulnloc/libtiff/CVE-2016-5321', build_directory='/data/vulnloc/libtiff/CVE-2016-5321/src', source_directory='/data/vulnloc/libtiff/CVE-2016-5321/src', tag_id='libtiff_CVE-2016-5321', binary_path='/data/vulnloc/libtiff/CVE-2016-5321/src/tools/tiffcrop', clean_command='make clean', prebuild_command='./configure --enable-static --disable-shared', build_command='make CFLAGS="${INJECT_CFLAGS}" CXXFLAGS="${INJECT_CXXFLAGS}" LDFLAGS="${INJECT_LDFLAGS}"', crashing_command='$POC foo.tif', crashing_input='/CrashRepair/experiments/vulnloc/libtiff/CVE-2016-5321/tests/1.tif', shell=Shell(cwd='/data/vulnloc/libtiff/CVE-2016-5321'), crash_test=Test(name='crash', command='/data/vulnloc/libtiff/CVE-2016-5321/src/tools/tiffcrop /CrashRepair/experiments/vulnloc/libtiff/CVE-2016-5321/tests/1.tif foo.tif', expected_exit_code=0, expected_stdout=None, bad_output='AddressSanitizer:', asan_options=None, ubsan_options=None), sanitizer_flags='-fsanitize=address', additional_klee_flags='', expected_exit_code_for_crashing_input=0, should_terminate_early=True, fuzzer_tests=[], fuzzer=None, time_limit_minutes_validation=None, time_limit_seconds_single_test=30, time_limit_minutes_analysis=3600, halt_on_error=True, rebuild_for_validation=False, asan_options=None, ubsan_options=None, use_ghost_functions=True, acceptable_patch_limit=None)
2025-02-03 21:50:20.338 | INFO     | scenario:fuzz:426 - skipping fuzzing: fuzzer disabled
2025-02-03 21:50:20.338 | INFO     | analyzer:run:114 - running analysis with timeout: 60 minutes
2025-02-03 21:50:20.338 | DEBUG    | analyzer:write_config_to_file:88 - generated analyzer config:

dir_exp:/data/vulnloc/libtiff/CVE-2016-5321
tag_id:libtiff_CVE-2016-5321
src_directory:/data/vulnloc/libtiff/CVE-2016-5321/src
binary_path:/data/vulnloc/libtiff/CVE-2016-5321/src/tools/tiffcrop
config_command:./configure --enable-static --disable-shared
build_command:make CFLAGS="${INJECT_CFLAGS}" CXXFLAGS="${INJECT_CXXFLAGS}" LDFLAGS="${INJECT_LDFLAGS}"
test_input_list:$POC foo.tif
poc_list:/CrashRepair/experiments/vulnloc/libtiff/CVE-2016-5321/tests/1.tif
klee_flags:--link-llvm-lib=/CrashRepair/lib/libcrepair_proxy.bca 

2025-02-03 21:50:20.338 | DEBUG    | analyzer:run:124 - wrote analyzer config file to: /tmp/tmpwfv_80aq
2025-02-03 21:50:20.338 | DEBUG    | shell:__call__:41 - executing: crepair --conf=/tmp/tmpwfv_80aq
[K[1;36m
====================================================================================================

	Starting CRepair (C Crash Repair) 
====================================================================================================
[0m
[K[1;36m
	Loading Configurations
	__________________________________________________________________________________________
[0m
[K	[1;34mreading configuration values from arguments[0m
[K	[1;34mreading configuration values form configuration file[0m
[K	[1;37m	[file] /tmp/tmpwfv_80aq[0m
[K	[1;34mupdating configuration values[0m
[K	[1;34mreading test configuration[0m
[K	[1;34mreading seed information[0m
[K	[1;37m	[config] stack size: 15000[0m
[K	[1;37m	[config] collecting stats: False[0m
[K	[1;37m	[config] number of tests: 1[0m
[K	[1;37m	[config] number of cores: 8[0m
[K	[1;37m	[config] klee concrete execution timeout: 600[0m
[K	[1;37m	[config] klee concolic execution timeout: 1200[0m
[K	[1;37m	[config] synthesize subset expressions: True[0m
[K	[1;37m	[config] window size for taint locations: 500[0m
[K	[1;37m	[config] window size for taint values: 500000[0m
[K[1;36m

	Analyzing Program
====================================================================================================
[0m
[K[1;36m
	Test Case #1
	__________________________________________________________________________________________
[0m
[K[1;36m
		Running Concrete Execution
		------------------------------------------------------------------------------------------
[0m
[K	[1;37m	[0m[K     [1;37mUsing Arguments: ['$POC', 'foo.tif'][0m
[K	[1;37m	[0m[K     [1;37mUsing Input File: /CrashRepair/experiments/vulnloc/libtiff/CVE-2016-5321/tests/1.tif[0m
[K	[1;34m	building program[0m
[K	[1;34m		setting environment variables[0m
[K	[1;34m		cleaning files[0m
[K	[1;34m		configuring program[0m
[K	[1;34m		compiling program[0m
[K	[1;37m	[0m[K     [1;37mUsing Binary: /data/vulnloc/libtiff/CVE-2016-5321/src/tools/tiffcrop[0m
[K	[1;34m	extracting bytecode[0m
[K	[1;34m	executing klee in concrete mode[0m
[K	[1;34m	extracting instruction trace[0m
[K	[1;37m		[note] program crashed[0m
[K	[1;34m	collecting tainted expressions[0m
[K	[1;34m	collecting tainted concrete values[0m
[K	[1;34m	collecting memory allocations/de-allocations[0m
[K	[1;34m	collecting pointer mapping[0m
[K	[1;34m	extracting crash information[0m
[K	[1;37m		[0m[K     [1;37m[info] crash type: memory read overflow[0m
[K	[1;37m		[0m[K     [1;37m[info] crash location:
                             /data/vulnloc/libtiff/CVE-2016-5321/src/tools/tiffcrop.c:994:28[0m
[K	[1;37m		[0m[K     [1;37m[info] crash function: readSeparateTilesIntoBuffer[0m
[K	[1;37m		[0m[K     [1;37m[info] crash address: 116502[0m
[K	[1;37m		[0m[K     [1;37m[info] crash free constraint: ((8 * @var(integer, s)) < 64)[0m
[K	[1;37m		[0m[K     [1;37m[info] crash inducing variables: s[0m
[K	[1;37m			[info] identified crash type: memory read overflow[0m
[K[1;36m
		Running Concolic Execution
		------------------------------------------------------------------------------------------
[0m
[K	[1;37m	[0m[K     [1;37mUsing Arguments: ['$POC', 'foo.tif'][0m
[K	[1;37m	[0m[K     [1;37mUsing Input File: /CrashRepair/experiments/vulnloc/libtiff/CVE-2016-5321/tests/1.tif[0m
[K	[1;34m	building program[0m
[K	[1;34m		setting environment variables[0m
[K	[1;34m		cleaning files[0m
[K	[1;34m		configuring program[0m
[K	[1;34m		compiling program[0m
[K	[1;34m	extracting bytecode[0m
[K	[1;34m	generating ktest file[0m
[K	[1;34m	executing klee in concolic mode[0m
[K	[1;34m	extracting largest symbolic path[0m
[K	[1;34m	extracting instruction trace[0m
[K	[1;37m		[note] program crashed[0m
[K	[1;34m	collecting tainted expressions[0m
[K	[1;34m	collecting memory allocations/de-allocations[0m
[K	[1;34m	collecting pointer mapping[0m
[K	[1;37m		[0m[K     [1;37m[info] Symbolic Mapping: s -> [][0m
[K[1;36m

	Fix Localization
====================================================================================================
[0m
[K[1;36m
	Generating Fix Locations
	__________________________________________________________________________________________
[0m
[K	[1;34m	generating taint map[0m
[K	[1;37m		[0m[K     [1;37m[info] found 10854 tainted locations[0m
[K	[1;34m		starting parallel computing[0m
[K	[1;34m		waiting for thread completion[0m
[K	[1;37m		[0m[K     [1;37m[info] found 5 source files[0m
[K	[1;37m		[0m[K     [1;37m[info] found 12 executed functions[0m
[K	[1;34m	generating possible fix locations[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] readSeparateTilesIntoBuffer,
                             /data/vulnloc/libtiff/CVE-2016-5321/src/tools/tiffcrop.c:992:29[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] readSeparateTilesIntoBuffer,
                             /data/vulnloc/libtiff/CVE-2016-5321/src/tools/tiffcrop.c:995:20[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] readSeparateTilesIntoBuffer,
                             /data/vulnloc/libtiff/CVE-2016-5321/src/tools/tiffcrop.c:995:13[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] readSeparateTilesIntoBuffer,
                             /data/vulnloc/libtiff/CVE-2016-5321/src/tools/tiffcrop.c:994:9[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] readSeparateTilesIntoBuffer,
                             /data/vulnloc/libtiff/CVE-2016-5321/src/tools/tiffcrop.c:994:11[0m
[K[1;36m
	Localizing Constraints
	__________________________________________________________________________________________
[0m
[K[1;36m
		[fix-loc] /data/vulnloc/libtiff/CVE-2016-5321/src/tools/tiffcrop.c:992:7
		------------------------------------------------------------------------------------------
[0m
[K	[1;37m	[0m[K     [1;37m[constraint] ((8 * @var(integer, s)) < 64)[0m
[K[1;36m
		[fix-loc] /data/vulnloc/libtiff/CVE-2016-5321/src/tools/tiffcrop.c:994:11
		------------------------------------------------------------------------------------------
[0m
[K	[1;37m	[0m[K     [1;37m[constraint] ((8 * @var(integer, s)) < 64)[0m
[K[1;36m
		[fix-loc] /data/vulnloc/libtiff/CVE-2016-5321/src/tools/tiffcrop.c:995:9
		------------------------------------------------------------------------------------------
[0m
[K	[1;37m	[0m[K     [1;37m[constraint] ((8 * @var(integer, s)) < 64)[0m
[K[1;36m
		[fix-loc] /data/vulnloc/libtiff/CVE-2016-5321/src/tools/tiffcrop.c:994:2
		------------------------------------------------------------------------------------------
[0m
[K	[1;37m	[0m[K     [1;37m[constraint] ((8 * @var(integer, s)) < 64)[0m
[K[1;32m
	localization information saved at /CrashRepair/output/libtiff_CVE-2016-5321/localization.json[0m
[K[1;32m
	state values saved at /CrashRepair/output/libtiff_CVE-2016-5321/values/[0m
[K	[1;37m
Run time statistics:
-----------------------
[0m
[K	[1;37mStartup: 0.000 minutes[0m
[K	[1;37mBuild: 0 minutes[0m
[K	[1;37mConcrete Analysis: 0.999 minutes[0m
[K	[1;37mConcolic Analysis: 0.589 minutes[0m
[K	[1;37mTotal Analysis: 1.620 minutes[0m
[K	[1;37mLocalization: 0.270 minutes[0m
[K[1;32m
CRepair finished successfully after 1.928 minutes 
[0m
2025-02-03 21:52:17.027 | WARNING  | analyzer:run:143 - analysis output directory does not exist [/data/vulnloc/libtiff/CVE-2016-5321/analysis]: creating...
2025-02-03 21:52:17.139 | INFO     | scenario:generate:454 - generating candidate repairs in implicated files: {'/data/vulnloc/libtiff/CVE-2016-5321/src/tools/tiffcrop.c'}
total_candidates:[{'diff': '@@ -948,152 +948,159 @@\n   return status;\n   }\n \n-static int  readSeparateTilesIntoBuffer (TIFF* in, uint8 *obuf, \n-\t\t\t\t\t uint32 imagelength, uint32 imagewidth, \n-                                         uint32 tw, uint32 tl,\n-                                         uint16 spp, uint16 bps)\n-  {\n-  int     i, status = 1, sample;\n-  int     shift_width, bytes_per_pixel;\n-  uint16  bytes_per_sample;\n-  uint32  row, col;     /* Current row and col of image */\n-  uint32  nrow, ncol;   /* Number of rows and cols in current tile */\n-  uint32  row_offset, col_offset; /* Output buffer offsets */\n-  tsize_t tbytes = 0, tilesize = TIFFTileSize(in);\n-  tsample_t s;\n-  uint8*  bufp = (uint8*)obuf;\n-  unsigned char *srcbuffs[MAX_SAMPLES];\n-  unsigned char *tbuff = NULL;\n \n-  bytes_per_sample = (bps + 7) / 8;\n+static int readSeparateTilesIntoBuffer(TIFF* in, uint8 *obuf, \n+                                       uint32 imagelength, uint32 imagewidth, \n+                                       uint32 tw, uint32 tl,\n+                                       uint16 spp, uint16 bps)\n+{\n+    int i, status = 1, sample;\n+    int shift_width, bytes_per_pixel;\n+    uint16 bytes_per_sample;\n+    uint32 row, col;     /* Current row and col of image */\n+    uint32 nrow, ncol;   /* Number of rows and cols in current tile */\n+    uint32 row_offset, col_offset; /* Output buffer offsets */\n+    tsize_t tbytes = 0, tilesize = TIFFTileSize(in);\n+    tsample_t s;\n+    uint8* bufp = (uint8*)obuf;\n+    unsigned char *srcbuffs[MAX_SAMPLES];\n+    unsigned char *tbuff = NULL;\n+\n+    bytes_per_sample = (bps + 7) / 8;\n+\n+    if (spp > MAX_SAMPLES) {\n+        TIFFError("readSeparateTilesIntoBuffer", "Sample per pixel exceeds max samples");\n+        return 0;\n+    }\n \n-  for (sample = 0; (sample < spp) && (sample < MAX_SAMPLES); sample++)\n+    for (sample = 0; (sample < spp) && (sample < MAX_SAMPLES); sample++)\n     {\n-    srcbuffs[sample] = NULL;\n-    tbuff = (unsigned char *)_TIFFmalloc(tilesize + 8);\n-    if (!tbuff)\n-      {\n-      TIFFError ("readSeparateTilesIntoBuffer", \n-                 "Unable to allocate tile read buffer for sample %d", sample);\n-      for (i = 0; i < sample; i++)\n-        _TIFFfree (srcbuffs[i]);\n-      return 0;\n-      }\n-    srcbuffs[sample] = tbuff;\n+        srcbuffs[sample] = NULL;\n+        tbuff = (unsigned char *)_TIFFmalloc(tilesize + 8);\n+        if (!tbuff)\n+        {\n+            TIFFError("readSeparateTilesIntoBuffer", \n+                       "Unable to allocate tile read buffer for sample %d", sample);\n+            for (i = 0; i < sample; i++)\n+                _TIFFfree(srcbuffs[i]);\n+            return 0;\n+        }\n+        srcbuffs[sample] = tbuff;\n     } \n-  /* Each tile contains only the data for a single plane\n-   * arranged in scanlines of tw * bytes_per_sample bytes.\n-   */\n-  for (row = 0; row < imagelength; row += tl)\n+    /* Each tile contains only the data for a single plane\n+     * arranged in scanlines of tw * bytes_per_sample bytes.\n+     */\n+    for (row = 0; row < imagelength; row += tl)\n     {\n-    nrow = (row + tl > imagelength) ? imagelength - row : tl;\n-    for (col = 0; col < imagewidth; col += tw)\n-      {\n-      for (s = 0; s < spp; s++)\n-        {  /* Read each plane of a tile set into srcbuffs[s] */\n-\ttbytes = TIFFReadTile(in, srcbuffs[s], col, row, 0, s);\n-        if (tbytes < 0  && !ignore)\n-          {\n-\t  TIFFError(TIFFFileName(in),\n-                 "Error, can\'t read tile for row %lu col %lu, "\n-\t\t "sample %lu",\n-\t\t (unsigned long) col, (unsigned long) row,\n-\t\t (unsigned long) s);\n-\t\t status = 0;\n-          for (sample = 0; (sample < spp) && (sample < MAX_SAMPLES); sample++)\n-            {\n-            tbuff = srcbuffs[sample];\n-            if (tbuff != NULL)\n-              _TIFFfree(tbuff);\n-            }\n-          return status;\n-\t  }\n-\t}\n-     /* Tiles on the right edge may be padded out to tw \n-      * which must be a multiple of 16.\n-      * Ncol represents the visible (non padding) portion.  \n-      */\n-      if (col + tw > imagewidth)\n-        ncol = imagewidth - col;\n-      else\n-        ncol = tw;\n-\n-      row_offset = row * (((imagewidth * spp * bps) + 7) / 8);\n-      col_offset = ((col * spp * bps) + 7) / 8;\n-      bufp = obuf + row_offset + col_offset;\n-\n-      if ((bps % 8) == 0)\n-        {\n-        if (combineSeparateTileSamplesBytes(srcbuffs, bufp, ncol, nrow, imagewidth,\n-\t\t\t\t\t    tw, spp, bps, NULL, 0, 0))\n-\t  {\n-          status = 0;\n-          break;\n-      \t  }\n-\t}\n-      else\n+        nrow = (row + tl > imagelength) ? imagelength - row : tl;\n+        for (col = 0; col < imagewidth; col += tw)\n         {\n-        bytes_per_pixel  = ((bps * spp) + 7) / 8;\n-        if (bytes_per_pixel < (bytes_per_sample + 1))\n-          shift_width = bytes_per_pixel;\n-        else\n-          shift_width = bytes_per_sample + 1;\n-\n-        switch (shift_width)\n-          {\n-          case 1: if (combineSeparateTileSamples8bits (srcbuffs, bufp, ncol, nrow,\n-                                                       imagewidth, tw, spp, bps, \n-\t\t\t\t\t\t       NULL, 0, 0))\n-\t            {\n-                    status = 0;\n-                    break;\n-      \t            }\n-\t          break;\n-          case 2: if (combineSeparateTileSamples16bits (srcbuffs, bufp, ncol, nrow,\n-                                                       imagewidth, tw, spp, bps, \n-\t\t\t\t\t\t       NULL, 0, 0))\n-\t            {\n-                    status = 0;\n-                    break;\n-\t\t    }\n-\t          break;\n-          case 3: if (combineSeparateTileSamples24bits (srcbuffs, bufp, ncol, nrow,\n-                                                       imagewidth, tw, spp, bps, \n-\t\t\t\t\t\t       NULL, 0, 0))\n-\t            {\n+            for (s = 0; s < spp && s < MAX_SAMPLES; s++)\n+            {  /* Read each plane of a tile set into srcbuffs[s] */\n+                tbytes = TIFFReadTile(in, srcbuffs[s], col, row, 0, s);\n+                if (tbytes < 0  && !ignore)\n+                {\n+                    TIFFError(TIFFFileName(in),\n+                               "Error, can\'t read tile for row %lu col %lu, "\n+                               "sample %lu",\n+                               (unsigned long)col, (unsigned long)row,\n+                               (unsigned long)s);\n                     status = 0;\n-                    break;\n-       \t            }\n-                  break;\n-          case 4: \n-          case 5:\n-          case 6:\n-          case 7:\n-          case 8: if (combineSeparateTileSamples32bits (srcbuffs, bufp, ncol, nrow,\n-                                                       imagewidth, tw, spp, bps, \n-\t\t\t\t\t\t       NULL, 0, 0))\n-\t            {\n+                    for (sample = 0; (sample < spp) && (sample < MAX_SAMPLES); sample++)\n+                    {\n+                        tbuff = srcbuffs[sample];\n+                        if (tbuff != NULL)\n+                            _TIFFfree(tbuff);\n+                    }\n+                    return status;\n+                }\n+            }\n+            /* Tiles on the right edge may be padded out to tw \n+             * which must be a multiple of 16.\n+             * Ncol represents the visible (non padding) portion.  \n+             */\n+            if (col + tw > imagewidth)\n+                ncol = imagewidth - col;\n+            else\n+                ncol = tw;\n+\n+            row_offset = row * (((imagewidth * spp * bps) + 7) / 8);\n+            col_offset = ((col * spp * bps) + 7) / 8;\n+            bufp = obuf + row_offset + col_offset;\n+\n+            if ((bps % 8) == 0)\n+            {\n+                if (combineSeparateTileSamplesBytes(srcbuffs, bufp, ncol, nrow, imagewidth,\n+                                                     tw, spp, bps, NULL, 0, 0))\n+                {\n                     status = 0;\n                     break;\n-\t\t    }\n-\t          break;\n-          default: TIFFError ("readSeparateTilesIntoBuffer", "Unsupported bit depth: %d", bps);\n-                  status = 0;\n-                  break;\n-          }\n+                }\n+            }\n+            else\n+            {\n+                bytes_per_pixel  = ((bps * spp) + 7) / 8;\n+                if (bytes_per_pixel < (bytes_per_sample + 1))\n+                    shift_width = bytes_per_pixel;\n+                else\n+                    shift_width = bytes_per_sample + 1;\n+\n+                switch (shift_width)\n+                {\n+                    case 1: if (combineSeparateTileSamples8bits(srcbuffs, bufp, ncol, nrow,\n+                                                                imagewidth, tw, spp, bps, \n+                                                                NULL, 0, 0))\n+                            {\n+                                status = 0;\n+                                break;\n+                            }\n+                            break;\n+                    case 2: if (combineSeparateTileSamples16bits(srcbuffs, bufp, ncol, nrow,\n+                                                                  imagewidth, tw, spp, bps, \n+                                                                  NULL, 0, 0))\n+                            {\n+                                status = 0;\n+                                break;\n+                            }\n+                            break;\n+                    case 3: if (combineSeparateTileSamples24bits(srcbuffs, bufp, ncol, nrow,\n+                                                                  imagewidth, tw, spp, bps, \n+                                                                  NULL, 0, 0))\n+                            {\n+                                status = 0;\n+                                break;\n+                            }\n+                            break;\n+                    case 4: \n+                    case 5:\n+                    case 6:\n+                    case 7:\n+                    case 8: if (combineSeparateTileSamples32bits(srcbuffs, bufp, ncol, nrow,\n+                                                                  imagewidth, tw, spp, bps, \n+                                                                  NULL, 0, 0))\n+                            {\n+                                status = 0;\n+                                break;\n+                            }\n+                            break;\n+                    default: TIFFError("readSeparateTilesIntoBuffer", "Unsupported bit depth: %d", bps);\n+                             status = 0;\n+                             break;\n+                }\n+            }\n         }\n-      }\n     }\n \n-  for (sample = 0; (sample < spp) && (sample < MAX_SAMPLES); sample++)\n+    for (sample = 0; (sample < spp) && (sample < MAX_SAMPLES); sample++)\n     {\n-    tbuff = srcbuffs[sample];\n-    if (tbuff != NULL)\n-      _TIFFfree(tbuff);\n+        tbuff = srcbuffs[sample];\n+        if (tbuff != NULL)\n+            _TIFFfree(tbuff);\n     }\n- \n-  return status;\n-  }\n+\n+    return status;\n+}\n+\n \n static int writeBufferToContigStrips(TIFF* out, uint8* buf, uint32 imagelength)\n   {\n', 'id': 0, 'location': '/data/vulnloc/libtiff/CVE-2016-5321/src/tools/tiffcrop.c:992:7'}, {'diff': '@@ -948,152 +948,163 @@\n   return status;\n   }\n \n-static int  readSeparateTilesIntoBuffer (TIFF* in, uint8 *obuf, \n-\t\t\t\t\t uint32 imagelength, uint32 imagewidth, \n+\n+static int readSeparateTilesIntoBuffer (TIFF* in, uint8 *obuf, \n+                                         uint32 imagelength, uint32 imagewidth, \n                                          uint32 tw, uint32 tl,\n                                          uint16 spp, uint16 bps)\n-  {\n-  int     i, status = 1, sample;\n-  int     shift_width, bytes_per_pixel;\n-  uint16  bytes_per_sample;\n-  uint32  row, col;     /* Current row and col of image */\n-  uint32  nrow, ncol;   /* Number of rows and cols in current tile */\n-  uint32  row_offset, col_offset; /* Output buffer offsets */\n-  tsize_t tbytes = 0, tilesize = TIFFTileSize(in);\n-  tsample_t s;\n-  uint8*  bufp = (uint8*)obuf;\n-  unsigned char *srcbuffs[MAX_SAMPLES];\n-  unsigned char *tbuff = NULL;\n-\n-  bytes_per_sample = (bps + 7) / 8;\n+{\n+    int i, status = 1, sample;\n+    int shift_width, bytes_per_pixel;\n+    uint16 bytes_per_sample;\n+    uint32 row, col;     /* Current row and col of image */\n+    uint32 nrow, ncol;   /* Number of rows and cols in current tile */\n+    uint32 row_offset, col_offset; /* Output buffer offsets */\n+    tsize_t tbytes = 0, tilesize = TIFFTileSize(in);\n+    tsample_t s;\n+    uint8* bufp = (uint8*)obuf;\n+    unsigned char *srcbuffs[MAX_SAMPLES];\n+    unsigned char *tbuff = NULL;\n+\n+    bytes_per_sample = (bps + 7) / 8;\n+\n+    if (spp > MAX_SAMPLES) {\n+        TIFFError("readSeparateTilesIntoBuffer", "Number of Samples exceeds MAX_SAMPLES");\n+        return 0;\n+    }\n \n-  for (sample = 0; (sample < spp) && (sample < MAX_SAMPLES); sample++)\n+    for (sample = 0; (sample < spp) && (sample < MAX_SAMPLES); sample++)\n     {\n-    srcbuffs[sample] = NULL;\n-    tbuff = (unsigned char *)_TIFFmalloc(tilesize + 8);\n-    if (!tbuff)\n-      {\n-      TIFFError ("readSeparateTilesIntoBuffer", \n-                 "Unable to allocate tile read buffer for sample %d", sample);\n-      for (i = 0; i < sample; i++)\n-        _TIFFfree (srcbuffs[i]);\n-      return 0;\n-      }\n-    srcbuffs[sample] = tbuff;\n+        srcbuffs[sample] = NULL;\n+        tbuff = (unsigned char *)_TIFFmalloc(tilesize + 8);\n+        if (!tbuff)\n+        {\n+            TIFFError("readSeparateTilesIntoBuffer", \n+                       "Unable to allocate tile read buffer for sample %d", sample);\n+            for (i = 0; i < sample; i++)\n+                _TIFFfree(srcbuffs[i]);\n+            return 0;\n+        }\n+        srcbuffs[sample] = tbuff;\n     } \n-  /* Each tile contains only the data for a single plane\n-   * arranged in scanlines of tw * bytes_per_sample bytes.\n-   */\n-  for (row = 0; row < imagelength; row += tl)\n+    /* Each tile contains only the data for a single plane\n+     * arranged in scanlines of tw * bytes_per_sample bytes.\n+     */\n+    for (row = 0; row < imagelength; row += tl)\n     {\n-    nrow = (row + tl > imagelength) ? imagelength - row : tl;\n-    for (col = 0; col < imagewidth; col += tw)\n-      {\n-      for (s = 0; s < spp; s++)\n-        {  /* Read each plane of a tile set into srcbuffs[s] */\n-\ttbytes = TIFFReadTile(in, srcbuffs[s], col, row, 0, s);\n-        if (tbytes < 0  && !ignore)\n-          {\n-\t  TIFFError(TIFFFileName(in),\n-                 "Error, can\'t read tile for row %lu col %lu, "\n-\t\t "sample %lu",\n-\t\t (unsigned long) col, (unsigned long) row,\n-\t\t (unsigned long) s);\n-\t\t status = 0;\n-          for (sample = 0; (sample < spp) && (sample < MAX_SAMPLES); sample++)\n-            {\n-            tbuff = srcbuffs[sample];\n-            if (tbuff != NULL)\n-              _TIFFfree(tbuff);\n+        nrow = (row + tl > imagelength) ? imagelength - row : tl;\n+        for (col = 0; col < imagewidth; col += tw)\n+        {\n+            if (spp > MAX_SAMPLES) {\n+                TIFFError("readSeparateTilesIntoBuffer", "Number of Samples exceeds MAX_SAMPLES");\n+                return 0;\n+            }\n+            for (s = 0; s < spp; s++)\n+            {  /* Read each plane of a tile set into srcbuffs[s] */\n+                tbytes = TIFFReadTile(in, srcbuffs[s], col, row, 0, s);\n+                if (tbytes < 0  && !ignore)\n+                {\n+                    TIFFError(TIFFFileName(in),\n+                              "Error, can\'t read tile for row %lu col %lu, "\n+                              "sample %lu",\n+                              (unsigned long) col, (unsigned long) row,\n+                              (unsigned long) s);\n+                    status = 0;\n+                    for (sample = 0; (sample < spp) && (sample < MAX_SAMPLES); sample++)\n+                    {\n+                        tbuff = srcbuffs[sample];\n+                        if (tbuff != NULL)\n+                            _TIFFfree(tbuff);\n+                    }\n+                    return status;\n+                }\n             }\n-          return status;\n-\t  }\n-\t}\n-     /* Tiles on the right edge may be padded out to tw \n-      * which must be a multiple of 16.\n-      * Ncol represents the visible (non padding) portion.  \n-      */\n-      if (col + tw > imagewidth)\n-        ncol = imagewidth - col;\n-      else\n-        ncol = tw;\n-\n-      row_offset = row * (((imagewidth * spp * bps) + 7) / 8);\n-      col_offset = ((col * spp * bps) + 7) / 8;\n-      bufp = obuf + row_offset + col_offset;\n+            /* Tiles on the right edge may be padded out to tw \n+             * which must be a multiple of 16.\n+             * Ncol represents the visible (non padding) portion.  \n+             */\n+            if (col + tw > imagewidth)\n+                ncol = imagewidth - col;\n+            else\n+                ncol = tw;\n+\n+            row_offset = row * (((imagewidth * spp * bps) + 7) / 8);\n+            col_offset = ((col * spp * bps) + 7) / 8;\n+            bufp = obuf + row_offset + col_offset;\n \n-      if ((bps % 8) == 0)\n-        {\n-        if (combineSeparateTileSamplesBytes(srcbuffs, bufp, ncol, nrow, imagewidth,\n-\t\t\t\t\t    tw, spp, bps, NULL, 0, 0))\n-\t  {\n-          status = 0;\n-          break;\n-      \t  }\n-\t}\n-      else\n-        {\n-        bytes_per_pixel  = ((bps * spp) + 7) / 8;\n-        if (bytes_per_pixel < (bytes_per_sample + 1))\n-          shift_width = bytes_per_pixel;\n-        else\n-          shift_width = bytes_per_sample + 1;\n-\n-        switch (shift_width)\n-          {\n-          case 1: if (combineSeparateTileSamples8bits (srcbuffs, bufp, ncol, nrow,\n-                                                       imagewidth, tw, spp, bps, \n-\t\t\t\t\t\t       NULL, 0, 0))\n-\t            {\n+            if ((bps % 8) == 0)\n+            {\n+                if (combineSeparateTileSamplesBytes(srcbuffs, bufp, ncol, nrow, imagewidth,\n+                                                     tw, spp, bps, NULL, 0, 0))\n+                {\n                     status = 0;\n                     break;\n-      \t            }\n-\t          break;\n-          case 2: if (combineSeparateTileSamples16bits (srcbuffs, bufp, ncol, nrow,\n-                                                       imagewidth, tw, spp, bps, \n-\t\t\t\t\t\t       NULL, 0, 0))\n-\t            {\n-                    status = 0;\n+                }\n+            }\n+            else\n+            {\n+                bytes_per_pixel  = ((bps * spp) + 7) / 8;\n+                if (bytes_per_pixel < (bytes_per_sample + 1))\n+                    shift_width = bytes_per_pixel;\n+                else\n+                    shift_width = bytes_per_sample + 1;\n+\n+                switch (shift_width)\n+                {\n+                case 1: if (combineSeparateTileSamples8bits(srcbuffs, bufp, ncol, nrow,\n+                                                             imagewidth, tw, spp, bps, \n+                                                             NULL, 0, 0))\n+                    {\n+                        status = 0;\n+                        break;\n+                    }\n                     break;\n-\t\t    }\n-\t          break;\n-          case 3: if (combineSeparateTileSamples24bits (srcbuffs, bufp, ncol, nrow,\n-                                                       imagewidth, tw, spp, bps, \n-\t\t\t\t\t\t       NULL, 0, 0))\n-\t            {\n-                    status = 0;\n+                case 2: if (combineSeparateTileSamples16bits(srcbuffs, bufp, ncol, nrow,\n+                                                             imagewidth, tw, spp, bps, \n+                                                             NULL, 0, 0))\n+                    {\n+                        status = 0;\n+                        break;\n+                    }\n+                    break;\n+                case 3: if (combineSeparateTileSamples24bits(srcbuffs, bufp, ncol, nrow,\n+                                                             imagewidth, tw, spp, bps, \n+                                                             NULL, 0, 0))\n+                    {\n+                        status = 0;\n+                        break;\n+                    }\n                     break;\n-       \t            }\n-                  break;\n-          case 4: \n-          case 5:\n-          case 6:\n-          case 7:\n-          case 8: if (combineSeparateTileSamples32bits (srcbuffs, bufp, ncol, nrow,\n-                                                       imagewidth, tw, spp, bps, \n-\t\t\t\t\t\t       NULL, 0, 0))\n-\t            {\n+                case 4: \n+                case 5:\n+                case 6:\n+                case 7:\n+                case 8: if (combineSeparateTileSamples32bits(srcbuffs, bufp, ncol, nrow,\n+                                                             imagewidth, tw, spp, bps, \n+                                                             NULL, 0, 0))\n+                    {\n+                        status = 0;\n+                        break;\n+                    }\n+                    break;\n+                default: TIFFError("readSeparateTilesIntoBuffer", "Unsupported bit depth: %d", bps);\n                     status = 0;\n                     break;\n-\t\t    }\n-\t          break;\n-          default: TIFFError ("readSeparateTilesIntoBuffer", "Unsupported bit depth: %d", bps);\n-                  status = 0;\n-                  break;\n-          }\n+                }\n+            }\n         }\n-      }\n     }\n \n-  for (sample = 0; (sample < spp) && (sample < MAX_SAMPLES); sample++)\n+    for (sample = 0; (sample < spp) && (sample < MAX_SAMPLES); sample++)\n     {\n-    tbuff = srcbuffs[sample];\n-    if (tbuff != NULL)\n-      _TIFFfree(tbuff);\n+        tbuff = srcbuffs[sample];\n+        if (tbuff != NULL)\n+            _TIFFfree(tbuff);\n     }\n- \n-  return status;\n-  }\n+\n+    return status;\n+}\n+\n \n static int writeBufferToContigStrips(TIFF* out, uint8* buf, uint32 imagelength)\n   {\n', 'id': 1, 'location': '/data/vulnloc/libtiff/CVE-2016-5321/src/tools/tiffcrop.c:992:7'}, {'diff': '@@ -948,152 +948,164 @@\n   return status;\n   }\n \n-static int  readSeparateTilesIntoBuffer (TIFF* in, uint8 *obuf, \n+\n+static int readSeparateTilesIntoBuffer (TIFF* in, uint8 *obuf, \n \t\t\t\t\t uint32 imagelength, uint32 imagewidth, \n                                          uint32 tw, uint32 tl,\n                                          uint16 spp, uint16 bps)\n-  {\n-  int     i, status = 1, sample;\n-  int     shift_width, bytes_per_pixel;\n-  uint16  bytes_per_sample;\n-  uint32  row, col;     /* Current row and col of image */\n-  uint32  nrow, ncol;   /* Number of rows and cols in current tile */\n-  uint32  row_offset, col_offset; /* Output buffer offsets */\n-  tsize_t tbytes = 0, tilesize = TIFFTileSize(in);\n-  tsample_t s;\n-  uint8*  bufp = (uint8*)obuf;\n-  unsigned char *srcbuffs[MAX_SAMPLES];\n-  unsigned char *tbuff = NULL;\n-\n-  bytes_per_sample = (bps + 7) / 8;\n+{\n+    int     i, status = 1, sample;\n+    int     shift_width, bytes_per_pixel;\n+    uint16  bytes_per_sample;\n+    uint32  row, col;     /* Current row and col of image */\n+    uint32  nrow, ncol;   /* Number of rows and cols in current tile */\n+    uint32  row_offset, col_offset; /* Output buffer offsets */\n+    tsize_t tbytes = 0, tilesize = TIFFTileSize(in);\n+    tsample_t s;\n+    uint8*  bufp = (uint8*)obuf;\n+    unsigned char *srcbuffs[MAX_SAMPLES];\n+    unsigned char *tbuff = NULL;\n+\n+    bytes_per_sample = (bps + 7) / 8;\n+\n+    if(spp > MAX_SAMPLES) {\n+        TIFFError("readSeparateTilesIntoBuffer", "Samples per pixel (%d) exceeds maximum (%d)", spp, MAX_SAMPLES);\n+        return 0;\n+    }\n \n-  for (sample = 0; (sample < spp) && (sample < MAX_SAMPLES); sample++)\n+    for (sample = 0; (sample < spp); sample++)\n     {\n-    srcbuffs[sample] = NULL;\n-    tbuff = (unsigned char *)_TIFFmalloc(tilesize + 8);\n-    if (!tbuff)\n-      {\n-      TIFFError ("readSeparateTilesIntoBuffer", \n-                 "Unable to allocate tile read buffer for sample %d", sample);\n-      for (i = 0; i < sample; i++)\n-        _TIFFfree (srcbuffs[i]);\n-      return 0;\n-      }\n-    srcbuffs[sample] = tbuff;\n+        srcbuffs[sample] = NULL;\n+        tbuff = (unsigned char *)_TIFFmalloc(tilesize + 8);\n+        if (!tbuff)\n+        {\n+            TIFFError ("readSeparateTilesIntoBuffer", \n+                       "Unable to allocate tile read buffer for sample %d", sample);\n+            for (i = 0; i < sample; i++)\n+                _TIFFfree (srcbuffs[i]);\n+            return 0;\n+        }\n+        srcbuffs[sample] = tbuff;\n     } \n-  /* Each tile contains only the data for a single plane\n-   * arranged in scanlines of tw * bytes_per_sample bytes.\n-   */\n-  for (row = 0; row < imagelength; row += tl)\n+    /* Each tile contains only the data for a single plane\n+     * arranged in scanlines of tw * bytes_per_sample bytes.\n+     */\n+    for (row = 0; row < imagelength; row += tl)\n     {\n-    nrow = (row + tl > imagelength) ? imagelength - row : tl;\n-    for (col = 0; col < imagewidth; col += tw)\n-      {\n-      for (s = 0; s < spp; s++)\n-        {  /* Read each plane of a tile set into srcbuffs[s] */\n-\ttbytes = TIFFReadTile(in, srcbuffs[s], col, row, 0, s);\n-        if (tbytes < 0  && !ignore)\n-          {\n-\t  TIFFError(TIFFFileName(in),\n-                 "Error, can\'t read tile for row %lu col %lu, "\n-\t\t "sample %lu",\n-\t\t (unsigned long) col, (unsigned long) row,\n-\t\t (unsigned long) s);\n-\t\t status = 0;\n-          for (sample = 0; (sample < spp) && (sample < MAX_SAMPLES); sample++)\n-            {\n-            tbuff = srcbuffs[sample];\n-            if (tbuff != NULL)\n-              _TIFFfree(tbuff);\n-            }\n-          return status;\n-\t  }\n-\t}\n-     /* Tiles on the right edge may be padded out to tw \n-      * which must be a multiple of 16.\n-      * Ncol represents the visible (non padding) portion.  \n-      */\n-      if (col + tw > imagewidth)\n-        ncol = imagewidth - col;\n-      else\n-        ncol = tw;\n-\n-      row_offset = row * (((imagewidth * spp * bps) + 7) / 8);\n-      col_offset = ((col * spp * bps) + 7) / 8;\n-      bufp = obuf + row_offset + col_offset;\n-\n-      if ((bps % 8) == 0)\n-        {\n-        if (combineSeparateTileSamplesBytes(srcbuffs, bufp, ncol, nrow, imagewidth,\n-\t\t\t\t\t    tw, spp, bps, NULL, 0, 0))\n-\t  {\n-          status = 0;\n-          break;\n-      \t  }\n-\t}\n-      else\n+        nrow = (row + tl > imagelength) ? imagelength - row : tl;\n+        for (col = 0; col < imagewidth; col += tw)\n         {\n-        bytes_per_pixel  = ((bps * spp) + 7) / 8;\n-        if (bytes_per_pixel < (bytes_per_sample + 1))\n-          shift_width = bytes_per_pixel;\n-        else\n-          shift_width = bytes_per_sample + 1;\n-\n-        switch (shift_width)\n-          {\n-          case 1: if (combineSeparateTileSamples8bits (srcbuffs, bufp, ncol, nrow,\n-                                                       imagewidth, tw, spp, bps, \n-\t\t\t\t\t\t       NULL, 0, 0))\n-\t            {\n+            for (s = 0; s < spp; s++)\n+            {  /* Read each plane of a tile set into srcbuffs[s] */\n+                tbytes = TIFFReadTile(in, srcbuffs[s], col, row, 0, s);\n+                if (tbytes < 0  && !ignore)\n+                {\n+                    TIFFError(TIFFFileName(in),\n+                               "Error, can\'t read tile for row %lu col %lu, "\n+                               "sample %lu",\n+                               (unsigned long) col, (unsigned long) row,\n+                               (unsigned long) s);\n                     status = 0;\n-                    break;\n-      \t            }\n-\t          break;\n-          case 2: if (combineSeparateTileSamples16bits (srcbuffs, bufp, ncol, nrow,\n-                                                       imagewidth, tw, spp, bps, \n-\t\t\t\t\t\t       NULL, 0, 0))\n-\t            {\n-                    status = 0;\n-                    break;\n-\t\t    }\n-\t          break;\n-          case 3: if (combineSeparateTileSamples24bits (srcbuffs, bufp, ncol, nrow,\n-                                                       imagewidth, tw, spp, bps, \n-\t\t\t\t\t\t       NULL, 0, 0))\n-\t            {\n-                    status = 0;\n-                    break;\n-       \t            }\n-                  break;\n-          case 4: \n-          case 5:\n-          case 6:\n-          case 7:\n-          case 8: if (combineSeparateTileSamples32bits (srcbuffs, bufp, ncol, nrow,\n-                                                       imagewidth, tw, spp, bps, \n-\t\t\t\t\t\t       NULL, 0, 0))\n-\t            {\n+                    for (sample = 0; (sample < spp) && (sample < MAX_SAMPLES); sample++)\n+                    {\n+                        tbuff = srcbuffs[sample];\n+                        if (tbuff != NULL)\n+                            _TIFFfree(tbuff);\n+                    }\n+                    return status;\n+                }\n+            }\n+            /* Tiles on the right edge may be padded out to tw \n+             * which must be a multiple of 16.\n+             * Ncol represents the visible (non padding) portion.  \n+             */\n+            if (col + tw > imagewidth)\n+                ncol = imagewidth - col;\n+            else\n+                ncol = tw;\n+\n+            row_offset = row * (((imagewidth * spp * bps) + 7) / 8);\n+            col_offset = ((col * spp * bps) + 7) / 8;\n+            bufp = obuf + row_offset + col_offset;\n+\n+            if ((bps % 8) == 0)\n+            {\n+                if (combineSeparateTileSamplesBytes(srcbuffs, bufp, ncol, nrow, imagewidth,\n+                                                     tw, spp, bps, NULL, 0, 0))\n+                {\n                     status = 0;\n                     break;\n-\t\t    }\n-\t          break;\n-          default: TIFFError ("readSeparateTilesIntoBuffer", "Unsupported bit depth: %d", bps);\n-                  status = 0;\n-                  break;\n-          }\n+                }\n+            }\n+            else\n+            {\n+                bytes_per_pixel = ((bps * spp) + 7) / 8;\n+                if (bytes_per_pixel < (bytes_per_sample + 1))\n+                    shift_width = bytes_per_pixel;\n+                else\n+                    shift_width = bytes_per_sample + 1;\n+\n+                switch (shift_width)\n+                {\n+                    case 1: \n+                        if (combineSeparateTileSamples8bits (srcbuffs, bufp, ncol, nrow,\n+                                                             imagewidth, tw, spp, bps, \n+                                                             NULL, 0, 0))\n+                        {\n+                            status = 0;\n+                            break;\n+                        }\n+                        break;\n+                    case 2: \n+                        if (combineSeparateTileSamples16bits (srcbuffs, bufp, ncol, nrow,\n+                                                              imagewidth, tw, spp, bps, \n+                                                              NULL, 0, 0))\n+                        {\n+                            status = 0;\n+                            break;\n+                        }\n+                        break;\n+                    case 3: \n+                        if (combineSeparateTileSamples24bits (srcbuffs, bufp, ncol, nrow,\n+                                                              imagewidth, tw, spp, bps, \n+                                                              NULL, 0, 0))\n+                        {\n+                            status = 0;\n+                            break;\n+                        }\n+                        break;\n+                    case 4: \n+                    case 5:\n+                    case 6:\n+                    case 7:\n+                    case 8: \n+                        if (combineSeparateTileSamples32bits (srcbuffs, bufp, ncol, nrow,\n+                                                              imagewidth, tw, spp, bps, \n+                                                              NULL, 0, 0))\n+                        {\n+                            status = 0;\n+                            break;\n+                        }\n+                        break;\n+                    default: \n+                        TIFFError ("readSeparateTilesIntoBuffer", "Unsupported bit depth: %d", bps);\n+                        status = 0;\n+                        break;\n+                }\n+            }\n         }\n-      }\n     }\n \n-  for (sample = 0; (sample < spp) && (sample < MAX_SAMPLES); sample++)\n+    for (sample = 0; (sample < spp) && (sample < MAX_SAMPLES); sample++)\n     {\n-    tbuff = srcbuffs[sample];\n-    if (tbuff != NULL)\n-      _TIFFfree(tbuff);\n+        tbuff = srcbuffs[sample];\n+        if (tbuff != NULL)\n+            _TIFFfree(tbuff);\n     }\n- \n-  return status;\n-  }\n+\n+    return status;\n+}\n+\n \n static int writeBufferToContigStrips(TIFF* out, uint8* buf, uint32 imagelength)\n   {\n', 'id': 2, 'location': '/data/vulnloc/libtiff/CVE-2016-5321/src/tools/tiffcrop.c:992:7'}, {'diff': '@@ -948,152 +948,159 @@\n   return status;\n   }\n \n-static int  readSeparateTilesIntoBuffer (TIFF* in, uint8 *obuf, \n-\t\t\t\t\t uint32 imagelength, uint32 imagewidth, \n+\n+static int readSeparateTilesIntoBuffer (TIFF* in, uint8 *obuf, \n+                                         uint32 imagelength, uint32 imagewidth, \n                                          uint32 tw, uint32 tl,\n                                          uint16 spp, uint16 bps)\n-  {\n-  int     i, status = 1, sample;\n-  int     shift_width, bytes_per_pixel;\n-  uint16  bytes_per_sample;\n-  uint32  row, col;     /* Current row and col of image */\n-  uint32  nrow, ncol;   /* Number of rows and cols in current tile */\n-  uint32  row_offset, col_offset; /* Output buffer offsets */\n-  tsize_t tbytes = 0, tilesize = TIFFTileSize(in);\n-  tsample_t s;\n-  uint8*  bufp = (uint8*)obuf;\n-  unsigned char *srcbuffs[MAX_SAMPLES];\n-  unsigned char *tbuff = NULL;\n-\n-  bytes_per_sample = (bps + 7) / 8;\n+{\n+    int i, status = 1, sample;\n+    int shift_width, bytes_per_pixel;\n+    uint16 bytes_per_sample;\n+    uint32 row, col;     /* Current row and col of image */\n+    uint32 nrow, ncol;   /* Number of rows and cols in current tile */\n+    uint32 row_offset, col_offset; /* Output buffer offsets */\n+    tsize_t tbytes = 0, tilesize = TIFFTileSize(in);\n+    tsample_t s;\n+    uint8*  bufp = (uint8*)obuf;\n+    unsigned char *srcbuffs[MAX_SAMPLES];\n+    unsigned char *tbuff = NULL;\n+\n+    bytes_per_sample = (bps + 7) / 8;\n+\n+    if (spp > MAX_SAMPLES) {\n+        TIFFError("readSeparateTilesIntoBuffer", "Number of samples exceeds MAX_SAMPLES");\n+        return 0;\n+    }\n \n-  for (sample = 0; (sample < spp) && (sample < MAX_SAMPLES); sample++)\n+    for (sample = 0; (sample < spp); sample++)\n     {\n-    srcbuffs[sample] = NULL;\n-    tbuff = (unsigned char *)_TIFFmalloc(tilesize + 8);\n-    if (!tbuff)\n-      {\n-      TIFFError ("readSeparateTilesIntoBuffer", \n-                 "Unable to allocate tile read buffer for sample %d", sample);\n-      for (i = 0; i < sample; i++)\n-        _TIFFfree (srcbuffs[i]);\n-      return 0;\n-      }\n-    srcbuffs[sample] = tbuff;\n+        srcbuffs[sample] = NULL;\n+        tbuff = (unsigned char *)_TIFFmalloc(tilesize + 8);\n+        if (!tbuff)\n+        {\n+            TIFFError ("readSeparateTilesIntoBuffer", \n+                        "Unable to allocate tile read buffer for sample %d", sample);\n+            for (i = 0; i < sample; i++)\n+                _TIFFfree (srcbuffs[i]);\n+            return 0;\n+        }\n+        srcbuffs[sample] = tbuff;\n     } \n-  /* Each tile contains only the data for a single plane\n-   * arranged in scanlines of tw * bytes_per_sample bytes.\n-   */\n-  for (row = 0; row < imagelength; row += tl)\n+    /* Each tile contains only the data for a single plane\n+     * arranged in scanlines of tw * bytes_per_sample bytes.\n+     */\n+    for (row = 0; row < imagelength; row += tl)\n     {\n-    nrow = (row + tl > imagelength) ? imagelength - row : tl;\n-    for (col = 0; col < imagewidth; col += tw)\n-      {\n-      for (s = 0; s < spp; s++)\n-        {  /* Read each plane of a tile set into srcbuffs[s] */\n-\ttbytes = TIFFReadTile(in, srcbuffs[s], col, row, 0, s);\n-        if (tbytes < 0  && !ignore)\n-          {\n-\t  TIFFError(TIFFFileName(in),\n-                 "Error, can\'t read tile for row %lu col %lu, "\n-\t\t "sample %lu",\n-\t\t (unsigned long) col, (unsigned long) row,\n-\t\t (unsigned long) s);\n-\t\t status = 0;\n-          for (sample = 0; (sample < spp) && (sample < MAX_SAMPLES); sample++)\n-            {\n-            tbuff = srcbuffs[sample];\n-            if (tbuff != NULL)\n-              _TIFFfree(tbuff);\n-            }\n-          return status;\n-\t  }\n-\t}\n-     /* Tiles on the right edge may be padded out to tw \n-      * which must be a multiple of 16.\n-      * Ncol represents the visible (non padding) portion.  \n-      */\n-      if (col + tw > imagewidth)\n-        ncol = imagewidth - col;\n-      else\n-        ncol = tw;\n-\n-      row_offset = row * (((imagewidth * spp * bps) + 7) / 8);\n-      col_offset = ((col * spp * bps) + 7) / 8;\n-      bufp = obuf + row_offset + col_offset;\n-\n-      if ((bps % 8) == 0)\n-        {\n-        if (combineSeparateTileSamplesBytes(srcbuffs, bufp, ncol, nrow, imagewidth,\n-\t\t\t\t\t    tw, spp, bps, NULL, 0, 0))\n-\t  {\n-          status = 0;\n-          break;\n-      \t  }\n-\t}\n-      else\n+        nrow = (row + tl > imagelength) ? imagelength - row : tl;\n+        for (col = 0; col < imagewidth; col += tw)\n         {\n-        bytes_per_pixel  = ((bps * spp) + 7) / 8;\n-        if (bytes_per_pixel < (bytes_per_sample + 1))\n-          shift_width = bytes_per_pixel;\n-        else\n-          shift_width = bytes_per_sample + 1;\n-\n-        switch (shift_width)\n-          {\n-          case 1: if (combineSeparateTileSamples8bits (srcbuffs, bufp, ncol, nrow,\n-                                                       imagewidth, tw, spp, bps, \n-\t\t\t\t\t\t       NULL, 0, 0))\n-\t            {\n+            for (s = 0; s < spp; s++)\n+            {  /* Read each plane of a tile set into srcbuffs[s] */\n+                tbytes = TIFFReadTile(in, srcbuffs[s], col, row, 0, s);\n+                if (tbytes < 0 /* && !ignore */)\n+                {\n+                    TIFFError(TIFFFileName(in),\n+                               "Error, can\'t read tile for row %lu col %lu, "\n+                               "sample %lu",\n+                               (unsigned long) col, (unsigned long) row,\n+                               (unsigned long) s);\n                     status = 0;\n-                    break;\n-      \t            }\n-\t          break;\n-          case 2: if (combineSeparateTileSamples16bits (srcbuffs, bufp, ncol, nrow,\n-                                                       imagewidth, tw, spp, bps, \n-\t\t\t\t\t\t       NULL, 0, 0))\n-\t            {\n-                    status = 0;\n-                    break;\n-\t\t    }\n-\t          break;\n-          case 3: if (combineSeparateTileSamples24bits (srcbuffs, bufp, ncol, nrow,\n-                                                       imagewidth, tw, spp, bps, \n-\t\t\t\t\t\t       NULL, 0, 0))\n-\t            {\n-                    status = 0;\n-                    break;\n-       \t            }\n-                  break;\n-          case 4: \n-          case 5:\n-          case 6:\n-          case 7:\n-          case 8: if (combineSeparateTileSamples32bits (srcbuffs, bufp, ncol, nrow,\n-                                                       imagewidth, tw, spp, bps, \n-\t\t\t\t\t\t       NULL, 0, 0))\n-\t            {\n+                    for (sample = 0; (sample < spp); sample++)\n+                    {\n+                        tbuff = srcbuffs[sample];\n+                        if (tbuff != NULL)\n+                            _TIFFfree(tbuff);\n+                    }\n+                    return status;\n+                }\n+            }\n+            /* Tiles on the right edge may be padded out to tw \n+             * which must be a multiple of 16.\n+             * Ncol represents the visible (non padding) portion.  \n+             */\n+            if (col + tw > imagewidth)\n+                ncol = imagewidth - col;\n+            else\n+                ncol = tw;\n+\n+            row_offset = row * (((imagewidth * spp * bps) + 7) / 8);\n+            col_offset = ((col * spp * bps) + 7) / 8;\n+            bufp = obuf + row_offset + col_offset;\n+\n+            if ((bps % 8) == 0)\n+            {\n+                if (combineSeparateTileSamplesBytes(srcbuffs, bufp, ncol, nrow, imagewidth,\n+                                                    tw, spp, bps, NULL, 0, 0))\n+                {\n                     status = 0;\n                     break;\n-\t\t    }\n-\t          break;\n-          default: TIFFError ("readSeparateTilesIntoBuffer", "Unsupported bit depth: %d", bps);\n-                  status = 0;\n-                  break;\n-          }\n+                }\n+            }\n+            else\n+            {\n+                bytes_per_pixel  = ((bps * spp) + 7) / 8;\n+                if (bytes_per_pixel < (bytes_per_sample + 1))\n+                    shift_width = bytes_per_pixel;\n+                else\n+                    shift_width = bytes_per_sample + 1;\n+\n+                switch (shift_width)\n+                {\n+                case 1: if (combineSeparateTileSamples8bits (srcbuffs, bufp, ncol, nrow,\n+                                                             imagewidth, tw, spp, bps, \n+                                                             NULL, 0, 0))\n+                        {\n+                            status = 0;\n+                            break;\n+                        }\n+                        break;\n+                case 2: if (combineSeparateTileSamples16bits (srcbuffs, bufp, ncol, nrow,\n+                                                             imagewidth, tw, spp, bps, \n+                                                             NULL, 0, 0))\n+                        {\n+                            status = 0;\n+                            break;\n+                        }\n+                        break;\n+                case 3: if (combineSeparateTileSamples24bits (srcbuffs, bufp, ncol, nrow,\n+                                                             imagewidth, tw, spp, bps, \n+                                                             NULL, 0, 0))\n+                        {\n+                            status = 0;\n+                            break;\n+                        }\n+                        break;\n+                case 4: \n+                case 5:\n+                case 6:\n+                case 7:\n+                case 8: if (combineSeparateTileSamples32bits (srcbuffs, bufp, ncol, nrow,\n+                                                             imagewidth, tw, spp, bps, \n+                                                             NULL, 0, 0))\n+                        {\n+                            status = 0;\n+                            break;\n+                        }\n+                        break;\n+                default: TIFFError ("readSeparateTilesIntoBuffer", "Unsupported bit depth: %d", bps);\n+                         status = 0;\n+                         break;\n+                }\n+            }\n         }\n-      }\n     }\n \n-  for (sample = 0; (sample < spp) && (sample < MAX_SAMPLES); sample++)\n+    for (sample = 0; (sample < spp); sample++)\n     {\n-    tbuff = srcbuffs[sample];\n-    if (tbuff != NULL)\n-      _TIFFfree(tbuff);\n+        tbuff = srcbuffs[sample];\n+        if (tbuff != NULL)\n+            _TIFFfree(tbuff);\n     }\n- \n-  return status;\n-  }\n+\n+    return status;\n+}\n+\n \n static int writeBufferToContigStrips(TIFF* out, uint8* buf, uint32 imagelength)\n   {\n', 'id': 3, 'location': '/data/vulnloc/libtiff/CVE-2016-5321/src/tools/tiffcrop.c:992:7'}, {'diff': '@@ -948,152 +948,159 @@\n   return status;\n   }\n \n-static int  readSeparateTilesIntoBuffer (TIFF* in, uint8 *obuf, \n-\t\t\t\t\t uint32 imagelength, uint32 imagewidth, \n+\n+static int readSeparateTilesIntoBuffer (TIFF* in, uint8 *obuf, \n+                                         uint32 imagelength, uint32 imagewidth, \n                                          uint32 tw, uint32 tl,\n                                          uint16 spp, uint16 bps)\n-  {\n-  int     i, status = 1, sample;\n-  int     shift_width, bytes_per_pixel;\n-  uint16  bytes_per_sample;\n-  uint32  row, col;     /* Current row and col of image */\n-  uint32  nrow, ncol;   /* Number of rows and cols in current tile */\n-  uint32  row_offset, col_offset; /* Output buffer offsets */\n-  tsize_t tbytes = 0, tilesize = TIFFTileSize(in);\n-  tsample_t s;\n-  uint8*  bufp = (uint8*)obuf;\n-  unsigned char *srcbuffs[MAX_SAMPLES];\n-  unsigned char *tbuff = NULL;\n-\n-  bytes_per_sample = (bps + 7) / 8;\n+{\n+    int     i, status = 1, sample;\n+    int     shift_width, bytes_per_pixel;\n+    uint16  bytes_per_sample;\n+    uint32  row, col;     /* Current row and col of image */\n+    uint32  nrow, ncol;   /* Number of rows and cols in current tile */\n+    uint32  row_offset, col_offset; /* Output buffer offsets */\n+    tsize_t tbytes = 0, tilesize = TIFFTileSize(in);\n+    tsample_t s;\n+    uint8*  bufp = (uint8*)obuf;\n+    unsigned char *srcbuffs[MAX_SAMPLES];\n+    unsigned char *tbuff = NULL;\n+\n+    bytes_per_sample = (bps + 7) / 8;\n+\n+    if (spp > MAX_SAMPLES) {\n+        TIFFError("readSeparateTilesIntoBuffer", "Samples per pixel exceed maximum allowed");\n+        return 0;\n+    }\n \n-  for (sample = 0; (sample < spp) && (sample < MAX_SAMPLES); sample++)\n+    for (sample = 0; (sample < spp) && (sample < MAX_SAMPLES); sample++)\n     {\n-    srcbuffs[sample] = NULL;\n-    tbuff = (unsigned char *)_TIFFmalloc(tilesize + 8);\n-    if (!tbuff)\n-      {\n-      TIFFError ("readSeparateTilesIntoBuffer", \n-                 "Unable to allocate tile read buffer for sample %d", sample);\n-      for (i = 0; i < sample; i++)\n-        _TIFFfree (srcbuffs[i]);\n-      return 0;\n-      }\n-    srcbuffs[sample] = tbuff;\n+        srcbuffs[sample] = NULL;\n+        tbuff = (unsigned char *)_TIFFmalloc(tilesize + 8);\n+        if (!tbuff)\n+        {\n+            TIFFError ("readSeparateTilesIntoBuffer", \n+                        "Unable to allocate tile read buffer for sample %d", sample);\n+            for (i = 0; i < sample; i++)\n+                _TIFFfree (srcbuffs[i]);\n+            return 0;\n+        }\n+        srcbuffs[sample] = tbuff;\n     } \n-  /* Each tile contains only the data for a single plane\n-   * arranged in scanlines of tw * bytes_per_sample bytes.\n-   */\n-  for (row = 0; row < imagelength; row += tl)\n+    /* Each tile contains only the data for a single plane\n+     * arranged in scanlines of tw * bytes_per_sample bytes.\n+     */\n+    for (row = 0; row < imagelength; row += tl)\n     {\n-    nrow = (row + tl > imagelength) ? imagelength - row : tl;\n-    for (col = 0; col < imagewidth; col += tw)\n-      {\n-      for (s = 0; s < spp; s++)\n-        {  /* Read each plane of a tile set into srcbuffs[s] */\n-\ttbytes = TIFFReadTile(in, srcbuffs[s], col, row, 0, s);\n-        if (tbytes < 0  && !ignore)\n-          {\n-\t  TIFFError(TIFFFileName(in),\n-                 "Error, can\'t read tile for row %lu col %lu, "\n-\t\t "sample %lu",\n-\t\t (unsigned long) col, (unsigned long) row,\n-\t\t (unsigned long) s);\n-\t\t status = 0;\n-          for (sample = 0; (sample < spp) && (sample < MAX_SAMPLES); sample++)\n-            {\n-            tbuff = srcbuffs[sample];\n-            if (tbuff != NULL)\n-              _TIFFfree(tbuff);\n+        nrow = (row + tl > imagelength) ? imagelength - row : tl;\n+        for (col = 0; col < imagewidth; col += tw)\n+        {\n+            for (s = 0; s < spp; s++)\n+            {  /* Read each plane of a tile set into srcbuffs[s] */\n+                tbytes = TIFFReadTile(in, srcbuffs[s], col, row, 0, s);\n+                if (tbytes < 0  && !ignore)\n+                {\n+                    TIFFError(TIFFFileName(in),\n+                              "Error, can\'t read tile for row %lu col %lu, "\n+                              "sample %lu",\n+                              (unsigned long) col, (unsigned long) row,\n+                              (unsigned long) s);\n+                    status = 0;\n+                    for (sample = 0; (sample < spp) && (sample < MAX_SAMPLES); sample++)\n+                    {\n+                        tbuff = srcbuffs[sample];\n+                        if (tbuff != NULL)\n+                            _TIFFfree(tbuff);\n+                    }\n+                    return status;\n+                }\n             }\n-          return status;\n-\t  }\n-\t}\n-     /* Tiles on the right edge may be padded out to tw \n-      * which must be a multiple of 16.\n-      * Ncol represents the visible (non padding) portion.  \n-      */\n-      if (col + tw > imagewidth)\n-        ncol = imagewidth - col;\n-      else\n-        ncol = tw;\n-\n-      row_offset = row * (((imagewidth * spp * bps) + 7) / 8);\n-      col_offset = ((col * spp * bps) + 7) / 8;\n-      bufp = obuf + row_offset + col_offset;\n+            /* Tiles on the right edge may be padded out to tw \n+             * which must be a multiple of 16.\n+             * Ncol represents the visible (non padding) portion.  \n+             */\n+            if (col + tw > imagewidth)\n+                ncol = imagewidth - col;\n+            else\n+                ncol = tw;\n+\n+            row_offset = row * (((imagewidth * spp * bps) + 7) / 8);\n+            col_offset = ((col * spp * bps) + 7) / 8;\n+            bufp = obuf + row_offset + col_offset;\n \n-      if ((bps % 8) == 0)\n-        {\n-        if (combineSeparateTileSamplesBytes(srcbuffs, bufp, ncol, nrow, imagewidth,\n-\t\t\t\t\t    tw, spp, bps, NULL, 0, 0))\n-\t  {\n-          status = 0;\n-          break;\n-      \t  }\n-\t}\n-      else\n-        {\n-        bytes_per_pixel  = ((bps * spp) + 7) / 8;\n-        if (bytes_per_pixel < (bytes_per_sample + 1))\n-          shift_width = bytes_per_pixel;\n-        else\n-          shift_width = bytes_per_sample + 1;\n-\n-        switch (shift_width)\n-          {\n-          case 1: if (combineSeparateTileSamples8bits (srcbuffs, bufp, ncol, nrow,\n-                                                       imagewidth, tw, spp, bps, \n-\t\t\t\t\t\t       NULL, 0, 0))\n-\t            {\n+            if ((bps % 8) == 0)\n+            {\n+                if (combineSeparateTileSamplesBytes(srcbuffs, bufp, ncol, nrow, imagewidth,\n+                                                     tw, spp, bps, NULL, 0, 0))\n+                {\n                     status = 0;\n                     break;\n-      \t            }\n-\t          break;\n-          case 2: if (combineSeparateTileSamples16bits (srcbuffs, bufp, ncol, nrow,\n-                                                       imagewidth, tw, spp, bps, \n-\t\t\t\t\t\t       NULL, 0, 0))\n-\t            {\n-                    status = 0;\n+                }\n+            }\n+            else\n+            {\n+                bytes_per_pixel  = ((bps * spp) + 7) / 8;\n+                if (bytes_per_pixel < (bytes_per_sample + 1))\n+                    shift_width = bytes_per_pixel;\n+                else\n+                    shift_width = bytes_per_sample + 1;\n+\n+                switch (shift_width)\n+                {\n+                case 1: if (combineSeparateTileSamples8bits (srcbuffs, bufp, ncol, nrow,\n+                                                             imagewidth, tw, spp, bps, \n+                                                             NULL, 0, 0))\n+                    {\n+                        status = 0;\n+                        break;\n+                    }\n                     break;\n-\t\t    }\n-\t          break;\n-          case 3: if (combineSeparateTileSamples24bits (srcbuffs, bufp, ncol, nrow,\n-                                                       imagewidth, tw, spp, bps, \n-\t\t\t\t\t\t       NULL, 0, 0))\n-\t            {\n-                    status = 0;\n+                case 2: if (combineSeparateTileSamples16bits (srcbuffs, bufp, ncol, nrow,\n+                                                             imagewidth, tw, spp, bps, \n+                                                             NULL, 0, 0))\n+                    {\n+                        status = 0;\n+                        break;\n+                    }\n                     break;\n-       \t            }\n-                  break;\n-          case 4: \n-          case 5:\n-          case 6:\n-          case 7:\n-          case 8: if (combineSeparateTileSamples32bits (srcbuffs, bufp, ncol, nrow,\n-                                                       imagewidth, tw, spp, bps, \n-\t\t\t\t\t\t       NULL, 0, 0))\n-\t            {\n-                    status = 0;\n+                case 3: if (combineSeparateTileSamples24bits (srcbuffs, bufp, ncol, nrow,\n+                                                             imagewidth, tw, spp, bps, \n+                                                             NULL, 0, 0))\n+                    {\n+                        status = 0;\n+                        break;\n+                    }\n+                    break;\n+                case 4: \n+                case 5:\n+                case 6:\n+                case 7:\n+                case 8: if (combineSeparateTileSamples32bits (srcbuffs, bufp, ncol, nrow,\n+                                                             imagewidth, tw, spp, bps, \n+                                                             NULL, 0, 0))\n+                    {\n+                        status = 0;\n+                        break;\n+                    }\n                     break;\n-\t\t    }\n-\t          break;\n-          default: TIFFError ("readSeparateTilesIntoBuffer", "Unsupported bit depth: %d", bps);\n-                  status = 0;\n-                  break;\n-          }\n+                default: TIFFError ("readSeparateTilesIntoBuffer", "Unsupported bit depth: %d", bps);\n+                         status = 0;\n+                         break;\n+                }\n+            }\n         }\n-      }\n     }\n \n-  for (sample = 0; (sample < spp) && (sample < MAX_SAMPLES); sample++)\n+    for (sample = 0; (sample < spp) && (sample < MAX_SAMPLES); sample++)\n     {\n-    tbuff = srcbuffs[sample];\n-    if (tbuff != NULL)\n-      _TIFFfree(tbuff);\n+        tbuff = srcbuffs[sample];\n+        if (tbuff != NULL)\n+            _TIFFfree(tbuff);\n     }\n- \n-  return status;\n-  }\n+\n+    return status;\n+}\n+\n \n static int writeBufferToContigStrips(TIFF* out, uint8* buf, uint32 imagelength)\n   {\n', 'id': 4, 'location': '/data/vulnloc/libtiff/CVE-2016-5321/src/tools/tiffcrop.c:992:7'}, {'diff': '@@ -948,152 +948,159 @@\n   return status;\n   }\n \n-static int  readSeparateTilesIntoBuffer (TIFF* in, uint8 *obuf, \n-\t\t\t\t\t uint32 imagelength, uint32 imagewidth, \n-                                         uint32 tw, uint32 tl,\n-                                         uint16 spp, uint16 bps)\n-  {\n-  int     i, status = 1, sample;\n-  int     shift_width, bytes_per_pixel;\n-  uint16  bytes_per_sample;\n-  uint32  row, col;     /* Current row and col of image */\n-  uint32  nrow, ncol;   /* Number of rows and cols in current tile */\n-  uint32  row_offset, col_offset; /* Output buffer offsets */\n-  tsize_t tbytes = 0, tilesize = TIFFTileSize(in);\n-  tsample_t s;\n-  uint8*  bufp = (uint8*)obuf;\n-  unsigned char *srcbuffs[MAX_SAMPLES];\n-  unsigned char *tbuff = NULL;\n \n-  bytes_per_sample = (bps + 7) / 8;\n+static int readSeparateTilesIntoBuffer(TIFF* in, uint8 *obuf, \n+                                       uint32 imagelength, uint32 imagewidth, \n+                                       uint32 tw, uint32 tl,\n+                                       uint16 spp, uint16 bps)\n+{\n+    int i, status = 1, sample;\n+    int shift_width, bytes_per_pixel;\n+    uint16 bytes_per_sample;\n+    uint32 row, col; /* Current row and col of image */\n+    uint32 nrow, ncol; /* Number of rows and cols in current tile */\n+    uint32 row_offset, col_offset; /* Output buffer offsets */\n+    tsize_t tbytes = 0, tilesize = TIFFTileSize(in);\n+    tsample_t s;\n+    uint8* bufp = (uint8*)obuf;\n+    unsigned char *srcbuffs[MAX_SAMPLES];\n+    unsigned char *tbuff = NULL;\n+\n+    bytes_per_sample = (bps + 7) / 8;\n \n-  for (sample = 0; (sample < spp) && (sample < MAX_SAMPLES); sample++)\n+    for (sample = 0; (sample < spp) && (sample < MAX_SAMPLES); sample++)\n     {\n-    srcbuffs[sample] = NULL;\n-    tbuff = (unsigned char *)_TIFFmalloc(tilesize + 8);\n-    if (!tbuff)\n-      {\n-      TIFFError ("readSeparateTilesIntoBuffer", \n-                 "Unable to allocate tile read buffer for sample %d", sample);\n-      for (i = 0; i < sample; i++)\n-        _TIFFfree (srcbuffs[i]);\n-      return 0;\n-      }\n-    srcbuffs[sample] = tbuff;\n-    } \n-  /* Each tile contains only the data for a single plane\n-   * arranged in scanlines of tw * bytes_per_sample bytes.\n-   */\n-  for (row = 0; row < imagelength; row += tl)\n+        srcbuffs[sample] = NULL;\n+        tbuff = (unsigned char *)_TIFFmalloc(tilesize + 8);\n+        if (!tbuff)\n+        {\n+            TIFFError("readSeparateTilesIntoBuffer", \n+                       "Unable to allocate tile read buffer for sample %d", sample);\n+            for (i = 0; i < sample; i++)\n+                _TIFFfree(srcbuffs[i]);\n+            return 0;\n+        }\n+        srcbuffs[sample] = tbuff;\n+    }\n+    /* Each tile contains only the data for a single plane\n+     * arranged in scanlines of tw * bytes_per_sample bytes.\n+     */\n+    for (row = 0; row < imagelength; row += tl)\n     {\n-    nrow = (row + tl > imagelength) ? imagelength - row : tl;\n-    for (col = 0; col < imagewidth; col += tw)\n-      {\n-      for (s = 0; s < spp; s++)\n-        {  /* Read each plane of a tile set into srcbuffs[s] */\n-\ttbytes = TIFFReadTile(in, srcbuffs[s], col, row, 0, s);\n-        if (tbytes < 0  && !ignore)\n-          {\n-\t  TIFFError(TIFFFileName(in),\n-                 "Error, can\'t read tile for row %lu col %lu, "\n-\t\t "sample %lu",\n-\t\t (unsigned long) col, (unsigned long) row,\n-\t\t (unsigned long) s);\n-\t\t status = 0;\n-          for (sample = 0; (sample < spp) && (sample < MAX_SAMPLES); sample++)\n-            {\n-            tbuff = srcbuffs[sample];\n-            if (tbuff != NULL)\n-              _TIFFfree(tbuff);\n+        nrow = (row + tl > imagelength) ? imagelength - row : tl;\n+        for (col = 0; col < imagewidth; col += tw)\n+        {\n+            for (s = 0; s < spp; s++)\n+            {  /* Read each plane of a tile set into srcbuffs[s] */\n+                tbytes = TIFFReadTile(in, srcbuffs[s], col, row, 0, s);\n+                if (tbytes < 0 && !ignore)\n+                {\n+                    TIFFError(TIFFFileName(in),\n+                               "Error, can\'t read tile for row %lu col %lu, "\n+                               "sample %lu",\n+                               (unsigned long)col, (unsigned long)row,\n+                               (unsigned long)s);\n+                    status = 0;\n+                    for (sample = 0; (sample < spp) && (sample < MAX_SAMPLES); sample++)\n+                    {\n+                        tbuff = srcbuffs[sample];\n+                        if (tbuff != NULL)\n+                            _TIFFfree(tbuff);\n+                    }\n+                    return status;\n+                }\n             }\n-          return status;\n-\t  }\n-\t}\n-     /* Tiles on the right edge may be padded out to tw \n-      * which must be a multiple of 16.\n-      * Ncol represents the visible (non padding) portion.  \n-      */\n-      if (col + tw > imagewidth)\n-        ncol = imagewidth - col;\n-      else\n-        ncol = tw;\n-\n-      row_offset = row * (((imagewidth * spp * bps) + 7) / 8);\n-      col_offset = ((col * spp * bps) + 7) / 8;\n-      bufp = obuf + row_offset + col_offset;\n+            /* Tiles on the right edge may be padded out to tw \n+             * which must be a multiple of 16.\n+             * Ncol represents the visible (non padding) portion.  \n+             */\n+            if (col + tw > imagewidth)\n+                ncol = imagewidth - col;\n+            else\n+                ncol = tw;\n+\n+            row_offset = row * (((imagewidth * spp * bps) + 7) / 8);\n+            col_offset = ((col * spp * bps) + 7) / 8;\n+            bufp = obuf + row_offset + col_offset;\n \n-      if ((bps % 8) == 0)\n-        {\n-        if (combineSeparateTileSamplesBytes(srcbuffs, bufp, ncol, nrow, imagewidth,\n-\t\t\t\t\t    tw, spp, bps, NULL, 0, 0))\n-\t  {\n-          status = 0;\n-          break;\n-      \t  }\n-\t}\n-      else\n-        {\n-        bytes_per_pixel  = ((bps * spp) + 7) / 8;\n-        if (bytes_per_pixel < (bytes_per_sample + 1))\n-          shift_width = bytes_per_pixel;\n-        else\n-          shift_width = bytes_per_sample + 1;\n-\n-        switch (shift_width)\n-          {\n-          case 1: if (combineSeparateTileSamples8bits (srcbuffs, bufp, ncol, nrow,\n-                                                       imagewidth, tw, spp, bps, \n-\t\t\t\t\t\t       NULL, 0, 0))\n-\t            {\n+            if ((bps % 8) == 0)\n+            {\n+                if (combineSeparateTileSamplesBytes(srcbuffs, bufp, ncol, nrow, imagewidth,\n+                                                     tw, spp, bps, NULL, 0, 0))\n+                {\n                     status = 0;\n                     break;\n-      \t            }\n-\t          break;\n-          case 2: if (combineSeparateTileSamples16bits (srcbuffs, bufp, ncol, nrow,\n-                                                       imagewidth, tw, spp, bps, \n-\t\t\t\t\t\t       NULL, 0, 0))\n-\t            {\n-                    status = 0;\n+                }\n+            }\n+            else\n+            {\n+                bytes_per_pixel = ((bps * spp) + 7) / 8;\n+                if (bytes_per_pixel < (bytes_per_sample + 1))\n+                    shift_width = bytes_per_pixel;\n+                else\n+                    shift_width = bytes_per_sample + 1;\n+\n+                switch (shift_width)\n+                {\n+                case 1: \n+                    if (combineSeparateTileSamples8bits(srcbuffs, bufp, ncol, nrow,\n+                                                         imagewidth, tw, spp, bps, \n+                                                         NULL, 0, 0))\n+                    {\n+                        status = 0;\n+                        break;\n+                    }\n                     break;\n-\t\t    }\n-\t          break;\n-          case 3: if (combineSeparateTileSamples24bits (srcbuffs, bufp, ncol, nrow,\n-                                                       imagewidth, tw, spp, bps, \n-\t\t\t\t\t\t       NULL, 0, 0))\n-\t            {\n-                    status = 0;\n+                case 2: \n+                    if (combineSeparateTileSamples16bits(srcbuffs, bufp, ncol, nrow,\n+                                                          imagewidth, tw, spp, bps, \n+                                                          NULL, 0, 0))\n+                    {\n+                        status = 0;\n+                        break;\n+                    }\n+                    break;\n+                case 3: \n+                    if (combineSeparateTileSamples24bits(srcbuffs, bufp, ncol, nrow,\n+                                                          imagewidth, tw, spp, bps, \n+                                                          NULL, 0, 0))\n+                    {\n+                        status = 0;\n+                        break;\n+                    }\n+                    break;\n+                case 4: \n+                case 5:\n+                case 6:\n+                case 7:\n+                case 8: \n+                    if (combineSeparateTileSamples32bits(srcbuffs, bufp, ncol, nrow,\n+                                                          imagewidth, tw, spp, bps, \n+                                                          NULL, 0, 0))\n+                    {\n+                        status = 0;\n+                        break;\n+                    }\n                     break;\n-       \t            }\n-                  break;\n-          case 4: \n-          case 5:\n-          case 6:\n-          case 7:\n-          case 8: if (combineSeparateTileSamples32bits (srcbuffs, bufp, ncol, nrow,\n-                                                       imagewidth, tw, spp, bps, \n-\t\t\t\t\t\t       NULL, 0, 0))\n-\t            {\n+                default: \n+                    TIFFError("readSeparateTilesIntoBuffer", "Unsupported bit depth: %d", bps);\n                     status = 0;\n                     break;\n-\t\t    }\n-\t          break;\n-          default: TIFFError ("readSeparateTilesIntoBuffer", "Unsupported bit depth: %d", bps);\n-                  status = 0;\n-                  break;\n-          }\n+                }\n+            }\n         }\n-      }\n     }\n \n-  for (sample = 0; (sample < spp) && (sample < MAX_SAMPLES); sample++)\n+    for (sample = 0; (sample < spp) && (sample < MAX_SAMPLES); sample++)\n     {\n-    tbuff = srcbuffs[sample];\n-    if (tbuff != NULL)\n-      _TIFFfree(tbuff);\n+        tbuff = srcbuffs[sample];\n+        if (tbuff != NULL)\n+            _TIFFfree(tbuff);\n     }\n- \n-  return status;\n-  }\n+\n+    return status;\n+}\n+\n \n static int writeBufferToContigStrips(TIFF* out, uint8* buf, uint32 imagelength)\n   {\n', 'id': 5, 'location': '/data/vulnloc/libtiff/CVE-2016-5321/src/tools/tiffcrop.c:994:11'}, {'diff': '@@ -948,11 +948,12 @@\n   return status;\n   }\n \n+\n static int  readSeparateTilesIntoBuffer (TIFF* in, uint8 *obuf, \n \t\t\t\t\t uint32 imagelength, uint32 imagewidth, \n                                          uint32 tw, uint32 tl,\n                                          uint16 spp, uint16 bps)\n-  {\n+{\n   int     i, status = 1, sample;\n   int     shift_width, bytes_per_pixel;\n   uint16  bytes_per_sample;\n@@ -968,51 +969,46 @@\n   bytes_per_sample = (bps + 7) / 8;\n \n   for (sample = 0; (sample < spp) && (sample < MAX_SAMPLES); sample++)\n-    {\n+  {\n     srcbuffs[sample] = NULL;\n     tbuff = (unsigned char *)_TIFFmalloc(tilesize + 8);\n     if (!tbuff)\n-      {\n+    {\n       TIFFError ("readSeparateTilesIntoBuffer", \n                  "Unable to allocate tile read buffer for sample %d", sample);\n       for (i = 0; i < sample; i++)\n         _TIFFfree (srcbuffs[i]);\n       return 0;\n-      }\n+    }\n     srcbuffs[sample] = tbuff;\n-    } \n-  /* Each tile contains only the data for a single plane\n-   * arranged in scanlines of tw * bytes_per_sample bytes.\n-   */\n+  } \n+\n   for (row = 0; row < imagelength; row += tl)\n-    {\n+  {\n     nrow = (row + tl > imagelength) ? imagelength - row : tl;\n     for (col = 0; col < imagewidth; col += tw)\n-      {\n+    {\n       for (s = 0; s < spp; s++)\n-        {  /* Read each plane of a tile set into srcbuffs[s] */\n-\ttbytes = TIFFReadTile(in, srcbuffs[s], col, row, 0, s);\n+      {  \n+        tbytes = TIFFReadTile(in, srcbuffs[s], col, row, 0, s);\n         if (tbytes < 0  && !ignore)\n-          {\n-\t  TIFFError(TIFFFileName(in),\n+        {\n+          TIFFError(TIFFFileName(in),\n                  "Error, can\'t read tile for row %lu col %lu, "\n \t\t "sample %lu",\n \t\t (unsigned long) col, (unsigned long) row,\n \t\t (unsigned long) s);\n-\t\t status = 0;\n+          status = 0;\n           for (sample = 0; (sample < spp) && (sample < MAX_SAMPLES); sample++)\n-            {\n+          {\n             tbuff = srcbuffs[sample];\n             if (tbuff != NULL)\n               _TIFFfree(tbuff);\n-            }\n+          }\n           return status;\n-\t  }\n-\t}\n-     /* Tiles on the right edge may be padded out to tw \n-      * which must be a multiple of 16.\n-      * Ncol represents the visible (non padding) portion.  \n-      */\n+        }\n+      }\n+     \n       if (col + tw > imagewidth)\n         ncol = imagewidth - col;\n       else\n@@ -1023,16 +1019,16 @@\n       bufp = obuf + row_offset + col_offset;\n \n       if ((bps % 8) == 0)\n-        {\n+      {\n         if (combineSeparateTileSamplesBytes(srcbuffs, bufp, ncol, nrow, imagewidth,\n \t\t\t\t\t    tw, spp, bps, NULL, 0, 0))\n-\t  {\n+\t{\n           status = 0;\n           break;\n-      \t  }\n-\t}\n+        }\n+      }\n       else\n-        {\n+      {\n         bytes_per_pixel  = ((bps * spp) + 7) / 8;\n         if (bytes_per_pixel < (bytes_per_sample + 1))\n           shift_width = bytes_per_pixel;\n@@ -1040,7 +1036,7 @@\n           shift_width = bytes_per_sample + 1;\n \n         switch (shift_width)\n-          {\n+        {\n           case 1: if (combineSeparateTileSamples8bits (srcbuffs, bufp, ncol, nrow,\n                                                        imagewidth, tw, spp, bps, \n \t\t\t\t\t\t       NULL, 0, 0))\n@@ -1080,20 +1076,21 @@\n           default: TIFFError ("readSeparateTilesIntoBuffer", "Unsupported bit depth: %d", bps);\n                   status = 0;\n                   break;\n-          }\n         }\n       }\n     }\n+  }\n \n   for (sample = 0; (sample < spp) && (sample < MAX_SAMPLES); sample++)\n-    {\n+  {\n     tbuff = srcbuffs[sample];\n     if (tbuff != NULL)\n       _TIFFfree(tbuff);\n-    }\n+  }\n  \n   return status;\n-  }\n+}\n+\n \n static int writeBufferToContigStrips(TIFF* out, uint8* buf, uint32 imagelength)\n   {\n', 'id': 6, 'location': '/data/vulnloc/libtiff/CVE-2016-5321/src/tools/tiffcrop.c:994:11'}, {'diff': '@@ -948,152 +948,147 @@\n   return status;\n   }\n \n-static int  readSeparateTilesIntoBuffer (TIFF* in, uint8 *obuf, \n-\t\t\t\t\t uint32 imagelength, uint32 imagewidth, \n-                                         uint32 tw, uint32 tl,\n-                                         uint16 spp, uint16 bps)\n-  {\n-  int     i, status = 1, sample;\n-  int     shift_width, bytes_per_pixel;\n-  uint16  bytes_per_sample;\n-  uint32  row, col;     /* Current row and col of image */\n-  uint32  nrow, ncol;   /* Number of rows and cols in current tile */\n-  uint32  row_offset, col_offset; /* Output buffer offsets */\n-  tsize_t tbytes = 0, tilesize = TIFFTileSize(in);\n-  tsample_t s;\n-  uint8*  bufp = (uint8*)obuf;\n-  unsigned char *srcbuffs[MAX_SAMPLES];\n-  unsigned char *tbuff = NULL;\n \n-  bytes_per_sample = (bps + 7) / 8;\n+static int readSeparateTilesIntoBuffer(TIFF* in, uint8 *obuf, \n+                                        uint32 imagelength, uint32 imagewidth, \n+                                        uint32 tw, uint32 tl,\n+                                        uint16 spp, uint16 bps)\n+{\n+    int     i, status = 1, sample;\n+    int     shift_width, bytes_per_pixel;\n+    uint16  bytes_per_sample;\n+    uint32  row, col;     /* Current row and col of image */\n+    uint32  nrow, ncol;   /* Number of rows and cols in current tile */\n+    uint32  row_offset, col_offset; /* Output buffer offsets */\n+    tsize_t tbytes = 0, tilesize = TIFFTileSize(in);\n+    tsample_t s;\n+    uint8*  bufp = (uint8*)obuf;\n+    unsigned char *srcbuffs[MAX_SAMPLES];\n+    unsigned char *tbuff = NULL;\n+\n+    bytes_per_sample = (bps + 7) / 8;\n \n-  for (sample = 0; (sample < spp) && (sample < MAX_SAMPLES); sample++)\n+    for (sample = 0; (sample < spp) && (sample < MAX_SAMPLES); sample++)\n     {\n-    srcbuffs[sample] = NULL;\n-    tbuff = (unsigned char *)_TIFFmalloc(tilesize + 8);\n-    if (!tbuff)\n-      {\n-      TIFFError ("readSeparateTilesIntoBuffer", \n-                 "Unable to allocate tile read buffer for sample %d", sample);\n-      for (i = 0; i < sample; i++)\n-        _TIFFfree (srcbuffs[i]);\n-      return 0;\n-      }\n-    srcbuffs[sample] = tbuff;\n+        srcbuffs[sample] = NULL;\n+        tbuff = (unsigned char *)_TIFFmalloc(tilesize + 8);\n+        if (!tbuff)\n+        {\n+            TIFFError ("readSeparateTilesIntoBuffer", \n+                        "Unable to allocate tile read buffer for sample %d", sample);\n+            for (i = 0; i < sample; i++)\n+                _TIFFfree(srcbuffs[i]);\n+            return 0;\n+        }\n+        srcbuffs[sample] = tbuff;\n     } \n-  /* Each tile contains only the data for a single plane\n-   * arranged in scanlines of tw * bytes_per_sample bytes.\n-   */\n-  for (row = 0; row < imagelength; row += tl)\n-    {\n-    nrow = (row + tl > imagelength) ? imagelength - row : tl;\n-    for (col = 0; col < imagewidth; col += tw)\n-      {\n-      for (s = 0; s < spp; s++)\n-        {  /* Read each plane of a tile set into srcbuffs[s] */\n-\ttbytes = TIFFReadTile(in, srcbuffs[s], col, row, 0, s);\n-        if (tbytes < 0  && !ignore)\n-          {\n-\t  TIFFError(TIFFFileName(in),\n-                 "Error, can\'t read tile for row %lu col %lu, "\n-\t\t "sample %lu",\n-\t\t (unsigned long) col, (unsigned long) row,\n-\t\t (unsigned long) s);\n-\t\t status = 0;\n-          for (sample = 0; (sample < spp) && (sample < MAX_SAMPLES); sample++)\n-            {\n-            tbuff = srcbuffs[sample];\n-            if (tbuff != NULL)\n-              _TIFFfree(tbuff);\n-            }\n-          return status;\n-\t  }\n-\t}\n-     /* Tiles on the right edge may be padded out to tw \n-      * which must be a multiple of 16.\n-      * Ncol represents the visible (non padding) portion.  \n-      */\n-      if (col + tw > imagewidth)\n-        ncol = imagewidth - col;\n-      else\n-        ncol = tw;\n-\n-      row_offset = row * (((imagewidth * spp * bps) + 7) / 8);\n-      col_offset = ((col * spp * bps) + 7) / 8;\n-      bufp = obuf + row_offset + col_offset;\n \n-      if ((bps % 8) == 0)\n-        {\n-        if (combineSeparateTileSamplesBytes(srcbuffs, bufp, ncol, nrow, imagewidth,\n-\t\t\t\t\t    tw, spp, bps, NULL, 0, 0))\n-\t  {\n-          status = 0;\n-          break;\n-      \t  }\n-\t}\n-      else\n+    for (row = 0; row < imagelength; row += tl)\n+    {\n+        nrow = (row + tl > imagelength) ? imagelength - row : tl;\n+        for (col = 0; col < imagewidth; col += tw)\n         {\n-        bytes_per_pixel  = ((bps * spp) + 7) / 8;\n-        if (bytes_per_pixel < (bytes_per_sample + 1))\n-          shift_width = bytes_per_pixel;\n-        else\n-          shift_width = bytes_per_sample + 1;\n-\n-        switch (shift_width)\n-          {\n-          case 1: if (combineSeparateTileSamples8bits (srcbuffs, bufp, ncol, nrow,\n-                                                       imagewidth, tw, spp, bps, \n-\t\t\t\t\t\t       NULL, 0, 0))\n-\t            {\n+            for (s = 0; s < spp; s++)\n+            {  \n+                /* Read each plane of a tile set into srcbuffs[s], adding error checks */\n+                tbytes = TIFFReadTile(in, srcbuffs[s], col, row, 0, s);\n+                if (tbytes == (tsize_t)-1 || tbytes == 0)\n+                {\n+                    TIFFError(TIFFFileName(in),\n+                               "Error, can\'t read tile for row %lu col %lu, "\n+                               "sample %lu",\n+                               (unsigned long) col, (unsigned long) row,\n+                               (unsigned long) s);\n                     status = 0;\n                     break;\n-      \t            }\n-\t          break;\n-          case 2: if (combineSeparateTileSamples16bits (srcbuffs, bufp, ncol, nrow,\n-                                                       imagewidth, tw, spp, bps, \n-\t\t\t\t\t\t       NULL, 0, 0))\n-\t            {\n+                }\n+            }\n+            if (status == 0) break;\n+\n+            if (col + tw > imagewidth)\n+                ncol = imagewidth - col;\n+            else\n+                ncol = tw;\n+\n+            row_offset = row * (((imagewidth * spp * bps) + 7) / 8);\n+            col_offset = ((col * spp * bps) + 7) / 8;\n+            bufp = obuf + row_offset + col_offset;\n+\n+            if ((bps % 8) == 0)\n+            {\n+                if (combineSeparateTileSamplesBytes(srcbuffs, bufp, ncol, nrow, imagewidth,\n+                                                     tw, spp, bps, NULL, 0, 0))\n+                {\n                     status = 0;\n                     break;\n-\t\t    }\n-\t          break;\n-          case 3: if (combineSeparateTileSamples24bits (srcbuffs, bufp, ncol, nrow,\n-                                                       imagewidth, tw, spp, bps, \n-\t\t\t\t\t\t       NULL, 0, 0))\n-\t            {\n-                    status = 0;\n+                }\n+            }\n+            else\n+            {\n+                bytes_per_pixel  = ((bps * spp) + 7) / 8;\n+                if (bytes_per_pixel < (bytes_per_sample + 1))\n+                    shift_width = bytes_per_pixel;\n+                else\n+                    shift_width = bytes_per_sample + 1;\n+\n+                switch (shift_width)\n+                {\n+                case 1: if (combineSeparateTileSamples8bits(srcbuffs, bufp, ncol, nrow,\n+                                                             imagewidth, tw, spp, bps, \n+                                                             NULL, 0, 0))\n+                    {\n+                        status = 0;\n+                        break;\n+                    }\n                     break;\n-       \t            }\n-                  break;\n-          case 4: \n-          case 5:\n-          case 6:\n-          case 7:\n-          case 8: if (combineSeparateTileSamples32bits (srcbuffs, bufp, ncol, nrow,\n-                                                       imagewidth, tw, spp, bps, \n-\t\t\t\t\t\t       NULL, 0, 0))\n-\t            {\n-                    status = 0;\n+                case 2: if (combineSeparateTileSamples16bits(srcbuffs, bufp, ncol, nrow,\n+                                                             imagewidth, tw, spp, bps, \n+                                                             NULL, 0, 0))\n+                    {\n+                        status = 0;\n+                        break;\n+                    }\n+                    break;\n+                case 3: if (combineSeparateTileSamples24bits(srcbuffs, bufp, ncol, nrow,\n+                                                             imagewidth, tw, spp, bps, \n+                                                             NULL, 0, 0))\n+                    {\n+                        status = 0;\n+                        break;\n+                    }\n                     break;\n-\t\t    }\n-\t          break;\n-          default: TIFFError ("readSeparateTilesIntoBuffer", "Unsupported bit depth: %d", bps);\n-                  status = 0;\n-                  break;\n-          }\n+                case 4: \n+                case 5:\n+                case 6:\n+                case 7:\n+                case 8: if (combineSeparateTileSamples32bits(srcbuffs, bufp, ncol, nrow,\n+                                                             imagewidth, tw, spp, bps, \n+                                                             NULL, 0, 0))\n+                    {\n+                        status = 0;\n+                        break;\n+                    }\n+                    break;\n+                default: TIFFError ("readSeparateTilesIntoBuffer", "Unsupported bit depth: %d", bps);\n+                         status = 0;\n+                         break;\n+                }\n+            }\n+            if (status == 0) break;\n         }\n-      }\n+        if (status == 0) break;\n     }\n \n-  for (sample = 0; (sample < spp) && (sample < MAX_SAMPLES); sample++)\n+    for (sample = 0; (sample < spp) && (sample < MAX_SAMPLES); sample++)\n     {\n-    tbuff = srcbuffs[sample];\n-    if (tbuff != NULL)\n-      _TIFFfree(tbuff);\n+        tbuff = srcbuffs[sample];\n+        if (tbuff != NULL)\n+            _TIFFfree(tbuff);\n     }\n- \n-  return status;\n-  }\n+\n+    return status;\n+}\n+\n \n static int writeBufferToContigStrips(TIFF* out, uint8* buf, uint32 imagelength)\n   {\n', 'id': 7, 'location': '/data/vulnloc/libtiff/CVE-2016-5321/src/tools/tiffcrop.c:994:11'}, {'diff': '@@ -948,6 +948,7 @@\n   return status;\n   }\n \n+\n static int  readSeparateTilesIntoBuffer (TIFF* in, uint8 *obuf, \n \t\t\t\t\t uint32 imagelength, uint32 imagewidth, \n                                          uint32 tw, uint32 tl,\n@@ -991,24 +992,15 @@\n       {\n       for (s = 0; s < spp; s++)\n         {  /* Read each plane of a tile set into srcbuffs[s] */\n-\ttbytes = TIFFReadTile(in, srcbuffs[s], col, row, 0, s);\n-        if (tbytes < 0  && !ignore)\n-          {\n+\tif (!(tbytes = TIFFReadTile(in, srcbuffs[s], col, row, 0, s))) {\n \t  TIFFError(TIFFFileName(in),\n                  "Error, can\'t read tile for row %lu col %lu, "\n \t\t "sample %lu",\n \t\t (unsigned long) col, (unsigned long) row,\n \t\t (unsigned long) s);\n-\t\t status = 0;\n-          for (sample = 0; (sample < spp) && (sample < MAX_SAMPLES); sample++)\n-            {\n-            tbuff = srcbuffs[sample];\n-            if (tbuff != NULL)\n-              _TIFFfree(tbuff);\n-            }\n-          return status;\n-\t  }\n-\t}\n+\t  status = 0;\n+        }\n+        }\n      /* Tiles on the right edge may be padded out to tw \n       * which must be a multiple of 16.\n       * Ncol represents the visible (non padding) portion.  \n@@ -1095,6 +1087,7 @@\n   return status;\n   }\n \n+\n static int writeBufferToContigStrips(TIFF* out, uint8* buf, uint32 imagelength)\n   {\n   uint32 row, nrows, rowsperstrip;\n', 'id': 8, 'location': '/data/vulnloc/libtiff/CVE-2016-5321/src/tools/tiffcrop.c:994:11'}, {'diff': '@@ -948,152 +948,154 @@\n   return status;\n   }\n \n-static int  readSeparateTilesIntoBuffer (TIFF* in, uint8 *obuf, \n-\t\t\t\t\t uint32 imagelength, uint32 imagewidth, \n-                                         uint32 tw, uint32 tl,\n-                                         uint16 spp, uint16 bps)\n-  {\n-  int     i, status = 1, sample;\n-  int     shift_width, bytes_per_pixel;\n-  uint16  bytes_per_sample;\n-  uint32  row, col;     /* Current row and col of image */\n-  uint32  nrow, ncol;   /* Number of rows and cols in current tile */\n-  uint32  row_offset, col_offset; /* Output buffer offsets */\n-  tsize_t tbytes = 0, tilesize = TIFFTileSize(in);\n-  tsample_t s;\n-  uint8*  bufp = (uint8*)obuf;\n-  unsigned char *srcbuffs[MAX_SAMPLES];\n-  unsigned char *tbuff = NULL;\n \n-  bytes_per_sample = (bps + 7) / 8;\n+static int readSeparateTilesIntoBuffer(TIFF* in, uint8 *obuf, \n+                                       uint32 imagelength, uint32 imagewidth, \n+                                       uint32 tw, uint32 tl,\n+                                       uint16 spp, uint16 bps)\n+{\n+    int i, status = 1, sample;\n+    int shift_width, bytes_per_pixel;\n+    uint16 bytes_per_sample;\n+    uint32 row, col;     /* Current row and col of image */\n+    uint32 nrow, ncol;   /* Number of rows and cols in current tile */\n+    uint32 row_offset, col_offset; /* Output buffer offsets */\n+    tsize_t tbytes = 0, tilesize = TIFFTileSize(in);\n+    tsample_t s;\n+    uint8* bufp = (uint8*)obuf;\n+    unsigned char *srcbuffs[MAX_SAMPLES];\n+    unsigned char *tbuff = NULL;\n \n-  for (sample = 0; (sample < spp) && (sample < MAX_SAMPLES); sample++)\n-    {\n-    srcbuffs[sample] = NULL;\n-    tbuff = (unsigned char *)_TIFFmalloc(tilesize + 8);\n-    if (!tbuff)\n-      {\n-      TIFFError ("readSeparateTilesIntoBuffer", \n-                 "Unable to allocate tile read buffer for sample %d", sample);\n-      for (i = 0; i < sample; i++)\n-        _TIFFfree (srcbuffs[i]);\n-      return 0;\n-      }\n-    srcbuffs[sample] = tbuff;\n-    } \n-  /* Each tile contains only the data for a single plane\n-   * arranged in scanlines of tw * bytes_per_sample bytes.\n-   */\n-  for (row = 0; row < imagelength; row += tl)\n-    {\n-    nrow = (row + tl > imagelength) ? imagelength - row : tl;\n-    for (col = 0; col < imagewidth; col += tw)\n-      {\n-      for (s = 0; s < spp; s++)\n-        {  /* Read each plane of a tile set into srcbuffs[s] */\n-\ttbytes = TIFFReadTile(in, srcbuffs[s], col, row, 0, s);\n-        if (tbytes < 0  && !ignore)\n-          {\n-\t  TIFFError(TIFFFileName(in),\n-                 "Error, can\'t read tile for row %lu col %lu, "\n-\t\t "sample %lu",\n-\t\t (unsigned long) col, (unsigned long) row,\n-\t\t (unsigned long) s);\n-\t\t status = 0;\n-          for (sample = 0; (sample < spp) && (sample < MAX_SAMPLES); sample++)\n-            {\n-            tbuff = srcbuffs[sample];\n-            if (tbuff != NULL)\n-              _TIFFfree(tbuff);\n-            }\n-          return status;\n-\t  }\n-\t}\n-     /* Tiles on the right edge may be padded out to tw \n-      * which must be a multiple of 16.\n-      * Ncol represents the visible (non padding) portion.  \n-      */\n-      if (col + tw > imagewidth)\n-        ncol = imagewidth - col;\n-      else\n-        ncol = tw;\n-\n-      row_offset = row * (((imagewidth * spp * bps) + 7) / 8);\n-      col_offset = ((col * spp * bps) + 7) / 8;\n-      bufp = obuf + row_offset + col_offset;\n+    bytes_per_sample = (bps + 7) / 8;\n \n-      if ((bps % 8) == 0)\n+    for (sample = 0; (sample < spp) && (sample < MAX_SAMPLES); sample++)\n+    {\n+        srcbuffs[sample] = NULL;\n+        tbuff = (unsigned char *)_TIFFmalloc(tilesize + 8);\n+        if (!tbuff)\n         {\n-        if (combineSeparateTileSamplesBytes(srcbuffs, bufp, ncol, nrow, imagewidth,\n-\t\t\t\t\t    tw, spp, bps, NULL, 0, 0))\n-\t  {\n-          status = 0;\n-          break;\n-      \t  }\n-\t}\n-      else\n+            TIFFError("readSeparateTilesIntoBuffer", \n+                       "Unable to allocate tile read buffer for sample %d", sample);\n+            for (i = 0; i < sample; i++)\n+                _TIFFfree(srcbuffs[i]);\n+            return 0;\n+        }\n+        srcbuffs[sample] = tbuff;\n+    }\n+    /* Each tile contains only the data for a single plane\n+     * arranged in scanlines of tw * bytes_per_sample bytes.\n+     */\n+    for (row = 0; row < imagelength; row += tl)\n+    {\n+        nrow = (row + tl > imagelength) ? imagelength - row : tl;\n+        for (col = 0; col < imagewidth; col += tw)\n         {\n-        bytes_per_pixel  = ((bps * spp) + 7) / 8;\n-        if (bytes_per_pixel < (bytes_per_sample + 1))\n-          shift_width = bytes_per_pixel;\n-        else\n-          shift_width = bytes_per_sample + 1;\n-\n-        switch (shift_width)\n-          {\n-          case 1: if (combineSeparateTileSamples8bits (srcbuffs, bufp, ncol, nrow,\n-                                                       imagewidth, tw, spp, bps, \n-\t\t\t\t\t\t       NULL, 0, 0))\n-\t            {\n-                    status = 0;\n-                    break;\n-      \t            }\n-\t          break;\n-          case 2: if (combineSeparateTileSamples16bits (srcbuffs, bufp, ncol, nrow,\n-                                                       imagewidth, tw, spp, bps, \n-\t\t\t\t\t\t       NULL, 0, 0))\n-\t            {\n-                    status = 0;\n-                    break;\n-\t\t    }\n-\t          break;\n-          case 3: if (combineSeparateTileSamples24bits (srcbuffs, bufp, ncol, nrow,\n-                                                       imagewidth, tw, spp, bps, \n-\t\t\t\t\t\t       NULL, 0, 0))\n-\t            {\n+            for (s = 0; s < spp; s++)\n+            {  \n+                tbytes = TIFFReadTile(in, srcbuffs[s], col, row, 0, s);\n+                if (tbytes == (tsize_t)-1 && !ignore)\n+                {\n+                    TIFFError(TIFFFileName(in),\n+                               "Error, can\'t read tile for row %lu col %lu, "\n+                               "sample %lu",\n+                               (unsigned long)col, (unsigned long)row,\n+                               (unsigned long)s);\n                     status = 0;\n-                    break;\n-       \t            }\n-                  break;\n-          case 4: \n-          case 5:\n-          case 6:\n-          case 7:\n-          case 8: if (combineSeparateTileSamples32bits (srcbuffs, bufp, ncol, nrow,\n-                                                       imagewidth, tw, spp, bps, \n-\t\t\t\t\t\t       NULL, 0, 0))\n-\t            {\n+                    for (sample = 0; (sample < spp) && (sample < MAX_SAMPLES); sample++)\n+                    {\n+                        tbuff = srcbuffs[sample];\n+                        if (tbuff != NULL)\n+                            _TIFFfree(tbuff);\n+                    }\n+                    return status;\n+                }\n+            }\n+            /* Tiles on the right edge may be padded out to tw \n+             * which must be a multiple of 16.\n+             * Ncol represents the visible (non padding) portion.  \n+             */\n+            if (col + tw > imagewidth)\n+                ncol = imagewidth - col;\n+            else\n+                ncol = tw;\n+\n+            row_offset = row * (((imagewidth * spp * bps) + 7) / 8);\n+            col_offset = ((col * spp * bps) + 7) / 8;\n+            bufp = obuf + row_offset + col_offset;\n+\n+            if ((bps % 8) == 0)\n+            {\n+                if (combineSeparateTileSamplesBytes(srcbuffs, bufp, ncol, nrow, imagewidth,\n+                                                    tw, spp, bps, NULL, 0, 0))\n+                {\n                     status = 0;\n                     break;\n-\t\t    }\n-\t          break;\n-          default: TIFFError ("readSeparateTilesIntoBuffer", "Unsupported bit depth: %d", bps);\n-                  status = 0;\n-                  break;\n-          }\n+                }\n+            }\n+            else\n+            {\n+                bytes_per_pixel = ((bps * spp) + 7) / 8;\n+                if (bytes_per_pixel < (bytes_per_sample + 1))\n+                    shift_width = bytes_per_pixel;\n+                else\n+                    shift_width = bytes_per_sample + 1;\n+\n+                switch (shift_width)\n+                {\n+                    case 1: if (combineSeparateTileSamples8bits (srcbuffs, bufp, ncol, nrow,\n+                                                                 imagewidth, tw, spp, bps, \n+                                                                 NULL, 0, 0))\n+                        {\n+                            status = 0;\n+                            break;\n+                        }\n+                        break;\n+                    case 2: if (combineSeparateTileSamples16bits (srcbuffs, bufp, ncol, nrow,\n+                                                                 imagewidth, tw, spp, bps, \n+                                                                 NULL, 0, 0))\n+                        {\n+                            status = 0;\n+                            break;\n+                        }\n+                        break;\n+                    case 3: if (combineSeparateTileSamples24bits (srcbuffs, bufp, ncol, nrow,\n+                                                                 imagewidth, tw, spp, bps, \n+                                                                 NULL, 0, 0))\n+                        {\n+                            status = 0;\n+                            break;\n+                        }\n+                        break;\n+                    case 4: \n+                    case 5:\n+                    case 6:\n+                    case 7:\n+                    case 8: if (combineSeparateTileSamples32bits (srcbuffs, bufp, ncol, nrow,\n+                                                                 imagewidth, tw, spp, bps, \n+                                                                 NULL, 0, 0))\n+                        {\n+                            status = 0;\n+                            break;\n+                        }\n+                        break;\n+                    default: TIFFError("readSeparateTilesIntoBuffer", "Unsupported bit depth: %d", bps);\n+                             status = 0;\n+                             break;\n+                }\n+            }\n         }\n-      }\n     }\n \n-  for (sample = 0; (sample < spp) && (sample < MAX_SAMPLES); sample++)\n+    for (sample = 0; (sample < spp) && (sample < MAX_SAMPLES); sample++)\n     {\n-    tbuff = srcbuffs[sample];\n-    if (tbuff != NULL)\n-      _TIFFfree(tbuff);\n+        tbuff = srcbuffs[sample];\n+        if (tbuff != NULL)\n+            _TIFFfree(tbuff);\n     }\n- \n-  return status;\n-  }\n+\n+    return status;\n+}\n+\n \n static int writeBufferToContigStrips(TIFF* out, uint8* buf, uint32 imagelength)\n   {\n', 'id': 9, 'location': '/data/vulnloc/libtiff/CVE-2016-5321/src/tools/tiffcrop.c:994:11'}, {'diff': '@@ -948,11 +948,12 @@\n   return status;\n   }\n \n-static int  readSeparateTilesIntoBuffer (TIFF* in, uint8 *obuf, \n-\t\t\t\t\t uint32 imagelength, uint32 imagewidth, \n-                                         uint32 tw, uint32 tl,\n-                                         uint16 spp, uint16 bps)\n-  {\n+\n+static int readSeparateTilesIntoBuffer (TIFF* in, uint8 *obuf, \n+                                        uint32 imagelength, uint32 imagewidth, \n+                                        uint32 tw, uint32 tl,\n+                                        uint16 spp, uint16 bps)\n+{\n   int     i, status = 1, sample;\n   int     shift_width, bytes_per_pixel;\n   uint16  bytes_per_sample;\n@@ -968,51 +969,53 @@\n   bytes_per_sample = (bps + 7) / 8;\n \n   for (sample = 0; (sample < spp) && (sample < MAX_SAMPLES); sample++)\n-    {\n+  {\n     srcbuffs[sample] = NULL;\n     tbuff = (unsigned char *)_TIFFmalloc(tilesize + 8);\n     if (!tbuff)\n-      {\n+    {\n       TIFFError ("readSeparateTilesIntoBuffer", \n                  "Unable to allocate tile read buffer for sample %d", sample);\n       for (i = 0; i < sample; i++)\n         _TIFFfree (srcbuffs[i]);\n       return 0;\n-      }\n+    }\n     srcbuffs[sample] = tbuff;\n-    } \n+  } \n   /* Each tile contains only the data for a single plane\n    * arranged in scanlines of tw * bytes_per_sample bytes.\n    */\n   for (row = 0; row < imagelength; row += tl)\n-    {\n+  {\n     nrow = (row + tl > imagelength) ? imagelength - row : tl;\n     for (col = 0; col < imagewidth; col += tw)\n-      {\n+    {\n       for (s = 0; s < spp; s++)\n-        {  /* Read each plane of a tile set into srcbuffs[s] */\n-\ttbytes = TIFFReadTile(in, srcbuffs[s], col, row, 0, s);\n-        if (tbytes < 0  && !ignore)\n-          {\n-\t  TIFFError(TIFFFileName(in),\n-                 "Error, can\'t read tile for row %lu col %lu, "\n-\t\t "sample %lu",\n-\t\t (unsigned long) col, (unsigned long) row,\n-\t\t (unsigned long) s);\n-\t\t status = 0;\n+      {  /* Read each plane of a tile set into srcbuffs[s] */\n+        tbytes = TIFFReadTile(in, srcbuffs[s], col, row, 0, s);\n+        if (tbytes < 0)\n+        {\n+          if (!ignore) {\n+            TIFFError(TIFFFileName(in),\n+                       "Error, can\'t read tile for row %lu col %lu, "\n+                       "sample %lu",\n+                       (unsigned long) col, (unsigned long) row,\n+                       (unsigned long) s);\n+            status = 0;\n+          }\n           for (sample = 0; (sample < spp) && (sample < MAX_SAMPLES); sample++)\n-            {\n+          {\n             tbuff = srcbuffs[sample];\n             if (tbuff != NULL)\n               _TIFFfree(tbuff);\n-            }\n+          }\n           return status;\n-\t  }\n-\t}\n-     /* Tiles on the right edge may be padded out to tw \n-      * which must be a multiple of 16.\n-      * Ncol represents the visible (non padding) portion.  \n-      */\n+        }\n+      }\n+      /* Tiles on the right edge may be padded out to tw \n+       * which must be a multiple of 16.\n+       * Ncol represents the visible (non padding) portion.  \n+       */\n       if (col + tw > imagewidth)\n         ncol = imagewidth - col;\n       else\n@@ -1023,16 +1026,16 @@\n       bufp = obuf + row_offset + col_offset;\n \n       if ((bps % 8) == 0)\n-        {\n+      {\n         if (combineSeparateTileSamplesBytes(srcbuffs, bufp, ncol, nrow, imagewidth,\n-\t\t\t\t\t    tw, spp, bps, NULL, 0, 0))\n-\t  {\n+                                             tw, spp, bps, NULL, 0, 0))\n+        {\n           status = 0;\n           break;\n-      \t  }\n-\t}\n+        }\n+      }\n       else\n-        {\n+      {\n         bytes_per_pixel  = ((bps * spp) + 7) / 8;\n         if (bytes_per_pixel < (bytes_per_sample + 1))\n           shift_width = bytes_per_pixel;\n@@ -1040,61 +1043,62 @@\n           shift_width = bytes_per_sample + 1;\n \n         switch (shift_width)\n-          {\n+        {\n           case 1: if (combineSeparateTileSamples8bits (srcbuffs, bufp, ncol, nrow,\n                                                        imagewidth, tw, spp, bps, \n-\t\t\t\t\t\t       NULL, 0, 0))\n-\t            {\n-                    status = 0;\n-                    break;\n-      \t            }\n-\t          break;\n+                                                       NULL, 0, 0))\n+            {\n+              status = 0;\n+              break;\n+            }\n+            break;\n           case 2: if (combineSeparateTileSamples16bits (srcbuffs, bufp, ncol, nrow,\n                                                        imagewidth, tw, spp, bps, \n-\t\t\t\t\t\t       NULL, 0, 0))\n-\t            {\n-                    status = 0;\n-                    break;\n-\t\t    }\n-\t          break;\n+                                                       NULL, 0, 0))\n+            {\n+              status = 0;\n+              break;\n+            }\n+            break;\n           case 3: if (combineSeparateTileSamples24bits (srcbuffs, bufp, ncol, nrow,\n                                                        imagewidth, tw, spp, bps, \n-\t\t\t\t\t\t       NULL, 0, 0))\n-\t            {\n-                    status = 0;\n-                    break;\n-       \t            }\n-                  break;\n+                                                       NULL, 0, 0))\n+            {\n+              status = 0;\n+              break;\n+            }\n+            break;\n           case 4: \n           case 5:\n           case 6:\n           case 7:\n           case 8: if (combineSeparateTileSamples32bits (srcbuffs, bufp, ncol, nrow,\n                                                        imagewidth, tw, spp, bps, \n-\t\t\t\t\t\t       NULL, 0, 0))\n-\t            {\n-                    status = 0;\n-                    break;\n-\t\t    }\n-\t          break;\n+                                                       NULL, 0, 0))\n+            {\n+              status = 0;\n+              break;\n+            }\n+            break;\n           default: TIFFError ("readSeparateTilesIntoBuffer", "Unsupported bit depth: %d", bps);\n                   status = 0;\n                   break;\n-          }\n         }\n       }\n     }\n+  }\n \n   for (sample = 0; (sample < spp) && (sample < MAX_SAMPLES); sample++)\n-    {\n+  {\n     tbuff = srcbuffs[sample];\n     if (tbuff != NULL)\n       _TIFFfree(tbuff);\n-    }\n- \n-  return status;\n   }\n \n+  return status;\n+}\n+\n+\n static int writeBufferToContigStrips(TIFF* out, uint8* buf, uint32 imagelength)\n   {\n   uint32 row, nrows, rowsperstrip;\n', 'id': 10, 'location': '/data/vulnloc/libtiff/CVE-2016-5321/src/tools/tiffcrop.c:995:9'}, {'diff': '@@ -948,152 +948,161 @@\n   return status;\n   }\n \n-static int  readSeparateTilesIntoBuffer (TIFF* in, uint8 *obuf, \n-\t\t\t\t\t uint32 imagelength, uint32 imagewidth, \n-                                         uint32 tw, uint32 tl,\n-                                         uint16 spp, uint16 bps)\n-  {\n-  int     i, status = 1, sample;\n-  int     shift_width, bytes_per_pixel;\n-  uint16  bytes_per_sample;\n-  uint32  row, col;     /* Current row and col of image */\n-  uint32  nrow, ncol;   /* Number of rows and cols in current tile */\n-  uint32  row_offset, col_offset; /* Output buffer offsets */\n-  tsize_t tbytes = 0, tilesize = TIFFTileSize(in);\n-  tsample_t s;\n-  uint8*  bufp = (uint8*)obuf;\n-  unsigned char *srcbuffs[MAX_SAMPLES];\n-  unsigned char *tbuff = NULL;\n \n-  bytes_per_sample = (bps + 7) / 8;\n+static int readSeparateTilesIntoBuffer(TIFF* in, uint8 *obuf, \n+                                        uint32 imagelength, uint32 imagewidth, \n+                                        uint32 tw, uint32 tl,\n+                                        uint16 spp, uint16 bps)\n+{\n+    int i, status = 1, sample;\n+    int shift_width, bytes_per_pixel;\n+    uint16 bytes_per_sample;\n+    uint32 row, col;     /* Current row and col of image */\n+    uint32 nrow, ncol;   /* Number of rows and cols in current tile */\n+    uint32 row_offset, col_offset; /* Output buffer offsets */\n+    tsize_t tbytes = 0, tilesize = TIFFTileSize(in);\n+    tsample_t s;\n+    uint8* bufp = (uint8*)obuf;\n+    unsigned char *srcbuffs[MAX_SAMPLES];\n+    unsigned char *tbuff = NULL;\n+\n+    bytes_per_sample = (bps + 7) / 8;\n \n-  for (sample = 0; (sample < spp) && (sample < MAX_SAMPLES); sample++)\n+    for (sample = 0; (sample < spp) && (sample < MAX_SAMPLES); sample++)\n     {\n-    srcbuffs[sample] = NULL;\n-    tbuff = (unsigned char *)_TIFFmalloc(tilesize + 8);\n-    if (!tbuff)\n-      {\n-      TIFFError ("readSeparateTilesIntoBuffer", \n-                 "Unable to allocate tile read buffer for sample %d", sample);\n-      for (i = 0; i < sample; i++)\n-        _TIFFfree (srcbuffs[i]);\n-      return 0;\n-      }\n-    srcbuffs[sample] = tbuff;\n+        srcbuffs[sample] = NULL;\n+        tbuff = (unsigned char *)_TIFFmalloc(tilesize + 8);\n+        if (!tbuff)\n+        {\n+            TIFFError ("readSeparateTilesIntoBuffer", \n+                        "Unable to allocate tile read buffer for sample %d", sample);\n+            for (i = 0; i < sample; i++)\n+                _TIFFfree(srcbuffs[i]);\n+            return 0;\n+        }\n+        srcbuffs[sample] = tbuff;\n     } \n-  /* Each tile contains only the data for a single plane\n-   * arranged in scanlines of tw * bytes_per_sample bytes.\n-   */\n-  for (row = 0; row < imagelength; row += tl)\n+    /* Each tile contains only the data for a single plane\n+       arranged in scanlines of tw * bytes_per_sample bytes.\n+    */\n+    for (row = 0; row < imagelength; row += tl)\n     {\n-    nrow = (row + tl > imagelength) ? imagelength - row : tl;\n-    for (col = 0; col < imagewidth; col += tw)\n-      {\n-      for (s = 0; s < spp; s++)\n-        {  /* Read each plane of a tile set into srcbuffs[s] */\n-\ttbytes = TIFFReadTile(in, srcbuffs[s], col, row, 0, s);\n-        if (tbytes < 0  && !ignore)\n-          {\n-\t  TIFFError(TIFFFileName(in),\n-                 "Error, can\'t read tile for row %lu col %lu, "\n-\t\t "sample %lu",\n-\t\t (unsigned long) col, (unsigned long) row,\n-\t\t (unsigned long) s);\n-\t\t status = 0;\n-          for (sample = 0; (sample < spp) && (sample < MAX_SAMPLES); sample++)\n-            {\n-            tbuff = srcbuffs[sample];\n-            if (tbuff != NULL)\n-              _TIFFfree(tbuff);\n+        nrow = (row + tl > imagelength) ? imagelength - row : tl;\n+        for (col = 0; col < imagewidth; col += tw)\n+        {\n+            for (s = 0; s < spp; s++)\n+            {  /* Read each plane of a tile set into srcbuffs[s] */\n+                tbytes = TIFFReadTile(in, srcbuffs[s], col, row, 0, s);\n+                if (tbytes < 0)\n+                {\n+                    if (!ignore)\n+                    {\n+                        TIFFError(TIFFFileName(in),\n+                                  "Error, can\'t read tile for row %lu col %lu, "\n+                                  "sample %lu",\n+                                  (unsigned long) col, (unsigned long) row,\n+                                  (unsigned long) s);\n+                        status = 0;\n+                    }\n+                    else\n+                    {\n+                        // Handle the scenario where reading a tile is ignored\n+                        // An update to handle `ignore` variable appropriately\n+                        continue; // Skip further processing for this tile/sample\n+                    }\n+                }\n             }\n-          return status;\n-\t  }\n-\t}\n-     /* Tiles on the right edge may be padded out to tw \n-      * which must be a multiple of 16.\n-      * Ncol represents the visible (non padding) portion.  \n-      */\n-      if (col + tw > imagewidth)\n-        ncol = imagewidth - col;\n-      else\n-        ncol = tw;\n-\n-      row_offset = row * (((imagewidth * spp * bps) + 7) / 8);\n-      col_offset = ((col * spp * bps) + 7) / 8;\n-      bufp = obuf + row_offset + col_offset;\n+            /* Tiles on the right edge may be padded out to tw \n+               which must be a multiple of 16.\n+               Ncol represents the visible (non padding) portion.  \n+            */\n+            if (col + tw > imagewidth)\n+                ncol = imagewidth - col;\n+            else\n+                ncol = tw;\n+\n+            row_offset = row * (((imagewidth * spp * bps) + 7) / 8);\n+            col_offset = ((col * spp * bps) + 7) / 8;\n+            bufp = obuf + row_offset + col_offset;\n \n-      if ((bps % 8) == 0)\n-        {\n-        if (combineSeparateTileSamplesBytes(srcbuffs, bufp, ncol, nrow, imagewidth,\n-\t\t\t\t\t    tw, spp, bps, NULL, 0, 0))\n-\t  {\n-          status = 0;\n-          break;\n-      \t  }\n-\t}\n-      else\n-        {\n-        bytes_per_pixel  = ((bps * spp) + 7) / 8;\n-        if (bytes_per_pixel < (bytes_per_sample + 1))\n-          shift_width = bytes_per_pixel;\n-        else\n-          shift_width = bytes_per_sample + 1;\n-\n-        switch (shift_width)\n-          {\n-          case 1: if (combineSeparateTileSamples8bits (srcbuffs, bufp, ncol, nrow,\n-                                                       imagewidth, tw, spp, bps, \n-\t\t\t\t\t\t       NULL, 0, 0))\n-\t            {\n-                    status = 0;\n-                    break;\n-      \t            }\n-\t          break;\n-          case 2: if (combineSeparateTileSamples16bits (srcbuffs, bufp, ncol, nrow,\n-                                                       imagewidth, tw, spp, bps, \n-\t\t\t\t\t\t       NULL, 0, 0))\n-\t            {\n-                    status = 0;\n-                    break;\n-\t\t    }\n-\t          break;\n-          case 3: if (combineSeparateTileSamples24bits (srcbuffs, bufp, ncol, nrow,\n-                                                       imagewidth, tw, spp, bps, \n-\t\t\t\t\t\t       NULL, 0, 0))\n-\t            {\n-                    status = 0;\n-                    break;\n-       \t            }\n-                  break;\n-          case 4: \n-          case 5:\n-          case 6:\n-          case 7:\n-          case 8: if (combineSeparateTileSamples32bits (srcbuffs, bufp, ncol, nrow,\n-                                                       imagewidth, tw, spp, bps, \n-\t\t\t\t\t\t       NULL, 0, 0))\n-\t            {\n+            if ((bps % 8) == 0)\n+            {\n+                if (combineSeparateTileSamplesBytes(srcbuffs, bufp, ncol, nrow, imagewidth,\n+                                                    tw, spp, bps, NULL, 0, 0))\n+                {\n                     status = 0;\n                     break;\n-\t\t    }\n-\t          break;\n-          default: TIFFError ("readSeparateTilesIntoBuffer", "Unsupported bit depth: %d", bps);\n-                  status = 0;\n-                  break;\n-          }\n+                }\n+            }\n+            else\n+            {\n+                bytes_per_pixel  = ((bps * spp) + 7) / 8;\n+                if (bytes_per_pixel < (bytes_per_sample + 1))\n+                    shift_width = bytes_per_pixel;\n+                else\n+                    shift_width = bytes_per_sample + 1;\n+\n+                switch (shift_width)\n+                {\n+                    case 1: \n+                        if (combineSeparateTileSamples8bits(srcbuffs, bufp, ncol, nrow,\n+                                                            imagewidth, tw, spp, bps, \n+                                                            NULL, 0, 0))\n+                        {\n+                            status = 0;\n+                            break;\n+                        }\n+                        break;\n+                    case 2: \n+                        if (combineSeparateTileSamples16bits(srcbuffs, bufp, ncol, nrow,\n+                                                            imagewidth, tw, spp, bps, \n+                                                            NULL, 0, 0))\n+                        {\n+                            status = 0;\n+                            break;\n+                        }\n+                        break;\n+                    case 3: \n+                        if (combineSeparateTileSamples24bits(srcbuffs, bufp, ncol, nrow,\n+                                                            imagewidth, tw, spp, bps, \n+                                                            NULL, 0, 0))\n+                        {\n+                            status = 0;\n+                            break;\n+                        }\n+                        break;\n+                    case 4: \n+                    case 5:\n+                    case 6:\n+                    case 7:\n+                    case 8: \n+                        if (combineSeparateTileSamples32bits(srcbuffs, bufp, ncol, nrow,\n+                                                            imagewidth, tw, spp, bps, \n+                                                            NULL, 0, 0))\n+                        {\n+                            status = 0;\n+                            break;\n+                        }\n+                        break;\n+                    default:\n+                        TIFFError("readSeparateTilesIntoBuffer", "Unsupported bit depth: %d", bps);\n+                        status = 0;\n+                        break;\n+                }\n+            }\n         }\n-      }\n     }\n \n-  for (sample = 0; (sample < spp) && (sample < MAX_SAMPLES); sample++)\n+    for (sample = 0; (sample < spp) && (sample < MAX_SAMPLES); sample++)\n     {\n-    tbuff = srcbuffs[sample];\n-    if (tbuff != NULL)\n-      _TIFFfree(tbuff);\n+        tbuff = srcbuffs[sample];\n+        if (tbuff != NULL)\n+            _TIFFfree(tbuff);\n     }\n- \n-  return status;\n-  }\n+\n+    return status;\n+}\n+\n \n static int writeBufferToContigStrips(TIFF* out, uint8* buf, uint32 imagelength)\n   {\n', 'id': 11, 'location': '/data/vulnloc/libtiff/CVE-2016-5321/src/tools/tiffcrop.c:995:9'}, {'diff': '@@ -948,152 +948,150 @@\n   return status;\n   }\n \n-static int  readSeparateTilesIntoBuffer (TIFF* in, uint8 *obuf, \n-\t\t\t\t\t uint32 imagelength, uint32 imagewidth, \n-                                         uint32 tw, uint32 tl,\n-                                         uint16 spp, uint16 bps)\n-  {\n-  int     i, status = 1, sample;\n-  int     shift_width, bytes_per_pixel;\n-  uint16  bytes_per_sample;\n-  uint32  row, col;     /* Current row and col of image */\n-  uint32  nrow, ncol;   /* Number of rows and cols in current tile */\n-  uint32  row_offset, col_offset; /* Output buffer offsets */\n-  tsize_t tbytes = 0, tilesize = TIFFTileSize(in);\n-  tsample_t s;\n-  uint8*  bufp = (uint8*)obuf;\n-  unsigned char *srcbuffs[MAX_SAMPLES];\n-  unsigned char *tbuff = NULL;\n \n-  bytes_per_sample = (bps + 7) / 8;\n+static int readSeparateTilesIntoBuffer(TIFF* in, uint8 *obuf,\n+                                       uint32 imagelength, uint32 imagewidth,\n+                                       uint32 tw, uint32 tl,\n+                                       uint16 spp, uint16 bps)\n+{\n+    int i, status = 1, sample;\n+    int shift_width, bytes_per_pixel;\n+    uint16 bytes_per_sample;\n+    uint32 row, col; /* Current row and col of image */\n+    uint32 nrow, ncol; /* Number of rows and cols in current tile */\n+    uint32 row_offset, col_offset; /* Output buffer offsets */\n+    tsize_t tbytes = 0, tilesize = TIFFTileSize(in);\n+    tsample_t s;\n+    uint8* bufp = (uint8*)obuf;\n+    unsigned char *srcbuffs[MAX_SAMPLES];\n+    unsigned char *tbuff = NULL;\n+\n+    bytes_per_sample = (bps + 7) / 8;\n \n-  for (sample = 0; (sample < spp) && (sample < MAX_SAMPLES); sample++)\n+    for (sample = 0; (sample < spp) && (sample < MAX_SAMPLES); sample++)\n     {\n-    srcbuffs[sample] = NULL;\n-    tbuff = (unsigned char *)_TIFFmalloc(tilesize + 8);\n-    if (!tbuff)\n-      {\n-      TIFFError ("readSeparateTilesIntoBuffer", \n-                 "Unable to allocate tile read buffer for sample %d", sample);\n-      for (i = 0; i < sample; i++)\n-        _TIFFfree (srcbuffs[i]);\n-      return 0;\n-      }\n-    srcbuffs[sample] = tbuff;\n+        srcbuffs[sample] = NULL;\n+        tbuff = (unsigned char *)_TIFFmalloc(tilesize + 8);\n+        if (!tbuff)\n+        {\n+            TIFFError("readSeparateTilesIntoBuffer",\n+                       "Unable to allocate tile read buffer for sample %d", sample);\n+            for (i = 0; i < sample; i++)\n+                _TIFFfree(srcbuffs[i]);\n+            return 0;\n+        }\n+        srcbuffs[sample] = tbuff;\n     } \n-  /* Each tile contains only the data for a single plane\n-   * arranged in scanlines of tw * bytes_per_sample bytes.\n-   */\n-  for (row = 0; row < imagelength; row += tl)\n+    for (row = 0; row < imagelength; row += tl)\n     {\n-    nrow = (row + tl > imagelength) ? imagelength - row : tl;\n-    for (col = 0; col < imagewidth; col += tw)\n-      {\n-      for (s = 0; s < spp; s++)\n-        {  /* Read each plane of a tile set into srcbuffs[s] */\n-\ttbytes = TIFFReadTile(in, srcbuffs[s], col, row, 0, s);\n-        if (tbytes < 0  && !ignore)\n-          {\n-\t  TIFFError(TIFFFileName(in),\n-                 "Error, can\'t read tile for row %lu col %lu, "\n-\t\t "sample %lu",\n-\t\t (unsigned long) col, (unsigned long) row,\n-\t\t (unsigned long) s);\n-\t\t status = 0;\n-          for (sample = 0; (sample < spp) && (sample < MAX_SAMPLES); sample++)\n+        nrow = (row + tl > imagelength) ? imagelength - row : tl;\n+        for (col = 0; col < imagewidth; col += tw)\n+        {\n+            for (s = 0; s < spp; s++)\n             {\n-            tbuff = srcbuffs[sample];\n-            if (tbuff != NULL)\n-              _TIFFfree(tbuff);\n+                tbytes = TIFFReadTile(in, srcbuffs[s], col, row, 0, s);\n+                if (tbytes < 0)\n+                {\n+                    TIFFError(TIFFFileName(in),\n+                               "Error, can\'t read tile for row %lu col %lu, "\n+                               "sample %lu",\n+                               (unsigned long)col, (unsigned long)row,\n+                               (unsigned long)s);\n+                    status = 0;\n+                    break; // Exit the current sample loop\n+                }\n             }\n-          return status;\n-\t  }\n-\t}\n-     /* Tiles on the right edge may be padded out to tw \n-      * which must be a multiple of 16.\n-      * Ncol represents the visible (non padding) portion.  \n-      */\n-      if (col + tw > imagewidth)\n-        ncol = imagewidth - col;\n-      else\n-        ncol = tw;\n-\n-      row_offset = row * (((imagewidth * spp * bps) + 7) / 8);\n-      col_offset = ((col * spp * bps) + 7) / 8;\n-      bufp = obuf + row_offset + col_offset;\n+            if (status == 0) break; // Exit the current col loop if error occurred\n+            \n+            if (col + tw > imagewidth)\n+                ncol = imagewidth - col;\n+            else\n+                ncol = tw;\n+\n+            row_offset = row * (((imagewidth * spp * bps) + 7) / 8);\n+            col_offset = ((col * spp * bps) + 7) / 8;\n+            bufp = obuf + row_offset + col_offset;\n \n-      if ((bps % 8) == 0)\n-        {\n-        if (combineSeparateTileSamplesBytes(srcbuffs, bufp, ncol, nrow, imagewidth,\n-\t\t\t\t\t    tw, spp, bps, NULL, 0, 0))\n-\t  {\n-          status = 0;\n-          break;\n-      \t  }\n-\t}\n-      else\n-        {\n-        bytes_per_pixel  = ((bps * spp) + 7) / 8;\n-        if (bytes_per_pixel < (bytes_per_sample + 1))\n-          shift_width = bytes_per_pixel;\n-        else\n-          shift_width = bytes_per_sample + 1;\n-\n-        switch (shift_width)\n-          {\n-          case 1: if (combineSeparateTileSamples8bits (srcbuffs, bufp, ncol, nrow,\n-                                                       imagewidth, tw, spp, bps, \n-\t\t\t\t\t\t       NULL, 0, 0))\n-\t            {\n-                    status = 0;\n-                    break;\n-      \t            }\n-\t          break;\n-          case 2: if (combineSeparateTileSamples16bits (srcbuffs, bufp, ncol, nrow,\n-                                                       imagewidth, tw, spp, bps, \n-\t\t\t\t\t\t       NULL, 0, 0))\n-\t            {\n-                    status = 0;\n-                    break;\n-\t\t    }\n-\t          break;\n-          case 3: if (combineSeparateTileSamples24bits (srcbuffs, bufp, ncol, nrow,\n-                                                       imagewidth, tw, spp, bps, \n-\t\t\t\t\t\t       NULL, 0, 0))\n-\t            {\n-                    status = 0;\n-                    break;\n-       \t            }\n-                  break;\n-          case 4: \n-          case 5:\n-          case 6:\n-          case 7:\n-          case 8: if (combineSeparateTileSamples32bits (srcbuffs, bufp, ncol, nrow,\n-                                                       imagewidth, tw, spp, bps, \n-\t\t\t\t\t\t       NULL, 0, 0))\n-\t            {\n+            if ((bps % 8) == 0)\n+            {\n+                if (combineSeparateTileSamplesBytes(srcbuffs, bufp, ncol, nrow, imagewidth,\n+                                                     tw, spp, bps, NULL, 0, 0))\n+                {\n                     status = 0;\n                     break;\n-\t\t    }\n-\t          break;\n-          default: TIFFError ("readSeparateTilesIntoBuffer", "Unsupported bit depth: %d", bps);\n-                  status = 0;\n-                  break;\n-          }\n+                }\n+            }\n+            else\n+            {\n+                bytes_per_pixel  = ((bps * spp) + 7) / 8;\n+                if (bytes_per_pixel < (bytes_per_sample + 1))\n+                    shift_width = bytes_per_pixel;\n+                else\n+                    shift_width = bytes_per_sample + 1;\n+\n+                switch (shift_width)\n+                {\n+                    case 1: \n+                        if (combineSeparateTileSamples8bits(srcbuffs, bufp, ncol, nrow,\n+                                                            imagewidth, tw, spp, bps, \n+                                                            NULL, 0, 0))\n+                        {\n+                            status = 0;\n+                            break;\n+                        }\n+                        break;\n+                    case 2: \n+                        if (combineSeparateTileSamples16bits(srcbuffs, bufp, ncol, nrow,\n+                                                             imagewidth, tw, spp, bps, \n+                                                             NULL, 0, 0))\n+                        {\n+                            status = 0;\n+                            break;\n+                        }\n+                        break;\n+                    case 3: \n+                        if (combineSeparateTileSamples24bits(srcbuffs, bufp, ncol, nrow,\n+                                                             imagewidth, tw, spp, bps, \n+                                                             NULL, 0, 0))\n+                        {\n+                            status = 0;\n+                            break;\n+                        }\n+                        break;\n+                    case 4: \n+                    case 5:\n+                    case 6:\n+                    case 7:\n+                    case 8: \n+                        if (combineSeparateTileSamples32bits(srcbuffs, bufp, ncol, nrow,\n+                                                             imagewidth, tw, spp, bps, \n+                                                             NULL, 0, 0))\n+                        {\n+                            status = 0;\n+                            break;\n+                        }\n+                        break;\n+                    default: \n+                        TIFFError("readSeparateTilesIntoBuffer", "Unsupported bit depth: %d", bps);\n+                        status = 0;\n+                        break;\n+                }\n+            }\n+            if (status == 0) break; // Exit the current col loop if error occurred\n         }\n-      }\n+        if (status == 0) break; // Exit the row loop if error occurred\n     }\n \n-  for (sample = 0; (sample < spp) && (sample < MAX_SAMPLES); sample++)\n+    for (sample = 0; (sample < spp) && (sample < MAX_SAMPLES); sample++)\n     {\n-    tbuff = srcbuffs[sample];\n-    if (tbuff != NULL)\n-      _TIFFfree(tbuff);\n+        tbuff = srcbuffs[sample];\n+        if (tbuff != NULL)\n+            _TIFFfree(tbuff);\n     }\n- \n-  return status;\n-  }\n+\n+    return status;\n+}\n+\n \n static int writeBufferToContigStrips(TIFF* out, uint8* buf, uint32 imagelength)\n   {\n', 'id': 12, 'location': '/data/vulnloc/libtiff/CVE-2016-5321/src/tools/tiffcrop.c:995:9'}, {'diff': '@@ -948,11 +948,12 @@\n   return status;\n   }\n \n+\n static int  readSeparateTilesIntoBuffer (TIFF* in, uint8 *obuf, \n \t\t\t\t\t uint32 imagelength, uint32 imagewidth, \n                                          uint32 tw, uint32 tl,\n                                          uint16 spp, uint16 bps)\n-  {\n+{\n   int     i, status = 1, sample;\n   int     shift_width, bytes_per_pixel;\n   uint16  bytes_per_sample;\n@@ -968,51 +969,49 @@\n   bytes_per_sample = (bps + 7) / 8;\n \n   for (sample = 0; (sample < spp) && (sample < MAX_SAMPLES); sample++)\n-    {\n+  {\n     srcbuffs[sample] = NULL;\n     tbuff = (unsigned char *)_TIFFmalloc(tilesize + 8);\n     if (!tbuff)\n-      {\n+    {\n       TIFFError ("readSeparateTilesIntoBuffer", \n                  "Unable to allocate tile read buffer for sample %d", sample);\n       for (i = 0; i < sample; i++)\n         _TIFFfree (srcbuffs[i]);\n       return 0;\n-      }\n+    }\n     srcbuffs[sample] = tbuff;\n-    } \n+  } \n   /* Each tile contains only the data for a single plane\n    * arranged in scanlines of tw * bytes_per_sample bytes.\n    */\n   for (row = 0; row < imagelength; row += tl)\n-    {\n+  {\n     nrow = (row + tl > imagelength) ? imagelength - row : tl;\n     for (col = 0; col < imagewidth; col += tw)\n-      {\n+    {\n       for (s = 0; s < spp; s++)\n-        {  /* Read each plane of a tile set into srcbuffs[s] */\n-\ttbytes = TIFFReadTile(in, srcbuffs[s], col, row, 0, s);\n-        if (tbytes < 0  && !ignore)\n-          {\n-\t  TIFFError(TIFFFileName(in),\n+      {  /* Read each plane of a tile set into srcbuffs[s] */\n+        tbytes = TIFFReadTile(in, srcbuffs[s], col, row, 0, s);\n+        if (tbytes < 0)\n+        {\n+          TIFFError(TIFFFileName(in),\n                  "Error, can\'t read tile for row %lu col %lu, "\n-\t\t "sample %lu",\n-\t\t (unsigned long) col, (unsigned long) row,\n-\t\t (unsigned long) s);\n-\t\t status = 0;\n-          for (sample = 0; (sample < spp) && (sample < MAX_SAMPLES); sample++)\n-            {\n-            tbuff = srcbuffs[sample];\n-            if (tbuff != NULL)\n-              _TIFFfree(tbuff);\n-            }\n-          return status;\n-\t  }\n-\t}\n-     /* Tiles on the right edge may be padded out to tw \n-      * which must be a multiple of 16.\n-      * Ncol represents the visible (non padding) portion.  \n-      */\n+                 "sample %lu",\n+                 (unsigned long) col, (unsigned long) row,\n+                 (unsigned long) s);\n+          status = 0;\n+          break; // Exit the loop as reading failed for this tile\n+        }\n+      }\n+      if (status == 0) {\n+        break; // Exit outer loop if there was an error\n+      }\n+     \n+      /* Tiles on the right edge may be padded out to tw \n+       * which must be a multiple of 16.\n+       * Ncol represents the visible (non padding) portion.  \n+       */\n       if (col + tw > imagewidth)\n         ncol = imagewidth - col;\n       else\n@@ -1023,16 +1022,16 @@\n       bufp = obuf + row_offset + col_offset;\n \n       if ((bps % 8) == 0)\n-        {\n+      {\n         if (combineSeparateTileSamplesBytes(srcbuffs, bufp, ncol, nrow, imagewidth,\n \t\t\t\t\t    tw, spp, bps, NULL, 0, 0))\n-\t  {\n+        {\n           status = 0;\n           break;\n-      \t  }\n-\t}\n+        }\n+      }\n       else\n-        {\n+      {\n         bytes_per_pixel  = ((bps * spp) + 7) / 8;\n         if (bytes_per_pixel < (bytes_per_sample + 1))\n           shift_width = bytes_per_pixel;\n@@ -1040,60 +1039,69 @@\n           shift_width = bytes_per_sample + 1;\n \n         switch (shift_width)\n-          {\n-          case 1: if (combineSeparateTileSamples8bits (srcbuffs, bufp, ncol, nrow,\n-                                                       imagewidth, tw, spp, bps, \n-\t\t\t\t\t\t       NULL, 0, 0))\n-\t            {\n-                    status = 0;\n-                    break;\n-      \t            }\n-\t          break;\n-          case 2: if (combineSeparateTileSamples16bits (srcbuffs, bufp, ncol, nrow,\n-                                                       imagewidth, tw, spp, bps, \n-\t\t\t\t\t\t       NULL, 0, 0))\n-\t            {\n-                    status = 0;\n-                    break;\n-\t\t    }\n-\t          break;\n-          case 3: if (combineSeparateTileSamples24bits (srcbuffs, bufp, ncol, nrow,\n-                                                       imagewidth, tw, spp, bps, \n-\t\t\t\t\t\t       NULL, 0, 0))\n-\t            {\n-                    status = 0;\n-                    break;\n-       \t            }\n-                  break;\n+        {\n+          case 1: \n+            if (combineSeparateTileSamples8bits (srcbuffs, bufp, ncol, nrow,\n+                                                 imagewidth, tw, spp, bps, \n+\t\t\t\t\t\t NULL, 0, 0))\n+            {\n+              status = 0;\n+              break;\n+            }\n+            break;\n+          case 2: \n+            if (combineSeparateTileSamples16bits (srcbuffs, bufp, ncol, nrow,\n+                                                  imagewidth, tw, spp, bps, \n+                                                  NULL, 0, 0))\n+            {\n+              status = 0;\n+              break;\n+            }\n+            break;\n+          case 3: \n+            if (combineSeparateTileSamples24bits (srcbuffs, bufp, ncol, nrow,\n+                                                  imagewidth, tw, spp, bps, \n+                                                  NULL, 0, 0))\n+            {\n+              status = 0;\n+              break;\n+            }\n+            break;\n           case 4: \n           case 5:\n           case 6:\n           case 7:\n-          case 8: if (combineSeparateTileSamples32bits (srcbuffs, bufp, ncol, nrow,\n-                                                       imagewidth, tw, spp, bps, \n-\t\t\t\t\t\t       NULL, 0, 0))\n-\t            {\n-                    status = 0;\n-                    break;\n-\t\t    }\n-\t          break;\n-          default: TIFFError ("readSeparateTilesIntoBuffer", "Unsupported bit depth: %d", bps);\n-                  status = 0;\n-                  break;\n-          }\n+          case 8: \n+            if (combineSeparateTileSamples32bits (srcbuffs, bufp, ncol, nrow,\n+                                                  imagewidth, tw, spp, bps, \n+                                                  NULL, 0, 0))\n+            {\n+              status = 0;\n+              break;\n+            }\n+            break;\n+          default: \n+            TIFFError ("readSeparateTilesIntoBuffer", "Unsupported bit depth: %d", bps);\n+            status = 0;\n+            break;\n         }\n       }\n     }\n+    if (status == 0) {\n+      break; // Exit if there was an overall error\n+    }\n+  }\n \n   for (sample = 0; (sample < spp) && (sample < MAX_SAMPLES); sample++)\n-    {\n+  {\n     tbuff = srcbuffs[sample];\n     if (tbuff != NULL)\n       _TIFFfree(tbuff);\n-    }\n+  }\n  \n   return status;\n-  }\n+}\n+\n \n static int writeBufferToContigStrips(TIFF* out, uint8* buf, uint32 imagelength)\n   {\n', 'id': 13, 'location': '/data/vulnloc/libtiff/CVE-2016-5321/src/tools/tiffcrop.c:995:9'}, {'diff': '@@ -948,152 +948,162 @@\n   return status;\n   }\n \n-static int  readSeparateTilesIntoBuffer (TIFF* in, uint8 *obuf, \n-\t\t\t\t\t uint32 imagelength, uint32 imagewidth, \n-                                         uint32 tw, uint32 tl,\n-                                         uint16 spp, uint16 bps)\n-  {\n-  int     i, status = 1, sample;\n-  int     shift_width, bytes_per_pixel;\n-  uint16  bytes_per_sample;\n-  uint32  row, col;     /* Current row and col of image */\n-  uint32  nrow, ncol;   /* Number of rows and cols in current tile */\n-  uint32  row_offset, col_offset; /* Output buffer offsets */\n-  tsize_t tbytes = 0, tilesize = TIFFTileSize(in);\n-  tsample_t s;\n-  uint8*  bufp = (uint8*)obuf;\n-  unsigned char *srcbuffs[MAX_SAMPLES];\n-  unsigned char *tbuff = NULL;\n \n-  bytes_per_sample = (bps + 7) / 8;\n+static int readSeparateTilesIntoBuffer(TIFF* in, uint8 *obuf, \n+                                        uint32 imagelength, uint32 imagewidth, \n+                                        uint32 tw, uint32 tl,\n+                                        uint16 spp, uint16 bps)\n+{\n+    int i, status = 1, sample;\n+    int shift_width, bytes_per_pixel;\n+    uint16 bytes_per_sample;\n+    uint32 row, col;     /* Current row and col of image */\n+    uint32 nrow, ncol;   /* Number of rows and cols in current tile */\n+    uint32 row_offset, col_offset; /* Output buffer offsets */\n+    tsize_t tbytes = 0, tilesize = TIFFTileSize(in);\n+    tsample_t s;\n+    uint8* bufp = (uint8*)obuf;\n+    unsigned char *srcbuffs[MAX_SAMPLES];\n+    unsigned char *tbuff = NULL;\n+\n+    bytes_per_sample = (bps + 7) / 8;\n \n-  for (sample = 0; (sample < spp) && (sample < MAX_SAMPLES); sample++)\n+    for (sample = 0; (sample < spp) && (sample < MAX_SAMPLES); sample++)\n     {\n-    srcbuffs[sample] = NULL;\n-    tbuff = (unsigned char *)_TIFFmalloc(tilesize + 8);\n-    if (!tbuff)\n-      {\n-      TIFFError ("readSeparateTilesIntoBuffer", \n-                 "Unable to allocate tile read buffer for sample %d", sample);\n-      for (i = 0; i < sample; i++)\n-        _TIFFfree (srcbuffs[i]);\n-      return 0;\n-      }\n-    srcbuffs[sample] = tbuff;\n+        srcbuffs[sample] = NULL;\n+        tbuff = (unsigned char *)_TIFFmalloc(tilesize + 8);\n+        if (!tbuff)\n+        {\n+            TIFFError("readSeparateTilesIntoBuffer", \n+                       "Unable to allocate tile read buffer for sample %d", sample);\n+            for (i = 0; i < sample; i++)\n+                _TIFFfree(srcbuffs[i]);\n+            return 0;\n+        }\n+        srcbuffs[sample] = tbuff;\n     } \n-  /* Each tile contains only the data for a single plane\n-   * arranged in scanlines of tw * bytes_per_sample bytes.\n-   */\n-  for (row = 0; row < imagelength; row += tl)\n+    /* Each tile contains only the data for a single plane\n+     * arranged in scanlines of tw * bytes_per_sample bytes.\n+     */\n+    for (row = 0; row < imagelength; row += tl)\n     {\n-    nrow = (row + tl > imagelength) ? imagelength - row : tl;\n-    for (col = 0; col < imagewidth; col += tw)\n-      {\n-      for (s = 0; s < spp; s++)\n-        {  /* Read each plane of a tile set into srcbuffs[s] */\n-\ttbytes = TIFFReadTile(in, srcbuffs[s], col, row, 0, s);\n-        if (tbytes < 0  && !ignore)\n-          {\n-\t  TIFFError(TIFFFileName(in),\n-                 "Error, can\'t read tile for row %lu col %lu, "\n-\t\t "sample %lu",\n-\t\t (unsigned long) col, (unsigned long) row,\n-\t\t (unsigned long) s);\n-\t\t status = 0;\n-          for (sample = 0; (sample < spp) && (sample < MAX_SAMPLES); sample++)\n-            {\n-            tbuff = srcbuffs[sample];\n-            if (tbuff != NULL)\n-              _TIFFfree(tbuff);\n+        nrow = (row + tl > imagelength) ? imagelength - row : tl;\n+        for (col = 0; col < imagewidth; col += tw)\n+        {\n+            for (s = 0; s < spp; s++)\n+            {  /* Read each plane of a tile set into srcbuffs[s] */\n+                tbytes = TIFFReadTile(in, srcbuffs[s], col, row, 0, s);\n+                if (tbytes < 0)\n+                {\n+                    if (!ignore)\n+                    {\n+                        TIFFError(TIFFFileName(in),\n+                                   "Error, can\'t read tile for row %lu col %lu, "\n+                                   "sample %lu",\n+                                   (unsigned long)col, (unsigned long)row,\n+                                   (unsigned long)s);\n+                        status = 0;\n+                    }\n+                    for (sample = 0; (sample < spp) && (sample < MAX_SAMPLES); sample++)\n+                    {\n+                        tbuff = srcbuffs[sample];\n+                        if (tbuff != NULL)\n+                            _TIFFfree(tbuff);\n+                    }\n+                    return status;\n+                }\n             }\n-          return status;\n-\t  }\n-\t}\n-     /* Tiles on the right edge may be padded out to tw \n-      * which must be a multiple of 16.\n-      * Ncol represents the visible (non padding) portion.  \n-      */\n-      if (col + tw > imagewidth)\n-        ncol = imagewidth - col;\n-      else\n-        ncol = tw;\n-\n-      row_offset = row * (((imagewidth * spp * bps) + 7) / 8);\n-      col_offset = ((col * spp * bps) + 7) / 8;\n-      bufp = obuf + row_offset + col_offset;\n+            /* Tiles on the right edge may be padded out to tw \n+             * which must be a multiple of 16.\n+             * Ncol represents the visible (non padding) portion.  \n+             */\n+            if (col + tw > imagewidth)\n+                ncol = imagewidth - col;\n+            else\n+                ncol = tw;\n+\n+            row_offset = row * (((imagewidth * spp * bps) + 7) / 8);\n+            col_offset = ((col * spp * bps) + 7) / 8;\n+            bufp = obuf + row_offset + col_offset;\n \n-      if ((bps % 8) == 0)\n-        {\n-        if (combineSeparateTileSamplesBytes(srcbuffs, bufp, ncol, nrow, imagewidth,\n-\t\t\t\t\t    tw, spp, bps, NULL, 0, 0))\n-\t  {\n-          status = 0;\n-          break;\n-      \t  }\n-\t}\n-      else\n-        {\n-        bytes_per_pixel  = ((bps * spp) + 7) / 8;\n-        if (bytes_per_pixel < (bytes_per_sample + 1))\n-          shift_width = bytes_per_pixel;\n-        else\n-          shift_width = bytes_per_sample + 1;\n-\n-        switch (shift_width)\n-          {\n-          case 1: if (combineSeparateTileSamples8bits (srcbuffs, bufp, ncol, nrow,\n-                                                       imagewidth, tw, spp, bps, \n-\t\t\t\t\t\t       NULL, 0, 0))\n-\t            {\n+            if ((bps % 8) == 0)\n+            {\n+                if (combineSeparateTileSamplesBytes(srcbuffs, bufp, ncol, nrow, imagewidth,\n+                                                    tw, spp, bps, NULL, 0, 0))\n+                {\n                     status = 0;\n                     break;\n-      \t            }\n-\t          break;\n-          case 2: if (combineSeparateTileSamples16bits (srcbuffs, bufp, ncol, nrow,\n-                                                       imagewidth, tw, spp, bps, \n-\t\t\t\t\t\t       NULL, 0, 0))\n-\t            {\n-                    status = 0;\n+                }\n+            }\n+            else\n+            {\n+                bytes_per_pixel = ((bps * spp) + 7) / 8;\n+                if (bytes_per_pixel < (bytes_per_sample + 1))\n+                    shift_width = bytes_per_pixel;\n+                else\n+                    shift_width = bytes_per_sample + 1;\n+\n+                switch (shift_width)\n+                {\n+                case 1: \n+                    if (combineSeparateTileSamples8bits(srcbuffs, bufp, ncol, nrow,\n+                                                         imagewidth, tw, spp, bps, \n+                                                         NULL, 0, 0))\n+                    {\n+                        status = 0;\n+                        break;\n+                    }\n                     break;\n-\t\t    }\n-\t          break;\n-          case 3: if (combineSeparateTileSamples24bits (srcbuffs, bufp, ncol, nrow,\n-                                                       imagewidth, tw, spp, bps, \n-\t\t\t\t\t\t       NULL, 0, 0))\n-\t            {\n-                    status = 0;\n+                case 2: \n+                    if (combineSeparateTileSamples16bits(srcbuffs, bufp, ncol, nrow,\n+                                                         imagewidth, tw, spp, bps, \n+                                                         NULL, 0, 0))\n+                    {\n+                        status = 0;\n+                        break;\n+                    }\n+                    break;\n+                case 3: \n+                    if (combineSeparateTileSamples24bits(srcbuffs, bufp, ncol, nrow,\n+                                                         imagewidth, tw, spp, bps, \n+                                                         NULL, 0, 0))\n+                    {\n+                        status = 0;\n+                        break;\n+                    }\n+                    break;\n+                case 4: \n+                case 5:\n+                case 6:\n+                case 7:\n+                case 8: \n+                    if (combineSeparateTileSamples32bits(srcbuffs, bufp, ncol, nrow,\n+                                                         imagewidth, tw, spp, bps, \n+                                                         NULL, 0, 0))\n+                    {\n+                        status = 0;\n+                        break;\n+                    }\n                     break;\n-       \t            }\n-                  break;\n-          case 4: \n-          case 5:\n-          case 6:\n-          case 7:\n-          case 8: if (combineSeparateTileSamples32bits (srcbuffs, bufp, ncol, nrow,\n-                                                       imagewidth, tw, spp, bps, \n-\t\t\t\t\t\t       NULL, 0, 0))\n-\t            {\n+                default: \n+                    TIFFError("readSeparateTilesIntoBuffer", "Unsupported bit depth: %d", bps);\n                     status = 0;\n                     break;\n-\t\t    }\n-\t          break;\n-          default: TIFFError ("readSeparateTilesIntoBuffer", "Unsupported bit depth: %d", bps);\n-                  status = 0;\n-                  break;\n-          }\n+                }\n+            }\n         }\n-      }\n     }\n \n-  for (sample = 0; (sample < spp) && (sample < MAX_SAMPLES); sample++)\n+    for (sample = 0; (sample < spp) && (sample < MAX_SAMPLES); sample++)\n     {\n-    tbuff = srcbuffs[sample];\n-    if (tbuff != NULL)\n-      _TIFFfree(tbuff);\n+        tbuff = srcbuffs[sample];\n+        if (tbuff != NULL)\n+            _TIFFfree(tbuff);\n     }\n- \n-  return status;\n-  }\n+\n+    return status;\n+}\n+\n \n static int writeBufferToContigStrips(TIFF* out, uint8* buf, uint32 imagelength)\n   {\n', 'id': 14, 'location': '/data/vulnloc/libtiff/CVE-2016-5321/src/tools/tiffcrop.c:995:9'}, {'diff': '@@ -948,152 +948,154 @@\n   return status;\n   }\n \n-static int  readSeparateTilesIntoBuffer (TIFF* in, uint8 *obuf, \n-\t\t\t\t\t uint32 imagelength, uint32 imagewidth, \n+\n+static int readSeparateTilesIntoBuffer (TIFF* in, uint8 *obuf, \n+                                         uint32 imagelength, uint32 imagewidth, \n                                          uint32 tw, uint32 tl,\n                                          uint16 spp, uint16 bps)\n-  {\n-  int     i, status = 1, sample;\n-  int     shift_width, bytes_per_pixel;\n-  uint16  bytes_per_sample;\n-  uint32  row, col;     /* Current row and col of image */\n-  uint32  nrow, ncol;   /* Number of rows and cols in current tile */\n-  uint32  row_offset, col_offset; /* Output buffer offsets */\n-  tsize_t tbytes = 0, tilesize = TIFFTileSize(in);\n-  tsample_t s;\n-  uint8*  bufp = (uint8*)obuf;\n-  unsigned char *srcbuffs[MAX_SAMPLES];\n-  unsigned char *tbuff = NULL;\n+{\n+    int     i, status = 1, sample;\n+    int     shift_width, bytes_per_pixel;\n+    uint16  bytes_per_sample;\n+    uint32  row, col;     /* Current row and col of image */\n+    uint32  nrow, ncol;   /* Number of rows and cols in current tile */\n+    uint32  row_offset, col_offset; /* Output buffer offsets */\n+    tsize_t tbytes = 0, tilesize = TIFFTileSize(in);\n+    tsample_t s;\n+    uint8*  bufp = (uint8*)obuf;\n+    unsigned char *srcbuffs[MAX_SAMPLES];\n+    unsigned char *tbuff = NULL;\n \n-  bytes_per_sample = (bps + 7) / 8;\n+    bytes_per_sample = (bps + 7) / 8;\n \n-  for (sample = 0; (sample < spp) && (sample < MAX_SAMPLES); sample++)\n+    for (sample = 0; (sample < spp) && (sample < MAX_SAMPLES); sample++)\n     {\n-    srcbuffs[sample] = NULL;\n-    tbuff = (unsigned char *)_TIFFmalloc(tilesize + 8);\n-    if (!tbuff)\n-      {\n-      TIFFError ("readSeparateTilesIntoBuffer", \n-                 "Unable to allocate tile read buffer for sample %d", sample);\n-      for (i = 0; i < sample; i++)\n-        _TIFFfree (srcbuffs[i]);\n-      return 0;\n-      }\n-    srcbuffs[sample] = tbuff;\n+        srcbuffs[sample] = NULL;\n+        tbuff = (unsigned char *)_TIFFmalloc(tilesize + 8);\n+        if (!tbuff)\n+        {\n+            TIFFError ("readSeparateTilesIntoBuffer", \n+                        "Unable to allocate tile read buffer for sample %d", sample);\n+            for (i = 0; i < sample; i++)\n+                _TIFFfree (srcbuffs[i]);\n+            return 0;\n+        }\n+        srcbuffs[sample] = tbuff;\n     } \n-  /* Each tile contains only the data for a single plane\n-   * arranged in scanlines of tw * bytes_per_sample bytes.\n-   */\n-  for (row = 0; row < imagelength; row += tl)\n+\n+    for (row = 0; row < imagelength; row += tl)\n     {\n-    nrow = (row + tl > imagelength) ? imagelength - row : tl;\n-    for (col = 0; col < imagewidth; col += tw)\n-      {\n-      for (s = 0; s < spp; s++)\n-        {  /* Read each plane of a tile set into srcbuffs[s] */\n-\ttbytes = TIFFReadTile(in, srcbuffs[s], col, row, 0, s);\n-        if (tbytes < 0  && !ignore)\n-          {\n-\t  TIFFError(TIFFFileName(in),\n-                 "Error, can\'t read tile for row %lu col %lu, "\n-\t\t "sample %lu",\n-\t\t (unsigned long) col, (unsigned long) row,\n-\t\t (unsigned long) s);\n-\t\t status = 0;\n-          for (sample = 0; (sample < spp) && (sample < MAX_SAMPLES); sample++)\n+        nrow = (row + tl > imagelength) ? imagelength - row : tl;\n+        for (col = 0; col < imagewidth; col += tw)\n+        {\n+            for (s = 0; s < spp; s++)\n             {\n-            tbuff = srcbuffs[sample];\n-            if (tbuff != NULL)\n-              _TIFFfree(tbuff);\n+                tbytes = TIFFReadTile(in, srcbuffs[s], col, row, 0, s);\n+                if (tbytes < 0)\n+                {\n+                    TIFFError(TIFFFileName(in),\n+                              "Error, can\'t read tile for row %lu col %lu, "\n+                              "sample %lu",\n+                              (unsigned long) col, (unsigned long) row,\n+                              (unsigned long) s);\n+                    status = 0;\n+                    for (sample = 0; (sample < spp) && (sample < MAX_SAMPLES); sample++)\n+                    {\n+                        tbuff = srcbuffs[sample];\n+                        if (tbuff != NULL)\n+                            _TIFFfree(tbuff);\n+                    }\n+                    return status;\n+                }\n             }\n-          return status;\n-\t  }\n-\t}\n-     /* Tiles on the right edge may be padded out to tw \n-      * which must be a multiple of 16.\n-      * Ncol represents the visible (non padding) portion.  \n-      */\n-      if (col + tw > imagewidth)\n-        ncol = imagewidth - col;\n-      else\n-        ncol = tw;\n-\n-      row_offset = row * (((imagewidth * spp * bps) + 7) / 8);\n-      col_offset = ((col * spp * bps) + 7) / 8;\n-      bufp = obuf + row_offset + col_offset;\n \n-      if ((bps % 8) == 0)\n-        {\n-        if (combineSeparateTileSamplesBytes(srcbuffs, bufp, ncol, nrow, imagewidth,\n-\t\t\t\t\t    tw, spp, bps, NULL, 0, 0))\n-\t  {\n-          status = 0;\n-          break;\n-      \t  }\n-\t}\n-      else\n-        {\n-        bytes_per_pixel  = ((bps * spp) + 7) / 8;\n-        if (bytes_per_pixel < (bytes_per_sample + 1))\n-          shift_width = bytes_per_pixel;\n-        else\n-          shift_width = bytes_per_sample + 1;\n-\n-        switch (shift_width)\n-          {\n-          case 1: if (combineSeparateTileSamples8bits (srcbuffs, bufp, ncol, nrow,\n-                                                       imagewidth, tw, spp, bps, \n-\t\t\t\t\t\t       NULL, 0, 0))\n-\t            {\n-                    status = 0;\n-                    break;\n-      \t            }\n-\t          break;\n-          case 2: if (combineSeparateTileSamples16bits (srcbuffs, bufp, ncol, nrow,\n-                                                       imagewidth, tw, spp, bps, \n-\t\t\t\t\t\t       NULL, 0, 0))\n-\t            {\n-                    status = 0;\n-                    break;\n-\t\t    }\n-\t          break;\n-          case 3: if (combineSeparateTileSamples24bits (srcbuffs, bufp, ncol, nrow,\n-                                                       imagewidth, tw, spp, bps, \n-\t\t\t\t\t\t       NULL, 0, 0))\n-\t            {\n-                    status = 0;\n-                    break;\n-       \t            }\n-                  break;\n-          case 4: \n-          case 5:\n-          case 6:\n-          case 7:\n-          case 8: if (combineSeparateTileSamples32bits (srcbuffs, bufp, ncol, nrow,\n-                                                       imagewidth, tw, spp, bps, \n-\t\t\t\t\t\t       NULL, 0, 0))\n-\t            {\n+            if (col + tw > imagewidth)\n+                ncol = imagewidth - col;\n+            else\n+                ncol = tw;\n+\n+            row_offset = row * (((imagewidth * spp * bps) + 7) / 8);\n+            col_offset = ((col * spp * bps) + 7) / 8;\n+            bufp = obuf + row_offset + col_offset;\n+\n+            if ((bps % 8) == 0)\n+            {\n+                if (combineSeparateTileSamplesBytes(srcbuffs, bufp, ncol, nrow, imagewidth,\n+                                                     tw, spp, bps, NULL, 0, 0))\n+                {\n                     status = 0;\n                     break;\n-\t\t    }\n-\t          break;\n-          default: TIFFError ("readSeparateTilesIntoBuffer", "Unsupported bit depth: %d", bps);\n-                  status = 0;\n-                  break;\n-          }\n+                }\n+            }\n+            else\n+            {\n+                bytes_per_pixel  = ((bps * spp) + 7) / 8;\n+                if (bytes_per_pixel < (bytes_per_sample + 1))\n+                    shift_width = bytes_per_pixel;\n+                else\n+                    shift_width = bytes_per_sample + 1;\n+\n+                switch (shift_width)\n+                {\n+                    case 1: \n+                        if (combineSeparateTileSamples8bits (srcbuffs, bufp, ncol, nrow,\n+                                                             imagewidth, tw, spp, bps, \n+                                                             NULL, 0, 0))\n+                        {\n+                            status = 0;\n+                            break;\n+                        }\n+                        break;\n+                    case 2: \n+                        if (combineSeparateTileSamples16bits (srcbuffs, bufp, ncol, nrow,\n+                                                              imagewidth, tw, spp, bps, \n+                                                              NULL, 0, 0))\n+                        {\n+                            status = 0;\n+                            break;\n+                        }\n+                        break;\n+                    case 3: \n+                        if (combineSeparateTileSamples24bits (srcbuffs, bufp, ncol, nrow,\n+                                                              imagewidth, tw, spp, bps, \n+                                                              NULL, 0, 0))\n+                        {\n+                            status = 0;\n+                            break;\n+                        }\n+                        break;\n+                    case 4: \n+                    case 5:\n+                    case 6:\n+                    case 7:\n+                    case 8: \n+                        if (combineSeparateTileSamples32bits (srcbuffs, bufp, ncol, nrow,\n+                                                              imagewidth, tw, spp, bps, \n+                                                              NULL, 0, 0))\n+                        {\n+                            status = 0;\n+                            break;\n+                        }\n+                        break;\n+                    default: \n+                        TIFFError ("readSeparateTilesIntoBuffer", "Unsupported bit depth: %d", bps);\n+                        status = 0;\n+                        break;\n+                }\n+            }\n         }\n-      }\n     }\n \n-  for (sample = 0; (sample < spp) && (sample < MAX_SAMPLES); sample++)\n+    for (sample = 0; (sample < spp) && (sample < MAX_SAMPLES); sample++)\n     {\n-    tbuff = srcbuffs[sample];\n-    if (tbuff != NULL)\n-      _TIFFfree(tbuff);\n+        tbuff = srcbuffs[sample];\n+        if (tbuff != NULL)\n+            _TIFFfree(tbuff);\n     }\n- \n-  return status;\n-  }\n+\n+    return status;\n+}\n+\n \n static int writeBufferToContigStrips(TIFF* out, uint8* buf, uint32 imagelength)\n   {\n', 'id': 15, 'location': '/data/vulnloc/libtiff/CVE-2016-5321/src/tools/tiffcrop.c:994:2'}, {'diff': '@@ -948,11 +948,12 @@\n   return status;\n   }\n \n-static int  readSeparateTilesIntoBuffer (TIFF* in, uint8 *obuf, \n-\t\t\t\t\t uint32 imagelength, uint32 imagewidth, \n+\n+static int readSeparateTilesIntoBuffer (TIFF* in, uint8 *obuf, \n+                                         uint32 imagelength, uint32 imagewidth, \n                                          uint32 tw, uint32 tl,\n                                          uint16 spp, uint16 bps)\n-  {\n+{\n   int     i, status = 1, sample;\n   int     shift_width, bytes_per_pixel;\n   uint16  bytes_per_sample;\n@@ -968,51 +969,51 @@\n   bytes_per_sample = (bps + 7) / 8;\n \n   for (sample = 0; (sample < spp) && (sample < MAX_SAMPLES); sample++)\n-    {\n+  {\n     srcbuffs[sample] = NULL;\n     tbuff = (unsigned char *)_TIFFmalloc(tilesize + 8);\n     if (!tbuff)\n-      {\n+    {\n       TIFFError ("readSeparateTilesIntoBuffer", \n                  "Unable to allocate tile read buffer for sample %d", sample);\n       for (i = 0; i < sample; i++)\n         _TIFFfree (srcbuffs[i]);\n       return 0;\n-      }\n+    }\n     srcbuffs[sample] = tbuff;\n-    } \n+  } \n   /* Each tile contains only the data for a single plane\n    * arranged in scanlines of tw * bytes_per_sample bytes.\n    */\n   for (row = 0; row < imagelength; row += tl)\n-    {\n+  {\n     nrow = (row + tl > imagelength) ? imagelength - row : tl;\n     for (col = 0; col < imagewidth; col += tw)\n-      {\n+    {\n       for (s = 0; s < spp; s++)\n-        {  /* Read each plane of a tile set into srcbuffs[s] */\n-\ttbytes = TIFFReadTile(in, srcbuffs[s], col, row, 0, s);\n-        if (tbytes < 0  && !ignore)\n-          {\n-\t  TIFFError(TIFFFileName(in),\n+      {  \n+        tbytes = TIFFReadTile(in, srcbuffs[s], col, row, 0, s);\n+        if (tbytes == (tsize_t)-1  && !ignore)  // Change to check for -1 instead of < 0\n+        {\n+          TIFFError(TIFFFileName(in),\n                  "Error, can\'t read tile for row %lu col %lu, "\n-\t\t "sample %lu",\n-\t\t (unsigned long) col, (unsigned long) row,\n-\t\t (unsigned long) s);\n-\t\t status = 0;\n+                 "sample %lu",\n+                 (unsigned long) col, (unsigned long) row,\n+                 (unsigned long) s);\n+          status = 0;\n           for (sample = 0; (sample < spp) && (sample < MAX_SAMPLES); sample++)\n-            {\n+          {\n             tbuff = srcbuffs[sample];\n             if (tbuff != NULL)\n               _TIFFfree(tbuff);\n-            }\n+          }\n           return status;\n-\t  }\n-\t}\n-     /* Tiles on the right edge may be padded out to tw \n-      * which must be a multiple of 16.\n-      * Ncol represents the visible (non padding) portion.  \n-      */\n+        }\n+      }\n+      /* Tiles on the right edge may be padded out to tw \n+       * which must be a multiple of 16.\n+       * Ncol represents the visible (non padding) portion.  \n+       */\n       if (col + tw > imagewidth)\n         ncol = imagewidth - col;\n       else\n@@ -1023,16 +1024,16 @@\n       bufp = obuf + row_offset + col_offset;\n \n       if ((bps % 8) == 0)\n-        {\n+      {\n         if (combineSeparateTileSamplesBytes(srcbuffs, bufp, ncol, nrow, imagewidth,\n-\t\t\t\t\t    tw, spp, bps, NULL, 0, 0))\n-\t  {\n+                                            tw, spp, bps, NULL, 0, 0))\n+        {\n           status = 0;\n           break;\n-      \t  }\n-\t}\n+        }\n+      }\n       else\n-        {\n+      {\n         bytes_per_pixel  = ((bps * spp) + 7) / 8;\n         if (bytes_per_pixel < (bytes_per_sample + 1))\n           shift_width = bytes_per_pixel;\n@@ -1040,30 +1041,30 @@\n           shift_width = bytes_per_sample + 1;\n \n         switch (shift_width)\n-          {\n+        {\n           case 1: if (combineSeparateTileSamples8bits (srcbuffs, bufp, ncol, nrow,\n                                                        imagewidth, tw, spp, bps, \n-\t\t\t\t\t\t       NULL, 0, 0))\n-\t            {\n+                                                       NULL, 0, 0))\n+                  {\n                     status = 0;\n                     break;\n-      \t            }\n-\t          break;\n+                  }\n+                  break;\n           case 2: if (combineSeparateTileSamples16bits (srcbuffs, bufp, ncol, nrow,\n                                                        imagewidth, tw, spp, bps, \n-\t\t\t\t\t\t       NULL, 0, 0))\n-\t            {\n+                                                       NULL, 0, 0))\n+                  {\n                     status = 0;\n                     break;\n-\t\t    }\n-\t          break;\n+                  }\n+                  break;\n           case 3: if (combineSeparateTileSamples24bits (srcbuffs, bufp, ncol, nrow,\n                                                        imagewidth, tw, spp, bps, \n-\t\t\t\t\t\t       NULL, 0, 0))\n-\t            {\n+                                                       NULL, 0, 0))\n+                  {\n                     status = 0;\n                     break;\n-       \t            }\n+                  }\n                   break;\n           case 4: \n           case 5:\n@@ -1071,29 +1072,30 @@\n           case 7:\n           case 8: if (combineSeparateTileSamples32bits (srcbuffs, bufp, ncol, nrow,\n                                                        imagewidth, tw, spp, bps, \n-\t\t\t\t\t\t       NULL, 0, 0))\n-\t            {\n+                                                       NULL, 0, 0))\n+                  {\n                     status = 0;\n                     break;\n-\t\t    }\n-\t          break;\n+                  }\n+                  break;\n           default: TIFFError ("readSeparateTilesIntoBuffer", "Unsupported bit depth: %d", bps);\n                   status = 0;\n                   break;\n-          }\n         }\n       }\n     }\n+  }\n \n   for (sample = 0; (sample < spp) && (sample < MAX_SAMPLES); sample++)\n-    {\n+  {\n     tbuff = srcbuffs[sample];\n     if (tbuff != NULL)\n       _TIFFfree(tbuff);\n-    }\n+  }\n  \n   return status;\n-  }\n+}\n+\n \n static int writeBufferToContigStrips(TIFF* out, uint8* buf, uint32 imagelength)\n   {\n', 'id': 16, 'location': '/data/vulnloc/libtiff/CVE-2016-5321/src/tools/tiffcrop.c:994:2'}, {'diff': '@@ -948,152 +948,149 @@\n   return status;\n   }\n \n-static int  readSeparateTilesIntoBuffer (TIFF* in, uint8 *obuf, \n-\t\t\t\t\t uint32 imagelength, uint32 imagewidth, \n+\n+static int readSeparateTilesIntoBuffer (TIFF* in, uint8 *obuf, \n+                                         uint32 imagelength, uint32 imagewidth, \n                                          uint32 tw, uint32 tl,\n                                          uint16 spp, uint16 bps)\n-  {\n-  int     i, status = 1, sample;\n-  int     shift_width, bytes_per_pixel;\n-  uint16  bytes_per_sample;\n-  uint32  row, col;     /* Current row and col of image */\n-  uint32  nrow, ncol;   /* Number of rows and cols in current tile */\n-  uint32  row_offset, col_offset; /* Output buffer offsets */\n-  tsize_t tbytes = 0, tilesize = TIFFTileSize(in);\n-  tsample_t s;\n-  uint8*  bufp = (uint8*)obuf;\n-  unsigned char *srcbuffs[MAX_SAMPLES];\n-  unsigned char *tbuff = NULL;\n+{\n+    int     i, status = 1, sample;\n+    int     shift_width, bytes_per_pixel;\n+    uint16  bytes_per_sample;\n+    uint32  row, col;     /* Current row and col of image */\n+    uint32  nrow, ncol;   /* Number of rows and cols in current tile */\n+    uint32  row_offset, col_offset; /* Output buffer offsets */\n+    tsize_t tbytes = 0, tilesize = TIFFTileSize(in);\n+    tsample_t s;\n+    uint8*  bufp = (uint8*)obuf;\n+    unsigned char *srcbuffs[MAX_SAMPLES];\n+    unsigned char *tbuff = NULL;\n \n-  bytes_per_sample = (bps + 7) / 8;\n+    bytes_per_sample = (bps + 7) / 8;\n \n-  for (sample = 0; (sample < spp) && (sample < MAX_SAMPLES); sample++)\n+    for (sample = 0; (sample < spp) && (sample < MAX_SAMPLES); sample++)\n     {\n-    srcbuffs[sample] = NULL;\n-    tbuff = (unsigned char *)_TIFFmalloc(tilesize + 8);\n-    if (!tbuff)\n-      {\n-      TIFFError ("readSeparateTilesIntoBuffer", \n-                 "Unable to allocate tile read buffer for sample %d", sample);\n-      for (i = 0; i < sample; i++)\n-        _TIFFfree (srcbuffs[i]);\n-      return 0;\n-      }\n-    srcbuffs[sample] = tbuff;\n+        srcbuffs[sample] = NULL;\n+        tbuff = (unsigned char *)_TIFFmalloc(tilesize + 8);\n+        if (!tbuff)\n+        {\n+            TIFFError ("readSeparateTilesIntoBuffer", \n+                "Unable to allocate tile read buffer for sample %d", sample);\n+            for (i = 0; i < sample; i++)\n+                _TIFFfree (srcbuffs[i]);\n+            return 0;\n+        }\n+        srcbuffs[sample] = tbuff;\n     } \n-  /* Each tile contains only the data for a single plane\n-   * arranged in scanlines of tw * bytes_per_sample bytes.\n-   */\n-  for (row = 0; row < imagelength; row += tl)\n+    /* Each tile contains only the data for a single plane\n+     * arranged in scanlines of tw * bytes_per_sample bytes.\n+     */\n+    for (row = 0; row < imagelength; row += tl)\n     {\n-    nrow = (row + tl > imagelength) ? imagelength - row : tl;\n-    for (col = 0; col < imagewidth; col += tw)\n-      {\n-      for (s = 0; s < spp; s++)\n-        {  /* Read each plane of a tile set into srcbuffs[s] */\n-\ttbytes = TIFFReadTile(in, srcbuffs[s], col, row, 0, s);\n-        if (tbytes < 0  && !ignore)\n-          {\n-\t  TIFFError(TIFFFileName(in),\n-                 "Error, can\'t read tile for row %lu col %lu, "\n-\t\t "sample %lu",\n-\t\t (unsigned long) col, (unsigned long) row,\n-\t\t (unsigned long) s);\n-\t\t status = 0;\n-          for (sample = 0; (sample < spp) && (sample < MAX_SAMPLES); sample++)\n-            {\n-            tbuff = srcbuffs[sample];\n-            if (tbuff != NULL)\n-              _TIFFfree(tbuff);\n-            }\n-          return status;\n-\t  }\n-\t}\n-     /* Tiles on the right edge may be padded out to tw \n-      * which must be a multiple of 16.\n-      * Ncol represents the visible (non padding) portion.  \n-      */\n-      if (col + tw > imagewidth)\n-        ncol = imagewidth - col;\n-      else\n-        ncol = tw;\n-\n-      row_offset = row * (((imagewidth * spp * bps) + 7) / 8);\n-      col_offset = ((col * spp * bps) + 7) / 8;\n-      bufp = obuf + row_offset + col_offset;\n-\n-      if ((bps % 8) == 0)\n-        {\n-        if (combineSeparateTileSamplesBytes(srcbuffs, bufp, ncol, nrow, imagewidth,\n-\t\t\t\t\t    tw, spp, bps, NULL, 0, 0))\n-\t  {\n-          status = 0;\n-          break;\n-      \t  }\n-\t}\n-      else\n+        nrow = (row + tl > imagelength) ? imagelength - row : tl;\n+        for (col = 0; col < imagewidth; col += tw)\n         {\n-        bytes_per_pixel  = ((bps * spp) + 7) / 8;\n-        if (bytes_per_pixel < (bytes_per_sample + 1))\n-          shift_width = bytes_per_pixel;\n-        else\n-          shift_width = bytes_per_sample + 1;\n-\n-        switch (shift_width)\n-          {\n-          case 1: if (combineSeparateTileSamples8bits (srcbuffs, bufp, ncol, nrow,\n-                                                       imagewidth, tw, spp, bps, \n-\t\t\t\t\t\t       NULL, 0, 0))\n-\t            {\n-                    status = 0;\n-                    break;\n-      \t            }\n-\t          break;\n-          case 2: if (combineSeparateTileSamples16bits (srcbuffs, bufp, ncol, nrow,\n-                                                       imagewidth, tw, spp, bps, \n-\t\t\t\t\t\t       NULL, 0, 0))\n-\t            {\n-                    status = 0;\n-                    break;\n-\t\t    }\n-\t          break;\n-          case 3: if (combineSeparateTileSamples24bits (srcbuffs, bufp, ncol, nrow,\n-                                                       imagewidth, tw, spp, bps, \n-\t\t\t\t\t\t       NULL, 0, 0))\n-\t            {\n+            for (s = 0; s < spp; s++)\n+            {  /* Read each plane of a tile set into srcbuffs[s] */\n+                tbytes = TIFFReadTile(in, srcbuffs[s], col, row, 0, s);\n+                if (tbytes == (tsize_t)(-1)) \n+                {\n+                    TIFFError(TIFFFileName(in),\n+                        "Error, can\'t read tile for row %lu col %lu, "\n+                        "sample %lu",\n+                        (unsigned long) col, (unsigned long) row,\n+                        (unsigned long) s);\n                     status = 0;\n                     break;\n-       \t            }\n-                  break;\n-          case 4: \n-          case 5:\n-          case 6:\n-          case 7:\n-          case 8: if (combineSeparateTileSamples32bits (srcbuffs, bufp, ncol, nrow,\n-                                                       imagewidth, tw, spp, bps, \n-\t\t\t\t\t\t       NULL, 0, 0))\n-\t            {\n+                }\n+            }\n+        \n+            /* Tiles on the right edge may be padded out to tw \n+             * which must be a multiple of 16.\n+             * Ncol represents the visible (non padding) portion.  \n+             */\n+            if (col + tw > imagewidth)\n+                ncol = imagewidth - col;\n+            else\n+                ncol = tw;\n+\n+            row_offset = row * (((imagewidth * spp * bps) + 7) / 8);\n+            col_offset = ((col * spp * bps) + 7) / 8;\n+            bufp = obuf + row_offset + col_offset;\n+\n+            if ((bps % 8) == 0)\n+            {\n+                if (combineSeparateTileSamplesBytes(srcbuffs, bufp, ncol, nrow, imagewidth,\n+                                                     tw, spp, bps, NULL, 0, 0))\n+                {\n                     status = 0;\n                     break;\n-\t\t    }\n-\t          break;\n-          default: TIFFError ("readSeparateTilesIntoBuffer", "Unsupported bit depth: %d", bps);\n-                  status = 0;\n-                  break;\n-          }\n+                }\n+            }\n+            else\n+            {\n+                bytes_per_pixel  = ((bps * spp) + 7) / 8;\n+                if (bytes_per_pixel < (bytes_per_sample + 1))\n+                    shift_width = bytes_per_pixel;\n+                else\n+                    shift_width = bytes_per_sample + 1;\n+\n+                switch (shift_width)\n+                {\n+                    case 1: if (combineSeparateTileSamples8bits (srcbuffs, bufp, ncol, nrow,\n+                                                                 imagewidth, tw, spp, bps, \n+                                                                 NULL, 0, 0))\n+                            {\n+                                status = 0;\n+                                break;\n+                            }\n+                            break;\n+                    case 2: if (combineSeparateTileSamples16bits (srcbuffs, bufp, ncol, nrow,\n+                                                                 imagewidth, tw, spp, bps, \n+                                                                 NULL, 0, 0))\n+                            {\n+                                status = 0;\n+                                break;\n+                            }\n+                            break;\n+                    case 3: if (combineSeparateTileSamples24bits (srcbuffs, bufp, ncol, nrow,\n+                                                                 imagewidth, tw, spp, bps, \n+                                                                 NULL, 0, 0))\n+                            {\n+                                status = 0;\n+                                break;\n+                            }\n+                            break;\n+                    case 4: \n+                    case 5:\n+                    case 6:\n+                    case 7:\n+                    case 8: if (combineSeparateTileSamples32bits (srcbuffs, bufp, ncol, nrow,\n+                                                                 imagewidth, tw, spp, bps, \n+                                                                 NULL, 0, 0))\n+                            {\n+                                status = 0;\n+                                break;\n+                            }\n+                            break;\n+                    default: TIFFError ("readSeparateTilesIntoBuffer", "Unsupported bit depth: %d", bps);\n+                             status = 0;\n+                             break;\n+                }\n+            }\n         }\n-      }\n     }\n \n-  for (sample = 0; (sample < spp) && (sample < MAX_SAMPLES); sample++)\n+    for (sample = 0; (sample < spp) && (sample < MAX_SAMPLES); sample++)\n     {\n-    tbuff = srcbuffs[sample];\n-    if (tbuff != NULL)\n-      _TIFFfree(tbuff);\n+        tbuff = srcbuffs[sample];\n+        if (tbuff != NULL)\n+            _TIFFfree(tbuff);\n     }\n- \n-  return status;\n-  }\n+\n+    return status;\n+}\n+\n \n static int writeBufferToContigStrips(TIFF* out, uint8* buf, uint32 imagelength)\n   {\n', 'id': 17, 'location': '/data/vulnloc/libtiff/CVE-2016-5321/src/tools/tiffcrop.c:994:2'}, {'diff': '@@ -948,11 +948,12 @@\n   return status;\n   }\n \n-static int  readSeparateTilesIntoBuffer (TIFF* in, uint8 *obuf, \n-\t\t\t\t\t uint32 imagelength, uint32 imagewidth, \n+\n+static int readSeparateTilesIntoBuffer (TIFF* in, uint8 *obuf, \n+                                         uint32 imagelength, uint32 imagewidth, \n                                          uint32 tw, uint32 tl,\n                                          uint16 spp, uint16 bps)\n-  {\n+{\n   int     i, status = 1, sample;\n   int     shift_width, bytes_per_pixel;\n   uint16  bytes_per_sample;\n@@ -968,51 +969,42 @@\n   bytes_per_sample = (bps + 7) / 8;\n \n   for (sample = 0; (sample < spp) && (sample < MAX_SAMPLES); sample++)\n-    {\n+  {\n     srcbuffs[sample] = NULL;\n     tbuff = (unsigned char *)_TIFFmalloc(tilesize + 8);\n     if (!tbuff)\n-      {\n+    {\n       TIFFError ("readSeparateTilesIntoBuffer", \n                  "Unable to allocate tile read buffer for sample %d", sample);\n       for (i = 0; i < sample; i++)\n         _TIFFfree (srcbuffs[i]);\n       return 0;\n-      }\n+    }\n     srcbuffs[sample] = tbuff;\n-    } \n-  /* Each tile contains only the data for a single plane\n-   * arranged in scanlines of tw * bytes_per_sample bytes.\n-   */\n+  } \n+\n   for (row = 0; row < imagelength; row += tl)\n-    {\n+  {\n     nrow = (row + tl > imagelength) ? imagelength - row : tl;\n     for (col = 0; col < imagewidth; col += tw)\n-      {\n+    {\n       for (s = 0; s < spp; s++)\n-        {  /* Read each plane of a tile set into srcbuffs[s] */\n-\ttbytes = TIFFReadTile(in, srcbuffs[s], col, row, 0, s);\n-        if (tbytes < 0  && !ignore)\n-          {\n-\t  TIFFError(TIFFFileName(in),\n-                 "Error, can\'t read tile for row %lu col %lu, "\n-\t\t "sample %lu",\n-\t\t (unsigned long) col, (unsigned long) row,\n-\t\t (unsigned long) s);\n-\t\t status = 0;\n-          for (sample = 0; (sample < spp) && (sample < MAX_SAMPLES); sample++)\n-            {\n-            tbuff = srcbuffs[sample];\n-            if (tbuff != NULL)\n-              _TIFFfree(tbuff);\n-            }\n-          return status;\n-\t  }\n-\t}\n-     /* Tiles on the right edge may be padded out to tw \n-      * which must be a multiple of 16.\n-      * Ncol represents the visible (non padding) portion.  \n-      */\n+      {\n+        tbytes = TIFFReadTile(in, srcbuffs[s], col, row, 0, s);\n+        if (tbytes < 0)\n+        {\n+          TIFFError(TIFFFileName(in),\n+                     "Error, can\'t read tile for row %lu col %lu, "\n+                     "sample %lu",\n+                     (unsigned long) col, (unsigned long) row,\n+                     (unsigned long) s);\n+          status = 0;\n+          break; // Added break to avoid fallthrough on error\n+        }\n+      }\n+\n+      if (status == 0) break; // Added break to exit outer loop on error\n+\n       if (col + tw > imagewidth)\n         ncol = imagewidth - col;\n       else\n@@ -1023,16 +1015,16 @@\n       bufp = obuf + row_offset + col_offset;\n \n       if ((bps % 8) == 0)\n-        {\n+      {\n         if (combineSeparateTileSamplesBytes(srcbuffs, bufp, ncol, nrow, imagewidth,\n-\t\t\t\t\t    tw, spp, bps, NULL, 0, 0))\n-\t  {\n+                                             tw, spp, bps, NULL, 0, 0))\n+        {\n           status = 0;\n           break;\n-      \t  }\n-\t}\n+        }\n+      }\n       else\n-        {\n+      {\n         bytes_per_pixel  = ((bps * spp) + 7) / 8;\n         if (bytes_per_pixel < (bytes_per_sample + 1))\n           shift_width = bytes_per_pixel;\n@@ -1040,30 +1032,30 @@\n           shift_width = bytes_per_sample + 1;\n \n         switch (shift_width)\n-          {\n+        {\n           case 1: if (combineSeparateTileSamples8bits (srcbuffs, bufp, ncol, nrow,\n                                                        imagewidth, tw, spp, bps, \n-\t\t\t\t\t\t       NULL, 0, 0))\n-\t            {\n+                                                       NULL, 0, 0))\n+                  {\n                     status = 0;\n                     break;\n-      \t            }\n-\t          break;\n+                  }\n+                  break;\n           case 2: if (combineSeparateTileSamples16bits (srcbuffs, bufp, ncol, nrow,\n                                                        imagewidth, tw, spp, bps, \n-\t\t\t\t\t\t       NULL, 0, 0))\n-\t            {\n+                                                       NULL, 0, 0))\n+                  {\n                     status = 0;\n                     break;\n-\t\t    }\n-\t          break;\n+                  }\n+                  break;\n           case 3: if (combineSeparateTileSamples24bits (srcbuffs, bufp, ncol, nrow,\n                                                        imagewidth, tw, spp, bps, \n-\t\t\t\t\t\t       NULL, 0, 0))\n-\t            {\n+                                                       NULL, 0, 0))\n+                  {\n                     status = 0;\n                     break;\n-       \t            }\n+                  }\n                   break;\n           case 4: \n           case 5:\n@@ -1071,30 +1063,32 @@\n           case 7:\n           case 8: if (combineSeparateTileSamples32bits (srcbuffs, bufp, ncol, nrow,\n                                                        imagewidth, tw, spp, bps, \n-\t\t\t\t\t\t       NULL, 0, 0))\n-\t            {\n+                                                       NULL, 0, 0))\n+                  {\n                     status = 0;\n                     break;\n-\t\t    }\n-\t          break;\n+                  }\n+                  break;\n           default: TIFFError ("readSeparateTilesIntoBuffer", "Unsupported bit depth: %d", bps);\n                   status = 0;\n                   break;\n-          }\n         }\n       }\n     }\n+    if (status == 0) break; // Added break to exit the row loop on error\n+  }\n \n   for (sample = 0; (sample < spp) && (sample < MAX_SAMPLES); sample++)\n-    {\n+  {\n     tbuff = srcbuffs[sample];\n     if (tbuff != NULL)\n       _TIFFfree(tbuff);\n-    }\n- \n-  return status;\n   }\n \n+  return status;\n+}\n+\n+\n static int writeBufferToContigStrips(TIFF* out, uint8* buf, uint32 imagelength)\n   {\n   uint32 row, nrows, rowsperstrip;\n', 'id': 18, 'location': '/data/vulnloc/libtiff/CVE-2016-5321/src/tools/tiffcrop.c:994:2'}, {'diff': '@@ -948,152 +948,160 @@\n   return status;\n   }\n \n-static int  readSeparateTilesIntoBuffer (TIFF* in, uint8 *obuf, \n-\t\t\t\t\t uint32 imagelength, uint32 imagewidth, \n+\n+static int readSeparateTilesIntoBuffer (TIFF* in, uint8 *obuf, \n+                                         uint32 imagelength, uint32 imagewidth, \n                                          uint32 tw, uint32 tl,\n                                          uint16 spp, uint16 bps)\n-  {\n-  int     i, status = 1, sample;\n-  int     shift_width, bytes_per_pixel;\n-  uint16  bytes_per_sample;\n-  uint32  row, col;     /* Current row and col of image */\n-  uint32  nrow, ncol;   /* Number of rows and cols in current tile */\n-  uint32  row_offset, col_offset; /* Output buffer offsets */\n-  tsize_t tbytes = 0, tilesize = TIFFTileSize(in);\n-  tsample_t s;\n-  uint8*  bufp = (uint8*)obuf;\n-  unsigned char *srcbuffs[MAX_SAMPLES];\n-  unsigned char *tbuff = NULL;\n+{\n+    int     i, status = 1, sample;\n+    int     shift_width, bytes_per_pixel;\n+    uint16  bytes_per_sample;\n+    uint32  row, col;     /* Current row and col of image */\n+    uint32  nrow, ncol;   /* Number of rows and cols in current tile */\n+    uint32  row_offset, col_offset; /* Output buffer offsets */\n+    tsize_t tbytes = 0, tilesize = TIFFTileSize(in);\n+    tsample_t s;\n+    uint8*  bufp = (uint8*)obuf;\n+    unsigned char *srcbuffs[MAX_SAMPLES];\n+    unsigned char *tbuff = NULL;\n \n-  bytes_per_sample = (bps + 7) / 8;\n+    bytes_per_sample = (bps + 7) / 8;\n \n-  for (sample = 0; (sample < spp) && (sample < MAX_SAMPLES); sample++)\n+    for (sample = 0; (sample < spp) && (sample < MAX_SAMPLES); sample++)\n     {\n-    srcbuffs[sample] = NULL;\n-    tbuff = (unsigned char *)_TIFFmalloc(tilesize + 8);\n-    if (!tbuff)\n-      {\n-      TIFFError ("readSeparateTilesIntoBuffer", \n-                 "Unable to allocate tile read buffer for sample %d", sample);\n-      for (i = 0; i < sample; i++)\n-        _TIFFfree (srcbuffs[i]);\n-      return 0;\n-      }\n-    srcbuffs[sample] = tbuff;\n+        srcbuffs[sample] = NULL;\n+        tbuff = (unsigned char *)_TIFFmalloc(tilesize + 8);\n+        if (!tbuff)\n+        {\n+            TIFFError ("readSeparateTilesIntoBuffer", \n+                        "Unable to allocate tile read buffer for sample %d", sample);\n+            for (i = 0; i < sample; i++)\n+                _TIFFfree (srcbuffs[i]);\n+            return 0;\n+        }\n+        srcbuffs[sample] = tbuff;\n     } \n-  /* Each tile contains only the data for a single plane\n-   * arranged in scanlines of tw * bytes_per_sample bytes.\n-   */\n-  for (row = 0; row < imagelength; row += tl)\n+    /* Each tile contains only the data for a single plane\n+     * arranged in scanlines of tw * bytes_per_sample bytes.\n+     */\n+    for (row = 0; row < imagelength; row += tl)\n     {\n-    nrow = (row + tl > imagelength) ? imagelength - row : tl;\n-    for (col = 0; col < imagewidth; col += tw)\n-      {\n-      for (s = 0; s < spp; s++)\n-        {  /* Read each plane of a tile set into srcbuffs[s] */\n-\ttbytes = TIFFReadTile(in, srcbuffs[s], col, row, 0, s);\n-        if (tbytes < 0  && !ignore)\n-          {\n-\t  TIFFError(TIFFFileName(in),\n-                 "Error, can\'t read tile for row %lu col %lu, "\n-\t\t "sample %lu",\n-\t\t (unsigned long) col, (unsigned long) row,\n-\t\t (unsigned long) s);\n-\t\t status = 0;\n-          for (sample = 0; (sample < spp) && (sample < MAX_SAMPLES); sample++)\n-            {\n-            tbuff = srcbuffs[sample];\n-            if (tbuff != NULL)\n-              _TIFFfree(tbuff);\n-            }\n-          return status;\n-\t  }\n-\t}\n-     /* Tiles on the right edge may be padded out to tw \n-      * which must be a multiple of 16.\n-      * Ncol represents the visible (non padding) portion.  \n-      */\n-      if (col + tw > imagewidth)\n-        ncol = imagewidth - col;\n-      else\n-        ncol = tw;\n-\n-      row_offset = row * (((imagewidth * spp * bps) + 7) / 8);\n-      col_offset = ((col * spp * bps) + 7) / 8;\n-      bufp = obuf + row_offset + col_offset;\n-\n-      if ((bps % 8) == 0)\n-        {\n-        if (combineSeparateTileSamplesBytes(srcbuffs, bufp, ncol, nrow, imagewidth,\n-\t\t\t\t\t    tw, spp, bps, NULL, 0, 0))\n-\t  {\n-          status = 0;\n-          break;\n-      \t  }\n-\t}\n-      else\n+        nrow = (row + tl > imagelength) ? imagelength - row : tl;\n+        for (col = 0; col < imagewidth; col += tw)\n         {\n-        bytes_per_pixel  = ((bps * spp) + 7) / 8;\n-        if (bytes_per_pixel < (bytes_per_sample + 1))\n-          shift_width = bytes_per_pixel;\n-        else\n-          shift_width = bytes_per_sample + 1;\n-\n-        switch (shift_width)\n-          {\n-          case 1: if (combineSeparateTileSamples8bits (srcbuffs, bufp, ncol, nrow,\n-                                                       imagewidth, tw, spp, bps, \n-\t\t\t\t\t\t       NULL, 0, 0))\n-\t            {\n-                    status = 0;\n-                    break;\n-      \t            }\n-\t          break;\n-          case 2: if (combineSeparateTileSamples16bits (srcbuffs, bufp, ncol, nrow,\n-                                                       imagewidth, tw, spp, bps, \n-\t\t\t\t\t\t       NULL, 0, 0))\n-\t            {\n-                    status = 0;\n-                    break;\n-\t\t    }\n-\t          break;\n-          case 3: if (combineSeparateTileSamples24bits (srcbuffs, bufp, ncol, nrow,\n-                                                       imagewidth, tw, spp, bps, \n-\t\t\t\t\t\t       NULL, 0, 0))\n-\t            {\n+            for (s = 0; s < spp; s++)\n+            {  \n+                /* Validate TIFFReadTile return value to avoid processing errors */\n+                tbytes = TIFFReadTile(in, srcbuffs[s], col, row, 0, s);\n+                if (tbytes == (tsize_t)-1) // Handle error condition\n+                {\n+                    TIFFError(TIFFFileName(in),\n+                              "Error, can\'t read tile for row %lu col %lu, "\n+                              "sample %lu",\n+                              (unsigned long) col, (unsigned long) row,\n+                              (unsigned long) s);\n                     status = 0;\n                     break;\n-       \t            }\n-                  break;\n-          case 4: \n-          case 5:\n-          case 6:\n-          case 7:\n-          case 8: if (combineSeparateTileSamples32bits (srcbuffs, bufp, ncol, nrow,\n-                                                       imagewidth, tw, spp, bps, \n-\t\t\t\t\t\t       NULL, 0, 0))\n-\t            {\n+                }\n+                else if (tbytes == 0) // Handle a potential read failure\n+                {\n+                    TIFFError(TIFFFileName(in),\n+                              "Warning, read no bytes for tile at row %lu col %lu, "\n+                              "sample %lu",\n+                              (unsigned long) col, (unsigned long) row,\n+                              (unsigned long) s);\n+                    // Continue without breaking the loop\n+                }\n+            }\n+            if (status == 0) break; // Exit outer loop if there was an error\n+            /* Tiles on the right edge may be padded out to tw \n+             * which must be a multiple of 16.\n+             * Ncol represents the visible (non padding) portion.  \n+             */\n+            if (col + tw > imagewidth)\n+                ncol = imagewidth - col;\n+            else\n+                ncol = tw;\n+\n+            row_offset = row * (((imagewidth * spp * bps) + 7) / 8);\n+            col_offset = ((col * spp * bps) + 7) / 8;\n+            bufp = obuf + row_offset + col_offset;\n+\n+            if ((bps % 8) == 0)\n+            {\n+                if (combineSeparateTileSamplesBytes(srcbuffs, bufp, ncol, nrow, imagewidth,\n+                                                     tw, spp, bps, NULL, 0, 0))\n+                {\n                     status = 0;\n                     break;\n-\t\t    }\n-\t          break;\n-          default: TIFFError ("readSeparateTilesIntoBuffer", "Unsupported bit depth: %d", bps);\n-                  status = 0;\n-                  break;\n-          }\n+                }\n+            }\n+            else\n+            {\n+                bytes_per_pixel  = ((bps * spp) + 7) / 8;\n+                if (bytes_per_pixel < (bytes_per_sample + 1))\n+                    shift_width = bytes_per_pixel;\n+                else\n+                    shift_width = bytes_per_sample + 1;\n+\n+                switch (shift_width)\n+                {\n+                    case 1: if (combineSeparateTileSamples8bits (srcbuffs, bufp, ncol, nrow,\n+                                                                 imagewidth, tw, spp, bps, \n+                                                                 NULL, 0, 0))\n+                            {\n+                                status = 0;\n+                                break;\n+                            }\n+                            break;\n+                    case 2: if (combineSeparateTileSamples16bits (srcbuffs, bufp, ncol, nrow,\n+                                                                  imagewidth, tw, spp, bps, \n+                                                                  NULL, 0, 0))\n+                            {\n+                                status = 0;\n+                                break;\n+                            }\n+                            break;\n+                    case 3: if (combineSeparateTileSamples24bits (srcbuffs, bufp, ncol, nrow,\n+                                                                  imagewidth, tw, spp, bps, \n+                                                                  NULL, 0, 0))\n+                            {\n+                                status = 0;\n+                                break;\n+                            }\n+                            break;\n+                    case 4: \n+                    case 5:\n+                    case 6:\n+                    case 7:\n+                    case 8: if (combineSeparateTileSamples32bits (srcbuffs, bufp, ncol, nrow,\n+                                                                  imagewidth, tw, spp, bps, \n+                                                                  NULL, 0, 0))\n+                            {\n+                                status = 0;\n+                                break;\n+                            }\n+                            break;\n+                    default: TIFFError ("readSeparateTilesIntoBuffer", "Unsupported bit depth: %d", bps);\n+                             status = 0;\n+                             break;\n+                }\n+            }\n         }\n-      }\n+        if (status == 0) break; // Exit if there\'s an error in tile processing\n     }\n \n-  for (sample = 0; (sample < spp) && (sample < MAX_SAMPLES); sample++)\n+    for (sample = 0; (sample < spp) && (sample < MAX_SAMPLES); sample++)\n     {\n-    tbuff = srcbuffs[sample];\n-    if (tbuff != NULL)\n-      _TIFFfree(tbuff);\n+        tbuff = srcbuffs[sample];\n+        if (tbuff != NULL)\n+            _TIFFfree(tbuff);\n     }\n- \n-  return status;\n-  }\n+\n+    return status;\n+}\n+\n \n static int writeBufferToContigStrips(TIFF* out, uint8* buf, uint32 imagelength)\n   {\n', 'id': 19, 'location': '/data/vulnloc/libtiff/CVE-2016-5321/src/tools/tiffcrop.c:994:2'}]2025-02-03 22:05:04.191 | INFO     | scenario:validate:475 - beginning candidate patch evaluation with time limit: 45 minutes
2025-02-03 22:05:04.194 | DEBUG    | scenario:rebuild:369 - original environment: environ({'CONDA_SHLVL': '2', 'LC_ALL': 'C.UTF-8', 'LS_COLORS': 'rs=0:di=01;34:ln=01;36:mh=00:pi=40;33:so=01;35:do=01;35:bd=40;33;01:cd=40;33;01:or=40;31;01:mi=00:su=37;41:sg=30;43:ca=30;41:tw=30;42:ow=34;42:st=37;44:ex=01;32:*.tar=01;31:*.tgz=01;31:*.arc=01;31:*.arj=01;31:*.taz=01;31:*.lha=01;31:*.lz4=01;31:*.lzh=01;31:*.lzma=01;31:*.tlz=01;31:*.txz=01;31:*.tzo=01;31:*.t7z=01;31:*.zip=01;31:*.z=01;31:*.Z=01;31:*.dz=01;31:*.gz=01;31:*.lrz=01;31:*.lz=01;31:*.lzo=01;31:*.xz=01;31:*.zst=01;31:*.tzst=01;31:*.bz2=01;31:*.bz=01;31:*.tbz=01;31:*.tbz2=01;31:*.tz=01;31:*.deb=01;31:*.rpm=01;31:*.jar=01;31:*.war=01;31:*.ear=01;31:*.sar=01;31:*.rar=01;31:*.alz=01;31:*.ace=01;31:*.zoo=01;31:*.cpio=01;31:*.7z=01;31:*.rz=01;31:*.cab=01;31:*.wim=01;31:*.swm=01;31:*.dwm=01;31:*.esd=01;31:*.jpg=01;35:*.jpeg=01;35:*.mjpg=01;35:*.mjpeg=01;35:*.gif=01;35:*.bmp=01;35:*.pbm=01;35:*.pgm=01;35:*.ppm=01;35:*.tga=01;35:*.xbm=01;35:*.xpm=01;35:*.tif=01;35:*.tiff=01;35:*.png=01;35:*.svg=01;35:*.svgz=01;35:*.mng=01;35:*.pcx=01;35:*.mov=01;35:*.mpg=01;35:*.mpeg=01;35:*.m2v=01;35:*.mkv=01;35:*.webm=01;35:*.ogm=01;35:*.mp4=01;35:*.m4v=01;35:*.mp4v=01;35:*.vob=01;35:*.qt=01;35:*.nuv=01;35:*.wmv=01;35:*.asf=01;35:*.rm=01;35:*.rmvb=01;35:*.flc=01;35:*.avi=01;35:*.fli=01;35:*.flv=01;35:*.gl=01;35:*.dl=01;35:*.xcf=01;35:*.xwd=01;35:*.yuv=01;35:*.cgm=01;35:*.emf=01;35:*.ogv=01;35:*.ogx=01;35:*.aac=00;36:*.au=00;36:*.flac=00;36:*.m4a=00;36:*.mid=00;36:*.midi=00;36:*.mka=00;36:*.mp3=00;36:*.mpc=00;36:*.ogg=00;36:*.ra=00;36:*.wav=00;36:*.oga=00;36:*.opus=00;36:*.spx=00;36:*.xspf=00;36:', 'LD_LIBRARY_PATH': '/opt/crashrepair/lib:/CrashRepair/lib:/klee/build/lib:', 'CONDA_EXE': '/root/anaconda3/bin/conda', 'LANG': 'C.UTF-8', 'TZ': 'Asia/Shanghai', 'HOSTNAME': 'fea22102047d', 'OLDPWD': '/orchestrator', 'CONDA_PREFIX': '/root/anaconda3/envs/CrashRepair', '_CE_M': '', 'CC': 'crepair-cc', 'LLVM_COMPILER': 'clang', 'CONDA_PREFIX_1': '/root/anaconda3', 'PWD': '/orchestrator/crashrepair', 'HOME': '/root', 'CONDA_PYTHON_EXE': '/root/anaconda3/bin/python', '_CE_CONDA': '', 'CONDA_PROMPT_MODIFIER': '(CrashRepair) ', 'CXX': 'crepair-cxx', 'TERM': 'xterm', 'SHLVL': '2', 'PYTHONPATH': '/usr/lib/python3.8/site-packages:', 'PATH': '/root/anaconda3/envs/CrashRepair/bin:/root/anaconda3/condabin:~/anaconda3/bin:/opt/crashrepair/bin:/CrashRepair/compiler:/klee/build/bin:/opt/llvm-6/bin:/klee/build/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', 'CONDA_DEFAULT_ENV': 'CrashRepair', '_': '/root/anaconda3/envs/CrashRepair/bin/python'})
2025-02-03 22:05:04.194 | DEBUG    | scenario:rebuild:382 - injecting ghost function into CFLAGS during build: -lcrepair_ghost
2025-02-03 22:05:04.194 | DEBUG    | scenario:rebuild:398 - using environment: {'INJECT_CFLAGS': '-g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address', 'INJECT_CXXFLAGS': '-g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address', 'INJECT_LDFLAGS': '-g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address'}
2025-02-03 22:05:04.195 | DEBUG    | shell:__call__:41 - executing: make clean
Making clean in port
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/port'
rm -rf .libs _libs
test -z "libport.la" || rm -f libport.la
rm -f ./so_locations
rm -f *.o
rm -f *.lo
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/port'
Making clean in libtiff
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/libtiff'
test -z "libtiff.la libtiffxx.la" || rm -f libtiff.la libtiffxx.la
rm -f ./so_locations
rm -rf .libs _libs
 rm -f mkg3states
rm -f *.o
rm -f *.lo
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/libtiff'
Making clean in tools
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/tools'
 rm -f bmp2tiff fax2ps fax2tiff gif2tiff pal2rgb ppm2tiff ras2tiff raw2tiff rgb2ycbcr thumbnail tiff2bw tiff2pdf tiff2ps tiff2rgba tiffcmp tiffcp tiffcrop tiffdither tiffdump tiffinfo tiffmedian tiffset tiffsplit
rm -rf .libs _libs
rm -f *.o
rm -f *.lo
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/tools'
Making clean in build
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/build'
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/build'
rm -rf .libs _libs
rm -f *.lo
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/build'
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/build'
Making clean in contrib
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib'
Making clean in addtiffo
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/addtiffo'
rm -rf .libs _libs
 rm -f addtiffo
rm -f *.o
rm -f *.lo
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/addtiffo'
Making clean in dbs
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/dbs'
Making clean in xtiff
make[3]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/dbs/xtiff'
rm -rf .libs _libs
rm -f *.lo
make[3]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/dbs/xtiff'
make[3]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/dbs'
rm -rf .libs _libs
 rm -f tiff-bi tiff-grayscale tiff-palette tiff-rgb
rm -f *.o
rm -f *.lo
make[3]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/dbs'
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/dbs'
Making clean in iptcutil
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/iptcutil'
rm -rf .libs _libs
 rm -f iptcutil
rm -f *.o
rm -f *.lo
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/iptcutil'
Making clean in mfs
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/mfs'
rm -rf .libs _libs
rm -f *.lo
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/mfs'
Making clean in pds
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/pds'
rm -rf .libs _libs
rm -f *.lo
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/pds'
Making clean in ras
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/ras'
rm -rf .libs _libs
rm -f *.lo
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/ras'
Making clean in stream
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/stream'
rm -rf .libs _libs
rm -f *.lo
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/stream'
Making clean in tags
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/tags'
rm -rf .libs _libs
rm -f *.lo
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/tags'
Making clean in win_dib
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/win_dib'
rm -rf .libs _libs
rm -f *.lo
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/win_dib'
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib'
rm -rf .libs _libs
rm -f *.lo
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib'
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib'
Making clean in test
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/test'
 rm -f ascii_tag long_tag short_tag strip_rw rewrite custom_dir raw_decode
test -z "test_packbits.tif o-*" || rm -f test_packbits.tif o-*
rm -rf .libs _libs
rm -f *.o
test -z "ascii_tag.log long_tag.log short_tag.log strip_rw.log rewrite.log custom_dir.log raw_decode.log bmp2tiff_palette.sh.log bmp2tiff_rgb.sh.log gif2tiff.sh.log ppm2tiff_pbm.sh.log ppm2tiff_pgm.sh.log ppm2tiff_ppm.sh.log tiffcp-g3.sh.log tiffcp-g3-1d.sh.log tiffcp-g3-1d-fill.sh.log tiffcp-g3-2d.sh.log tiffcp-g3-2d-fill.sh.log tiffcp-g4.sh.log tiffcp-logluv.sh.log tiffcp-thumbnail.sh.log tiffdump.sh.log tiffinfo.sh.log tiffcp-split.sh.log tiffcp-split-join.sh.log tiff2ps-PS1.sh.log tiff2ps-PS2.sh.log tiff2ps-PS3.sh.log tiff2ps-EPS1.sh.log tiff2pdf.sh.log tiffcrop-doubleflip-logluv-3c-16b.sh.log tiffcrop-doubleflip-minisblack-1c-16b.sh.log tiffcrop-doubleflip-minisblack-1c-8b.sh.log tiffcrop-doubleflip-minisblack-2c-8b-alpha.sh.log tiffcrop-doubleflip-miniswhite-1c-1b.sh.log tiffcrop-doubleflip-palette-1c-1b.sh.log tiffcrop-doubleflip-palette-1c-4b.sh.log tiffcrop-doubleflip-palette-1c-8b.sh.log tiffcrop-doubleflip-rgb-3c-16b.sh.log tiffcrop-doubleflip-rgb-3c-8b.sh.log tiffcrop-extract-logluv-3c-16b.sh.log tiffcrop-extract-minisblack-1c-16b.sh.log tiffcrop-extract-minisblack-1c-8b.sh.log tiffcrop-extract-minisblack-2c-8b-alpha.sh.log tiffcrop-extract-miniswhite-1c-1b.sh.log tiffcrop-extract-palette-1c-1b.sh.log tiffcrop-extract-palette-1c-4b.sh.log tiffcrop-extract-palette-1c-8b.sh.log tiffcrop-extract-rgb-3c-16b.sh.log tiffcrop-extract-rgb-3c-8b.sh.log tiffcrop-extractz14-logluv-3c-16b.sh.log tiffcrop-extractz14-minisblack-1c-16b.sh.log tiffcrop-extractz14-minisblack-1c-8b.sh.log tiffcrop-extractz14-minisblack-2c-8b-alpha.sh.log tiffcrop-extractz14-miniswhite-1c-1b.sh.log tiffcrop-extractz14-palette-1c-1b.sh.log tiffcrop-extractz14-palette-1c-4b.sh.log tiffcrop-extractz14-palette-1c-8b.sh.log tiffcrop-extractz14-rgb-3c-16b.sh.log tiffcrop-extractz14-rgb-3c-8b.sh.log tiffcrop-R90-logluv-3c-16b.sh.log tiffcrop-R90-minisblack-1c-16b.sh.log tiffcrop-R90-minisblack-1c-8b.sh.log tiffcrop-R90-minisblack-2c-8b-alpha.sh.log tiffcrop-R90-miniswhite-1c-1b.sh.log tiffcrop-R90-palette-1c-1b.sh.log tiffcrop-R90-palette-1c-4b.sh.log tiffcrop-R90-palette-1c-8b.sh.log tiffcrop-R90-rgb-3c-16b.sh.log tiffcrop-R90-rgb-3c-8b.sh.log tiff2rgba-logluv-3c-16b.sh.log tiff2rgba-minisblack-1c-16b.sh.log tiff2rgba-minisblack-1c-8b.sh.log tiff2rgba-minisblack-2c-8b-alpha.sh.log tiff2rgba-miniswhite-1c-1b.sh.log tiff2rgba-palette-1c-1b.sh.log tiff2rgba-palette-1c-4b.sh.log tiff2rgba-palette-1c-8b.sh.log tiff2rgba-rgb-3c-16b.sh.log tiff2rgba-rgb-3c-8b.sh.log tiff2rgba-quad-tile.jpg.sh.log" || rm -f ascii_tag.log long_tag.log short_tag.log strip_rw.log rewrite.log custom_dir.log raw_decode.log bmp2tiff_palette.sh.log bmp2tiff_rgb.sh.log gif2tiff.sh.log ppm2tiff_pbm.sh.log ppm2tiff_pgm.sh.log ppm2tiff_ppm.sh.log tiffcp-g3.sh.log tiffcp-g3-1d.sh.log tiffcp-g3-1d-fill.sh.log tiffcp-g3-2d.sh.log tiffcp-g3-2d-fill.sh.log tiffcp-g4.sh.log tiffcp-logluv.sh.log tiffcp-thumbnail.sh.log tiffdump.sh.log tiffinfo.sh.log tiffcp-split.sh.log tiffcp-split-join.sh.log tiff2ps-PS1.sh.log tiff2ps-PS2.sh.log tiff2ps-PS3.sh.log tiff2ps-EPS1.sh.log tiff2pdf.sh.log tiffcrop-doubleflip-logluv-3c-16b.sh.log tiffcrop-doubleflip-minisblack-1c-16b.sh.log tiffcrop-doubleflip-minisblack-1c-8b.sh.log tiffcrop-doubleflip-minisblack-2c-8b-alpha.sh.log tiffcrop-doubleflip-miniswhite-1c-1b.sh.log tiffcrop-doubleflip-palette-1c-1b.sh.log tiffcrop-doubleflip-palette-1c-4b.sh.log tiffcrop-doubleflip-palette-1c-8b.sh.log tiffcrop-doubleflip-rgb-3c-16b.sh.log tiffcrop-doubleflip-rgb-3c-8b.sh.log tiffcrop-extract-logluv-3c-16b.sh.log tiffcrop-extract-minisblack-1c-16b.sh.log tiffcrop-extract-minisblack-1c-8b.sh.log tiffcrop-extract-minisblack-2c-8b-alpha.sh.log tiffcrop-extract-miniswhite-1c-1b.sh.log tiffcrop-extract-palette-1c-1b.sh.log tiffcrop-extract-palette-1c-4b.sh.log tiffcrop-extract-palette-1c-8b.sh.log tiffcrop-extract-rgb-3c-16b.sh.log tiffcrop-extract-rgb-3c-8b.sh.log tiffcrop-extractz14-logluv-3c-16b.sh.log tiffcrop-extractz14-minisblack-1c-16b.sh.log tiffcrop-extractz14-minisblack-1c-8b.sh.log tiffcrop-extractz14-minisblack-2c-8b-alpha.sh.log tiffcrop-extractz14-miniswhite-1c-1b.sh.log tiffcrop-extractz14-palette-1c-1b.sh.log tiffcrop-extractz14-palette-1c-4b.sh.log tiffcrop-extractz14-palette-1c-8b.sh.log tiffcrop-extractz14-rgb-3c-16b.sh.log tiffcrop-extractz14-rgb-3c-8b.sh.log tiffcrop-R90-logluv-3c-16b.sh.log tiffcrop-R90-minisblack-1c-16b.sh.log tiffcrop-R90-minisblack-1c-8b.sh.log tiffcrop-R90-minisblack-2c-8b-alpha.sh.log tiffcrop-R90-miniswhite-1c-1b.sh.log tiffcrop-R90-palette-1c-1b.sh.log tiffcrop-R90-palette-1c-4b.sh.log tiffcrop-R90-palette-1c-8b.sh.log tiffcrop-R90-rgb-3c-16b.sh.log tiffcrop-R90-rgb-3c-8b.sh.log tiff2rgba-logluv-3c-16b.sh.log tiff2rgba-minisblack-1c-16b.sh.log tiff2rgba-minisblack-1c-8b.sh.log tiff2rgba-minisblack-2c-8b-alpha.sh.log tiff2rgba-miniswhite-1c-1b.sh.log tiff2rgba-palette-1c-1b.sh.log tiff2rgba-palette-1c-4b.sh.log tiff2rgba-palette-1c-8b.sh.log tiff2rgba-rgb-3c-16b.sh.log tiff2rgba-rgb-3c-8b.sh.log tiff2rgba-quad-tile.jpg.sh.log
test -z "ascii_tag.trs long_tag.trs short_tag.trs strip_rw.trs rewrite.trs custom_dir.trs raw_decode.trs bmp2tiff_palette.sh.trs bmp2tiff_rgb.sh.trs gif2tiff.sh.trs ppm2tiff_pbm.sh.trs ppm2tiff_pgm.sh.trs ppm2tiff_ppm.sh.trs tiffcp-g3.sh.trs tiffcp-g3-1d.sh.trs tiffcp-g3-1d-fill.sh.trs tiffcp-g3-2d.sh.trs tiffcp-g3-2d-fill.sh.trs tiffcp-g4.sh.trs tiffcp-logluv.sh.trs tiffcp-thumbnail.sh.trs tiffdump.sh.trs tiffinfo.sh.trs tiffcp-split.sh.trs tiffcp-split-join.sh.trs tiff2ps-PS1.sh.trs tiff2ps-PS2.sh.trs tiff2ps-PS3.sh.trs tiff2ps-EPS1.sh.trs tiff2pdf.sh.trs tiffcrop-doubleflip-logluv-3c-16b.sh.trs tiffcrop-doubleflip-minisblack-1c-16b.sh.trs tiffcrop-doubleflip-minisblack-1c-8b.sh.trs tiffcrop-doubleflip-minisblack-2c-8b-alpha.sh.trs tiffcrop-doubleflip-miniswhite-1c-1b.sh.trs tiffcrop-doubleflip-palette-1c-1b.sh.trs tiffcrop-doubleflip-palette-1c-4b.sh.trs tiffcrop-doubleflip-palette-1c-8b.sh.trs tiffcrop-doubleflip-rgb-3c-16b.sh.trs tiffcrop-doubleflip-rgb-3c-8b.sh.trs tiffcrop-extract-logluv-3c-16b.sh.trs tiffcrop-extract-minisblack-1c-16b.sh.trs tiffcrop-extract-minisblack-1c-8b.sh.trs tiffcrop-extract-minisblack-2c-8b-alpha.sh.trs tiffcrop-extract-miniswhite-1c-1b.sh.trs tiffcrop-extract-palette-1c-1b.sh.trs tiffcrop-extract-palette-1c-4b.sh.trs tiffcrop-extract-palette-1c-8b.sh.trs tiffcrop-extract-rgb-3c-16b.sh.trs tiffcrop-extract-rgb-3c-8b.sh.trs tiffcrop-extractz14-logluv-3c-16b.sh.trs tiffcrop-extractz14-minisblack-1c-16b.sh.trs tiffcrop-extractz14-minisblack-1c-8b.sh.trs tiffcrop-extractz14-minisblack-2c-8b-alpha.sh.trs tiffcrop-extractz14-miniswhite-1c-1b.sh.trs tiffcrop-extractz14-palette-1c-1b.sh.trs tiffcrop-extractz14-palette-1c-4b.sh.trs tiffcrop-extractz14-palette-1c-8b.sh.trs tiffcrop-extractz14-rgb-3c-16b.sh.trs tiffcrop-extractz14-rgb-3c-8b.sh.trs tiffcrop-R90-logluv-3c-16b.sh.trs tiffcrop-R90-minisblack-1c-16b.sh.trs tiffcrop-R90-minisblack-1c-8b.sh.trs tiffcrop-R90-minisblack-2c-8b-alpha.sh.trs tiffcrop-R90-miniswhite-1c-1b.sh.trs tiffcrop-R90-palette-1c-1b.sh.trs tiffcrop-R90-palette-1c-4b.sh.trs tiffcrop-R90-palette-1c-8b.sh.trs tiffcrop-R90-rgb-3c-16b.sh.trs tiffcrop-R90-rgb-3c-8b.sh.trs tiff2rgba-logluv-3c-16b.sh.trs tiff2rgba-minisblack-1c-16b.sh.trs tiff2rgba-minisblack-1c-8b.sh.trs tiff2rgba-minisblack-2c-8b-alpha.sh.trs tiff2rgba-miniswhite-1c-1b.sh.trs tiff2rgba-palette-1c-1b.sh.trs tiff2rgba-palette-1c-4b.sh.trs tiff2rgba-palette-1c-8b.sh.trs tiff2rgba-rgb-3c-16b.sh.trs tiff2rgba-rgb-3c-8b.sh.trs tiff2rgba-quad-tile.jpg.sh.trs" || rm -f ascii_tag.trs long_tag.trs short_tag.trs strip_rw.trs rewrite.trs custom_dir.trs raw_decode.trs bmp2tiff_palette.sh.trs bmp2tiff_rgb.sh.trs gif2tiff.sh.trs ppm2tiff_pbm.sh.trs ppm2tiff_pgm.sh.trs ppm2tiff_ppm.sh.trs tiffcp-g3.sh.trs tiffcp-g3-1d.sh.trs tiffcp-g3-1d-fill.sh.trs tiffcp-g3-2d.sh.trs tiffcp-g3-2d-fill.sh.trs tiffcp-g4.sh.trs tiffcp-logluv.sh.trs tiffcp-thumbnail.sh.trs tiffdump.sh.trs tiffinfo.sh.trs tiffcp-split.sh.trs tiffcp-split-join.sh.trs tiff2ps-PS1.sh.trs tiff2ps-PS2.sh.trs tiff2ps-PS3.sh.trs tiff2ps-EPS1.sh.trs tiff2pdf.sh.trs tiffcrop-doubleflip-logluv-3c-16b.sh.trs tiffcrop-doubleflip-minisblack-1c-16b.sh.trs tiffcrop-doubleflip-minisblack-1c-8b.sh.trs tiffcrop-doubleflip-minisblack-2c-8b-alpha.sh.trs tiffcrop-doubleflip-miniswhite-1c-1b.sh.trs tiffcrop-doubleflip-palette-1c-1b.sh.trs tiffcrop-doubleflip-palette-1c-4b.sh.trs tiffcrop-doubleflip-palette-1c-8b.sh.trs tiffcrop-doubleflip-rgb-3c-16b.sh.trs tiffcrop-doubleflip-rgb-3c-8b.sh.trs tiffcrop-extract-logluv-3c-16b.sh.trs tiffcrop-extract-minisblack-1c-16b.sh.trs tiffcrop-extract-minisblack-1c-8b.sh.trs tiffcrop-extract-minisblack-2c-8b-alpha.sh.trs tiffcrop-extract-miniswhite-1c-1b.sh.trs tiffcrop-extract-palette-1c-1b.sh.trs tiffcrop-extract-palette-1c-4b.sh.trs tiffcrop-extract-palette-1c-8b.sh.trs tiffcrop-extract-rgb-3c-16b.sh.trs tiffcrop-extract-rgb-3c-8b.sh.trs tiffcrop-extractz14-logluv-3c-16b.sh.trs tiffcrop-extractz14-minisblack-1c-16b.sh.trs tiffcrop-extractz14-minisblack-1c-8b.sh.trs tiffcrop-extractz14-minisblack-2c-8b-alpha.sh.trs tiffcrop-extractz14-miniswhite-1c-1b.sh.trs tiffcrop-extractz14-palette-1c-1b.sh.trs tiffcrop-extractz14-palette-1c-4b.sh.trs tiffcrop-extractz14-palette-1c-8b.sh.trs tiffcrop-extractz14-rgb-3c-16b.sh.trs tiffcrop-extractz14-rgb-3c-8b.sh.trs tiffcrop-R90-logluv-3c-16b.sh.trs tiffcrop-R90-minisblack-1c-16b.sh.trs tiffcrop-R90-minisblack-1c-8b.sh.trs tiffcrop-R90-minisblack-2c-8b-alpha.sh.trs tiffcrop-R90-miniswhite-1c-1b.sh.trs tiffcrop-R90-palette-1c-1b.sh.trs tiffcrop-R90-palette-1c-4b.sh.trs tiffcrop-R90-palette-1c-8b.sh.trs tiffcrop-R90-rgb-3c-16b.sh.trs tiffcrop-R90-rgb-3c-8b.sh.trs tiff2rgba-logluv-3c-16b.sh.trs tiff2rgba-minisblack-1c-16b.sh.trs tiff2rgba-minisblack-1c-8b.sh.trs tiff2rgba-minisblack-2c-8b-alpha.sh.trs tiff2rgba-miniswhite-1c-1b.sh.trs tiff2rgba-palette-1c-1b.sh.trs tiff2rgba-palette-1c-4b.sh.trs tiff2rgba-palette-1c-8b.sh.trs tiff2rgba-rgb-3c-16b.sh.trs tiff2rgba-rgb-3c-8b.sh.trs tiff2rgba-quad-tile.jpg.sh.trs
test -z "test-suite.log" || rm -f test-suite.log
rm -f *.lo
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/test'
Making clean in man
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/man'
rm -rf .libs _libs
rm -f *.lo
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/man'
Making clean in html
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html'
Making clean in images
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html/images'
rm -rf .libs _libs
rm -f *.lo
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html/images'
Making clean in man
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html/man'
rm -rf .libs _libs
rm -f *.lo
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html/man'
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html'
rm -rf .libs _libs
rm -f *.lo
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html'
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html'
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src'
rm -rf .libs _libs
rm -f *.lo
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src'
2025-02-03 22:05:04.350 | DEBUG    | shell:__call__:41 - executing: make CFLAGS="${INJECT_CFLAGS}" CXXFLAGS="${INJECT_CXXFLAGS}" LDFLAGS="${INJECT_LDFLAGS}"
Making all in port
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/port'
/bin/bash ../libtool  --tag=CC   --mode=compile crepair-cc -DHAVE_CONFIG_H -I. -I../libtiff     -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -MT dummy.lo -MD -MP -MF .deps/dummy.Tpo -c -o dummy.lo dummy.c
libtool: compile:  crepair-cc -DHAVE_CONFIG_H -I. -I../libtiff -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -MT dummy.lo -MD -MP -MF .deps/dummy.Tpo -c dummy.c -o dummy.o
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_ghost: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
mv -f .deps/dummy.Tpo .deps/dummy.Plo
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address  -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -o libport.la  dummy.lo  -llzma -ljbig -ljpeg -lz -lm 
libtool: link: ar cru .libs/libport.a  dummy.o
ar: `u' modifier ignored since `D' is the default (see `U')
libtool: link: ranlib .libs/libport.a
libtool: link: ( cd ".libs" && rm -f "libport.la" && ln -s "../libport.la" "libport.la" )
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/port'
Making all in libtiff
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/libtiff'
make  all-am
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/libtiff'
/bin/bash ../libtool  --tag=CC   --mode=compile crepair-cc -DHAVE_CONFIG_H -I.     -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -MT tif_aux.lo -MD -MP -MF .deps/tif_aux.Tpo -c -o tif_aux.lo tif_aux.c
libtool: compile:  crepair-cc -DHAVE_CONFIG_H -I. -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -MT tif_aux.lo -MD -MP -MF .deps/tif_aux.Tpo -c tif_aux.c -o tif_aux.o
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_ghost: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
mv -f .deps/tif_aux.Tpo .deps/tif_aux.Plo
/bin/bash ../libtool  --tag=CC   --mode=compile crepair-cc -DHAVE_CONFIG_H -I.     -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -MT tif_close.lo -MD -MP -MF .deps/tif_close.Tpo -c -o tif_close.lo tif_close.c
libtool: compile:  crepair-cc -DHAVE_CONFIG_H -I. -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -MT tif_close.lo -MD -MP -MF .deps/tif_close.Tpo -c tif_close.c -o tif_close.o
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_ghost: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
mv -f .deps/tif_close.Tpo .deps/tif_close.Plo
/bin/bash ../libtool  --tag=CC   --mode=compile crepair-cc -DHAVE_CONFIG_H -I.     -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -MT tif_codec.lo -MD -MP -MF .deps/tif_codec.Tpo -c -o tif_codec.lo tif_codec.c
libtool: compile:  crepair-cc -DHAVE_CONFIG_H -I. -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -MT tif_codec.lo -MD -MP -MF .deps/tif_codec.Tpo -c tif_codec.c -o tif_codec.o
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_ghost: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
mv -f .deps/tif_codec.Tpo .deps/tif_codec.Plo
/bin/bash ../libtool  --tag=CC   --mode=compile crepair-cc -DHAVE_CONFIG_H -I.     -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -MT tif_color.lo -MD -MP -MF .deps/tif_color.Tpo -c -o tif_color.lo tif_color.c
libtool: compile:  crepair-cc -DHAVE_CONFIG_H -I. -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -MT tif_color.lo -MD -MP -MF .deps/tif_color.Tpo -c tif_color.c -o tif_color.o
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_ghost: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
mv -f .deps/tif_color.Tpo .deps/tif_color.Plo
/bin/bash ../libtool  --tag=CC   --mode=compile crepair-cc -DHAVE_CONFIG_H -I.     -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -MT tif_compress.lo -MD -MP -MF .deps/tif_compress.Tpo -c -o tif_compress.lo tif_compress.c
libtool: compile:  crepair-cc -DHAVE_CONFIG_H -I. -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -MT tif_compress.lo -MD -MP -MF .deps/tif_compress.Tpo -c tif_compress.c -o tif_compress.o
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_ghost: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
mv -f .deps/tif_compress.Tpo .deps/tif_compress.Plo
/bin/bash ../libtool  --tag=CC   --mode=compile crepair-cc -DHAVE_CONFIG_H -I.     -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -MT tif_dir.lo -MD -MP -MF .deps/tif_dir.Tpo -c -o tif_dir.lo tif_dir.c
libtool: compile:  crepair-cc -DHAVE_CONFIG_H -I. -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -MT tif_dir.lo -MD -MP -MF .deps/tif_dir.Tpo -c tif_dir.c -o tif_dir.o
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_ghost: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
mv -f .deps/tif_dir.Tpo .deps/tif_dir.Plo
/bin/bash ../libtool  --tag=CC   --mode=compile crepair-cc -DHAVE_CONFIG_H -I.     -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -MT tif_dirinfo.lo -MD -MP -MF .deps/tif_dirinfo.Tpo -c -o tif_dirinfo.lo tif_dirinfo.c
libtool: compile:  crepair-cc -DHAVE_CONFIG_H -I. -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -MT tif_dirinfo.lo -MD -MP -MF .deps/tif_dirinfo.Tpo -c tif_dirinfo.c -o tif_dirinfo.o
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_ghost: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
mv -f .deps/tif_dirinfo.Tpo .deps/tif_dirinfo.Plo
/bin/bash ../libtool  --tag=CC   --mode=compile crepair-cc -DHAVE_CONFIG_H -I.     -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -MT tif_dirread.lo -MD -MP -MF .deps/tif_dirread.Tpo -c -o tif_dirread.lo tif_dirread.c
libtool: compile:  crepair-cc -DHAVE_CONFIG_H -I. -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -MT tif_dirread.lo -MD -MP -MF .deps/tif_dirread.Tpo -c tif_dirread.c -o tif_dirread.o
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_ghost: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
mv -f .deps/tif_dirread.Tpo .deps/tif_dirread.Plo
/bin/bash ../libtool  --tag=CC   --mode=compile crepair-cc -DHAVE_CONFIG_H -I.     -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -MT tif_dirwrite.lo -MD -MP -MF .deps/tif_dirwrite.Tpo -c -o tif_dirwrite.lo tif_dirwrite.c
libtool: compile:  crepair-cc -DHAVE_CONFIG_H -I. -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -MT tif_dirwrite.lo -MD -MP -MF .deps/tif_dirwrite.Tpo -c tif_dirwrite.c -o tif_dirwrite.o
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_ghost: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
mv -f .deps/tif_dirwrite.Tpo .deps/tif_dirwrite.Plo
/bin/bash ../libtool  --tag=CC   --mode=compile crepair-cc -DHAVE_CONFIG_H -I.     -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -MT tif_dumpmode.lo -MD -MP -MF .deps/tif_dumpmode.Tpo -c -o tif_dumpmode.lo tif_dumpmode.c
libtool: compile:  crepair-cc -DHAVE_CONFIG_H -I. -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -MT tif_dumpmode.lo -MD -MP -MF .deps/tif_dumpmode.Tpo -c tif_dumpmode.c -o tif_dumpmode.o
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_ghost: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
mv -f .deps/tif_dumpmode.Tpo .deps/tif_dumpmode.Plo
/bin/bash ../libtool  --tag=CC   --mode=compile crepair-cc -DHAVE_CONFIG_H -I.     -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -MT tif_error.lo -MD -MP -MF .deps/tif_error.Tpo -c -o tif_error.lo tif_error.c
libtool: compile:  crepair-cc -DHAVE_CONFIG_H -I. -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -MT tif_error.lo -MD -MP -MF .deps/tif_error.Tpo -c tif_error.c -o tif_error.o
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_ghost: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
mv -f .deps/tif_error.Tpo .deps/tif_error.Plo
/bin/bash ../libtool  --tag=CC   --mode=compile crepair-cc -DHAVE_CONFIG_H -I.     -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -MT tif_extension.lo -MD -MP -MF .deps/tif_extension.Tpo -c -o tif_extension.lo tif_extension.c
libtool: compile:  crepair-cc -DHAVE_CONFIG_H -I. -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -MT tif_extension.lo -MD -MP -MF .deps/tif_extension.Tpo -c tif_extension.c -o tif_extension.o
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_ghost: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
mv -f .deps/tif_extension.Tpo .deps/tif_extension.Plo
/bin/bash ../libtool  --tag=CC   --mode=compile crepair-cc -DHAVE_CONFIG_H -I.     -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -MT tif_fax3.lo -MD -MP -MF .deps/tif_fax3.Tpo -c -o tif_fax3.lo tif_fax3.c
libtool: compile:  crepair-cc -DHAVE_CONFIG_H -I. -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -MT tif_fax3.lo -MD -MP -MF .deps/tif_fax3.Tpo -c tif_fax3.c -o tif_fax3.o
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_ghost: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
mv -f .deps/tif_fax3.Tpo .deps/tif_fax3.Plo
/bin/bash ../libtool  --tag=CC   --mode=compile crepair-cc -DHAVE_CONFIG_H -I.     -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -MT tif_fax3sm.lo -MD -MP -MF .deps/tif_fax3sm.Tpo -c -o tif_fax3sm.lo tif_fax3sm.c
libtool: compile:  crepair-cc -DHAVE_CONFIG_H -I. -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -MT tif_fax3sm.lo -MD -MP -MF .deps/tif_fax3sm.Tpo -c tif_fax3sm.c -o tif_fax3sm.o
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_ghost: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
mv -f .deps/tif_fax3sm.Tpo .deps/tif_fax3sm.Plo
/bin/bash ../libtool  --tag=CC   --mode=compile crepair-cc -DHAVE_CONFIG_H -I.     -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -MT tif_flush.lo -MD -MP -MF .deps/tif_flush.Tpo -c -o tif_flush.lo tif_flush.c
libtool: compile:  crepair-cc -DHAVE_CONFIG_H -I. -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -MT tif_flush.lo -MD -MP -MF .deps/tif_flush.Tpo -c tif_flush.c -o tif_flush.o
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_ghost: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
mv -f .deps/tif_flush.Tpo .deps/tif_flush.Plo
/bin/bash ../libtool  --tag=CC   --mode=compile crepair-cc -DHAVE_CONFIG_H -I.     -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -MT tif_getimage.lo -MD -MP -MF .deps/tif_getimage.Tpo -c -o tif_getimage.lo tif_getimage.c
libtool: compile:  crepair-cc -DHAVE_CONFIG_H -I. -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -MT tif_getimage.lo -MD -MP -MF .deps/tif_getimage.Tpo -c tif_getimage.c -o tif_getimage.o
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_ghost: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
mv -f .deps/tif_getimage.Tpo .deps/tif_getimage.Plo
/bin/bash ../libtool  --tag=CC   --mode=compile crepair-cc -DHAVE_CONFIG_H -I.     -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -MT tif_jbig.lo -MD -MP -MF .deps/tif_jbig.Tpo -c -o tif_jbig.lo tif_jbig.c
libtool: compile:  crepair-cc -DHAVE_CONFIG_H -I. -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -MT tif_jbig.lo -MD -MP -MF .deps/tif_jbig.Tpo -c tif_jbig.c -o tif_jbig.o
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_ghost: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
mv -f .deps/tif_jbig.Tpo .deps/tif_jbig.Plo
/bin/bash ../libtool  --tag=CC   --mode=compile crepair-cc -DHAVE_CONFIG_H -I.     -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -MT tif_jpeg.lo -MD -MP -MF .deps/tif_jpeg.Tpo -c -o tif_jpeg.lo tif_jpeg.c
libtool: compile:  crepair-cc -DHAVE_CONFIG_H -I. -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -MT tif_jpeg.lo -MD -MP -MF .deps/tif_jpeg.Tpo -c tif_jpeg.c -o tif_jpeg.o
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_ghost: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
mv -f .deps/tif_jpeg.Tpo .deps/tif_jpeg.Plo
/bin/bash ../libtool  --tag=CC   --mode=compile crepair-cc -DHAVE_CONFIG_H -I.     -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -MT tif_jpeg_12.lo -MD -MP -MF .deps/tif_jpeg_12.Tpo -c -o tif_jpeg_12.lo tif_jpeg_12.c
libtool: compile:  crepair-cc -DHAVE_CONFIG_H -I. -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -MT tif_jpeg_12.lo -MD -MP -MF .deps/tif_jpeg_12.Tpo -c tif_jpeg_12.c -o tif_jpeg_12.o
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_ghost: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
mv -f .deps/tif_jpeg_12.Tpo .deps/tif_jpeg_12.Plo
/bin/bash ../libtool  --tag=CC   --mode=compile crepair-cc -DHAVE_CONFIG_H -I.     -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -MT tif_luv.lo -MD -MP -MF .deps/tif_luv.Tpo -c -o tif_luv.lo tif_luv.c
libtool: compile:  crepair-cc -DHAVE_CONFIG_H -I. -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -MT tif_luv.lo -MD -MP -MF .deps/tif_luv.Tpo -c tif_luv.c -o tif_luv.o
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_ghost: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
tif_luv.c:872:12: warning: implicit declaration of function 'fabs_crepair' is invalid in C99 [-Wimplicit-function-declaration]
                                epsa = fabs_crepair(ang - (i+.5));
                                       ^
1 warning generated.
tif_luv.c:872:12: warning: implicit declaration of function 'fabs_crepair' is invalid in C99 [-Wimplicit-function-declaration]
                                epsa = fabs_crepair(ang - (i+.5));
                                       ^
1 warning generated.
mv -f .deps/tif_luv.Tpo .deps/tif_luv.Plo
/bin/bash ../libtool  --tag=CC   --mode=compile crepair-cc -DHAVE_CONFIG_H -I.     -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -MT tif_lzma.lo -MD -MP -MF .deps/tif_lzma.Tpo -c -o tif_lzma.lo tif_lzma.c
libtool: compile:  crepair-cc -DHAVE_CONFIG_H -I. -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -MT tif_lzma.lo -MD -MP -MF .deps/tif_lzma.Tpo -c tif_lzma.c -o tif_lzma.o
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_ghost: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
mv -f .deps/tif_lzma.Tpo .deps/tif_lzma.Plo
/bin/bash ../libtool  --tag=CC   --mode=compile crepair-cc -DHAVE_CONFIG_H -I.     -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -MT tif_lzw.lo -MD -MP -MF .deps/tif_lzw.Tpo -c -o tif_lzw.lo tif_lzw.c
libtool: compile:  crepair-cc -DHAVE_CONFIG_H -I. -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -MT tif_lzw.lo -MD -MP -MF .deps/tif_lzw.Tpo -c tif_lzw.c -o tif_lzw.o
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_ghost: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
mv -f .deps/tif_lzw.Tpo .deps/tif_lzw.Plo
/bin/bash ../libtool  --tag=CC   --mode=compile crepair-cc -DHAVE_CONFIG_H -I.     -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -MT tif_next.lo -MD -MP -MF .deps/tif_next.Tpo -c -o tif_next.lo tif_next.c
libtool: compile:  crepair-cc -DHAVE_CONFIG_H -I. -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -MT tif_next.lo -MD -MP -MF .deps/tif_next.Tpo -c tif_next.c -o tif_next.o
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_ghost: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
mv -f .deps/tif_next.Tpo .deps/tif_next.Plo
/bin/bash ../libtool  --tag=CC   --mode=compile crepair-cc -DHAVE_CONFIG_H -I.     -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -MT tif_ojpeg.lo -MD -MP -MF .deps/tif_ojpeg.Tpo -c -o tif_ojpeg.lo tif_ojpeg.c
libtool: compile:  crepair-cc -DHAVE_CONFIG_H -I. -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -MT tif_ojpeg.lo -MD -MP -MF .deps/tif_ojpeg.Tpo -c tif_ojpeg.c -o tif_ojpeg.o
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_ghost: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
mv -f .deps/tif_ojpeg.Tpo .deps/tif_ojpeg.Plo
/bin/bash ../libtool  --tag=CC   --mode=compile crepair-cc -DHAVE_CONFIG_H -I.     -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -MT tif_open.lo -MD -MP -MF .deps/tif_open.Tpo -c -o tif_open.lo tif_open.c
libtool: compile:  crepair-cc -DHAVE_CONFIG_H -I. -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -MT tif_open.lo -MD -MP -MF .deps/tif_open.Tpo -c tif_open.c -o tif_open.o
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_ghost: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
mv -f .deps/tif_open.Tpo .deps/tif_open.Plo
/bin/bash ../libtool  --tag=CC   --mode=compile crepair-cc -DHAVE_CONFIG_H -I.     -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -MT tif_packbits.lo -MD -MP -MF .deps/tif_packbits.Tpo -c -o tif_packbits.lo tif_packbits.c
libtool: compile:  crepair-cc -DHAVE_CONFIG_H -I. -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -MT tif_packbits.lo -MD -MP -MF .deps/tif_packbits.Tpo -c tif_packbits.c -o tif_packbits.o
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_ghost: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
mv -f .deps/tif_packbits.Tpo .deps/tif_packbits.Plo
/bin/bash ../libtool  --tag=CC   --mode=compile crepair-cc -DHAVE_CONFIG_H -I.     -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -MT tif_pixarlog.lo -MD -MP -MF .deps/tif_pixarlog.Tpo -c -o tif_pixarlog.lo tif_pixarlog.c
libtool: compile:  crepair-cc -DHAVE_CONFIG_H -I. -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -MT tif_pixarlog.lo -MD -MP -MF .deps/tif_pixarlog.Tpo -c tif_pixarlog.c -o tif_pixarlog.o
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_ghost: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
mv -f .deps/tif_pixarlog.Tpo .deps/tif_pixarlog.Plo
/bin/bash ../libtool  --tag=CC   --mode=compile crepair-cc -DHAVE_CONFIG_H -I.     -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -MT tif_predict.lo -MD -MP -MF .deps/tif_predict.Tpo -c -o tif_predict.lo tif_predict.c
libtool: compile:  crepair-cc -DHAVE_CONFIG_H -I. -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -MT tif_predict.lo -MD -MP -MF .deps/tif_predict.Tpo -c tif_predict.c -o tif_predict.o
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_ghost: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
mv -f .deps/tif_predict.Tpo .deps/tif_predict.Plo
/bin/bash ../libtool  --tag=CC   --mode=compile crepair-cc -DHAVE_CONFIG_H -I.     -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -MT tif_print.lo -MD -MP -MF .deps/tif_print.Tpo -c -o tif_print.lo tif_print.c
libtool: compile:  crepair-cc -DHAVE_CONFIG_H -I. -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -MT tif_print.lo -MD -MP -MF .deps/tif_print.Tpo -c tif_print.c -o tif_print.o
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_ghost: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
mv -f .deps/tif_print.Tpo .deps/tif_print.Plo
/bin/bash ../libtool  --tag=CC   --mode=compile crepair-cc -DHAVE_CONFIG_H -I.     -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -MT tif_read.lo -MD -MP -MF .deps/tif_read.Tpo -c -o tif_read.lo tif_read.c
libtool: compile:  crepair-cc -DHAVE_CONFIG_H -I. -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -MT tif_read.lo -MD -MP -MF .deps/tif_read.Tpo -c tif_read.c -o tif_read.o
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_ghost: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
mv -f .deps/tif_read.Tpo .deps/tif_read.Plo
/bin/bash ../libtool  --tag=CC   --mode=compile crepair-cc -DHAVE_CONFIG_H -I.     -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -MT tif_strip.lo -MD -MP -MF .deps/tif_strip.Tpo -c -o tif_strip.lo tif_strip.c
libtool: compile:  crepair-cc -DHAVE_CONFIG_H -I. -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -MT tif_strip.lo -MD -MP -MF .deps/tif_strip.Tpo -c tif_strip.c -o tif_strip.o
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_ghost: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
mv -f .deps/tif_strip.Tpo .deps/tif_strip.Plo
/bin/bash ../libtool  --tag=CC   --mode=compile crepair-cc -DHAVE_CONFIG_H -I.     -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -MT tif_swab.lo -MD -MP -MF .deps/tif_swab.Tpo -c -o tif_swab.lo tif_swab.c
libtool: compile:  crepair-cc -DHAVE_CONFIG_H -I. -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -MT tif_swab.lo -MD -MP -MF .deps/tif_swab.Tpo -c tif_swab.c -o tif_swab.o
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_ghost: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
mv -f .deps/tif_swab.Tpo .deps/tif_swab.Plo
/bin/bash ../libtool  --tag=CC   --mode=compile crepair-cc -DHAVE_CONFIG_H -I.     -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -MT tif_thunder.lo -MD -MP -MF .deps/tif_thunder.Tpo -c -o tif_thunder.lo tif_thunder.c
libtool: compile:  crepair-cc -DHAVE_CONFIG_H -I. -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -MT tif_thunder.lo -MD -MP -MF .deps/tif_thunder.Tpo -c tif_thunder.c -o tif_thunder.o
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_ghost: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
mv -f .deps/tif_thunder.Tpo .deps/tif_thunder.Plo
/bin/bash ../libtool  --tag=CC   --mode=compile crepair-cc -DHAVE_CONFIG_H -I.     -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -MT tif_tile.lo -MD -MP -MF .deps/tif_tile.Tpo -c -o tif_tile.lo tif_tile.c
libtool: compile:  crepair-cc -DHAVE_CONFIG_H -I. -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -MT tif_tile.lo -MD -MP -MF .deps/tif_tile.Tpo -c tif_tile.c -o tif_tile.o
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_ghost: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
mv -f .deps/tif_tile.Tpo .deps/tif_tile.Plo
/bin/bash ../libtool  --tag=CC   --mode=compile crepair-cc -DHAVE_CONFIG_H -I.     -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -MT tif_version.lo -MD -MP -MF .deps/tif_version.Tpo -c -o tif_version.lo tif_version.c
libtool: compile:  crepair-cc -DHAVE_CONFIG_H -I. -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -MT tif_version.lo -MD -MP -MF .deps/tif_version.Tpo -c tif_version.c -o tif_version.o
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_ghost: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
mv -f .deps/tif_version.Tpo .deps/tif_version.Plo
/bin/bash ../libtool  --tag=CC   --mode=compile crepair-cc -DHAVE_CONFIG_H -I.     -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -MT tif_warning.lo -MD -MP -MF .deps/tif_warning.Tpo -c -o tif_warning.lo tif_warning.c
libtool: compile:  crepair-cc -DHAVE_CONFIG_H -I. -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -MT tif_warning.lo -MD -MP -MF .deps/tif_warning.Tpo -c tif_warning.c -o tif_warning.o
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_ghost: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
mv -f .deps/tif_warning.Tpo .deps/tif_warning.Plo
/bin/bash ../libtool  --tag=CC   --mode=compile crepair-cc -DHAVE_CONFIG_H -I.     -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -MT tif_write.lo -MD -MP -MF .deps/tif_write.Tpo -c -o tif_write.lo tif_write.c
libtool: compile:  crepair-cc -DHAVE_CONFIG_H -I. -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -MT tif_write.lo -MD -MP -MF .deps/tif_write.Tpo -c tif_write.c -o tif_write.o
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_ghost: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
mv -f .deps/tif_write.Tpo .deps/tif_write.Plo
/bin/bash ../libtool  --tag=CC   --mode=compile crepair-cc -DHAVE_CONFIG_H -I.     -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -MT tif_zip.lo -MD -MP -MF .deps/tif_zip.Tpo -c -o tif_zip.lo tif_zip.c
libtool: compile:  crepair-cc -DHAVE_CONFIG_H -I. -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -MT tif_zip.lo -MD -MP -MF .deps/tif_zip.Tpo -c tif_zip.c -o tif_zip.o
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_ghost: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
mv -f .deps/tif_zip.Tpo .deps/tif_zip.Plo
/bin/bash ../libtool  --tag=CC   --mode=compile crepair-cc -DHAVE_CONFIG_H -I.     -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -MT tif_unix.lo -MD -MP -MF .deps/tif_unix.Tpo -c -o tif_unix.lo tif_unix.c
libtool: compile:  crepair-cc -DHAVE_CONFIG_H -I. -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -MT tif_unix.lo -MD -MP -MF .deps/tif_unix.Tpo -c tif_unix.c -o tif_unix.o
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_ghost: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
mv -f .deps/tif_unix.Tpo .deps/tif_unix.Plo
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -no-undefined -version-info 7:4:2   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -o libtiff.la -rpath /usr/local/lib tif_aux.lo tif_close.lo tif_codec.lo tif_color.lo tif_compress.lo tif_dir.lo tif_dirinfo.lo tif_dirread.lo tif_dirwrite.lo tif_dumpmode.lo tif_error.lo tif_extension.lo tif_fax3.lo tif_fax3sm.lo tif_flush.lo tif_getimage.lo tif_jbig.lo tif_jpeg.lo tif_jpeg_12.lo tif_luv.lo tif_lzma.lo tif_lzw.lo tif_next.lo tif_ojpeg.lo tif_open.lo tif_packbits.lo tif_pixarlog.lo tif_predict.lo tif_print.lo tif_read.lo tif_strip.lo tif_swab.lo tif_thunder.lo tif_tile.lo tif_version.lo tif_warning.lo tif_write.lo tif_zip.lo  tif_unix.lo ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: (cd .libs/libtiff.lax/libport.a && ar x "/data/vulnloc/libtiff/CVE-2016-5321/src/libtiff/../port/.libs/libport.a")
libtool: link: ar cru .libs/libtiff.a  tif_aux.o tif_close.o tif_codec.o tif_color.o tif_compress.o tif_dir.o tif_dirinfo.o tif_dirread.o tif_dirwrite.o tif_dumpmode.o tif_error.o tif_extension.o tif_fax3.o tif_fax3sm.o tif_flush.o tif_getimage.o tif_jbig.o tif_jpeg.o tif_jpeg_12.o tif_luv.o tif_lzma.o tif_lzw.o tif_next.o tif_ojpeg.o tif_open.o tif_packbits.o tif_pixarlog.o tif_predict.o tif_print.o tif_read.o tif_strip.o tif_swab.o tif_thunder.o tif_tile.o tif_version.o tif_warning.o tif_write.o tif_zip.o tif_unix.o  .libs/libtiff.lax/libport.a/dummy.o 
ar: `u' modifier ignored since `D' is the default (see `U')
libtool: link: ranlib .libs/libtiff.a
libtool: link: rm -fr .libs/libtiff.lax
libtool: link: ( cd ".libs" && rm -f "libtiff.la" && ln -s "../libtiff.la" "libtiff.la" )
/bin/bash ../libtool  --tag=CXX   --mode=compile crepair-cxx -DHAVE_CONFIG_H -I.     -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -MT tif_stream.lo -MD -MP -MF .deps/tif_stream.Tpo -c -o tif_stream.lo tif_stream.cxx
libtool: compile:  crepair-cxx -DHAVE_CONFIG_H -I. -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -MT tif_stream.lo -MD -MP -MF .deps/tif_stream.Tpo -c tif_stream.cxx -o tif_stream.o
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_ghost: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
mv -f .deps/tif_stream.Tpo .deps/tif_stream.Plo
/bin/bash ../libtool  --tag=CXX   --mode=link crepair-cxx  -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -no-undefined -version-info 7:4:2   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -o libtiffxx.la -rpath /usr/local/lib tif_stream.lo ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: (cd .libs/libtiffxx.lax/libport.a && ar x "/data/vulnloc/libtiff/CVE-2016-5321/src/libtiff/../port/.libs/libport.a")
libtool: link: ar cru .libs/libtiffxx.a  tif_stream.o  .libs/libtiffxx.lax/libport.a/dummy.o 
ar: `u' modifier ignored since `D' is the default (see `U')
libtool: link: ranlib .libs/libtiffxx.a
libtool: link: rm -fr .libs/libtiffxx.lax
libtool: link: ( cd ".libs" && rm -f "libtiffxx.la" && ln -s "../libtiffxx.la" "libtiffxx.la" )
crepair-cc -DHAVE_CONFIG_H -I.     -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -MT mkg3states.o -MD -MP -MF .deps/mkg3states.Tpo -c -o mkg3states.o mkg3states.c
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_ghost: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
mv -f .deps/mkg3states.Tpo .deps/mkg3states.Po
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address  -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -o mkg3states mkg3states.o ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -g -O0 -Wno-error -I/CrashRepair/lib -fsanitize=address -g -O0 -Wno-error -I/CrashRepair/lib -fsanitize=address -o mkg3states mkg3states.o  -L/klee/build/lib -L/CrashRepair/lib ../port/.libs/libport.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -llzma -ljbig -ljpeg -lz -lm
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/libtiff'
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/libtiff'
Making all in tools
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/tools'
crepair-cc -DHAVE_CONFIG_H -I. -I../libtiff  -I../libtiff   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -MT bmp2tiff.o -MD -MP -MF .deps/bmp2tiff.Tpo -c -o bmp2tiff.o bmp2tiff.c
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_ghost: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
mv -f .deps/bmp2tiff.Tpo .deps/bmp2tiff.Po
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address  -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -o bmp2tiff bmp2tiff.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -g -O0 -Wno-error -I/CrashRepair/lib -fsanitize=address -g -O0 -Wno-error -I/CrashRepair/lib -fsanitize=address -o bmp2tiff bmp2tiff.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a ../port/.libs/libport.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -llzma -ljbig -ljpeg -lz -lm
crepair-cc -DHAVE_CONFIG_H -I. -I../libtiff  -I../libtiff   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -MT fax2ps.o -MD -MP -MF .deps/fax2ps.Tpo -c -o fax2ps.o fax2ps.c
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_ghost: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
mv -f .deps/fax2ps.Tpo .deps/fax2ps.Po
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address  -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -o fax2ps fax2ps.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -g -O0 -Wno-error -I/CrashRepair/lib -fsanitize=address -g -O0 -Wno-error -I/CrashRepair/lib -fsanitize=address -o fax2ps fax2ps.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a ../port/.libs/libport.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -llzma -ljbig -ljpeg -lz -lm
crepair-cc -DHAVE_CONFIG_H -I. -I../libtiff  -I../libtiff   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -MT fax2tiff.o -MD -MP -MF .deps/fax2tiff.Tpo -c -o fax2tiff.o fax2tiff.c
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_ghost: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
mv -f .deps/fax2tiff.Tpo .deps/fax2tiff.Po
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address  -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -o fax2tiff fax2tiff.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -g -O0 -Wno-error -I/CrashRepair/lib -fsanitize=address -g -O0 -Wno-error -I/CrashRepair/lib -fsanitize=address -o fax2tiff fax2tiff.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a ../port/.libs/libport.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -llzma -ljbig -ljpeg -lz -lm
crepair-cc -DHAVE_CONFIG_H -I. -I../libtiff  -I../libtiff   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -MT gif2tiff.o -MD -MP -MF .deps/gif2tiff.Tpo -c -o gif2tiff.o gif2tiff.c
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_ghost: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
mv -f .deps/gif2tiff.Tpo .deps/gif2tiff.Po
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address  -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -o gif2tiff gif2tiff.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -g -O0 -Wno-error -I/CrashRepair/lib -fsanitize=address -g -O0 -Wno-error -I/CrashRepair/lib -fsanitize=address -o gif2tiff gif2tiff.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a ../port/.libs/libport.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -llzma -ljbig -ljpeg -lz -lm
crepair-cc -DHAVE_CONFIG_H -I. -I../libtiff  -I../libtiff   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -MT pal2rgb.o -MD -MP -MF .deps/pal2rgb.Tpo -c -o pal2rgb.o pal2rgb.c
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_ghost: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
mv -f .deps/pal2rgb.Tpo .deps/pal2rgb.Po
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address  -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -o pal2rgb pal2rgb.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -g -O0 -Wno-error -I/CrashRepair/lib -fsanitize=address -g -O0 -Wno-error -I/CrashRepair/lib -fsanitize=address -o pal2rgb pal2rgb.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a ../port/.libs/libport.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -llzma -ljbig -ljpeg -lz -lm
crepair-cc -DHAVE_CONFIG_H -I. -I../libtiff  -I../libtiff   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -MT ppm2tiff.o -MD -MP -MF .deps/ppm2tiff.Tpo -c -o ppm2tiff.o ppm2tiff.c
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_ghost: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
mv -f .deps/ppm2tiff.Tpo .deps/ppm2tiff.Po
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address  -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -o ppm2tiff ppm2tiff.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -g -O0 -Wno-error -I/CrashRepair/lib -fsanitize=address -g -O0 -Wno-error -I/CrashRepair/lib -fsanitize=address -o ppm2tiff ppm2tiff.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a ../port/.libs/libport.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -llzma -ljbig -ljpeg -lz -lm
crepair-cc -DHAVE_CONFIG_H -I. -I../libtiff  -I../libtiff   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -MT ras2tiff.o -MD -MP -MF .deps/ras2tiff.Tpo -c -o ras2tiff.o ras2tiff.c
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_ghost: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
mv -f .deps/ras2tiff.Tpo .deps/ras2tiff.Po
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address  -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -o ras2tiff ras2tiff.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -g -O0 -Wno-error -I/CrashRepair/lib -fsanitize=address -g -O0 -Wno-error -I/CrashRepair/lib -fsanitize=address -o ras2tiff ras2tiff.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a ../port/.libs/libport.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -llzma -ljbig -ljpeg -lz -lm
crepair-cc -DHAVE_CONFIG_H -I. -I../libtiff  -I../libtiff   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -MT raw2tiff.o -MD -MP -MF .deps/raw2tiff.Tpo -c -o raw2tiff.o raw2tiff.c
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_ghost: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
mv -f .deps/raw2tiff.Tpo .deps/raw2tiff.Po
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address  -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -o raw2tiff raw2tiff.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -g -O0 -Wno-error -I/CrashRepair/lib -fsanitize=address -g -O0 -Wno-error -I/CrashRepair/lib -fsanitize=address -o raw2tiff raw2tiff.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a ../port/.libs/libport.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -llzma -ljbig -ljpeg -lz -lm
crepair-cc -DHAVE_CONFIG_H -I. -I../libtiff  -I../libtiff   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -MT rgb2ycbcr.o -MD -MP -MF .deps/rgb2ycbcr.Tpo -c -o rgb2ycbcr.o rgb2ycbcr.c
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_ghost: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
mv -f .deps/rgb2ycbcr.Tpo .deps/rgb2ycbcr.Po
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address  -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -o rgb2ycbcr rgb2ycbcr.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -g -O0 -Wno-error -I/CrashRepair/lib -fsanitize=address -g -O0 -Wno-error -I/CrashRepair/lib -fsanitize=address -o rgb2ycbcr rgb2ycbcr.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a ../port/.libs/libport.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -llzma -ljbig -ljpeg -lz -lm
crepair-cc -DHAVE_CONFIG_H -I. -I../libtiff  -I../libtiff   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -MT thumbnail.o -MD -MP -MF .deps/thumbnail.Tpo -c -o thumbnail.o thumbnail.c
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_ghost: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
mv -f .deps/thumbnail.Tpo .deps/thumbnail.Po
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address  -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -o thumbnail thumbnail.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -g -O0 -Wno-error -I/CrashRepair/lib -fsanitize=address -g -O0 -Wno-error -I/CrashRepair/lib -fsanitize=address -o thumbnail thumbnail.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a ../port/.libs/libport.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -llzma -ljbig -ljpeg -lz -lm
crepair-cc -DHAVE_CONFIG_H -I. -I../libtiff  -I../libtiff   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -MT tiff2bw.o -MD -MP -MF .deps/tiff2bw.Tpo -c -o tiff2bw.o tiff2bw.c
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_ghost: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
mv -f .deps/tiff2bw.Tpo .deps/tiff2bw.Po
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address  -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -o tiff2bw tiff2bw.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -g -O0 -Wno-error -I/CrashRepair/lib -fsanitize=address -g -O0 -Wno-error -I/CrashRepair/lib -fsanitize=address -o tiff2bw tiff2bw.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a ../port/.libs/libport.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -llzma -ljbig -ljpeg -lz -lm
crepair-cc -DHAVE_CONFIG_H -I. -I../libtiff  -I../libtiff   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -MT tiff2pdf.o -MD -MP -MF .deps/tiff2pdf.Tpo -c -o tiff2pdf.o tiff2pdf.c
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_ghost: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
mv -f .deps/tiff2pdf.Tpo .deps/tiff2pdf.Po
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address  -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -o tiff2pdf tiff2pdf.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -g -O0 -Wno-error -I/CrashRepair/lib -fsanitize=address -g -O0 -Wno-error -I/CrashRepair/lib -fsanitize=address -o tiff2pdf tiff2pdf.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a ../port/.libs/libport.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -llzma -ljbig -ljpeg -lz -lm
crepair-cc -DHAVE_CONFIG_H -I. -I../libtiff  -I../libtiff   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -MT tiff2ps.o -MD -MP -MF .deps/tiff2ps.Tpo -c -o tiff2ps.o tiff2ps.c
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_ghost: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
mv -f .deps/tiff2ps.Tpo .deps/tiff2ps.Po
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address  -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -o tiff2ps tiff2ps.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -g -O0 -Wno-error -I/CrashRepair/lib -fsanitize=address -g -O0 -Wno-error -I/CrashRepair/lib -fsanitize=address -o tiff2ps tiff2ps.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a ../port/.libs/libport.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -llzma -ljbig -ljpeg -lz -lm
crepair-cc -DHAVE_CONFIG_H -I. -I../libtiff  -I../libtiff   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -MT tiff2rgba.o -MD -MP -MF .deps/tiff2rgba.Tpo -c -o tiff2rgba.o tiff2rgba.c
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_ghost: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
mv -f .deps/tiff2rgba.Tpo .deps/tiff2rgba.Po
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address  -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -o tiff2rgba tiff2rgba.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -g -O0 -Wno-error -I/CrashRepair/lib -fsanitize=address -g -O0 -Wno-error -I/CrashRepair/lib -fsanitize=address -o tiff2rgba tiff2rgba.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a ../port/.libs/libport.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -llzma -ljbig -ljpeg -lz -lm
crepair-cc -DHAVE_CONFIG_H -I. -I../libtiff  -I../libtiff   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -MT tiffcmp.o -MD -MP -MF .deps/tiffcmp.Tpo -c -o tiffcmp.o tiffcmp.c
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_ghost: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
mv -f .deps/tiffcmp.Tpo .deps/tiffcmp.Po
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address  -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -o tiffcmp tiffcmp.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -g -O0 -Wno-error -I/CrashRepair/lib -fsanitize=address -g -O0 -Wno-error -I/CrashRepair/lib -fsanitize=address -o tiffcmp tiffcmp.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a ../port/.libs/libport.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -llzma -ljbig -ljpeg -lz -lm
crepair-cc -DHAVE_CONFIG_H -I. -I../libtiff  -I../libtiff   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -MT tiffcp.o -MD -MP -MF .deps/tiffcp.Tpo -c -o tiffcp.o tiffcp.c
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_ghost: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
mv -f .deps/tiffcp.Tpo .deps/tiffcp.Po
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address  -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -o tiffcp tiffcp.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -g -O0 -Wno-error -I/CrashRepair/lib -fsanitize=address -g -O0 -Wno-error -I/CrashRepair/lib -fsanitize=address -o tiffcp tiffcp.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a ../port/.libs/libport.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -llzma -ljbig -ljpeg -lz -lm
crepair-cc -DHAVE_CONFIG_H -I. -I../libtiff  -I../libtiff   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -MT tiffcrop.o -MD -MP -MF .deps/tiffcrop.Tpo -c -o tiffcrop.o tiffcrop.c
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_ghost: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
mv -f .deps/tiffcrop.Tpo .deps/tiffcrop.Po
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address  -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -o tiffcrop tiffcrop.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -g -O0 -Wno-error -I/CrashRepair/lib -fsanitize=address -g -O0 -Wno-error -I/CrashRepair/lib -fsanitize=address -o tiffcrop tiffcrop.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a ../port/.libs/libport.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -llzma -ljbig -ljpeg -lz -lm
crepair-cc -DHAVE_CONFIG_H -I. -I../libtiff  -I../libtiff   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -MT tiffdither.o -MD -MP -MF .deps/tiffdither.Tpo -c -o tiffdither.o tiffdither.c
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_ghost: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
mv -f .deps/tiffdither.Tpo .deps/tiffdither.Po
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address  -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -o tiffdither tiffdither.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -g -O0 -Wno-error -I/CrashRepair/lib -fsanitize=address -g -O0 -Wno-error -I/CrashRepair/lib -fsanitize=address -o tiffdither tiffdither.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a ../port/.libs/libport.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -llzma -ljbig -ljpeg -lz -lm
crepair-cc -DHAVE_CONFIG_H -I. -I../libtiff  -I../libtiff   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -MT tiffdump.o -MD -MP -MF .deps/tiffdump.Tpo -c -o tiffdump.o tiffdump.c
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_ghost: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
mv -f .deps/tiffdump.Tpo .deps/tiffdump.Po
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address  -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -o tiffdump tiffdump.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -g -O0 -Wno-error -I/CrashRepair/lib -fsanitize=address -g -O0 -Wno-error -I/CrashRepair/lib -fsanitize=address -o tiffdump tiffdump.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a ../port/.libs/libport.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -llzma -ljbig -ljpeg -lz -lm
crepair-cc -DHAVE_CONFIG_H -I. -I../libtiff  -I../libtiff   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -MT tiffinfo.o -MD -MP -MF .deps/tiffinfo.Tpo -c -o tiffinfo.o tiffinfo.c
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_ghost: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
mv -f .deps/tiffinfo.Tpo .deps/tiffinfo.Po
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address  -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -o tiffinfo tiffinfo.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -g -O0 -Wno-error -I/CrashRepair/lib -fsanitize=address -g -O0 -Wno-error -I/CrashRepair/lib -fsanitize=address -o tiffinfo tiffinfo.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a ../port/.libs/libport.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -llzma -ljbig -ljpeg -lz -lm
crepair-cc -DHAVE_CONFIG_H -I. -I../libtiff  -I../libtiff   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -MT tiffmedian.o -MD -MP -MF .deps/tiffmedian.Tpo -c -o tiffmedian.o tiffmedian.c
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_ghost: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
mv -f .deps/tiffmedian.Tpo .deps/tiffmedian.Po
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address  -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -o tiffmedian tiffmedian.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -g -O0 -Wno-error -I/CrashRepair/lib -fsanitize=address -g -O0 -Wno-error -I/CrashRepair/lib -fsanitize=address -o tiffmedian tiffmedian.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a ../port/.libs/libport.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -llzma -ljbig -ljpeg -lz -lm
crepair-cc -DHAVE_CONFIG_H -I. -I../libtiff  -I../libtiff   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -MT tiffset.o -MD -MP -MF .deps/tiffset.Tpo -c -o tiffset.o tiffset.c
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_ghost: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
mv -f .deps/tiffset.Tpo .deps/tiffset.Po
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address  -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -o tiffset tiffset.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -g -O0 -Wno-error -I/CrashRepair/lib -fsanitize=address -g -O0 -Wno-error -I/CrashRepair/lib -fsanitize=address -o tiffset tiffset.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a ../port/.libs/libport.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -llzma -ljbig -ljpeg -lz -lm
crepair-cc -DHAVE_CONFIG_H -I. -I../libtiff  -I../libtiff   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -MT tiffsplit.o -MD -MP -MF .deps/tiffsplit.Tpo -c -o tiffsplit.o tiffsplit.c
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_ghost: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
mv -f .deps/tiffsplit.Tpo .deps/tiffsplit.Po
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address  -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -o tiffsplit tiffsplit.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -g -O0 -Wno-error -I/CrashRepair/lib -fsanitize=address -g -O0 -Wno-error -I/CrashRepair/lib -fsanitize=address -o tiffsplit tiffsplit.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a ../port/.libs/libport.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -llzma -ljbig -ljpeg -lz -lm
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/tools'
Making all in build
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/build'
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/build'
make[2]: Nothing to be done for 'all-am'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/build'
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/build'
Making all in contrib
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib'
Making all in addtiffo
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/addtiffo'
crepair-cc -DHAVE_CONFIG_H -I. -I../../libtiff  -I../../libtiff   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -MT addtiffo.o -MD -MP -MF .deps/addtiffo.Tpo -c -o addtiffo.o addtiffo.c
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_ghost: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
mv -f .deps/addtiffo.Tpo .deps/addtiffo.Po
crepair-cc -DHAVE_CONFIG_H -I. -I../../libtiff  -I../../libtiff   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -MT tif_overview.o -MD -MP -MF .deps/tif_overview.Tpo -c -o tif_overview.o tif_overview.c
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_ghost: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
mv -f .deps/tif_overview.Tpo .deps/tif_overview.Po
crepair-cc -DHAVE_CONFIG_H -I. -I../../libtiff  -I../../libtiff   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -MT tif_ovrcache.o -MD -MP -MF .deps/tif_ovrcache.Tpo -c -o tif_ovrcache.o tif_ovrcache.c
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_ghost: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
mv -f .deps/tif_ovrcache.Tpo .deps/tif_ovrcache.Po
/bin/bash ../../libtool  --tag=CC   --mode=link crepair-cc  -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address  -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -o addtiffo addtiffo.o tif_overview.o tif_ovrcache.o ../../libtiff/libtiff.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -g -O0 -Wno-error -I/CrashRepair/lib -fsanitize=address -g -O0 -Wno-error -I/CrashRepair/lib -fsanitize=address -o addtiffo addtiffo.o tif_overview.o tif_ovrcache.o  -L/klee/build/lib -L/CrashRepair/lib ../../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -llzma -ljbig -ljpeg -lz -lm
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/addtiffo'
Making all in dbs
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/dbs'
Making all in xtiff
make[3]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/dbs/xtiff'
make[3]: Nothing to be done for 'all'.
make[3]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/dbs/xtiff'
make[3]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/dbs'
crepair-cc -DHAVE_CONFIG_H -I. -I../../libtiff  -I../../libtiff   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -MT tiff-bi.o -MD -MP -MF .deps/tiff-bi.Tpo -c -o tiff-bi.o tiff-bi.c
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_ghost: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
mv -f .deps/tiff-bi.Tpo .deps/tiff-bi.Po
/bin/bash ../../libtool  --tag=CC   --mode=link crepair-cc  -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address  -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -o tiff-bi tiff-bi.o ../../libtiff/libtiff.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -g -O0 -Wno-error -I/CrashRepair/lib -fsanitize=address -g -O0 -Wno-error -I/CrashRepair/lib -fsanitize=address -o tiff-bi tiff-bi.o  -L/klee/build/lib -L/CrashRepair/lib ../../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -llzma -ljbig -ljpeg -lz -lm
crepair-cc -DHAVE_CONFIG_H -I. -I../../libtiff  -I../../libtiff   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -MT tiff-grayscale.o -MD -MP -MF .deps/tiff-grayscale.Tpo -c -o tiff-grayscale.o tiff-grayscale.c
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_ghost: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
mv -f .deps/tiff-grayscale.Tpo .deps/tiff-grayscale.Po
/bin/bash ../../libtool  --tag=CC   --mode=link crepair-cc  -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address  -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -o tiff-grayscale tiff-grayscale.o ../../libtiff/libtiff.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -g -O0 -Wno-error -I/CrashRepair/lib -fsanitize=address -g -O0 -Wno-error -I/CrashRepair/lib -fsanitize=address -o tiff-grayscale tiff-grayscale.o  -L/klee/build/lib -L/CrashRepair/lib ../../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -llzma -ljbig -ljpeg -lz -lm
crepair-cc -DHAVE_CONFIG_H -I. -I../../libtiff  -I../../libtiff   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -MT tiff-palette.o -MD -MP -MF .deps/tiff-palette.Tpo -c -o tiff-palette.o tiff-palette.c
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_ghost: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
mv -f .deps/tiff-palette.Tpo .deps/tiff-palette.Po
/bin/bash ../../libtool  --tag=CC   --mode=link crepair-cc  -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address  -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -o tiff-palette tiff-palette.o ../../libtiff/libtiff.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -g -O0 -Wno-error -I/CrashRepair/lib -fsanitize=address -g -O0 -Wno-error -I/CrashRepair/lib -fsanitize=address -o tiff-palette tiff-palette.o  -L/klee/build/lib -L/CrashRepair/lib ../../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -llzma -ljbig -ljpeg -lz -lm
crepair-cc -DHAVE_CONFIG_H -I. -I../../libtiff  -I../../libtiff   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -MT tiff-rgb.o -MD -MP -MF .deps/tiff-rgb.Tpo -c -o tiff-rgb.o tiff-rgb.c
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_ghost: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
mv -f .deps/tiff-rgb.Tpo .deps/tiff-rgb.Po
/bin/bash ../../libtool  --tag=CC   --mode=link crepair-cc  -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address  -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -o tiff-rgb tiff-rgb.o ../../libtiff/libtiff.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -g -O0 -Wno-error -I/CrashRepair/lib -fsanitize=address -g -O0 -Wno-error -I/CrashRepair/lib -fsanitize=address -o tiff-rgb tiff-rgb.o  -L/klee/build/lib -L/CrashRepair/lib ../../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -llzma -ljbig -ljpeg -lz -lm
make[3]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/dbs'
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/dbs'
Making all in iptcutil
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/iptcutil'
crepair-cc -DHAVE_CONFIG_H -I. -I../../libtiff  -I../../libtiff   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -MT iptcutil.o -MD -MP -MF .deps/iptcutil.Tpo -c -o iptcutil.o iptcutil.c
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_ghost: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
mv -f .deps/iptcutil.Tpo .deps/iptcutil.Po
/bin/bash ../../libtool  --tag=CC   --mode=link crepair-cc  -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address  -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -o iptcutil iptcutil.o ../../libtiff/libtiff.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -g -O0 -Wno-error -I/CrashRepair/lib -fsanitize=address -g -O0 -Wno-error -I/CrashRepair/lib -fsanitize=address -o iptcutil iptcutil.o  -L/klee/build/lib -L/CrashRepair/lib ../../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -llzma -ljbig -ljpeg -lz -lm
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/iptcutil'
Making all in mfs
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/mfs'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/mfs'
Making all in pds
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/pds'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/pds'
Making all in ras
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/ras'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/ras'
Making all in stream
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/stream'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/stream'
Making all in tags
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/tags'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/tags'
Making all in win_dib
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/win_dib'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/win_dib'
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib'
make[2]: Nothing to be done for 'all-am'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib'
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib'
Making all in test
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/test'
make[1]: Nothing to be done for 'all'.
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/test'
Making all in man
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/man'
make[1]: Nothing to be done for 'all'.
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/man'
Making all in html
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html'
Making all in images
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html/images'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html/images'
Making all in man
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html/man'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html/man'
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html'
make[2]: Nothing to be done for 'all-am'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html'
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html'
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src'
make[1]: Nothing to be done for 'all-am'.
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src'
2025-02-03 22:05:16.983 | INFO     | scenario:evaluate:635 - evaluating candidate patch #0:
@@ -948,152 +948,159 @@
   return status;
   }
 
-static int  readSeparateTilesIntoBuffer (TIFF* in, uint8 *obuf, 
-					 uint32 imagelength, uint32 imagewidth, 
-                                         uint32 tw, uint32 tl,
-                                         uint16 spp, uint16 bps)
-  {
-  int     i, status = 1, sample;
-  int     shift_width, bytes_per_pixel;
-  uint16  bytes_per_sample;
-  uint32  row, col;     /* Current row and col of image */
-  uint32  nrow, ncol;   /* Number of rows and cols in current tile */
-  uint32  row_offset, col_offset; /* Output buffer offsets */
-  tsize_t tbytes = 0, tilesize = TIFFTileSize(in);
-  tsample_t s;
-  uint8*  bufp = (uint8*)obuf;
-  unsigned char *srcbuffs[MAX_SAMPLES];
-  unsigned char *tbuff = NULL;
 
-  bytes_per_sample = (bps + 7) / 8;
+static int readSeparateTilesIntoBuffer(TIFF* in, uint8 *obuf, 
+                                       uint32 imagelength, uint32 imagewidth, 
+                                       uint32 tw, uint32 tl,
+                                       uint16 spp, uint16 bps)
+{
+    int i, status = 1, sample;
+    int shift_width, bytes_per_pixel;
+    uint16 bytes_per_sample;
+    uint32 row, col;     /* Current row and col of image */
+    uint32 nrow, ncol;   /* Number of rows and cols in current tile */
+    uint32 row_offset, col_offset; /* Output buffer offsets */
+    tsize_t tbytes = 0, tilesize = TIFFTileSize(in);
+    tsample_t s;
+    uint8* bufp = (uint8*)obuf;
+    unsigned char *srcbuffs[MAX_SAMPLES];
+    unsigned char *tbuff = NULL;
+
+    bytes_per_sample = (bps + 7) / 8;
+
+    if (spp > MAX_SAMPLES) {
+        TIFFError("readSeparateTilesIntoBuffer", "Sample per pixel exceeds max samples");
+        return 0;
+    }
 
-  for (sample = 0; (sample < spp) && (sample < MAX_SAMPLES); sample++)
+    for (sample = 0; (sample < spp) && (sample < MAX_SAMPLES); sample++)
     {
-    srcbuffs[sample] = NULL;
-    tbuff = (unsigned char *)_TIFFmalloc(tilesize + 8);
-    if (!tbuff)
-      {
-      TIFFError ("readSeparateTilesIntoBuffer", 
-                 "Unable to allocate tile read buffer for sample %d", sample);
-      for (i = 0; i < sample; i++)
-        _TIFFfree (srcbuffs[i]);
-      return 0;
-      }
-    srcbuffs[sample] = tbuff;
+        srcbuffs[sample] = NULL;
+        tbuff = (unsigned char *)_TIFFmalloc(tilesize + 8);
+        if (!tbuff)
+        {
+            TIFFError("readSeparateTilesIntoBuffer", 
+                       "Unable to allocate tile read buffer for sample %d", sample);
+            for (i = 0; i < sample; i++)
+                _TIFFfree(srcbuffs[i]);
+            return 0;
+        }
+        srcbuffs[sample] = tbuff;
     } 
-  /* Each tile contains only the data for a single plane
-   * arranged in scanlines of tw * bytes_per_sample bytes.
-   */
-  for (row = 0; row < imagelength; row += tl)
+    /* Each tile contains only the data for a single plane
+     * arranged in scanlines of tw * bytes_per_sample bytes.
+     */
+    for (row = 0; row < imagelength; row += tl)
     {
-    nrow = (row + tl > imagelength) ? imagelength - row : tl;
-    for (col = 0; col < imagewidth; col += tw)
-      {
-      for (s = 0; s < spp; s++)
-        {  /* Read each plane of a tile set into srcbuffs[s] */
-	tbytes = TIFFReadTile(in, srcbuffs[s], col, row, 0, s);
-        if (tbytes < 0  && !ignore)
-          {
-	  TIFFError(TIFFFileName(in),
-                 "Error, can't read tile for row %lu col %lu, "
-		 "sample %lu",
-		 (unsigned long) col, (unsigned long) row,
-		 (unsigned long) s);
-		 status = 0;
-          for (sample = 0; (sample < spp) && (sample < MAX_SAMPLES); sample++)
-            {
-            tbuff = srcbuffs[sample];
-            if (tbuff != NULL)
-              _TIFFfree(tbuff);
-            }
-          return status;
-	  }
-	}
-     /* Tiles on the right edge may be padded out to tw 
-      * which must be a multiple of 16.
-      * Ncol represents the visible (non padding) portion.  
-      */
-      if (col + tw > imagewidth)
-        ncol = imagewidth - col;
-      else
-        ncol = tw;
-
-      row_offset = row * (((imagewidth * spp * bps) + 7) / 8);
-      col_offset = ((col * spp * bps) + 7) / 8;
-      bufp = obuf + row_offset + col_offset;
-
-      if ((bps % 8) == 0)
-        {
-        if (combineSeparateTileSamplesBytes(srcbuffs, bufp, ncol, nrow, imagewidth,
-					    tw, spp, bps, NULL, 0, 0))
-	  {
-          status = 0;
-          break;
-      	  }
-	}
-      else
+        nrow = (row + tl > imagelength) ? imagelength - row : tl;
+        for (col = 0; col < imagewidth; col += tw)
         {
-        bytes_per_pixel  = ((bps * spp) + 7) / 8;
-        if (bytes_per_pixel < (bytes_per_sample + 1))
-          shift_width = bytes_per_pixel;
-        else
-          shift_width = bytes_per_sample + 1;
-
-        switch (shift_width)
-          {
-          case 1: if (combineSeparateTileSamples8bits (srcbuffs, bufp, ncol, nrow,
-                                                       imagewidth, tw, spp, bps, 
-						       NULL, 0, 0))
-	            {
-                    status = 0;
-                    break;
-      	            }
-	          break;
-          case 2: if (combineSeparateTileSamples16bits (srcbuffs, bufp, ncol, nrow,
-                                                       imagewidth, tw, spp, bps, 
-						       NULL, 0, 0))
-	            {
-                    status = 0;
-                    break;
-		    }
-	          break;
-          case 3: if (combineSeparateTileSamples24bits (srcbuffs, bufp, ncol, nrow,
-                                                       imagewidth, tw, spp, bps, 
-						       NULL, 0, 0))
-	            {
+            for (s = 0; s < spp && s < MAX_SAMPLES; s++)
+            {  /* Read each plane of a tile set into srcbuffs[s] */
+                tbytes = TIFFReadTile(in, srcbuffs[s], col, row, 0, s);
+                if (tbytes < 0  && !ignore)
+                {
+                    TIFFError(TIFFFileName(in),
+                               "Error, can't read tile for row %lu col %lu, "
+                               "sample %lu",
+                               (unsigned long)col, (unsigned long)row,
+                               (unsigned long)s);
                     status = 0;
-                    break;
-       	            }
-                  break;
-          case 4: 
-          case 5:
-          case 6:
-          case 7:
-          case 8: if (combineSeparateTileSamples32bits (srcbuffs, bufp, ncol, nrow,
-                                                       imagewidth, tw, spp, bps, 
-						       NULL, 0, 0))
-	            {
+                    for (sample = 0; (sample < spp) && (sample < MAX_SAMPLES); sample++)
+                    {
+                        tbuff = srcbuffs[sample];
+                        if (tbuff != NULL)
+                            _TIFFfree(tbuff);
+                    }
+                    return status;
+                }
+            }
+            /* Tiles on the right edge may be padded out to tw 
+             * which must be a multiple of 16.
+             * Ncol represents the visible (non padding) portion.  
+             */
+            if (col + tw > imagewidth)
+                ncol = imagewidth - col;
+            else
+                ncol = tw;
+
+            row_offset = row * (((imagewidth * spp * bps) + 7) / 8);
+            col_offset = ((col * spp * bps) + 7) / 8;
+            bufp = obuf + row_offset + col_offset;
+
+            if ((bps % 8) == 0)
+            {
+                if (combineSeparateTileSamplesBytes(srcbuffs, bufp, ncol, nrow, imagewidth,
+                                                     tw, spp, bps, NULL, 0, 0))
+                {
                     status = 0;
                     break;
-		    }
-	          break;
-          default: TIFFError ("readSeparateTilesIntoBuffer", "Unsupported bit depth: %d", bps);
-                  status = 0;
-                  break;
-          }
+                }
+            }
+            else
+            {
+                bytes_per_pixel  = ((bps * spp) + 7) / 8;
+                if (bytes_per_pixel < (bytes_per_sample + 1))
+                    shift_width = bytes_per_pixel;
+                else
+                    shift_width = bytes_per_sample + 1;
+
+                switch (shift_width)
+                {
+                    case 1: if (combineSeparateTileSamples8bits(srcbuffs, bufp, ncol, nrow,
+                                                                imagewidth, tw, spp, bps, 
+                                                                NULL, 0, 0))
+                            {
+                                status = 0;
+                                break;
+                            }
+                            break;
+                    case 2: if (combineSeparateTileSamples16bits(srcbuffs, bufp, ncol, nrow,
+                                                                  imagewidth, tw, spp, bps, 
+                                                                  NULL, 0, 0))
+                            {
+                                status = 0;
+                                break;
+                            }
+                            break;
+                    case 3: if (combineSeparateTileSamples24bits(srcbuffs, bufp, ncol, nrow,
+                                                                  imagewidth, tw, spp, bps, 
+                                                                  NULL, 0, 0))
+                            {
+                                status = 0;
+                                break;
+                            }
+                            break;
+                    case 4: 
+                    case 5:
+                    case 6:
+                    case 7:
+                    case 8: if (combineSeparateTileSamples32bits(srcbuffs, bufp, ncol, nrow,
+                                                                  imagewidth, tw, spp, bps, 
+                                                                  NULL, 0, 0))
+                            {
+                                status = 0;
+                                break;
+                            }
+                            break;
+                    default: TIFFError("readSeparateTilesIntoBuffer", "Unsupported bit depth: %d", bps);
+                             status = 0;
+                             break;
+                }
+            }
         }
-      }
     }
 
-  for (sample = 0; (sample < spp) && (sample < MAX_SAMPLES); sample++)
+    for (sample = 0; (sample < spp) && (sample < MAX_SAMPLES); sample++)
     {
-    tbuff = srcbuffs[sample];
-    if (tbuff != NULL)
-      _TIFFfree(tbuff);
+        tbuff = srcbuffs[sample];
+        if (tbuff != NULL)
+            _TIFFfree(tbuff);
     }
- 
-  return status;
-  }
+
+    return status;
+}
+
 
 static int writeBufferToContigStrips(TIFF* out, uint8* buf, uint32 imagelength)
   {

2025-02-03 22:05:16.990 | DEBUG    | scenario:rebuild:369 - original environment: environ({'CONDA_SHLVL': '2', 'LC_ALL': 'C.UTF-8', 'LS_COLORS': 'rs=0:di=01;34:ln=01;36:mh=00:pi=40;33:so=01;35:do=01;35:bd=40;33;01:cd=40;33;01:or=40;31;01:mi=00:su=37;41:sg=30;43:ca=30;41:tw=30;42:ow=34;42:st=37;44:ex=01;32:*.tar=01;31:*.tgz=01;31:*.arc=01;31:*.arj=01;31:*.taz=01;31:*.lha=01;31:*.lz4=01;31:*.lzh=01;31:*.lzma=01;31:*.tlz=01;31:*.txz=01;31:*.tzo=01;31:*.t7z=01;31:*.zip=01;31:*.z=01;31:*.Z=01;31:*.dz=01;31:*.gz=01;31:*.lrz=01;31:*.lz=01;31:*.lzo=01;31:*.xz=01;31:*.zst=01;31:*.tzst=01;31:*.bz2=01;31:*.bz=01;31:*.tbz=01;31:*.tbz2=01;31:*.tz=01;31:*.deb=01;31:*.rpm=01;31:*.jar=01;31:*.war=01;31:*.ear=01;31:*.sar=01;31:*.rar=01;31:*.alz=01;31:*.ace=01;31:*.zoo=01;31:*.cpio=01;31:*.7z=01;31:*.rz=01;31:*.cab=01;31:*.wim=01;31:*.swm=01;31:*.dwm=01;31:*.esd=01;31:*.jpg=01;35:*.jpeg=01;35:*.mjpg=01;35:*.mjpeg=01;35:*.gif=01;35:*.bmp=01;35:*.pbm=01;35:*.pgm=01;35:*.ppm=01;35:*.tga=01;35:*.xbm=01;35:*.xpm=01;35:*.tif=01;35:*.tiff=01;35:*.png=01;35:*.svg=01;35:*.svgz=01;35:*.mng=01;35:*.pcx=01;35:*.mov=01;35:*.mpg=01;35:*.mpeg=01;35:*.m2v=01;35:*.mkv=01;35:*.webm=01;35:*.ogm=01;35:*.mp4=01;35:*.m4v=01;35:*.mp4v=01;35:*.vob=01;35:*.qt=01;35:*.nuv=01;35:*.wmv=01;35:*.asf=01;35:*.rm=01;35:*.rmvb=01;35:*.flc=01;35:*.avi=01;35:*.fli=01;35:*.flv=01;35:*.gl=01;35:*.dl=01;35:*.xcf=01;35:*.xwd=01;35:*.yuv=01;35:*.cgm=01;35:*.emf=01;35:*.ogv=01;35:*.ogx=01;35:*.aac=00;36:*.au=00;36:*.flac=00;36:*.m4a=00;36:*.mid=00;36:*.midi=00;36:*.mka=00;36:*.mp3=00;36:*.mpc=00;36:*.ogg=00;36:*.ra=00;36:*.wav=00;36:*.oga=00;36:*.opus=00;36:*.spx=00;36:*.xspf=00;36:', 'LD_LIBRARY_PATH': '/opt/crashrepair/lib:/CrashRepair/lib:/klee/build/lib:', 'CONDA_EXE': '/root/anaconda3/bin/conda', 'LANG': 'C.UTF-8', 'TZ': 'Asia/Shanghai', 'HOSTNAME': 'fea22102047d', 'OLDPWD': '/orchestrator', 'CONDA_PREFIX': '/root/anaconda3/envs/CrashRepair', '_CE_M': '', 'CC': 'crepair-cc', 'LLVM_COMPILER': 'clang', 'CONDA_PREFIX_1': '/root/anaconda3', 'PWD': '/orchestrator/crashrepair', 'HOME': '/root', 'CONDA_PYTHON_EXE': '/root/anaconda3/bin/python', '_CE_CONDA': '', 'CONDA_PROMPT_MODIFIER': '(CrashRepair) ', 'CXX': 'crepair-cxx', 'TERM': 'xterm', 'SHLVL': '2', 'PYTHONPATH': '/usr/lib/python3.8/site-packages:', 'PATH': '/root/anaconda3/envs/CrashRepair/bin:/root/anaconda3/condabin:~/anaconda3/bin:/opt/crashrepair/bin:/CrashRepair/compiler:/klee/build/bin:/opt/llvm-6/bin:/klee/build/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', 'CONDA_DEFAULT_ENV': 'CrashRepair', '_': '/root/anaconda3/envs/CrashRepair/bin/python'})
2025-02-03 22:05:16.990 | DEBUG    | scenario:rebuild:382 - injecting ghost function into CFLAGS during build: -lcrepair_ghost
2025-02-03 22:05:16.990 | DEBUG    | scenario:rebuild:398 - using environment: {'INJECT_CFLAGS': '-g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address', 'INJECT_CXXFLAGS': '-g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address', 'INJECT_LDFLAGS': '-g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address'}
2025-02-03 22:05:16.990 | DEBUG    | shell:__call__:41 - executing: make CFLAGS="${INJECT_CFLAGS}" CXXFLAGS="${INJECT_CXXFLAGS}" LDFLAGS="${INJECT_LDFLAGS}"
Making all in port
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/port'
make[1]: Nothing to be done for 'all'.
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/port'
Making all in libtiff
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/libtiff'
make  all-am
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/libtiff'
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/libtiff'
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/libtiff'
Making all in tools
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/tools'
crepair-cc -DHAVE_CONFIG_H -I. -I../libtiff  -I../libtiff   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -MT tiffcrop.o -MD -MP -MF .deps/tiffcrop.Tpo -c -o tiffcrop.o tiffcrop.c
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_ghost: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
mv -f .deps/tiffcrop.Tpo .deps/tiffcrop.Po
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address  -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -o tiffcrop tiffcrop.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -g -O0 -Wno-error -I/CrashRepair/lib -fsanitize=address -g -O0 -Wno-error -I/CrashRepair/lib -fsanitize=address -o tiffcrop tiffcrop.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a ../port/.libs/libport.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -llzma -ljbig -ljpeg -lz -lm
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/tools'
Making all in build
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/build'
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/build'
make[2]: Nothing to be done for 'all-am'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/build'
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/build'
Making all in contrib
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib'
Making all in addtiffo
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/addtiffo'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/addtiffo'
Making all in dbs
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/dbs'
Making all in xtiff
make[3]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/dbs/xtiff'
make[3]: Nothing to be done for 'all'.
make[3]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/dbs/xtiff'
make[3]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/dbs'
make[3]: Nothing to be done for 'all-am'.
make[3]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/dbs'
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/dbs'
Making all in iptcutil
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/iptcutil'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/iptcutil'
Making all in mfs
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/mfs'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/mfs'
Making all in pds
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/pds'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/pds'
Making all in ras
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/ras'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/ras'
Making all in stream
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/stream'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/stream'
Making all in tags
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/tags'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/tags'
Making all in win_dib
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/win_dib'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/win_dib'
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib'
make[2]: Nothing to be done for 'all-am'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib'
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib'
Making all in test
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/test'
make[1]: Nothing to be done for 'all'.
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/test'
Making all in man
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/man'
make[1]: Nothing to be done for 'all'.
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/man'
Making all in html
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html'
Making all in images
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html/images'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html/images'
Making all in man
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html/man'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html/man'
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html'
make[2]: Nothing to be done for 'all-am'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html'
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html'
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src'
make[1]: Nothing to be done for 'all-am'.
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src'
2025-02-03 22:05:17.477 | DEBUG    | scenario:evaluate:655 - testing candidate #0 against test #crash...
2025-02-03 22:05:17.479 | DEBUG    | shell:__call__:41 - executing: /data/vulnloc/libtiff/CVE-2016-5321/src/tools/tiffcrop /CrashRepair/experiments/vulnloc/libtiff/CVE-2016-5321/tests/1.tif foo.tif
2025-02-03 22:05:17.483 | DEBUG    | test:run:189 - test failed: unexpected exit code (actual: 255, expected: 0)
2025-02-03 22:05:17.483 | INFO     | scenario:evaluate:662 - candidate #0 fails test #crash
2025-02-03 22:05:17.489 | INFO     | scenario:evaluate:635 - evaluating candidate patch #1:
@@ -948,152 +948,163 @@
   return status;
   }
 
-static int  readSeparateTilesIntoBuffer (TIFF* in, uint8 *obuf, 
-					 uint32 imagelength, uint32 imagewidth, 
+
+static int readSeparateTilesIntoBuffer (TIFF* in, uint8 *obuf, 
+                                         uint32 imagelength, uint32 imagewidth, 
                                          uint32 tw, uint32 tl,
                                          uint16 spp, uint16 bps)
-  {
-  int     i, status = 1, sample;
-  int     shift_width, bytes_per_pixel;
-  uint16  bytes_per_sample;
-  uint32  row, col;     /* Current row and col of image */
-  uint32  nrow, ncol;   /* Number of rows and cols in current tile */
-  uint32  row_offset, col_offset; /* Output buffer offsets */
-  tsize_t tbytes = 0, tilesize = TIFFTileSize(in);
-  tsample_t s;
-  uint8*  bufp = (uint8*)obuf;
-  unsigned char *srcbuffs[MAX_SAMPLES];
-  unsigned char *tbuff = NULL;
-
-  bytes_per_sample = (bps + 7) / 8;
+{
+    int i, status = 1, sample;
+    int shift_width, bytes_per_pixel;
+    uint16 bytes_per_sample;
+    uint32 row, col;     /* Current row and col of image */
+    uint32 nrow, ncol;   /* Number of rows and cols in current tile */
+    uint32 row_offset, col_offset; /* Output buffer offsets */
+    tsize_t tbytes = 0, tilesize = TIFFTileSize(in);
+    tsample_t s;
+    uint8* bufp = (uint8*)obuf;
+    unsigned char *srcbuffs[MAX_SAMPLES];
+    unsigned char *tbuff = NULL;
+
+    bytes_per_sample = (bps + 7) / 8;
+
+    if (spp > MAX_SAMPLES) {
+        TIFFError("readSeparateTilesIntoBuffer", "Number of Samples exceeds MAX_SAMPLES");
+        return 0;
+    }
 
-  for (sample = 0; (sample < spp) && (sample < MAX_SAMPLES); sample++)
+    for (sample = 0; (sample < spp) && (sample < MAX_SAMPLES); sample++)
     {
-    srcbuffs[sample] = NULL;
-    tbuff = (unsigned char *)_TIFFmalloc(tilesize + 8);
-    if (!tbuff)
-      {
-      TIFFError ("readSeparateTilesIntoBuffer", 
-                 "Unable to allocate tile read buffer for sample %d", sample);
-      for (i = 0; i < sample; i++)
-        _TIFFfree (srcbuffs[i]);
-      return 0;
-      }
-    srcbuffs[sample] = tbuff;
+        srcbuffs[sample] = NULL;
+        tbuff = (unsigned char *)_TIFFmalloc(tilesize + 8);
+        if (!tbuff)
+        {
+            TIFFError("readSeparateTilesIntoBuffer", 
+                       "Unable to allocate tile read buffer for sample %d", sample);
+            for (i = 0; i < sample; i++)
+                _TIFFfree(srcbuffs[i]);
+            return 0;
+        }
+        srcbuffs[sample] = tbuff;
     } 
-  /* Each tile contains only the data for a single plane
-   * arranged in scanlines of tw * bytes_per_sample bytes.
-   */
-  for (row = 0; row < imagelength; row += tl)
+    /* Each tile contains only the data for a single plane
+     * arranged in scanlines of tw * bytes_per_sample bytes.
+     */
+    for (row = 0; row < imagelength; row += tl)
     {
-    nrow = (row + tl > imagelength) ? imagelength - row : tl;
-    for (col = 0; col < imagewidth; col += tw)
-      {
-      for (s = 0; s < spp; s++)
-        {  /* Read each plane of a tile set into srcbuffs[s] */
-	tbytes = TIFFReadTile(in, srcbuffs[s], col, row, 0, s);
-        if (tbytes < 0  && !ignore)
-          {
-	  TIFFError(TIFFFileName(in),
-                 "Error, can't read tile for row %lu col %lu, "
-		 "sample %lu",
-		 (unsigned long) col, (unsigned long) row,
-		 (unsigned long) s);
-		 status = 0;
-          for (sample = 0; (sample < spp) && (sample < MAX_SAMPLES); sample++)
-            {
-            tbuff = srcbuffs[sample];
-            if (tbuff != NULL)
-              _TIFFfree(tbuff);
+        nrow = (row + tl > imagelength) ? imagelength - row : tl;
+        for (col = 0; col < imagewidth; col += tw)
+        {
+            if (spp > MAX_SAMPLES) {
+                TIFFError("readSeparateTilesIntoBuffer", "Number of Samples exceeds MAX_SAMPLES");
+                return 0;
+            }
+            for (s = 0; s < spp; s++)
+            {  /* Read each plane of a tile set into srcbuffs[s] */
+                tbytes = TIFFReadTile(in, srcbuffs[s], col, row, 0, s);
+                if (tbytes < 0  && !ignore)
+                {
+                    TIFFError(TIFFFileName(in),
+                              "Error, can't read tile for row %lu col %lu, "
+                              "sample %lu",
+                              (unsigned long) col, (unsigned long) row,
+                              (unsigned long) s);
+                    status = 0;
+                    for (sample = 0; (sample < spp) && (sample < MAX_SAMPLES); sample++)
+                    {
+                        tbuff = srcbuffs[sample];
+                        if (tbuff != NULL)
+                            _TIFFfree(tbuff);
+                    }
+                    return status;
+                }
             }
-          return status;
-	  }
-	}
-     /* Tiles on the right edge may be padded out to tw 
-      * which must be a multiple of 16.
-      * Ncol represents the visible (non padding) portion.  
-      */
-      if (col + tw > imagewidth)
-        ncol = imagewidth - col;
-      else
-        ncol = tw;
-
-      row_offset = row * (((imagewidth * spp * bps) + 7) / 8);
-      col_offset = ((col * spp * bps) + 7) / 8;
-      bufp = obuf + row_offset + col_offset;
+            /* Tiles on the right edge may be padded out to tw 
+             * which must be a multiple of 16.
+             * Ncol represents the visible (non padding) portion.  
+             */
+            if (col + tw > imagewidth)
+                ncol = imagewidth - col;
+            else
+                ncol = tw;
+
+            row_offset = row * (((imagewidth * spp * bps) + 7) / 8);
+            col_offset = ((col * spp * bps) + 7) / 8;
+            bufp = obuf + row_offset + col_offset;
 
-      if ((bps % 8) == 0)
-        {
-        if (combineSeparateTileSamplesBytes(srcbuffs, bufp, ncol, nrow, imagewidth,
-					    tw, spp, bps, NULL, 0, 0))
-	  {
-          status = 0;
-          break;
-      	  }
-	}
-      else
-        {
-        bytes_per_pixel  = ((bps * spp) + 7) / 8;
-        if (bytes_per_pixel < (bytes_per_sample + 1))
-          shift_width = bytes_per_pixel;
-        else
-          shift_width = bytes_per_sample + 1;
-
-        switch (shift_width)
-          {
-          case 1: if (combineSeparateTileSamples8bits (srcbuffs, bufp, ncol, nrow,
-                                                       imagewidth, tw, spp, bps, 
-						       NULL, 0, 0))
-	            {
+            if ((bps % 8) == 0)
+            {
+                if (combineSeparateTileSamplesBytes(srcbuffs, bufp, ncol, nrow, imagewidth,
+                                                     tw, spp, bps, NULL, 0, 0))
+                {
                     status = 0;
                     break;
-      	            }
-	          break;
-          case 2: if (combineSeparateTileSamples16bits (srcbuffs, bufp, ncol, nrow,
-                                                       imagewidth, tw, spp, bps, 
-						       NULL, 0, 0))
-	            {
-                    status = 0;
+                }
+            }
+            else
+            {
+                bytes_per_pixel  = ((bps * spp) + 7) / 8;
+                if (bytes_per_pixel < (bytes_per_sample + 1))
+                    shift_width = bytes_per_pixel;
+                else
+                    shift_width = bytes_per_sample + 1;
+
+                switch (shift_width)
+                {
+                case 1: if (combineSeparateTileSamples8bits(srcbuffs, bufp, ncol, nrow,
+                                                             imagewidth, tw, spp, bps, 
+                                                             NULL, 0, 0))
+                    {
+                        status = 0;
+                        break;
+                    }
                     break;
-		    }
-	          break;
-          case 3: if (combineSeparateTileSamples24bits (srcbuffs, bufp, ncol, nrow,
-                                                       imagewidth, tw, spp, bps, 
-						       NULL, 0, 0))
-	            {
-                    status = 0;
+                case 2: if (combineSeparateTileSamples16bits(srcbuffs, bufp, ncol, nrow,
+                                                             imagewidth, tw, spp, bps, 
+                                                             NULL, 0, 0))
+                    {
+                        status = 0;
+                        break;
+                    }
+                    break;
+                case 3: if (combineSeparateTileSamples24bits(srcbuffs, bufp, ncol, nrow,
+                                                             imagewidth, tw, spp, bps, 
+                                                             NULL, 0, 0))
+                    {
+                        status = 0;
+                        break;
+                    }
                     break;
-       	            }
-                  break;
-          case 4: 
-          case 5:
-          case 6:
-          case 7:
-          case 8: if (combineSeparateTileSamples32bits (srcbuffs, bufp, ncol, nrow,
-                                                       imagewidth, tw, spp, bps, 
-						       NULL, 0, 0))
-	            {
+                case 4: 
+                case 5:
+                case 6:
+                case 7:
+                case 8: if (combineSeparateTileSamples32bits(srcbuffs, bufp, ncol, nrow,
+                                                             imagewidth, tw, spp, bps, 
+                                                             NULL, 0, 0))
+                    {
+                        status = 0;
+                        break;
+                    }
+                    break;
+                default: TIFFError("readSeparateTilesIntoBuffer", "Unsupported bit depth: %d", bps);
                     status = 0;
                     break;
-		    }
-	          break;
-          default: TIFFError ("readSeparateTilesIntoBuffer", "Unsupported bit depth: %d", bps);
-                  status = 0;
-                  break;
-          }
+                }
+            }
         }
-      }
     }
 
-  for (sample = 0; (sample < spp) && (sample < MAX_SAMPLES); sample++)
+    for (sample = 0; (sample < spp) && (sample < MAX_SAMPLES); sample++)
     {
-    tbuff = srcbuffs[sample];
-    if (tbuff != NULL)
-      _TIFFfree(tbuff);
+        tbuff = srcbuffs[sample];
+        if (tbuff != NULL)
+            _TIFFfree(tbuff);
     }
- 
-  return status;
-  }
+
+    return status;
+}
+
 
 static int writeBufferToContigStrips(TIFF* out, uint8* buf, uint32 imagelength)
   {

2025-02-03 22:05:17.495 | DEBUG    | scenario:rebuild:369 - original environment: environ({'CONDA_SHLVL': '2', 'LC_ALL': 'C.UTF-8', 'LS_COLORS': 'rs=0:di=01;34:ln=01;36:mh=00:pi=40;33:so=01;35:do=01;35:bd=40;33;01:cd=40;33;01:or=40;31;01:mi=00:su=37;41:sg=30;43:ca=30;41:tw=30;42:ow=34;42:st=37;44:ex=01;32:*.tar=01;31:*.tgz=01;31:*.arc=01;31:*.arj=01;31:*.taz=01;31:*.lha=01;31:*.lz4=01;31:*.lzh=01;31:*.lzma=01;31:*.tlz=01;31:*.txz=01;31:*.tzo=01;31:*.t7z=01;31:*.zip=01;31:*.z=01;31:*.Z=01;31:*.dz=01;31:*.gz=01;31:*.lrz=01;31:*.lz=01;31:*.lzo=01;31:*.xz=01;31:*.zst=01;31:*.tzst=01;31:*.bz2=01;31:*.bz=01;31:*.tbz=01;31:*.tbz2=01;31:*.tz=01;31:*.deb=01;31:*.rpm=01;31:*.jar=01;31:*.war=01;31:*.ear=01;31:*.sar=01;31:*.rar=01;31:*.alz=01;31:*.ace=01;31:*.zoo=01;31:*.cpio=01;31:*.7z=01;31:*.rz=01;31:*.cab=01;31:*.wim=01;31:*.swm=01;31:*.dwm=01;31:*.esd=01;31:*.jpg=01;35:*.jpeg=01;35:*.mjpg=01;35:*.mjpeg=01;35:*.gif=01;35:*.bmp=01;35:*.pbm=01;35:*.pgm=01;35:*.ppm=01;35:*.tga=01;35:*.xbm=01;35:*.xpm=01;35:*.tif=01;35:*.tiff=01;35:*.png=01;35:*.svg=01;35:*.svgz=01;35:*.mng=01;35:*.pcx=01;35:*.mov=01;35:*.mpg=01;35:*.mpeg=01;35:*.m2v=01;35:*.mkv=01;35:*.webm=01;35:*.ogm=01;35:*.mp4=01;35:*.m4v=01;35:*.mp4v=01;35:*.vob=01;35:*.qt=01;35:*.nuv=01;35:*.wmv=01;35:*.asf=01;35:*.rm=01;35:*.rmvb=01;35:*.flc=01;35:*.avi=01;35:*.fli=01;35:*.flv=01;35:*.gl=01;35:*.dl=01;35:*.xcf=01;35:*.xwd=01;35:*.yuv=01;35:*.cgm=01;35:*.emf=01;35:*.ogv=01;35:*.ogx=01;35:*.aac=00;36:*.au=00;36:*.flac=00;36:*.m4a=00;36:*.mid=00;36:*.midi=00;36:*.mka=00;36:*.mp3=00;36:*.mpc=00;36:*.ogg=00;36:*.ra=00;36:*.wav=00;36:*.oga=00;36:*.opus=00;36:*.spx=00;36:*.xspf=00;36:', 'LD_LIBRARY_PATH': '/opt/crashrepair/lib:/CrashRepair/lib:/klee/build/lib:', 'CONDA_EXE': '/root/anaconda3/bin/conda', 'LANG': 'C.UTF-8', 'TZ': 'Asia/Shanghai', 'HOSTNAME': 'fea22102047d', 'OLDPWD': '/orchestrator', 'CONDA_PREFIX': '/root/anaconda3/envs/CrashRepair', '_CE_M': '', 'CC': 'crepair-cc', 'LLVM_COMPILER': 'clang', 'CONDA_PREFIX_1': '/root/anaconda3', 'PWD': '/orchestrator/crashrepair', 'HOME': '/root', 'CONDA_PYTHON_EXE': '/root/anaconda3/bin/python', '_CE_CONDA': '', 'CONDA_PROMPT_MODIFIER': '(CrashRepair) ', 'CXX': 'crepair-cxx', 'TERM': 'xterm', 'SHLVL': '2', 'PYTHONPATH': '/usr/lib/python3.8/site-packages:', 'PATH': '/root/anaconda3/envs/CrashRepair/bin:/root/anaconda3/condabin:~/anaconda3/bin:/opt/crashrepair/bin:/CrashRepair/compiler:/klee/build/bin:/opt/llvm-6/bin:/klee/build/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', 'CONDA_DEFAULT_ENV': 'CrashRepair', '_': '/root/anaconda3/envs/CrashRepair/bin/python'})
2025-02-03 22:05:17.495 | DEBUG    | scenario:rebuild:382 - injecting ghost function into CFLAGS during build: -lcrepair_ghost
2025-02-03 22:05:17.495 | DEBUG    | scenario:rebuild:398 - using environment: {'INJECT_CFLAGS': '-g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address', 'INJECT_CXXFLAGS': '-g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address', 'INJECT_LDFLAGS': '-g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address'}
2025-02-03 22:05:17.495 | DEBUG    | shell:__call__:41 - executing: make CFLAGS="${INJECT_CFLAGS}" CXXFLAGS="${INJECT_CXXFLAGS}" LDFLAGS="${INJECT_LDFLAGS}"
Making all in port
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/port'
make[1]: Nothing to be done for 'all'.
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/port'
Making all in libtiff
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/libtiff'
make  all-am
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/libtiff'
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/libtiff'
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/libtiff'
Making all in tools
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/tools'
crepair-cc -DHAVE_CONFIG_H -I. -I../libtiff  -I../libtiff   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -MT tiffcrop.o -MD -MP -MF .deps/tiffcrop.Tpo -c -o tiffcrop.o tiffcrop.c
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_ghost: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
mv -f .deps/tiffcrop.Tpo .deps/tiffcrop.Po
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address  -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -o tiffcrop tiffcrop.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -g -O0 -Wno-error -I/CrashRepair/lib -fsanitize=address -g -O0 -Wno-error -I/CrashRepair/lib -fsanitize=address -o tiffcrop tiffcrop.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a ../port/.libs/libport.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -llzma -ljbig -ljpeg -lz -lm
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/tools'
Making all in build
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/build'
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/build'
make[2]: Nothing to be done for 'all-am'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/build'
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/build'
Making all in contrib
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib'
Making all in addtiffo
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/addtiffo'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/addtiffo'
Making all in dbs
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/dbs'
Making all in xtiff
make[3]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/dbs/xtiff'
make[3]: Nothing to be done for 'all'.
make[3]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/dbs/xtiff'
make[3]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/dbs'
make[3]: Nothing to be done for 'all-am'.
make[3]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/dbs'
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/dbs'
Making all in iptcutil
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/iptcutil'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/iptcutil'
Making all in mfs
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/mfs'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/mfs'
Making all in pds
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/pds'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/pds'
Making all in ras
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/ras'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/ras'
Making all in stream
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/stream'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/stream'
Making all in tags
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/tags'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/tags'
Making all in win_dib
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/win_dib'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/win_dib'
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib'
make[2]: Nothing to be done for 'all-am'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib'
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib'
Making all in test
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/test'
make[1]: Nothing to be done for 'all'.
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/test'
Making all in man
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/man'
make[1]: Nothing to be done for 'all'.
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/man'
Making all in html
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html'
Making all in images
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html/images'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html/images'
Making all in man
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html/man'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html/man'
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html'
make[2]: Nothing to be done for 'all-am'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html'
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html'
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src'
make[1]: Nothing to be done for 'all-am'.
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src'
2025-02-03 22:05:17.976 | DEBUG    | scenario:evaluate:655 - testing candidate #1 against test #crash...
2025-02-03 22:05:17.976 | DEBUG    | shell:__call__:41 - executing: /data/vulnloc/libtiff/CVE-2016-5321/src/tools/tiffcrop /CrashRepair/experiments/vulnloc/libtiff/CVE-2016-5321/tests/1.tif foo.tif
2025-02-03 22:05:17.979 | DEBUG    | test:run:189 - test failed: unexpected exit code (actual: 255, expected: 0)
2025-02-03 22:05:17.980 | INFO     | scenario:evaluate:662 - candidate #1 fails test #crash
2025-02-03 22:05:17.984 | INFO     | scenario:evaluate:635 - evaluating candidate patch #2:
@@ -948,152 +948,164 @@
   return status;
   }
 
-static int  readSeparateTilesIntoBuffer (TIFF* in, uint8 *obuf, 
+
+static int readSeparateTilesIntoBuffer (TIFF* in, uint8 *obuf, 
 					 uint32 imagelength, uint32 imagewidth, 
                                          uint32 tw, uint32 tl,
                                          uint16 spp, uint16 bps)
-  {
-  int     i, status = 1, sample;
-  int     shift_width, bytes_per_pixel;
-  uint16  bytes_per_sample;
-  uint32  row, col;     /* Current row and col of image */
-  uint32  nrow, ncol;   /* Number of rows and cols in current tile */
-  uint32  row_offset, col_offset; /* Output buffer offsets */
-  tsize_t tbytes = 0, tilesize = TIFFTileSize(in);
-  tsample_t s;
-  uint8*  bufp = (uint8*)obuf;
-  unsigned char *srcbuffs[MAX_SAMPLES];
-  unsigned char *tbuff = NULL;
-
-  bytes_per_sample = (bps + 7) / 8;
+{
+    int     i, status = 1, sample;
+    int     shift_width, bytes_per_pixel;
+    uint16  bytes_per_sample;
+    uint32  row, col;     /* Current row and col of image */
+    uint32  nrow, ncol;   /* Number of rows and cols in current tile */
+    uint32  row_offset, col_offset; /* Output buffer offsets */
+    tsize_t tbytes = 0, tilesize = TIFFTileSize(in);
+    tsample_t s;
+    uint8*  bufp = (uint8*)obuf;
+    unsigned char *srcbuffs[MAX_SAMPLES];
+    unsigned char *tbuff = NULL;
+
+    bytes_per_sample = (bps + 7) / 8;
+
+    if(spp > MAX_SAMPLES) {
+        TIFFError("readSeparateTilesIntoBuffer", "Samples per pixel (%d) exceeds maximum (%d)", spp, MAX_SAMPLES);
+        return 0;
+    }
 
-  for (sample = 0; (sample < spp) && (sample < MAX_SAMPLES); sample++)
+    for (sample = 0; (sample < spp); sample++)
     {
-    srcbuffs[sample] = NULL;
-    tbuff = (unsigned char *)_TIFFmalloc(tilesize + 8);
-    if (!tbuff)
-      {
-      TIFFError ("readSeparateTilesIntoBuffer", 
-                 "Unable to allocate tile read buffer for sample %d", sample);
-      for (i = 0; i < sample; i++)
-        _TIFFfree (srcbuffs[i]);
-      return 0;
-      }
-    srcbuffs[sample] = tbuff;
+        srcbuffs[sample] = NULL;
+        tbuff = (unsigned char *)_TIFFmalloc(tilesize + 8);
+        if (!tbuff)
+        {
+            TIFFError ("readSeparateTilesIntoBuffer", 
+                       "Unable to allocate tile read buffer for sample %d", sample);
+            for (i = 0; i < sample; i++)
+                _TIFFfree (srcbuffs[i]);
+            return 0;
+        }
+        srcbuffs[sample] = tbuff;
     } 
-  /* Each tile contains only the data for a single plane
-   * arranged in scanlines of tw * bytes_per_sample bytes.
-   */
-  for (row = 0; row < imagelength; row += tl)
+    /* Each tile contains only the data for a single plane
+     * arranged in scanlines of tw * bytes_per_sample bytes.
+     */
+    for (row = 0; row < imagelength; row += tl)
     {
-    nrow = (row + tl > imagelength) ? imagelength - row : tl;
-    for (col = 0; col < imagewidth; col += tw)
-      {
-      for (s = 0; s < spp; s++)
-        {  /* Read each plane of a tile set into srcbuffs[s] */
-	tbytes = TIFFReadTile(in, srcbuffs[s], col, row, 0, s);
-        if (tbytes < 0  && !ignore)
-          {
-	  TIFFError(TIFFFileName(in),
-                 "Error, can't read tile for row %lu col %lu, "
-		 "sample %lu",
-		 (unsigned long) col, (unsigned long) row,
-		 (unsigned long) s);
-		 status = 0;
-          for (sample = 0; (sample < spp) && (sample < MAX_SAMPLES); sample++)
-            {
-            tbuff = srcbuffs[sample];
-            if (tbuff != NULL)
-              _TIFFfree(tbuff);
-            }
-          return status;
-	  }
-	}
-     /* Tiles on the right edge may be padded out to tw 
-      * which must be a multiple of 16.
-      * Ncol represents the visible (non padding) portion.  
-      */
-      if (col + tw > imagewidth)
-        ncol = imagewidth - col;
-      else
-        ncol = tw;
-
-      row_offset = row * (((imagewidth * spp * bps) + 7) / 8);
-      col_offset = ((col * spp * bps) + 7) / 8;
-      bufp = obuf + row_offset + col_offset;
-
-      if ((bps % 8) == 0)
-        {
-        if (combineSeparateTileSamplesBytes(srcbuffs, bufp, ncol, nrow, imagewidth,
-					    tw, spp, bps, NULL, 0, 0))
-	  {
-          status = 0;
-          break;
-      	  }
-	}
-      else
+        nrow = (row + tl > imagelength) ? imagelength - row : tl;
+        for (col = 0; col < imagewidth; col += tw)
         {
-        bytes_per_pixel  = ((bps * spp) + 7) / 8;
-        if (bytes_per_pixel < (bytes_per_sample + 1))
-          shift_width = bytes_per_pixel;
-        else
-          shift_width = bytes_per_sample + 1;
-
-        switch (shift_width)
-          {
-          case 1: if (combineSeparateTileSamples8bits (srcbuffs, bufp, ncol, nrow,
-                                                       imagewidth, tw, spp, bps, 
-						       NULL, 0, 0))
-	            {
+            for (s = 0; s < spp; s++)
+            {  /* Read each plane of a tile set into srcbuffs[s] */
+                tbytes = TIFFReadTile(in, srcbuffs[s], col, row, 0, s);
+                if (tbytes < 0  && !ignore)
+                {
+                    TIFFError(TIFFFileName(in),
+                               "Error, can't read tile for row %lu col %lu, "
+                               "sample %lu",
+                               (unsigned long) col, (unsigned long) row,
+                               (unsigned long) s);
                     status = 0;
-                    break;
-      	            }
-	          break;
-          case 2: if (combineSeparateTileSamples16bits (srcbuffs, bufp, ncol, nrow,
-                                                       imagewidth, tw, spp, bps, 
-						       NULL, 0, 0))
-	            {
-                    status = 0;
-                    break;
-		    }
-	          break;
-          case 3: if (combineSeparateTileSamples24bits (srcbuffs, bufp, ncol, nrow,
-                                                       imagewidth, tw, spp, bps, 
-						       NULL, 0, 0))
-	            {
-                    status = 0;
-                    break;
-       	            }
-                  break;
-          case 4: 
-          case 5:
-          case 6:
-          case 7:
-          case 8: if (combineSeparateTileSamples32bits (srcbuffs, bufp, ncol, nrow,
-                                                       imagewidth, tw, spp, bps, 
-						       NULL, 0, 0))
-	            {
+                    for (sample = 0; (sample < spp) && (sample < MAX_SAMPLES); sample++)
+                    {
+                        tbuff = srcbuffs[sample];
+                        if (tbuff != NULL)
+                            _TIFFfree(tbuff);
+                    }
+                    return status;
+                }
+            }
+            /* Tiles on the right edge may be padded out to tw 
+             * which must be a multiple of 16.
+             * Ncol represents the visible (non padding) portion.  
+             */
+            if (col + tw > imagewidth)
+                ncol = imagewidth - col;
+            else
+                ncol = tw;
+
+            row_offset = row * (((imagewidth * spp * bps) + 7) / 8);
+            col_offset = ((col * spp * bps) + 7) / 8;
+            bufp = obuf + row_offset + col_offset;
+
+            if ((bps % 8) == 0)
+            {
+                if (combineSeparateTileSamplesBytes(srcbuffs, bufp, ncol, nrow, imagewidth,
+                                                     tw, spp, bps, NULL, 0, 0))
+                {
                     status = 0;
                     break;
-		    }
-	          break;
-          default: TIFFError ("readSeparateTilesIntoBuffer", "Unsupported bit depth: %d", bps);
-                  status = 0;
-                  break;
-          }
+                }
+            }
+            else
+            {
+                bytes_per_pixel = ((bps * spp) + 7) / 8;
+                if (bytes_per_pixel < (bytes_per_sample + 1))
+                    shift_width = bytes_per_pixel;
+                else
+                    shift_width = bytes_per_sample + 1;
+
+                switch (shift_width)
+                {
+                    case 1: 
+                        if (combineSeparateTileSamples8bits (srcbuffs, bufp, ncol, nrow,
+                                                             imagewidth, tw, spp, bps, 
+                                                             NULL, 0, 0))
+                        {
+                            status = 0;
+                            break;
+                        }
+                        break;
+                    case 2: 
+                        if (combineSeparateTileSamples16bits (srcbuffs, bufp, ncol, nrow,
+                                                              imagewidth, tw, spp, bps, 
+                                                              NULL, 0, 0))
+                        {
+                            status = 0;
+                            break;
+                        }
+                        break;
+                    case 3: 
+                        if (combineSeparateTileSamples24bits (srcbuffs, bufp, ncol, nrow,
+                                                              imagewidth, tw, spp, bps, 
+                                                              NULL, 0, 0))
+                        {
+                            status = 0;
+                            break;
+                        }
+                        break;
+                    case 4: 
+                    case 5:
+                    case 6:
+                    case 7:
+                    case 8: 
+                        if (combineSeparateTileSamples32bits (srcbuffs, bufp, ncol, nrow,
+                                                              imagewidth, tw, spp, bps, 
+                                                              NULL, 0, 0))
+                        {
+                            status = 0;
+                            break;
+                        }
+                        break;
+                    default: 
+                        TIFFError ("readSeparateTilesIntoBuffer", "Unsupported bit depth: %d", bps);
+                        status = 0;
+                        break;
+                }
+            }
         }
-      }
     }
 
-  for (sample = 0; (sample < spp) && (sample < MAX_SAMPLES); sample++)
+    for (sample = 0; (sample < spp) && (sample < MAX_SAMPLES); sample++)
     {
-    tbuff = srcbuffs[sample];
-    if (tbuff != NULL)
-      _TIFFfree(tbuff);
+        tbuff = srcbuffs[sample];
+        if (tbuff != NULL)
+            _TIFFfree(tbuff);
     }
- 
-  return status;
-  }
+
+    return status;
+}
+
 
 static int writeBufferToContigStrips(TIFF* out, uint8* buf, uint32 imagelength)
   {

2025-02-03 22:05:17.992 | DEBUG    | scenario:rebuild:369 - original environment: environ({'CONDA_SHLVL': '2', 'LC_ALL': 'C.UTF-8', 'LS_COLORS': 'rs=0:di=01;34:ln=01;36:mh=00:pi=40;33:so=01;35:do=01;35:bd=40;33;01:cd=40;33;01:or=40;31;01:mi=00:su=37;41:sg=30;43:ca=30;41:tw=30;42:ow=34;42:st=37;44:ex=01;32:*.tar=01;31:*.tgz=01;31:*.arc=01;31:*.arj=01;31:*.taz=01;31:*.lha=01;31:*.lz4=01;31:*.lzh=01;31:*.lzma=01;31:*.tlz=01;31:*.txz=01;31:*.tzo=01;31:*.t7z=01;31:*.zip=01;31:*.z=01;31:*.Z=01;31:*.dz=01;31:*.gz=01;31:*.lrz=01;31:*.lz=01;31:*.lzo=01;31:*.xz=01;31:*.zst=01;31:*.tzst=01;31:*.bz2=01;31:*.bz=01;31:*.tbz=01;31:*.tbz2=01;31:*.tz=01;31:*.deb=01;31:*.rpm=01;31:*.jar=01;31:*.war=01;31:*.ear=01;31:*.sar=01;31:*.rar=01;31:*.alz=01;31:*.ace=01;31:*.zoo=01;31:*.cpio=01;31:*.7z=01;31:*.rz=01;31:*.cab=01;31:*.wim=01;31:*.swm=01;31:*.dwm=01;31:*.esd=01;31:*.jpg=01;35:*.jpeg=01;35:*.mjpg=01;35:*.mjpeg=01;35:*.gif=01;35:*.bmp=01;35:*.pbm=01;35:*.pgm=01;35:*.ppm=01;35:*.tga=01;35:*.xbm=01;35:*.xpm=01;35:*.tif=01;35:*.tiff=01;35:*.png=01;35:*.svg=01;35:*.svgz=01;35:*.mng=01;35:*.pcx=01;35:*.mov=01;35:*.mpg=01;35:*.mpeg=01;35:*.m2v=01;35:*.mkv=01;35:*.webm=01;35:*.ogm=01;35:*.mp4=01;35:*.m4v=01;35:*.mp4v=01;35:*.vob=01;35:*.qt=01;35:*.nuv=01;35:*.wmv=01;35:*.asf=01;35:*.rm=01;35:*.rmvb=01;35:*.flc=01;35:*.avi=01;35:*.fli=01;35:*.flv=01;35:*.gl=01;35:*.dl=01;35:*.xcf=01;35:*.xwd=01;35:*.yuv=01;35:*.cgm=01;35:*.emf=01;35:*.ogv=01;35:*.ogx=01;35:*.aac=00;36:*.au=00;36:*.flac=00;36:*.m4a=00;36:*.mid=00;36:*.midi=00;36:*.mka=00;36:*.mp3=00;36:*.mpc=00;36:*.ogg=00;36:*.ra=00;36:*.wav=00;36:*.oga=00;36:*.opus=00;36:*.spx=00;36:*.xspf=00;36:', 'LD_LIBRARY_PATH': '/opt/crashrepair/lib:/CrashRepair/lib:/klee/build/lib:', 'CONDA_EXE': '/root/anaconda3/bin/conda', 'LANG': 'C.UTF-8', 'TZ': 'Asia/Shanghai', 'HOSTNAME': 'fea22102047d', 'OLDPWD': '/orchestrator', 'CONDA_PREFIX': '/root/anaconda3/envs/CrashRepair', '_CE_M': '', 'CC': 'crepair-cc', 'LLVM_COMPILER': 'clang', 'CONDA_PREFIX_1': '/root/anaconda3', 'PWD': '/orchestrator/crashrepair', 'HOME': '/root', 'CONDA_PYTHON_EXE': '/root/anaconda3/bin/python', '_CE_CONDA': '', 'CONDA_PROMPT_MODIFIER': '(CrashRepair) ', 'CXX': 'crepair-cxx', 'TERM': 'xterm', 'SHLVL': '2', 'PYTHONPATH': '/usr/lib/python3.8/site-packages:', 'PATH': '/root/anaconda3/envs/CrashRepair/bin:/root/anaconda3/condabin:~/anaconda3/bin:/opt/crashrepair/bin:/CrashRepair/compiler:/klee/build/bin:/opt/llvm-6/bin:/klee/build/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', 'CONDA_DEFAULT_ENV': 'CrashRepair', '_': '/root/anaconda3/envs/CrashRepair/bin/python'})
2025-02-03 22:05:17.993 | DEBUG    | scenario:rebuild:382 - injecting ghost function into CFLAGS during build: -lcrepair_ghost
2025-02-03 22:05:17.993 | DEBUG    | scenario:rebuild:398 - using environment: {'INJECT_CFLAGS': '-g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address', 'INJECT_CXXFLAGS': '-g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address', 'INJECT_LDFLAGS': '-g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address'}
2025-02-03 22:05:17.993 | DEBUG    | shell:__call__:41 - executing: make CFLAGS="${INJECT_CFLAGS}" CXXFLAGS="${INJECT_CXXFLAGS}" LDFLAGS="${INJECT_LDFLAGS}"
Making all in port
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/port'
make[1]: Nothing to be done for 'all'.
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/port'
Making all in libtiff
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/libtiff'
make  all-am
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/libtiff'
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/libtiff'
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/libtiff'
Making all in tools
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/tools'
crepair-cc -DHAVE_CONFIG_H -I. -I../libtiff  -I../libtiff   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -MT tiffcrop.o -MD -MP -MF .deps/tiffcrop.Tpo -c -o tiffcrop.o tiffcrop.c
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_ghost: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
mv -f .deps/tiffcrop.Tpo .deps/tiffcrop.Po
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address  -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -o tiffcrop tiffcrop.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -g -O0 -Wno-error -I/CrashRepair/lib -fsanitize=address -g -O0 -Wno-error -I/CrashRepair/lib -fsanitize=address -o tiffcrop tiffcrop.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a ../port/.libs/libport.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -llzma -ljbig -ljpeg -lz -lm
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/tools'
Making all in build
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/build'
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/build'
make[2]: Nothing to be done for 'all-am'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/build'
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/build'
Making all in contrib
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib'
Making all in addtiffo
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/addtiffo'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/addtiffo'
Making all in dbs
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/dbs'
Making all in xtiff
make[3]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/dbs/xtiff'
make[3]: Nothing to be done for 'all'.
make[3]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/dbs/xtiff'
make[3]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/dbs'
make[3]: Nothing to be done for 'all-am'.
make[3]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/dbs'
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/dbs'
Making all in iptcutil
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/iptcutil'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/iptcutil'
Making all in mfs
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/mfs'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/mfs'
Making all in pds
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/pds'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/pds'
Making all in ras
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/ras'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/ras'
Making all in stream
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/stream'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/stream'
Making all in tags
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/tags'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/tags'
Making all in win_dib
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/win_dib'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/win_dib'
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib'
make[2]: Nothing to be done for 'all-am'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib'
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib'
Making all in test
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/test'
make[1]: Nothing to be done for 'all'.
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/test'
Making all in man
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/man'
make[1]: Nothing to be done for 'all'.
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/man'
Making all in html
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html'
Making all in images
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html/images'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html/images'
Making all in man
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html/man'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html/man'
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html'
make[2]: Nothing to be done for 'all-am'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html'
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html'
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src'
make[1]: Nothing to be done for 'all-am'.
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src'
2025-02-03 22:05:18.475 | DEBUG    | scenario:evaluate:655 - testing candidate #2 against test #crash...
2025-02-03 22:05:18.475 | DEBUG    | shell:__call__:41 - executing: /data/vulnloc/libtiff/CVE-2016-5321/src/tools/tiffcrop /CrashRepair/experiments/vulnloc/libtiff/CVE-2016-5321/tests/1.tif foo.tif
2025-02-03 22:05:18.479 | DEBUG    | test:run:189 - test failed: unexpected exit code (actual: 255, expected: 0)
2025-02-03 22:05:18.479 | INFO     | scenario:evaluate:662 - candidate #2 fails test #crash
2025-02-03 22:05:18.486 | INFO     | scenario:evaluate:635 - evaluating candidate patch #3:
@@ -948,152 +948,159 @@
   return status;
   }
 
-static int  readSeparateTilesIntoBuffer (TIFF* in, uint8 *obuf, 
-					 uint32 imagelength, uint32 imagewidth, 
+
+static int readSeparateTilesIntoBuffer (TIFF* in, uint8 *obuf, 
+                                         uint32 imagelength, uint32 imagewidth, 
                                          uint32 tw, uint32 tl,
                                          uint16 spp, uint16 bps)
-  {
-  int     i, status = 1, sample;
-  int     shift_width, bytes_per_pixel;
-  uint16  bytes_per_sample;
-  uint32  row, col;     /* Current row and col of image */
-  uint32  nrow, ncol;   /* Number of rows and cols in current tile */
-  uint32  row_offset, col_offset; /* Output buffer offsets */
-  tsize_t tbytes = 0, tilesize = TIFFTileSize(in);
-  tsample_t s;
-  uint8*  bufp = (uint8*)obuf;
-  unsigned char *srcbuffs[MAX_SAMPLES];
-  unsigned char *tbuff = NULL;
-
-  bytes_per_sample = (bps + 7) / 8;
+{
+    int i, status = 1, sample;
+    int shift_width, bytes_per_pixel;
+    uint16 bytes_per_sample;
+    uint32 row, col;     /* Current row and col of image */
+    uint32 nrow, ncol;   /* Number of rows and cols in current tile */
+    uint32 row_offset, col_offset; /* Output buffer offsets */
+    tsize_t tbytes = 0, tilesize = TIFFTileSize(in);
+    tsample_t s;
+    uint8*  bufp = (uint8*)obuf;
+    unsigned char *srcbuffs[MAX_SAMPLES];
+    unsigned char *tbuff = NULL;
+
+    bytes_per_sample = (bps + 7) / 8;
+
+    if (spp > MAX_SAMPLES) {
+        TIFFError("readSeparateTilesIntoBuffer", "Number of samples exceeds MAX_SAMPLES");
+        return 0;
+    }
 
-  for (sample = 0; (sample < spp) && (sample < MAX_SAMPLES); sample++)
+    for (sample = 0; (sample < spp); sample++)
     {
-    srcbuffs[sample] = NULL;
-    tbuff = (unsigned char *)_TIFFmalloc(tilesize + 8);
-    if (!tbuff)
-      {
-      TIFFError ("readSeparateTilesIntoBuffer", 
-                 "Unable to allocate tile read buffer for sample %d", sample);
-      for (i = 0; i < sample; i++)
-        _TIFFfree (srcbuffs[i]);
-      return 0;
-      }
-    srcbuffs[sample] = tbuff;
+        srcbuffs[sample] = NULL;
+        tbuff = (unsigned char *)_TIFFmalloc(tilesize + 8);
+        if (!tbuff)
+        {
+            TIFFError ("readSeparateTilesIntoBuffer", 
+                        "Unable to allocate tile read buffer for sample %d", sample);
+            for (i = 0; i < sample; i++)
+                _TIFFfree (srcbuffs[i]);
+            return 0;
+        }
+        srcbuffs[sample] = tbuff;
     } 
-  /* Each tile contains only the data for a single plane
-   * arranged in scanlines of tw * bytes_per_sample bytes.
-   */
-  for (row = 0; row < imagelength; row += tl)
+    /* Each tile contains only the data for a single plane
+     * arranged in scanlines of tw * bytes_per_sample bytes.
+     */
+    for (row = 0; row < imagelength; row += tl)
     {
-    nrow = (row + tl > imagelength) ? imagelength - row : tl;
-    for (col = 0; col < imagewidth; col += tw)
-      {
-      for (s = 0; s < spp; s++)
-        {  /* Read each plane of a tile set into srcbuffs[s] */
-	tbytes = TIFFReadTile(in, srcbuffs[s], col, row, 0, s);
-        if (tbytes < 0  && !ignore)
-          {
-	  TIFFError(TIFFFileName(in),
-                 "Error, can't read tile for row %lu col %lu, "
-		 "sample %lu",
-		 (unsigned long) col, (unsigned long) row,
-		 (unsigned long) s);
-		 status = 0;
-          for (sample = 0; (sample < spp) && (sample < MAX_SAMPLES); sample++)
-            {
-            tbuff = srcbuffs[sample];
-            if (tbuff != NULL)
-              _TIFFfree(tbuff);
-            }
-          return status;
-	  }
-	}
-     /* Tiles on the right edge may be padded out to tw 
-      * which must be a multiple of 16.
-      * Ncol represents the visible (non padding) portion.  
-      */
-      if (col + tw > imagewidth)
-        ncol = imagewidth - col;
-      else
-        ncol = tw;
-
-      row_offset = row * (((imagewidth * spp * bps) + 7) / 8);
-      col_offset = ((col * spp * bps) + 7) / 8;
-      bufp = obuf + row_offset + col_offset;
-
-      if ((bps % 8) == 0)
-        {
-        if (combineSeparateTileSamplesBytes(srcbuffs, bufp, ncol, nrow, imagewidth,
-					    tw, spp, bps, NULL, 0, 0))
-	  {
-          status = 0;
-          break;
-      	  }
-	}
-      else
+        nrow = (row + tl > imagelength) ? imagelength - row : tl;
+        for (col = 0; col < imagewidth; col += tw)
         {
-        bytes_per_pixel  = ((bps * spp) + 7) / 8;
-        if (bytes_per_pixel < (bytes_per_sample + 1))
-          shift_width = bytes_per_pixel;
-        else
-          shift_width = bytes_per_sample + 1;
-
-        switch (shift_width)
-          {
-          case 1: if (combineSeparateTileSamples8bits (srcbuffs, bufp, ncol, nrow,
-                                                       imagewidth, tw, spp, bps, 
-						       NULL, 0, 0))
-	            {
+            for (s = 0; s < spp; s++)
+            {  /* Read each plane of a tile set into srcbuffs[s] */
+                tbytes = TIFFReadTile(in, srcbuffs[s], col, row, 0, s);
+                if (tbytes < 0 /* && !ignore */)
+                {
+                    TIFFError(TIFFFileName(in),
+                               "Error, can't read tile for row %lu col %lu, "
+                               "sample %lu",
+                               (unsigned long) col, (unsigned long) row,
+                               (unsigned long) s);
                     status = 0;
-                    break;
-      	            }
-	          break;
-          case 2: if (combineSeparateTileSamples16bits (srcbuffs, bufp, ncol, nrow,
-                                                       imagewidth, tw, spp, bps, 
-						       NULL, 0, 0))
-	            {
-                    status = 0;
-                    break;
-		    }
-	          break;
-          case 3: if (combineSeparateTileSamples24bits (srcbuffs, bufp, ncol, nrow,
-                                                       imagewidth, tw, spp, bps, 
-						       NULL, 0, 0))
-	            {
-                    status = 0;
-                    break;
-       	            }
-                  break;
-          case 4: 
-          case 5:
-          case 6:
-          case 7:
-          case 8: if (combineSeparateTileSamples32bits (srcbuffs, bufp, ncol, nrow,
-                                                       imagewidth, tw, spp, bps, 
-						       NULL, 0, 0))
-	            {
+                    for (sample = 0; (sample < spp); sample++)
+                    {
+                        tbuff = srcbuffs[sample];
+                        if (tbuff != NULL)
+                            _TIFFfree(tbuff);
+                    }
+                    return status;
+                }
+            }
+            /* Tiles on the right edge may be padded out to tw 
+             * which must be a multiple of 16.
+             * Ncol represents the visible (non padding) portion.  
+             */
+            if (col + tw > imagewidth)
+                ncol = imagewidth - col;
+            else
+                ncol = tw;
+
+            row_offset = row * (((imagewidth * spp * bps) + 7) / 8);
+            col_offset = ((col * spp * bps) + 7) / 8;
+            bufp = obuf + row_offset + col_offset;
+
+            if ((bps % 8) == 0)
+            {
+                if (combineSeparateTileSamplesBytes(srcbuffs, bufp, ncol, nrow, imagewidth,
+                                                    tw, spp, bps, NULL, 0, 0))
+                {
                     status = 0;
                     break;
-		    }
-	          break;
-          default: TIFFError ("readSeparateTilesIntoBuffer", "Unsupported bit depth: %d", bps);
-                  status = 0;
-                  break;
-          }
+                }
+            }
+            else
+            {
+                bytes_per_pixel  = ((bps * spp) + 7) / 8;
+                if (bytes_per_pixel < (bytes_per_sample + 1))
+                    shift_width = bytes_per_pixel;
+                else
+                    shift_width = bytes_per_sample + 1;
+
+                switch (shift_width)
+                {
+                case 1: if (combineSeparateTileSamples8bits (srcbuffs, bufp, ncol, nrow,
+                                                             imagewidth, tw, spp, bps, 
+                                                             NULL, 0, 0))
+                        {
+                            status = 0;
+                            break;
+                        }
+                        break;
+                case 2: if (combineSeparateTileSamples16bits (srcbuffs, bufp, ncol, nrow,
+                                                             imagewidth, tw, spp, bps, 
+                                                             NULL, 0, 0))
+                        {
+                            status = 0;
+                            break;
+                        }
+                        break;
+                case 3: if (combineSeparateTileSamples24bits (srcbuffs, bufp, ncol, nrow,
+                                                             imagewidth, tw, spp, bps, 
+                                                             NULL, 0, 0))
+                        {
+                            status = 0;
+                            break;
+                        }
+                        break;
+                case 4: 
+                case 5:
+                case 6:
+                case 7:
+                case 8: if (combineSeparateTileSamples32bits (srcbuffs, bufp, ncol, nrow,
+                                                             imagewidth, tw, spp, bps, 
+                                                             NULL, 0, 0))
+                        {
+                            status = 0;
+                            break;
+                        }
+                        break;
+                default: TIFFError ("readSeparateTilesIntoBuffer", "Unsupported bit depth: %d", bps);
+                         status = 0;
+                         break;
+                }
+            }
         }
-      }
     }
 
-  for (sample = 0; (sample < spp) && (sample < MAX_SAMPLES); sample++)
+    for (sample = 0; (sample < spp); sample++)
     {
-    tbuff = srcbuffs[sample];
-    if (tbuff != NULL)
-      _TIFFfree(tbuff);
+        tbuff = srcbuffs[sample];
+        if (tbuff != NULL)
+            _TIFFfree(tbuff);
     }
- 
-  return status;
-  }
+
+    return status;
+}
+
 
 static int writeBufferToContigStrips(TIFF* out, uint8* buf, uint32 imagelength)
   {

2025-02-03 22:05:18.494 | DEBUG    | scenario:rebuild:369 - original environment: environ({'CONDA_SHLVL': '2', 'LC_ALL': 'C.UTF-8', 'LS_COLORS': 'rs=0:di=01;34:ln=01;36:mh=00:pi=40;33:so=01;35:do=01;35:bd=40;33;01:cd=40;33;01:or=40;31;01:mi=00:su=37;41:sg=30;43:ca=30;41:tw=30;42:ow=34;42:st=37;44:ex=01;32:*.tar=01;31:*.tgz=01;31:*.arc=01;31:*.arj=01;31:*.taz=01;31:*.lha=01;31:*.lz4=01;31:*.lzh=01;31:*.lzma=01;31:*.tlz=01;31:*.txz=01;31:*.tzo=01;31:*.t7z=01;31:*.zip=01;31:*.z=01;31:*.Z=01;31:*.dz=01;31:*.gz=01;31:*.lrz=01;31:*.lz=01;31:*.lzo=01;31:*.xz=01;31:*.zst=01;31:*.tzst=01;31:*.bz2=01;31:*.bz=01;31:*.tbz=01;31:*.tbz2=01;31:*.tz=01;31:*.deb=01;31:*.rpm=01;31:*.jar=01;31:*.war=01;31:*.ear=01;31:*.sar=01;31:*.rar=01;31:*.alz=01;31:*.ace=01;31:*.zoo=01;31:*.cpio=01;31:*.7z=01;31:*.rz=01;31:*.cab=01;31:*.wim=01;31:*.swm=01;31:*.dwm=01;31:*.esd=01;31:*.jpg=01;35:*.jpeg=01;35:*.mjpg=01;35:*.mjpeg=01;35:*.gif=01;35:*.bmp=01;35:*.pbm=01;35:*.pgm=01;35:*.ppm=01;35:*.tga=01;35:*.xbm=01;35:*.xpm=01;35:*.tif=01;35:*.tiff=01;35:*.png=01;35:*.svg=01;35:*.svgz=01;35:*.mng=01;35:*.pcx=01;35:*.mov=01;35:*.mpg=01;35:*.mpeg=01;35:*.m2v=01;35:*.mkv=01;35:*.webm=01;35:*.ogm=01;35:*.mp4=01;35:*.m4v=01;35:*.mp4v=01;35:*.vob=01;35:*.qt=01;35:*.nuv=01;35:*.wmv=01;35:*.asf=01;35:*.rm=01;35:*.rmvb=01;35:*.flc=01;35:*.avi=01;35:*.fli=01;35:*.flv=01;35:*.gl=01;35:*.dl=01;35:*.xcf=01;35:*.xwd=01;35:*.yuv=01;35:*.cgm=01;35:*.emf=01;35:*.ogv=01;35:*.ogx=01;35:*.aac=00;36:*.au=00;36:*.flac=00;36:*.m4a=00;36:*.mid=00;36:*.midi=00;36:*.mka=00;36:*.mp3=00;36:*.mpc=00;36:*.ogg=00;36:*.ra=00;36:*.wav=00;36:*.oga=00;36:*.opus=00;36:*.spx=00;36:*.xspf=00;36:', 'LD_LIBRARY_PATH': '/opt/crashrepair/lib:/CrashRepair/lib:/klee/build/lib:', 'CONDA_EXE': '/root/anaconda3/bin/conda', 'LANG': 'C.UTF-8', 'TZ': 'Asia/Shanghai', 'HOSTNAME': 'fea22102047d', 'OLDPWD': '/orchestrator', 'CONDA_PREFIX': '/root/anaconda3/envs/CrashRepair', '_CE_M': '', 'CC': 'crepair-cc', 'LLVM_COMPILER': 'clang', 'CONDA_PREFIX_1': '/root/anaconda3', 'PWD': '/orchestrator/crashrepair', 'HOME': '/root', 'CONDA_PYTHON_EXE': '/root/anaconda3/bin/python', '_CE_CONDA': '', 'CONDA_PROMPT_MODIFIER': '(CrashRepair) ', 'CXX': 'crepair-cxx', 'TERM': 'xterm', 'SHLVL': '2', 'PYTHONPATH': '/usr/lib/python3.8/site-packages:', 'PATH': '/root/anaconda3/envs/CrashRepair/bin:/root/anaconda3/condabin:~/anaconda3/bin:/opt/crashrepair/bin:/CrashRepair/compiler:/klee/build/bin:/opt/llvm-6/bin:/klee/build/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', 'CONDA_DEFAULT_ENV': 'CrashRepair', '_': '/root/anaconda3/envs/CrashRepair/bin/python'})
2025-02-03 22:05:18.494 | DEBUG    | scenario:rebuild:382 - injecting ghost function into CFLAGS during build: -lcrepair_ghost
2025-02-03 22:05:18.494 | DEBUG    | scenario:rebuild:398 - using environment: {'INJECT_CFLAGS': '-g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address', 'INJECT_CXXFLAGS': '-g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address', 'INJECT_LDFLAGS': '-g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address'}
2025-02-03 22:05:18.494 | DEBUG    | shell:__call__:41 - executing: make CFLAGS="${INJECT_CFLAGS}" CXXFLAGS="${INJECT_CXXFLAGS}" LDFLAGS="${INJECT_LDFLAGS}"
Making all in port
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/port'
make[1]: Nothing to be done for 'all'.
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/port'
Making all in libtiff
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/libtiff'
make  all-am
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/libtiff'
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/libtiff'
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/libtiff'
Making all in tools
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/tools'
crepair-cc -DHAVE_CONFIG_H -I. -I../libtiff  -I../libtiff   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -MT tiffcrop.o -MD -MP -MF .deps/tiffcrop.Tpo -c -o tiffcrop.o tiffcrop.c
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_ghost: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
mv -f .deps/tiffcrop.Tpo .deps/tiffcrop.Po
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address  -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -o tiffcrop tiffcrop.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -g -O0 -Wno-error -I/CrashRepair/lib -fsanitize=address -g -O0 -Wno-error -I/CrashRepair/lib -fsanitize=address -o tiffcrop tiffcrop.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a ../port/.libs/libport.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -llzma -ljbig -ljpeg -lz -lm
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/tools'
Making all in build
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/build'
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/build'
make[2]: Nothing to be done for 'all-am'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/build'
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/build'
Making all in contrib
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib'
Making all in addtiffo
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/addtiffo'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/addtiffo'
Making all in dbs
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/dbs'
Making all in xtiff
make[3]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/dbs/xtiff'
make[3]: Nothing to be done for 'all'.
make[3]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/dbs/xtiff'
make[3]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/dbs'
make[3]: Nothing to be done for 'all-am'.
make[3]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/dbs'
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/dbs'
Making all in iptcutil
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/iptcutil'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/iptcutil'
Making all in mfs
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/mfs'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/mfs'
Making all in pds
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/pds'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/pds'
Making all in ras
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/ras'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/ras'
Making all in stream
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/stream'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/stream'
Making all in tags
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/tags'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/tags'
Making all in win_dib
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/win_dib'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/win_dib'
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib'
make[2]: Nothing to be done for 'all-am'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib'
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib'
Making all in test
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/test'
make[1]: Nothing to be done for 'all'.
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/test'
Making all in man
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/man'
make[1]: Nothing to be done for 'all'.
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/man'
Making all in html
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html'
Making all in images
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html/images'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html/images'
Making all in man
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html/man'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html/man'
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html'
make[2]: Nothing to be done for 'all-am'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html'
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html'
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src'
make[1]: Nothing to be done for 'all-am'.
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src'
2025-02-03 22:05:18.973 | DEBUG    | scenario:evaluate:655 - testing candidate #3 against test #crash...
2025-02-03 22:05:18.973 | DEBUG    | shell:__call__:41 - executing: /data/vulnloc/libtiff/CVE-2016-5321/src/tools/tiffcrop /CrashRepair/experiments/vulnloc/libtiff/CVE-2016-5321/tests/1.tif foo.tif
2025-02-03 22:05:18.976 | DEBUG    | test:run:189 - test failed: unexpected exit code (actual: 255, expected: 0)
2025-02-03 22:05:18.977 | INFO     | scenario:evaluate:662 - candidate #3 fails test #crash
2025-02-03 22:05:18.981 | INFO     | scenario:evaluate:635 - evaluating candidate patch #4:
@@ -948,152 +948,159 @@
   return status;
   }
 
-static int  readSeparateTilesIntoBuffer (TIFF* in, uint8 *obuf, 
-					 uint32 imagelength, uint32 imagewidth, 
+
+static int readSeparateTilesIntoBuffer (TIFF* in, uint8 *obuf, 
+                                         uint32 imagelength, uint32 imagewidth, 
                                          uint32 tw, uint32 tl,
                                          uint16 spp, uint16 bps)
-  {
-  int     i, status = 1, sample;
-  int     shift_width, bytes_per_pixel;
-  uint16  bytes_per_sample;
-  uint32  row, col;     /* Current row and col of image */
-  uint32  nrow, ncol;   /* Number of rows and cols in current tile */
-  uint32  row_offset, col_offset; /* Output buffer offsets */
-  tsize_t tbytes = 0, tilesize = TIFFTileSize(in);
-  tsample_t s;
-  uint8*  bufp = (uint8*)obuf;
-  unsigned char *srcbuffs[MAX_SAMPLES];
-  unsigned char *tbuff = NULL;
-
-  bytes_per_sample = (bps + 7) / 8;
+{
+    int     i, status = 1, sample;
+    int     shift_width, bytes_per_pixel;
+    uint16  bytes_per_sample;
+    uint32  row, col;     /* Current row and col of image */
+    uint32  nrow, ncol;   /* Number of rows and cols in current tile */
+    uint32  row_offset, col_offset; /* Output buffer offsets */
+    tsize_t tbytes = 0, tilesize = TIFFTileSize(in);
+    tsample_t s;
+    uint8*  bufp = (uint8*)obuf;
+    unsigned char *srcbuffs[MAX_SAMPLES];
+    unsigned char *tbuff = NULL;
+
+    bytes_per_sample = (bps + 7) / 8;
+
+    if (spp > MAX_SAMPLES) {
+        TIFFError("readSeparateTilesIntoBuffer", "Samples per pixel exceed maximum allowed");
+        return 0;
+    }
 
-  for (sample = 0; (sample < spp) && (sample < MAX_SAMPLES); sample++)
+    for (sample = 0; (sample < spp) && (sample < MAX_SAMPLES); sample++)
     {
-    srcbuffs[sample] = NULL;
-    tbuff = (unsigned char *)_TIFFmalloc(tilesize + 8);
-    if (!tbuff)
-      {
-      TIFFError ("readSeparateTilesIntoBuffer", 
-                 "Unable to allocate tile read buffer for sample %d", sample);
-      for (i = 0; i < sample; i++)
-        _TIFFfree (srcbuffs[i]);
-      return 0;
-      }
-    srcbuffs[sample] = tbuff;
+        srcbuffs[sample] = NULL;
+        tbuff = (unsigned char *)_TIFFmalloc(tilesize + 8);
+        if (!tbuff)
+        {
+            TIFFError ("readSeparateTilesIntoBuffer", 
+                        "Unable to allocate tile read buffer for sample %d", sample);
+            for (i = 0; i < sample; i++)
+                _TIFFfree (srcbuffs[i]);
+            return 0;
+        }
+        srcbuffs[sample] = tbuff;
     } 
-  /* Each tile contains only the data for a single plane
-   * arranged in scanlines of tw * bytes_per_sample bytes.
-   */
-  for (row = 0; row < imagelength; row += tl)
+    /* Each tile contains only the data for a single plane
+     * arranged in scanlines of tw * bytes_per_sample bytes.
+     */
+    for (row = 0; row < imagelength; row += tl)
     {
-    nrow = (row + tl > imagelength) ? imagelength - row : tl;
-    for (col = 0; col < imagewidth; col += tw)
-      {
-      for (s = 0; s < spp; s++)
-        {  /* Read each plane of a tile set into srcbuffs[s] */
-	tbytes = TIFFReadTile(in, srcbuffs[s], col, row, 0, s);
-        if (tbytes < 0  && !ignore)
-          {
-	  TIFFError(TIFFFileName(in),
-                 "Error, can't read tile for row %lu col %lu, "
-		 "sample %lu",
-		 (unsigned long) col, (unsigned long) row,
-		 (unsigned long) s);
-		 status = 0;
-          for (sample = 0; (sample < spp) && (sample < MAX_SAMPLES); sample++)
-            {
-            tbuff = srcbuffs[sample];
-            if (tbuff != NULL)
-              _TIFFfree(tbuff);
+        nrow = (row + tl > imagelength) ? imagelength - row : tl;
+        for (col = 0; col < imagewidth; col += tw)
+        {
+            for (s = 0; s < spp; s++)
+            {  /* Read each plane of a tile set into srcbuffs[s] */
+                tbytes = TIFFReadTile(in, srcbuffs[s], col, row, 0, s);
+                if (tbytes < 0  && !ignore)
+                {
+                    TIFFError(TIFFFileName(in),
+                              "Error, can't read tile for row %lu col %lu, "
+                              "sample %lu",
+                              (unsigned long) col, (unsigned long) row,
+                              (unsigned long) s);
+                    status = 0;
+                    for (sample = 0; (sample < spp) && (sample < MAX_SAMPLES); sample++)
+                    {
+                        tbuff = srcbuffs[sample];
+                        if (tbuff != NULL)
+                            _TIFFfree(tbuff);
+                    }
+                    return status;
+                }
             }
-          return status;
-	  }
-	}
-     /* Tiles on the right edge may be padded out to tw 
-      * which must be a multiple of 16.
-      * Ncol represents the visible (non padding) portion.  
-      */
-      if (col + tw > imagewidth)
-        ncol = imagewidth - col;
-      else
-        ncol = tw;
-
-      row_offset = row * (((imagewidth * spp * bps) + 7) / 8);
-      col_offset = ((col * spp * bps) + 7) / 8;
-      bufp = obuf + row_offset + col_offset;
+            /* Tiles on the right edge may be padded out to tw 
+             * which must be a multiple of 16.
+             * Ncol represents the visible (non padding) portion.  
+             */
+            if (col + tw > imagewidth)
+                ncol = imagewidth - col;
+            else
+                ncol = tw;
+
+            row_offset = row * (((imagewidth * spp * bps) + 7) / 8);
+            col_offset = ((col * spp * bps) + 7) / 8;
+            bufp = obuf + row_offset + col_offset;
 
-      if ((bps % 8) == 0)
-        {
-        if (combineSeparateTileSamplesBytes(srcbuffs, bufp, ncol, nrow, imagewidth,
-					    tw, spp, bps, NULL, 0, 0))
-	  {
-          status = 0;
-          break;
-      	  }
-	}
-      else
-        {
-        bytes_per_pixel  = ((bps * spp) + 7) / 8;
-        if (bytes_per_pixel < (bytes_per_sample + 1))
-          shift_width = bytes_per_pixel;
-        else
-          shift_width = bytes_per_sample + 1;
-
-        switch (shift_width)
-          {
-          case 1: if (combineSeparateTileSamples8bits (srcbuffs, bufp, ncol, nrow,
-                                                       imagewidth, tw, spp, bps, 
-						       NULL, 0, 0))
-	            {
+            if ((bps % 8) == 0)
+            {
+                if (combineSeparateTileSamplesBytes(srcbuffs, bufp, ncol, nrow, imagewidth,
+                                                     tw, spp, bps, NULL, 0, 0))
+                {
                     status = 0;
                     break;
-      	            }
-	          break;
-          case 2: if (combineSeparateTileSamples16bits (srcbuffs, bufp, ncol, nrow,
-                                                       imagewidth, tw, spp, bps, 
-						       NULL, 0, 0))
-	            {
-                    status = 0;
+                }
+            }
+            else
+            {
+                bytes_per_pixel  = ((bps * spp) + 7) / 8;
+                if (bytes_per_pixel < (bytes_per_sample + 1))
+                    shift_width = bytes_per_pixel;
+                else
+                    shift_width = bytes_per_sample + 1;
+
+                switch (shift_width)
+                {
+                case 1: if (combineSeparateTileSamples8bits (srcbuffs, bufp, ncol, nrow,
+                                                             imagewidth, tw, spp, bps, 
+                                                             NULL, 0, 0))
+                    {
+                        status = 0;
+                        break;
+                    }
                     break;
-		    }
-	          break;
-          case 3: if (combineSeparateTileSamples24bits (srcbuffs, bufp, ncol, nrow,
-                                                       imagewidth, tw, spp, bps, 
-						       NULL, 0, 0))
-	            {
-                    status = 0;
+                case 2: if (combineSeparateTileSamples16bits (srcbuffs, bufp, ncol, nrow,
+                                                             imagewidth, tw, spp, bps, 
+                                                             NULL, 0, 0))
+                    {
+                        status = 0;
+                        break;
+                    }
                     break;
-       	            }
-                  break;
-          case 4: 
-          case 5:
-          case 6:
-          case 7:
-          case 8: if (combineSeparateTileSamples32bits (srcbuffs, bufp, ncol, nrow,
-                                                       imagewidth, tw, spp, bps, 
-						       NULL, 0, 0))
-	            {
-                    status = 0;
+                case 3: if (combineSeparateTileSamples24bits (srcbuffs, bufp, ncol, nrow,
+                                                             imagewidth, tw, spp, bps, 
+                                                             NULL, 0, 0))
+                    {
+                        status = 0;
+                        break;
+                    }
+                    break;
+                case 4: 
+                case 5:
+                case 6:
+                case 7:
+                case 8: if (combineSeparateTileSamples32bits (srcbuffs, bufp, ncol, nrow,
+                                                             imagewidth, tw, spp, bps, 
+                                                             NULL, 0, 0))
+                    {
+                        status = 0;
+                        break;
+                    }
                     break;
-		    }
-	          break;
-          default: TIFFError ("readSeparateTilesIntoBuffer", "Unsupported bit depth: %d", bps);
-                  status = 0;
-                  break;
-          }
+                default: TIFFError ("readSeparateTilesIntoBuffer", "Unsupported bit depth: %d", bps);
+                         status = 0;
+                         break;
+                }
+            }
         }
-      }
     }
 
-  for (sample = 0; (sample < spp) && (sample < MAX_SAMPLES); sample++)
+    for (sample = 0; (sample < spp) && (sample < MAX_SAMPLES); sample++)
     {
-    tbuff = srcbuffs[sample];
-    if (tbuff != NULL)
-      _TIFFfree(tbuff);
+        tbuff = srcbuffs[sample];
+        if (tbuff != NULL)
+            _TIFFfree(tbuff);
     }
- 
-  return status;
-  }
+
+    return status;
+}
+
 
 static int writeBufferToContigStrips(TIFF* out, uint8* buf, uint32 imagelength)
   {

2025-02-03 22:05:18.990 | DEBUG    | scenario:rebuild:369 - original environment: environ({'CONDA_SHLVL': '2', 'LC_ALL': 'C.UTF-8', 'LS_COLORS': 'rs=0:di=01;34:ln=01;36:mh=00:pi=40;33:so=01;35:do=01;35:bd=40;33;01:cd=40;33;01:or=40;31;01:mi=00:su=37;41:sg=30;43:ca=30;41:tw=30;42:ow=34;42:st=37;44:ex=01;32:*.tar=01;31:*.tgz=01;31:*.arc=01;31:*.arj=01;31:*.taz=01;31:*.lha=01;31:*.lz4=01;31:*.lzh=01;31:*.lzma=01;31:*.tlz=01;31:*.txz=01;31:*.tzo=01;31:*.t7z=01;31:*.zip=01;31:*.z=01;31:*.Z=01;31:*.dz=01;31:*.gz=01;31:*.lrz=01;31:*.lz=01;31:*.lzo=01;31:*.xz=01;31:*.zst=01;31:*.tzst=01;31:*.bz2=01;31:*.bz=01;31:*.tbz=01;31:*.tbz2=01;31:*.tz=01;31:*.deb=01;31:*.rpm=01;31:*.jar=01;31:*.war=01;31:*.ear=01;31:*.sar=01;31:*.rar=01;31:*.alz=01;31:*.ace=01;31:*.zoo=01;31:*.cpio=01;31:*.7z=01;31:*.rz=01;31:*.cab=01;31:*.wim=01;31:*.swm=01;31:*.dwm=01;31:*.esd=01;31:*.jpg=01;35:*.jpeg=01;35:*.mjpg=01;35:*.mjpeg=01;35:*.gif=01;35:*.bmp=01;35:*.pbm=01;35:*.pgm=01;35:*.ppm=01;35:*.tga=01;35:*.xbm=01;35:*.xpm=01;35:*.tif=01;35:*.tiff=01;35:*.png=01;35:*.svg=01;35:*.svgz=01;35:*.mng=01;35:*.pcx=01;35:*.mov=01;35:*.mpg=01;35:*.mpeg=01;35:*.m2v=01;35:*.mkv=01;35:*.webm=01;35:*.ogm=01;35:*.mp4=01;35:*.m4v=01;35:*.mp4v=01;35:*.vob=01;35:*.qt=01;35:*.nuv=01;35:*.wmv=01;35:*.asf=01;35:*.rm=01;35:*.rmvb=01;35:*.flc=01;35:*.avi=01;35:*.fli=01;35:*.flv=01;35:*.gl=01;35:*.dl=01;35:*.xcf=01;35:*.xwd=01;35:*.yuv=01;35:*.cgm=01;35:*.emf=01;35:*.ogv=01;35:*.ogx=01;35:*.aac=00;36:*.au=00;36:*.flac=00;36:*.m4a=00;36:*.mid=00;36:*.midi=00;36:*.mka=00;36:*.mp3=00;36:*.mpc=00;36:*.ogg=00;36:*.ra=00;36:*.wav=00;36:*.oga=00;36:*.opus=00;36:*.spx=00;36:*.xspf=00;36:', 'LD_LIBRARY_PATH': '/opt/crashrepair/lib:/CrashRepair/lib:/klee/build/lib:', 'CONDA_EXE': '/root/anaconda3/bin/conda', 'LANG': 'C.UTF-8', 'TZ': 'Asia/Shanghai', 'HOSTNAME': 'fea22102047d', 'OLDPWD': '/orchestrator', 'CONDA_PREFIX': '/root/anaconda3/envs/CrashRepair', '_CE_M': '', 'CC': 'crepair-cc', 'LLVM_COMPILER': 'clang', 'CONDA_PREFIX_1': '/root/anaconda3', 'PWD': '/orchestrator/crashrepair', 'HOME': '/root', 'CONDA_PYTHON_EXE': '/root/anaconda3/bin/python', '_CE_CONDA': '', 'CONDA_PROMPT_MODIFIER': '(CrashRepair) ', 'CXX': 'crepair-cxx', 'TERM': 'xterm', 'SHLVL': '2', 'PYTHONPATH': '/usr/lib/python3.8/site-packages:', 'PATH': '/root/anaconda3/envs/CrashRepair/bin:/root/anaconda3/condabin:~/anaconda3/bin:/opt/crashrepair/bin:/CrashRepair/compiler:/klee/build/bin:/opt/llvm-6/bin:/klee/build/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', 'CONDA_DEFAULT_ENV': 'CrashRepair', '_': '/root/anaconda3/envs/CrashRepair/bin/python'})
2025-02-03 22:05:18.990 | DEBUG    | scenario:rebuild:382 - injecting ghost function into CFLAGS during build: -lcrepair_ghost
2025-02-03 22:05:18.990 | DEBUG    | scenario:rebuild:398 - using environment: {'INJECT_CFLAGS': '-g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address', 'INJECT_CXXFLAGS': '-g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address', 'INJECT_LDFLAGS': '-g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address'}
2025-02-03 22:05:18.990 | DEBUG    | shell:__call__:41 - executing: make CFLAGS="${INJECT_CFLAGS}" CXXFLAGS="${INJECT_CXXFLAGS}" LDFLAGS="${INJECT_LDFLAGS}"
Making all in port
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/port'
make[1]: Nothing to be done for 'all'.
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/port'
Making all in libtiff
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/libtiff'
make  all-am
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/libtiff'
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/libtiff'
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/libtiff'
Making all in tools
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/tools'
crepair-cc -DHAVE_CONFIG_H -I. -I../libtiff  -I../libtiff   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -MT tiffcrop.o -MD -MP -MF .deps/tiffcrop.Tpo -c -o tiffcrop.o tiffcrop.c
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_ghost: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
mv -f .deps/tiffcrop.Tpo .deps/tiffcrop.Po
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address  -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -o tiffcrop tiffcrop.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -g -O0 -Wno-error -I/CrashRepair/lib -fsanitize=address -g -O0 -Wno-error -I/CrashRepair/lib -fsanitize=address -o tiffcrop tiffcrop.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a ../port/.libs/libport.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -llzma -ljbig -ljpeg -lz -lm
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/tools'
Making all in build
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/build'
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/build'
make[2]: Nothing to be done for 'all-am'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/build'
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/build'
Making all in contrib
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib'
Making all in addtiffo
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/addtiffo'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/addtiffo'
Making all in dbs
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/dbs'
Making all in xtiff
make[3]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/dbs/xtiff'
make[3]: Nothing to be done for 'all'.
make[3]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/dbs/xtiff'
make[3]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/dbs'
make[3]: Nothing to be done for 'all-am'.
make[3]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/dbs'
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/dbs'
Making all in iptcutil
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/iptcutil'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/iptcutil'
Making all in mfs
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/mfs'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/mfs'
Making all in pds
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/pds'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/pds'
Making all in ras
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/ras'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/ras'
Making all in stream
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/stream'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/stream'
Making all in tags
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/tags'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/tags'
Making all in win_dib
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/win_dib'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/win_dib'
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib'
make[2]: Nothing to be done for 'all-am'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib'
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib'
Making all in test
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/test'
make[1]: Nothing to be done for 'all'.
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/test'
Making all in man
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/man'
make[1]: Nothing to be done for 'all'.
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/man'
Making all in html
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html'
Making all in images
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html/images'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html/images'
Making all in man
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html/man'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html/man'
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html'
make[2]: Nothing to be done for 'all-am'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html'
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html'
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src'
make[1]: Nothing to be done for 'all-am'.
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src'
2025-02-03 22:05:21.104 | DEBUG    | scenario:evaluate:655 - testing candidate #4 against test #crash...
2025-02-03 22:05:21.104 | DEBUG    | shell:__call__:41 - executing: /data/vulnloc/libtiff/CVE-2016-5321/src/tools/tiffcrop /CrashRepair/experiments/vulnloc/libtiff/CVE-2016-5321/tests/1.tif foo.tif
2025-02-03 22:05:21.107 | DEBUG    | test:run:189 - test failed: unexpected exit code (actual: 255, expected: 0)
2025-02-03 22:05:21.108 | INFO     | scenario:evaluate:662 - candidate #4 fails test #crash
2025-02-03 22:05:21.112 | INFO     | scenario:evaluate:635 - evaluating candidate patch #5:
@@ -948,152 +948,159 @@
   return status;
   }
 
-static int  readSeparateTilesIntoBuffer (TIFF* in, uint8 *obuf, 
-					 uint32 imagelength, uint32 imagewidth, 
-                                         uint32 tw, uint32 tl,
-                                         uint16 spp, uint16 bps)
-  {
-  int     i, status = 1, sample;
-  int     shift_width, bytes_per_pixel;
-  uint16  bytes_per_sample;
-  uint32  row, col;     /* Current row and col of image */
-  uint32  nrow, ncol;   /* Number of rows and cols in current tile */
-  uint32  row_offset, col_offset; /* Output buffer offsets */
-  tsize_t tbytes = 0, tilesize = TIFFTileSize(in);
-  tsample_t s;
-  uint8*  bufp = (uint8*)obuf;
-  unsigned char *srcbuffs[MAX_SAMPLES];
-  unsigned char *tbuff = NULL;
 
-  bytes_per_sample = (bps + 7) / 8;
+static int readSeparateTilesIntoBuffer(TIFF* in, uint8 *obuf, 
+                                       uint32 imagelength, uint32 imagewidth, 
+                                       uint32 tw, uint32 tl,
+                                       uint16 spp, uint16 bps)
+{
+    int i, status = 1, sample;
+    int shift_width, bytes_per_pixel;
+    uint16 bytes_per_sample;
+    uint32 row, col; /* Current row and col of image */
+    uint32 nrow, ncol; /* Number of rows and cols in current tile */
+    uint32 row_offset, col_offset; /* Output buffer offsets */
+    tsize_t tbytes = 0, tilesize = TIFFTileSize(in);
+    tsample_t s;
+    uint8* bufp = (uint8*)obuf;
+    unsigned char *srcbuffs[MAX_SAMPLES];
+    unsigned char *tbuff = NULL;
+
+    bytes_per_sample = (bps + 7) / 8;
 
-  for (sample = 0; (sample < spp) && (sample < MAX_SAMPLES); sample++)
+    for (sample = 0; (sample < spp) && (sample < MAX_SAMPLES); sample++)
     {
-    srcbuffs[sample] = NULL;
-    tbuff = (unsigned char *)_TIFFmalloc(tilesize + 8);
-    if (!tbuff)
-      {
-      TIFFError ("readSeparateTilesIntoBuffer", 
-                 "Unable to allocate tile read buffer for sample %d", sample);
-      for (i = 0; i < sample; i++)
-        _TIFFfree (srcbuffs[i]);
-      return 0;
-      }
-    srcbuffs[sample] = tbuff;
-    } 
-  /* Each tile contains only the data for a single plane
-   * arranged in scanlines of tw * bytes_per_sample bytes.
-   */
-  for (row = 0; row < imagelength; row += tl)
+        srcbuffs[sample] = NULL;
+        tbuff = (unsigned char *)_TIFFmalloc(tilesize + 8);
+        if (!tbuff)
+        {
+            TIFFError("readSeparateTilesIntoBuffer", 
+                       "Unable to allocate tile read buffer for sample %d", sample);
+            for (i = 0; i < sample; i++)
+                _TIFFfree(srcbuffs[i]);
+            return 0;
+        }
+        srcbuffs[sample] = tbuff;
+    }
+    /* Each tile contains only the data for a single plane
+     * arranged in scanlines of tw * bytes_per_sample bytes.
+     */
+    for (row = 0; row < imagelength; row += tl)
     {
-    nrow = (row + tl > imagelength) ? imagelength - row : tl;
-    for (col = 0; col < imagewidth; col += tw)
-      {
-      for (s = 0; s < spp; s++)
-        {  /* Read each plane of a tile set into srcbuffs[s] */
-	tbytes = TIFFReadTile(in, srcbuffs[s], col, row, 0, s);
-        if (tbytes < 0  && !ignore)
-          {
-	  TIFFError(TIFFFileName(in),
-                 "Error, can't read tile for row %lu col %lu, "
-		 "sample %lu",
-		 (unsigned long) col, (unsigned long) row,
-		 (unsigned long) s);
-		 status = 0;
-          for (sample = 0; (sample < spp) && (sample < MAX_SAMPLES); sample++)
-            {
-            tbuff = srcbuffs[sample];
-            if (tbuff != NULL)
-              _TIFFfree(tbuff);
+        nrow = (row + tl > imagelength) ? imagelength - row : tl;
+        for (col = 0; col < imagewidth; col += tw)
+        {
+            for (s = 0; s < spp; s++)
+            {  /* Read each plane of a tile set into srcbuffs[s] */
+                tbytes = TIFFReadTile(in, srcbuffs[s], col, row, 0, s);
+                if (tbytes < 0 && !ignore)
+                {
+                    TIFFError(TIFFFileName(in),
+                               "Error, can't read tile for row %lu col %lu, "
+                               "sample %lu",
+                               (unsigned long)col, (unsigned long)row,
+                               (unsigned long)s);
+                    status = 0;
+                    for (sample = 0; (sample < spp) && (sample < MAX_SAMPLES); sample++)
+                    {
+                        tbuff = srcbuffs[sample];
+                        if (tbuff != NULL)
+                            _TIFFfree(tbuff);
+                    }
+                    return status;
+                }
             }
-          return status;
-	  }
-	}
-     /* Tiles on the right edge may be padded out to tw 
-      * which must be a multiple of 16.
-      * Ncol represents the visible (non padding) portion.  
-      */
-      if (col + tw > imagewidth)
-        ncol = imagewidth - col;
-      else
-        ncol = tw;
-
-      row_offset = row * (((imagewidth * spp * bps) + 7) / 8);
-      col_offset = ((col * spp * bps) + 7) / 8;
-      bufp = obuf + row_offset + col_offset;
+            /* Tiles on the right edge may be padded out to tw 
+             * which must be a multiple of 16.
+             * Ncol represents the visible (non padding) portion.  
+             */
+            if (col + tw > imagewidth)
+                ncol = imagewidth - col;
+            else
+                ncol = tw;
+
+            row_offset = row * (((imagewidth * spp * bps) + 7) / 8);
+            col_offset = ((col * spp * bps) + 7) / 8;
+            bufp = obuf + row_offset + col_offset;
 
-      if ((bps % 8) == 0)
-        {
-        if (combineSeparateTileSamplesBytes(srcbuffs, bufp, ncol, nrow, imagewidth,
-					    tw, spp, bps, NULL, 0, 0))
-	  {
-          status = 0;
-          break;
-      	  }
-	}
-      else
-        {
-        bytes_per_pixel  = ((bps * spp) + 7) / 8;
-        if (bytes_per_pixel < (bytes_per_sample + 1))
-          shift_width = bytes_per_pixel;
-        else
-          shift_width = bytes_per_sample + 1;
-
-        switch (shift_width)
-          {
-          case 1: if (combineSeparateTileSamples8bits (srcbuffs, bufp, ncol, nrow,
-                                                       imagewidth, tw, spp, bps, 
-						       NULL, 0, 0))
-	            {
+            if ((bps % 8) == 0)
+            {
+                if (combineSeparateTileSamplesBytes(srcbuffs, bufp, ncol, nrow, imagewidth,
+                                                     tw, spp, bps, NULL, 0, 0))
+                {
                     status = 0;
                     break;
-      	            }
-	          break;
-          case 2: if (combineSeparateTileSamples16bits (srcbuffs, bufp, ncol, nrow,
-                                                       imagewidth, tw, spp, bps, 
-						       NULL, 0, 0))
-	            {
-                    status = 0;
+                }
+            }
+            else
+            {
+                bytes_per_pixel = ((bps * spp) + 7) / 8;
+                if (bytes_per_pixel < (bytes_per_sample + 1))
+                    shift_width = bytes_per_pixel;
+                else
+                    shift_width = bytes_per_sample + 1;
+
+                switch (shift_width)
+                {
+                case 1: 
+                    if (combineSeparateTileSamples8bits(srcbuffs, bufp, ncol, nrow,
+                                                         imagewidth, tw, spp, bps, 
+                                                         NULL, 0, 0))
+                    {
+                        status = 0;
+                        break;
+                    }
                     break;
-		    }
-	          break;
-          case 3: if (combineSeparateTileSamples24bits (srcbuffs, bufp, ncol, nrow,
-                                                       imagewidth, tw, spp, bps, 
-						       NULL, 0, 0))
-	            {
-                    status = 0;
+                case 2: 
+                    if (combineSeparateTileSamples16bits(srcbuffs, bufp, ncol, nrow,
+                                                          imagewidth, tw, spp, bps, 
+                                                          NULL, 0, 0))
+                    {
+                        status = 0;
+                        break;
+                    }
+                    break;
+                case 3: 
+                    if (combineSeparateTileSamples24bits(srcbuffs, bufp, ncol, nrow,
+                                                          imagewidth, tw, spp, bps, 
+                                                          NULL, 0, 0))
+                    {
+                        status = 0;
+                        break;
+                    }
+                    break;
+                case 4: 
+                case 5:
+                case 6:
+                case 7:
+                case 8: 
+                    if (combineSeparateTileSamples32bits(srcbuffs, bufp, ncol, nrow,
+                                                          imagewidth, tw, spp, bps, 
+                                                          NULL, 0, 0))
+                    {
+                        status = 0;
+                        break;
+                    }
                     break;
-       	            }
-                  break;
-          case 4: 
-          case 5:
-          case 6:
-          case 7:
-          case 8: if (combineSeparateTileSamples32bits (srcbuffs, bufp, ncol, nrow,
-                                                       imagewidth, tw, spp, bps, 
-						       NULL, 0, 0))
-	            {
+                default: 
+                    TIFFError("readSeparateTilesIntoBuffer", "Unsupported bit depth: %d", bps);
                     status = 0;
                     break;
-		    }
-	          break;
-          default: TIFFError ("readSeparateTilesIntoBuffer", "Unsupported bit depth: %d", bps);
-                  status = 0;
-                  break;
-          }
+                }
+            }
         }
-      }
     }
 
-  for (sample = 0; (sample < spp) && (sample < MAX_SAMPLES); sample++)
+    for (sample = 0; (sample < spp) && (sample < MAX_SAMPLES); sample++)
     {
-    tbuff = srcbuffs[sample];
-    if (tbuff != NULL)
-      _TIFFfree(tbuff);
+        tbuff = srcbuffs[sample];
+        if (tbuff != NULL)
+            _TIFFfree(tbuff);
     }
- 
-  return status;
-  }
+
+    return status;
+}
+
 
 static int writeBufferToContigStrips(TIFF* out, uint8* buf, uint32 imagelength)
   {

2025-02-03 22:05:21.120 | DEBUG    | scenario:rebuild:369 - original environment: environ({'CONDA_SHLVL': '2', 'LC_ALL': 'C.UTF-8', 'LS_COLORS': 'rs=0:di=01;34:ln=01;36:mh=00:pi=40;33:so=01;35:do=01;35:bd=40;33;01:cd=40;33;01:or=40;31;01:mi=00:su=37;41:sg=30;43:ca=30;41:tw=30;42:ow=34;42:st=37;44:ex=01;32:*.tar=01;31:*.tgz=01;31:*.arc=01;31:*.arj=01;31:*.taz=01;31:*.lha=01;31:*.lz4=01;31:*.lzh=01;31:*.lzma=01;31:*.tlz=01;31:*.txz=01;31:*.tzo=01;31:*.t7z=01;31:*.zip=01;31:*.z=01;31:*.Z=01;31:*.dz=01;31:*.gz=01;31:*.lrz=01;31:*.lz=01;31:*.lzo=01;31:*.xz=01;31:*.zst=01;31:*.tzst=01;31:*.bz2=01;31:*.bz=01;31:*.tbz=01;31:*.tbz2=01;31:*.tz=01;31:*.deb=01;31:*.rpm=01;31:*.jar=01;31:*.war=01;31:*.ear=01;31:*.sar=01;31:*.rar=01;31:*.alz=01;31:*.ace=01;31:*.zoo=01;31:*.cpio=01;31:*.7z=01;31:*.rz=01;31:*.cab=01;31:*.wim=01;31:*.swm=01;31:*.dwm=01;31:*.esd=01;31:*.jpg=01;35:*.jpeg=01;35:*.mjpg=01;35:*.mjpeg=01;35:*.gif=01;35:*.bmp=01;35:*.pbm=01;35:*.pgm=01;35:*.ppm=01;35:*.tga=01;35:*.xbm=01;35:*.xpm=01;35:*.tif=01;35:*.tiff=01;35:*.png=01;35:*.svg=01;35:*.svgz=01;35:*.mng=01;35:*.pcx=01;35:*.mov=01;35:*.mpg=01;35:*.mpeg=01;35:*.m2v=01;35:*.mkv=01;35:*.webm=01;35:*.ogm=01;35:*.mp4=01;35:*.m4v=01;35:*.mp4v=01;35:*.vob=01;35:*.qt=01;35:*.nuv=01;35:*.wmv=01;35:*.asf=01;35:*.rm=01;35:*.rmvb=01;35:*.flc=01;35:*.avi=01;35:*.fli=01;35:*.flv=01;35:*.gl=01;35:*.dl=01;35:*.xcf=01;35:*.xwd=01;35:*.yuv=01;35:*.cgm=01;35:*.emf=01;35:*.ogv=01;35:*.ogx=01;35:*.aac=00;36:*.au=00;36:*.flac=00;36:*.m4a=00;36:*.mid=00;36:*.midi=00;36:*.mka=00;36:*.mp3=00;36:*.mpc=00;36:*.ogg=00;36:*.ra=00;36:*.wav=00;36:*.oga=00;36:*.opus=00;36:*.spx=00;36:*.xspf=00;36:', 'LD_LIBRARY_PATH': '/opt/crashrepair/lib:/CrashRepair/lib:/klee/build/lib:', 'CONDA_EXE': '/root/anaconda3/bin/conda', 'LANG': 'C.UTF-8', 'TZ': 'Asia/Shanghai', 'HOSTNAME': 'fea22102047d', 'OLDPWD': '/orchestrator', 'CONDA_PREFIX': '/root/anaconda3/envs/CrashRepair', '_CE_M': '', 'CC': 'crepair-cc', 'LLVM_COMPILER': 'clang', 'CONDA_PREFIX_1': '/root/anaconda3', 'PWD': '/orchestrator/crashrepair', 'HOME': '/root', 'CONDA_PYTHON_EXE': '/root/anaconda3/bin/python', '_CE_CONDA': '', 'CONDA_PROMPT_MODIFIER': '(CrashRepair) ', 'CXX': 'crepair-cxx', 'TERM': 'xterm', 'SHLVL': '2', 'PYTHONPATH': '/usr/lib/python3.8/site-packages:', 'PATH': '/root/anaconda3/envs/CrashRepair/bin:/root/anaconda3/condabin:~/anaconda3/bin:/opt/crashrepair/bin:/CrashRepair/compiler:/klee/build/bin:/opt/llvm-6/bin:/klee/build/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', 'CONDA_DEFAULT_ENV': 'CrashRepair', '_': '/root/anaconda3/envs/CrashRepair/bin/python'})
2025-02-03 22:05:21.120 | DEBUG    | scenario:rebuild:382 - injecting ghost function into CFLAGS during build: -lcrepair_ghost
2025-02-03 22:05:21.120 | DEBUG    | scenario:rebuild:398 - using environment: {'INJECT_CFLAGS': '-g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address', 'INJECT_CXXFLAGS': '-g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address', 'INJECT_LDFLAGS': '-g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address'}
2025-02-03 22:05:21.120 | DEBUG    | shell:__call__:41 - executing: make CFLAGS="${INJECT_CFLAGS}" CXXFLAGS="${INJECT_CXXFLAGS}" LDFLAGS="${INJECT_LDFLAGS}"
Making all in port
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/port'
make[1]: Nothing to be done for 'all'.
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/port'
Making all in libtiff
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/libtiff'
make  all-am
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/libtiff'
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/libtiff'
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/libtiff'
Making all in tools
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/tools'
crepair-cc -DHAVE_CONFIG_H -I. -I../libtiff  -I../libtiff   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -MT tiffcrop.o -MD -MP -MF .deps/tiffcrop.Tpo -c -o tiffcrop.o tiffcrop.c
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_ghost: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
mv -f .deps/tiffcrop.Tpo .deps/tiffcrop.Po
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address  -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -o tiffcrop tiffcrop.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -g -O0 -Wno-error -I/CrashRepair/lib -fsanitize=address -g -O0 -Wno-error -I/CrashRepair/lib -fsanitize=address -o tiffcrop tiffcrop.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a ../port/.libs/libport.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -llzma -ljbig -ljpeg -lz -lm
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/tools'
Making all in build
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/build'
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/build'
make[2]: Nothing to be done for 'all-am'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/build'
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/build'
Making all in contrib
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib'
Making all in addtiffo
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/addtiffo'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/addtiffo'
Making all in dbs
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/dbs'
Making all in xtiff
make[3]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/dbs/xtiff'
make[3]: Nothing to be done for 'all'.
make[3]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/dbs/xtiff'
make[3]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/dbs'
make[3]: Nothing to be done for 'all-am'.
make[3]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/dbs'
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/dbs'
Making all in iptcutil
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/iptcutil'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/iptcutil'
Making all in mfs
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/mfs'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/mfs'
Making all in pds
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/pds'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/pds'
Making all in ras
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/ras'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/ras'
Making all in stream
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/stream'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/stream'
Making all in tags
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/tags'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/tags'
Making all in win_dib
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/win_dib'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/win_dib'
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib'
make[2]: Nothing to be done for 'all-am'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib'
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib'
Making all in test
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/test'
make[1]: Nothing to be done for 'all'.
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/test'
Making all in man
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/man'
make[1]: Nothing to be done for 'all'.
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/man'
Making all in html
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html'
Making all in images
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html/images'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html/images'
Making all in man
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html/man'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html/man'
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html'
make[2]: Nothing to be done for 'all-am'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html'
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html'
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src'
make[1]: Nothing to be done for 'all-am'.
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src'
2025-02-03 22:05:21.594 | DEBUG    | scenario:evaluate:655 - testing candidate #5 against test #crash...
2025-02-03 22:05:21.594 | DEBUG    | shell:__call__:41 - executing: /data/vulnloc/libtiff/CVE-2016-5321/src/tools/tiffcrop /CrashRepair/experiments/vulnloc/libtiff/CVE-2016-5321/tests/1.tif foo.tif
2025-02-03 22:05:21.603 | DEBUG    | test:run:189 - test failed: unexpected exit code (actual: 139, expected: 0)
2025-02-03 22:05:21.603 | INFO     | scenario:evaluate:662 - candidate #5 fails test #crash
2025-02-03 22:05:21.609 | INFO     | scenario:evaluate:635 - evaluating candidate patch #6:
@@ -948,11 +948,12 @@
   return status;
   }
 
+
 static int  readSeparateTilesIntoBuffer (TIFF* in, uint8 *obuf, 
 					 uint32 imagelength, uint32 imagewidth, 
                                          uint32 tw, uint32 tl,
                                          uint16 spp, uint16 bps)
-  {
+{
   int     i, status = 1, sample;
   int     shift_width, bytes_per_pixel;
   uint16  bytes_per_sample;
@@ -968,51 +969,46 @@
   bytes_per_sample = (bps + 7) / 8;
 
   for (sample = 0; (sample < spp) && (sample < MAX_SAMPLES); sample++)
-    {
+  {
     srcbuffs[sample] = NULL;
     tbuff = (unsigned char *)_TIFFmalloc(tilesize + 8);
     if (!tbuff)
-      {
+    {
       TIFFError ("readSeparateTilesIntoBuffer", 
                  "Unable to allocate tile read buffer for sample %d", sample);
       for (i = 0; i < sample; i++)
         _TIFFfree (srcbuffs[i]);
       return 0;
-      }
+    }
     srcbuffs[sample] = tbuff;
-    } 
-  /* Each tile contains only the data for a single plane
-   * arranged in scanlines of tw * bytes_per_sample bytes.
-   */
+  } 
+
   for (row = 0; row < imagelength; row += tl)
-    {
+  {
     nrow = (row + tl > imagelength) ? imagelength - row : tl;
     for (col = 0; col < imagewidth; col += tw)
-      {
+    {
       for (s = 0; s < spp; s++)
-        {  /* Read each plane of a tile set into srcbuffs[s] */
-	tbytes = TIFFReadTile(in, srcbuffs[s], col, row, 0, s);
+      {  
+        tbytes = TIFFReadTile(in, srcbuffs[s], col, row, 0, s);
         if (tbytes < 0  && !ignore)
-          {
-	  TIFFError(TIFFFileName(in),
+        {
+          TIFFError(TIFFFileName(in),
                  "Error, can't read tile for row %lu col %lu, "
 		 "sample %lu",
 		 (unsigned long) col, (unsigned long) row,
 		 (unsigned long) s);
-		 status = 0;
+          status = 0;
           for (sample = 0; (sample < spp) && (sample < MAX_SAMPLES); sample++)
-            {
+          {
             tbuff = srcbuffs[sample];
             if (tbuff != NULL)
               _TIFFfree(tbuff);
-            }
+          }
           return status;
-	  }
-	}
-     /* Tiles on the right edge may be padded out to tw 
-      * which must be a multiple of 16.
-      * Ncol represents the visible (non padding) portion.  
-      */
+        }
+      }
+     
       if (col + tw > imagewidth)
         ncol = imagewidth - col;
       else
@@ -1023,16 +1019,16 @@
       bufp = obuf + row_offset + col_offset;
 
       if ((bps % 8) == 0)
-        {
+      {
         if (combineSeparateTileSamplesBytes(srcbuffs, bufp, ncol, nrow, imagewidth,
 					    tw, spp, bps, NULL, 0, 0))
-	  {
+	{
           status = 0;
           break;
-      	  }
-	}
+        }
+      }
       else
-        {
+      {
         bytes_per_pixel  = ((bps * spp) + 7) / 8;
         if (bytes_per_pixel < (bytes_per_sample + 1))
           shift_width = bytes_per_pixel;
@@ -1040,7 +1036,7 @@
           shift_width = bytes_per_sample + 1;
 
         switch (shift_width)
-          {
+        {
           case 1: if (combineSeparateTileSamples8bits (srcbuffs, bufp, ncol, nrow,
                                                        imagewidth, tw, spp, bps, 
 						       NULL, 0, 0))
@@ -1080,20 +1076,21 @@
           default: TIFFError ("readSeparateTilesIntoBuffer", "Unsupported bit depth: %d", bps);
                   status = 0;
                   break;
-          }
         }
       }
     }
+  }
 
   for (sample = 0; (sample < spp) && (sample < MAX_SAMPLES); sample++)
-    {
+  {
     tbuff = srcbuffs[sample];
     if (tbuff != NULL)
       _TIFFfree(tbuff);
-    }
+  }
  
   return status;
-  }
+}
+
 
 static int writeBufferToContigStrips(TIFF* out, uint8* buf, uint32 imagelength)
   {

2025-02-03 22:05:21.615 | DEBUG    | scenario:rebuild:369 - original environment: environ({'CONDA_SHLVL': '2', 'LC_ALL': 'C.UTF-8', 'LS_COLORS': 'rs=0:di=01;34:ln=01;36:mh=00:pi=40;33:so=01;35:do=01;35:bd=40;33;01:cd=40;33;01:or=40;31;01:mi=00:su=37;41:sg=30;43:ca=30;41:tw=30;42:ow=34;42:st=37;44:ex=01;32:*.tar=01;31:*.tgz=01;31:*.arc=01;31:*.arj=01;31:*.taz=01;31:*.lha=01;31:*.lz4=01;31:*.lzh=01;31:*.lzma=01;31:*.tlz=01;31:*.txz=01;31:*.tzo=01;31:*.t7z=01;31:*.zip=01;31:*.z=01;31:*.Z=01;31:*.dz=01;31:*.gz=01;31:*.lrz=01;31:*.lz=01;31:*.lzo=01;31:*.xz=01;31:*.zst=01;31:*.tzst=01;31:*.bz2=01;31:*.bz=01;31:*.tbz=01;31:*.tbz2=01;31:*.tz=01;31:*.deb=01;31:*.rpm=01;31:*.jar=01;31:*.war=01;31:*.ear=01;31:*.sar=01;31:*.rar=01;31:*.alz=01;31:*.ace=01;31:*.zoo=01;31:*.cpio=01;31:*.7z=01;31:*.rz=01;31:*.cab=01;31:*.wim=01;31:*.swm=01;31:*.dwm=01;31:*.esd=01;31:*.jpg=01;35:*.jpeg=01;35:*.mjpg=01;35:*.mjpeg=01;35:*.gif=01;35:*.bmp=01;35:*.pbm=01;35:*.pgm=01;35:*.ppm=01;35:*.tga=01;35:*.xbm=01;35:*.xpm=01;35:*.tif=01;35:*.tiff=01;35:*.png=01;35:*.svg=01;35:*.svgz=01;35:*.mng=01;35:*.pcx=01;35:*.mov=01;35:*.mpg=01;35:*.mpeg=01;35:*.m2v=01;35:*.mkv=01;35:*.webm=01;35:*.ogm=01;35:*.mp4=01;35:*.m4v=01;35:*.mp4v=01;35:*.vob=01;35:*.qt=01;35:*.nuv=01;35:*.wmv=01;35:*.asf=01;35:*.rm=01;35:*.rmvb=01;35:*.flc=01;35:*.avi=01;35:*.fli=01;35:*.flv=01;35:*.gl=01;35:*.dl=01;35:*.xcf=01;35:*.xwd=01;35:*.yuv=01;35:*.cgm=01;35:*.emf=01;35:*.ogv=01;35:*.ogx=01;35:*.aac=00;36:*.au=00;36:*.flac=00;36:*.m4a=00;36:*.mid=00;36:*.midi=00;36:*.mka=00;36:*.mp3=00;36:*.mpc=00;36:*.ogg=00;36:*.ra=00;36:*.wav=00;36:*.oga=00;36:*.opus=00;36:*.spx=00;36:*.xspf=00;36:', 'LD_LIBRARY_PATH': '/opt/crashrepair/lib:/CrashRepair/lib:/klee/build/lib:', 'CONDA_EXE': '/root/anaconda3/bin/conda', 'LANG': 'C.UTF-8', 'TZ': 'Asia/Shanghai', 'HOSTNAME': 'fea22102047d', 'OLDPWD': '/orchestrator', 'CONDA_PREFIX': '/root/anaconda3/envs/CrashRepair', '_CE_M': '', 'CC': 'crepair-cc', 'LLVM_COMPILER': 'clang', 'CONDA_PREFIX_1': '/root/anaconda3', 'PWD': '/orchestrator/crashrepair', 'HOME': '/root', 'CONDA_PYTHON_EXE': '/root/anaconda3/bin/python', '_CE_CONDA': '', 'CONDA_PROMPT_MODIFIER': '(CrashRepair) ', 'CXX': 'crepair-cxx', 'TERM': 'xterm', 'SHLVL': '2', 'PYTHONPATH': '/usr/lib/python3.8/site-packages:', 'PATH': '/root/anaconda3/envs/CrashRepair/bin:/root/anaconda3/condabin:~/anaconda3/bin:/opt/crashrepair/bin:/CrashRepair/compiler:/klee/build/bin:/opt/llvm-6/bin:/klee/build/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', 'CONDA_DEFAULT_ENV': 'CrashRepair', '_': '/root/anaconda3/envs/CrashRepair/bin/python'})
2025-02-03 22:05:21.615 | DEBUG    | scenario:rebuild:382 - injecting ghost function into CFLAGS during build: -lcrepair_ghost
2025-02-03 22:05:21.615 | DEBUG    | scenario:rebuild:398 - using environment: {'INJECT_CFLAGS': '-g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address', 'INJECT_CXXFLAGS': '-g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address', 'INJECT_LDFLAGS': '-g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address'}
2025-02-03 22:05:21.615 | DEBUG    | shell:__call__:41 - executing: make CFLAGS="${INJECT_CFLAGS}" CXXFLAGS="${INJECT_CXXFLAGS}" LDFLAGS="${INJECT_LDFLAGS}"
Making all in port
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/port'
make[1]: Nothing to be done for 'all'.
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/port'
Making all in libtiff
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/libtiff'
make  all-am
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/libtiff'
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/libtiff'
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/libtiff'
Making all in tools
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/tools'
crepair-cc -DHAVE_CONFIG_H -I. -I../libtiff  -I../libtiff   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -MT tiffcrop.o -MD -MP -MF .deps/tiffcrop.Tpo -c -o tiffcrop.o tiffcrop.c
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_ghost: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
mv -f .deps/tiffcrop.Tpo .deps/tiffcrop.Po
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address  -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -o tiffcrop tiffcrop.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -g -O0 -Wno-error -I/CrashRepair/lib -fsanitize=address -g -O0 -Wno-error -I/CrashRepair/lib -fsanitize=address -o tiffcrop tiffcrop.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a ../port/.libs/libport.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -llzma -ljbig -ljpeg -lz -lm
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/tools'
Making all in build
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/build'
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/build'
make[2]: Nothing to be done for 'all-am'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/build'
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/build'
Making all in contrib
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib'
Making all in addtiffo
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/addtiffo'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/addtiffo'
Making all in dbs
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/dbs'
Making all in xtiff
make[3]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/dbs/xtiff'
make[3]: Nothing to be done for 'all'.
make[3]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/dbs/xtiff'
make[3]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/dbs'
make[3]: Nothing to be done for 'all-am'.
make[3]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/dbs'
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/dbs'
Making all in iptcutil
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/iptcutil'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/iptcutil'
Making all in mfs
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/mfs'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/mfs'
Making all in pds
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/pds'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/pds'
Making all in ras
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/ras'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/ras'
Making all in stream
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/stream'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/stream'
Making all in tags
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/tags'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/tags'
Making all in win_dib
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/win_dib'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/win_dib'
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib'
make[2]: Nothing to be done for 'all-am'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib'
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib'
Making all in test
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/test'
make[1]: Nothing to be done for 'all'.
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/test'
Making all in man
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/man'
make[1]: Nothing to be done for 'all'.
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/man'
Making all in html
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html'
Making all in images
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html/images'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html/images'
Making all in man
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html/man'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html/man'
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html'
make[2]: Nothing to be done for 'all-am'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html'
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html'
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src'
make[1]: Nothing to be done for 'all-am'.
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src'
2025-02-03 22:05:22.092 | DEBUG    | scenario:evaluate:655 - testing candidate #6 against test #crash...
2025-02-03 22:05:22.092 | DEBUG    | shell:__call__:41 - executing: /data/vulnloc/libtiff/CVE-2016-5321/src/tools/tiffcrop /CrashRepair/experiments/vulnloc/libtiff/CVE-2016-5321/tests/1.tif foo.tif
2025-02-03 22:05:22.098 | DEBUG    | test:run:189 - test failed: unexpected exit code (actual: 139, expected: 0)
2025-02-03 22:05:22.098 | INFO     | scenario:evaluate:662 - candidate #6 fails test #crash
2025-02-03 22:05:22.103 | INFO     | scenario:evaluate:635 - evaluating candidate patch #7:
@@ -948,152 +948,147 @@
   return status;
   }
 
-static int  readSeparateTilesIntoBuffer (TIFF* in, uint8 *obuf, 
-					 uint32 imagelength, uint32 imagewidth, 
-                                         uint32 tw, uint32 tl,
-                                         uint16 spp, uint16 bps)
-  {
-  int     i, status = 1, sample;
-  int     shift_width, bytes_per_pixel;
-  uint16  bytes_per_sample;
-  uint32  row, col;     /* Current row and col of image */
-  uint32  nrow, ncol;   /* Number of rows and cols in current tile */
-  uint32  row_offset, col_offset; /* Output buffer offsets */
-  tsize_t tbytes = 0, tilesize = TIFFTileSize(in);
-  tsample_t s;
-  uint8*  bufp = (uint8*)obuf;
-  unsigned char *srcbuffs[MAX_SAMPLES];
-  unsigned char *tbuff = NULL;
 
-  bytes_per_sample = (bps + 7) / 8;
+static int readSeparateTilesIntoBuffer(TIFF* in, uint8 *obuf, 
+                                        uint32 imagelength, uint32 imagewidth, 
+                                        uint32 tw, uint32 tl,
+                                        uint16 spp, uint16 bps)
+{
+    int     i, status = 1, sample;
+    int     shift_width, bytes_per_pixel;
+    uint16  bytes_per_sample;
+    uint32  row, col;     /* Current row and col of image */
+    uint32  nrow, ncol;   /* Number of rows and cols in current tile */
+    uint32  row_offset, col_offset; /* Output buffer offsets */
+    tsize_t tbytes = 0, tilesize = TIFFTileSize(in);
+    tsample_t s;
+    uint8*  bufp = (uint8*)obuf;
+    unsigned char *srcbuffs[MAX_SAMPLES];
+    unsigned char *tbuff = NULL;
+
+    bytes_per_sample = (bps + 7) / 8;
 
-  for (sample = 0; (sample < spp) && (sample < MAX_SAMPLES); sample++)
+    for (sample = 0; (sample < spp) && (sample < MAX_SAMPLES); sample++)
     {
-    srcbuffs[sample] = NULL;
-    tbuff = (unsigned char *)_TIFFmalloc(tilesize + 8);
-    if (!tbuff)
-      {
-      TIFFError ("readSeparateTilesIntoBuffer", 
-                 "Unable to allocate tile read buffer for sample %d", sample);
-      for (i = 0; i < sample; i++)
-        _TIFFfree (srcbuffs[i]);
-      return 0;
-      }
-    srcbuffs[sample] = tbuff;
+        srcbuffs[sample] = NULL;
+        tbuff = (unsigned char *)_TIFFmalloc(tilesize + 8);
+        if (!tbuff)
+        {
+            TIFFError ("readSeparateTilesIntoBuffer", 
+                        "Unable to allocate tile read buffer for sample %d", sample);
+            for (i = 0; i < sample; i++)
+                _TIFFfree(srcbuffs[i]);
+            return 0;
+        }
+        srcbuffs[sample] = tbuff;
     } 
-  /* Each tile contains only the data for a single plane
-   * arranged in scanlines of tw * bytes_per_sample bytes.
-   */
-  for (row = 0; row < imagelength; row += tl)
-    {
-    nrow = (row + tl > imagelength) ? imagelength - row : tl;
-    for (col = 0; col < imagewidth; col += tw)
-      {
-      for (s = 0; s < spp; s++)
-        {  /* Read each plane of a tile set into srcbuffs[s] */
-	tbytes = TIFFReadTile(in, srcbuffs[s], col, row, 0, s);
-        if (tbytes < 0  && !ignore)
-          {
-	  TIFFError(TIFFFileName(in),
-                 "Error, can't read tile for row %lu col %lu, "
-		 "sample %lu",
-		 (unsigned long) col, (unsigned long) row,
-		 (unsigned long) s);
-		 status = 0;
-          for (sample = 0; (sample < spp) && (sample < MAX_SAMPLES); sample++)
-            {
-            tbuff = srcbuffs[sample];
-            if (tbuff != NULL)
-              _TIFFfree(tbuff);
-            }
-          return status;
-	  }
-	}
-     /* Tiles on the right edge may be padded out to tw 
-      * which must be a multiple of 16.
-      * Ncol represents the visible (non padding) portion.  
-      */
-      if (col + tw > imagewidth)
-        ncol = imagewidth - col;
-      else
-        ncol = tw;
-
-      row_offset = row * (((imagewidth * spp * bps) + 7) / 8);
-      col_offset = ((col * spp * bps) + 7) / 8;
-      bufp = obuf + row_offset + col_offset;
 
-      if ((bps % 8) == 0)
-        {
-        if (combineSeparateTileSamplesBytes(srcbuffs, bufp, ncol, nrow, imagewidth,
-					    tw, spp, bps, NULL, 0, 0))
-	  {
-          status = 0;
-          break;
-      	  }
-	}
-      else
+    for (row = 0; row < imagelength; row += tl)
+    {
+        nrow = (row + tl > imagelength) ? imagelength - row : tl;
+        for (col = 0; col < imagewidth; col += tw)
         {
-        bytes_per_pixel  = ((bps * spp) + 7) / 8;
-        if (bytes_per_pixel < (bytes_per_sample + 1))
-          shift_width = bytes_per_pixel;
-        else
-          shift_width = bytes_per_sample + 1;
-
-        switch (shift_width)
-          {
-          case 1: if (combineSeparateTileSamples8bits (srcbuffs, bufp, ncol, nrow,
-                                                       imagewidth, tw, spp, bps, 
-						       NULL, 0, 0))
-	            {
+            for (s = 0; s < spp; s++)
+            {  
+                /* Read each plane of a tile set into srcbuffs[s], adding error checks */
+                tbytes = TIFFReadTile(in, srcbuffs[s], col, row, 0, s);
+                if (tbytes == (tsize_t)-1 || tbytes == 0)
+                {
+                    TIFFError(TIFFFileName(in),
+                               "Error, can't read tile for row %lu col %lu, "
+                               "sample %lu",
+                               (unsigned long) col, (unsigned long) row,
+                               (unsigned long) s);
                     status = 0;
                     break;
-      	            }
-	          break;
-          case 2: if (combineSeparateTileSamples16bits (srcbuffs, bufp, ncol, nrow,
-                                                       imagewidth, tw, spp, bps, 
-						       NULL, 0, 0))
-	            {
+                }
+            }
+            if (status == 0) break;
+
+            if (col + tw > imagewidth)
+                ncol = imagewidth - col;
+            else
+                ncol = tw;
+
+            row_offset = row * (((imagewidth * spp * bps) + 7) / 8);
+            col_offset = ((col * spp * bps) + 7) / 8;
+            bufp = obuf + row_offset + col_offset;
+
+            if ((bps % 8) == 0)
+            {
+                if (combineSeparateTileSamplesBytes(srcbuffs, bufp, ncol, nrow, imagewidth,
+                                                     tw, spp, bps, NULL, 0, 0))
+                {
                     status = 0;
                     break;
-		    }
-	          break;
-          case 3: if (combineSeparateTileSamples24bits (srcbuffs, bufp, ncol, nrow,
-                                                       imagewidth, tw, spp, bps, 
-						       NULL, 0, 0))
-	            {
-                    status = 0;
+                }
+            }
+            else
+            {
+                bytes_per_pixel  = ((bps * spp) + 7) / 8;
+                if (bytes_per_pixel < (bytes_per_sample + 1))
+                    shift_width = bytes_per_pixel;
+                else
+                    shift_width = bytes_per_sample + 1;
+
+                switch (shift_width)
+                {
+                case 1: if (combineSeparateTileSamples8bits(srcbuffs, bufp, ncol, nrow,
+                                                             imagewidth, tw, spp, bps, 
+                                                             NULL, 0, 0))
+                    {
+                        status = 0;
+                        break;
+                    }
                     break;
-       	            }
-                  break;
-          case 4: 
-          case 5:
-          case 6:
-          case 7:
-          case 8: if (combineSeparateTileSamples32bits (srcbuffs, bufp, ncol, nrow,
-                                                       imagewidth, tw, spp, bps, 
-						       NULL, 0, 0))
-	            {
-                    status = 0;
+                case 2: if (combineSeparateTileSamples16bits(srcbuffs, bufp, ncol, nrow,
+                                                             imagewidth, tw, spp, bps, 
+                                                             NULL, 0, 0))
+                    {
+                        status = 0;
+                        break;
+                    }
+                    break;
+                case 3: if (combineSeparateTileSamples24bits(srcbuffs, bufp, ncol, nrow,
+                                                             imagewidth, tw, spp, bps, 
+                                                             NULL, 0, 0))
+                    {
+                        status = 0;
+                        break;
+                    }
                     break;
-		    }
-	          break;
-          default: TIFFError ("readSeparateTilesIntoBuffer", "Unsupported bit depth: %d", bps);
-                  status = 0;
-                  break;
-          }
+                case 4: 
+                case 5:
+                case 6:
+                case 7:
+                case 8: if (combineSeparateTileSamples32bits(srcbuffs, bufp, ncol, nrow,
+                                                             imagewidth, tw, spp, bps, 
+                                                             NULL, 0, 0))
+                    {
+                        status = 0;
+                        break;
+                    }
+                    break;
+                default: TIFFError ("readSeparateTilesIntoBuffer", "Unsupported bit depth: %d", bps);
+                         status = 0;
+                         break;
+                }
+            }
+            if (status == 0) break;
         }
-      }
+        if (status == 0) break;
     }
 
-  for (sample = 0; (sample < spp) && (sample < MAX_SAMPLES); sample++)
+    for (sample = 0; (sample < spp) && (sample < MAX_SAMPLES); sample++)
     {
-    tbuff = srcbuffs[sample];
-    if (tbuff != NULL)
-      _TIFFfree(tbuff);
+        tbuff = srcbuffs[sample];
+        if (tbuff != NULL)
+            _TIFFfree(tbuff);
     }
- 
-  return status;
-  }
+
+    return status;
+}
+
 
 static int writeBufferToContigStrips(TIFF* out, uint8* buf, uint32 imagelength)
   {

2025-02-03 22:05:22.111 | DEBUG    | scenario:rebuild:369 - original environment: environ({'CONDA_SHLVL': '2', 'LC_ALL': 'C.UTF-8', 'LS_COLORS': 'rs=0:di=01;34:ln=01;36:mh=00:pi=40;33:so=01;35:do=01;35:bd=40;33;01:cd=40;33;01:or=40;31;01:mi=00:su=37;41:sg=30;43:ca=30;41:tw=30;42:ow=34;42:st=37;44:ex=01;32:*.tar=01;31:*.tgz=01;31:*.arc=01;31:*.arj=01;31:*.taz=01;31:*.lha=01;31:*.lz4=01;31:*.lzh=01;31:*.lzma=01;31:*.tlz=01;31:*.txz=01;31:*.tzo=01;31:*.t7z=01;31:*.zip=01;31:*.z=01;31:*.Z=01;31:*.dz=01;31:*.gz=01;31:*.lrz=01;31:*.lz=01;31:*.lzo=01;31:*.xz=01;31:*.zst=01;31:*.tzst=01;31:*.bz2=01;31:*.bz=01;31:*.tbz=01;31:*.tbz2=01;31:*.tz=01;31:*.deb=01;31:*.rpm=01;31:*.jar=01;31:*.war=01;31:*.ear=01;31:*.sar=01;31:*.rar=01;31:*.alz=01;31:*.ace=01;31:*.zoo=01;31:*.cpio=01;31:*.7z=01;31:*.rz=01;31:*.cab=01;31:*.wim=01;31:*.swm=01;31:*.dwm=01;31:*.esd=01;31:*.jpg=01;35:*.jpeg=01;35:*.mjpg=01;35:*.mjpeg=01;35:*.gif=01;35:*.bmp=01;35:*.pbm=01;35:*.pgm=01;35:*.ppm=01;35:*.tga=01;35:*.xbm=01;35:*.xpm=01;35:*.tif=01;35:*.tiff=01;35:*.png=01;35:*.svg=01;35:*.svgz=01;35:*.mng=01;35:*.pcx=01;35:*.mov=01;35:*.mpg=01;35:*.mpeg=01;35:*.m2v=01;35:*.mkv=01;35:*.webm=01;35:*.ogm=01;35:*.mp4=01;35:*.m4v=01;35:*.mp4v=01;35:*.vob=01;35:*.qt=01;35:*.nuv=01;35:*.wmv=01;35:*.asf=01;35:*.rm=01;35:*.rmvb=01;35:*.flc=01;35:*.avi=01;35:*.fli=01;35:*.flv=01;35:*.gl=01;35:*.dl=01;35:*.xcf=01;35:*.xwd=01;35:*.yuv=01;35:*.cgm=01;35:*.emf=01;35:*.ogv=01;35:*.ogx=01;35:*.aac=00;36:*.au=00;36:*.flac=00;36:*.m4a=00;36:*.mid=00;36:*.midi=00;36:*.mka=00;36:*.mp3=00;36:*.mpc=00;36:*.ogg=00;36:*.ra=00;36:*.wav=00;36:*.oga=00;36:*.opus=00;36:*.spx=00;36:*.xspf=00;36:', 'LD_LIBRARY_PATH': '/opt/crashrepair/lib:/CrashRepair/lib:/klee/build/lib:', 'CONDA_EXE': '/root/anaconda3/bin/conda', 'LANG': 'C.UTF-8', 'TZ': 'Asia/Shanghai', 'HOSTNAME': 'fea22102047d', 'OLDPWD': '/orchestrator', 'CONDA_PREFIX': '/root/anaconda3/envs/CrashRepair', '_CE_M': '', 'CC': 'crepair-cc', 'LLVM_COMPILER': 'clang', 'CONDA_PREFIX_1': '/root/anaconda3', 'PWD': '/orchestrator/crashrepair', 'HOME': '/root', 'CONDA_PYTHON_EXE': '/root/anaconda3/bin/python', '_CE_CONDA': '', 'CONDA_PROMPT_MODIFIER': '(CrashRepair) ', 'CXX': 'crepair-cxx', 'TERM': 'xterm', 'SHLVL': '2', 'PYTHONPATH': '/usr/lib/python3.8/site-packages:', 'PATH': '/root/anaconda3/envs/CrashRepair/bin:/root/anaconda3/condabin:~/anaconda3/bin:/opt/crashrepair/bin:/CrashRepair/compiler:/klee/build/bin:/opt/llvm-6/bin:/klee/build/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', 'CONDA_DEFAULT_ENV': 'CrashRepair', '_': '/root/anaconda3/envs/CrashRepair/bin/python'})
2025-02-03 22:05:22.111 | DEBUG    | scenario:rebuild:382 - injecting ghost function into CFLAGS during build: -lcrepair_ghost
2025-02-03 22:05:22.111 | DEBUG    | scenario:rebuild:398 - using environment: {'INJECT_CFLAGS': '-g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address', 'INJECT_CXXFLAGS': '-g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address', 'INJECT_LDFLAGS': '-g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address'}
2025-02-03 22:05:22.111 | DEBUG    | shell:__call__:41 - executing: make CFLAGS="${INJECT_CFLAGS}" CXXFLAGS="${INJECT_CXXFLAGS}" LDFLAGS="${INJECT_LDFLAGS}"
Making all in port
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/port'
make[1]: Nothing to be done for 'all'.
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/port'
Making all in libtiff
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/libtiff'
make  all-am
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/libtiff'
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/libtiff'
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/libtiff'
Making all in tools
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/tools'
crepair-cc -DHAVE_CONFIG_H -I. -I../libtiff  -I../libtiff   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -MT tiffcrop.o -MD -MP -MF .deps/tiffcrop.Tpo -c -o tiffcrop.o tiffcrop.c
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_ghost: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
mv -f .deps/tiffcrop.Tpo .deps/tiffcrop.Po
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address  -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -o tiffcrop tiffcrop.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -g -O0 -Wno-error -I/CrashRepair/lib -fsanitize=address -g -O0 -Wno-error -I/CrashRepair/lib -fsanitize=address -o tiffcrop tiffcrop.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a ../port/.libs/libport.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -llzma -ljbig -ljpeg -lz -lm
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/tools'
Making all in build
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/build'
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/build'
make[2]: Nothing to be done for 'all-am'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/build'
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/build'
Making all in contrib
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib'
Making all in addtiffo
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/addtiffo'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/addtiffo'
Making all in dbs
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/dbs'
Making all in xtiff
make[3]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/dbs/xtiff'
make[3]: Nothing to be done for 'all'.
make[3]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/dbs/xtiff'
make[3]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/dbs'
make[3]: Nothing to be done for 'all-am'.
make[3]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/dbs'
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/dbs'
Making all in iptcutil
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/iptcutil'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/iptcutil'
Making all in mfs
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/mfs'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/mfs'
Making all in pds
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/pds'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/pds'
Making all in ras
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/ras'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/ras'
Making all in stream
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/stream'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/stream'
Making all in tags
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/tags'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/tags'
Making all in win_dib
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/win_dib'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/win_dib'
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib'
make[2]: Nothing to be done for 'all-am'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib'
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib'
Making all in test
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/test'
make[1]: Nothing to be done for 'all'.
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/test'
Making all in man
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/man'
make[1]: Nothing to be done for 'all'.
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/man'
Making all in html
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html'
Making all in images
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html/images'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html/images'
Making all in man
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html/man'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html/man'
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html'
make[2]: Nothing to be done for 'all-am'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html'
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html'
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src'
make[1]: Nothing to be done for 'all-am'.
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src'
2025-02-03 22:05:22.597 | DEBUG    | scenario:evaluate:655 - testing candidate #7 against test #crash...
2025-02-03 22:05:22.597 | DEBUG    | shell:__call__:41 - executing: /data/vulnloc/libtiff/CVE-2016-5321/src/tools/tiffcrop /CrashRepair/experiments/vulnloc/libtiff/CVE-2016-5321/tests/1.tif foo.tif
2025-02-03 22:05:22.606 | DEBUG    | test:run:189 - test failed: unexpected exit code (actual: 139, expected: 0)
2025-02-03 22:05:22.607 | INFO     | scenario:evaluate:662 - candidate #7 fails test #crash
2025-02-03 22:05:22.611 | INFO     | scenario:evaluate:635 - evaluating candidate patch #8:
@@ -948,6 +948,7 @@
   return status;
   }
 
+
 static int  readSeparateTilesIntoBuffer (TIFF* in, uint8 *obuf, 
 					 uint32 imagelength, uint32 imagewidth, 
                                          uint32 tw, uint32 tl,
@@ -991,24 +992,15 @@
       {
       for (s = 0; s < spp; s++)
         {  /* Read each plane of a tile set into srcbuffs[s] */
-	tbytes = TIFFReadTile(in, srcbuffs[s], col, row, 0, s);
-        if (tbytes < 0  && !ignore)
-          {
+	if (!(tbytes = TIFFReadTile(in, srcbuffs[s], col, row, 0, s))) {
 	  TIFFError(TIFFFileName(in),
                  "Error, can't read tile for row %lu col %lu, "
 		 "sample %lu",
 		 (unsigned long) col, (unsigned long) row,
 		 (unsigned long) s);
-		 status = 0;
-          for (sample = 0; (sample < spp) && (sample < MAX_SAMPLES); sample++)
-            {
-            tbuff = srcbuffs[sample];
-            if (tbuff != NULL)
-              _TIFFfree(tbuff);
-            }
-          return status;
-	  }
-	}
+	  status = 0;
+        }
+        }
      /* Tiles on the right edge may be padded out to tw 
       * which must be a multiple of 16.
       * Ncol represents the visible (non padding) portion.  
@@ -1095,6 +1087,7 @@
   return status;
   }
 
+
 static int writeBufferToContigStrips(TIFF* out, uint8* buf, uint32 imagelength)
   {
   uint32 row, nrows, rowsperstrip;

2025-02-03 22:05:22.617 | DEBUG    | scenario:rebuild:369 - original environment: environ({'CONDA_SHLVL': '2', 'LC_ALL': 'C.UTF-8', 'LS_COLORS': 'rs=0:di=01;34:ln=01;36:mh=00:pi=40;33:so=01;35:do=01;35:bd=40;33;01:cd=40;33;01:or=40;31;01:mi=00:su=37;41:sg=30;43:ca=30;41:tw=30;42:ow=34;42:st=37;44:ex=01;32:*.tar=01;31:*.tgz=01;31:*.arc=01;31:*.arj=01;31:*.taz=01;31:*.lha=01;31:*.lz4=01;31:*.lzh=01;31:*.lzma=01;31:*.tlz=01;31:*.txz=01;31:*.tzo=01;31:*.t7z=01;31:*.zip=01;31:*.z=01;31:*.Z=01;31:*.dz=01;31:*.gz=01;31:*.lrz=01;31:*.lz=01;31:*.lzo=01;31:*.xz=01;31:*.zst=01;31:*.tzst=01;31:*.bz2=01;31:*.bz=01;31:*.tbz=01;31:*.tbz2=01;31:*.tz=01;31:*.deb=01;31:*.rpm=01;31:*.jar=01;31:*.war=01;31:*.ear=01;31:*.sar=01;31:*.rar=01;31:*.alz=01;31:*.ace=01;31:*.zoo=01;31:*.cpio=01;31:*.7z=01;31:*.rz=01;31:*.cab=01;31:*.wim=01;31:*.swm=01;31:*.dwm=01;31:*.esd=01;31:*.jpg=01;35:*.jpeg=01;35:*.mjpg=01;35:*.mjpeg=01;35:*.gif=01;35:*.bmp=01;35:*.pbm=01;35:*.pgm=01;35:*.ppm=01;35:*.tga=01;35:*.xbm=01;35:*.xpm=01;35:*.tif=01;35:*.tiff=01;35:*.png=01;35:*.svg=01;35:*.svgz=01;35:*.mng=01;35:*.pcx=01;35:*.mov=01;35:*.mpg=01;35:*.mpeg=01;35:*.m2v=01;35:*.mkv=01;35:*.webm=01;35:*.ogm=01;35:*.mp4=01;35:*.m4v=01;35:*.mp4v=01;35:*.vob=01;35:*.qt=01;35:*.nuv=01;35:*.wmv=01;35:*.asf=01;35:*.rm=01;35:*.rmvb=01;35:*.flc=01;35:*.avi=01;35:*.fli=01;35:*.flv=01;35:*.gl=01;35:*.dl=01;35:*.xcf=01;35:*.xwd=01;35:*.yuv=01;35:*.cgm=01;35:*.emf=01;35:*.ogv=01;35:*.ogx=01;35:*.aac=00;36:*.au=00;36:*.flac=00;36:*.m4a=00;36:*.mid=00;36:*.midi=00;36:*.mka=00;36:*.mp3=00;36:*.mpc=00;36:*.ogg=00;36:*.ra=00;36:*.wav=00;36:*.oga=00;36:*.opus=00;36:*.spx=00;36:*.xspf=00;36:', 'LD_LIBRARY_PATH': '/opt/crashrepair/lib:/CrashRepair/lib:/klee/build/lib:', 'CONDA_EXE': '/root/anaconda3/bin/conda', 'LANG': 'C.UTF-8', 'TZ': 'Asia/Shanghai', 'HOSTNAME': 'fea22102047d', 'OLDPWD': '/orchestrator', 'CONDA_PREFIX': '/root/anaconda3/envs/CrashRepair', '_CE_M': '', 'CC': 'crepair-cc', 'LLVM_COMPILER': 'clang', 'CONDA_PREFIX_1': '/root/anaconda3', 'PWD': '/orchestrator/crashrepair', 'HOME': '/root', 'CONDA_PYTHON_EXE': '/root/anaconda3/bin/python', '_CE_CONDA': '', 'CONDA_PROMPT_MODIFIER': '(CrashRepair) ', 'CXX': 'crepair-cxx', 'TERM': 'xterm', 'SHLVL': '2', 'PYTHONPATH': '/usr/lib/python3.8/site-packages:', 'PATH': '/root/anaconda3/envs/CrashRepair/bin:/root/anaconda3/condabin:~/anaconda3/bin:/opt/crashrepair/bin:/CrashRepair/compiler:/klee/build/bin:/opt/llvm-6/bin:/klee/build/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', 'CONDA_DEFAULT_ENV': 'CrashRepair', '_': '/root/anaconda3/envs/CrashRepair/bin/python'})
2025-02-03 22:05:22.617 | DEBUG    | scenario:rebuild:382 - injecting ghost function into CFLAGS during build: -lcrepair_ghost
2025-02-03 22:05:22.617 | DEBUG    | scenario:rebuild:398 - using environment: {'INJECT_CFLAGS': '-g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address', 'INJECT_CXXFLAGS': '-g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address', 'INJECT_LDFLAGS': '-g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address'}
2025-02-03 22:05:22.617 | DEBUG    | shell:__call__:41 - executing: make CFLAGS="${INJECT_CFLAGS}" CXXFLAGS="${INJECT_CXXFLAGS}" LDFLAGS="${INJECT_LDFLAGS}"
Making all in port
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/port'
make[1]: Nothing to be done for 'all'.
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/port'
Making all in libtiff
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/libtiff'
make  all-am
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/libtiff'
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/libtiff'
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/libtiff'
Making all in tools
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/tools'
crepair-cc -DHAVE_CONFIG_H -I. -I../libtiff  -I../libtiff   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -MT tiffcrop.o -MD -MP -MF .deps/tiffcrop.Tpo -c -o tiffcrop.o tiffcrop.c
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_ghost: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
mv -f .deps/tiffcrop.Tpo .deps/tiffcrop.Po
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address  -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -o tiffcrop tiffcrop.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -g -O0 -Wno-error -I/CrashRepair/lib -fsanitize=address -g -O0 -Wno-error -I/CrashRepair/lib -fsanitize=address -o tiffcrop tiffcrop.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a ../port/.libs/libport.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -llzma -ljbig -ljpeg -lz -lm
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/tools'
Making all in build
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/build'
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/build'
make[2]: Nothing to be done for 'all-am'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/build'
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/build'
Making all in contrib
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib'
Making all in addtiffo
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/addtiffo'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/addtiffo'
Making all in dbs
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/dbs'
Making all in xtiff
make[3]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/dbs/xtiff'
make[3]: Nothing to be done for 'all'.
make[3]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/dbs/xtiff'
make[3]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/dbs'
make[3]: Nothing to be done for 'all-am'.
make[3]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/dbs'
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/dbs'
Making all in iptcutil
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/iptcutil'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/iptcutil'
Making all in mfs
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/mfs'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/mfs'
Making all in pds
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/pds'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/pds'
Making all in ras
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/ras'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/ras'
Making all in stream
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/stream'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/stream'
Making all in tags
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/tags'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/tags'
Making all in win_dib
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/win_dib'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/win_dib'
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib'
make[2]: Nothing to be done for 'all-am'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib'
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib'
Making all in test
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/test'
make[1]: Nothing to be done for 'all'.
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/test'
Making all in man
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/man'
make[1]: Nothing to be done for 'all'.
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/man'
Making all in html
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html'
Making all in images
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html/images'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html/images'
Making all in man
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html/man'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html/man'
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html'
make[2]: Nothing to be done for 'all-am'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html'
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html'
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src'
make[1]: Nothing to be done for 'all-am'.
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src'
2025-02-03 22:05:23.101 | DEBUG    | scenario:evaluate:655 - testing candidate #8 against test #crash...
2025-02-03 22:05:23.101 | DEBUG    | shell:__call__:41 - executing: /data/vulnloc/libtiff/CVE-2016-5321/src/tools/tiffcrop /CrashRepair/experiments/vulnloc/libtiff/CVE-2016-5321/tests/1.tif foo.tif
2025-02-03 22:05:23.109 | DEBUG    | test:run:189 - test failed: unexpected exit code (actual: 139, expected: 0)
2025-02-03 22:05:23.109 | INFO     | scenario:evaluate:662 - candidate #8 fails test #crash
2025-02-03 22:05:23.114 | INFO     | scenario:evaluate:635 - evaluating candidate patch #9:
@@ -948,152 +948,154 @@
   return status;
   }
 
-static int  readSeparateTilesIntoBuffer (TIFF* in, uint8 *obuf, 
-					 uint32 imagelength, uint32 imagewidth, 
-                                         uint32 tw, uint32 tl,
-                                         uint16 spp, uint16 bps)
-  {
-  int     i, status = 1, sample;
-  int     shift_width, bytes_per_pixel;
-  uint16  bytes_per_sample;
-  uint32  row, col;     /* Current row and col of image */
-  uint32  nrow, ncol;   /* Number of rows and cols in current tile */
-  uint32  row_offset, col_offset; /* Output buffer offsets */
-  tsize_t tbytes = 0, tilesize = TIFFTileSize(in);
-  tsample_t s;
-  uint8*  bufp = (uint8*)obuf;
-  unsigned char *srcbuffs[MAX_SAMPLES];
-  unsigned char *tbuff = NULL;
 
-  bytes_per_sample = (bps + 7) / 8;
+static int readSeparateTilesIntoBuffer(TIFF* in, uint8 *obuf, 
+                                       uint32 imagelength, uint32 imagewidth, 
+                                       uint32 tw, uint32 tl,
+                                       uint16 spp, uint16 bps)
+{
+    int i, status = 1, sample;
+    int shift_width, bytes_per_pixel;
+    uint16 bytes_per_sample;
+    uint32 row, col;     /* Current row and col of image */
+    uint32 nrow, ncol;   /* Number of rows and cols in current tile */
+    uint32 row_offset, col_offset; /* Output buffer offsets */
+    tsize_t tbytes = 0, tilesize = TIFFTileSize(in);
+    tsample_t s;
+    uint8* bufp = (uint8*)obuf;
+    unsigned char *srcbuffs[MAX_SAMPLES];
+    unsigned char *tbuff = NULL;
 
-  for (sample = 0; (sample < spp) && (sample < MAX_SAMPLES); sample++)
-    {
-    srcbuffs[sample] = NULL;
-    tbuff = (unsigned char *)_TIFFmalloc(tilesize + 8);
-    if (!tbuff)
-      {
-      TIFFError ("readSeparateTilesIntoBuffer", 
-                 "Unable to allocate tile read buffer for sample %d", sample);
-      for (i = 0; i < sample; i++)
-        _TIFFfree (srcbuffs[i]);
-      return 0;
-      }
-    srcbuffs[sample] = tbuff;
-    } 
-  /* Each tile contains only the data for a single plane
-   * arranged in scanlines of tw * bytes_per_sample bytes.
-   */
-  for (row = 0; row < imagelength; row += tl)
-    {
-    nrow = (row + tl > imagelength) ? imagelength - row : tl;
-    for (col = 0; col < imagewidth; col += tw)
-      {
-      for (s = 0; s < spp; s++)
-        {  /* Read each plane of a tile set into srcbuffs[s] */
-	tbytes = TIFFReadTile(in, srcbuffs[s], col, row, 0, s);
-        if (tbytes < 0  && !ignore)
-          {
-	  TIFFError(TIFFFileName(in),
-                 "Error, can't read tile for row %lu col %lu, "
-		 "sample %lu",
-		 (unsigned long) col, (unsigned long) row,
-		 (unsigned long) s);
-		 status = 0;
-          for (sample = 0; (sample < spp) && (sample < MAX_SAMPLES); sample++)
-            {
-            tbuff = srcbuffs[sample];
-            if (tbuff != NULL)
-              _TIFFfree(tbuff);
-            }
-          return status;
-	  }
-	}
-     /* Tiles on the right edge may be padded out to tw 
-      * which must be a multiple of 16.
-      * Ncol represents the visible (non padding) portion.  
-      */
-      if (col + tw > imagewidth)
-        ncol = imagewidth - col;
-      else
-        ncol = tw;
-
-      row_offset = row * (((imagewidth * spp * bps) + 7) / 8);
-      col_offset = ((col * spp * bps) + 7) / 8;
-      bufp = obuf + row_offset + col_offset;
+    bytes_per_sample = (bps + 7) / 8;
 
-      if ((bps % 8) == 0)
+    for (sample = 0; (sample < spp) && (sample < MAX_SAMPLES); sample++)
+    {
+        srcbuffs[sample] = NULL;
+        tbuff = (unsigned char *)_TIFFmalloc(tilesize + 8);
+        if (!tbuff)
         {
-        if (combineSeparateTileSamplesBytes(srcbuffs, bufp, ncol, nrow, imagewidth,
-					    tw, spp, bps, NULL, 0, 0))
-	  {
-          status = 0;
-          break;
-      	  }
-	}
-      else
+            TIFFError("readSeparateTilesIntoBuffer", 
+                       "Unable to allocate tile read buffer for sample %d", sample);
+            for (i = 0; i < sample; i++)
+                _TIFFfree(srcbuffs[i]);
+            return 0;
+        }
+        srcbuffs[sample] = tbuff;
+    }
+    /* Each tile contains only the data for a single plane
+     * arranged in scanlines of tw * bytes_per_sample bytes.
+     */
+    for (row = 0; row < imagelength; row += tl)
+    {
+        nrow = (row + tl > imagelength) ? imagelength - row : tl;
+        for (col = 0; col < imagewidth; col += tw)
         {
-        bytes_per_pixel  = ((bps * spp) + 7) / 8;
-        if (bytes_per_pixel < (bytes_per_sample + 1))
-          shift_width = bytes_per_pixel;
-        else
-          shift_width = bytes_per_sample + 1;
-
-        switch (shift_width)
-          {
-          case 1: if (combineSeparateTileSamples8bits (srcbuffs, bufp, ncol, nrow,
-                                                       imagewidth, tw, spp, bps, 
-						       NULL, 0, 0))
-	            {
-                    status = 0;
-                    break;
-      	            }
-	          break;
-          case 2: if (combineSeparateTileSamples16bits (srcbuffs, bufp, ncol, nrow,
-                                                       imagewidth, tw, spp, bps, 
-						       NULL, 0, 0))
-	            {
-                    status = 0;
-                    break;
-		    }
-	          break;
-          case 3: if (combineSeparateTileSamples24bits (srcbuffs, bufp, ncol, nrow,
-                                                       imagewidth, tw, spp, bps, 
-						       NULL, 0, 0))
-	            {
+            for (s = 0; s < spp; s++)
+            {  
+                tbytes = TIFFReadTile(in, srcbuffs[s], col, row, 0, s);
+                if (tbytes == (tsize_t)-1 && !ignore)
+                {
+                    TIFFError(TIFFFileName(in),
+                               "Error, can't read tile for row %lu col %lu, "
+                               "sample %lu",
+                               (unsigned long)col, (unsigned long)row,
+                               (unsigned long)s);
                     status = 0;
-                    break;
-       	            }
-                  break;
-          case 4: 
-          case 5:
-          case 6:
-          case 7:
-          case 8: if (combineSeparateTileSamples32bits (srcbuffs, bufp, ncol, nrow,
-                                                       imagewidth, tw, spp, bps, 
-						       NULL, 0, 0))
-	            {
+                    for (sample = 0; (sample < spp) && (sample < MAX_SAMPLES); sample++)
+                    {
+                        tbuff = srcbuffs[sample];
+                        if (tbuff != NULL)
+                            _TIFFfree(tbuff);
+                    }
+                    return status;
+                }
+            }
+            /* Tiles on the right edge may be padded out to tw 
+             * which must be a multiple of 16.
+             * Ncol represents the visible (non padding) portion.  
+             */
+            if (col + tw > imagewidth)
+                ncol = imagewidth - col;
+            else
+                ncol = tw;
+
+            row_offset = row * (((imagewidth * spp * bps) + 7) / 8);
+            col_offset = ((col * spp * bps) + 7) / 8;
+            bufp = obuf + row_offset + col_offset;
+
+            if ((bps % 8) == 0)
+            {
+                if (combineSeparateTileSamplesBytes(srcbuffs, bufp, ncol, nrow, imagewidth,
+                                                    tw, spp, bps, NULL, 0, 0))
+                {
                     status = 0;
                     break;
-		    }
-	          break;
-          default: TIFFError ("readSeparateTilesIntoBuffer", "Unsupported bit depth: %d", bps);
-                  status = 0;
-                  break;
-          }
+                }
+            }
+            else
+            {
+                bytes_per_pixel = ((bps * spp) + 7) / 8;
+                if (bytes_per_pixel < (bytes_per_sample + 1))
+                    shift_width = bytes_per_pixel;
+                else
+                    shift_width = bytes_per_sample + 1;
+
+                switch (shift_width)
+                {
+                    case 1: if (combineSeparateTileSamples8bits (srcbuffs, bufp, ncol, nrow,
+                                                                 imagewidth, tw, spp, bps, 
+                                                                 NULL, 0, 0))
+                        {
+                            status = 0;
+                            break;
+                        }
+                        break;
+                    case 2: if (combineSeparateTileSamples16bits (srcbuffs, bufp, ncol, nrow,
+                                                                 imagewidth, tw, spp, bps, 
+                                                                 NULL, 0, 0))
+                        {
+                            status = 0;
+                            break;
+                        }
+                        break;
+                    case 3: if (combineSeparateTileSamples24bits (srcbuffs, bufp, ncol, nrow,
+                                                                 imagewidth, tw, spp, bps, 
+                                                                 NULL, 0, 0))
+                        {
+                            status = 0;
+                            break;
+                        }
+                        break;
+                    case 4: 
+                    case 5:
+                    case 6:
+                    case 7:
+                    case 8: if (combineSeparateTileSamples32bits (srcbuffs, bufp, ncol, nrow,
+                                                                 imagewidth, tw, spp, bps, 
+                                                                 NULL, 0, 0))
+                        {
+                            status = 0;
+                            break;
+                        }
+                        break;
+                    default: TIFFError("readSeparateTilesIntoBuffer", "Unsupported bit depth: %d", bps);
+                             status = 0;
+                             break;
+                }
+            }
         }
-      }
     }
 
-  for (sample = 0; (sample < spp) && (sample < MAX_SAMPLES); sample++)
+    for (sample = 0; (sample < spp) && (sample < MAX_SAMPLES); sample++)
     {
-    tbuff = srcbuffs[sample];
-    if (tbuff != NULL)
-      _TIFFfree(tbuff);
+        tbuff = srcbuffs[sample];
+        if (tbuff != NULL)
+            _TIFFfree(tbuff);
     }
- 
-  return status;
-  }
+
+    return status;
+}
+
 
 static int writeBufferToContigStrips(TIFF* out, uint8* buf, uint32 imagelength)
   {

2025-02-03 22:05:23.122 | DEBUG    | scenario:rebuild:369 - original environment: environ({'CONDA_SHLVL': '2', 'LC_ALL': 'C.UTF-8', 'LS_COLORS': 'rs=0:di=01;34:ln=01;36:mh=00:pi=40;33:so=01;35:do=01;35:bd=40;33;01:cd=40;33;01:or=40;31;01:mi=00:su=37;41:sg=30;43:ca=30;41:tw=30;42:ow=34;42:st=37;44:ex=01;32:*.tar=01;31:*.tgz=01;31:*.arc=01;31:*.arj=01;31:*.taz=01;31:*.lha=01;31:*.lz4=01;31:*.lzh=01;31:*.lzma=01;31:*.tlz=01;31:*.txz=01;31:*.tzo=01;31:*.t7z=01;31:*.zip=01;31:*.z=01;31:*.Z=01;31:*.dz=01;31:*.gz=01;31:*.lrz=01;31:*.lz=01;31:*.lzo=01;31:*.xz=01;31:*.zst=01;31:*.tzst=01;31:*.bz2=01;31:*.bz=01;31:*.tbz=01;31:*.tbz2=01;31:*.tz=01;31:*.deb=01;31:*.rpm=01;31:*.jar=01;31:*.war=01;31:*.ear=01;31:*.sar=01;31:*.rar=01;31:*.alz=01;31:*.ace=01;31:*.zoo=01;31:*.cpio=01;31:*.7z=01;31:*.rz=01;31:*.cab=01;31:*.wim=01;31:*.swm=01;31:*.dwm=01;31:*.esd=01;31:*.jpg=01;35:*.jpeg=01;35:*.mjpg=01;35:*.mjpeg=01;35:*.gif=01;35:*.bmp=01;35:*.pbm=01;35:*.pgm=01;35:*.ppm=01;35:*.tga=01;35:*.xbm=01;35:*.xpm=01;35:*.tif=01;35:*.tiff=01;35:*.png=01;35:*.svg=01;35:*.svgz=01;35:*.mng=01;35:*.pcx=01;35:*.mov=01;35:*.mpg=01;35:*.mpeg=01;35:*.m2v=01;35:*.mkv=01;35:*.webm=01;35:*.ogm=01;35:*.mp4=01;35:*.m4v=01;35:*.mp4v=01;35:*.vob=01;35:*.qt=01;35:*.nuv=01;35:*.wmv=01;35:*.asf=01;35:*.rm=01;35:*.rmvb=01;35:*.flc=01;35:*.avi=01;35:*.fli=01;35:*.flv=01;35:*.gl=01;35:*.dl=01;35:*.xcf=01;35:*.xwd=01;35:*.yuv=01;35:*.cgm=01;35:*.emf=01;35:*.ogv=01;35:*.ogx=01;35:*.aac=00;36:*.au=00;36:*.flac=00;36:*.m4a=00;36:*.mid=00;36:*.midi=00;36:*.mka=00;36:*.mp3=00;36:*.mpc=00;36:*.ogg=00;36:*.ra=00;36:*.wav=00;36:*.oga=00;36:*.opus=00;36:*.spx=00;36:*.xspf=00;36:', 'LD_LIBRARY_PATH': '/opt/crashrepair/lib:/CrashRepair/lib:/klee/build/lib:', 'CONDA_EXE': '/root/anaconda3/bin/conda', 'LANG': 'C.UTF-8', 'TZ': 'Asia/Shanghai', 'HOSTNAME': 'fea22102047d', 'OLDPWD': '/orchestrator', 'CONDA_PREFIX': '/root/anaconda3/envs/CrashRepair', '_CE_M': '', 'CC': 'crepair-cc', 'LLVM_COMPILER': 'clang', 'CONDA_PREFIX_1': '/root/anaconda3', 'PWD': '/orchestrator/crashrepair', 'HOME': '/root', 'CONDA_PYTHON_EXE': '/root/anaconda3/bin/python', '_CE_CONDA': '', 'CONDA_PROMPT_MODIFIER': '(CrashRepair) ', 'CXX': 'crepair-cxx', 'TERM': 'xterm', 'SHLVL': '2', 'PYTHONPATH': '/usr/lib/python3.8/site-packages:', 'PATH': '/root/anaconda3/envs/CrashRepair/bin:/root/anaconda3/condabin:~/anaconda3/bin:/opt/crashrepair/bin:/CrashRepair/compiler:/klee/build/bin:/opt/llvm-6/bin:/klee/build/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', 'CONDA_DEFAULT_ENV': 'CrashRepair', '_': '/root/anaconda3/envs/CrashRepair/bin/python'})
2025-02-03 22:05:23.122 | DEBUG    | scenario:rebuild:382 - injecting ghost function into CFLAGS during build: -lcrepair_ghost
2025-02-03 22:05:23.122 | DEBUG    | scenario:rebuild:398 - using environment: {'INJECT_CFLAGS': '-g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address', 'INJECT_CXXFLAGS': '-g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address', 'INJECT_LDFLAGS': '-g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address'}
2025-02-03 22:05:23.122 | DEBUG    | shell:__call__:41 - executing: make CFLAGS="${INJECT_CFLAGS}" CXXFLAGS="${INJECT_CXXFLAGS}" LDFLAGS="${INJECT_LDFLAGS}"
Making all in port
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/port'
make[1]: Nothing to be done for 'all'.
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/port'
Making all in libtiff
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/libtiff'
make  all-am
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/libtiff'
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/libtiff'
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/libtiff'
Making all in tools
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/tools'
crepair-cc -DHAVE_CONFIG_H -I. -I../libtiff  -I../libtiff   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -MT tiffcrop.o -MD -MP -MF .deps/tiffcrop.Tpo -c -o tiffcrop.o tiffcrop.c
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_ghost: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
mv -f .deps/tiffcrop.Tpo .deps/tiffcrop.Po
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address  -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -o tiffcrop tiffcrop.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -g -O0 -Wno-error -I/CrashRepair/lib -fsanitize=address -g -O0 -Wno-error -I/CrashRepair/lib -fsanitize=address -o tiffcrop tiffcrop.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a ../port/.libs/libport.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -llzma -ljbig -ljpeg -lz -lm
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/tools'
Making all in build
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/build'
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/build'
make[2]: Nothing to be done for 'all-am'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/build'
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/build'
Making all in contrib
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib'
Making all in addtiffo
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/addtiffo'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/addtiffo'
Making all in dbs
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/dbs'
Making all in xtiff
make[3]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/dbs/xtiff'
make[3]: Nothing to be done for 'all'.
make[3]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/dbs/xtiff'
make[3]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/dbs'
make[3]: Nothing to be done for 'all-am'.
make[3]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/dbs'
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/dbs'
Making all in iptcutil
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/iptcutil'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/iptcutil'
Making all in mfs
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/mfs'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/mfs'
Making all in pds
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/pds'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/pds'
Making all in ras
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/ras'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/ras'
Making all in stream
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/stream'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/stream'
Making all in tags
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/tags'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/tags'
Making all in win_dib
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/win_dib'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/win_dib'
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib'
make[2]: Nothing to be done for 'all-am'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib'
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib'
Making all in test
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/test'
make[1]: Nothing to be done for 'all'.
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/test'
Making all in man
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/man'
make[1]: Nothing to be done for 'all'.
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/man'
Making all in html
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html'
Making all in images
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html/images'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html/images'
Making all in man
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html/man'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html/man'
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html'
make[2]: Nothing to be done for 'all-am'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html'
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html'
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src'
make[1]: Nothing to be done for 'all-am'.
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src'
2025-02-03 22:05:23.600 | DEBUG    | scenario:evaluate:655 - testing candidate #9 against test #crash...
2025-02-03 22:05:23.600 | DEBUG    | shell:__call__:41 - executing: /data/vulnloc/libtiff/CVE-2016-5321/src/tools/tiffcrop /CrashRepair/experiments/vulnloc/libtiff/CVE-2016-5321/tests/1.tif foo.tif
2025-02-03 22:05:23.606 | DEBUG    | test:run:189 - test failed: unexpected exit code (actual: 139, expected: 0)
2025-02-03 22:05:23.607 | INFO     | scenario:evaluate:662 - candidate #9 fails test #crash
2025-02-03 22:05:23.612 | INFO     | scenario:evaluate:635 - evaluating candidate patch #10:
@@ -948,11 +948,12 @@
   return status;
   }
 
-static int  readSeparateTilesIntoBuffer (TIFF* in, uint8 *obuf, 
-					 uint32 imagelength, uint32 imagewidth, 
-                                         uint32 tw, uint32 tl,
-                                         uint16 spp, uint16 bps)
-  {
+
+static int readSeparateTilesIntoBuffer (TIFF* in, uint8 *obuf, 
+                                        uint32 imagelength, uint32 imagewidth, 
+                                        uint32 tw, uint32 tl,
+                                        uint16 spp, uint16 bps)
+{
   int     i, status = 1, sample;
   int     shift_width, bytes_per_pixel;
   uint16  bytes_per_sample;
@@ -968,51 +969,53 @@
   bytes_per_sample = (bps + 7) / 8;
 
   for (sample = 0; (sample < spp) && (sample < MAX_SAMPLES); sample++)
-    {
+  {
     srcbuffs[sample] = NULL;
     tbuff = (unsigned char *)_TIFFmalloc(tilesize + 8);
     if (!tbuff)
-      {
+    {
       TIFFError ("readSeparateTilesIntoBuffer", 
                  "Unable to allocate tile read buffer for sample %d", sample);
       for (i = 0; i < sample; i++)
         _TIFFfree (srcbuffs[i]);
       return 0;
-      }
+    }
     srcbuffs[sample] = tbuff;
-    } 
+  } 
   /* Each tile contains only the data for a single plane
    * arranged in scanlines of tw * bytes_per_sample bytes.
    */
   for (row = 0; row < imagelength; row += tl)
-    {
+  {
     nrow = (row + tl > imagelength) ? imagelength - row : tl;
     for (col = 0; col < imagewidth; col += tw)
-      {
+    {
       for (s = 0; s < spp; s++)
-        {  /* Read each plane of a tile set into srcbuffs[s] */
-	tbytes = TIFFReadTile(in, srcbuffs[s], col, row, 0, s);
-        if (tbytes < 0  && !ignore)
-          {
-	  TIFFError(TIFFFileName(in),
-                 "Error, can't read tile for row %lu col %lu, "
-		 "sample %lu",
-		 (unsigned long) col, (unsigned long) row,
-		 (unsigned long) s);
-		 status = 0;
+      {  /* Read each plane of a tile set into srcbuffs[s] */
+        tbytes = TIFFReadTile(in, srcbuffs[s], col, row, 0, s);
+        if (tbytes < 0)
+        {
+          if (!ignore) {
+            TIFFError(TIFFFileName(in),
+                       "Error, can't read tile for row %lu col %lu, "
+                       "sample %lu",
+                       (unsigned long) col, (unsigned long) row,
+                       (unsigned long) s);
+            status = 0;
+          }
           for (sample = 0; (sample < spp) && (sample < MAX_SAMPLES); sample++)
-            {
+          {
             tbuff = srcbuffs[sample];
             if (tbuff != NULL)
               _TIFFfree(tbuff);
-            }
+          }
           return status;
-	  }
-	}
-     /* Tiles on the right edge may be padded out to tw 
-      * which must be a multiple of 16.
-      * Ncol represents the visible (non padding) portion.  
-      */
+        }
+      }
+      /* Tiles on the right edge may be padded out to tw 
+       * which must be a multiple of 16.
+       * Ncol represents the visible (non padding) portion.  
+       */
       if (col + tw > imagewidth)
         ncol = imagewidth - col;
       else
@@ -1023,16 +1026,16 @@
       bufp = obuf + row_offset + col_offset;
 
       if ((bps % 8) == 0)
-        {
+      {
         if (combineSeparateTileSamplesBytes(srcbuffs, bufp, ncol, nrow, imagewidth,
-					    tw, spp, bps, NULL, 0, 0))
-	  {
+                                             tw, spp, bps, NULL, 0, 0))
+        {
           status = 0;
           break;
-      	  }
-	}
+        }
+      }
       else
-        {
+      {
         bytes_per_pixel  = ((bps * spp) + 7) / 8;
         if (bytes_per_pixel < (bytes_per_sample + 1))
           shift_width = bytes_per_pixel;
@@ -1040,61 +1043,62 @@
           shift_width = bytes_per_sample + 1;
 
         switch (shift_width)
-          {
+        {
           case 1: if (combineSeparateTileSamples8bits (srcbuffs, bufp, ncol, nrow,
                                                        imagewidth, tw, spp, bps, 
-						       NULL, 0, 0))
-	            {
-                    status = 0;
-                    break;
-      	            }
-	          break;
+                                                       NULL, 0, 0))
+            {
+              status = 0;
+              break;
+            }
+            break;
           case 2: if (combineSeparateTileSamples16bits (srcbuffs, bufp, ncol, nrow,
                                                        imagewidth, tw, spp, bps, 
-						       NULL, 0, 0))
-	            {
-                    status = 0;
-                    break;
-		    }
-	          break;
+                                                       NULL, 0, 0))
+            {
+              status = 0;
+              break;
+            }
+            break;
           case 3: if (combineSeparateTileSamples24bits (srcbuffs, bufp, ncol, nrow,
                                                        imagewidth, tw, spp, bps, 
-						       NULL, 0, 0))
-	            {
-                    status = 0;
-                    break;
-       	            }
-                  break;
+                                                       NULL, 0, 0))
+            {
+              status = 0;
+              break;
+            }
+            break;
           case 4: 
           case 5:
           case 6:
           case 7:
           case 8: if (combineSeparateTileSamples32bits (srcbuffs, bufp, ncol, nrow,
                                                        imagewidth, tw, spp, bps, 
-						       NULL, 0, 0))
-	            {
-                    status = 0;
-                    break;
-		    }
-	          break;
+                                                       NULL, 0, 0))
+            {
+              status = 0;
+              break;
+            }
+            break;
           default: TIFFError ("readSeparateTilesIntoBuffer", "Unsupported bit depth: %d", bps);
                   status = 0;
                   break;
-          }
         }
       }
     }
+  }
 
   for (sample = 0; (sample < spp) && (sample < MAX_SAMPLES); sample++)
-    {
+  {
     tbuff = srcbuffs[sample];
     if (tbuff != NULL)
       _TIFFfree(tbuff);
-    }
- 
-  return status;
   }
 
+  return status;
+}
+
+
 static int writeBufferToContigStrips(TIFF* out, uint8* buf, uint32 imagelength)
   {
   uint32 row, nrows, rowsperstrip;

2025-02-03 22:05:23.617 | DEBUG    | scenario:rebuild:369 - original environment: environ({'CONDA_SHLVL': '2', 'LC_ALL': 'C.UTF-8', 'LS_COLORS': 'rs=0:di=01;34:ln=01;36:mh=00:pi=40;33:so=01;35:do=01;35:bd=40;33;01:cd=40;33;01:or=40;31;01:mi=00:su=37;41:sg=30;43:ca=30;41:tw=30;42:ow=34;42:st=37;44:ex=01;32:*.tar=01;31:*.tgz=01;31:*.arc=01;31:*.arj=01;31:*.taz=01;31:*.lha=01;31:*.lz4=01;31:*.lzh=01;31:*.lzma=01;31:*.tlz=01;31:*.txz=01;31:*.tzo=01;31:*.t7z=01;31:*.zip=01;31:*.z=01;31:*.Z=01;31:*.dz=01;31:*.gz=01;31:*.lrz=01;31:*.lz=01;31:*.lzo=01;31:*.xz=01;31:*.zst=01;31:*.tzst=01;31:*.bz2=01;31:*.bz=01;31:*.tbz=01;31:*.tbz2=01;31:*.tz=01;31:*.deb=01;31:*.rpm=01;31:*.jar=01;31:*.war=01;31:*.ear=01;31:*.sar=01;31:*.rar=01;31:*.alz=01;31:*.ace=01;31:*.zoo=01;31:*.cpio=01;31:*.7z=01;31:*.rz=01;31:*.cab=01;31:*.wim=01;31:*.swm=01;31:*.dwm=01;31:*.esd=01;31:*.jpg=01;35:*.jpeg=01;35:*.mjpg=01;35:*.mjpeg=01;35:*.gif=01;35:*.bmp=01;35:*.pbm=01;35:*.pgm=01;35:*.ppm=01;35:*.tga=01;35:*.xbm=01;35:*.xpm=01;35:*.tif=01;35:*.tiff=01;35:*.png=01;35:*.svg=01;35:*.svgz=01;35:*.mng=01;35:*.pcx=01;35:*.mov=01;35:*.mpg=01;35:*.mpeg=01;35:*.m2v=01;35:*.mkv=01;35:*.webm=01;35:*.ogm=01;35:*.mp4=01;35:*.m4v=01;35:*.mp4v=01;35:*.vob=01;35:*.qt=01;35:*.nuv=01;35:*.wmv=01;35:*.asf=01;35:*.rm=01;35:*.rmvb=01;35:*.flc=01;35:*.avi=01;35:*.fli=01;35:*.flv=01;35:*.gl=01;35:*.dl=01;35:*.xcf=01;35:*.xwd=01;35:*.yuv=01;35:*.cgm=01;35:*.emf=01;35:*.ogv=01;35:*.ogx=01;35:*.aac=00;36:*.au=00;36:*.flac=00;36:*.m4a=00;36:*.mid=00;36:*.midi=00;36:*.mka=00;36:*.mp3=00;36:*.mpc=00;36:*.ogg=00;36:*.ra=00;36:*.wav=00;36:*.oga=00;36:*.opus=00;36:*.spx=00;36:*.xspf=00;36:', 'LD_LIBRARY_PATH': '/opt/crashrepair/lib:/CrashRepair/lib:/klee/build/lib:', 'CONDA_EXE': '/root/anaconda3/bin/conda', 'LANG': 'C.UTF-8', 'TZ': 'Asia/Shanghai', 'HOSTNAME': 'fea22102047d', 'OLDPWD': '/orchestrator', 'CONDA_PREFIX': '/root/anaconda3/envs/CrashRepair', '_CE_M': '', 'CC': 'crepair-cc', 'LLVM_COMPILER': 'clang', 'CONDA_PREFIX_1': '/root/anaconda3', 'PWD': '/orchestrator/crashrepair', 'HOME': '/root', 'CONDA_PYTHON_EXE': '/root/anaconda3/bin/python', '_CE_CONDA': '', 'CONDA_PROMPT_MODIFIER': '(CrashRepair) ', 'CXX': 'crepair-cxx', 'TERM': 'xterm', 'SHLVL': '2', 'PYTHONPATH': '/usr/lib/python3.8/site-packages:', 'PATH': '/root/anaconda3/envs/CrashRepair/bin:/root/anaconda3/condabin:~/anaconda3/bin:/opt/crashrepair/bin:/CrashRepair/compiler:/klee/build/bin:/opt/llvm-6/bin:/klee/build/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', 'CONDA_DEFAULT_ENV': 'CrashRepair', '_': '/root/anaconda3/envs/CrashRepair/bin/python'})
2025-02-03 22:05:23.617 | DEBUG    | scenario:rebuild:382 - injecting ghost function into CFLAGS during build: -lcrepair_ghost
2025-02-03 22:05:23.617 | DEBUG    | scenario:rebuild:398 - using environment: {'INJECT_CFLAGS': '-g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address', 'INJECT_CXXFLAGS': '-g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address', 'INJECT_LDFLAGS': '-g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address'}
2025-02-03 22:05:23.617 | DEBUG    | shell:__call__:41 - executing: make CFLAGS="${INJECT_CFLAGS}" CXXFLAGS="${INJECT_CXXFLAGS}" LDFLAGS="${INJECT_LDFLAGS}"
Making all in port
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/port'
make[1]: Nothing to be done for 'all'.
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/port'
Making all in libtiff
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/libtiff'
make  all-am
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/libtiff'
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/libtiff'
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/libtiff'
Making all in tools
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/tools'
crepair-cc -DHAVE_CONFIG_H -I. -I../libtiff  -I../libtiff   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -MT tiffcrop.o -MD -MP -MF .deps/tiffcrop.Tpo -c -o tiffcrop.o tiffcrop.c
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_ghost: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
mv -f .deps/tiffcrop.Tpo .deps/tiffcrop.Po
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address  -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -o tiffcrop tiffcrop.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -g -O0 -Wno-error -I/CrashRepair/lib -fsanitize=address -g -O0 -Wno-error -I/CrashRepair/lib -fsanitize=address -o tiffcrop tiffcrop.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a ../port/.libs/libport.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -llzma -ljbig -ljpeg -lz -lm
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/tools'
Making all in build
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/build'
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/build'
make[2]: Nothing to be done for 'all-am'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/build'
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/build'
Making all in contrib
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib'
Making all in addtiffo
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/addtiffo'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/addtiffo'
Making all in dbs
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/dbs'
Making all in xtiff
make[3]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/dbs/xtiff'
make[3]: Nothing to be done for 'all'.
make[3]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/dbs/xtiff'
make[3]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/dbs'
make[3]: Nothing to be done for 'all-am'.
make[3]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/dbs'
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/dbs'
Making all in iptcutil
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/iptcutil'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/iptcutil'
Making all in mfs
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/mfs'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/mfs'
Making all in pds
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/pds'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/pds'
Making all in ras
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/ras'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/ras'
Making all in stream
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/stream'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/stream'
Making all in tags
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/tags'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/tags'
Making all in win_dib
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/win_dib'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/win_dib'
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib'
make[2]: Nothing to be done for 'all-am'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib'
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib'
Making all in test
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/test'
make[1]: Nothing to be done for 'all'.
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/test'
Making all in man
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/man'
make[1]: Nothing to be done for 'all'.
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/man'
Making all in html
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html'
Making all in images
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html/images'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html/images'
Making all in man
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html/man'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html/man'
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html'
make[2]: Nothing to be done for 'all-am'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html'
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html'
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src'
make[1]: Nothing to be done for 'all-am'.
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src'
2025-02-03 22:05:24.090 | DEBUG    | scenario:evaluate:655 - testing candidate #10 against test #crash...
2025-02-03 22:05:24.090 | DEBUG    | shell:__call__:41 - executing: /data/vulnloc/libtiff/CVE-2016-5321/src/tools/tiffcrop /CrashRepair/experiments/vulnloc/libtiff/CVE-2016-5321/tests/1.tif foo.tif
2025-02-03 22:05:24.102 | DEBUG    | test:run:189 - test failed: unexpected exit code (actual: 139, expected: 0)
2025-02-03 22:05:24.102 | INFO     | scenario:evaluate:662 - candidate #10 fails test #crash
2025-02-03 22:05:24.115 | INFO     | scenario:evaluate:635 - evaluating candidate patch #11:
@@ -948,152 +948,161 @@
   return status;
   }
 
-static int  readSeparateTilesIntoBuffer (TIFF* in, uint8 *obuf, 
-					 uint32 imagelength, uint32 imagewidth, 
-                                         uint32 tw, uint32 tl,
-                                         uint16 spp, uint16 bps)
-  {
-  int     i, status = 1, sample;
-  int     shift_width, bytes_per_pixel;
-  uint16  bytes_per_sample;
-  uint32  row, col;     /* Current row and col of image */
-  uint32  nrow, ncol;   /* Number of rows and cols in current tile */
-  uint32  row_offset, col_offset; /* Output buffer offsets */
-  tsize_t tbytes = 0, tilesize = TIFFTileSize(in);
-  tsample_t s;
-  uint8*  bufp = (uint8*)obuf;
-  unsigned char *srcbuffs[MAX_SAMPLES];
-  unsigned char *tbuff = NULL;
 
-  bytes_per_sample = (bps + 7) / 8;
+static int readSeparateTilesIntoBuffer(TIFF* in, uint8 *obuf, 
+                                        uint32 imagelength, uint32 imagewidth, 
+                                        uint32 tw, uint32 tl,
+                                        uint16 spp, uint16 bps)
+{
+    int i, status = 1, sample;
+    int shift_width, bytes_per_pixel;
+    uint16 bytes_per_sample;
+    uint32 row, col;     /* Current row and col of image */
+    uint32 nrow, ncol;   /* Number of rows and cols in current tile */
+    uint32 row_offset, col_offset; /* Output buffer offsets */
+    tsize_t tbytes = 0, tilesize = TIFFTileSize(in);
+    tsample_t s;
+    uint8* bufp = (uint8*)obuf;
+    unsigned char *srcbuffs[MAX_SAMPLES];
+    unsigned char *tbuff = NULL;
+
+    bytes_per_sample = (bps + 7) / 8;
 
-  for (sample = 0; (sample < spp) && (sample < MAX_SAMPLES); sample++)
+    for (sample = 0; (sample < spp) && (sample < MAX_SAMPLES); sample++)
     {
-    srcbuffs[sample] = NULL;
-    tbuff = (unsigned char *)_TIFFmalloc(tilesize + 8);
-    if (!tbuff)
-      {
-      TIFFError ("readSeparateTilesIntoBuffer", 
-                 "Unable to allocate tile read buffer for sample %d", sample);
-      for (i = 0; i < sample; i++)
-        _TIFFfree (srcbuffs[i]);
-      return 0;
-      }
-    srcbuffs[sample] = tbuff;
+        srcbuffs[sample] = NULL;
+        tbuff = (unsigned char *)_TIFFmalloc(tilesize + 8);
+        if (!tbuff)
+        {
+            TIFFError ("readSeparateTilesIntoBuffer", 
+                        "Unable to allocate tile read buffer for sample %d", sample);
+            for (i = 0; i < sample; i++)
+                _TIFFfree(srcbuffs[i]);
+            return 0;
+        }
+        srcbuffs[sample] = tbuff;
     } 
-  /* Each tile contains only the data for a single plane
-   * arranged in scanlines of tw * bytes_per_sample bytes.
-   */
-  for (row = 0; row < imagelength; row += tl)
+    /* Each tile contains only the data for a single plane
+       arranged in scanlines of tw * bytes_per_sample bytes.
+    */
+    for (row = 0; row < imagelength; row += tl)
     {
-    nrow = (row + tl > imagelength) ? imagelength - row : tl;
-    for (col = 0; col < imagewidth; col += tw)
-      {
-      for (s = 0; s < spp; s++)
-        {  /* Read each plane of a tile set into srcbuffs[s] */
-	tbytes = TIFFReadTile(in, srcbuffs[s], col, row, 0, s);
-        if (tbytes < 0  && !ignore)
-          {
-	  TIFFError(TIFFFileName(in),
-                 "Error, can't read tile for row %lu col %lu, "
-		 "sample %lu",
-		 (unsigned long) col, (unsigned long) row,
-		 (unsigned long) s);
-		 status = 0;
-          for (sample = 0; (sample < spp) && (sample < MAX_SAMPLES); sample++)
-            {
-            tbuff = srcbuffs[sample];
-            if (tbuff != NULL)
-              _TIFFfree(tbuff);
+        nrow = (row + tl > imagelength) ? imagelength - row : tl;
+        for (col = 0; col < imagewidth; col += tw)
+        {
+            for (s = 0; s < spp; s++)
+            {  /* Read each plane of a tile set into srcbuffs[s] */
+                tbytes = TIFFReadTile(in, srcbuffs[s], col, row, 0, s);
+                if (tbytes < 0)
+                {
+                    if (!ignore)
+                    {
+                        TIFFError(TIFFFileName(in),
+                                  "Error, can't read tile for row %lu col %lu, "
+                                  "sample %lu",
+                                  (unsigned long) col, (unsigned long) row,
+                                  (unsigned long) s);
+                        status = 0;
+                    }
+                    else
+                    {
+                        // Handle the scenario where reading a tile is ignored
+                        // An update to handle `ignore` variable appropriately
+                        continue; // Skip further processing for this tile/sample
+                    }
+                }
             }
-          return status;
-	  }
-	}
-     /* Tiles on the right edge may be padded out to tw 
-      * which must be a multiple of 16.
-      * Ncol represents the visible (non padding) portion.  
-      */
-      if (col + tw > imagewidth)
-        ncol = imagewidth - col;
-      else
-        ncol = tw;
-
-      row_offset = row * (((imagewidth * spp * bps) + 7) / 8);
-      col_offset = ((col * spp * bps) + 7) / 8;
-      bufp = obuf + row_offset + col_offset;
+            /* Tiles on the right edge may be padded out to tw 
+               which must be a multiple of 16.
+               Ncol represents the visible (non padding) portion.  
+            */
+            if (col + tw > imagewidth)
+                ncol = imagewidth - col;
+            else
+                ncol = tw;
+
+            row_offset = row * (((imagewidth * spp * bps) + 7) / 8);
+            col_offset = ((col * spp * bps) + 7) / 8;
+            bufp = obuf + row_offset + col_offset;
 
-      if ((bps % 8) == 0)
-        {
-        if (combineSeparateTileSamplesBytes(srcbuffs, bufp, ncol, nrow, imagewidth,
-					    tw, spp, bps, NULL, 0, 0))
-	  {
-          status = 0;
-          break;
-      	  }
-	}
-      else
-        {
-        bytes_per_pixel  = ((bps * spp) + 7) / 8;
-        if (bytes_per_pixel < (bytes_per_sample + 1))
-          shift_width = bytes_per_pixel;
-        else
-          shift_width = bytes_per_sample + 1;
-
-        switch (shift_width)
-          {
-          case 1: if (combineSeparateTileSamples8bits (srcbuffs, bufp, ncol, nrow,
-                                                       imagewidth, tw, spp, bps, 
-						       NULL, 0, 0))
-	            {
-                    status = 0;
-                    break;
-      	            }
-	          break;
-          case 2: if (combineSeparateTileSamples16bits (srcbuffs, bufp, ncol, nrow,
-                                                       imagewidth, tw, spp, bps, 
-						       NULL, 0, 0))
-	            {
-                    status = 0;
-                    break;
-		    }
-	          break;
-          case 3: if (combineSeparateTileSamples24bits (srcbuffs, bufp, ncol, nrow,
-                                                       imagewidth, tw, spp, bps, 
-						       NULL, 0, 0))
-	            {
-                    status = 0;
-                    break;
-       	            }
-                  break;
-          case 4: 
-          case 5:
-          case 6:
-          case 7:
-          case 8: if (combineSeparateTileSamples32bits (srcbuffs, bufp, ncol, nrow,
-                                                       imagewidth, tw, spp, bps, 
-						       NULL, 0, 0))
-	            {
+            if ((bps % 8) == 0)
+            {
+                if (combineSeparateTileSamplesBytes(srcbuffs, bufp, ncol, nrow, imagewidth,
+                                                    tw, spp, bps, NULL, 0, 0))
+                {
                     status = 0;
                     break;
-		    }
-	          break;
-          default: TIFFError ("readSeparateTilesIntoBuffer", "Unsupported bit depth: %d", bps);
-                  status = 0;
-                  break;
-          }
+                }
+            }
+            else
+            {
+                bytes_per_pixel  = ((bps * spp) + 7) / 8;
+                if (bytes_per_pixel < (bytes_per_sample + 1))
+                    shift_width = bytes_per_pixel;
+                else
+                    shift_width = bytes_per_sample + 1;
+
+                switch (shift_width)
+                {
+                    case 1: 
+                        if (combineSeparateTileSamples8bits(srcbuffs, bufp, ncol, nrow,
+                                                            imagewidth, tw, spp, bps, 
+                                                            NULL, 0, 0))
+                        {
+                            status = 0;
+                            break;
+                        }
+                        break;
+                    case 2: 
+                        if (combineSeparateTileSamples16bits(srcbuffs, bufp, ncol, nrow,
+                                                            imagewidth, tw, spp, bps, 
+                                                            NULL, 0, 0))
+                        {
+                            status = 0;
+                            break;
+                        }
+                        break;
+                    case 3: 
+                        if (combineSeparateTileSamples24bits(srcbuffs, bufp, ncol, nrow,
+                                                            imagewidth, tw, spp, bps, 
+                                                            NULL, 0, 0))
+                        {
+                            status = 0;
+                            break;
+                        }
+                        break;
+                    case 4: 
+                    case 5:
+                    case 6:
+                    case 7:
+                    case 8: 
+                        if (combineSeparateTileSamples32bits(srcbuffs, bufp, ncol, nrow,
+                                                            imagewidth, tw, spp, bps, 
+                                                            NULL, 0, 0))
+                        {
+                            status = 0;
+                            break;
+                        }
+                        break;
+                    default:
+                        TIFFError("readSeparateTilesIntoBuffer", "Unsupported bit depth: %d", bps);
+                        status = 0;
+                        break;
+                }
+            }
         }
-      }
     }
 
-  for (sample = 0; (sample < spp) && (sample < MAX_SAMPLES); sample++)
+    for (sample = 0; (sample < spp) && (sample < MAX_SAMPLES); sample++)
     {
-    tbuff = srcbuffs[sample];
-    if (tbuff != NULL)
-      _TIFFfree(tbuff);
+        tbuff = srcbuffs[sample];
+        if (tbuff != NULL)
+            _TIFFfree(tbuff);
     }
- 
-  return status;
-  }
+
+    return status;
+}
+
 
 static int writeBufferToContigStrips(TIFF* out, uint8* buf, uint32 imagelength)
   {

2025-02-03 22:05:24.129 | DEBUG    | scenario:rebuild:369 - original environment: environ({'CONDA_SHLVL': '2', 'LC_ALL': 'C.UTF-8', 'LS_COLORS': 'rs=0:di=01;34:ln=01;36:mh=00:pi=40;33:so=01;35:do=01;35:bd=40;33;01:cd=40;33;01:or=40;31;01:mi=00:su=37;41:sg=30;43:ca=30;41:tw=30;42:ow=34;42:st=37;44:ex=01;32:*.tar=01;31:*.tgz=01;31:*.arc=01;31:*.arj=01;31:*.taz=01;31:*.lha=01;31:*.lz4=01;31:*.lzh=01;31:*.lzma=01;31:*.tlz=01;31:*.txz=01;31:*.tzo=01;31:*.t7z=01;31:*.zip=01;31:*.z=01;31:*.Z=01;31:*.dz=01;31:*.gz=01;31:*.lrz=01;31:*.lz=01;31:*.lzo=01;31:*.xz=01;31:*.zst=01;31:*.tzst=01;31:*.bz2=01;31:*.bz=01;31:*.tbz=01;31:*.tbz2=01;31:*.tz=01;31:*.deb=01;31:*.rpm=01;31:*.jar=01;31:*.war=01;31:*.ear=01;31:*.sar=01;31:*.rar=01;31:*.alz=01;31:*.ace=01;31:*.zoo=01;31:*.cpio=01;31:*.7z=01;31:*.rz=01;31:*.cab=01;31:*.wim=01;31:*.swm=01;31:*.dwm=01;31:*.esd=01;31:*.jpg=01;35:*.jpeg=01;35:*.mjpg=01;35:*.mjpeg=01;35:*.gif=01;35:*.bmp=01;35:*.pbm=01;35:*.pgm=01;35:*.ppm=01;35:*.tga=01;35:*.xbm=01;35:*.xpm=01;35:*.tif=01;35:*.tiff=01;35:*.png=01;35:*.svg=01;35:*.svgz=01;35:*.mng=01;35:*.pcx=01;35:*.mov=01;35:*.mpg=01;35:*.mpeg=01;35:*.m2v=01;35:*.mkv=01;35:*.webm=01;35:*.ogm=01;35:*.mp4=01;35:*.m4v=01;35:*.mp4v=01;35:*.vob=01;35:*.qt=01;35:*.nuv=01;35:*.wmv=01;35:*.asf=01;35:*.rm=01;35:*.rmvb=01;35:*.flc=01;35:*.avi=01;35:*.fli=01;35:*.flv=01;35:*.gl=01;35:*.dl=01;35:*.xcf=01;35:*.xwd=01;35:*.yuv=01;35:*.cgm=01;35:*.emf=01;35:*.ogv=01;35:*.ogx=01;35:*.aac=00;36:*.au=00;36:*.flac=00;36:*.m4a=00;36:*.mid=00;36:*.midi=00;36:*.mka=00;36:*.mp3=00;36:*.mpc=00;36:*.ogg=00;36:*.ra=00;36:*.wav=00;36:*.oga=00;36:*.opus=00;36:*.spx=00;36:*.xspf=00;36:', 'LD_LIBRARY_PATH': '/opt/crashrepair/lib:/CrashRepair/lib:/klee/build/lib:', 'CONDA_EXE': '/root/anaconda3/bin/conda', 'LANG': 'C.UTF-8', 'TZ': 'Asia/Shanghai', 'HOSTNAME': 'fea22102047d', 'OLDPWD': '/orchestrator', 'CONDA_PREFIX': '/root/anaconda3/envs/CrashRepair', '_CE_M': '', 'CC': 'crepair-cc', 'LLVM_COMPILER': 'clang', 'CONDA_PREFIX_1': '/root/anaconda3', 'PWD': '/orchestrator/crashrepair', 'HOME': '/root', 'CONDA_PYTHON_EXE': '/root/anaconda3/bin/python', '_CE_CONDA': '', 'CONDA_PROMPT_MODIFIER': '(CrashRepair) ', 'CXX': 'crepair-cxx', 'TERM': 'xterm', 'SHLVL': '2', 'PYTHONPATH': '/usr/lib/python3.8/site-packages:', 'PATH': '/root/anaconda3/envs/CrashRepair/bin:/root/anaconda3/condabin:~/anaconda3/bin:/opt/crashrepair/bin:/CrashRepair/compiler:/klee/build/bin:/opt/llvm-6/bin:/klee/build/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', 'CONDA_DEFAULT_ENV': 'CrashRepair', '_': '/root/anaconda3/envs/CrashRepair/bin/python'})
2025-02-03 22:05:24.129 | DEBUG    | scenario:rebuild:382 - injecting ghost function into CFLAGS during build: -lcrepair_ghost
2025-02-03 22:05:24.129 | DEBUG    | scenario:rebuild:398 - using environment: {'INJECT_CFLAGS': '-g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address', 'INJECT_CXXFLAGS': '-g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address', 'INJECT_LDFLAGS': '-g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address'}
2025-02-03 22:05:24.129 | DEBUG    | shell:__call__:41 - executing: make CFLAGS="${INJECT_CFLAGS}" CXXFLAGS="${INJECT_CXXFLAGS}" LDFLAGS="${INJECT_LDFLAGS}"
Making all in port
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/port'
make[1]: Nothing to be done for 'all'.
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/port'
Making all in libtiff
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/libtiff'
make  all-am
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/libtiff'
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/libtiff'
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/libtiff'
Making all in tools
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/tools'
crepair-cc -DHAVE_CONFIG_H -I. -I../libtiff  -I../libtiff   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -MT tiffcrop.o -MD -MP -MF .deps/tiffcrop.Tpo -c -o tiffcrop.o tiffcrop.c
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_ghost: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
mv -f .deps/tiffcrop.Tpo .deps/tiffcrop.Po
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address  -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -o tiffcrop tiffcrop.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -g -O0 -Wno-error -I/CrashRepair/lib -fsanitize=address -g -O0 -Wno-error -I/CrashRepair/lib -fsanitize=address -o tiffcrop tiffcrop.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a ../port/.libs/libport.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -llzma -ljbig -ljpeg -lz -lm
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/tools'
Making all in build
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/build'
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/build'
make[2]: Nothing to be done for 'all-am'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/build'
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/build'
Making all in contrib
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib'
Making all in addtiffo
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/addtiffo'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/addtiffo'
Making all in dbs
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/dbs'
Making all in xtiff
make[3]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/dbs/xtiff'
make[3]: Nothing to be done for 'all'.
make[3]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/dbs/xtiff'
make[3]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/dbs'
make[3]: Nothing to be done for 'all-am'.
make[3]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/dbs'
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/dbs'
Making all in iptcutil
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/iptcutil'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/iptcutil'
Making all in mfs
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/mfs'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/mfs'
Making all in pds
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/pds'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/pds'
Making all in ras
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/ras'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/ras'
Making all in stream
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/stream'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/stream'
Making all in tags
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/tags'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/tags'
Making all in win_dib
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/win_dib'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/win_dib'
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib'
make[2]: Nothing to be done for 'all-am'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib'
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib'
Making all in test
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/test'
make[1]: Nothing to be done for 'all'.
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/test'
Making all in man
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/man'
make[1]: Nothing to be done for 'all'.
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/man'
Making all in html
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html'
Making all in images
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html/images'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html/images'
Making all in man
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html/man'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html/man'
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html'
make[2]: Nothing to be done for 'all-am'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html'
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html'
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src'
make[1]: Nothing to be done for 'all-am'.
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src'
2025-02-03 22:05:24.618 | DEBUG    | scenario:evaluate:655 - testing candidate #11 against test #crash...
2025-02-03 22:05:24.618 | DEBUG    | shell:__call__:41 - executing: /data/vulnloc/libtiff/CVE-2016-5321/src/tools/tiffcrop /CrashRepair/experiments/vulnloc/libtiff/CVE-2016-5321/tests/1.tif foo.tif
2025-02-03 22:05:24.624 | DEBUG    | test:run:189 - test failed: unexpected exit code (actual: 139, expected: 0)
2025-02-03 22:05:24.624 | INFO     | scenario:evaluate:662 - candidate #11 fails test #crash
2025-02-03 22:05:24.630 | INFO     | scenario:evaluate:635 - evaluating candidate patch #12:
@@ -948,152 +948,150 @@
   return status;
   }
 
-static int  readSeparateTilesIntoBuffer (TIFF* in, uint8 *obuf, 
-					 uint32 imagelength, uint32 imagewidth, 
-                                         uint32 tw, uint32 tl,
-                                         uint16 spp, uint16 bps)
-  {
-  int     i, status = 1, sample;
-  int     shift_width, bytes_per_pixel;
-  uint16  bytes_per_sample;
-  uint32  row, col;     /* Current row and col of image */
-  uint32  nrow, ncol;   /* Number of rows and cols in current tile */
-  uint32  row_offset, col_offset; /* Output buffer offsets */
-  tsize_t tbytes = 0, tilesize = TIFFTileSize(in);
-  tsample_t s;
-  uint8*  bufp = (uint8*)obuf;
-  unsigned char *srcbuffs[MAX_SAMPLES];
-  unsigned char *tbuff = NULL;
 
-  bytes_per_sample = (bps + 7) / 8;
+static int readSeparateTilesIntoBuffer(TIFF* in, uint8 *obuf,
+                                       uint32 imagelength, uint32 imagewidth,
+                                       uint32 tw, uint32 tl,
+                                       uint16 spp, uint16 bps)
+{
+    int i, status = 1, sample;
+    int shift_width, bytes_per_pixel;
+    uint16 bytes_per_sample;
+    uint32 row, col; /* Current row and col of image */
+    uint32 nrow, ncol; /* Number of rows and cols in current tile */
+    uint32 row_offset, col_offset; /* Output buffer offsets */
+    tsize_t tbytes = 0, tilesize = TIFFTileSize(in);
+    tsample_t s;
+    uint8* bufp = (uint8*)obuf;
+    unsigned char *srcbuffs[MAX_SAMPLES];
+    unsigned char *tbuff = NULL;
+
+    bytes_per_sample = (bps + 7) / 8;
 
-  for (sample = 0; (sample < spp) && (sample < MAX_SAMPLES); sample++)
+    for (sample = 0; (sample < spp) && (sample < MAX_SAMPLES); sample++)
     {
-    srcbuffs[sample] = NULL;
-    tbuff = (unsigned char *)_TIFFmalloc(tilesize + 8);
-    if (!tbuff)
-      {
-      TIFFError ("readSeparateTilesIntoBuffer", 
-                 "Unable to allocate tile read buffer for sample %d", sample);
-      for (i = 0; i < sample; i++)
-        _TIFFfree (srcbuffs[i]);
-      return 0;
-      }
-    srcbuffs[sample] = tbuff;
+        srcbuffs[sample] = NULL;
+        tbuff = (unsigned char *)_TIFFmalloc(tilesize + 8);
+        if (!tbuff)
+        {
+            TIFFError("readSeparateTilesIntoBuffer",
+                       "Unable to allocate tile read buffer for sample %d", sample);
+            for (i = 0; i < sample; i++)
+                _TIFFfree(srcbuffs[i]);
+            return 0;
+        }
+        srcbuffs[sample] = tbuff;
     } 
-  /* Each tile contains only the data for a single plane
-   * arranged in scanlines of tw * bytes_per_sample bytes.
-   */
-  for (row = 0; row < imagelength; row += tl)
+    for (row = 0; row < imagelength; row += tl)
     {
-    nrow = (row + tl > imagelength) ? imagelength - row : tl;
-    for (col = 0; col < imagewidth; col += tw)
-      {
-      for (s = 0; s < spp; s++)
-        {  /* Read each plane of a tile set into srcbuffs[s] */
-	tbytes = TIFFReadTile(in, srcbuffs[s], col, row, 0, s);
-        if (tbytes < 0  && !ignore)
-          {
-	  TIFFError(TIFFFileName(in),
-                 "Error, can't read tile for row %lu col %lu, "
-		 "sample %lu",
-		 (unsigned long) col, (unsigned long) row,
-		 (unsigned long) s);
-		 status = 0;
-          for (sample = 0; (sample < spp) && (sample < MAX_SAMPLES); sample++)
+        nrow = (row + tl > imagelength) ? imagelength - row : tl;
+        for (col = 0; col < imagewidth; col += tw)
+        {
+            for (s = 0; s < spp; s++)
             {
-            tbuff = srcbuffs[sample];
-            if (tbuff != NULL)
-              _TIFFfree(tbuff);
+                tbytes = TIFFReadTile(in, srcbuffs[s], col, row, 0, s);
+                if (tbytes < 0)
+                {
+                    TIFFError(TIFFFileName(in),
+                               "Error, can't read tile for row %lu col %lu, "
+                               "sample %lu",
+                               (unsigned long)col, (unsigned long)row,
+                               (unsigned long)s);
+                    status = 0;
+                    break; // Exit the current sample loop
+                }
             }
-          return status;
-	  }
-	}
-     /* Tiles on the right edge may be padded out to tw 
-      * which must be a multiple of 16.
-      * Ncol represents the visible (non padding) portion.  
-      */
-      if (col + tw > imagewidth)
-        ncol = imagewidth - col;
-      else
-        ncol = tw;
-
-      row_offset = row * (((imagewidth * spp * bps) + 7) / 8);
-      col_offset = ((col * spp * bps) + 7) / 8;
-      bufp = obuf + row_offset + col_offset;
+            if (status == 0) break; // Exit the current col loop if error occurred
+            
+            if (col + tw > imagewidth)
+                ncol = imagewidth - col;
+            else
+                ncol = tw;
+
+            row_offset = row * (((imagewidth * spp * bps) + 7) / 8);
+            col_offset = ((col * spp * bps) + 7) / 8;
+            bufp = obuf + row_offset + col_offset;
 
-      if ((bps % 8) == 0)
-        {
-        if (combineSeparateTileSamplesBytes(srcbuffs, bufp, ncol, nrow, imagewidth,
-					    tw, spp, bps, NULL, 0, 0))
-	  {
-          status = 0;
-          break;
-      	  }
-	}
-      else
-        {
-        bytes_per_pixel  = ((bps * spp) + 7) / 8;
-        if (bytes_per_pixel < (bytes_per_sample + 1))
-          shift_width = bytes_per_pixel;
-        else
-          shift_width = bytes_per_sample + 1;
-
-        switch (shift_width)
-          {
-          case 1: if (combineSeparateTileSamples8bits (srcbuffs, bufp, ncol, nrow,
-                                                       imagewidth, tw, spp, bps, 
-						       NULL, 0, 0))
-	            {
-                    status = 0;
-                    break;
-      	            }
-	          break;
-          case 2: if (combineSeparateTileSamples16bits (srcbuffs, bufp, ncol, nrow,
-                                                       imagewidth, tw, spp, bps, 
-						       NULL, 0, 0))
-	            {
-                    status = 0;
-                    break;
-		    }
-	          break;
-          case 3: if (combineSeparateTileSamples24bits (srcbuffs, bufp, ncol, nrow,
-                                                       imagewidth, tw, spp, bps, 
-						       NULL, 0, 0))
-	            {
-                    status = 0;
-                    break;
-       	            }
-                  break;
-          case 4: 
-          case 5:
-          case 6:
-          case 7:
-          case 8: if (combineSeparateTileSamples32bits (srcbuffs, bufp, ncol, nrow,
-                                                       imagewidth, tw, spp, bps, 
-						       NULL, 0, 0))
-	            {
+            if ((bps % 8) == 0)
+            {
+                if (combineSeparateTileSamplesBytes(srcbuffs, bufp, ncol, nrow, imagewidth,
+                                                     tw, spp, bps, NULL, 0, 0))
+                {
                     status = 0;
                     break;
-		    }
-	          break;
-          default: TIFFError ("readSeparateTilesIntoBuffer", "Unsupported bit depth: %d", bps);
-                  status = 0;
-                  break;
-          }
+                }
+            }
+            else
+            {
+                bytes_per_pixel  = ((bps * spp) + 7) / 8;
+                if (bytes_per_pixel < (bytes_per_sample + 1))
+                    shift_width = bytes_per_pixel;
+                else
+                    shift_width = bytes_per_sample + 1;
+
+                switch (shift_width)
+                {
+                    case 1: 
+                        if (combineSeparateTileSamples8bits(srcbuffs, bufp, ncol, nrow,
+                                                            imagewidth, tw, spp, bps, 
+                                                            NULL, 0, 0))
+                        {
+                            status = 0;
+                            break;
+                        }
+                        break;
+                    case 2: 
+                        if (combineSeparateTileSamples16bits(srcbuffs, bufp, ncol, nrow,
+                                                             imagewidth, tw, spp, bps, 
+                                                             NULL, 0, 0))
+                        {
+                            status = 0;
+                            break;
+                        }
+                        break;
+                    case 3: 
+                        if (combineSeparateTileSamples24bits(srcbuffs, bufp, ncol, nrow,
+                                                             imagewidth, tw, spp, bps, 
+                                                             NULL, 0, 0))
+                        {
+                            status = 0;
+                            break;
+                        }
+                        break;
+                    case 4: 
+                    case 5:
+                    case 6:
+                    case 7:
+                    case 8: 
+                        if (combineSeparateTileSamples32bits(srcbuffs, bufp, ncol, nrow,
+                                                             imagewidth, tw, spp, bps, 
+                                                             NULL, 0, 0))
+                        {
+                            status = 0;
+                            break;
+                        }
+                        break;
+                    default: 
+                        TIFFError("readSeparateTilesIntoBuffer", "Unsupported bit depth: %d", bps);
+                        status = 0;
+                        break;
+                }
+            }
+            if (status == 0) break; // Exit the current col loop if error occurred
         }
-      }
+        if (status == 0) break; // Exit the row loop if error occurred
     }
 
-  for (sample = 0; (sample < spp) && (sample < MAX_SAMPLES); sample++)
+    for (sample = 0; (sample < spp) && (sample < MAX_SAMPLES); sample++)
     {
-    tbuff = srcbuffs[sample];
-    if (tbuff != NULL)
-      _TIFFfree(tbuff);
+        tbuff = srcbuffs[sample];
+        if (tbuff != NULL)
+            _TIFFfree(tbuff);
     }
- 
-  return status;
-  }
+
+    return status;
+}
+
 
 static int writeBufferToContigStrips(TIFF* out, uint8* buf, uint32 imagelength)
   {

2025-02-03 22:05:24.638 | DEBUG    | scenario:rebuild:369 - original environment: environ({'CONDA_SHLVL': '2', 'LC_ALL': 'C.UTF-8', 'LS_COLORS': 'rs=0:di=01;34:ln=01;36:mh=00:pi=40;33:so=01;35:do=01;35:bd=40;33;01:cd=40;33;01:or=40;31;01:mi=00:su=37;41:sg=30;43:ca=30;41:tw=30;42:ow=34;42:st=37;44:ex=01;32:*.tar=01;31:*.tgz=01;31:*.arc=01;31:*.arj=01;31:*.taz=01;31:*.lha=01;31:*.lz4=01;31:*.lzh=01;31:*.lzma=01;31:*.tlz=01;31:*.txz=01;31:*.tzo=01;31:*.t7z=01;31:*.zip=01;31:*.z=01;31:*.Z=01;31:*.dz=01;31:*.gz=01;31:*.lrz=01;31:*.lz=01;31:*.lzo=01;31:*.xz=01;31:*.zst=01;31:*.tzst=01;31:*.bz2=01;31:*.bz=01;31:*.tbz=01;31:*.tbz2=01;31:*.tz=01;31:*.deb=01;31:*.rpm=01;31:*.jar=01;31:*.war=01;31:*.ear=01;31:*.sar=01;31:*.rar=01;31:*.alz=01;31:*.ace=01;31:*.zoo=01;31:*.cpio=01;31:*.7z=01;31:*.rz=01;31:*.cab=01;31:*.wim=01;31:*.swm=01;31:*.dwm=01;31:*.esd=01;31:*.jpg=01;35:*.jpeg=01;35:*.mjpg=01;35:*.mjpeg=01;35:*.gif=01;35:*.bmp=01;35:*.pbm=01;35:*.pgm=01;35:*.ppm=01;35:*.tga=01;35:*.xbm=01;35:*.xpm=01;35:*.tif=01;35:*.tiff=01;35:*.png=01;35:*.svg=01;35:*.svgz=01;35:*.mng=01;35:*.pcx=01;35:*.mov=01;35:*.mpg=01;35:*.mpeg=01;35:*.m2v=01;35:*.mkv=01;35:*.webm=01;35:*.ogm=01;35:*.mp4=01;35:*.m4v=01;35:*.mp4v=01;35:*.vob=01;35:*.qt=01;35:*.nuv=01;35:*.wmv=01;35:*.asf=01;35:*.rm=01;35:*.rmvb=01;35:*.flc=01;35:*.avi=01;35:*.fli=01;35:*.flv=01;35:*.gl=01;35:*.dl=01;35:*.xcf=01;35:*.xwd=01;35:*.yuv=01;35:*.cgm=01;35:*.emf=01;35:*.ogv=01;35:*.ogx=01;35:*.aac=00;36:*.au=00;36:*.flac=00;36:*.m4a=00;36:*.mid=00;36:*.midi=00;36:*.mka=00;36:*.mp3=00;36:*.mpc=00;36:*.ogg=00;36:*.ra=00;36:*.wav=00;36:*.oga=00;36:*.opus=00;36:*.spx=00;36:*.xspf=00;36:', 'LD_LIBRARY_PATH': '/opt/crashrepair/lib:/CrashRepair/lib:/klee/build/lib:', 'CONDA_EXE': '/root/anaconda3/bin/conda', 'LANG': 'C.UTF-8', 'TZ': 'Asia/Shanghai', 'HOSTNAME': 'fea22102047d', 'OLDPWD': '/orchestrator', 'CONDA_PREFIX': '/root/anaconda3/envs/CrashRepair', '_CE_M': '', 'CC': 'crepair-cc', 'LLVM_COMPILER': 'clang', 'CONDA_PREFIX_1': '/root/anaconda3', 'PWD': '/orchestrator/crashrepair', 'HOME': '/root', 'CONDA_PYTHON_EXE': '/root/anaconda3/bin/python', '_CE_CONDA': '', 'CONDA_PROMPT_MODIFIER': '(CrashRepair) ', 'CXX': 'crepair-cxx', 'TERM': 'xterm', 'SHLVL': '2', 'PYTHONPATH': '/usr/lib/python3.8/site-packages:', 'PATH': '/root/anaconda3/envs/CrashRepair/bin:/root/anaconda3/condabin:~/anaconda3/bin:/opt/crashrepair/bin:/CrashRepair/compiler:/klee/build/bin:/opt/llvm-6/bin:/klee/build/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', 'CONDA_DEFAULT_ENV': 'CrashRepair', '_': '/root/anaconda3/envs/CrashRepair/bin/python'})
2025-02-03 22:05:24.638 | DEBUG    | scenario:rebuild:382 - injecting ghost function into CFLAGS during build: -lcrepair_ghost
2025-02-03 22:05:24.638 | DEBUG    | scenario:rebuild:398 - using environment: {'INJECT_CFLAGS': '-g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address', 'INJECT_CXXFLAGS': '-g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address', 'INJECT_LDFLAGS': '-g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address'}
2025-02-03 22:05:24.638 | DEBUG    | shell:__call__:41 - executing: make CFLAGS="${INJECT_CFLAGS}" CXXFLAGS="${INJECT_CXXFLAGS}" LDFLAGS="${INJECT_LDFLAGS}"
Making all in port
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/port'
make[1]: Nothing to be done for 'all'.
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/port'
Making all in libtiff
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/libtiff'
make  all-am
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/libtiff'
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/libtiff'
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/libtiff'
Making all in tools
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/tools'
crepair-cc -DHAVE_CONFIG_H -I. -I../libtiff  -I../libtiff   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -MT tiffcrop.o -MD -MP -MF .deps/tiffcrop.Tpo -c -o tiffcrop.o tiffcrop.c
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_ghost: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
mv -f .deps/tiffcrop.Tpo .deps/tiffcrop.Po
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address  -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -o tiffcrop tiffcrop.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -g -O0 -Wno-error -I/CrashRepair/lib -fsanitize=address -g -O0 -Wno-error -I/CrashRepair/lib -fsanitize=address -o tiffcrop tiffcrop.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a ../port/.libs/libport.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -llzma -ljbig -ljpeg -lz -lm
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/tools'
Making all in build
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/build'
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/build'
make[2]: Nothing to be done for 'all-am'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/build'
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/build'
Making all in contrib
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib'
Making all in addtiffo
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/addtiffo'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/addtiffo'
Making all in dbs
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/dbs'
Making all in xtiff
make[3]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/dbs/xtiff'
make[3]: Nothing to be done for 'all'.
make[3]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/dbs/xtiff'
make[3]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/dbs'
make[3]: Nothing to be done for 'all-am'.
make[3]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/dbs'
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/dbs'
Making all in iptcutil
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/iptcutil'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/iptcutil'
Making all in mfs
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/mfs'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/mfs'
Making all in pds
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/pds'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/pds'
Making all in ras
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/ras'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/ras'
Making all in stream
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/stream'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/stream'
Making all in tags
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/tags'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/tags'
Making all in win_dib
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/win_dib'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/win_dib'
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib'
make[2]: Nothing to be done for 'all-am'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib'
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib'
Making all in test
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/test'
make[1]: Nothing to be done for 'all'.
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/test'
Making all in man
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/man'
make[1]: Nothing to be done for 'all'.
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/man'
Making all in html
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html'
Making all in images
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html/images'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html/images'
Making all in man
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html/man'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html/man'
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html'
make[2]: Nothing to be done for 'all-am'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html'
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html'
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src'
make[1]: Nothing to be done for 'all-am'.
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src'
2025-02-03 22:05:25.115 | DEBUG    | scenario:evaluate:655 - testing candidate #12 against test #crash...
2025-02-03 22:05:25.115 | DEBUG    | shell:__call__:41 - executing: /data/vulnloc/libtiff/CVE-2016-5321/src/tools/tiffcrop /CrashRepair/experiments/vulnloc/libtiff/CVE-2016-5321/tests/1.tif foo.tif
2025-02-03 22:05:25.121 | DEBUG    | test:run:189 - test failed: unexpected exit code (actual: 139, expected: 0)
2025-02-03 22:05:25.121 | INFO     | scenario:evaluate:662 - candidate #12 fails test #crash
2025-02-03 22:05:25.127 | INFO     | scenario:evaluate:635 - evaluating candidate patch #13:
@@ -948,11 +948,12 @@
   return status;
   }
 
+
 static int  readSeparateTilesIntoBuffer (TIFF* in, uint8 *obuf, 
 					 uint32 imagelength, uint32 imagewidth, 
                                          uint32 tw, uint32 tl,
                                          uint16 spp, uint16 bps)
-  {
+{
   int     i, status = 1, sample;
   int     shift_width, bytes_per_pixel;
   uint16  bytes_per_sample;
@@ -968,51 +969,49 @@
   bytes_per_sample = (bps + 7) / 8;
 
   for (sample = 0; (sample < spp) && (sample < MAX_SAMPLES); sample++)
-    {
+  {
     srcbuffs[sample] = NULL;
     tbuff = (unsigned char *)_TIFFmalloc(tilesize + 8);
     if (!tbuff)
-      {
+    {
       TIFFError ("readSeparateTilesIntoBuffer", 
                  "Unable to allocate tile read buffer for sample %d", sample);
       for (i = 0; i < sample; i++)
         _TIFFfree (srcbuffs[i]);
       return 0;
-      }
+    }
     srcbuffs[sample] = tbuff;
-    } 
+  } 
   /* Each tile contains only the data for a single plane
    * arranged in scanlines of tw * bytes_per_sample bytes.
    */
   for (row = 0; row < imagelength; row += tl)
-    {
+  {
     nrow = (row + tl > imagelength) ? imagelength - row : tl;
     for (col = 0; col < imagewidth; col += tw)
-      {
+    {
       for (s = 0; s < spp; s++)
-        {  /* Read each plane of a tile set into srcbuffs[s] */
-	tbytes = TIFFReadTile(in, srcbuffs[s], col, row, 0, s);
-        if (tbytes < 0  && !ignore)
-          {
-	  TIFFError(TIFFFileName(in),
+      {  /* Read each plane of a tile set into srcbuffs[s] */
+        tbytes = TIFFReadTile(in, srcbuffs[s], col, row, 0, s);
+        if (tbytes < 0)
+        {
+          TIFFError(TIFFFileName(in),
                  "Error, can't read tile for row %lu col %lu, "
-		 "sample %lu",
-		 (unsigned long) col, (unsigned long) row,
-		 (unsigned long) s);
-		 status = 0;
-          for (sample = 0; (sample < spp) && (sample < MAX_SAMPLES); sample++)
-            {
-            tbuff = srcbuffs[sample];
-            if (tbuff != NULL)
-              _TIFFfree(tbuff);
-            }
-          return status;
-	  }
-	}
-     /* Tiles on the right edge may be padded out to tw 
-      * which must be a multiple of 16.
-      * Ncol represents the visible (non padding) portion.  
-      */
+                 "sample %lu",
+                 (unsigned long) col, (unsigned long) row,
+                 (unsigned long) s);
+          status = 0;
+          break; // Exit the loop as reading failed for this tile
+        }
+      }
+      if (status == 0) {
+        break; // Exit outer loop if there was an error
+      }
+     
+      /* Tiles on the right edge may be padded out to tw 
+       * which must be a multiple of 16.
+       * Ncol represents the visible (non padding) portion.  
+       */
       if (col + tw > imagewidth)
         ncol = imagewidth - col;
       else
@@ -1023,16 +1022,16 @@
       bufp = obuf + row_offset + col_offset;
 
       if ((bps % 8) == 0)
-        {
+      {
         if (combineSeparateTileSamplesBytes(srcbuffs, bufp, ncol, nrow, imagewidth,
 					    tw, spp, bps, NULL, 0, 0))
-	  {
+        {
           status = 0;
           break;
-      	  }
-	}
+        }
+      }
       else
-        {
+      {
         bytes_per_pixel  = ((bps * spp) + 7) / 8;
         if (bytes_per_pixel < (bytes_per_sample + 1))
           shift_width = bytes_per_pixel;
@@ -1040,60 +1039,69 @@
           shift_width = bytes_per_sample + 1;
 
         switch (shift_width)
-          {
-          case 1: if (combineSeparateTileSamples8bits (srcbuffs, bufp, ncol, nrow,
-                                                       imagewidth, tw, spp, bps, 
-						       NULL, 0, 0))
-	            {
-                    status = 0;
-                    break;
-      	            }
-	          break;
-          case 2: if (combineSeparateTileSamples16bits (srcbuffs, bufp, ncol, nrow,
-                                                       imagewidth, tw, spp, bps, 
-						       NULL, 0, 0))
-	            {
-                    status = 0;
-                    break;
-		    }
-	          break;
-          case 3: if (combineSeparateTileSamples24bits (srcbuffs, bufp, ncol, nrow,
-                                                       imagewidth, tw, spp, bps, 
-						       NULL, 0, 0))
-	            {
-                    status = 0;
-                    break;
-       	            }
-                  break;
+        {
+          case 1: 
+            if (combineSeparateTileSamples8bits (srcbuffs, bufp, ncol, nrow,
+                                                 imagewidth, tw, spp, bps, 
+						 NULL, 0, 0))
+            {
+              status = 0;
+              break;
+            }
+            break;
+          case 2: 
+            if (combineSeparateTileSamples16bits (srcbuffs, bufp, ncol, nrow,
+                                                  imagewidth, tw, spp, bps, 
+                                                  NULL, 0, 0))
+            {
+              status = 0;
+              break;
+            }
+            break;
+          case 3: 
+            if (combineSeparateTileSamples24bits (srcbuffs, bufp, ncol, nrow,
+                                                  imagewidth, tw, spp, bps, 
+                                                  NULL, 0, 0))
+            {
+              status = 0;
+              break;
+            }
+            break;
           case 4: 
           case 5:
           case 6:
           case 7:
-          case 8: if (combineSeparateTileSamples32bits (srcbuffs, bufp, ncol, nrow,
-                                                       imagewidth, tw, spp, bps, 
-						       NULL, 0, 0))
-	            {
-                    status = 0;
-                    break;
-		    }
-	          break;
-          default: TIFFError ("readSeparateTilesIntoBuffer", "Unsupported bit depth: %d", bps);
-                  status = 0;
-                  break;
-          }
+          case 8: 
+            if (combineSeparateTileSamples32bits (srcbuffs, bufp, ncol, nrow,
+                                                  imagewidth, tw, spp, bps, 
+                                                  NULL, 0, 0))
+            {
+              status = 0;
+              break;
+            }
+            break;
+          default: 
+            TIFFError ("readSeparateTilesIntoBuffer", "Unsupported bit depth: %d", bps);
+            status = 0;
+            break;
         }
       }
     }
+    if (status == 0) {
+      break; // Exit if there was an overall error
+    }
+  }
 
   for (sample = 0; (sample < spp) && (sample < MAX_SAMPLES); sample++)
-    {
+  {
     tbuff = srcbuffs[sample];
     if (tbuff != NULL)
       _TIFFfree(tbuff);
-    }
+  }
  
   return status;
-  }
+}
+
 
 static int writeBufferToContigStrips(TIFF* out, uint8* buf, uint32 imagelength)
   {

2025-02-03 22:05:25.132 | DEBUG    | scenario:rebuild:369 - original environment: environ({'CONDA_SHLVL': '2', 'LC_ALL': 'C.UTF-8', 'LS_COLORS': 'rs=0:di=01;34:ln=01;36:mh=00:pi=40;33:so=01;35:do=01;35:bd=40;33;01:cd=40;33;01:or=40;31;01:mi=00:su=37;41:sg=30;43:ca=30;41:tw=30;42:ow=34;42:st=37;44:ex=01;32:*.tar=01;31:*.tgz=01;31:*.arc=01;31:*.arj=01;31:*.taz=01;31:*.lha=01;31:*.lz4=01;31:*.lzh=01;31:*.lzma=01;31:*.tlz=01;31:*.txz=01;31:*.tzo=01;31:*.t7z=01;31:*.zip=01;31:*.z=01;31:*.Z=01;31:*.dz=01;31:*.gz=01;31:*.lrz=01;31:*.lz=01;31:*.lzo=01;31:*.xz=01;31:*.zst=01;31:*.tzst=01;31:*.bz2=01;31:*.bz=01;31:*.tbz=01;31:*.tbz2=01;31:*.tz=01;31:*.deb=01;31:*.rpm=01;31:*.jar=01;31:*.war=01;31:*.ear=01;31:*.sar=01;31:*.rar=01;31:*.alz=01;31:*.ace=01;31:*.zoo=01;31:*.cpio=01;31:*.7z=01;31:*.rz=01;31:*.cab=01;31:*.wim=01;31:*.swm=01;31:*.dwm=01;31:*.esd=01;31:*.jpg=01;35:*.jpeg=01;35:*.mjpg=01;35:*.mjpeg=01;35:*.gif=01;35:*.bmp=01;35:*.pbm=01;35:*.pgm=01;35:*.ppm=01;35:*.tga=01;35:*.xbm=01;35:*.xpm=01;35:*.tif=01;35:*.tiff=01;35:*.png=01;35:*.svg=01;35:*.svgz=01;35:*.mng=01;35:*.pcx=01;35:*.mov=01;35:*.mpg=01;35:*.mpeg=01;35:*.m2v=01;35:*.mkv=01;35:*.webm=01;35:*.ogm=01;35:*.mp4=01;35:*.m4v=01;35:*.mp4v=01;35:*.vob=01;35:*.qt=01;35:*.nuv=01;35:*.wmv=01;35:*.asf=01;35:*.rm=01;35:*.rmvb=01;35:*.flc=01;35:*.avi=01;35:*.fli=01;35:*.flv=01;35:*.gl=01;35:*.dl=01;35:*.xcf=01;35:*.xwd=01;35:*.yuv=01;35:*.cgm=01;35:*.emf=01;35:*.ogv=01;35:*.ogx=01;35:*.aac=00;36:*.au=00;36:*.flac=00;36:*.m4a=00;36:*.mid=00;36:*.midi=00;36:*.mka=00;36:*.mp3=00;36:*.mpc=00;36:*.ogg=00;36:*.ra=00;36:*.wav=00;36:*.oga=00;36:*.opus=00;36:*.spx=00;36:*.xspf=00;36:', 'LD_LIBRARY_PATH': '/opt/crashrepair/lib:/CrashRepair/lib:/klee/build/lib:', 'CONDA_EXE': '/root/anaconda3/bin/conda', 'LANG': 'C.UTF-8', 'TZ': 'Asia/Shanghai', 'HOSTNAME': 'fea22102047d', 'OLDPWD': '/orchestrator', 'CONDA_PREFIX': '/root/anaconda3/envs/CrashRepair', '_CE_M': '', 'CC': 'crepair-cc', 'LLVM_COMPILER': 'clang', 'CONDA_PREFIX_1': '/root/anaconda3', 'PWD': '/orchestrator/crashrepair', 'HOME': '/root', 'CONDA_PYTHON_EXE': '/root/anaconda3/bin/python', '_CE_CONDA': '', 'CONDA_PROMPT_MODIFIER': '(CrashRepair) ', 'CXX': 'crepair-cxx', 'TERM': 'xterm', 'SHLVL': '2', 'PYTHONPATH': '/usr/lib/python3.8/site-packages:', 'PATH': '/root/anaconda3/envs/CrashRepair/bin:/root/anaconda3/condabin:~/anaconda3/bin:/opt/crashrepair/bin:/CrashRepair/compiler:/klee/build/bin:/opt/llvm-6/bin:/klee/build/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', 'CONDA_DEFAULT_ENV': 'CrashRepair', '_': '/root/anaconda3/envs/CrashRepair/bin/python'})
2025-02-03 22:05:25.133 | DEBUG    | scenario:rebuild:382 - injecting ghost function into CFLAGS during build: -lcrepair_ghost
2025-02-03 22:05:25.133 | DEBUG    | scenario:rebuild:398 - using environment: {'INJECT_CFLAGS': '-g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address', 'INJECT_CXXFLAGS': '-g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address', 'INJECT_LDFLAGS': '-g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address'}
2025-02-03 22:05:25.133 | DEBUG    | shell:__call__:41 - executing: make CFLAGS="${INJECT_CFLAGS}" CXXFLAGS="${INJECT_CXXFLAGS}" LDFLAGS="${INJECT_LDFLAGS}"
Making all in port
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/port'
make[1]: Nothing to be done for 'all'.
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/port'
Making all in libtiff
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/libtiff'
make  all-am
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/libtiff'
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/libtiff'
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/libtiff'
Making all in tools
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/tools'
crepair-cc -DHAVE_CONFIG_H -I. -I../libtiff  -I../libtiff   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -MT tiffcrop.o -MD -MP -MF .deps/tiffcrop.Tpo -c -o tiffcrop.o tiffcrop.c
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_ghost: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
mv -f .deps/tiffcrop.Tpo .deps/tiffcrop.Po
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address  -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -o tiffcrop tiffcrop.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -g -O0 -Wno-error -I/CrashRepair/lib -fsanitize=address -g -O0 -Wno-error -I/CrashRepair/lib -fsanitize=address -o tiffcrop tiffcrop.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a ../port/.libs/libport.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -llzma -ljbig -ljpeg -lz -lm
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/tools'
Making all in build
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/build'
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/build'
make[2]: Nothing to be done for 'all-am'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/build'
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/build'
Making all in contrib
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib'
Making all in addtiffo
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/addtiffo'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/addtiffo'
Making all in dbs
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/dbs'
Making all in xtiff
make[3]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/dbs/xtiff'
make[3]: Nothing to be done for 'all'.
make[3]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/dbs/xtiff'
make[3]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/dbs'
make[3]: Nothing to be done for 'all-am'.
make[3]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/dbs'
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/dbs'
Making all in iptcutil
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/iptcutil'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/iptcutil'
Making all in mfs
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/mfs'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/mfs'
Making all in pds
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/pds'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/pds'
Making all in ras
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/ras'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/ras'
Making all in stream
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/stream'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/stream'
Making all in tags
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/tags'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/tags'
Making all in win_dib
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/win_dib'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/win_dib'
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib'
make[2]: Nothing to be done for 'all-am'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib'
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib'
Making all in test
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/test'
make[1]: Nothing to be done for 'all'.
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/test'
Making all in man
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/man'
make[1]: Nothing to be done for 'all'.
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/man'
Making all in html
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html'
Making all in images
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html/images'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html/images'
Making all in man
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html/man'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html/man'
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html'
make[2]: Nothing to be done for 'all-am'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html'
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html'
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src'
make[1]: Nothing to be done for 'all-am'.
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src'
2025-02-03 22:05:25.614 | DEBUG    | scenario:evaluate:655 - testing candidate #13 against test #crash...
2025-02-03 22:05:25.615 | DEBUG    | shell:__call__:41 - executing: /data/vulnloc/libtiff/CVE-2016-5321/src/tools/tiffcrop /CrashRepair/experiments/vulnloc/libtiff/CVE-2016-5321/tests/1.tif foo.tif
2025-02-03 22:05:25.621 | DEBUG    | test:run:189 - test failed: unexpected exit code (actual: 139, expected: 0)
2025-02-03 22:05:25.621 | INFO     | scenario:evaluate:662 - candidate #13 fails test #crash
2025-02-03 22:05:25.626 | INFO     | scenario:evaluate:635 - evaluating candidate patch #14:
@@ -948,152 +948,162 @@
   return status;
   }
 
-static int  readSeparateTilesIntoBuffer (TIFF* in, uint8 *obuf, 
-					 uint32 imagelength, uint32 imagewidth, 
-                                         uint32 tw, uint32 tl,
-                                         uint16 spp, uint16 bps)
-  {
-  int     i, status = 1, sample;
-  int     shift_width, bytes_per_pixel;
-  uint16  bytes_per_sample;
-  uint32  row, col;     /* Current row and col of image */
-  uint32  nrow, ncol;   /* Number of rows and cols in current tile */
-  uint32  row_offset, col_offset; /* Output buffer offsets */
-  tsize_t tbytes = 0, tilesize = TIFFTileSize(in);
-  tsample_t s;
-  uint8*  bufp = (uint8*)obuf;
-  unsigned char *srcbuffs[MAX_SAMPLES];
-  unsigned char *tbuff = NULL;
 
-  bytes_per_sample = (bps + 7) / 8;
+static int readSeparateTilesIntoBuffer(TIFF* in, uint8 *obuf, 
+                                        uint32 imagelength, uint32 imagewidth, 
+                                        uint32 tw, uint32 tl,
+                                        uint16 spp, uint16 bps)
+{
+    int i, status = 1, sample;
+    int shift_width, bytes_per_pixel;
+    uint16 bytes_per_sample;
+    uint32 row, col;     /* Current row and col of image */
+    uint32 nrow, ncol;   /* Number of rows and cols in current tile */
+    uint32 row_offset, col_offset; /* Output buffer offsets */
+    tsize_t tbytes = 0, tilesize = TIFFTileSize(in);
+    tsample_t s;
+    uint8* bufp = (uint8*)obuf;
+    unsigned char *srcbuffs[MAX_SAMPLES];
+    unsigned char *tbuff = NULL;
+
+    bytes_per_sample = (bps + 7) / 8;
 
-  for (sample = 0; (sample < spp) && (sample < MAX_SAMPLES); sample++)
+    for (sample = 0; (sample < spp) && (sample < MAX_SAMPLES); sample++)
     {
-    srcbuffs[sample] = NULL;
-    tbuff = (unsigned char *)_TIFFmalloc(tilesize + 8);
-    if (!tbuff)
-      {
-      TIFFError ("readSeparateTilesIntoBuffer", 
-                 "Unable to allocate tile read buffer for sample %d", sample);
-      for (i = 0; i < sample; i++)
-        _TIFFfree (srcbuffs[i]);
-      return 0;
-      }
-    srcbuffs[sample] = tbuff;
+        srcbuffs[sample] = NULL;
+        tbuff = (unsigned char *)_TIFFmalloc(tilesize + 8);
+        if (!tbuff)
+        {
+            TIFFError("readSeparateTilesIntoBuffer", 
+                       "Unable to allocate tile read buffer for sample %d", sample);
+            for (i = 0; i < sample; i++)
+                _TIFFfree(srcbuffs[i]);
+            return 0;
+        }
+        srcbuffs[sample] = tbuff;
     } 
-  /* Each tile contains only the data for a single plane
-   * arranged in scanlines of tw * bytes_per_sample bytes.
-   */
-  for (row = 0; row < imagelength; row += tl)
+    /* Each tile contains only the data for a single plane
+     * arranged in scanlines of tw * bytes_per_sample bytes.
+     */
+    for (row = 0; row < imagelength; row += tl)
     {
-    nrow = (row + tl > imagelength) ? imagelength - row : tl;
-    for (col = 0; col < imagewidth; col += tw)
-      {
-      for (s = 0; s < spp; s++)
-        {  /* Read each plane of a tile set into srcbuffs[s] */
-	tbytes = TIFFReadTile(in, srcbuffs[s], col, row, 0, s);
-        if (tbytes < 0  && !ignore)
-          {
-	  TIFFError(TIFFFileName(in),
-                 "Error, can't read tile for row %lu col %lu, "
-		 "sample %lu",
-		 (unsigned long) col, (unsigned long) row,
-		 (unsigned long) s);
-		 status = 0;
-          for (sample = 0; (sample < spp) && (sample < MAX_SAMPLES); sample++)
-            {
-            tbuff = srcbuffs[sample];
-            if (tbuff != NULL)
-              _TIFFfree(tbuff);
+        nrow = (row + tl > imagelength) ? imagelength - row : tl;
+        for (col = 0; col < imagewidth; col += tw)
+        {
+            for (s = 0; s < spp; s++)
+            {  /* Read each plane of a tile set into srcbuffs[s] */
+                tbytes = TIFFReadTile(in, srcbuffs[s], col, row, 0, s);
+                if (tbytes < 0)
+                {
+                    if (!ignore)
+                    {
+                        TIFFError(TIFFFileName(in),
+                                   "Error, can't read tile for row %lu col %lu, "
+                                   "sample %lu",
+                                   (unsigned long)col, (unsigned long)row,
+                                   (unsigned long)s);
+                        status = 0;
+                    }
+                    for (sample = 0; (sample < spp) && (sample < MAX_SAMPLES); sample++)
+                    {
+                        tbuff = srcbuffs[sample];
+                        if (tbuff != NULL)
+                            _TIFFfree(tbuff);
+                    }
+                    return status;
+                }
             }
-          return status;
-	  }
-	}
-     /* Tiles on the right edge may be padded out to tw 
-      * which must be a multiple of 16.
-      * Ncol represents the visible (non padding) portion.  
-      */
-      if (col + tw > imagewidth)
-        ncol = imagewidth - col;
-      else
-        ncol = tw;
-
-      row_offset = row * (((imagewidth * spp * bps) + 7) / 8);
-      col_offset = ((col * spp * bps) + 7) / 8;
-      bufp = obuf + row_offset + col_offset;
+            /* Tiles on the right edge may be padded out to tw 
+             * which must be a multiple of 16.
+             * Ncol represents the visible (non padding) portion.  
+             */
+            if (col + tw > imagewidth)
+                ncol = imagewidth - col;
+            else
+                ncol = tw;
+
+            row_offset = row * (((imagewidth * spp * bps) + 7) / 8);
+            col_offset = ((col * spp * bps) + 7) / 8;
+            bufp = obuf + row_offset + col_offset;
 
-      if ((bps % 8) == 0)
-        {
-        if (combineSeparateTileSamplesBytes(srcbuffs, bufp, ncol, nrow, imagewidth,
-					    tw, spp, bps, NULL, 0, 0))
-	  {
-          status = 0;
-          break;
-      	  }
-	}
-      else
-        {
-        bytes_per_pixel  = ((bps * spp) + 7) / 8;
-        if (bytes_per_pixel < (bytes_per_sample + 1))
-          shift_width = bytes_per_pixel;
-        else
-          shift_width = bytes_per_sample + 1;
-
-        switch (shift_width)
-          {
-          case 1: if (combineSeparateTileSamples8bits (srcbuffs, bufp, ncol, nrow,
-                                                       imagewidth, tw, spp, bps, 
-						       NULL, 0, 0))
-	            {
+            if ((bps % 8) == 0)
+            {
+                if (combineSeparateTileSamplesBytes(srcbuffs, bufp, ncol, nrow, imagewidth,
+                                                    tw, spp, bps, NULL, 0, 0))
+                {
                     status = 0;
                     break;
-      	            }
-	          break;
-          case 2: if (combineSeparateTileSamples16bits (srcbuffs, bufp, ncol, nrow,
-                                                       imagewidth, tw, spp, bps, 
-						       NULL, 0, 0))
-	            {
-                    status = 0;
+                }
+            }
+            else
+            {
+                bytes_per_pixel = ((bps * spp) + 7) / 8;
+                if (bytes_per_pixel < (bytes_per_sample + 1))
+                    shift_width = bytes_per_pixel;
+                else
+                    shift_width = bytes_per_sample + 1;
+
+                switch (shift_width)
+                {
+                case 1: 
+                    if (combineSeparateTileSamples8bits(srcbuffs, bufp, ncol, nrow,
+                                                         imagewidth, tw, spp, bps, 
+                                                         NULL, 0, 0))
+                    {
+                        status = 0;
+                        break;
+                    }
                     break;
-		    }
-	          break;
-          case 3: if (combineSeparateTileSamples24bits (srcbuffs, bufp, ncol, nrow,
-                                                       imagewidth, tw, spp, bps, 
-						       NULL, 0, 0))
-	            {
-                    status = 0;
+                case 2: 
+                    if (combineSeparateTileSamples16bits(srcbuffs, bufp, ncol, nrow,
+                                                         imagewidth, tw, spp, bps, 
+                                                         NULL, 0, 0))
+                    {
+                        status = 0;
+                        break;
+                    }
+                    break;
+                case 3: 
+                    if (combineSeparateTileSamples24bits(srcbuffs, bufp, ncol, nrow,
+                                                         imagewidth, tw, spp, bps, 
+                                                         NULL, 0, 0))
+                    {
+                        status = 0;
+                        break;
+                    }
+                    break;
+                case 4: 
+                case 5:
+                case 6:
+                case 7:
+                case 8: 
+                    if (combineSeparateTileSamples32bits(srcbuffs, bufp, ncol, nrow,
+                                                         imagewidth, tw, spp, bps, 
+                                                         NULL, 0, 0))
+                    {
+                        status = 0;
+                        break;
+                    }
                     break;
-       	            }
-                  break;
-          case 4: 
-          case 5:
-          case 6:
-          case 7:
-          case 8: if (combineSeparateTileSamples32bits (srcbuffs, bufp, ncol, nrow,
-                                                       imagewidth, tw, spp, bps, 
-						       NULL, 0, 0))
-	            {
+                default: 
+                    TIFFError("readSeparateTilesIntoBuffer", "Unsupported bit depth: %d", bps);
                     status = 0;
                     break;
-		    }
-	          break;
-          default: TIFFError ("readSeparateTilesIntoBuffer", "Unsupported bit depth: %d", bps);
-                  status = 0;
-                  break;
-          }
+                }
+            }
         }
-      }
     }
 
-  for (sample = 0; (sample < spp) && (sample < MAX_SAMPLES); sample++)
+    for (sample = 0; (sample < spp) && (sample < MAX_SAMPLES); sample++)
     {
-    tbuff = srcbuffs[sample];
-    if (tbuff != NULL)
-      _TIFFfree(tbuff);
+        tbuff = srcbuffs[sample];
+        if (tbuff != NULL)
+            _TIFFfree(tbuff);
     }
- 
-  return status;
-  }
+
+    return status;
+}
+
 
 static int writeBufferToContigStrips(TIFF* out, uint8* buf, uint32 imagelength)
   {

2025-02-03 22:05:25.633 | DEBUG    | scenario:rebuild:369 - original environment: environ({'CONDA_SHLVL': '2', 'LC_ALL': 'C.UTF-8', 'LS_COLORS': 'rs=0:di=01;34:ln=01;36:mh=00:pi=40;33:so=01;35:do=01;35:bd=40;33;01:cd=40;33;01:or=40;31;01:mi=00:su=37;41:sg=30;43:ca=30;41:tw=30;42:ow=34;42:st=37;44:ex=01;32:*.tar=01;31:*.tgz=01;31:*.arc=01;31:*.arj=01;31:*.taz=01;31:*.lha=01;31:*.lz4=01;31:*.lzh=01;31:*.lzma=01;31:*.tlz=01;31:*.txz=01;31:*.tzo=01;31:*.t7z=01;31:*.zip=01;31:*.z=01;31:*.Z=01;31:*.dz=01;31:*.gz=01;31:*.lrz=01;31:*.lz=01;31:*.lzo=01;31:*.xz=01;31:*.zst=01;31:*.tzst=01;31:*.bz2=01;31:*.bz=01;31:*.tbz=01;31:*.tbz2=01;31:*.tz=01;31:*.deb=01;31:*.rpm=01;31:*.jar=01;31:*.war=01;31:*.ear=01;31:*.sar=01;31:*.rar=01;31:*.alz=01;31:*.ace=01;31:*.zoo=01;31:*.cpio=01;31:*.7z=01;31:*.rz=01;31:*.cab=01;31:*.wim=01;31:*.swm=01;31:*.dwm=01;31:*.esd=01;31:*.jpg=01;35:*.jpeg=01;35:*.mjpg=01;35:*.mjpeg=01;35:*.gif=01;35:*.bmp=01;35:*.pbm=01;35:*.pgm=01;35:*.ppm=01;35:*.tga=01;35:*.xbm=01;35:*.xpm=01;35:*.tif=01;35:*.tiff=01;35:*.png=01;35:*.svg=01;35:*.svgz=01;35:*.mng=01;35:*.pcx=01;35:*.mov=01;35:*.mpg=01;35:*.mpeg=01;35:*.m2v=01;35:*.mkv=01;35:*.webm=01;35:*.ogm=01;35:*.mp4=01;35:*.m4v=01;35:*.mp4v=01;35:*.vob=01;35:*.qt=01;35:*.nuv=01;35:*.wmv=01;35:*.asf=01;35:*.rm=01;35:*.rmvb=01;35:*.flc=01;35:*.avi=01;35:*.fli=01;35:*.flv=01;35:*.gl=01;35:*.dl=01;35:*.xcf=01;35:*.xwd=01;35:*.yuv=01;35:*.cgm=01;35:*.emf=01;35:*.ogv=01;35:*.ogx=01;35:*.aac=00;36:*.au=00;36:*.flac=00;36:*.m4a=00;36:*.mid=00;36:*.midi=00;36:*.mka=00;36:*.mp3=00;36:*.mpc=00;36:*.ogg=00;36:*.ra=00;36:*.wav=00;36:*.oga=00;36:*.opus=00;36:*.spx=00;36:*.xspf=00;36:', 'LD_LIBRARY_PATH': '/opt/crashrepair/lib:/CrashRepair/lib:/klee/build/lib:', 'CONDA_EXE': '/root/anaconda3/bin/conda', 'LANG': 'C.UTF-8', 'TZ': 'Asia/Shanghai', 'HOSTNAME': 'fea22102047d', 'OLDPWD': '/orchestrator', 'CONDA_PREFIX': '/root/anaconda3/envs/CrashRepair', '_CE_M': '', 'CC': 'crepair-cc', 'LLVM_COMPILER': 'clang', 'CONDA_PREFIX_1': '/root/anaconda3', 'PWD': '/orchestrator/crashrepair', 'HOME': '/root', 'CONDA_PYTHON_EXE': '/root/anaconda3/bin/python', '_CE_CONDA': '', 'CONDA_PROMPT_MODIFIER': '(CrashRepair) ', 'CXX': 'crepair-cxx', 'TERM': 'xterm', 'SHLVL': '2', 'PYTHONPATH': '/usr/lib/python3.8/site-packages:', 'PATH': '/root/anaconda3/envs/CrashRepair/bin:/root/anaconda3/condabin:~/anaconda3/bin:/opt/crashrepair/bin:/CrashRepair/compiler:/klee/build/bin:/opt/llvm-6/bin:/klee/build/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', 'CONDA_DEFAULT_ENV': 'CrashRepair', '_': '/root/anaconda3/envs/CrashRepair/bin/python'})
2025-02-03 22:05:25.633 | DEBUG    | scenario:rebuild:382 - injecting ghost function into CFLAGS during build: -lcrepair_ghost
2025-02-03 22:05:25.633 | DEBUG    | scenario:rebuild:398 - using environment: {'INJECT_CFLAGS': '-g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address', 'INJECT_CXXFLAGS': '-g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address', 'INJECT_LDFLAGS': '-g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address'}
2025-02-03 22:05:25.633 | DEBUG    | shell:__call__:41 - executing: make CFLAGS="${INJECT_CFLAGS}" CXXFLAGS="${INJECT_CXXFLAGS}" LDFLAGS="${INJECT_LDFLAGS}"
Making all in port
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/port'
make[1]: Nothing to be done for 'all'.
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/port'
Making all in libtiff
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/libtiff'
make  all-am
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/libtiff'
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/libtiff'
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/libtiff'
Making all in tools
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/tools'
crepair-cc -DHAVE_CONFIG_H -I. -I../libtiff  -I../libtiff   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -MT tiffcrop.o -MD -MP -MF .deps/tiffcrop.Tpo -c -o tiffcrop.o tiffcrop.c
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_ghost: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
mv -f .deps/tiffcrop.Tpo .deps/tiffcrop.Po
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address  -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -o tiffcrop tiffcrop.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -g -O0 -Wno-error -I/CrashRepair/lib -fsanitize=address -g -O0 -Wno-error -I/CrashRepair/lib -fsanitize=address -o tiffcrop tiffcrop.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a ../port/.libs/libport.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -llzma -ljbig -ljpeg -lz -lm
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/tools'
Making all in build
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/build'
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/build'
make[2]: Nothing to be done for 'all-am'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/build'
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/build'
Making all in contrib
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib'
Making all in addtiffo
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/addtiffo'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/addtiffo'
Making all in dbs
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/dbs'
Making all in xtiff
make[3]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/dbs/xtiff'
make[3]: Nothing to be done for 'all'.
make[3]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/dbs/xtiff'
make[3]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/dbs'
make[3]: Nothing to be done for 'all-am'.
make[3]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/dbs'
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/dbs'
Making all in iptcutil
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/iptcutil'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/iptcutil'
Making all in mfs
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/mfs'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/mfs'
Making all in pds
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/pds'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/pds'
Making all in ras
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/ras'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/ras'
Making all in stream
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/stream'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/stream'
Making all in tags
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/tags'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/tags'
Making all in win_dib
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/win_dib'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/win_dib'
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib'
make[2]: Nothing to be done for 'all-am'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib'
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib'
Making all in test
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/test'
make[1]: Nothing to be done for 'all'.
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/test'
Making all in man
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/man'
make[1]: Nothing to be done for 'all'.
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/man'
Making all in html
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html'
Making all in images
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html/images'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html/images'
Making all in man
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html/man'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html/man'
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html'
make[2]: Nothing to be done for 'all-am'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html'
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html'
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src'
make[1]: Nothing to be done for 'all-am'.
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src'
2025-02-03 22:05:26.116 | DEBUG    | scenario:evaluate:655 - testing candidate #14 against test #crash...
2025-02-03 22:05:26.116 | DEBUG    | shell:__call__:41 - executing: /data/vulnloc/libtiff/CVE-2016-5321/src/tools/tiffcrop /CrashRepair/experiments/vulnloc/libtiff/CVE-2016-5321/tests/1.tif foo.tif
2025-02-03 22:05:26.122 | DEBUG    | test:run:189 - test failed: unexpected exit code (actual: 139, expected: 0)
2025-02-03 22:05:26.122 | INFO     | scenario:evaluate:662 - candidate #14 fails test #crash
2025-02-03 22:05:26.130 | INFO     | scenario:evaluate:635 - evaluating candidate patch #15:
@@ -948,152 +948,154 @@
   return status;
   }
 
-static int  readSeparateTilesIntoBuffer (TIFF* in, uint8 *obuf, 
-					 uint32 imagelength, uint32 imagewidth, 
+
+static int readSeparateTilesIntoBuffer (TIFF* in, uint8 *obuf, 
+                                         uint32 imagelength, uint32 imagewidth, 
                                          uint32 tw, uint32 tl,
                                          uint16 spp, uint16 bps)
-  {
-  int     i, status = 1, sample;
-  int     shift_width, bytes_per_pixel;
-  uint16  bytes_per_sample;
-  uint32  row, col;     /* Current row and col of image */
-  uint32  nrow, ncol;   /* Number of rows and cols in current tile */
-  uint32  row_offset, col_offset; /* Output buffer offsets */
-  tsize_t tbytes = 0, tilesize = TIFFTileSize(in);
-  tsample_t s;
-  uint8*  bufp = (uint8*)obuf;
-  unsigned char *srcbuffs[MAX_SAMPLES];
-  unsigned char *tbuff = NULL;
+{
+    int     i, status = 1, sample;
+    int     shift_width, bytes_per_pixel;
+    uint16  bytes_per_sample;
+    uint32  row, col;     /* Current row and col of image */
+    uint32  nrow, ncol;   /* Number of rows and cols in current tile */
+    uint32  row_offset, col_offset; /* Output buffer offsets */
+    tsize_t tbytes = 0, tilesize = TIFFTileSize(in);
+    tsample_t s;
+    uint8*  bufp = (uint8*)obuf;
+    unsigned char *srcbuffs[MAX_SAMPLES];
+    unsigned char *tbuff = NULL;
 
-  bytes_per_sample = (bps + 7) / 8;
+    bytes_per_sample = (bps + 7) / 8;
 
-  for (sample = 0; (sample < spp) && (sample < MAX_SAMPLES); sample++)
+    for (sample = 0; (sample < spp) && (sample < MAX_SAMPLES); sample++)
     {
-    srcbuffs[sample] = NULL;
-    tbuff = (unsigned char *)_TIFFmalloc(tilesize + 8);
-    if (!tbuff)
-      {
-      TIFFError ("readSeparateTilesIntoBuffer", 
-                 "Unable to allocate tile read buffer for sample %d", sample);
-      for (i = 0; i < sample; i++)
-        _TIFFfree (srcbuffs[i]);
-      return 0;
-      }
-    srcbuffs[sample] = tbuff;
+        srcbuffs[sample] = NULL;
+        tbuff = (unsigned char *)_TIFFmalloc(tilesize + 8);
+        if (!tbuff)
+        {
+            TIFFError ("readSeparateTilesIntoBuffer", 
+                        "Unable to allocate tile read buffer for sample %d", sample);
+            for (i = 0; i < sample; i++)
+                _TIFFfree (srcbuffs[i]);
+            return 0;
+        }
+        srcbuffs[sample] = tbuff;
     } 
-  /* Each tile contains only the data for a single plane
-   * arranged in scanlines of tw * bytes_per_sample bytes.
-   */
-  for (row = 0; row < imagelength; row += tl)
+
+    for (row = 0; row < imagelength; row += tl)
     {
-    nrow = (row + tl > imagelength) ? imagelength - row : tl;
-    for (col = 0; col < imagewidth; col += tw)
-      {
-      for (s = 0; s < spp; s++)
-        {  /* Read each plane of a tile set into srcbuffs[s] */
-	tbytes = TIFFReadTile(in, srcbuffs[s], col, row, 0, s);
-        if (tbytes < 0  && !ignore)
-          {
-	  TIFFError(TIFFFileName(in),
-                 "Error, can't read tile for row %lu col %lu, "
-		 "sample %lu",
-		 (unsigned long) col, (unsigned long) row,
-		 (unsigned long) s);
-		 status = 0;
-          for (sample = 0; (sample < spp) && (sample < MAX_SAMPLES); sample++)
+        nrow = (row + tl > imagelength) ? imagelength - row : tl;
+        for (col = 0; col < imagewidth; col += tw)
+        {
+            for (s = 0; s < spp; s++)
             {
-            tbuff = srcbuffs[sample];
-            if (tbuff != NULL)
-              _TIFFfree(tbuff);
+                tbytes = TIFFReadTile(in, srcbuffs[s], col, row, 0, s);
+                if (tbytes < 0)
+                {
+                    TIFFError(TIFFFileName(in),
+                              "Error, can't read tile for row %lu col %lu, "
+                              "sample %lu",
+                              (unsigned long) col, (unsigned long) row,
+                              (unsigned long) s);
+                    status = 0;
+                    for (sample = 0; (sample < spp) && (sample < MAX_SAMPLES); sample++)
+                    {
+                        tbuff = srcbuffs[sample];
+                        if (tbuff != NULL)
+                            _TIFFfree(tbuff);
+                    }
+                    return status;
+                }
             }
-          return status;
-	  }
-	}
-     /* Tiles on the right edge may be padded out to tw 
-      * which must be a multiple of 16.
-      * Ncol represents the visible (non padding) portion.  
-      */
-      if (col + tw > imagewidth)
-        ncol = imagewidth - col;
-      else
-        ncol = tw;
-
-      row_offset = row * (((imagewidth * spp * bps) + 7) / 8);
-      col_offset = ((col * spp * bps) + 7) / 8;
-      bufp = obuf + row_offset + col_offset;
 
-      if ((bps % 8) == 0)
-        {
-        if (combineSeparateTileSamplesBytes(srcbuffs, bufp, ncol, nrow, imagewidth,
-					    tw, spp, bps, NULL, 0, 0))
-	  {
-          status = 0;
-          break;
-      	  }
-	}
-      else
-        {
-        bytes_per_pixel  = ((bps * spp) + 7) / 8;
-        if (bytes_per_pixel < (bytes_per_sample + 1))
-          shift_width = bytes_per_pixel;
-        else
-          shift_width = bytes_per_sample + 1;
-
-        switch (shift_width)
-          {
-          case 1: if (combineSeparateTileSamples8bits (srcbuffs, bufp, ncol, nrow,
-                                                       imagewidth, tw, spp, bps, 
-						       NULL, 0, 0))
-	            {
-                    status = 0;
-                    break;
-      	            }
-	          break;
-          case 2: if (combineSeparateTileSamples16bits (srcbuffs, bufp, ncol, nrow,
-                                                       imagewidth, tw, spp, bps, 
-						       NULL, 0, 0))
-	            {
-                    status = 0;
-                    break;
-		    }
-	          break;
-          case 3: if (combineSeparateTileSamples24bits (srcbuffs, bufp, ncol, nrow,
-                                                       imagewidth, tw, spp, bps, 
-						       NULL, 0, 0))
-	            {
-                    status = 0;
-                    break;
-       	            }
-                  break;
-          case 4: 
-          case 5:
-          case 6:
-          case 7:
-          case 8: if (combineSeparateTileSamples32bits (srcbuffs, bufp, ncol, nrow,
-                                                       imagewidth, tw, spp, bps, 
-						       NULL, 0, 0))
-	            {
+            if (col + tw > imagewidth)
+                ncol = imagewidth - col;
+            else
+                ncol = tw;
+
+            row_offset = row * (((imagewidth * spp * bps) + 7) / 8);
+            col_offset = ((col * spp * bps) + 7) / 8;
+            bufp = obuf + row_offset + col_offset;
+
+            if ((bps % 8) == 0)
+            {
+                if (combineSeparateTileSamplesBytes(srcbuffs, bufp, ncol, nrow, imagewidth,
+                                                     tw, spp, bps, NULL, 0, 0))
+                {
                     status = 0;
                     break;
-		    }
-	          break;
-          default: TIFFError ("readSeparateTilesIntoBuffer", "Unsupported bit depth: %d", bps);
-                  status = 0;
-                  break;
-          }
+                }
+            }
+            else
+            {
+                bytes_per_pixel  = ((bps * spp) + 7) / 8;
+                if (bytes_per_pixel < (bytes_per_sample + 1))
+                    shift_width = bytes_per_pixel;
+                else
+                    shift_width = bytes_per_sample + 1;
+
+                switch (shift_width)
+                {
+                    case 1: 
+                        if (combineSeparateTileSamples8bits (srcbuffs, bufp, ncol, nrow,
+                                                             imagewidth, tw, spp, bps, 
+                                                             NULL, 0, 0))
+                        {
+                            status = 0;
+                            break;
+                        }
+                        break;
+                    case 2: 
+                        if (combineSeparateTileSamples16bits (srcbuffs, bufp, ncol, nrow,
+                                                              imagewidth, tw, spp, bps, 
+                                                              NULL, 0, 0))
+                        {
+                            status = 0;
+                            break;
+                        }
+                        break;
+                    case 3: 
+                        if (combineSeparateTileSamples24bits (srcbuffs, bufp, ncol, nrow,
+                                                              imagewidth, tw, spp, bps, 
+                                                              NULL, 0, 0))
+                        {
+                            status = 0;
+                            break;
+                        }
+                        break;
+                    case 4: 
+                    case 5:
+                    case 6:
+                    case 7:
+                    case 8: 
+                        if (combineSeparateTileSamples32bits (srcbuffs, bufp, ncol, nrow,
+                                                              imagewidth, tw, spp, bps, 
+                                                              NULL, 0, 0))
+                        {
+                            status = 0;
+                            break;
+                        }
+                        break;
+                    default: 
+                        TIFFError ("readSeparateTilesIntoBuffer", "Unsupported bit depth: %d", bps);
+                        status = 0;
+                        break;
+                }
+            }
         }
-      }
     }
 
-  for (sample = 0; (sample < spp) && (sample < MAX_SAMPLES); sample++)
+    for (sample = 0; (sample < spp) && (sample < MAX_SAMPLES); sample++)
     {
-    tbuff = srcbuffs[sample];
-    if (tbuff != NULL)
-      _TIFFfree(tbuff);
+        tbuff = srcbuffs[sample];
+        if (tbuff != NULL)
+            _TIFFfree(tbuff);
     }
- 
-  return status;
-  }
+
+    return status;
+}
+
 
 static int writeBufferToContigStrips(TIFF* out, uint8* buf, uint32 imagelength)
   {

2025-02-03 22:05:26.138 | DEBUG    | scenario:rebuild:369 - original environment: environ({'CONDA_SHLVL': '2', 'LC_ALL': 'C.UTF-8', 'LS_COLORS': 'rs=0:di=01;34:ln=01;36:mh=00:pi=40;33:so=01;35:do=01;35:bd=40;33;01:cd=40;33;01:or=40;31;01:mi=00:su=37;41:sg=30;43:ca=30;41:tw=30;42:ow=34;42:st=37;44:ex=01;32:*.tar=01;31:*.tgz=01;31:*.arc=01;31:*.arj=01;31:*.taz=01;31:*.lha=01;31:*.lz4=01;31:*.lzh=01;31:*.lzma=01;31:*.tlz=01;31:*.txz=01;31:*.tzo=01;31:*.t7z=01;31:*.zip=01;31:*.z=01;31:*.Z=01;31:*.dz=01;31:*.gz=01;31:*.lrz=01;31:*.lz=01;31:*.lzo=01;31:*.xz=01;31:*.zst=01;31:*.tzst=01;31:*.bz2=01;31:*.bz=01;31:*.tbz=01;31:*.tbz2=01;31:*.tz=01;31:*.deb=01;31:*.rpm=01;31:*.jar=01;31:*.war=01;31:*.ear=01;31:*.sar=01;31:*.rar=01;31:*.alz=01;31:*.ace=01;31:*.zoo=01;31:*.cpio=01;31:*.7z=01;31:*.rz=01;31:*.cab=01;31:*.wim=01;31:*.swm=01;31:*.dwm=01;31:*.esd=01;31:*.jpg=01;35:*.jpeg=01;35:*.mjpg=01;35:*.mjpeg=01;35:*.gif=01;35:*.bmp=01;35:*.pbm=01;35:*.pgm=01;35:*.ppm=01;35:*.tga=01;35:*.xbm=01;35:*.xpm=01;35:*.tif=01;35:*.tiff=01;35:*.png=01;35:*.svg=01;35:*.svgz=01;35:*.mng=01;35:*.pcx=01;35:*.mov=01;35:*.mpg=01;35:*.mpeg=01;35:*.m2v=01;35:*.mkv=01;35:*.webm=01;35:*.ogm=01;35:*.mp4=01;35:*.m4v=01;35:*.mp4v=01;35:*.vob=01;35:*.qt=01;35:*.nuv=01;35:*.wmv=01;35:*.asf=01;35:*.rm=01;35:*.rmvb=01;35:*.flc=01;35:*.avi=01;35:*.fli=01;35:*.flv=01;35:*.gl=01;35:*.dl=01;35:*.xcf=01;35:*.xwd=01;35:*.yuv=01;35:*.cgm=01;35:*.emf=01;35:*.ogv=01;35:*.ogx=01;35:*.aac=00;36:*.au=00;36:*.flac=00;36:*.m4a=00;36:*.mid=00;36:*.midi=00;36:*.mka=00;36:*.mp3=00;36:*.mpc=00;36:*.ogg=00;36:*.ra=00;36:*.wav=00;36:*.oga=00;36:*.opus=00;36:*.spx=00;36:*.xspf=00;36:', 'LD_LIBRARY_PATH': '/opt/crashrepair/lib:/CrashRepair/lib:/klee/build/lib:', 'CONDA_EXE': '/root/anaconda3/bin/conda', 'LANG': 'C.UTF-8', 'TZ': 'Asia/Shanghai', 'HOSTNAME': 'fea22102047d', 'OLDPWD': '/orchestrator', 'CONDA_PREFIX': '/root/anaconda3/envs/CrashRepair', '_CE_M': '', 'CC': 'crepair-cc', 'LLVM_COMPILER': 'clang', 'CONDA_PREFIX_1': '/root/anaconda3', 'PWD': '/orchestrator/crashrepair', 'HOME': '/root', 'CONDA_PYTHON_EXE': '/root/anaconda3/bin/python', '_CE_CONDA': '', 'CONDA_PROMPT_MODIFIER': '(CrashRepair) ', 'CXX': 'crepair-cxx', 'TERM': 'xterm', 'SHLVL': '2', 'PYTHONPATH': '/usr/lib/python3.8/site-packages:', 'PATH': '/root/anaconda3/envs/CrashRepair/bin:/root/anaconda3/condabin:~/anaconda3/bin:/opt/crashrepair/bin:/CrashRepair/compiler:/klee/build/bin:/opt/llvm-6/bin:/klee/build/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', 'CONDA_DEFAULT_ENV': 'CrashRepair', '_': '/root/anaconda3/envs/CrashRepair/bin/python'})
2025-02-03 22:05:26.138 | DEBUG    | scenario:rebuild:382 - injecting ghost function into CFLAGS during build: -lcrepair_ghost
2025-02-03 22:05:26.138 | DEBUG    | scenario:rebuild:398 - using environment: {'INJECT_CFLAGS': '-g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address', 'INJECT_CXXFLAGS': '-g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address', 'INJECT_LDFLAGS': '-g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address'}
2025-02-03 22:05:26.138 | DEBUG    | shell:__call__:41 - executing: make CFLAGS="${INJECT_CFLAGS}" CXXFLAGS="${INJECT_CXXFLAGS}" LDFLAGS="${INJECT_LDFLAGS}"
Making all in port
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/port'
make[1]: Nothing to be done for 'all'.
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/port'
Making all in libtiff
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/libtiff'
make  all-am
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/libtiff'
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/libtiff'
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/libtiff'
Making all in tools
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/tools'
crepair-cc -DHAVE_CONFIG_H -I. -I../libtiff  -I../libtiff   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -MT tiffcrop.o -MD -MP -MF .deps/tiffcrop.Tpo -c -o tiffcrop.o tiffcrop.c
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_ghost: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
mv -f .deps/tiffcrop.Tpo .deps/tiffcrop.Po
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address  -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -o tiffcrop tiffcrop.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -g -O0 -Wno-error -I/CrashRepair/lib -fsanitize=address -g -O0 -Wno-error -I/CrashRepair/lib -fsanitize=address -o tiffcrop tiffcrop.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a ../port/.libs/libport.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -llzma -ljbig -ljpeg -lz -lm
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/tools'
Making all in build
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/build'
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/build'
make[2]: Nothing to be done for 'all-am'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/build'
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/build'
Making all in contrib
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib'
Making all in addtiffo
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/addtiffo'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/addtiffo'
Making all in dbs
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/dbs'
Making all in xtiff
make[3]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/dbs/xtiff'
make[3]: Nothing to be done for 'all'.
make[3]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/dbs/xtiff'
make[3]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/dbs'
make[3]: Nothing to be done for 'all-am'.
make[3]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/dbs'
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/dbs'
Making all in iptcutil
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/iptcutil'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/iptcutil'
Making all in mfs
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/mfs'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/mfs'
Making all in pds
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/pds'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/pds'
Making all in ras
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/ras'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/ras'
Making all in stream
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/stream'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/stream'
Making all in tags
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/tags'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/tags'
Making all in win_dib
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/win_dib'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/win_dib'
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib'
make[2]: Nothing to be done for 'all-am'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib'
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib'
Making all in test
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/test'
make[1]: Nothing to be done for 'all'.
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/test'
Making all in man
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/man'
make[1]: Nothing to be done for 'all'.
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/man'
Making all in html
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html'
Making all in images
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html/images'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html/images'
Making all in man
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html/man'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html/man'
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html'
make[2]: Nothing to be done for 'all-am'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html'
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html'
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src'
make[1]: Nothing to be done for 'all-am'.
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src'
2025-02-03 22:05:26.626 | DEBUG    | scenario:evaluate:655 - testing candidate #15 against test #crash...
2025-02-03 22:05:26.626 | DEBUG    | shell:__call__:41 - executing: /data/vulnloc/libtiff/CVE-2016-5321/src/tools/tiffcrop /CrashRepair/experiments/vulnloc/libtiff/CVE-2016-5321/tests/1.tif foo.tif
2025-02-03 22:05:26.633 | DEBUG    | test:run:189 - test failed: unexpected exit code (actual: 139, expected: 0)
2025-02-03 22:05:26.633 | INFO     | scenario:evaluate:662 - candidate #15 fails test #crash
2025-02-03 22:05:26.641 | INFO     | scenario:evaluate:635 - evaluating candidate patch #16:
@@ -948,11 +948,12 @@
   return status;
   }
 
-static int  readSeparateTilesIntoBuffer (TIFF* in, uint8 *obuf, 
-					 uint32 imagelength, uint32 imagewidth, 
+
+static int readSeparateTilesIntoBuffer (TIFF* in, uint8 *obuf, 
+                                         uint32 imagelength, uint32 imagewidth, 
                                          uint32 tw, uint32 tl,
                                          uint16 spp, uint16 bps)
-  {
+{
   int     i, status = 1, sample;
   int     shift_width, bytes_per_pixel;
   uint16  bytes_per_sample;
@@ -968,51 +969,51 @@
   bytes_per_sample = (bps + 7) / 8;
 
   for (sample = 0; (sample < spp) && (sample < MAX_SAMPLES); sample++)
-    {
+  {
     srcbuffs[sample] = NULL;
     tbuff = (unsigned char *)_TIFFmalloc(tilesize + 8);
     if (!tbuff)
-      {
+    {
       TIFFError ("readSeparateTilesIntoBuffer", 
                  "Unable to allocate tile read buffer for sample %d", sample);
       for (i = 0; i < sample; i++)
         _TIFFfree (srcbuffs[i]);
       return 0;
-      }
+    }
     srcbuffs[sample] = tbuff;
-    } 
+  } 
   /* Each tile contains only the data for a single plane
    * arranged in scanlines of tw * bytes_per_sample bytes.
    */
   for (row = 0; row < imagelength; row += tl)
-    {
+  {
     nrow = (row + tl > imagelength) ? imagelength - row : tl;
     for (col = 0; col < imagewidth; col += tw)
-      {
+    {
       for (s = 0; s < spp; s++)
-        {  /* Read each plane of a tile set into srcbuffs[s] */
-	tbytes = TIFFReadTile(in, srcbuffs[s], col, row, 0, s);
-        if (tbytes < 0  && !ignore)
-          {
-	  TIFFError(TIFFFileName(in),
+      {  
+        tbytes = TIFFReadTile(in, srcbuffs[s], col, row, 0, s);
+        if (tbytes == (tsize_t)-1  && !ignore)  // Change to check for -1 instead of < 0
+        {
+          TIFFError(TIFFFileName(in),
                  "Error, can't read tile for row %lu col %lu, "
-		 "sample %lu",
-		 (unsigned long) col, (unsigned long) row,
-		 (unsigned long) s);
-		 status = 0;
+                 "sample %lu",
+                 (unsigned long) col, (unsigned long) row,
+                 (unsigned long) s);
+          status = 0;
           for (sample = 0; (sample < spp) && (sample < MAX_SAMPLES); sample++)
-            {
+          {
             tbuff = srcbuffs[sample];
             if (tbuff != NULL)
               _TIFFfree(tbuff);
-            }
+          }
           return status;
-	  }
-	}
-     /* Tiles on the right edge may be padded out to tw 
-      * which must be a multiple of 16.
-      * Ncol represents the visible (non padding) portion.  
-      */
+        }
+      }
+      /* Tiles on the right edge may be padded out to tw 
+       * which must be a multiple of 16.
+       * Ncol represents the visible (non padding) portion.  
+       */
       if (col + tw > imagewidth)
         ncol = imagewidth - col;
       else
@@ -1023,16 +1024,16 @@
       bufp = obuf + row_offset + col_offset;
 
       if ((bps % 8) == 0)
-        {
+      {
         if (combineSeparateTileSamplesBytes(srcbuffs, bufp, ncol, nrow, imagewidth,
-					    tw, spp, bps, NULL, 0, 0))
-	  {
+                                            tw, spp, bps, NULL, 0, 0))
+        {
           status = 0;
           break;
-      	  }
-	}
+        }
+      }
       else
-        {
+      {
         bytes_per_pixel  = ((bps * spp) + 7) / 8;
         if (bytes_per_pixel < (bytes_per_sample + 1))
           shift_width = bytes_per_pixel;
@@ -1040,30 +1041,30 @@
           shift_width = bytes_per_sample + 1;
 
         switch (shift_width)
-          {
+        {
           case 1: if (combineSeparateTileSamples8bits (srcbuffs, bufp, ncol, nrow,
                                                        imagewidth, tw, spp, bps, 
-						       NULL, 0, 0))
-	            {
+                                                       NULL, 0, 0))
+                  {
                     status = 0;
                     break;
-      	            }
-	          break;
+                  }
+                  break;
           case 2: if (combineSeparateTileSamples16bits (srcbuffs, bufp, ncol, nrow,
                                                        imagewidth, tw, spp, bps, 
-						       NULL, 0, 0))
-	            {
+                                                       NULL, 0, 0))
+                  {
                     status = 0;
                     break;
-		    }
-	          break;
+                  }
+                  break;
           case 3: if (combineSeparateTileSamples24bits (srcbuffs, bufp, ncol, nrow,
                                                        imagewidth, tw, spp, bps, 
-						       NULL, 0, 0))
-	            {
+                                                       NULL, 0, 0))
+                  {
                     status = 0;
                     break;
-       	            }
+                  }
                   break;
           case 4: 
           case 5:
@@ -1071,29 +1072,30 @@
           case 7:
           case 8: if (combineSeparateTileSamples32bits (srcbuffs, bufp, ncol, nrow,
                                                        imagewidth, tw, spp, bps, 
-						       NULL, 0, 0))
-	            {
+                                                       NULL, 0, 0))
+                  {
                     status = 0;
                     break;
-		    }
-	          break;
+                  }
+                  break;
           default: TIFFError ("readSeparateTilesIntoBuffer", "Unsupported bit depth: %d", bps);
                   status = 0;
                   break;
-          }
         }
       }
     }
+  }
 
   for (sample = 0; (sample < spp) && (sample < MAX_SAMPLES); sample++)
-    {
+  {
     tbuff = srcbuffs[sample];
     if (tbuff != NULL)
       _TIFFfree(tbuff);
-    }
+  }
  
   return status;
-  }
+}
+
 
 static int writeBufferToContigStrips(TIFF* out, uint8* buf, uint32 imagelength)
   {

2025-02-03 22:05:26.647 | DEBUG    | scenario:rebuild:369 - original environment: environ({'CONDA_SHLVL': '2', 'LC_ALL': 'C.UTF-8', 'LS_COLORS': 'rs=0:di=01;34:ln=01;36:mh=00:pi=40;33:so=01;35:do=01;35:bd=40;33;01:cd=40;33;01:or=40;31;01:mi=00:su=37;41:sg=30;43:ca=30;41:tw=30;42:ow=34;42:st=37;44:ex=01;32:*.tar=01;31:*.tgz=01;31:*.arc=01;31:*.arj=01;31:*.taz=01;31:*.lha=01;31:*.lz4=01;31:*.lzh=01;31:*.lzma=01;31:*.tlz=01;31:*.txz=01;31:*.tzo=01;31:*.t7z=01;31:*.zip=01;31:*.z=01;31:*.Z=01;31:*.dz=01;31:*.gz=01;31:*.lrz=01;31:*.lz=01;31:*.lzo=01;31:*.xz=01;31:*.zst=01;31:*.tzst=01;31:*.bz2=01;31:*.bz=01;31:*.tbz=01;31:*.tbz2=01;31:*.tz=01;31:*.deb=01;31:*.rpm=01;31:*.jar=01;31:*.war=01;31:*.ear=01;31:*.sar=01;31:*.rar=01;31:*.alz=01;31:*.ace=01;31:*.zoo=01;31:*.cpio=01;31:*.7z=01;31:*.rz=01;31:*.cab=01;31:*.wim=01;31:*.swm=01;31:*.dwm=01;31:*.esd=01;31:*.jpg=01;35:*.jpeg=01;35:*.mjpg=01;35:*.mjpeg=01;35:*.gif=01;35:*.bmp=01;35:*.pbm=01;35:*.pgm=01;35:*.ppm=01;35:*.tga=01;35:*.xbm=01;35:*.xpm=01;35:*.tif=01;35:*.tiff=01;35:*.png=01;35:*.svg=01;35:*.svgz=01;35:*.mng=01;35:*.pcx=01;35:*.mov=01;35:*.mpg=01;35:*.mpeg=01;35:*.m2v=01;35:*.mkv=01;35:*.webm=01;35:*.ogm=01;35:*.mp4=01;35:*.m4v=01;35:*.mp4v=01;35:*.vob=01;35:*.qt=01;35:*.nuv=01;35:*.wmv=01;35:*.asf=01;35:*.rm=01;35:*.rmvb=01;35:*.flc=01;35:*.avi=01;35:*.fli=01;35:*.flv=01;35:*.gl=01;35:*.dl=01;35:*.xcf=01;35:*.xwd=01;35:*.yuv=01;35:*.cgm=01;35:*.emf=01;35:*.ogv=01;35:*.ogx=01;35:*.aac=00;36:*.au=00;36:*.flac=00;36:*.m4a=00;36:*.mid=00;36:*.midi=00;36:*.mka=00;36:*.mp3=00;36:*.mpc=00;36:*.ogg=00;36:*.ra=00;36:*.wav=00;36:*.oga=00;36:*.opus=00;36:*.spx=00;36:*.xspf=00;36:', 'LD_LIBRARY_PATH': '/opt/crashrepair/lib:/CrashRepair/lib:/klee/build/lib:', 'CONDA_EXE': '/root/anaconda3/bin/conda', 'LANG': 'C.UTF-8', 'TZ': 'Asia/Shanghai', 'HOSTNAME': 'fea22102047d', 'OLDPWD': '/orchestrator', 'CONDA_PREFIX': '/root/anaconda3/envs/CrashRepair', '_CE_M': '', 'CC': 'crepair-cc', 'LLVM_COMPILER': 'clang', 'CONDA_PREFIX_1': '/root/anaconda3', 'PWD': '/orchestrator/crashrepair', 'HOME': '/root', 'CONDA_PYTHON_EXE': '/root/anaconda3/bin/python', '_CE_CONDA': '', 'CONDA_PROMPT_MODIFIER': '(CrashRepair) ', 'CXX': 'crepair-cxx', 'TERM': 'xterm', 'SHLVL': '2', 'PYTHONPATH': '/usr/lib/python3.8/site-packages:', 'PATH': '/root/anaconda3/envs/CrashRepair/bin:/root/anaconda3/condabin:~/anaconda3/bin:/opt/crashrepair/bin:/CrashRepair/compiler:/klee/build/bin:/opt/llvm-6/bin:/klee/build/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', 'CONDA_DEFAULT_ENV': 'CrashRepair', '_': '/root/anaconda3/envs/CrashRepair/bin/python'})
2025-02-03 22:05:26.647 | DEBUG    | scenario:rebuild:382 - injecting ghost function into CFLAGS during build: -lcrepair_ghost
2025-02-03 22:05:26.647 | DEBUG    | scenario:rebuild:398 - using environment: {'INJECT_CFLAGS': '-g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address', 'INJECT_CXXFLAGS': '-g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address', 'INJECT_LDFLAGS': '-g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address'}
2025-02-03 22:05:26.647 | DEBUG    | shell:__call__:41 - executing: make CFLAGS="${INJECT_CFLAGS}" CXXFLAGS="${INJECT_CXXFLAGS}" LDFLAGS="${INJECT_LDFLAGS}"
Making all in port
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/port'
make[1]: Nothing to be done for 'all'.
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/port'
Making all in libtiff
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/libtiff'
make  all-am
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/libtiff'
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/libtiff'
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/libtiff'
Making all in tools
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/tools'
crepair-cc -DHAVE_CONFIG_H -I. -I../libtiff  -I../libtiff   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -MT tiffcrop.o -MD -MP -MF .deps/tiffcrop.Tpo -c -o tiffcrop.o tiffcrop.c
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_ghost: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
mv -f .deps/tiffcrop.Tpo .deps/tiffcrop.Po
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address  -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -o tiffcrop tiffcrop.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -g -O0 -Wno-error -I/CrashRepair/lib -fsanitize=address -g -O0 -Wno-error -I/CrashRepair/lib -fsanitize=address -o tiffcrop tiffcrop.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a ../port/.libs/libport.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -llzma -ljbig -ljpeg -lz -lm
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/tools'
Making all in build
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/build'
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/build'
make[2]: Nothing to be done for 'all-am'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/build'
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/build'
Making all in contrib
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib'
Making all in addtiffo
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/addtiffo'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/addtiffo'
Making all in dbs
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/dbs'
Making all in xtiff
make[3]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/dbs/xtiff'
make[3]: Nothing to be done for 'all'.
make[3]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/dbs/xtiff'
make[3]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/dbs'
make[3]: Nothing to be done for 'all-am'.
make[3]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/dbs'
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/dbs'
Making all in iptcutil
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/iptcutil'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/iptcutil'
Making all in mfs
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/mfs'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/mfs'
Making all in pds
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/pds'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/pds'
Making all in ras
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/ras'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/ras'
Making all in stream
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/stream'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/stream'
Making all in tags
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/tags'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/tags'
Making all in win_dib
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/win_dib'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/win_dib'
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib'
make[2]: Nothing to be done for 'all-am'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib'
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib'
Making all in test
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/test'
make[1]: Nothing to be done for 'all'.
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/test'
Making all in man
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/man'
make[1]: Nothing to be done for 'all'.
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/man'
Making all in html
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html'
Making all in images
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html/images'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html/images'
Making all in man
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html/man'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html/man'
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html'
make[2]: Nothing to be done for 'all-am'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html'
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html'
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src'
make[1]: Nothing to be done for 'all-am'.
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src'
2025-02-03 22:05:27.130 | DEBUG    | scenario:evaluate:655 - testing candidate #16 against test #crash...
2025-02-03 22:05:27.131 | DEBUG    | shell:__call__:41 - executing: /data/vulnloc/libtiff/CVE-2016-5321/src/tools/tiffcrop /CrashRepair/experiments/vulnloc/libtiff/CVE-2016-5321/tests/1.tif foo.tif
2025-02-03 22:05:27.143 | DEBUG    | test:run:189 - test failed: unexpected exit code (actual: 139, expected: 0)
2025-02-03 22:05:27.143 | INFO     | scenario:evaluate:662 - candidate #16 fails test #crash
2025-02-03 22:05:27.149 | INFO     | scenario:evaluate:635 - evaluating candidate patch #17:
@@ -948,152 +948,149 @@
   return status;
   }
 
-static int  readSeparateTilesIntoBuffer (TIFF* in, uint8 *obuf, 
-					 uint32 imagelength, uint32 imagewidth, 
+
+static int readSeparateTilesIntoBuffer (TIFF* in, uint8 *obuf, 
+                                         uint32 imagelength, uint32 imagewidth, 
                                          uint32 tw, uint32 tl,
                                          uint16 spp, uint16 bps)
-  {
-  int     i, status = 1, sample;
-  int     shift_width, bytes_per_pixel;
-  uint16  bytes_per_sample;
-  uint32  row, col;     /* Current row and col of image */
-  uint32  nrow, ncol;   /* Number of rows and cols in current tile */
-  uint32  row_offset, col_offset; /* Output buffer offsets */
-  tsize_t tbytes = 0, tilesize = TIFFTileSize(in);
-  tsample_t s;
-  uint8*  bufp = (uint8*)obuf;
-  unsigned char *srcbuffs[MAX_SAMPLES];
-  unsigned char *tbuff = NULL;
+{
+    int     i, status = 1, sample;
+    int     shift_width, bytes_per_pixel;
+    uint16  bytes_per_sample;
+    uint32  row, col;     /* Current row and col of image */
+    uint32  nrow, ncol;   /* Number of rows and cols in current tile */
+    uint32  row_offset, col_offset; /* Output buffer offsets */
+    tsize_t tbytes = 0, tilesize = TIFFTileSize(in);
+    tsample_t s;
+    uint8*  bufp = (uint8*)obuf;
+    unsigned char *srcbuffs[MAX_SAMPLES];
+    unsigned char *tbuff = NULL;
 
-  bytes_per_sample = (bps + 7) / 8;
+    bytes_per_sample = (bps + 7) / 8;
 
-  for (sample = 0; (sample < spp) && (sample < MAX_SAMPLES); sample++)
+    for (sample = 0; (sample < spp) && (sample < MAX_SAMPLES); sample++)
     {
-    srcbuffs[sample] = NULL;
-    tbuff = (unsigned char *)_TIFFmalloc(tilesize + 8);
-    if (!tbuff)
-      {
-      TIFFError ("readSeparateTilesIntoBuffer", 
-                 "Unable to allocate tile read buffer for sample %d", sample);
-      for (i = 0; i < sample; i++)
-        _TIFFfree (srcbuffs[i]);
-      return 0;
-      }
-    srcbuffs[sample] = tbuff;
+        srcbuffs[sample] = NULL;
+        tbuff = (unsigned char *)_TIFFmalloc(tilesize + 8);
+        if (!tbuff)
+        {
+            TIFFError ("readSeparateTilesIntoBuffer", 
+                "Unable to allocate tile read buffer for sample %d", sample);
+            for (i = 0; i < sample; i++)
+                _TIFFfree (srcbuffs[i]);
+            return 0;
+        }
+        srcbuffs[sample] = tbuff;
     } 
-  /* Each tile contains only the data for a single plane
-   * arranged in scanlines of tw * bytes_per_sample bytes.
-   */
-  for (row = 0; row < imagelength; row += tl)
+    /* Each tile contains only the data for a single plane
+     * arranged in scanlines of tw * bytes_per_sample bytes.
+     */
+    for (row = 0; row < imagelength; row += tl)
     {
-    nrow = (row + tl > imagelength) ? imagelength - row : tl;
-    for (col = 0; col < imagewidth; col += tw)
-      {
-      for (s = 0; s < spp; s++)
-        {  /* Read each plane of a tile set into srcbuffs[s] */
-	tbytes = TIFFReadTile(in, srcbuffs[s], col, row, 0, s);
-        if (tbytes < 0  && !ignore)
-          {
-	  TIFFError(TIFFFileName(in),
-                 "Error, can't read tile for row %lu col %lu, "
-		 "sample %lu",
-		 (unsigned long) col, (unsigned long) row,
-		 (unsigned long) s);
-		 status = 0;
-          for (sample = 0; (sample < spp) && (sample < MAX_SAMPLES); sample++)
-            {
-            tbuff = srcbuffs[sample];
-            if (tbuff != NULL)
-              _TIFFfree(tbuff);
-            }
-          return status;
-	  }
-	}
-     /* Tiles on the right edge may be padded out to tw 
-      * which must be a multiple of 16.
-      * Ncol represents the visible (non padding) portion.  
-      */
-      if (col + tw > imagewidth)
-        ncol = imagewidth - col;
-      else
-        ncol = tw;
-
-      row_offset = row * (((imagewidth * spp * bps) + 7) / 8);
-      col_offset = ((col * spp * bps) + 7) / 8;
-      bufp = obuf + row_offset + col_offset;
-
-      if ((bps % 8) == 0)
-        {
-        if (combineSeparateTileSamplesBytes(srcbuffs, bufp, ncol, nrow, imagewidth,
-					    tw, spp, bps, NULL, 0, 0))
-	  {
-          status = 0;
-          break;
-      	  }
-	}
-      else
+        nrow = (row + tl > imagelength) ? imagelength - row : tl;
+        for (col = 0; col < imagewidth; col += tw)
         {
-        bytes_per_pixel  = ((bps * spp) + 7) / 8;
-        if (bytes_per_pixel < (bytes_per_sample + 1))
-          shift_width = bytes_per_pixel;
-        else
-          shift_width = bytes_per_sample + 1;
-
-        switch (shift_width)
-          {
-          case 1: if (combineSeparateTileSamples8bits (srcbuffs, bufp, ncol, nrow,
-                                                       imagewidth, tw, spp, bps, 
-						       NULL, 0, 0))
-	            {
-                    status = 0;
-                    break;
-      	            }
-	          break;
-          case 2: if (combineSeparateTileSamples16bits (srcbuffs, bufp, ncol, nrow,
-                                                       imagewidth, tw, spp, bps, 
-						       NULL, 0, 0))
-	            {
-                    status = 0;
-                    break;
-		    }
-	          break;
-          case 3: if (combineSeparateTileSamples24bits (srcbuffs, bufp, ncol, nrow,
-                                                       imagewidth, tw, spp, bps, 
-						       NULL, 0, 0))
-	            {
+            for (s = 0; s < spp; s++)
+            {  /* Read each plane of a tile set into srcbuffs[s] */
+                tbytes = TIFFReadTile(in, srcbuffs[s], col, row, 0, s);
+                if (tbytes == (tsize_t)(-1)) 
+                {
+                    TIFFError(TIFFFileName(in),
+                        "Error, can't read tile for row %lu col %lu, "
+                        "sample %lu",
+                        (unsigned long) col, (unsigned long) row,
+                        (unsigned long) s);
                     status = 0;
                     break;
-       	            }
-                  break;
-          case 4: 
-          case 5:
-          case 6:
-          case 7:
-          case 8: if (combineSeparateTileSamples32bits (srcbuffs, bufp, ncol, nrow,
-                                                       imagewidth, tw, spp, bps, 
-						       NULL, 0, 0))
-	            {
+                }
+            }
+        
+            /* Tiles on the right edge may be padded out to tw 
+             * which must be a multiple of 16.
+             * Ncol represents the visible (non padding) portion.  
+             */
+            if (col + tw > imagewidth)
+                ncol = imagewidth - col;
+            else
+                ncol = tw;
+
+            row_offset = row * (((imagewidth * spp * bps) + 7) / 8);
+            col_offset = ((col * spp * bps) + 7) / 8;
+            bufp = obuf + row_offset + col_offset;
+
+            if ((bps % 8) == 0)
+            {
+                if (combineSeparateTileSamplesBytes(srcbuffs, bufp, ncol, nrow, imagewidth,
+                                                     tw, spp, bps, NULL, 0, 0))
+                {
                     status = 0;
                     break;
-		    }
-	          break;
-          default: TIFFError ("readSeparateTilesIntoBuffer", "Unsupported bit depth: %d", bps);
-                  status = 0;
-                  break;
-          }
+                }
+            }
+            else
+            {
+                bytes_per_pixel  = ((bps * spp) + 7) / 8;
+                if (bytes_per_pixel < (bytes_per_sample + 1))
+                    shift_width = bytes_per_pixel;
+                else
+                    shift_width = bytes_per_sample + 1;
+
+                switch (shift_width)
+                {
+                    case 1: if (combineSeparateTileSamples8bits (srcbuffs, bufp, ncol, nrow,
+                                                                 imagewidth, tw, spp, bps, 
+                                                                 NULL, 0, 0))
+                            {
+                                status = 0;
+                                break;
+                            }
+                            break;
+                    case 2: if (combineSeparateTileSamples16bits (srcbuffs, bufp, ncol, nrow,
+                                                                 imagewidth, tw, spp, bps, 
+                                                                 NULL, 0, 0))
+                            {
+                                status = 0;
+                                break;
+                            }
+                            break;
+                    case 3: if (combineSeparateTileSamples24bits (srcbuffs, bufp, ncol, nrow,
+                                                                 imagewidth, tw, spp, bps, 
+                                                                 NULL, 0, 0))
+                            {
+                                status = 0;
+                                break;
+                            }
+                            break;
+                    case 4: 
+                    case 5:
+                    case 6:
+                    case 7:
+                    case 8: if (combineSeparateTileSamples32bits (srcbuffs, bufp, ncol, nrow,
+                                                                 imagewidth, tw, spp, bps, 
+                                                                 NULL, 0, 0))
+                            {
+                                status = 0;
+                                break;
+                            }
+                            break;
+                    default: TIFFError ("readSeparateTilesIntoBuffer", "Unsupported bit depth: %d", bps);
+                             status = 0;
+                             break;
+                }
+            }
         }
-      }
     }
 
-  for (sample = 0; (sample < spp) && (sample < MAX_SAMPLES); sample++)
+    for (sample = 0; (sample < spp) && (sample < MAX_SAMPLES); sample++)
     {
-    tbuff = srcbuffs[sample];
-    if (tbuff != NULL)
-      _TIFFfree(tbuff);
+        tbuff = srcbuffs[sample];
+        if (tbuff != NULL)
+            _TIFFfree(tbuff);
     }
- 
-  return status;
-  }
+
+    return status;
+}
+
 
 static int writeBufferToContigStrips(TIFF* out, uint8* buf, uint32 imagelength)
   {

2025-02-03 22:05:27.155 | DEBUG    | scenario:rebuild:369 - original environment: environ({'CONDA_SHLVL': '2', 'LC_ALL': 'C.UTF-8', 'LS_COLORS': 'rs=0:di=01;34:ln=01;36:mh=00:pi=40;33:so=01;35:do=01;35:bd=40;33;01:cd=40;33;01:or=40;31;01:mi=00:su=37;41:sg=30;43:ca=30;41:tw=30;42:ow=34;42:st=37;44:ex=01;32:*.tar=01;31:*.tgz=01;31:*.arc=01;31:*.arj=01;31:*.taz=01;31:*.lha=01;31:*.lz4=01;31:*.lzh=01;31:*.lzma=01;31:*.tlz=01;31:*.txz=01;31:*.tzo=01;31:*.t7z=01;31:*.zip=01;31:*.z=01;31:*.Z=01;31:*.dz=01;31:*.gz=01;31:*.lrz=01;31:*.lz=01;31:*.lzo=01;31:*.xz=01;31:*.zst=01;31:*.tzst=01;31:*.bz2=01;31:*.bz=01;31:*.tbz=01;31:*.tbz2=01;31:*.tz=01;31:*.deb=01;31:*.rpm=01;31:*.jar=01;31:*.war=01;31:*.ear=01;31:*.sar=01;31:*.rar=01;31:*.alz=01;31:*.ace=01;31:*.zoo=01;31:*.cpio=01;31:*.7z=01;31:*.rz=01;31:*.cab=01;31:*.wim=01;31:*.swm=01;31:*.dwm=01;31:*.esd=01;31:*.jpg=01;35:*.jpeg=01;35:*.mjpg=01;35:*.mjpeg=01;35:*.gif=01;35:*.bmp=01;35:*.pbm=01;35:*.pgm=01;35:*.ppm=01;35:*.tga=01;35:*.xbm=01;35:*.xpm=01;35:*.tif=01;35:*.tiff=01;35:*.png=01;35:*.svg=01;35:*.svgz=01;35:*.mng=01;35:*.pcx=01;35:*.mov=01;35:*.mpg=01;35:*.mpeg=01;35:*.m2v=01;35:*.mkv=01;35:*.webm=01;35:*.ogm=01;35:*.mp4=01;35:*.m4v=01;35:*.mp4v=01;35:*.vob=01;35:*.qt=01;35:*.nuv=01;35:*.wmv=01;35:*.asf=01;35:*.rm=01;35:*.rmvb=01;35:*.flc=01;35:*.avi=01;35:*.fli=01;35:*.flv=01;35:*.gl=01;35:*.dl=01;35:*.xcf=01;35:*.xwd=01;35:*.yuv=01;35:*.cgm=01;35:*.emf=01;35:*.ogv=01;35:*.ogx=01;35:*.aac=00;36:*.au=00;36:*.flac=00;36:*.m4a=00;36:*.mid=00;36:*.midi=00;36:*.mka=00;36:*.mp3=00;36:*.mpc=00;36:*.ogg=00;36:*.ra=00;36:*.wav=00;36:*.oga=00;36:*.opus=00;36:*.spx=00;36:*.xspf=00;36:', 'LD_LIBRARY_PATH': '/opt/crashrepair/lib:/CrashRepair/lib:/klee/build/lib:', 'CONDA_EXE': '/root/anaconda3/bin/conda', 'LANG': 'C.UTF-8', 'TZ': 'Asia/Shanghai', 'HOSTNAME': 'fea22102047d', 'OLDPWD': '/orchestrator', 'CONDA_PREFIX': '/root/anaconda3/envs/CrashRepair', '_CE_M': '', 'CC': 'crepair-cc', 'LLVM_COMPILER': 'clang', 'CONDA_PREFIX_1': '/root/anaconda3', 'PWD': '/orchestrator/crashrepair', 'HOME': '/root', 'CONDA_PYTHON_EXE': '/root/anaconda3/bin/python', '_CE_CONDA': '', 'CONDA_PROMPT_MODIFIER': '(CrashRepair) ', 'CXX': 'crepair-cxx', 'TERM': 'xterm', 'SHLVL': '2', 'PYTHONPATH': '/usr/lib/python3.8/site-packages:', 'PATH': '/root/anaconda3/envs/CrashRepair/bin:/root/anaconda3/condabin:~/anaconda3/bin:/opt/crashrepair/bin:/CrashRepair/compiler:/klee/build/bin:/opt/llvm-6/bin:/klee/build/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', 'CONDA_DEFAULT_ENV': 'CrashRepair', '_': '/root/anaconda3/envs/CrashRepair/bin/python'})
2025-02-03 22:05:27.155 | DEBUG    | scenario:rebuild:382 - injecting ghost function into CFLAGS during build: -lcrepair_ghost
2025-02-03 22:05:27.155 | DEBUG    | scenario:rebuild:398 - using environment: {'INJECT_CFLAGS': '-g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address', 'INJECT_CXXFLAGS': '-g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address', 'INJECT_LDFLAGS': '-g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address'}
2025-02-03 22:05:27.155 | DEBUG    | shell:__call__:41 - executing: make CFLAGS="${INJECT_CFLAGS}" CXXFLAGS="${INJECT_CXXFLAGS}" LDFLAGS="${INJECT_LDFLAGS}"
Making all in port
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/port'
make[1]: Nothing to be done for 'all'.
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/port'
Making all in libtiff
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/libtiff'
make  all-am
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/libtiff'
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/libtiff'
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/libtiff'
Making all in tools
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/tools'
crepair-cc -DHAVE_CONFIG_H -I. -I../libtiff  -I../libtiff   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -MT tiffcrop.o -MD -MP -MF .deps/tiffcrop.Tpo -c -o tiffcrop.o tiffcrop.c
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_ghost: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
mv -f .deps/tiffcrop.Tpo .deps/tiffcrop.Po
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address  -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -o tiffcrop tiffcrop.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -g -O0 -Wno-error -I/CrashRepair/lib -fsanitize=address -g -O0 -Wno-error -I/CrashRepair/lib -fsanitize=address -o tiffcrop tiffcrop.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a ../port/.libs/libport.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -llzma -ljbig -ljpeg -lz -lm
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/tools'
Making all in build
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/build'
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/build'
make[2]: Nothing to be done for 'all-am'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/build'
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/build'
Making all in contrib
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib'
Making all in addtiffo
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/addtiffo'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/addtiffo'
Making all in dbs
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/dbs'
Making all in xtiff
make[3]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/dbs/xtiff'
make[3]: Nothing to be done for 'all'.
make[3]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/dbs/xtiff'
make[3]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/dbs'
make[3]: Nothing to be done for 'all-am'.
make[3]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/dbs'
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/dbs'
Making all in iptcutil
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/iptcutil'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/iptcutil'
Making all in mfs
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/mfs'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/mfs'
Making all in pds
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/pds'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/pds'
Making all in ras
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/ras'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/ras'
Making all in stream
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/stream'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/stream'
Making all in tags
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/tags'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/tags'
Making all in win_dib
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/win_dib'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/win_dib'
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib'
make[2]: Nothing to be done for 'all-am'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib'
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib'
Making all in test
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/test'
make[1]: Nothing to be done for 'all'.
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/test'
Making all in man
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/man'
make[1]: Nothing to be done for 'all'.
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/man'
Making all in html
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html'
Making all in images
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html/images'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html/images'
Making all in man
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html/man'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html/man'
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html'
make[2]: Nothing to be done for 'all-am'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html'
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html'
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src'
make[1]: Nothing to be done for 'all-am'.
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src'
2025-02-03 22:05:27.633 | DEBUG    | scenario:evaluate:655 - testing candidate #17 against test #crash...
2025-02-03 22:05:27.633 | DEBUG    | shell:__call__:41 - executing: /data/vulnloc/libtiff/CVE-2016-5321/src/tools/tiffcrop /CrashRepair/experiments/vulnloc/libtiff/CVE-2016-5321/tests/1.tif foo.tif
2025-02-03 22:05:27.646 | DEBUG    | test:run:189 - test failed: unexpected exit code (actual: 139, expected: 0)
2025-02-03 22:05:27.647 | INFO     | scenario:evaluate:662 - candidate #17 fails test #crash
2025-02-03 22:05:27.652 | INFO     | scenario:evaluate:635 - evaluating candidate patch #18:
@@ -948,11 +948,12 @@
   return status;
   }
 
-static int  readSeparateTilesIntoBuffer (TIFF* in, uint8 *obuf, 
-					 uint32 imagelength, uint32 imagewidth, 
+
+static int readSeparateTilesIntoBuffer (TIFF* in, uint8 *obuf, 
+                                         uint32 imagelength, uint32 imagewidth, 
                                          uint32 tw, uint32 tl,
                                          uint16 spp, uint16 bps)
-  {
+{
   int     i, status = 1, sample;
   int     shift_width, bytes_per_pixel;
   uint16  bytes_per_sample;
@@ -968,51 +969,42 @@
   bytes_per_sample = (bps + 7) / 8;
 
   for (sample = 0; (sample < spp) && (sample < MAX_SAMPLES); sample++)
-    {
+  {
     srcbuffs[sample] = NULL;
     tbuff = (unsigned char *)_TIFFmalloc(tilesize + 8);
     if (!tbuff)
-      {
+    {
       TIFFError ("readSeparateTilesIntoBuffer", 
                  "Unable to allocate tile read buffer for sample %d", sample);
       for (i = 0; i < sample; i++)
         _TIFFfree (srcbuffs[i]);
       return 0;
-      }
+    }
     srcbuffs[sample] = tbuff;
-    } 
-  /* Each tile contains only the data for a single plane
-   * arranged in scanlines of tw * bytes_per_sample bytes.
-   */
+  } 
+
   for (row = 0; row < imagelength; row += tl)
-    {
+  {
     nrow = (row + tl > imagelength) ? imagelength - row : tl;
     for (col = 0; col < imagewidth; col += tw)
-      {
+    {
       for (s = 0; s < spp; s++)
-        {  /* Read each plane of a tile set into srcbuffs[s] */
-	tbytes = TIFFReadTile(in, srcbuffs[s], col, row, 0, s);
-        if (tbytes < 0  && !ignore)
-          {
-	  TIFFError(TIFFFileName(in),
-                 "Error, can't read tile for row %lu col %lu, "
-		 "sample %lu",
-		 (unsigned long) col, (unsigned long) row,
-		 (unsigned long) s);
-		 status = 0;
-          for (sample = 0; (sample < spp) && (sample < MAX_SAMPLES); sample++)
-            {
-            tbuff = srcbuffs[sample];
-            if (tbuff != NULL)
-              _TIFFfree(tbuff);
-            }
-          return status;
-	  }
-	}
-     /* Tiles on the right edge may be padded out to tw 
-      * which must be a multiple of 16.
-      * Ncol represents the visible (non padding) portion.  
-      */
+      {
+        tbytes = TIFFReadTile(in, srcbuffs[s], col, row, 0, s);
+        if (tbytes < 0)
+        {
+          TIFFError(TIFFFileName(in),
+                     "Error, can't read tile for row %lu col %lu, "
+                     "sample %lu",
+                     (unsigned long) col, (unsigned long) row,
+                     (unsigned long) s);
+          status = 0;
+          break; // Added break to avoid fallthrough on error
+        }
+      }
+
+      if (status == 0) break; // Added break to exit outer loop on error
+
       if (col + tw > imagewidth)
         ncol = imagewidth - col;
       else
@@ -1023,16 +1015,16 @@
       bufp = obuf + row_offset + col_offset;
 
       if ((bps % 8) == 0)
-        {
+      {
         if (combineSeparateTileSamplesBytes(srcbuffs, bufp, ncol, nrow, imagewidth,
-					    tw, spp, bps, NULL, 0, 0))
-	  {
+                                             tw, spp, bps, NULL, 0, 0))
+        {
           status = 0;
           break;
-      	  }
-	}
+        }
+      }
       else
-        {
+      {
         bytes_per_pixel  = ((bps * spp) + 7) / 8;
         if (bytes_per_pixel < (bytes_per_sample + 1))
           shift_width = bytes_per_pixel;
@@ -1040,30 +1032,30 @@
           shift_width = bytes_per_sample + 1;
 
         switch (shift_width)
-          {
+        {
           case 1: if (combineSeparateTileSamples8bits (srcbuffs, bufp, ncol, nrow,
                                                        imagewidth, tw, spp, bps, 
-						       NULL, 0, 0))
-	            {
+                                                       NULL, 0, 0))
+                  {
                     status = 0;
                     break;
-      	            }
-	          break;
+                  }
+                  break;
           case 2: if (combineSeparateTileSamples16bits (srcbuffs, bufp, ncol, nrow,
                                                        imagewidth, tw, spp, bps, 
-						       NULL, 0, 0))
-	            {
+                                                       NULL, 0, 0))
+                  {
                     status = 0;
                     break;
-		    }
-	          break;
+                  }
+                  break;
           case 3: if (combineSeparateTileSamples24bits (srcbuffs, bufp, ncol, nrow,
                                                        imagewidth, tw, spp, bps, 
-						       NULL, 0, 0))
-	            {
+                                                       NULL, 0, 0))
+                  {
                     status = 0;
                     break;
-       	            }
+                  }
                   break;
           case 4: 
           case 5:
@@ -1071,30 +1063,32 @@
           case 7:
           case 8: if (combineSeparateTileSamples32bits (srcbuffs, bufp, ncol, nrow,
                                                        imagewidth, tw, spp, bps, 
-						       NULL, 0, 0))
-	            {
+                                                       NULL, 0, 0))
+                  {
                     status = 0;
                     break;
-		    }
-	          break;
+                  }
+                  break;
           default: TIFFError ("readSeparateTilesIntoBuffer", "Unsupported bit depth: %d", bps);
                   status = 0;
                   break;
-          }
         }
       }
     }
+    if (status == 0) break; // Added break to exit the row loop on error
+  }
 
   for (sample = 0; (sample < spp) && (sample < MAX_SAMPLES); sample++)
-    {
+  {
     tbuff = srcbuffs[sample];
     if (tbuff != NULL)
       _TIFFfree(tbuff);
-    }
- 
-  return status;
   }
 
+  return status;
+}
+
+
 static int writeBufferToContigStrips(TIFF* out, uint8* buf, uint32 imagelength)
   {
   uint32 row, nrows, rowsperstrip;

2025-02-03 22:05:27.657 | DEBUG    | scenario:rebuild:369 - original environment: environ({'CONDA_SHLVL': '2', 'LC_ALL': 'C.UTF-8', 'LS_COLORS': 'rs=0:di=01;34:ln=01;36:mh=00:pi=40;33:so=01;35:do=01;35:bd=40;33;01:cd=40;33;01:or=40;31;01:mi=00:su=37;41:sg=30;43:ca=30;41:tw=30;42:ow=34;42:st=37;44:ex=01;32:*.tar=01;31:*.tgz=01;31:*.arc=01;31:*.arj=01;31:*.taz=01;31:*.lha=01;31:*.lz4=01;31:*.lzh=01;31:*.lzma=01;31:*.tlz=01;31:*.txz=01;31:*.tzo=01;31:*.t7z=01;31:*.zip=01;31:*.z=01;31:*.Z=01;31:*.dz=01;31:*.gz=01;31:*.lrz=01;31:*.lz=01;31:*.lzo=01;31:*.xz=01;31:*.zst=01;31:*.tzst=01;31:*.bz2=01;31:*.bz=01;31:*.tbz=01;31:*.tbz2=01;31:*.tz=01;31:*.deb=01;31:*.rpm=01;31:*.jar=01;31:*.war=01;31:*.ear=01;31:*.sar=01;31:*.rar=01;31:*.alz=01;31:*.ace=01;31:*.zoo=01;31:*.cpio=01;31:*.7z=01;31:*.rz=01;31:*.cab=01;31:*.wim=01;31:*.swm=01;31:*.dwm=01;31:*.esd=01;31:*.jpg=01;35:*.jpeg=01;35:*.mjpg=01;35:*.mjpeg=01;35:*.gif=01;35:*.bmp=01;35:*.pbm=01;35:*.pgm=01;35:*.ppm=01;35:*.tga=01;35:*.xbm=01;35:*.xpm=01;35:*.tif=01;35:*.tiff=01;35:*.png=01;35:*.svg=01;35:*.svgz=01;35:*.mng=01;35:*.pcx=01;35:*.mov=01;35:*.mpg=01;35:*.mpeg=01;35:*.m2v=01;35:*.mkv=01;35:*.webm=01;35:*.ogm=01;35:*.mp4=01;35:*.m4v=01;35:*.mp4v=01;35:*.vob=01;35:*.qt=01;35:*.nuv=01;35:*.wmv=01;35:*.asf=01;35:*.rm=01;35:*.rmvb=01;35:*.flc=01;35:*.avi=01;35:*.fli=01;35:*.flv=01;35:*.gl=01;35:*.dl=01;35:*.xcf=01;35:*.xwd=01;35:*.yuv=01;35:*.cgm=01;35:*.emf=01;35:*.ogv=01;35:*.ogx=01;35:*.aac=00;36:*.au=00;36:*.flac=00;36:*.m4a=00;36:*.mid=00;36:*.midi=00;36:*.mka=00;36:*.mp3=00;36:*.mpc=00;36:*.ogg=00;36:*.ra=00;36:*.wav=00;36:*.oga=00;36:*.opus=00;36:*.spx=00;36:*.xspf=00;36:', 'LD_LIBRARY_PATH': '/opt/crashrepair/lib:/CrashRepair/lib:/klee/build/lib:', 'CONDA_EXE': '/root/anaconda3/bin/conda', 'LANG': 'C.UTF-8', 'TZ': 'Asia/Shanghai', 'HOSTNAME': 'fea22102047d', 'OLDPWD': '/orchestrator', 'CONDA_PREFIX': '/root/anaconda3/envs/CrashRepair', '_CE_M': '', 'CC': 'crepair-cc', 'LLVM_COMPILER': 'clang', 'CONDA_PREFIX_1': '/root/anaconda3', 'PWD': '/orchestrator/crashrepair', 'HOME': '/root', 'CONDA_PYTHON_EXE': '/root/anaconda3/bin/python', '_CE_CONDA': '', 'CONDA_PROMPT_MODIFIER': '(CrashRepair) ', 'CXX': 'crepair-cxx', 'TERM': 'xterm', 'SHLVL': '2', 'PYTHONPATH': '/usr/lib/python3.8/site-packages:', 'PATH': '/root/anaconda3/envs/CrashRepair/bin:/root/anaconda3/condabin:~/anaconda3/bin:/opt/crashrepair/bin:/CrashRepair/compiler:/klee/build/bin:/opt/llvm-6/bin:/klee/build/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', 'CONDA_DEFAULT_ENV': 'CrashRepair', '_': '/root/anaconda3/envs/CrashRepair/bin/python'})
2025-02-03 22:05:27.658 | DEBUG    | scenario:rebuild:382 - injecting ghost function into CFLAGS during build: -lcrepair_ghost
2025-02-03 22:05:27.658 | DEBUG    | scenario:rebuild:398 - using environment: {'INJECT_CFLAGS': '-g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address', 'INJECT_CXXFLAGS': '-g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address', 'INJECT_LDFLAGS': '-g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address'}
2025-02-03 22:05:27.658 | DEBUG    | shell:__call__:41 - executing: make CFLAGS="${INJECT_CFLAGS}" CXXFLAGS="${INJECT_CXXFLAGS}" LDFLAGS="${INJECT_LDFLAGS}"
Making all in port
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/port'
make[1]: Nothing to be done for 'all'.
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/port'
Making all in libtiff
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/libtiff'
make  all-am
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/libtiff'
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/libtiff'
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/libtiff'
Making all in tools
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/tools'
crepair-cc -DHAVE_CONFIG_H -I. -I../libtiff  -I../libtiff   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -MT tiffcrop.o -MD -MP -MF .deps/tiffcrop.Tpo -c -o tiffcrop.o tiffcrop.c
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_ghost: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
mv -f .deps/tiffcrop.Tpo .deps/tiffcrop.Po
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address  -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -o tiffcrop tiffcrop.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -g -O0 -Wno-error -I/CrashRepair/lib -fsanitize=address -g -O0 -Wno-error -I/CrashRepair/lib -fsanitize=address -o tiffcrop tiffcrop.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a ../port/.libs/libport.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -llzma -ljbig -ljpeg -lz -lm
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/tools'
Making all in build
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/build'
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/build'
make[2]: Nothing to be done for 'all-am'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/build'
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/build'
Making all in contrib
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib'
Making all in addtiffo
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/addtiffo'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/addtiffo'
Making all in dbs
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/dbs'
Making all in xtiff
make[3]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/dbs/xtiff'
make[3]: Nothing to be done for 'all'.
make[3]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/dbs/xtiff'
make[3]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/dbs'
make[3]: Nothing to be done for 'all-am'.
make[3]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/dbs'
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/dbs'
Making all in iptcutil
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/iptcutil'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/iptcutil'
Making all in mfs
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/mfs'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/mfs'
Making all in pds
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/pds'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/pds'
Making all in ras
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/ras'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/ras'
Making all in stream
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/stream'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/stream'
Making all in tags
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/tags'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/tags'
Making all in win_dib
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/win_dib'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/win_dib'
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib'
make[2]: Nothing to be done for 'all-am'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib'
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib'
Making all in test
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/test'
make[1]: Nothing to be done for 'all'.
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/test'
Making all in man
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/man'
make[1]: Nothing to be done for 'all'.
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/man'
Making all in html
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html'
Making all in images
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html/images'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html/images'
Making all in man
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html/man'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html/man'
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html'
make[2]: Nothing to be done for 'all-am'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html'
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html'
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src'
make[1]: Nothing to be done for 'all-am'.
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src'
2025-02-03 22:05:28.139 | DEBUG    | scenario:evaluate:655 - testing candidate #18 against test #crash...
2025-02-03 22:05:28.140 | DEBUG    | shell:__call__:41 - executing: /data/vulnloc/libtiff/CVE-2016-5321/src/tools/tiffcrop /CrashRepair/experiments/vulnloc/libtiff/CVE-2016-5321/tests/1.tif foo.tif
2025-02-03 22:05:28.149 | DEBUG    | test:run:189 - test failed: unexpected exit code (actual: 139, expected: 0)
2025-02-03 22:05:28.149 | INFO     | scenario:evaluate:662 - candidate #18 fails test #crash
2025-02-03 22:05:28.156 | INFO     | scenario:evaluate:635 - evaluating candidate patch #19:
@@ -948,152 +948,160 @@
   return status;
   }
 
-static int  readSeparateTilesIntoBuffer (TIFF* in, uint8 *obuf, 
-					 uint32 imagelength, uint32 imagewidth, 
+
+static int readSeparateTilesIntoBuffer (TIFF* in, uint8 *obuf, 
+                                         uint32 imagelength, uint32 imagewidth, 
                                          uint32 tw, uint32 tl,
                                          uint16 spp, uint16 bps)
-  {
-  int     i, status = 1, sample;
-  int     shift_width, bytes_per_pixel;
-  uint16  bytes_per_sample;
-  uint32  row, col;     /* Current row and col of image */
-  uint32  nrow, ncol;   /* Number of rows and cols in current tile */
-  uint32  row_offset, col_offset; /* Output buffer offsets */
-  tsize_t tbytes = 0, tilesize = TIFFTileSize(in);
-  tsample_t s;
-  uint8*  bufp = (uint8*)obuf;
-  unsigned char *srcbuffs[MAX_SAMPLES];
-  unsigned char *tbuff = NULL;
+{
+    int     i, status = 1, sample;
+    int     shift_width, bytes_per_pixel;
+    uint16  bytes_per_sample;
+    uint32  row, col;     /* Current row and col of image */
+    uint32  nrow, ncol;   /* Number of rows and cols in current tile */
+    uint32  row_offset, col_offset; /* Output buffer offsets */
+    tsize_t tbytes = 0, tilesize = TIFFTileSize(in);
+    tsample_t s;
+    uint8*  bufp = (uint8*)obuf;
+    unsigned char *srcbuffs[MAX_SAMPLES];
+    unsigned char *tbuff = NULL;
 
-  bytes_per_sample = (bps + 7) / 8;
+    bytes_per_sample = (bps + 7) / 8;
 
-  for (sample = 0; (sample < spp) && (sample < MAX_SAMPLES); sample++)
+    for (sample = 0; (sample < spp) && (sample < MAX_SAMPLES); sample++)
     {
-    srcbuffs[sample] = NULL;
-    tbuff = (unsigned char *)_TIFFmalloc(tilesize + 8);
-    if (!tbuff)
-      {
-      TIFFError ("readSeparateTilesIntoBuffer", 
-                 "Unable to allocate tile read buffer for sample %d", sample);
-      for (i = 0; i < sample; i++)
-        _TIFFfree (srcbuffs[i]);
-      return 0;
-      }
-    srcbuffs[sample] = tbuff;
+        srcbuffs[sample] = NULL;
+        tbuff = (unsigned char *)_TIFFmalloc(tilesize + 8);
+        if (!tbuff)
+        {
+            TIFFError ("readSeparateTilesIntoBuffer", 
+                        "Unable to allocate tile read buffer for sample %d", sample);
+            for (i = 0; i < sample; i++)
+                _TIFFfree (srcbuffs[i]);
+            return 0;
+        }
+        srcbuffs[sample] = tbuff;
     } 
-  /* Each tile contains only the data for a single plane
-   * arranged in scanlines of tw * bytes_per_sample bytes.
-   */
-  for (row = 0; row < imagelength; row += tl)
+    /* Each tile contains only the data for a single plane
+     * arranged in scanlines of tw * bytes_per_sample bytes.
+     */
+    for (row = 0; row < imagelength; row += tl)
     {
-    nrow = (row + tl > imagelength) ? imagelength - row : tl;
-    for (col = 0; col < imagewidth; col += tw)
-      {
-      for (s = 0; s < spp; s++)
-        {  /* Read each plane of a tile set into srcbuffs[s] */
-	tbytes = TIFFReadTile(in, srcbuffs[s], col, row, 0, s);
-        if (tbytes < 0  && !ignore)
-          {
-	  TIFFError(TIFFFileName(in),
-                 "Error, can't read tile for row %lu col %lu, "
-		 "sample %lu",
-		 (unsigned long) col, (unsigned long) row,
-		 (unsigned long) s);
-		 status = 0;
-          for (sample = 0; (sample < spp) && (sample < MAX_SAMPLES); sample++)
-            {
-            tbuff = srcbuffs[sample];
-            if (tbuff != NULL)
-              _TIFFfree(tbuff);
-            }
-          return status;
-	  }
-	}
-     /* Tiles on the right edge may be padded out to tw 
-      * which must be a multiple of 16.
-      * Ncol represents the visible (non padding) portion.  
-      */
-      if (col + tw > imagewidth)
-        ncol = imagewidth - col;
-      else
-        ncol = tw;
-
-      row_offset = row * (((imagewidth * spp * bps) + 7) / 8);
-      col_offset = ((col * spp * bps) + 7) / 8;
-      bufp = obuf + row_offset + col_offset;
-
-      if ((bps % 8) == 0)
-        {
-        if (combineSeparateTileSamplesBytes(srcbuffs, bufp, ncol, nrow, imagewidth,
-					    tw, spp, bps, NULL, 0, 0))
-	  {
-          status = 0;
-          break;
-      	  }
-	}
-      else
+        nrow = (row + tl > imagelength) ? imagelength - row : tl;
+        for (col = 0; col < imagewidth; col += tw)
         {
-        bytes_per_pixel  = ((bps * spp) + 7) / 8;
-        if (bytes_per_pixel < (bytes_per_sample + 1))
-          shift_width = bytes_per_pixel;
-        else
-          shift_width = bytes_per_sample + 1;
-
-        switch (shift_width)
-          {
-          case 1: if (combineSeparateTileSamples8bits (srcbuffs, bufp, ncol, nrow,
-                                                       imagewidth, tw, spp, bps, 
-						       NULL, 0, 0))
-	            {
-                    status = 0;
-                    break;
-      	            }
-	          break;
-          case 2: if (combineSeparateTileSamples16bits (srcbuffs, bufp, ncol, nrow,
-                                                       imagewidth, tw, spp, bps, 
-						       NULL, 0, 0))
-	            {
-                    status = 0;
-                    break;
-		    }
-	          break;
-          case 3: if (combineSeparateTileSamples24bits (srcbuffs, bufp, ncol, nrow,
-                                                       imagewidth, tw, spp, bps, 
-						       NULL, 0, 0))
-	            {
+            for (s = 0; s < spp; s++)
+            {  
+                /* Validate TIFFReadTile return value to avoid processing errors */
+                tbytes = TIFFReadTile(in, srcbuffs[s], col, row, 0, s);
+                if (tbytes == (tsize_t)-1) // Handle error condition
+                {
+                    TIFFError(TIFFFileName(in),
+                              "Error, can't read tile for row %lu col %lu, "
+                              "sample %lu",
+                              (unsigned long) col, (unsigned long) row,
+                              (unsigned long) s);
                     status = 0;
                     break;
-       	            }
-                  break;
-          case 4: 
-          case 5:
-          case 6:
-          case 7:
-          case 8: if (combineSeparateTileSamples32bits (srcbuffs, bufp, ncol, nrow,
-                                                       imagewidth, tw, spp, bps, 
-						       NULL, 0, 0))
-	            {
+                }
+                else if (tbytes == 0) // Handle a potential read failure
+                {
+                    TIFFError(TIFFFileName(in),
+                              "Warning, read no bytes for tile at row %lu col %lu, "
+                              "sample %lu",
+                              (unsigned long) col, (unsigned long) row,
+                              (unsigned long) s);
+                    // Continue without breaking the loop
+                }
+            }
+            if (status == 0) break; // Exit outer loop if there was an error
+            /* Tiles on the right edge may be padded out to tw 
+             * which must be a multiple of 16.
+             * Ncol represents the visible (non padding) portion.  
+             */
+            if (col + tw > imagewidth)
+                ncol = imagewidth - col;
+            else
+                ncol = tw;
+
+            row_offset = row * (((imagewidth * spp * bps) + 7) / 8);
+            col_offset = ((col * spp * bps) + 7) / 8;
+            bufp = obuf + row_offset + col_offset;
+
+            if ((bps % 8) == 0)
+            {
+                if (combineSeparateTileSamplesBytes(srcbuffs, bufp, ncol, nrow, imagewidth,
+                                                     tw, spp, bps, NULL, 0, 0))
+                {
                     status = 0;
                     break;
-		    }
-	          break;
-          default: TIFFError ("readSeparateTilesIntoBuffer", "Unsupported bit depth: %d", bps);
-                  status = 0;
-                  break;
-          }
+                }
+            }
+            else
+            {
+                bytes_per_pixel  = ((bps * spp) + 7) / 8;
+                if (bytes_per_pixel < (bytes_per_sample + 1))
+                    shift_width = bytes_per_pixel;
+                else
+                    shift_width = bytes_per_sample + 1;
+
+                switch (shift_width)
+                {
+                    case 1: if (combineSeparateTileSamples8bits (srcbuffs, bufp, ncol, nrow,
+                                                                 imagewidth, tw, spp, bps, 
+                                                                 NULL, 0, 0))
+                            {
+                                status = 0;
+                                break;
+                            }
+                            break;
+                    case 2: if (combineSeparateTileSamples16bits (srcbuffs, bufp, ncol, nrow,
+                                                                  imagewidth, tw, spp, bps, 
+                                                                  NULL, 0, 0))
+                            {
+                                status = 0;
+                                break;
+                            }
+                            break;
+                    case 3: if (combineSeparateTileSamples24bits (srcbuffs, bufp, ncol, nrow,
+                                                                  imagewidth, tw, spp, bps, 
+                                                                  NULL, 0, 0))
+                            {
+                                status = 0;
+                                break;
+                            }
+                            break;
+                    case 4: 
+                    case 5:
+                    case 6:
+                    case 7:
+                    case 8: if (combineSeparateTileSamples32bits (srcbuffs, bufp, ncol, nrow,
+                                                                  imagewidth, tw, spp, bps, 
+                                                                  NULL, 0, 0))
+                            {
+                                status = 0;
+                                break;
+                            }
+                            break;
+                    default: TIFFError ("readSeparateTilesIntoBuffer", "Unsupported bit depth: %d", bps);
+                             status = 0;
+                             break;
+                }
+            }
         }
-      }
+        if (status == 0) break; // Exit if there's an error in tile processing
     }
 
-  for (sample = 0; (sample < spp) && (sample < MAX_SAMPLES); sample++)
+    for (sample = 0; (sample < spp) && (sample < MAX_SAMPLES); sample++)
     {
-    tbuff = srcbuffs[sample];
-    if (tbuff != NULL)
-      _TIFFfree(tbuff);
+        tbuff = srcbuffs[sample];
+        if (tbuff != NULL)
+            _TIFFfree(tbuff);
     }
- 
-  return status;
-  }
+
+    return status;
+}
+
 
 static int writeBufferToContigStrips(TIFF* out, uint8* buf, uint32 imagelength)
   {

2025-02-03 22:05:28.162 | DEBUG    | scenario:rebuild:369 - original environment: environ({'CONDA_SHLVL': '2', 'LC_ALL': 'C.UTF-8', 'LS_COLORS': 'rs=0:di=01;34:ln=01;36:mh=00:pi=40;33:so=01;35:do=01;35:bd=40;33;01:cd=40;33;01:or=40;31;01:mi=00:su=37;41:sg=30;43:ca=30;41:tw=30;42:ow=34;42:st=37;44:ex=01;32:*.tar=01;31:*.tgz=01;31:*.arc=01;31:*.arj=01;31:*.taz=01;31:*.lha=01;31:*.lz4=01;31:*.lzh=01;31:*.lzma=01;31:*.tlz=01;31:*.txz=01;31:*.tzo=01;31:*.t7z=01;31:*.zip=01;31:*.z=01;31:*.Z=01;31:*.dz=01;31:*.gz=01;31:*.lrz=01;31:*.lz=01;31:*.lzo=01;31:*.xz=01;31:*.zst=01;31:*.tzst=01;31:*.bz2=01;31:*.bz=01;31:*.tbz=01;31:*.tbz2=01;31:*.tz=01;31:*.deb=01;31:*.rpm=01;31:*.jar=01;31:*.war=01;31:*.ear=01;31:*.sar=01;31:*.rar=01;31:*.alz=01;31:*.ace=01;31:*.zoo=01;31:*.cpio=01;31:*.7z=01;31:*.rz=01;31:*.cab=01;31:*.wim=01;31:*.swm=01;31:*.dwm=01;31:*.esd=01;31:*.jpg=01;35:*.jpeg=01;35:*.mjpg=01;35:*.mjpeg=01;35:*.gif=01;35:*.bmp=01;35:*.pbm=01;35:*.pgm=01;35:*.ppm=01;35:*.tga=01;35:*.xbm=01;35:*.xpm=01;35:*.tif=01;35:*.tiff=01;35:*.png=01;35:*.svg=01;35:*.svgz=01;35:*.mng=01;35:*.pcx=01;35:*.mov=01;35:*.mpg=01;35:*.mpeg=01;35:*.m2v=01;35:*.mkv=01;35:*.webm=01;35:*.ogm=01;35:*.mp4=01;35:*.m4v=01;35:*.mp4v=01;35:*.vob=01;35:*.qt=01;35:*.nuv=01;35:*.wmv=01;35:*.asf=01;35:*.rm=01;35:*.rmvb=01;35:*.flc=01;35:*.avi=01;35:*.fli=01;35:*.flv=01;35:*.gl=01;35:*.dl=01;35:*.xcf=01;35:*.xwd=01;35:*.yuv=01;35:*.cgm=01;35:*.emf=01;35:*.ogv=01;35:*.ogx=01;35:*.aac=00;36:*.au=00;36:*.flac=00;36:*.m4a=00;36:*.mid=00;36:*.midi=00;36:*.mka=00;36:*.mp3=00;36:*.mpc=00;36:*.ogg=00;36:*.ra=00;36:*.wav=00;36:*.oga=00;36:*.opus=00;36:*.spx=00;36:*.xspf=00;36:', 'LD_LIBRARY_PATH': '/opt/crashrepair/lib:/CrashRepair/lib:/klee/build/lib:', 'CONDA_EXE': '/root/anaconda3/bin/conda', 'LANG': 'C.UTF-8', 'TZ': 'Asia/Shanghai', 'HOSTNAME': 'fea22102047d', 'OLDPWD': '/orchestrator', 'CONDA_PREFIX': '/root/anaconda3/envs/CrashRepair', '_CE_M': '', 'CC': 'crepair-cc', 'LLVM_COMPILER': 'clang', 'CONDA_PREFIX_1': '/root/anaconda3', 'PWD': '/orchestrator/crashrepair', 'HOME': '/root', 'CONDA_PYTHON_EXE': '/root/anaconda3/bin/python', '_CE_CONDA': '', 'CONDA_PROMPT_MODIFIER': '(CrashRepair) ', 'CXX': 'crepair-cxx', 'TERM': 'xterm', 'SHLVL': '2', 'PYTHONPATH': '/usr/lib/python3.8/site-packages:', 'PATH': '/root/anaconda3/envs/CrashRepair/bin:/root/anaconda3/condabin:~/anaconda3/bin:/opt/crashrepair/bin:/CrashRepair/compiler:/klee/build/bin:/opt/llvm-6/bin:/klee/build/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', 'CONDA_DEFAULT_ENV': 'CrashRepair', '_': '/root/anaconda3/envs/CrashRepair/bin/python'})
2025-02-03 22:05:28.162 | DEBUG    | scenario:rebuild:382 - injecting ghost function into CFLAGS during build: -lcrepair_ghost
2025-02-03 22:05:28.162 | DEBUG    | scenario:rebuild:398 - using environment: {'INJECT_CFLAGS': '-g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address', 'INJECT_CXXFLAGS': '-g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address', 'INJECT_LDFLAGS': '-g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address'}
2025-02-03 22:05:28.162 | DEBUG    | shell:__call__:41 - executing: make CFLAGS="${INJECT_CFLAGS}" CXXFLAGS="${INJECT_CXXFLAGS}" LDFLAGS="${INJECT_LDFLAGS}"
Making all in port
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/port'
make[1]: Nothing to be done for 'all'.
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/port'
Making all in libtiff
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/libtiff'
make  all-am
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/libtiff'
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/libtiff'
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/libtiff'
Making all in tools
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/tools'
crepair-cc -DHAVE_CONFIG_H -I. -I../libtiff  -I../libtiff   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -MT tiffcrop.o -MD -MP -MF .deps/tiffcrop.Tpo -c -o tiffcrop.o tiffcrop.c
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_ghost: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
mv -f .deps/tiffcrop.Tpo .deps/tiffcrop.Po
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address  -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -o tiffcrop tiffcrop.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -g -O0 -Wno-error -I/CrashRepair/lib -fsanitize=address -g -O0 -Wno-error -I/CrashRepair/lib -fsanitize=address -o tiffcrop tiffcrop.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a ../port/.libs/libport.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -llzma -ljbig -ljpeg -lz -lm
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/tools'
Making all in build
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/build'
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/build'
make[2]: Nothing to be done for 'all-am'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/build'
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/build'
Making all in contrib
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib'
Making all in addtiffo
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/addtiffo'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/addtiffo'
Making all in dbs
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/dbs'
Making all in xtiff
make[3]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/dbs/xtiff'
make[3]: Nothing to be done for 'all'.
make[3]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/dbs/xtiff'
make[3]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/dbs'
make[3]: Nothing to be done for 'all-am'.
make[3]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/dbs'
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/dbs'
Making all in iptcutil
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/iptcutil'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/iptcutil'
Making all in mfs
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/mfs'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/mfs'
Making all in pds
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/pds'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/pds'
Making all in ras
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/ras'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/ras'
Making all in stream
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/stream'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/stream'
Making all in tags
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/tags'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/tags'
Making all in win_dib
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/win_dib'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/win_dib'
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib'
make[2]: Nothing to be done for 'all-am'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib'
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib'
Making all in test
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/test'
make[1]: Nothing to be done for 'all'.
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/test'
Making all in man
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/man'
make[1]: Nothing to be done for 'all'.
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/man'
Making all in html
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html'
Making all in images
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html/images'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html/images'
Making all in man
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html/man'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html/man'
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html'
make[2]: Nothing to be done for 'all-am'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html'
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html'
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src'
make[1]: Nothing to be done for 'all-am'.
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src'
2025-02-03 22:05:28.646 | DEBUG    | scenario:evaluate:655 - testing candidate #19 against test #crash...
2025-02-03 22:05:28.646 | DEBUG    | shell:__call__:41 - executing: /data/vulnloc/libtiff/CVE-2016-5321/src/tools/tiffcrop /CrashRepair/experiments/vulnloc/libtiff/CVE-2016-5321/tests/1.tif foo.tif
2025-02-03 22:05:28.653 | DEBUG    | test:run:189 - test failed: unexpected exit code (actual: 139, expected: 0)
2025-02-03 22:05:28.653 | INFO     | scenario:evaluate:662 - candidate #19 fails test #crash
2025-02-03 22:05:28.661 | INFO     | scenario:analyze_for_guide:558 - reanalyzing candidate patch: #0:
@@ -948,152 +948,159 @@
   return status;
   }
 
-static int  readSeparateTilesIntoBuffer (TIFF* in, uint8 *obuf, 
-					 uint32 imagelength, uint32 imagewidth, 
-                                         uint32 tw, uint32 tl,
-                                         uint16 spp, uint16 bps)
-  {
-  int     i, status = 1, sample;
-  int     shift_width, bytes_per_pixel;
-  uint16  bytes_per_sample;
-  uint32  row, col;     /* Current row and col of image */
-  uint32  nrow, ncol;   /* Number of rows and cols in current tile */
-  uint32  row_offset, col_offset; /* Output buffer offsets */
-  tsize_t tbytes = 0, tilesize = TIFFTileSize(in);
-  tsample_t s;
-  uint8*  bufp = (uint8*)obuf;
-  unsigned char *srcbuffs[MAX_SAMPLES];
-  unsigned char *tbuff = NULL;
 
-  bytes_per_sample = (bps + 7) / 8;
+static int readSeparateTilesIntoBuffer(TIFF* in, uint8 *obuf, 
+                                       uint32 imagelength, uint32 imagewidth, 
+                                       uint32 tw, uint32 tl,
+                                       uint16 spp, uint16 bps)
+{
+    int i, status = 1, sample;
+    int shift_width, bytes_per_pixel;
+    uint16 bytes_per_sample;
+    uint32 row, col;     /* Current row and col of image */
+    uint32 nrow, ncol;   /* Number of rows and cols in current tile */
+    uint32 row_offset, col_offset; /* Output buffer offsets */
+    tsize_t tbytes = 0, tilesize = TIFFTileSize(in);
+    tsample_t s;
+    uint8* bufp = (uint8*)obuf;
+    unsigned char *srcbuffs[MAX_SAMPLES];
+    unsigned char *tbuff = NULL;
+
+    bytes_per_sample = (bps + 7) / 8;
+
+    if (spp > MAX_SAMPLES) {
+        TIFFError("readSeparateTilesIntoBuffer", "Sample per pixel exceeds max samples");
+        return 0;
+    }
 
-  for (sample = 0; (sample < spp) && (sample < MAX_SAMPLES); sample++)
+    for (sample = 0; (sample < spp) && (sample < MAX_SAMPLES); sample++)
     {
-    srcbuffs[sample] = NULL;
-    tbuff = (unsigned char *)_TIFFmalloc(tilesize + 8);
-    if (!tbuff)
-      {
-      TIFFError ("readSeparateTilesIntoBuffer", 
-                 "Unable to allocate tile read buffer for sample %d", sample);
-      for (i = 0; i < sample; i++)
-        _TIFFfree (srcbuffs[i]);
-      return 0;
-      }
-    srcbuffs[sample] = tbuff;
+        srcbuffs[sample] = NULL;
+        tbuff = (unsigned char *)_TIFFmalloc(tilesize + 8);
+        if (!tbuff)
+        {
+            TIFFError("readSeparateTilesIntoBuffer", 
+                       "Unable to allocate tile read buffer for sample %d", sample);
+            for (i = 0; i < sample; i++)
+                _TIFFfree(srcbuffs[i]);
+            return 0;
+        }
+        srcbuffs[sample] = tbuff;
     } 
-  /* Each tile contains only the data for a single plane
-   * arranged in scanlines of tw * bytes_per_sample bytes.
-   */
-  for (row = 0; row < imagelength; row += tl)
+    /* Each tile contains only the data for a single plane
+     * arranged in scanlines of tw * bytes_per_sample bytes.
+     */
+    for (row = 0; row < imagelength; row += tl)
     {
-    nrow = (row + tl > imagelength) ? imagelength - row : tl;
-    for (col = 0; col < imagewidth; col += tw)
-      {
-      for (s = 0; s < spp; s++)
-        {  /* Read each plane of a tile set into srcbuffs[s] */
-	tbytes = TIFFReadTile(in, srcbuffs[s], col, row, 0, s);
-        if (tbytes < 0  && !ignore)
-          {
-	  TIFFError(TIFFFileName(in),
-                 "Error, can't read tile for row %lu col %lu, "
-		 "sample %lu",
-		 (unsigned long) col, (unsigned long) row,
-		 (unsigned long) s);
-		 status = 0;
-          for (sample = 0; (sample < spp) && (sample < MAX_SAMPLES); sample++)
-            {
-            tbuff = srcbuffs[sample];
-            if (tbuff != NULL)
-              _TIFFfree(tbuff);
-            }
-          return status;
-	  }
-	}
-     /* Tiles on the right edge may be padded out to tw 
-      * which must be a multiple of 16.
-      * Ncol represents the visible (non padding) portion.  
-      */
-      if (col + tw > imagewidth)
-        ncol = imagewidth - col;
-      else
-        ncol = tw;
-
-      row_offset = row * (((imagewidth * spp * bps) + 7) / 8);
-      col_offset = ((col * spp * bps) + 7) / 8;
-      bufp = obuf + row_offset + col_offset;
-
-      if ((bps % 8) == 0)
-        {
-        if (combineSeparateTileSamplesBytes(srcbuffs, bufp, ncol, nrow, imagewidth,
-					    tw, spp, bps, NULL, 0, 0))
-	  {
-          status = 0;
-          break;
-      	  }
-	}
-      else
+        nrow = (row + tl > imagelength) ? imagelength - row : tl;
+        for (col = 0; col < imagewidth; col += tw)
         {
-        bytes_per_pixel  = ((bps * spp) + 7) / 8;
-        if (bytes_per_pixel < (bytes_per_sample + 1))
-          shift_width = bytes_per_pixel;
-        else
-          shift_width = bytes_per_sample + 1;
-
-        switch (shift_width)
-          {
-          case 1: if (combineSeparateTileSamples8bits (srcbuffs, bufp, ncol, nrow,
-                                                       imagewidth, tw, spp, bps, 
-						       NULL, 0, 0))
-	            {
-                    status = 0;
-                    break;
-      	            }
-	          break;
-          case 2: if (combineSeparateTileSamples16bits (srcbuffs, bufp, ncol, nrow,
-                                                       imagewidth, tw, spp, bps, 
-						       NULL, 0, 0))
-	            {
-                    status = 0;
-                    break;
-		    }
-	          break;
-          case 3: if (combineSeparateTileSamples24bits (srcbuffs, bufp, ncol, nrow,
-                                                       imagewidth, tw, spp, bps, 
-						       NULL, 0, 0))
-	            {
+            for (s = 0; s < spp && s < MAX_SAMPLES; s++)
+            {  /* Read each plane of a tile set into srcbuffs[s] */
+                tbytes = TIFFReadTile(in, srcbuffs[s], col, row, 0, s);
+                if (tbytes < 0  && !ignore)
+                {
+                    TIFFError(TIFFFileName(in),
+                               "Error, can't read tile for row %lu col %lu, "
+                               "sample %lu",
+                               (unsigned long)col, (unsigned long)row,
+                               (unsigned long)s);
                     status = 0;
-                    break;
-       	            }
-                  break;
-          case 4: 
-          case 5:
-          case 6:
-          case 7:
-          case 8: if (combineSeparateTileSamples32bits (srcbuffs, bufp, ncol, nrow,
-                                                       imagewidth, tw, spp, bps, 
-						       NULL, 0, 0))
-	            {
+                    for (sample = 0; (sample < spp) && (sample < MAX_SAMPLES); sample++)
+                    {
+                        tbuff = srcbuffs[sample];
+                        if (tbuff != NULL)
+                            _TIFFfree(tbuff);
+                    }
+                    return status;
+                }
+            }
+            /* Tiles on the right edge may be padded out to tw 
+             * which must be a multiple of 16.
+             * Ncol represents the visible (non padding) portion.  
+             */
+            if (col + tw > imagewidth)
+                ncol = imagewidth - col;
+            else
+                ncol = tw;
+
+            row_offset = row * (((imagewidth * spp * bps) + 7) / 8);
+            col_offset = ((col * spp * bps) + 7) / 8;
+            bufp = obuf + row_offset + col_offset;
+
+            if ((bps % 8) == 0)
+            {
+                if (combineSeparateTileSamplesBytes(srcbuffs, bufp, ncol, nrow, imagewidth,
+                                                     tw, spp, bps, NULL, 0, 0))
+                {
                     status = 0;
                     break;
-		    }
-	          break;
-          default: TIFFError ("readSeparateTilesIntoBuffer", "Unsupported bit depth: %d", bps);
-                  status = 0;
-                  break;
-          }
+                }
+            }
+            else
+            {
+                bytes_per_pixel  = ((bps * spp) + 7) / 8;
+                if (bytes_per_pixel < (bytes_per_sample + 1))
+                    shift_width = bytes_per_pixel;
+                else
+                    shift_width = bytes_per_sample + 1;
+
+                switch (shift_width)
+                {
+                    case 1: if (combineSeparateTileSamples8bits(srcbuffs, bufp, ncol, nrow,
+                                                                imagewidth, tw, spp, bps, 
+                                                                NULL, 0, 0))
+                            {
+                                status = 0;
+                                break;
+                            }
+                            break;
+                    case 2: if (combineSeparateTileSamples16bits(srcbuffs, bufp, ncol, nrow,
+                                                                  imagewidth, tw, spp, bps, 
+                                                                  NULL, 0, 0))
+                            {
+                                status = 0;
+                                break;
+                            }
+                            break;
+                    case 3: if (combineSeparateTileSamples24bits(srcbuffs, bufp, ncol, nrow,
+                                                                  imagewidth, tw, spp, bps, 
+                                                                  NULL, 0, 0))
+                            {
+                                status = 0;
+                                break;
+                            }
+                            break;
+                    case 4: 
+                    case 5:
+                    case 6:
+                    case 7:
+                    case 8: if (combineSeparateTileSamples32bits(srcbuffs, bufp, ncol, nrow,
+                                                                  imagewidth, tw, spp, bps, 
+                                                                  NULL, 0, 0))
+                            {
+                                status = 0;
+                                break;
+                            }
+                            break;
+                    default: TIFFError("readSeparateTilesIntoBuffer", "Unsupported bit depth: %d", bps);
+                             status = 0;
+                             break;
+                }
+            }
         }
-      }
     }
 
-  for (sample = 0; (sample < spp) && (sample < MAX_SAMPLES); sample++)
+    for (sample = 0; (sample < spp) && (sample < MAX_SAMPLES); sample++)
     {
-    tbuff = srcbuffs[sample];
-    if (tbuff != NULL)
-      _TIFFfree(tbuff);
+        tbuff = srcbuffs[sample];
+        if (tbuff != NULL)
+            _TIFFfree(tbuff);
     }
- 
-  return status;
-  }
+
+    return status;
+}
+
 
 static int writeBufferToContigStrips(TIFF* out, uint8* buf, uint32 imagelength)
   {

2025-02-03 22:05:28.670 | DEBUG    | scenario:rebuild:369 - original environment: environ({'CONDA_SHLVL': '2', 'LC_ALL': 'C.UTF-8', 'LS_COLORS': 'rs=0:di=01;34:ln=01;36:mh=00:pi=40;33:so=01;35:do=01;35:bd=40;33;01:cd=40;33;01:or=40;31;01:mi=00:su=37;41:sg=30;43:ca=30;41:tw=30;42:ow=34;42:st=37;44:ex=01;32:*.tar=01;31:*.tgz=01;31:*.arc=01;31:*.arj=01;31:*.taz=01;31:*.lha=01;31:*.lz4=01;31:*.lzh=01;31:*.lzma=01;31:*.tlz=01;31:*.txz=01;31:*.tzo=01;31:*.t7z=01;31:*.zip=01;31:*.z=01;31:*.Z=01;31:*.dz=01;31:*.gz=01;31:*.lrz=01;31:*.lz=01;31:*.lzo=01;31:*.xz=01;31:*.zst=01;31:*.tzst=01;31:*.bz2=01;31:*.bz=01;31:*.tbz=01;31:*.tbz2=01;31:*.tz=01;31:*.deb=01;31:*.rpm=01;31:*.jar=01;31:*.war=01;31:*.ear=01;31:*.sar=01;31:*.rar=01;31:*.alz=01;31:*.ace=01;31:*.zoo=01;31:*.cpio=01;31:*.7z=01;31:*.rz=01;31:*.cab=01;31:*.wim=01;31:*.swm=01;31:*.dwm=01;31:*.esd=01;31:*.jpg=01;35:*.jpeg=01;35:*.mjpg=01;35:*.mjpeg=01;35:*.gif=01;35:*.bmp=01;35:*.pbm=01;35:*.pgm=01;35:*.ppm=01;35:*.tga=01;35:*.xbm=01;35:*.xpm=01;35:*.tif=01;35:*.tiff=01;35:*.png=01;35:*.svg=01;35:*.svgz=01;35:*.mng=01;35:*.pcx=01;35:*.mov=01;35:*.mpg=01;35:*.mpeg=01;35:*.m2v=01;35:*.mkv=01;35:*.webm=01;35:*.ogm=01;35:*.mp4=01;35:*.m4v=01;35:*.mp4v=01;35:*.vob=01;35:*.qt=01;35:*.nuv=01;35:*.wmv=01;35:*.asf=01;35:*.rm=01;35:*.rmvb=01;35:*.flc=01;35:*.avi=01;35:*.fli=01;35:*.flv=01;35:*.gl=01;35:*.dl=01;35:*.xcf=01;35:*.xwd=01;35:*.yuv=01;35:*.cgm=01;35:*.emf=01;35:*.ogv=01;35:*.ogx=01;35:*.aac=00;36:*.au=00;36:*.flac=00;36:*.m4a=00;36:*.mid=00;36:*.midi=00;36:*.mka=00;36:*.mp3=00;36:*.mpc=00;36:*.ogg=00;36:*.ra=00;36:*.wav=00;36:*.oga=00;36:*.opus=00;36:*.spx=00;36:*.xspf=00;36:', 'LD_LIBRARY_PATH': '/opt/crashrepair/lib:/CrashRepair/lib:/klee/build/lib:', 'CONDA_EXE': '/root/anaconda3/bin/conda', 'LANG': 'C.UTF-8', 'TZ': 'Asia/Shanghai', 'HOSTNAME': 'fea22102047d', 'OLDPWD': '/orchestrator', 'CONDA_PREFIX': '/root/anaconda3/envs/CrashRepair', '_CE_M': '', 'CC': 'crepair-cc', 'LLVM_COMPILER': 'clang', 'CONDA_PREFIX_1': '/root/anaconda3', 'PWD': '/orchestrator/crashrepair', 'HOME': '/root', 'CONDA_PYTHON_EXE': '/root/anaconda3/bin/python', '_CE_CONDA': '', 'CONDA_PROMPT_MODIFIER': '(CrashRepair) ', 'CXX': 'crepair-cxx', 'TERM': 'xterm', 'SHLVL': '2', 'PYTHONPATH': '/usr/lib/python3.8/site-packages:', 'PATH': '/root/anaconda3/envs/CrashRepair/bin:/root/anaconda3/condabin:~/anaconda3/bin:/opt/crashrepair/bin:/CrashRepair/compiler:/klee/build/bin:/opt/llvm-6/bin:/klee/build/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', 'CONDA_DEFAULT_ENV': 'CrashRepair', '_': '/root/anaconda3/envs/CrashRepair/bin/python'})
2025-02-03 22:05:28.670 | DEBUG    | scenario:rebuild:382 - injecting ghost function into CFLAGS during build: -lcrepair_ghost
2025-02-03 22:05:28.670 | DEBUG    | scenario:rebuild:398 - using environment: {'INJECT_CFLAGS': '-g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address', 'INJECT_CXXFLAGS': '-g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address', 'INJECT_LDFLAGS': '-g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address'}
2025-02-03 22:05:28.670 | DEBUG    | shell:__call__:41 - executing: make CFLAGS="${INJECT_CFLAGS}" CXXFLAGS="${INJECT_CXXFLAGS}" LDFLAGS="${INJECT_LDFLAGS}"
Making all in port
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/port'
make[1]: Nothing to be done for 'all'.
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/port'
Making all in libtiff
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/libtiff'
make  all-am
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/libtiff'
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/libtiff'
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/libtiff'
Making all in tools
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/tools'
crepair-cc -DHAVE_CONFIG_H -I. -I../libtiff  -I../libtiff   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -MT tiffcrop.o -MD -MP -MF .deps/tiffcrop.Tpo -c -o tiffcrop.o tiffcrop.c
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_ghost: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
mv -f .deps/tiffcrop.Tpo .deps/tiffcrop.Po
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address  -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -o tiffcrop tiffcrop.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -g -O0 -Wno-error -I/CrashRepair/lib -fsanitize=address -g -O0 -Wno-error -I/CrashRepair/lib -fsanitize=address -o tiffcrop tiffcrop.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a ../port/.libs/libport.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -llzma -ljbig -ljpeg -lz -lm
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/tools'
Making all in build
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/build'
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/build'
make[2]: Nothing to be done for 'all-am'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/build'
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/build'
Making all in contrib
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib'
Making all in addtiffo
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/addtiffo'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/addtiffo'
Making all in dbs
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/dbs'
Making all in xtiff
make[3]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/dbs/xtiff'
make[3]: Nothing to be done for 'all'.
make[3]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/dbs/xtiff'
make[3]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/dbs'
make[3]: Nothing to be done for 'all-am'.
make[3]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/dbs'
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/dbs'
Making all in iptcutil
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/iptcutil'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/iptcutil'
Making all in mfs
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/mfs'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/mfs'
Making all in pds
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/pds'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/pds'
Making all in ras
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/ras'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/ras'
Making all in stream
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/stream'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/stream'
Making all in tags
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/tags'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/tags'
Making all in win_dib
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/win_dib'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/win_dib'
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib'
make[2]: Nothing to be done for 'all-am'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib'
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib'
Making all in test
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/test'
make[1]: Nothing to be done for 'all'.
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/test'
Making all in man
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/man'
make[1]: Nothing to be done for 'all'.
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/man'
Making all in html
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html'
Making all in images
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html/images'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html/images'
Making all in man
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html/man'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html/man'
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html'
make[2]: Nothing to be done for 'all-am'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html'
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html'
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src'
make[1]: Nothing to be done for 'all-am'.
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src'
2025-02-03 22:05:29.160 | INFO     | analyzer:run:114 - running analysis with timeout: 60 minutes
2025-02-03 22:05:29.160 | DEBUG    | analyzer:write_config_to_file:88 - generated analyzer config:

dir_exp:/data/vulnloc/libtiff/CVE-2016-5321
tag_id:libtiff_CVE-2016-5321
src_directory:/data/vulnloc/libtiff/CVE-2016-5321/src
binary_path:/data/vulnloc/libtiff/CVE-2016-5321/src/tools/tiffcrop
config_command:./configure --enable-static --disable-shared
build_command:make CFLAGS="${INJECT_CFLAGS}" CXXFLAGS="${INJECT_CXXFLAGS}" LDFLAGS="${INJECT_LDFLAGS}"
test_input_list:$POC foo.tif
poc_list:/CrashRepair/experiments/vulnloc/libtiff/CVE-2016-5321/tests/1.tif
klee_flags:--link-llvm-lib=/CrashRepair/lib/libcrepair_proxy.bca 

2025-02-03 22:05:29.160 | DEBUG    | analyzer:run:124 - wrote analyzer config file to: /tmp/tmpuzww7ftw
2025-02-03 22:05:29.160 | DEBUG    | shell:__call__:41 - executing: crepair --conf=/tmp/tmpuzww7ftw
[K[1;36m
====================================================================================================

	Starting CRepair (C Crash Repair) 
====================================================================================================
[0m
[K[1;36m
	Loading Configurations
	__________________________________________________________________________________________
[0m
[K	[1;34mreading configuration values from arguments[0m
[K	[1;34mreading configuration values form configuration file[0m
[K	[1;37m	[file] /tmp/tmpuzww7ftw[0m
[K	[1;34mupdating configuration values[0m
[K	[1;34mreading test configuration[0m
[K	[1;34mreading seed information[0m
[K	[1;37m	[config] stack size: 15000[0m
[K	[1;37m	[config] collecting stats: False[0m
[K	[1;37m	[config] number of tests: 1[0m
[K	[1;37m	[config] number of cores: 8[0m
[K	[1;37m	[config] klee concrete execution timeout: 600[0m
[K	[1;37m	[config] klee concolic execution timeout: 1200[0m
[K	[1;37m	[config] synthesize subset expressions: True[0m
[K	[1;37m	[config] window size for taint locations: 500[0m
[K	[1;37m	[config] window size for taint values: 500000[0m
[K[1;36m

	Analyzing Program
====================================================================================================
[0m
[K[1;36m
	Test Case #1
	__________________________________________________________________________________________
[0m
[K[1;36m
		Running Concrete Execution
		------------------------------------------------------------------------------------------
[0m
[K	[1;37m	[0m[K     [1;37mUsing Arguments: ['$POC', 'foo.tif'][0m
[K	[1;37m	[0m[K     [1;37mUsing Input File: /CrashRepair/experiments/vulnloc/libtiff/CVE-2016-5321/tests/1.tif[0m
[K	[1;34m	building program[0m
[K	[1;34m		setting environment variables[0m
[K	[1;34m		cleaning files[0m
[K	[1;34m		configuring program[0m
[K	[1;34m		compiling program[0m
[K	[1;37m	[0m[K     [1;37mUsing Binary: /data/vulnloc/libtiff/CVE-2016-5321/src/tools/tiffcrop[0m
[K	[1;34m	extracting bytecode[0m
[K	[1;34m	executing klee in concrete mode[0m
[K	[1;34m	extracting instruction trace[0m
[K	[1;37m		[note] program did not crash[0m
[K	[1;33m		[note]: the program did not crash[0m
[K	[1;37m
Run time statistics:
-----------------------
[0m
[K	[1;37mStartup: 0.000 minutes[0m
[K	[1;37mBuild: 0 minutes[0m
[K	[1;37mConcrete Analysis: 0 minutes[0m
[K	[1;37mConcolic Analysis: 0 minutes[0m
[K	[1;37mTotal Analysis: 0 minutes[0m
[K	[1;37mLocalization: 0 minutes[0m
[K[1;32m
CRepair finished successfully after 0.439 minutes 
[0m
2025-02-03 22:05:55.928 | INFO     | scenario:analyze_for_guide:592 - analysis failed for candidate patch #0: analysis failed: no localization file was produced
2025-02-03 22:05:55.936 | INFO     | scenario:analyze_for_guide:558 - reanalyzing candidate patch: #1:
@@ -948,152 +948,163 @@
   return status;
   }
 
-static int  readSeparateTilesIntoBuffer (TIFF* in, uint8 *obuf, 
-					 uint32 imagelength, uint32 imagewidth, 
+
+static int readSeparateTilesIntoBuffer (TIFF* in, uint8 *obuf, 
+                                         uint32 imagelength, uint32 imagewidth, 
                                          uint32 tw, uint32 tl,
                                          uint16 spp, uint16 bps)
-  {
-  int     i, status = 1, sample;
-  int     shift_width, bytes_per_pixel;
-  uint16  bytes_per_sample;
-  uint32  row, col;     /* Current row and col of image */
-  uint32  nrow, ncol;   /* Number of rows and cols in current tile */
-  uint32  row_offset, col_offset; /* Output buffer offsets */
-  tsize_t tbytes = 0, tilesize = TIFFTileSize(in);
-  tsample_t s;
-  uint8*  bufp = (uint8*)obuf;
-  unsigned char *srcbuffs[MAX_SAMPLES];
-  unsigned char *tbuff = NULL;
-
-  bytes_per_sample = (bps + 7) / 8;
+{
+    int i, status = 1, sample;
+    int shift_width, bytes_per_pixel;
+    uint16 bytes_per_sample;
+    uint32 row, col;     /* Current row and col of image */
+    uint32 nrow, ncol;   /* Number of rows and cols in current tile */
+    uint32 row_offset, col_offset; /* Output buffer offsets */
+    tsize_t tbytes = 0, tilesize = TIFFTileSize(in);
+    tsample_t s;
+    uint8* bufp = (uint8*)obuf;
+    unsigned char *srcbuffs[MAX_SAMPLES];
+    unsigned char *tbuff = NULL;
+
+    bytes_per_sample = (bps + 7) / 8;
+
+    if (spp > MAX_SAMPLES) {
+        TIFFError("readSeparateTilesIntoBuffer", "Number of Samples exceeds MAX_SAMPLES");
+        return 0;
+    }
 
-  for (sample = 0; (sample < spp) && (sample < MAX_SAMPLES); sample++)
+    for (sample = 0; (sample < spp) && (sample < MAX_SAMPLES); sample++)
     {
-    srcbuffs[sample] = NULL;
-    tbuff = (unsigned char *)_TIFFmalloc(tilesize + 8);
-    if (!tbuff)
-      {
-      TIFFError ("readSeparateTilesIntoBuffer", 
-                 "Unable to allocate tile read buffer for sample %d", sample);
-      for (i = 0; i < sample; i++)
-        _TIFFfree (srcbuffs[i]);
-      return 0;
-      }
-    srcbuffs[sample] = tbuff;
+        srcbuffs[sample] = NULL;
+        tbuff = (unsigned char *)_TIFFmalloc(tilesize + 8);
+        if (!tbuff)
+        {
+            TIFFError("readSeparateTilesIntoBuffer", 
+                       "Unable to allocate tile read buffer for sample %d", sample);
+            for (i = 0; i < sample; i++)
+                _TIFFfree(srcbuffs[i]);
+            return 0;
+        }
+        srcbuffs[sample] = tbuff;
     } 
-  /* Each tile contains only the data for a single plane
-   * arranged in scanlines of tw * bytes_per_sample bytes.
-   */
-  for (row = 0; row < imagelength; row += tl)
+    /* Each tile contains only the data for a single plane
+     * arranged in scanlines of tw * bytes_per_sample bytes.
+     */
+    for (row = 0; row < imagelength; row += tl)
     {
-    nrow = (row + tl > imagelength) ? imagelength - row : tl;
-    for (col = 0; col < imagewidth; col += tw)
-      {
-      for (s = 0; s < spp; s++)
-        {  /* Read each plane of a tile set into srcbuffs[s] */
-	tbytes = TIFFReadTile(in, srcbuffs[s], col, row, 0, s);
-        if (tbytes < 0  && !ignore)
-          {
-	  TIFFError(TIFFFileName(in),
-                 "Error, can't read tile for row %lu col %lu, "
-		 "sample %lu",
-		 (unsigned long) col, (unsigned long) row,
-		 (unsigned long) s);
-		 status = 0;
-          for (sample = 0; (sample < spp) && (sample < MAX_SAMPLES); sample++)
-            {
-            tbuff = srcbuffs[sample];
-            if (tbuff != NULL)
-              _TIFFfree(tbuff);
+        nrow = (row + tl > imagelength) ? imagelength - row : tl;
+        for (col = 0; col < imagewidth; col += tw)
+        {
+            if (spp > MAX_SAMPLES) {
+                TIFFError("readSeparateTilesIntoBuffer", "Number of Samples exceeds MAX_SAMPLES");
+                return 0;
+            }
+            for (s = 0; s < spp; s++)
+            {  /* Read each plane of a tile set into srcbuffs[s] */
+                tbytes = TIFFReadTile(in, srcbuffs[s], col, row, 0, s);
+                if (tbytes < 0  && !ignore)
+                {
+                    TIFFError(TIFFFileName(in),
+                              "Error, can't read tile for row %lu col %lu, "
+                              "sample %lu",
+                              (unsigned long) col, (unsigned long) row,
+                              (unsigned long) s);
+                    status = 0;
+                    for (sample = 0; (sample < spp) && (sample < MAX_SAMPLES); sample++)
+                    {
+                        tbuff = srcbuffs[sample];
+                        if (tbuff != NULL)
+                            _TIFFfree(tbuff);
+                    }
+                    return status;
+                }
             }
-          return status;
-	  }
-	}
-     /* Tiles on the right edge may be padded out to tw 
-      * which must be a multiple of 16.
-      * Ncol represents the visible (non padding) portion.  
-      */
-      if (col + tw > imagewidth)
-        ncol = imagewidth - col;
-      else
-        ncol = tw;
-
-      row_offset = row * (((imagewidth * spp * bps) + 7) / 8);
-      col_offset = ((col * spp * bps) + 7) / 8;
-      bufp = obuf + row_offset + col_offset;
+            /* Tiles on the right edge may be padded out to tw 
+             * which must be a multiple of 16.
+             * Ncol represents the visible (non padding) portion.  
+             */
+            if (col + tw > imagewidth)
+                ncol = imagewidth - col;
+            else
+                ncol = tw;
+
+            row_offset = row * (((imagewidth * spp * bps) + 7) / 8);
+            col_offset = ((col * spp * bps) + 7) / 8;
+            bufp = obuf + row_offset + col_offset;
 
-      if ((bps % 8) == 0)
-        {
-        if (combineSeparateTileSamplesBytes(srcbuffs, bufp, ncol, nrow, imagewidth,
-					    tw, spp, bps, NULL, 0, 0))
-	  {
-          status = 0;
-          break;
-      	  }
-	}
-      else
-        {
-        bytes_per_pixel  = ((bps * spp) + 7) / 8;
-        if (bytes_per_pixel < (bytes_per_sample + 1))
-          shift_width = bytes_per_pixel;
-        else
-          shift_width = bytes_per_sample + 1;
-
-        switch (shift_width)
-          {
-          case 1: if (combineSeparateTileSamples8bits (srcbuffs, bufp, ncol, nrow,
-                                                       imagewidth, tw, spp, bps, 
-						       NULL, 0, 0))
-	            {
+            if ((bps % 8) == 0)
+            {
+                if (combineSeparateTileSamplesBytes(srcbuffs, bufp, ncol, nrow, imagewidth,
+                                                     tw, spp, bps, NULL, 0, 0))
+                {
                     status = 0;
                     break;
-      	            }
-	          break;
-          case 2: if (combineSeparateTileSamples16bits (srcbuffs, bufp, ncol, nrow,
-                                                       imagewidth, tw, spp, bps, 
-						       NULL, 0, 0))
-	            {
-                    status = 0;
+                }
+            }
+            else
+            {
+                bytes_per_pixel  = ((bps * spp) + 7) / 8;
+                if (bytes_per_pixel < (bytes_per_sample + 1))
+                    shift_width = bytes_per_pixel;
+                else
+                    shift_width = bytes_per_sample + 1;
+
+                switch (shift_width)
+                {
+                case 1: if (combineSeparateTileSamples8bits(srcbuffs, bufp, ncol, nrow,
+                                                             imagewidth, tw, spp, bps, 
+                                                             NULL, 0, 0))
+                    {
+                        status = 0;
+                        break;
+                    }
                     break;
-		    }
-	          break;
-          case 3: if (combineSeparateTileSamples24bits (srcbuffs, bufp, ncol, nrow,
-                                                       imagewidth, tw, spp, bps, 
-						       NULL, 0, 0))
-	            {
-                    status = 0;
+                case 2: if (combineSeparateTileSamples16bits(srcbuffs, bufp, ncol, nrow,
+                                                             imagewidth, tw, spp, bps, 
+                                                             NULL, 0, 0))
+                    {
+                        status = 0;
+                        break;
+                    }
+                    break;
+                case 3: if (combineSeparateTileSamples24bits(srcbuffs, bufp, ncol, nrow,
+                                                             imagewidth, tw, spp, bps, 
+                                                             NULL, 0, 0))
+                    {
+                        status = 0;
+                        break;
+                    }
                     break;
-       	            }
-                  break;
-          case 4: 
-          case 5:
-          case 6:
-          case 7:
-          case 8: if (combineSeparateTileSamples32bits (srcbuffs, bufp, ncol, nrow,
-                                                       imagewidth, tw, spp, bps, 
-						       NULL, 0, 0))
-	            {
+                case 4: 
+                case 5:
+                case 6:
+                case 7:
+                case 8: if (combineSeparateTileSamples32bits(srcbuffs, bufp, ncol, nrow,
+                                                             imagewidth, tw, spp, bps, 
+                                                             NULL, 0, 0))
+                    {
+                        status = 0;
+                        break;
+                    }
+                    break;
+                default: TIFFError("readSeparateTilesIntoBuffer", "Unsupported bit depth: %d", bps);
                     status = 0;
                     break;
-		    }
-	          break;
-          default: TIFFError ("readSeparateTilesIntoBuffer", "Unsupported bit depth: %d", bps);
-                  status = 0;
-                  break;
-          }
+                }
+            }
         }
-      }
     }
 
-  for (sample = 0; (sample < spp) && (sample < MAX_SAMPLES); sample++)
+    for (sample = 0; (sample < spp) && (sample < MAX_SAMPLES); sample++)
     {
-    tbuff = srcbuffs[sample];
-    if (tbuff != NULL)
-      _TIFFfree(tbuff);
+        tbuff = srcbuffs[sample];
+        if (tbuff != NULL)
+            _TIFFfree(tbuff);
     }
- 
-  return status;
-  }
+
+    return status;
+}
+
 
 static int writeBufferToContigStrips(TIFF* out, uint8* buf, uint32 imagelength)
   {

2025-02-03 22:05:55.942 | DEBUG    | scenario:rebuild:369 - original environment: environ({'CONDA_SHLVL': '2', 'LC_ALL': 'C.UTF-8', 'LS_COLORS': 'rs=0:di=01;34:ln=01;36:mh=00:pi=40;33:so=01;35:do=01;35:bd=40;33;01:cd=40;33;01:or=40;31;01:mi=00:su=37;41:sg=30;43:ca=30;41:tw=30;42:ow=34;42:st=37;44:ex=01;32:*.tar=01;31:*.tgz=01;31:*.arc=01;31:*.arj=01;31:*.taz=01;31:*.lha=01;31:*.lz4=01;31:*.lzh=01;31:*.lzma=01;31:*.tlz=01;31:*.txz=01;31:*.tzo=01;31:*.t7z=01;31:*.zip=01;31:*.z=01;31:*.Z=01;31:*.dz=01;31:*.gz=01;31:*.lrz=01;31:*.lz=01;31:*.lzo=01;31:*.xz=01;31:*.zst=01;31:*.tzst=01;31:*.bz2=01;31:*.bz=01;31:*.tbz=01;31:*.tbz2=01;31:*.tz=01;31:*.deb=01;31:*.rpm=01;31:*.jar=01;31:*.war=01;31:*.ear=01;31:*.sar=01;31:*.rar=01;31:*.alz=01;31:*.ace=01;31:*.zoo=01;31:*.cpio=01;31:*.7z=01;31:*.rz=01;31:*.cab=01;31:*.wim=01;31:*.swm=01;31:*.dwm=01;31:*.esd=01;31:*.jpg=01;35:*.jpeg=01;35:*.mjpg=01;35:*.mjpeg=01;35:*.gif=01;35:*.bmp=01;35:*.pbm=01;35:*.pgm=01;35:*.ppm=01;35:*.tga=01;35:*.xbm=01;35:*.xpm=01;35:*.tif=01;35:*.tiff=01;35:*.png=01;35:*.svg=01;35:*.svgz=01;35:*.mng=01;35:*.pcx=01;35:*.mov=01;35:*.mpg=01;35:*.mpeg=01;35:*.m2v=01;35:*.mkv=01;35:*.webm=01;35:*.ogm=01;35:*.mp4=01;35:*.m4v=01;35:*.mp4v=01;35:*.vob=01;35:*.qt=01;35:*.nuv=01;35:*.wmv=01;35:*.asf=01;35:*.rm=01;35:*.rmvb=01;35:*.flc=01;35:*.avi=01;35:*.fli=01;35:*.flv=01;35:*.gl=01;35:*.dl=01;35:*.xcf=01;35:*.xwd=01;35:*.yuv=01;35:*.cgm=01;35:*.emf=01;35:*.ogv=01;35:*.ogx=01;35:*.aac=00;36:*.au=00;36:*.flac=00;36:*.m4a=00;36:*.mid=00;36:*.midi=00;36:*.mka=00;36:*.mp3=00;36:*.mpc=00;36:*.ogg=00;36:*.ra=00;36:*.wav=00;36:*.oga=00;36:*.opus=00;36:*.spx=00;36:*.xspf=00;36:', 'LD_LIBRARY_PATH': '/opt/crashrepair/lib:/CrashRepair/lib:/klee/build/lib:', 'CONDA_EXE': '/root/anaconda3/bin/conda', 'LANG': 'C.UTF-8', 'TZ': 'Asia/Shanghai', 'HOSTNAME': 'fea22102047d', 'OLDPWD': '/orchestrator', 'CONDA_PREFIX': '/root/anaconda3/envs/CrashRepair', '_CE_M': '', 'CC': 'crepair-cc', 'LLVM_COMPILER': 'clang', 'CONDA_PREFIX_1': '/root/anaconda3', 'PWD': '/orchestrator/crashrepair', 'HOME': '/root', 'CONDA_PYTHON_EXE': '/root/anaconda3/bin/python', '_CE_CONDA': '', 'CONDA_PROMPT_MODIFIER': '(CrashRepair) ', 'CXX': 'crepair-cxx', 'TERM': 'xterm', 'SHLVL': '2', 'PYTHONPATH': '/usr/lib/python3.8/site-packages:', 'PATH': '/root/anaconda3/envs/CrashRepair/bin:/root/anaconda3/condabin:~/anaconda3/bin:/opt/crashrepair/bin:/CrashRepair/compiler:/klee/build/bin:/opt/llvm-6/bin:/klee/build/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', 'CONDA_DEFAULT_ENV': 'CrashRepair', '_': '/root/anaconda3/envs/CrashRepair/bin/python'})
2025-02-03 22:05:55.942 | DEBUG    | scenario:rebuild:382 - injecting ghost function into CFLAGS during build: -lcrepair_ghost
2025-02-03 22:05:55.942 | DEBUG    | scenario:rebuild:398 - using environment: {'INJECT_CFLAGS': '-g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address', 'INJECT_CXXFLAGS': '-g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address', 'INJECT_LDFLAGS': '-g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address'}
2025-02-03 22:05:55.942 | DEBUG    | shell:__call__:41 - executing: make CFLAGS="${INJECT_CFLAGS}" CXXFLAGS="${INJECT_CXXFLAGS}" LDFLAGS="${INJECT_LDFLAGS}"
Making all in port
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/port'
make[1]: Nothing to be done for 'all'.
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/port'
Making all in libtiff
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/libtiff'
make  all-am
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/libtiff'
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/libtiff'
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/libtiff'
Making all in tools
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/tools'
crepair-cc -DHAVE_CONFIG_H -I. -I../libtiff  -I../libtiff   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -MT tiffcrop.o -MD -MP -MF .deps/tiffcrop.Tpo -c -o tiffcrop.o tiffcrop.c
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_ghost: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
mv -f .deps/tiffcrop.Tpo .deps/tiffcrop.Po
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address  -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -o tiffcrop tiffcrop.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -g -O0 -Wno-error -I/CrashRepair/lib -fsanitize=address -g -O0 -Wno-error -I/CrashRepair/lib -fsanitize=address -o tiffcrop tiffcrop.o  -L/klee/build/lib -L/CrashRepair/lib -lkleeRuntest -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost ../libtiff/.libs/libtiff.a ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/tools'
Making all in build
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/build'
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/build'
make[2]: Nothing to be done for 'all-am'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/build'
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/build'
Making all in contrib
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib'
Making all in addtiffo
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/addtiffo'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/addtiffo'
Making all in dbs
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/dbs'
Making all in xtiff
make[3]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/dbs/xtiff'
make[3]: Nothing to be done for 'all'.
make[3]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/dbs/xtiff'
make[3]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/dbs'
make[3]: Nothing to be done for 'all-am'.
make[3]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/dbs'
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/dbs'
Making all in iptcutil
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/iptcutil'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/iptcutil'
Making all in mfs
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/mfs'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/mfs'
Making all in pds
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/pds'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/pds'
Making all in ras
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/ras'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/ras'
Making all in stream
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/stream'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/stream'
Making all in tags
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/tags'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/tags'
Making all in win_dib
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/win_dib'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/win_dib'
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib'
make[2]: Nothing to be done for 'all-am'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib'
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib'
Making all in test
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/test'
make[1]: Nothing to be done for 'all'.
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/test'
Making all in man
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/man'
make[1]: Nothing to be done for 'all'.
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/man'
Making all in html
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html'
Making all in images
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html/images'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html/images'
Making all in man
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html/man'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html/man'
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html'
make[2]: Nothing to be done for 'all-am'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html'
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html'
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src'
make[1]: Nothing to be done for 'all-am'.
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src'
2025-02-03 22:05:56.422 | INFO     | analyzer:run:114 - running analysis with timeout: 60 minutes
2025-02-03 22:05:56.423 | DEBUG    | analyzer:write_config_to_file:88 - generated analyzer config:

dir_exp:/data/vulnloc/libtiff/CVE-2016-5321
tag_id:libtiff_CVE-2016-5321
src_directory:/data/vulnloc/libtiff/CVE-2016-5321/src
binary_path:/data/vulnloc/libtiff/CVE-2016-5321/src/tools/tiffcrop
config_command:./configure --enable-static --disable-shared
build_command:make CFLAGS="${INJECT_CFLAGS}" CXXFLAGS="${INJECT_CXXFLAGS}" LDFLAGS="${INJECT_LDFLAGS}"
test_input_list:$POC foo.tif
poc_list:/CrashRepair/experiments/vulnloc/libtiff/CVE-2016-5321/tests/1.tif
klee_flags:--link-llvm-lib=/CrashRepair/lib/libcrepair_proxy.bca 

2025-02-03 22:05:56.423 | DEBUG    | analyzer:run:124 - wrote analyzer config file to: /tmp/tmpuh6ix1y_
2025-02-03 22:05:56.423 | DEBUG    | shell:__call__:41 - executing: crepair --conf=/tmp/tmpuh6ix1y_
[K[1;36m
====================================================================================================

	Starting CRepair (C Crash Repair) 
====================================================================================================
[0m
[K[1;36m
	Loading Configurations
	__________________________________________________________________________________________
[0m
[K	[1;34mreading configuration values from arguments[0m
[K	[1;34mreading configuration values form configuration file[0m
[K	[1;37m	[file] /tmp/tmpuh6ix1y_[0m
[K	[1;34mupdating configuration values[0m
[K	[1;34mreading test configuration[0m
[K	[1;34mreading seed information[0m
[K	[1;37m	[config] stack size: 15000[0m
[K	[1;37m	[config] collecting stats: False[0m
[K	[1;37m	[config] number of tests: 1[0m
[K	[1;37m	[config] number of cores: 8[0m
[K	[1;37m	[config] klee concrete execution timeout: 600[0m
[K	[1;37m	[config] klee concolic execution timeout: 1200[0m
[K	[1;37m	[config] synthesize subset expressions: True[0m
[K	[1;37m	[config] window size for taint locations: 500[0m
[K	[1;37m	[config] window size for taint values: 500000[0m
[K[1;36m

	Analyzing Program
====================================================================================================
[0m
[K[1;36m
	Test Case #1
	__________________________________________________________________________________________
[0m
[K[1;36m
		Running Concrete Execution
		------------------------------------------------------------------------------------------
[0m
[K	[1;37m	[0m[K     [1;37mUsing Arguments: ['$POC', 'foo.tif'][0m
[K	[1;37m	[0m[K     [1;37mUsing Input File: /CrashRepair/experiments/vulnloc/libtiff/CVE-2016-5321/tests/1.tif[0m
[K	[1;34m	building program[0m
[K	[1;34m		setting environment variables[0m
[K	[1;34m		cleaning files[0m
[K	[1;34m		configuring program[0m
[K	[1;34m		compiling program[0m
[K	[1;37m	[0m[K     [1;37mUsing Binary: /data/vulnloc/libtiff/CVE-2016-5321/src/tools/tiffcrop[0m
[K	[1;34m	extracting bytecode[0m
[K	[1;34m	executing klee in concrete mode[0m
[K	[1;34m	extracting instruction trace[0m
[K	[1;37m		[note] program did not crash[0m
[K	[1;33m		[note]: the program did not crash[0m
[K	[1;37m
Run time statistics:
-----------------------
[0m
[K	[1;37mStartup: 0.000 minutes[0m
[K	[1;37mBuild: 0 minutes[0m
[K	[1;37mConcrete Analysis: 0 minutes[0m
[K	[1;37mConcolic Analysis: 0 minutes[0m
[K	[1;37mTotal Analysis: 0 minutes[0m
[K	[1;37mLocalization: 0 minutes[0m
[K[1;32m
CRepair finished successfully after 0.408 minutes 
[0m
2025-02-03 22:06:21.310 | INFO     | scenario:analyze_for_guide:592 - analysis failed for candidate patch #1: analysis failed: no localization file was produced
2025-02-03 22:06:21.320 | INFO     | scenario:analyze_for_guide:558 - reanalyzing candidate patch: #2:
@@ -948,152 +948,164 @@
   return status;
   }
 
-static int  readSeparateTilesIntoBuffer (TIFF* in, uint8 *obuf, 
+
+static int readSeparateTilesIntoBuffer (TIFF* in, uint8 *obuf, 
 					 uint32 imagelength, uint32 imagewidth, 
                                          uint32 tw, uint32 tl,
                                          uint16 spp, uint16 bps)
-  {
-  int     i, status = 1, sample;
-  int     shift_width, bytes_per_pixel;
-  uint16  bytes_per_sample;
-  uint32  row, col;     /* Current row and col of image */
-  uint32  nrow, ncol;   /* Number of rows and cols in current tile */
-  uint32  row_offset, col_offset; /* Output buffer offsets */
-  tsize_t tbytes = 0, tilesize = TIFFTileSize(in);
-  tsample_t s;
-  uint8*  bufp = (uint8*)obuf;
-  unsigned char *srcbuffs[MAX_SAMPLES];
-  unsigned char *tbuff = NULL;
-
-  bytes_per_sample = (bps + 7) / 8;
+{
+    int     i, status = 1, sample;
+    int     shift_width, bytes_per_pixel;
+    uint16  bytes_per_sample;
+    uint32  row, col;     /* Current row and col of image */
+    uint32  nrow, ncol;   /* Number of rows and cols in current tile */
+    uint32  row_offset, col_offset; /* Output buffer offsets */
+    tsize_t tbytes = 0, tilesize = TIFFTileSize(in);
+    tsample_t s;
+    uint8*  bufp = (uint8*)obuf;
+    unsigned char *srcbuffs[MAX_SAMPLES];
+    unsigned char *tbuff = NULL;
+
+    bytes_per_sample = (bps + 7) / 8;
+
+    if(spp > MAX_SAMPLES) {
+        TIFFError("readSeparateTilesIntoBuffer", "Samples per pixel (%d) exceeds maximum (%d)", spp, MAX_SAMPLES);
+        return 0;
+    }
 
-  for (sample = 0; (sample < spp) && (sample < MAX_SAMPLES); sample++)
+    for (sample = 0; (sample < spp); sample++)
     {
-    srcbuffs[sample] = NULL;
-    tbuff = (unsigned char *)_TIFFmalloc(tilesize + 8);
-    if (!tbuff)
-      {
-      TIFFError ("readSeparateTilesIntoBuffer", 
-                 "Unable to allocate tile read buffer for sample %d", sample);
-      for (i = 0; i < sample; i++)
-        _TIFFfree (srcbuffs[i]);
-      return 0;
-      }
-    srcbuffs[sample] = tbuff;
+        srcbuffs[sample] = NULL;
+        tbuff = (unsigned char *)_TIFFmalloc(tilesize + 8);
+        if (!tbuff)
+        {
+            TIFFError ("readSeparateTilesIntoBuffer", 
+                       "Unable to allocate tile read buffer for sample %d", sample);
+            for (i = 0; i < sample; i++)
+                _TIFFfree (srcbuffs[i]);
+            return 0;
+        }
+        srcbuffs[sample] = tbuff;
     } 
-  /* Each tile contains only the data for a single plane
-   * arranged in scanlines of tw * bytes_per_sample bytes.
-   */
-  for (row = 0; row < imagelength; row += tl)
+    /* Each tile contains only the data for a single plane
+     * arranged in scanlines of tw * bytes_per_sample bytes.
+     */
+    for (row = 0; row < imagelength; row += tl)
     {
-    nrow = (row + tl > imagelength) ? imagelength - row : tl;
-    for (col = 0; col < imagewidth; col += tw)
-      {
-      for (s = 0; s < spp; s++)
-        {  /* Read each plane of a tile set into srcbuffs[s] */
-	tbytes = TIFFReadTile(in, srcbuffs[s], col, row, 0, s);
-        if (tbytes < 0  && !ignore)
-          {
-	  TIFFError(TIFFFileName(in),
-                 "Error, can't read tile for row %lu col %lu, "
-		 "sample %lu",
-		 (unsigned long) col, (unsigned long) row,
-		 (unsigned long) s);
-		 status = 0;
-          for (sample = 0; (sample < spp) && (sample < MAX_SAMPLES); sample++)
-            {
-            tbuff = srcbuffs[sample];
-            if (tbuff != NULL)
-              _TIFFfree(tbuff);
-            }
-          return status;
-	  }
-	}
-     /* Tiles on the right edge may be padded out to tw 
-      * which must be a multiple of 16.
-      * Ncol represents the visible (non padding) portion.  
-      */
-      if (col + tw > imagewidth)
-        ncol = imagewidth - col;
-      else
-        ncol = tw;
-
-      row_offset = row * (((imagewidth * spp * bps) + 7) / 8);
-      col_offset = ((col * spp * bps) + 7) / 8;
-      bufp = obuf + row_offset + col_offset;
-
-      if ((bps % 8) == 0)
-        {
-        if (combineSeparateTileSamplesBytes(srcbuffs, bufp, ncol, nrow, imagewidth,
-					    tw, spp, bps, NULL, 0, 0))
-	  {
-          status = 0;
-          break;
-      	  }
-	}
-      else
+        nrow = (row + tl > imagelength) ? imagelength - row : tl;
+        for (col = 0; col < imagewidth; col += tw)
         {
-        bytes_per_pixel  = ((bps * spp) + 7) / 8;
-        if (bytes_per_pixel < (bytes_per_sample + 1))
-          shift_width = bytes_per_pixel;
-        else
-          shift_width = bytes_per_sample + 1;
-
-        switch (shift_width)
-          {
-          case 1: if (combineSeparateTileSamples8bits (srcbuffs, bufp, ncol, nrow,
-                                                       imagewidth, tw, spp, bps, 
-						       NULL, 0, 0))
-	            {
+            for (s = 0; s < spp; s++)
+            {  /* Read each plane of a tile set into srcbuffs[s] */
+                tbytes = TIFFReadTile(in, srcbuffs[s], col, row, 0, s);
+                if (tbytes < 0  && !ignore)
+                {
+                    TIFFError(TIFFFileName(in),
+                               "Error, can't read tile for row %lu col %lu, "
+                               "sample %lu",
+                               (unsigned long) col, (unsigned long) row,
+                               (unsigned long) s);
                     status = 0;
-                    break;
-      	            }
-	          break;
-          case 2: if (combineSeparateTileSamples16bits (srcbuffs, bufp, ncol, nrow,
-                                                       imagewidth, tw, spp, bps, 
-						       NULL, 0, 0))
-	            {
-                    status = 0;
-                    break;
-		    }
-	          break;
-          case 3: if (combineSeparateTileSamples24bits (srcbuffs, bufp, ncol, nrow,
-                                                       imagewidth, tw, spp, bps, 
-						       NULL, 0, 0))
-	            {
-                    status = 0;
-                    break;
-       	            }
-                  break;
-          case 4: 
-          case 5:
-          case 6:
-          case 7:
-          case 8: if (combineSeparateTileSamples32bits (srcbuffs, bufp, ncol, nrow,
-                                                       imagewidth, tw, spp, bps, 
-						       NULL, 0, 0))
-	            {
+                    for (sample = 0; (sample < spp) && (sample < MAX_SAMPLES); sample++)
+                    {
+                        tbuff = srcbuffs[sample];
+                        if (tbuff != NULL)
+                            _TIFFfree(tbuff);
+                    }
+                    return status;
+                }
+            }
+            /* Tiles on the right edge may be padded out to tw 
+             * which must be a multiple of 16.
+             * Ncol represents the visible (non padding) portion.  
+             */
+            if (col + tw > imagewidth)
+                ncol = imagewidth - col;
+            else
+                ncol = tw;
+
+            row_offset = row * (((imagewidth * spp * bps) + 7) / 8);
+            col_offset = ((col * spp * bps) + 7) / 8;
+            bufp = obuf + row_offset + col_offset;
+
+            if ((bps % 8) == 0)
+            {
+                if (combineSeparateTileSamplesBytes(srcbuffs, bufp, ncol, nrow, imagewidth,
+                                                     tw, spp, bps, NULL, 0, 0))
+                {
                     status = 0;
                     break;
-		    }
-	          break;
-          default: TIFFError ("readSeparateTilesIntoBuffer", "Unsupported bit depth: %d", bps);
-                  status = 0;
-                  break;
-          }
+                }
+            }
+            else
+            {
+                bytes_per_pixel = ((bps * spp) + 7) / 8;
+                if (bytes_per_pixel < (bytes_per_sample + 1))
+                    shift_width = bytes_per_pixel;
+                else
+                    shift_width = bytes_per_sample + 1;
+
+                switch (shift_width)
+                {
+                    case 1: 
+                        if (combineSeparateTileSamples8bits (srcbuffs, bufp, ncol, nrow,
+                                                             imagewidth, tw, spp, bps, 
+                                                             NULL, 0, 0))
+                        {
+                            status = 0;
+                            break;
+                        }
+                        break;
+                    case 2: 
+                        if (combineSeparateTileSamples16bits (srcbuffs, bufp, ncol, nrow,
+                                                              imagewidth, tw, spp, bps, 
+                                                              NULL, 0, 0))
+                        {
+                            status = 0;
+                            break;
+                        }
+                        break;
+                    case 3: 
+                        if (combineSeparateTileSamples24bits (srcbuffs, bufp, ncol, nrow,
+                                                              imagewidth, tw, spp, bps, 
+                                                              NULL, 0, 0))
+                        {
+                            status = 0;
+                            break;
+                        }
+                        break;
+                    case 4: 
+                    case 5:
+                    case 6:
+                    case 7:
+                    case 8: 
+                        if (combineSeparateTileSamples32bits (srcbuffs, bufp, ncol, nrow,
+                                                              imagewidth, tw, spp, bps, 
+                                                              NULL, 0, 0))
+                        {
+                            status = 0;
+                            break;
+                        }
+                        break;
+                    default: 
+                        TIFFError ("readSeparateTilesIntoBuffer", "Unsupported bit depth: %d", bps);
+                        status = 0;
+                        break;
+                }
+            }
         }
-      }
     }
 
-  for (sample = 0; (sample < spp) && (sample < MAX_SAMPLES); sample++)
+    for (sample = 0; (sample < spp) && (sample < MAX_SAMPLES); sample++)
     {
-    tbuff = srcbuffs[sample];
-    if (tbuff != NULL)
-      _TIFFfree(tbuff);
+        tbuff = srcbuffs[sample];
+        if (tbuff != NULL)
+            _TIFFfree(tbuff);
     }
- 
-  return status;
-  }
+
+    return status;
+}
+
 
 static int writeBufferToContigStrips(TIFF* out, uint8* buf, uint32 imagelength)
   {

2025-02-03 22:06:21.328 | DEBUG    | scenario:rebuild:369 - original environment: environ({'CONDA_SHLVL': '2', 'LC_ALL': 'C.UTF-8', 'LS_COLORS': 'rs=0:di=01;34:ln=01;36:mh=00:pi=40;33:so=01;35:do=01;35:bd=40;33;01:cd=40;33;01:or=40;31;01:mi=00:su=37;41:sg=30;43:ca=30;41:tw=30;42:ow=34;42:st=37;44:ex=01;32:*.tar=01;31:*.tgz=01;31:*.arc=01;31:*.arj=01;31:*.taz=01;31:*.lha=01;31:*.lz4=01;31:*.lzh=01;31:*.lzma=01;31:*.tlz=01;31:*.txz=01;31:*.tzo=01;31:*.t7z=01;31:*.zip=01;31:*.z=01;31:*.Z=01;31:*.dz=01;31:*.gz=01;31:*.lrz=01;31:*.lz=01;31:*.lzo=01;31:*.xz=01;31:*.zst=01;31:*.tzst=01;31:*.bz2=01;31:*.bz=01;31:*.tbz=01;31:*.tbz2=01;31:*.tz=01;31:*.deb=01;31:*.rpm=01;31:*.jar=01;31:*.war=01;31:*.ear=01;31:*.sar=01;31:*.rar=01;31:*.alz=01;31:*.ace=01;31:*.zoo=01;31:*.cpio=01;31:*.7z=01;31:*.rz=01;31:*.cab=01;31:*.wim=01;31:*.swm=01;31:*.dwm=01;31:*.esd=01;31:*.jpg=01;35:*.jpeg=01;35:*.mjpg=01;35:*.mjpeg=01;35:*.gif=01;35:*.bmp=01;35:*.pbm=01;35:*.pgm=01;35:*.ppm=01;35:*.tga=01;35:*.xbm=01;35:*.xpm=01;35:*.tif=01;35:*.tiff=01;35:*.png=01;35:*.svg=01;35:*.svgz=01;35:*.mng=01;35:*.pcx=01;35:*.mov=01;35:*.mpg=01;35:*.mpeg=01;35:*.m2v=01;35:*.mkv=01;35:*.webm=01;35:*.ogm=01;35:*.mp4=01;35:*.m4v=01;35:*.mp4v=01;35:*.vob=01;35:*.qt=01;35:*.nuv=01;35:*.wmv=01;35:*.asf=01;35:*.rm=01;35:*.rmvb=01;35:*.flc=01;35:*.avi=01;35:*.fli=01;35:*.flv=01;35:*.gl=01;35:*.dl=01;35:*.xcf=01;35:*.xwd=01;35:*.yuv=01;35:*.cgm=01;35:*.emf=01;35:*.ogv=01;35:*.ogx=01;35:*.aac=00;36:*.au=00;36:*.flac=00;36:*.m4a=00;36:*.mid=00;36:*.midi=00;36:*.mka=00;36:*.mp3=00;36:*.mpc=00;36:*.ogg=00;36:*.ra=00;36:*.wav=00;36:*.oga=00;36:*.opus=00;36:*.spx=00;36:*.xspf=00;36:', 'LD_LIBRARY_PATH': '/opt/crashrepair/lib:/CrashRepair/lib:/klee/build/lib:', 'CONDA_EXE': '/root/anaconda3/bin/conda', 'LANG': 'C.UTF-8', 'TZ': 'Asia/Shanghai', 'HOSTNAME': 'fea22102047d', 'OLDPWD': '/orchestrator', 'CONDA_PREFIX': '/root/anaconda3/envs/CrashRepair', '_CE_M': '', 'CC': 'crepair-cc', 'LLVM_COMPILER': 'clang', 'CONDA_PREFIX_1': '/root/anaconda3', 'PWD': '/orchestrator/crashrepair', 'HOME': '/root', 'CONDA_PYTHON_EXE': '/root/anaconda3/bin/python', '_CE_CONDA': '', 'CONDA_PROMPT_MODIFIER': '(CrashRepair) ', 'CXX': 'crepair-cxx', 'TERM': 'xterm', 'SHLVL': '2', 'PYTHONPATH': '/usr/lib/python3.8/site-packages:', 'PATH': '/root/anaconda3/envs/CrashRepair/bin:/root/anaconda3/condabin:~/anaconda3/bin:/opt/crashrepair/bin:/CrashRepair/compiler:/klee/build/bin:/opt/llvm-6/bin:/klee/build/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', 'CONDA_DEFAULT_ENV': 'CrashRepair', '_': '/root/anaconda3/envs/CrashRepair/bin/python'})
2025-02-03 22:06:21.328 | DEBUG    | scenario:rebuild:382 - injecting ghost function into CFLAGS during build: -lcrepair_ghost
2025-02-03 22:06:21.328 | DEBUG    | scenario:rebuild:398 - using environment: {'INJECT_CFLAGS': '-g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address', 'INJECT_CXXFLAGS': '-g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address', 'INJECT_LDFLAGS': '-g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address'}
2025-02-03 22:06:21.328 | DEBUG    | shell:__call__:41 - executing: make CFLAGS="${INJECT_CFLAGS}" CXXFLAGS="${INJECT_CXXFLAGS}" LDFLAGS="${INJECT_LDFLAGS}"
Making all in port
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/port'
make[1]: Nothing to be done for 'all'.
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/port'
Making all in libtiff
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/libtiff'
make  all-am
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/libtiff'
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/libtiff'
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/libtiff'
Making all in tools
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/tools'
crepair-cc -DHAVE_CONFIG_H -I. -I../libtiff  -I../libtiff   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -MT tiffcrop.o -MD -MP -MF .deps/tiffcrop.Tpo -c -o tiffcrop.o tiffcrop.c
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_ghost: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
mv -f .deps/tiffcrop.Tpo .deps/tiffcrop.Po
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address  -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -o tiffcrop tiffcrop.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -g -O0 -Wno-error -I/CrashRepair/lib -fsanitize=address -g -O0 -Wno-error -I/CrashRepair/lib -fsanitize=address -o tiffcrop tiffcrop.o  -L/klee/build/lib -L/CrashRepair/lib -lkleeRuntest -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost ../libtiff/.libs/libtiff.a ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/tools'
Making all in build
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/build'
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/build'
make[2]: Nothing to be done for 'all-am'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/build'
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/build'
Making all in contrib
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib'
Making all in addtiffo
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/addtiffo'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/addtiffo'
Making all in dbs
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/dbs'
Making all in xtiff
make[3]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/dbs/xtiff'
make[3]: Nothing to be done for 'all'.
make[3]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/dbs/xtiff'
make[3]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/dbs'
make[3]: Nothing to be done for 'all-am'.
make[3]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/dbs'
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/dbs'
Making all in iptcutil
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/iptcutil'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/iptcutil'
Making all in mfs
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/mfs'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/mfs'
Making all in pds
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/pds'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/pds'
Making all in ras
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/ras'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/ras'
Making all in stream
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/stream'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/stream'
Making all in tags
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/tags'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/tags'
Making all in win_dib
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/win_dib'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/win_dib'
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib'
make[2]: Nothing to be done for 'all-am'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib'
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib'
Making all in test
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/test'
make[1]: Nothing to be done for 'all'.
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/test'
Making all in man
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/man'
make[1]: Nothing to be done for 'all'.
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/man'
Making all in html
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html'
Making all in images
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html/images'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html/images'
Making all in man
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html/man'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html/man'
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html'
make[2]: Nothing to be done for 'all-am'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html'
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html'
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src'
make[1]: Nothing to be done for 'all-am'.
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src'
2025-02-03 22:06:21.814 | INFO     | analyzer:run:114 - running analysis with timeout: 60 minutes
2025-02-03 22:06:21.814 | DEBUG    | analyzer:write_config_to_file:88 - generated analyzer config:

dir_exp:/data/vulnloc/libtiff/CVE-2016-5321
tag_id:libtiff_CVE-2016-5321
src_directory:/data/vulnloc/libtiff/CVE-2016-5321/src
binary_path:/data/vulnloc/libtiff/CVE-2016-5321/src/tools/tiffcrop
config_command:./configure --enable-static --disable-shared
build_command:make CFLAGS="${INJECT_CFLAGS}" CXXFLAGS="${INJECT_CXXFLAGS}" LDFLAGS="${INJECT_LDFLAGS}"
test_input_list:$POC foo.tif
poc_list:/CrashRepair/experiments/vulnloc/libtiff/CVE-2016-5321/tests/1.tif
klee_flags:--link-llvm-lib=/CrashRepair/lib/libcrepair_proxy.bca 

2025-02-03 22:06:21.814 | DEBUG    | analyzer:run:124 - wrote analyzer config file to: /tmp/tmpl6x7ye2y
2025-02-03 22:06:21.814 | DEBUG    | shell:__call__:41 - executing: crepair --conf=/tmp/tmpl6x7ye2y
[K[1;36m
====================================================================================================

	Starting CRepair (C Crash Repair) 
====================================================================================================
[0m
[K[1;36m
	Loading Configurations
	__________________________________________________________________________________________
[0m
[K	[1;34mreading configuration values from arguments[0m
[K	[1;34mreading configuration values form configuration file[0m
[K	[1;37m	[file] /tmp/tmpl6x7ye2y[0m
[K	[1;34mupdating configuration values[0m
[K	[1;34mreading test configuration[0m
[K	[1;34mreading seed information[0m
[K	[1;37m	[config] stack size: 15000[0m
[K	[1;37m	[config] collecting stats: False[0m
[K	[1;37m	[config] number of tests: 1[0m
[K	[1;37m	[config] number of cores: 8[0m
[K	[1;37m	[config] klee concrete execution timeout: 600[0m
[K	[1;37m	[config] klee concolic execution timeout: 1200[0m
[K	[1;37m	[config] synthesize subset expressions: True[0m
[K	[1;37m	[config] window size for taint locations: 500[0m
[K	[1;37m	[config] window size for taint values: 500000[0m
[K[1;36m

	Analyzing Program
====================================================================================================
[0m
[K[1;36m
	Test Case #1
	__________________________________________________________________________________________
[0m
[K[1;36m
		Running Concrete Execution
		------------------------------------------------------------------------------------------
[0m
[K	[1;37m	[0m[K     [1;37mUsing Arguments: ['$POC', 'foo.tif'][0m
[K	[1;37m	[0m[K     [1;37mUsing Input File: /CrashRepair/experiments/vulnloc/libtiff/CVE-2016-5321/tests/1.tif[0m
[K	[1;34m	building program[0m
[K	[1;34m		setting environment variables[0m
[K	[1;34m		cleaning files[0m
[K	[1;34m		configuring program[0m
[K	[1;34m		compiling program[0m
[K	[1;37m	[0m[K     [1;37mUsing Binary: /data/vulnloc/libtiff/CVE-2016-5321/src/tools/tiffcrop[0m
[K	[1;34m	extracting bytecode[0m
[K	[1;34m	executing klee in concrete mode[0m
[K	[1;34m	extracting instruction trace[0m
[K	[1;37m		[note] program did not crash[0m
[K	[1;33m		[note]: the program did not crash[0m
[K	[1;37m
Run time statistics:
-----------------------
[0m
[K	[1;37mStartup: 0.000 minutes[0m
[K	[1;37mBuild: 0 minutes[0m
[K	[1;37mConcrete Analysis: 0 minutes[0m
[K	[1;37mConcolic Analysis: 0 minutes[0m
[K	[1;37mTotal Analysis: 0 minutes[0m
[K	[1;37mLocalization: 0 minutes[0m
[K[1;32m
CRepair finished successfully after 0.435 minutes 
[0m
2025-02-03 22:06:48.335 | INFO     | scenario:analyze_for_guide:592 - analysis failed for candidate patch #2: analysis failed: no localization file was produced
2025-02-03 22:06:48.343 | INFO     | scenario:analyze_for_guide:558 - reanalyzing candidate patch: #3:
@@ -948,152 +948,159 @@
   return status;
   }
 
-static int  readSeparateTilesIntoBuffer (TIFF* in, uint8 *obuf, 
-					 uint32 imagelength, uint32 imagewidth, 
+
+static int readSeparateTilesIntoBuffer (TIFF* in, uint8 *obuf, 
+                                         uint32 imagelength, uint32 imagewidth, 
                                          uint32 tw, uint32 tl,
                                          uint16 spp, uint16 bps)
-  {
-  int     i, status = 1, sample;
-  int     shift_width, bytes_per_pixel;
-  uint16  bytes_per_sample;
-  uint32  row, col;     /* Current row and col of image */
-  uint32  nrow, ncol;   /* Number of rows and cols in current tile */
-  uint32  row_offset, col_offset; /* Output buffer offsets */
-  tsize_t tbytes = 0, tilesize = TIFFTileSize(in);
-  tsample_t s;
-  uint8*  bufp = (uint8*)obuf;
-  unsigned char *srcbuffs[MAX_SAMPLES];
-  unsigned char *tbuff = NULL;
-
-  bytes_per_sample = (bps + 7) / 8;
+{
+    int i, status = 1, sample;
+    int shift_width, bytes_per_pixel;
+    uint16 bytes_per_sample;
+    uint32 row, col;     /* Current row and col of image */
+    uint32 nrow, ncol;   /* Number of rows and cols in current tile */
+    uint32 row_offset, col_offset; /* Output buffer offsets */
+    tsize_t tbytes = 0, tilesize = TIFFTileSize(in);
+    tsample_t s;
+    uint8*  bufp = (uint8*)obuf;
+    unsigned char *srcbuffs[MAX_SAMPLES];
+    unsigned char *tbuff = NULL;
+
+    bytes_per_sample = (bps + 7) / 8;
+
+    if (spp > MAX_SAMPLES) {
+        TIFFError("readSeparateTilesIntoBuffer", "Number of samples exceeds MAX_SAMPLES");
+        return 0;
+    }
 
-  for (sample = 0; (sample < spp) && (sample < MAX_SAMPLES); sample++)
+    for (sample = 0; (sample < spp); sample++)
     {
-    srcbuffs[sample] = NULL;
-    tbuff = (unsigned char *)_TIFFmalloc(tilesize + 8);
-    if (!tbuff)
-      {
-      TIFFError ("readSeparateTilesIntoBuffer", 
-                 "Unable to allocate tile read buffer for sample %d", sample);
-      for (i = 0; i < sample; i++)
-        _TIFFfree (srcbuffs[i]);
-      return 0;
-      }
-    srcbuffs[sample] = tbuff;
+        srcbuffs[sample] = NULL;
+        tbuff = (unsigned char *)_TIFFmalloc(tilesize + 8);
+        if (!tbuff)
+        {
+            TIFFError ("readSeparateTilesIntoBuffer", 
+                        "Unable to allocate tile read buffer for sample %d", sample);
+            for (i = 0; i < sample; i++)
+                _TIFFfree (srcbuffs[i]);
+            return 0;
+        }
+        srcbuffs[sample] = tbuff;
     } 
-  /* Each tile contains only the data for a single plane
-   * arranged in scanlines of tw * bytes_per_sample bytes.
-   */
-  for (row = 0; row < imagelength; row += tl)
+    /* Each tile contains only the data for a single plane
+     * arranged in scanlines of tw * bytes_per_sample bytes.
+     */
+    for (row = 0; row < imagelength; row += tl)
     {
-    nrow = (row + tl > imagelength) ? imagelength - row : tl;
-    for (col = 0; col < imagewidth; col += tw)
-      {
-      for (s = 0; s < spp; s++)
-        {  /* Read each plane of a tile set into srcbuffs[s] */
-	tbytes = TIFFReadTile(in, srcbuffs[s], col, row, 0, s);
-        if (tbytes < 0  && !ignore)
-          {
-	  TIFFError(TIFFFileName(in),
-                 "Error, can't read tile for row %lu col %lu, "
-		 "sample %lu",
-		 (unsigned long) col, (unsigned long) row,
-		 (unsigned long) s);
-		 status = 0;
-          for (sample = 0; (sample < spp) && (sample < MAX_SAMPLES); sample++)
-            {
-            tbuff = srcbuffs[sample];
-            if (tbuff != NULL)
-              _TIFFfree(tbuff);
-            }
-          return status;
-	  }
-	}
-     /* Tiles on the right edge may be padded out to tw 
-      * which must be a multiple of 16.
-      * Ncol represents the visible (non padding) portion.  
-      */
-      if (col + tw > imagewidth)
-        ncol = imagewidth - col;
-      else
-        ncol = tw;
-
-      row_offset = row * (((imagewidth * spp * bps) + 7) / 8);
-      col_offset = ((col * spp * bps) + 7) / 8;
-      bufp = obuf + row_offset + col_offset;
-
-      if ((bps % 8) == 0)
-        {
-        if (combineSeparateTileSamplesBytes(srcbuffs, bufp, ncol, nrow, imagewidth,
-					    tw, spp, bps, NULL, 0, 0))
-	  {
-          status = 0;
-          break;
-      	  }
-	}
-      else
+        nrow = (row + tl > imagelength) ? imagelength - row : tl;
+        for (col = 0; col < imagewidth; col += tw)
         {
-        bytes_per_pixel  = ((bps * spp) + 7) / 8;
-        if (bytes_per_pixel < (bytes_per_sample + 1))
-          shift_width = bytes_per_pixel;
-        else
-          shift_width = bytes_per_sample + 1;
-
-        switch (shift_width)
-          {
-          case 1: if (combineSeparateTileSamples8bits (srcbuffs, bufp, ncol, nrow,
-                                                       imagewidth, tw, spp, bps, 
-						       NULL, 0, 0))
-	            {
+            for (s = 0; s < spp; s++)
+            {  /* Read each plane of a tile set into srcbuffs[s] */
+                tbytes = TIFFReadTile(in, srcbuffs[s], col, row, 0, s);
+                if (tbytes < 0 /* && !ignore */)
+                {
+                    TIFFError(TIFFFileName(in),
+                               "Error, can't read tile for row %lu col %lu, "
+                               "sample %lu",
+                               (unsigned long) col, (unsigned long) row,
+                               (unsigned long) s);
                     status = 0;
-                    break;
-      	            }
-	          break;
-          case 2: if (combineSeparateTileSamples16bits (srcbuffs, bufp, ncol, nrow,
-                                                       imagewidth, tw, spp, bps, 
-						       NULL, 0, 0))
-	            {
-                    status = 0;
-                    break;
-		    }
-	          break;
-          case 3: if (combineSeparateTileSamples24bits (srcbuffs, bufp, ncol, nrow,
-                                                       imagewidth, tw, spp, bps, 
-						       NULL, 0, 0))
-	            {
-                    status = 0;
-                    break;
-       	            }
-                  break;
-          case 4: 
-          case 5:
-          case 6:
-          case 7:
-          case 8: if (combineSeparateTileSamples32bits (srcbuffs, bufp, ncol, nrow,
-                                                       imagewidth, tw, spp, bps, 
-						       NULL, 0, 0))
-	            {
+                    for (sample = 0; (sample < spp); sample++)
+                    {
+                        tbuff = srcbuffs[sample];
+                        if (tbuff != NULL)
+                            _TIFFfree(tbuff);
+                    }
+                    return status;
+                }
+            }
+            /* Tiles on the right edge may be padded out to tw 
+             * which must be a multiple of 16.
+             * Ncol represents the visible (non padding) portion.  
+             */
+            if (col + tw > imagewidth)
+                ncol = imagewidth - col;
+            else
+                ncol = tw;
+
+            row_offset = row * (((imagewidth * spp * bps) + 7) / 8);
+            col_offset = ((col * spp * bps) + 7) / 8;
+            bufp = obuf + row_offset + col_offset;
+
+            if ((bps % 8) == 0)
+            {
+                if (combineSeparateTileSamplesBytes(srcbuffs, bufp, ncol, nrow, imagewidth,
+                                                    tw, spp, bps, NULL, 0, 0))
+                {
                     status = 0;
                     break;
-		    }
-	          break;
-          default: TIFFError ("readSeparateTilesIntoBuffer", "Unsupported bit depth: %d", bps);
-                  status = 0;
-                  break;
-          }
+                }
+            }
+            else
+            {
+                bytes_per_pixel  = ((bps * spp) + 7) / 8;
+                if (bytes_per_pixel < (bytes_per_sample + 1))
+                    shift_width = bytes_per_pixel;
+                else
+                    shift_width = bytes_per_sample + 1;
+
+                switch (shift_width)
+                {
+                case 1: if (combineSeparateTileSamples8bits (srcbuffs, bufp, ncol, nrow,
+                                                             imagewidth, tw, spp, bps, 
+                                                             NULL, 0, 0))
+                        {
+                            status = 0;
+                            break;
+                        }
+                        break;
+                case 2: if (combineSeparateTileSamples16bits (srcbuffs, bufp, ncol, nrow,
+                                                             imagewidth, tw, spp, bps, 
+                                                             NULL, 0, 0))
+                        {
+                            status = 0;
+                            break;
+                        }
+                        break;
+                case 3: if (combineSeparateTileSamples24bits (srcbuffs, bufp, ncol, nrow,
+                                                             imagewidth, tw, spp, bps, 
+                                                             NULL, 0, 0))
+                        {
+                            status = 0;
+                            break;
+                        }
+                        break;
+                case 4: 
+                case 5:
+                case 6:
+                case 7:
+                case 8: if (combineSeparateTileSamples32bits (srcbuffs, bufp, ncol, nrow,
+                                                             imagewidth, tw, spp, bps, 
+                                                             NULL, 0, 0))
+                        {
+                            status = 0;
+                            break;
+                        }
+                        break;
+                default: TIFFError ("readSeparateTilesIntoBuffer", "Unsupported bit depth: %d", bps);
+                         status = 0;
+                         break;
+                }
+            }
         }
-      }
     }
 
-  for (sample = 0; (sample < spp) && (sample < MAX_SAMPLES); sample++)
+    for (sample = 0; (sample < spp); sample++)
     {
-    tbuff = srcbuffs[sample];
-    if (tbuff != NULL)
-      _TIFFfree(tbuff);
+        tbuff = srcbuffs[sample];
+        if (tbuff != NULL)
+            _TIFFfree(tbuff);
     }
- 
-  return status;
-  }
+
+    return status;
+}
+
 
 static int writeBufferToContigStrips(TIFF* out, uint8* buf, uint32 imagelength)
   {

2025-02-03 22:06:48.350 | DEBUG    | scenario:rebuild:369 - original environment: environ({'CONDA_SHLVL': '2', 'LC_ALL': 'C.UTF-8', 'LS_COLORS': 'rs=0:di=01;34:ln=01;36:mh=00:pi=40;33:so=01;35:do=01;35:bd=40;33;01:cd=40;33;01:or=40;31;01:mi=00:su=37;41:sg=30;43:ca=30;41:tw=30;42:ow=34;42:st=37;44:ex=01;32:*.tar=01;31:*.tgz=01;31:*.arc=01;31:*.arj=01;31:*.taz=01;31:*.lha=01;31:*.lz4=01;31:*.lzh=01;31:*.lzma=01;31:*.tlz=01;31:*.txz=01;31:*.tzo=01;31:*.t7z=01;31:*.zip=01;31:*.z=01;31:*.Z=01;31:*.dz=01;31:*.gz=01;31:*.lrz=01;31:*.lz=01;31:*.lzo=01;31:*.xz=01;31:*.zst=01;31:*.tzst=01;31:*.bz2=01;31:*.bz=01;31:*.tbz=01;31:*.tbz2=01;31:*.tz=01;31:*.deb=01;31:*.rpm=01;31:*.jar=01;31:*.war=01;31:*.ear=01;31:*.sar=01;31:*.rar=01;31:*.alz=01;31:*.ace=01;31:*.zoo=01;31:*.cpio=01;31:*.7z=01;31:*.rz=01;31:*.cab=01;31:*.wim=01;31:*.swm=01;31:*.dwm=01;31:*.esd=01;31:*.jpg=01;35:*.jpeg=01;35:*.mjpg=01;35:*.mjpeg=01;35:*.gif=01;35:*.bmp=01;35:*.pbm=01;35:*.pgm=01;35:*.ppm=01;35:*.tga=01;35:*.xbm=01;35:*.xpm=01;35:*.tif=01;35:*.tiff=01;35:*.png=01;35:*.svg=01;35:*.svgz=01;35:*.mng=01;35:*.pcx=01;35:*.mov=01;35:*.mpg=01;35:*.mpeg=01;35:*.m2v=01;35:*.mkv=01;35:*.webm=01;35:*.ogm=01;35:*.mp4=01;35:*.m4v=01;35:*.mp4v=01;35:*.vob=01;35:*.qt=01;35:*.nuv=01;35:*.wmv=01;35:*.asf=01;35:*.rm=01;35:*.rmvb=01;35:*.flc=01;35:*.avi=01;35:*.fli=01;35:*.flv=01;35:*.gl=01;35:*.dl=01;35:*.xcf=01;35:*.xwd=01;35:*.yuv=01;35:*.cgm=01;35:*.emf=01;35:*.ogv=01;35:*.ogx=01;35:*.aac=00;36:*.au=00;36:*.flac=00;36:*.m4a=00;36:*.mid=00;36:*.midi=00;36:*.mka=00;36:*.mp3=00;36:*.mpc=00;36:*.ogg=00;36:*.ra=00;36:*.wav=00;36:*.oga=00;36:*.opus=00;36:*.spx=00;36:*.xspf=00;36:', 'LD_LIBRARY_PATH': '/opt/crashrepair/lib:/CrashRepair/lib:/klee/build/lib:', 'CONDA_EXE': '/root/anaconda3/bin/conda', 'LANG': 'C.UTF-8', 'TZ': 'Asia/Shanghai', 'HOSTNAME': 'fea22102047d', 'OLDPWD': '/orchestrator', 'CONDA_PREFIX': '/root/anaconda3/envs/CrashRepair', '_CE_M': '', 'CC': 'crepair-cc', 'LLVM_COMPILER': 'clang', 'CONDA_PREFIX_1': '/root/anaconda3', 'PWD': '/orchestrator/crashrepair', 'HOME': '/root', 'CONDA_PYTHON_EXE': '/root/anaconda3/bin/python', '_CE_CONDA': '', 'CONDA_PROMPT_MODIFIER': '(CrashRepair) ', 'CXX': 'crepair-cxx', 'TERM': 'xterm', 'SHLVL': '2', 'PYTHONPATH': '/usr/lib/python3.8/site-packages:', 'PATH': '/root/anaconda3/envs/CrashRepair/bin:/root/anaconda3/condabin:~/anaconda3/bin:/opt/crashrepair/bin:/CrashRepair/compiler:/klee/build/bin:/opt/llvm-6/bin:/klee/build/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', 'CONDA_DEFAULT_ENV': 'CrashRepair', '_': '/root/anaconda3/envs/CrashRepair/bin/python'})
2025-02-03 22:06:48.350 | DEBUG    | scenario:rebuild:382 - injecting ghost function into CFLAGS during build: -lcrepair_ghost
2025-02-03 22:06:48.350 | DEBUG    | scenario:rebuild:398 - using environment: {'INJECT_CFLAGS': '-g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address', 'INJECT_CXXFLAGS': '-g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address', 'INJECT_LDFLAGS': '-g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address'}
2025-02-03 22:06:48.350 | DEBUG    | shell:__call__:41 - executing: make CFLAGS="${INJECT_CFLAGS}" CXXFLAGS="${INJECT_CXXFLAGS}" LDFLAGS="${INJECT_LDFLAGS}"
Making all in port
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/port'
make[1]: Nothing to be done for 'all'.
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/port'
Making all in libtiff
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/libtiff'
make  all-am
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/libtiff'
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/libtiff'
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/libtiff'
Making all in tools
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/tools'
crepair-cc -DHAVE_CONFIG_H -I. -I../libtiff  -I../libtiff   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -MT tiffcrop.o -MD -MP -MF .deps/tiffcrop.Tpo -c -o tiffcrop.o tiffcrop.c
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_ghost: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
mv -f .deps/tiffcrop.Tpo .deps/tiffcrop.Po
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address  -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -o tiffcrop tiffcrop.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -g -O0 -Wno-error -I/CrashRepair/lib -fsanitize=address -g -O0 -Wno-error -I/CrashRepair/lib -fsanitize=address -o tiffcrop tiffcrop.o  -L/klee/build/lib -L/CrashRepair/lib -lkleeRuntest -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost ../libtiff/.libs/libtiff.a ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/tools'
Making all in build
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/build'
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/build'
make[2]: Nothing to be done for 'all-am'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/build'
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/build'
Making all in contrib
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib'
Making all in addtiffo
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/addtiffo'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/addtiffo'
Making all in dbs
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/dbs'
Making all in xtiff
make[3]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/dbs/xtiff'
make[3]: Nothing to be done for 'all'.
make[3]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/dbs/xtiff'
make[3]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/dbs'
make[3]: Nothing to be done for 'all-am'.
make[3]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/dbs'
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/dbs'
Making all in iptcutil
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/iptcutil'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/iptcutil'
Making all in mfs
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/mfs'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/mfs'
Making all in pds
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/pds'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/pds'
Making all in ras
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/ras'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/ras'
Making all in stream
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/stream'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/stream'
Making all in tags
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/tags'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/tags'
Making all in win_dib
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/win_dib'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/win_dib'
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib'
make[2]: Nothing to be done for 'all-am'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib'
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib'
Making all in test
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/test'
make[1]: Nothing to be done for 'all'.
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/test'
Making all in man
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/man'
make[1]: Nothing to be done for 'all'.
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/man'
Making all in html
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html'
Making all in images
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html/images'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html/images'
Making all in man
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html/man'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html/man'
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html'
make[2]: Nothing to be done for 'all-am'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html'
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html'
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src'
make[1]: Nothing to be done for 'all-am'.
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src'
2025-02-03 22:06:48.842 | INFO     | analyzer:run:114 - running analysis with timeout: 60 minutes
2025-02-03 22:06:48.842 | DEBUG    | analyzer:write_config_to_file:88 - generated analyzer config:

dir_exp:/data/vulnloc/libtiff/CVE-2016-5321
tag_id:libtiff_CVE-2016-5321
src_directory:/data/vulnloc/libtiff/CVE-2016-5321/src
binary_path:/data/vulnloc/libtiff/CVE-2016-5321/src/tools/tiffcrop
config_command:./configure --enable-static --disable-shared
build_command:make CFLAGS="${INJECT_CFLAGS}" CXXFLAGS="${INJECT_CXXFLAGS}" LDFLAGS="${INJECT_LDFLAGS}"
test_input_list:$POC foo.tif
poc_list:/CrashRepair/experiments/vulnloc/libtiff/CVE-2016-5321/tests/1.tif
klee_flags:--link-llvm-lib=/CrashRepair/lib/libcrepair_proxy.bca 

2025-02-03 22:06:48.842 | DEBUG    | analyzer:run:124 - wrote analyzer config file to: /tmp/tmpr1y5vdka
2025-02-03 22:06:48.842 | DEBUG    | shell:__call__:41 - executing: crepair --conf=/tmp/tmpr1y5vdka
[K[1;36m
====================================================================================================

	Starting CRepair (C Crash Repair) 
====================================================================================================
[0m
[K[1;36m
	Loading Configurations
	__________________________________________________________________________________________
[0m
[K	[1;34mreading configuration values from arguments[0m
[K	[1;34mreading configuration values form configuration file[0m
[K	[1;37m	[file] /tmp/tmpr1y5vdka[0m
[K	[1;34mupdating configuration values[0m
[K	[1;34mreading test configuration[0m
[K	[1;34mreading seed information[0m
[K	[1;37m	[config] stack size: 15000[0m
[K	[1;37m	[config] collecting stats: False[0m
[K	[1;37m	[config] number of tests: 1[0m
[K	[1;37m	[config] number of cores: 8[0m
[K	[1;37m	[config] klee concrete execution timeout: 600[0m
[K	[1;37m	[config] klee concolic execution timeout: 1200[0m
[K	[1;37m	[config] synthesize subset expressions: True[0m
[K	[1;37m	[config] window size for taint locations: 500[0m
[K	[1;37m	[config] window size for taint values: 500000[0m
[K[1;36m

	Analyzing Program
====================================================================================================
[0m
[K[1;36m
	Test Case #1
	__________________________________________________________________________________________
[0m
[K[1;36m
		Running Concrete Execution
		------------------------------------------------------------------------------------------
[0m
[K	[1;37m	[0m[K     [1;37mUsing Arguments: ['$POC', 'foo.tif'][0m
[K	[1;37m	[0m[K     [1;37mUsing Input File: /CrashRepair/experiments/vulnloc/libtiff/CVE-2016-5321/tests/1.tif[0m
[K	[1;34m	building program[0m
[K	[1;34m		setting environment variables[0m
[K	[1;34m		cleaning files[0m
[K	[1;34m		configuring program[0m
[K	[1;34m		compiling program[0m
[K	[1;37m	[0m[K     [1;37mUsing Binary: /data/vulnloc/libtiff/CVE-2016-5321/src/tools/tiffcrop[0m
[K	[1;34m	extracting bytecode[0m
[K	[1;34m	executing klee in concrete mode[0m
[K	[1;34m	extracting instruction trace[0m
[K	[1;37m		[note] program did not crash[0m
[K	[1;33m		[note]: the program did not crash[0m
[K	[1;37m
Run time statistics:
-----------------------
[0m
[K	[1;37mStartup: 0.000 minutes[0m
[K	[1;37mBuild: 0 minutes[0m
[K	[1;37mConcrete Analysis: 0 minutes[0m
[K	[1;37mConcolic Analysis: 0 minutes[0m
[K	[1;37mTotal Analysis: 0 minutes[0m
[K	[1;37mLocalization: 0 minutes[0m
[K[1;32m
CRepair finished successfully after 0.434 minutes 
[0m
2025-02-03 22:07:15.299 | INFO     | scenario:analyze_for_guide:592 - analysis failed for candidate patch #3: analysis failed: no localization file was produced
2025-02-03 22:07:15.307 | INFO     | scenario:analyze_for_guide:558 - reanalyzing candidate patch: #4:
@@ -948,152 +948,159 @@
   return status;
   }
 
-static int  readSeparateTilesIntoBuffer (TIFF* in, uint8 *obuf, 
-					 uint32 imagelength, uint32 imagewidth, 
+
+static int readSeparateTilesIntoBuffer (TIFF* in, uint8 *obuf, 
+                                         uint32 imagelength, uint32 imagewidth, 
                                          uint32 tw, uint32 tl,
                                          uint16 spp, uint16 bps)
-  {
-  int     i, status = 1, sample;
-  int     shift_width, bytes_per_pixel;
-  uint16  bytes_per_sample;
-  uint32  row, col;     /* Current row and col of image */
-  uint32  nrow, ncol;   /* Number of rows and cols in current tile */
-  uint32  row_offset, col_offset; /* Output buffer offsets */
-  tsize_t tbytes = 0, tilesize = TIFFTileSize(in);
-  tsample_t s;
-  uint8*  bufp = (uint8*)obuf;
-  unsigned char *srcbuffs[MAX_SAMPLES];
-  unsigned char *tbuff = NULL;
-
-  bytes_per_sample = (bps + 7) / 8;
+{
+    int     i, status = 1, sample;
+    int     shift_width, bytes_per_pixel;
+    uint16  bytes_per_sample;
+    uint32  row, col;     /* Current row and col of image */
+    uint32  nrow, ncol;   /* Number of rows and cols in current tile */
+    uint32  row_offset, col_offset; /* Output buffer offsets */
+    tsize_t tbytes = 0, tilesize = TIFFTileSize(in);
+    tsample_t s;
+    uint8*  bufp = (uint8*)obuf;
+    unsigned char *srcbuffs[MAX_SAMPLES];
+    unsigned char *tbuff = NULL;
+
+    bytes_per_sample = (bps + 7) / 8;
+
+    if (spp > MAX_SAMPLES) {
+        TIFFError("readSeparateTilesIntoBuffer", "Samples per pixel exceed maximum allowed");
+        return 0;
+    }
 
-  for (sample = 0; (sample < spp) && (sample < MAX_SAMPLES); sample++)
+    for (sample = 0; (sample < spp) && (sample < MAX_SAMPLES); sample++)
     {
-    srcbuffs[sample] = NULL;
-    tbuff = (unsigned char *)_TIFFmalloc(tilesize + 8);
-    if (!tbuff)
-      {
-      TIFFError ("readSeparateTilesIntoBuffer", 
-                 "Unable to allocate tile read buffer for sample %d", sample);
-      for (i = 0; i < sample; i++)
-        _TIFFfree (srcbuffs[i]);
-      return 0;
-      }
-    srcbuffs[sample] = tbuff;
+        srcbuffs[sample] = NULL;
+        tbuff = (unsigned char *)_TIFFmalloc(tilesize + 8);
+        if (!tbuff)
+        {
+            TIFFError ("readSeparateTilesIntoBuffer", 
+                        "Unable to allocate tile read buffer for sample %d", sample);
+            for (i = 0; i < sample; i++)
+                _TIFFfree (srcbuffs[i]);
+            return 0;
+        }
+        srcbuffs[sample] = tbuff;
     } 
-  /* Each tile contains only the data for a single plane
-   * arranged in scanlines of tw * bytes_per_sample bytes.
-   */
-  for (row = 0; row < imagelength; row += tl)
+    /* Each tile contains only the data for a single plane
+     * arranged in scanlines of tw * bytes_per_sample bytes.
+     */
+    for (row = 0; row < imagelength; row += tl)
     {
-    nrow = (row + tl > imagelength) ? imagelength - row : tl;
-    for (col = 0; col < imagewidth; col += tw)
-      {
-      for (s = 0; s < spp; s++)
-        {  /* Read each plane of a tile set into srcbuffs[s] */
-	tbytes = TIFFReadTile(in, srcbuffs[s], col, row, 0, s);
-        if (tbytes < 0  && !ignore)
-          {
-	  TIFFError(TIFFFileName(in),
-                 "Error, can't read tile for row %lu col %lu, "
-		 "sample %lu",
-		 (unsigned long) col, (unsigned long) row,
-		 (unsigned long) s);
-		 status = 0;
-          for (sample = 0; (sample < spp) && (sample < MAX_SAMPLES); sample++)
-            {
-            tbuff = srcbuffs[sample];
-            if (tbuff != NULL)
-              _TIFFfree(tbuff);
+        nrow = (row + tl > imagelength) ? imagelength - row : tl;
+        for (col = 0; col < imagewidth; col += tw)
+        {
+            for (s = 0; s < spp; s++)
+            {  /* Read each plane of a tile set into srcbuffs[s] */
+                tbytes = TIFFReadTile(in, srcbuffs[s], col, row, 0, s);
+                if (tbytes < 0  && !ignore)
+                {
+                    TIFFError(TIFFFileName(in),
+                              "Error, can't read tile for row %lu col %lu, "
+                              "sample %lu",
+                              (unsigned long) col, (unsigned long) row,
+                              (unsigned long) s);
+                    status = 0;
+                    for (sample = 0; (sample < spp) && (sample < MAX_SAMPLES); sample++)
+                    {
+                        tbuff = srcbuffs[sample];
+                        if (tbuff != NULL)
+                            _TIFFfree(tbuff);
+                    }
+                    return status;
+                }
             }
-          return status;
-	  }
-	}
-     /* Tiles on the right edge may be padded out to tw 
-      * which must be a multiple of 16.
-      * Ncol represents the visible (non padding) portion.  
-      */
-      if (col + tw > imagewidth)
-        ncol = imagewidth - col;
-      else
-        ncol = tw;
-
-      row_offset = row * (((imagewidth * spp * bps) + 7) / 8);
-      col_offset = ((col * spp * bps) + 7) / 8;
-      bufp = obuf + row_offset + col_offset;
+            /* Tiles on the right edge may be padded out to tw 
+             * which must be a multiple of 16.
+             * Ncol represents the visible (non padding) portion.  
+             */
+            if (col + tw > imagewidth)
+                ncol = imagewidth - col;
+            else
+                ncol = tw;
+
+            row_offset = row * (((imagewidth * spp * bps) + 7) / 8);
+            col_offset = ((col * spp * bps) + 7) / 8;
+            bufp = obuf + row_offset + col_offset;
 
-      if ((bps % 8) == 0)
-        {
-        if (combineSeparateTileSamplesBytes(srcbuffs, bufp, ncol, nrow, imagewidth,
-					    tw, spp, bps, NULL, 0, 0))
-	  {
-          status = 0;
-          break;
-      	  }
-	}
-      else
-        {
-        bytes_per_pixel  = ((bps * spp) + 7) / 8;
-        if (bytes_per_pixel < (bytes_per_sample + 1))
-          shift_width = bytes_per_pixel;
-        else
-          shift_width = bytes_per_sample + 1;
-
-        switch (shift_width)
-          {
-          case 1: if (combineSeparateTileSamples8bits (srcbuffs, bufp, ncol, nrow,
-                                                       imagewidth, tw, spp, bps, 
-						       NULL, 0, 0))
-	            {
+            if ((bps % 8) == 0)
+            {
+                if (combineSeparateTileSamplesBytes(srcbuffs, bufp, ncol, nrow, imagewidth,
+                                                     tw, spp, bps, NULL, 0, 0))
+                {
                     status = 0;
                     break;
-      	            }
-	          break;
-          case 2: if (combineSeparateTileSamples16bits (srcbuffs, bufp, ncol, nrow,
-                                                       imagewidth, tw, spp, bps, 
-						       NULL, 0, 0))
-	            {
-                    status = 0;
+                }
+            }
+            else
+            {
+                bytes_per_pixel  = ((bps * spp) + 7) / 8;
+                if (bytes_per_pixel < (bytes_per_sample + 1))
+                    shift_width = bytes_per_pixel;
+                else
+                    shift_width = bytes_per_sample + 1;
+
+                switch (shift_width)
+                {
+                case 1: if (combineSeparateTileSamples8bits (srcbuffs, bufp, ncol, nrow,
+                                                             imagewidth, tw, spp, bps, 
+                                                             NULL, 0, 0))
+                    {
+                        status = 0;
+                        break;
+                    }
                     break;
-		    }
-	          break;
-          case 3: if (combineSeparateTileSamples24bits (srcbuffs, bufp, ncol, nrow,
-                                                       imagewidth, tw, spp, bps, 
-						       NULL, 0, 0))
-	            {
-                    status = 0;
+                case 2: if (combineSeparateTileSamples16bits (srcbuffs, bufp, ncol, nrow,
+                                                             imagewidth, tw, spp, bps, 
+                                                             NULL, 0, 0))
+                    {
+                        status = 0;
+                        break;
+                    }
                     break;
-       	            }
-                  break;
-          case 4: 
-          case 5:
-          case 6:
-          case 7:
-          case 8: if (combineSeparateTileSamples32bits (srcbuffs, bufp, ncol, nrow,
-                                                       imagewidth, tw, spp, bps, 
-						       NULL, 0, 0))
-	            {
-                    status = 0;
+                case 3: if (combineSeparateTileSamples24bits (srcbuffs, bufp, ncol, nrow,
+                                                             imagewidth, tw, spp, bps, 
+                                                             NULL, 0, 0))
+                    {
+                        status = 0;
+                        break;
+                    }
+                    break;
+                case 4: 
+                case 5:
+                case 6:
+                case 7:
+                case 8: if (combineSeparateTileSamples32bits (srcbuffs, bufp, ncol, nrow,
+                                                             imagewidth, tw, spp, bps, 
+                                                             NULL, 0, 0))
+                    {
+                        status = 0;
+                        break;
+                    }
                     break;
-		    }
-	          break;
-          default: TIFFError ("readSeparateTilesIntoBuffer", "Unsupported bit depth: %d", bps);
-                  status = 0;
-                  break;
-          }
+                default: TIFFError ("readSeparateTilesIntoBuffer", "Unsupported bit depth: %d", bps);
+                         status = 0;
+                         break;
+                }
+            }
         }
-      }
     }
 
-  for (sample = 0; (sample < spp) && (sample < MAX_SAMPLES); sample++)
+    for (sample = 0; (sample < spp) && (sample < MAX_SAMPLES); sample++)
     {
-    tbuff = srcbuffs[sample];
-    if (tbuff != NULL)
-      _TIFFfree(tbuff);
+        tbuff = srcbuffs[sample];
+        if (tbuff != NULL)
+            _TIFFfree(tbuff);
     }
- 
-  return status;
-  }
+
+    return status;
+}
+
 
 static int writeBufferToContigStrips(TIFF* out, uint8* buf, uint32 imagelength)
   {

2025-02-03 22:07:15.318 | DEBUG    | scenario:rebuild:369 - original environment: environ({'CONDA_SHLVL': '2', 'LC_ALL': 'C.UTF-8', 'LS_COLORS': 'rs=0:di=01;34:ln=01;36:mh=00:pi=40;33:so=01;35:do=01;35:bd=40;33;01:cd=40;33;01:or=40;31;01:mi=00:su=37;41:sg=30;43:ca=30;41:tw=30;42:ow=34;42:st=37;44:ex=01;32:*.tar=01;31:*.tgz=01;31:*.arc=01;31:*.arj=01;31:*.taz=01;31:*.lha=01;31:*.lz4=01;31:*.lzh=01;31:*.lzma=01;31:*.tlz=01;31:*.txz=01;31:*.tzo=01;31:*.t7z=01;31:*.zip=01;31:*.z=01;31:*.Z=01;31:*.dz=01;31:*.gz=01;31:*.lrz=01;31:*.lz=01;31:*.lzo=01;31:*.xz=01;31:*.zst=01;31:*.tzst=01;31:*.bz2=01;31:*.bz=01;31:*.tbz=01;31:*.tbz2=01;31:*.tz=01;31:*.deb=01;31:*.rpm=01;31:*.jar=01;31:*.war=01;31:*.ear=01;31:*.sar=01;31:*.rar=01;31:*.alz=01;31:*.ace=01;31:*.zoo=01;31:*.cpio=01;31:*.7z=01;31:*.rz=01;31:*.cab=01;31:*.wim=01;31:*.swm=01;31:*.dwm=01;31:*.esd=01;31:*.jpg=01;35:*.jpeg=01;35:*.mjpg=01;35:*.mjpeg=01;35:*.gif=01;35:*.bmp=01;35:*.pbm=01;35:*.pgm=01;35:*.ppm=01;35:*.tga=01;35:*.xbm=01;35:*.xpm=01;35:*.tif=01;35:*.tiff=01;35:*.png=01;35:*.svg=01;35:*.svgz=01;35:*.mng=01;35:*.pcx=01;35:*.mov=01;35:*.mpg=01;35:*.mpeg=01;35:*.m2v=01;35:*.mkv=01;35:*.webm=01;35:*.ogm=01;35:*.mp4=01;35:*.m4v=01;35:*.mp4v=01;35:*.vob=01;35:*.qt=01;35:*.nuv=01;35:*.wmv=01;35:*.asf=01;35:*.rm=01;35:*.rmvb=01;35:*.flc=01;35:*.avi=01;35:*.fli=01;35:*.flv=01;35:*.gl=01;35:*.dl=01;35:*.xcf=01;35:*.xwd=01;35:*.yuv=01;35:*.cgm=01;35:*.emf=01;35:*.ogv=01;35:*.ogx=01;35:*.aac=00;36:*.au=00;36:*.flac=00;36:*.m4a=00;36:*.mid=00;36:*.midi=00;36:*.mka=00;36:*.mp3=00;36:*.mpc=00;36:*.ogg=00;36:*.ra=00;36:*.wav=00;36:*.oga=00;36:*.opus=00;36:*.spx=00;36:*.xspf=00;36:', 'LD_LIBRARY_PATH': '/opt/crashrepair/lib:/CrashRepair/lib:/klee/build/lib:', 'CONDA_EXE': '/root/anaconda3/bin/conda', 'LANG': 'C.UTF-8', 'TZ': 'Asia/Shanghai', 'HOSTNAME': 'fea22102047d', 'OLDPWD': '/orchestrator', 'CONDA_PREFIX': '/root/anaconda3/envs/CrashRepair', '_CE_M': '', 'CC': 'crepair-cc', 'LLVM_COMPILER': 'clang', 'CONDA_PREFIX_1': '/root/anaconda3', 'PWD': '/orchestrator/crashrepair', 'HOME': '/root', 'CONDA_PYTHON_EXE': '/root/anaconda3/bin/python', '_CE_CONDA': '', 'CONDA_PROMPT_MODIFIER': '(CrashRepair) ', 'CXX': 'crepair-cxx', 'TERM': 'xterm', 'SHLVL': '2', 'PYTHONPATH': '/usr/lib/python3.8/site-packages:', 'PATH': '/root/anaconda3/envs/CrashRepair/bin:/root/anaconda3/condabin:~/anaconda3/bin:/opt/crashrepair/bin:/CrashRepair/compiler:/klee/build/bin:/opt/llvm-6/bin:/klee/build/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', 'CONDA_DEFAULT_ENV': 'CrashRepair', '_': '/root/anaconda3/envs/CrashRepair/bin/python'})
2025-02-03 22:07:15.318 | DEBUG    | scenario:rebuild:382 - injecting ghost function into CFLAGS during build: -lcrepair_ghost
2025-02-03 22:07:15.318 | DEBUG    | scenario:rebuild:398 - using environment: {'INJECT_CFLAGS': '-g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address', 'INJECT_CXXFLAGS': '-g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address', 'INJECT_LDFLAGS': '-g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address'}
2025-02-03 22:07:15.318 | DEBUG    | shell:__call__:41 - executing: make CFLAGS="${INJECT_CFLAGS}" CXXFLAGS="${INJECT_CXXFLAGS}" LDFLAGS="${INJECT_LDFLAGS}"
Making all in port
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/port'
make[1]: Nothing to be done for 'all'.
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/port'
Making all in libtiff
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/libtiff'
make  all-am
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/libtiff'
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/libtiff'
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/libtiff'
Making all in tools
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/tools'
crepair-cc -DHAVE_CONFIG_H -I. -I../libtiff  -I../libtiff   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -MT tiffcrop.o -MD -MP -MF .deps/tiffcrop.Tpo -c -o tiffcrop.o tiffcrop.c
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_ghost: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
mv -f .deps/tiffcrop.Tpo .deps/tiffcrop.Po
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address  -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -o tiffcrop tiffcrop.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -g -O0 -Wno-error -I/CrashRepair/lib -fsanitize=address -g -O0 -Wno-error -I/CrashRepair/lib -fsanitize=address -o tiffcrop tiffcrop.o  -L/klee/build/lib -L/CrashRepair/lib -lkleeRuntest -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost ../libtiff/.libs/libtiff.a ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/tools'
Making all in build
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/build'
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/build'
make[2]: Nothing to be done for 'all-am'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/build'
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/build'
Making all in contrib
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib'
Making all in addtiffo
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/addtiffo'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/addtiffo'
Making all in dbs
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/dbs'
Making all in xtiff
make[3]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/dbs/xtiff'
make[3]: Nothing to be done for 'all'.
make[3]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/dbs/xtiff'
make[3]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/dbs'
make[3]: Nothing to be done for 'all-am'.
make[3]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/dbs'
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/dbs'
Making all in iptcutil
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/iptcutil'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/iptcutil'
Making all in mfs
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/mfs'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/mfs'
Making all in pds
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/pds'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/pds'
Making all in ras
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/ras'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/ras'
Making all in stream
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/stream'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/stream'
Making all in tags
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/tags'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/tags'
Making all in win_dib
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/win_dib'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/win_dib'
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib'
make[2]: Nothing to be done for 'all-am'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib'
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib'
Making all in test
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/test'
make[1]: Nothing to be done for 'all'.
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/test'
Making all in man
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/man'
make[1]: Nothing to be done for 'all'.
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/man'
Making all in html
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html'
Making all in images
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html/images'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html/images'
Making all in man
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html/man'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html/man'
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html'
make[2]: Nothing to be done for 'all-am'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html'
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html'
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src'
make[1]: Nothing to be done for 'all-am'.
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src'
2025-02-03 22:07:15.781 | INFO     | analyzer:run:114 - running analysis with timeout: 60 minutes
2025-02-03 22:07:15.781 | DEBUG    | analyzer:write_config_to_file:88 - generated analyzer config:

dir_exp:/data/vulnloc/libtiff/CVE-2016-5321
tag_id:libtiff_CVE-2016-5321
src_directory:/data/vulnloc/libtiff/CVE-2016-5321/src
binary_path:/data/vulnloc/libtiff/CVE-2016-5321/src/tools/tiffcrop
config_command:./configure --enable-static --disable-shared
build_command:make CFLAGS="${INJECT_CFLAGS}" CXXFLAGS="${INJECT_CXXFLAGS}" LDFLAGS="${INJECT_LDFLAGS}"
test_input_list:$POC foo.tif
poc_list:/CrashRepair/experiments/vulnloc/libtiff/CVE-2016-5321/tests/1.tif
klee_flags:--link-llvm-lib=/CrashRepair/lib/libcrepair_proxy.bca 

2025-02-03 22:07:15.781 | DEBUG    | analyzer:run:124 - wrote analyzer config file to: /tmp/tmpr4nnapk9
2025-02-03 22:07:15.781 | DEBUG    | shell:__call__:41 - executing: crepair --conf=/tmp/tmpr4nnapk9
[K[1;36m
====================================================================================================

	Starting CRepair (C Crash Repair) 
====================================================================================================
[0m
[K[1;36m
	Loading Configurations
	__________________________________________________________________________________________
[0m
[K	[1;34mreading configuration values from arguments[0m
[K	[1;34mreading configuration values form configuration file[0m
[K	[1;37m	[file] /tmp/tmpr4nnapk9[0m
[K	[1;34mupdating configuration values[0m
[K	[1;34mreading test configuration[0m
[K	[1;34mreading seed information[0m
[K	[1;37m	[config] stack size: 15000[0m
[K	[1;37m	[config] collecting stats: False[0m
[K	[1;37m	[config] number of tests: 1[0m
[K	[1;37m	[config] number of cores: 8[0m
[K	[1;37m	[config] klee concrete execution timeout: 600[0m
[K	[1;37m	[config] klee concolic execution timeout: 1200[0m
[K	[1;37m	[config] synthesize subset expressions: True[0m
[K	[1;37m	[config] window size for taint locations: 500[0m
[K	[1;37m	[config] window size for taint values: 500000[0m
[K[1;36m

	Analyzing Program
====================================================================================================
[0m
[K[1;36m
	Test Case #1
	__________________________________________________________________________________________
[0m
[K[1;36m
		Running Concrete Execution
		------------------------------------------------------------------------------------------
[0m
[K	[1;37m	[0m[K     [1;37mUsing Arguments: ['$POC', 'foo.tif'][0m
[K	[1;37m	[0m[K     [1;37mUsing Input File: /CrashRepair/experiments/vulnloc/libtiff/CVE-2016-5321/tests/1.tif[0m
[K	[1;34m	building program[0m
[K	[1;34m		setting environment variables[0m
[K	[1;34m		cleaning files[0m
[K	[1;34m		configuring program[0m
[K	[1;34m		compiling program[0m
[K	[1;37m	[0m[K     [1;37mUsing Binary: /data/vulnloc/libtiff/CVE-2016-5321/src/tools/tiffcrop[0m
[K	[1;34m	extracting bytecode[0m
[K	[1;34m	executing klee in concrete mode[0m
[K	[1;34m	extracting instruction trace[0m
[K	[1;37m		[note] program did not crash[0m
[K	[1;33m		[note]: the program did not crash[0m
[K	[1;37m
Run time statistics:
-----------------------
[0m
[K	[1;37mStartup: 0.000 minutes[0m
[K	[1;37mBuild: 0 minutes[0m
[K	[1;37mConcrete Analysis: 0 minutes[0m
[K	[1;37mConcolic Analysis: 0 minutes[0m
[K	[1;37mTotal Analysis: 0 minutes[0m
[K	[1;37mLocalization: 0 minutes[0m
[K[1;32m
CRepair finished successfully after 0.438 minutes 
[0m
2025-02-03 22:07:42.456 | INFO     | scenario:analyze_for_guide:592 - analysis failed for candidate patch #4: analysis failed: no localization file was produced
2025-02-03 22:07:42.465 | INFO     | scenario:analyze_for_guide:558 - reanalyzing candidate patch: #5:
@@ -948,152 +948,159 @@
   return status;
   }
 
-static int  readSeparateTilesIntoBuffer (TIFF* in, uint8 *obuf, 
-					 uint32 imagelength, uint32 imagewidth, 
-                                         uint32 tw, uint32 tl,
-                                         uint16 spp, uint16 bps)
-  {
-  int     i, status = 1, sample;
-  int     shift_width, bytes_per_pixel;
-  uint16  bytes_per_sample;
-  uint32  row, col;     /* Current row and col of image */
-  uint32  nrow, ncol;   /* Number of rows and cols in current tile */
-  uint32  row_offset, col_offset; /* Output buffer offsets */
-  tsize_t tbytes = 0, tilesize = TIFFTileSize(in);
-  tsample_t s;
-  uint8*  bufp = (uint8*)obuf;
-  unsigned char *srcbuffs[MAX_SAMPLES];
-  unsigned char *tbuff = NULL;
 
-  bytes_per_sample = (bps + 7) / 8;
+static int readSeparateTilesIntoBuffer(TIFF* in, uint8 *obuf, 
+                                       uint32 imagelength, uint32 imagewidth, 
+                                       uint32 tw, uint32 tl,
+                                       uint16 spp, uint16 bps)
+{
+    int i, status = 1, sample;
+    int shift_width, bytes_per_pixel;
+    uint16 bytes_per_sample;
+    uint32 row, col; /* Current row and col of image */
+    uint32 nrow, ncol; /* Number of rows and cols in current tile */
+    uint32 row_offset, col_offset; /* Output buffer offsets */
+    tsize_t tbytes = 0, tilesize = TIFFTileSize(in);
+    tsample_t s;
+    uint8* bufp = (uint8*)obuf;
+    unsigned char *srcbuffs[MAX_SAMPLES];
+    unsigned char *tbuff = NULL;
+
+    bytes_per_sample = (bps + 7) / 8;
 
-  for (sample = 0; (sample < spp) && (sample < MAX_SAMPLES); sample++)
+    for (sample = 0; (sample < spp) && (sample < MAX_SAMPLES); sample++)
     {
-    srcbuffs[sample] = NULL;
-    tbuff = (unsigned char *)_TIFFmalloc(tilesize + 8);
-    if (!tbuff)
-      {
-      TIFFError ("readSeparateTilesIntoBuffer", 
-                 "Unable to allocate tile read buffer for sample %d", sample);
-      for (i = 0; i < sample; i++)
-        _TIFFfree (srcbuffs[i]);
-      return 0;
-      }
-    srcbuffs[sample] = tbuff;
-    } 
-  /* Each tile contains only the data for a single plane
-   * arranged in scanlines of tw * bytes_per_sample bytes.
-   */
-  for (row = 0; row < imagelength; row += tl)
+        srcbuffs[sample] = NULL;
+        tbuff = (unsigned char *)_TIFFmalloc(tilesize + 8);
+        if (!tbuff)
+        {
+            TIFFError("readSeparateTilesIntoBuffer", 
+                       "Unable to allocate tile read buffer for sample %d", sample);
+            for (i = 0; i < sample; i++)
+                _TIFFfree(srcbuffs[i]);
+            return 0;
+        }
+        srcbuffs[sample] = tbuff;
+    }
+    /* Each tile contains only the data for a single plane
+     * arranged in scanlines of tw * bytes_per_sample bytes.
+     */
+    for (row = 0; row < imagelength; row += tl)
     {
-    nrow = (row + tl > imagelength) ? imagelength - row : tl;
-    for (col = 0; col < imagewidth; col += tw)
-      {
-      for (s = 0; s < spp; s++)
-        {  /* Read each plane of a tile set into srcbuffs[s] */
-	tbytes = TIFFReadTile(in, srcbuffs[s], col, row, 0, s);
-        if (tbytes < 0  && !ignore)
-          {
-	  TIFFError(TIFFFileName(in),
-                 "Error, can't read tile for row %lu col %lu, "
-		 "sample %lu",
-		 (unsigned long) col, (unsigned long) row,
-		 (unsigned long) s);
-		 status = 0;
-          for (sample = 0; (sample < spp) && (sample < MAX_SAMPLES); sample++)
-            {
-            tbuff = srcbuffs[sample];
-            if (tbuff != NULL)
-              _TIFFfree(tbuff);
+        nrow = (row + tl > imagelength) ? imagelength - row : tl;
+        for (col = 0; col < imagewidth; col += tw)
+        {
+            for (s = 0; s < spp; s++)
+            {  /* Read each plane of a tile set into srcbuffs[s] */
+                tbytes = TIFFReadTile(in, srcbuffs[s], col, row, 0, s);
+                if (tbytes < 0 && !ignore)
+                {
+                    TIFFError(TIFFFileName(in),
+                               "Error, can't read tile for row %lu col %lu, "
+                               "sample %lu",
+                               (unsigned long)col, (unsigned long)row,
+                               (unsigned long)s);
+                    status = 0;
+                    for (sample = 0; (sample < spp) && (sample < MAX_SAMPLES); sample++)
+                    {
+                        tbuff = srcbuffs[sample];
+                        if (tbuff != NULL)
+                            _TIFFfree(tbuff);
+                    }
+                    return status;
+                }
             }
-          return status;
-	  }
-	}
-     /* Tiles on the right edge may be padded out to tw 
-      * which must be a multiple of 16.
-      * Ncol represents the visible (non padding) portion.  
-      */
-      if (col + tw > imagewidth)
-        ncol = imagewidth - col;
-      else
-        ncol = tw;
-
-      row_offset = row * (((imagewidth * spp * bps) + 7) / 8);
-      col_offset = ((col * spp * bps) + 7) / 8;
-      bufp = obuf + row_offset + col_offset;
+            /* Tiles on the right edge may be padded out to tw 
+             * which must be a multiple of 16.
+             * Ncol represents the visible (non padding) portion.  
+             */
+            if (col + tw > imagewidth)
+                ncol = imagewidth - col;
+            else
+                ncol = tw;
+
+            row_offset = row * (((imagewidth * spp * bps) + 7) / 8);
+            col_offset = ((col * spp * bps) + 7) / 8;
+            bufp = obuf + row_offset + col_offset;
 
-      if ((bps % 8) == 0)
-        {
-        if (combineSeparateTileSamplesBytes(srcbuffs, bufp, ncol, nrow, imagewidth,
-					    tw, spp, bps, NULL, 0, 0))
-	  {
-          status = 0;
-          break;
-      	  }
-	}
-      else
-        {
-        bytes_per_pixel  = ((bps * spp) + 7) / 8;
-        if (bytes_per_pixel < (bytes_per_sample + 1))
-          shift_width = bytes_per_pixel;
-        else
-          shift_width = bytes_per_sample + 1;
-
-        switch (shift_width)
-          {
-          case 1: if (combineSeparateTileSamples8bits (srcbuffs, bufp, ncol, nrow,
-                                                       imagewidth, tw, spp, bps, 
-						       NULL, 0, 0))
-	            {
+            if ((bps % 8) == 0)
+            {
+                if (combineSeparateTileSamplesBytes(srcbuffs, bufp, ncol, nrow, imagewidth,
+                                                     tw, spp, bps, NULL, 0, 0))
+                {
                     status = 0;
                     break;
-      	            }
-	          break;
-          case 2: if (combineSeparateTileSamples16bits (srcbuffs, bufp, ncol, nrow,
-                                                       imagewidth, tw, spp, bps, 
-						       NULL, 0, 0))
-	            {
-                    status = 0;
+                }
+            }
+            else
+            {
+                bytes_per_pixel = ((bps * spp) + 7) / 8;
+                if (bytes_per_pixel < (bytes_per_sample + 1))
+                    shift_width = bytes_per_pixel;
+                else
+                    shift_width = bytes_per_sample + 1;
+
+                switch (shift_width)
+                {
+                case 1: 
+                    if (combineSeparateTileSamples8bits(srcbuffs, bufp, ncol, nrow,
+                                                         imagewidth, tw, spp, bps, 
+                                                         NULL, 0, 0))
+                    {
+                        status = 0;
+                        break;
+                    }
                     break;
-		    }
-	          break;
-          case 3: if (combineSeparateTileSamples24bits (srcbuffs, bufp, ncol, nrow,
-                                                       imagewidth, tw, spp, bps, 
-						       NULL, 0, 0))
-	            {
-                    status = 0;
+                case 2: 
+                    if (combineSeparateTileSamples16bits(srcbuffs, bufp, ncol, nrow,
+                                                          imagewidth, tw, spp, bps, 
+                                                          NULL, 0, 0))
+                    {
+                        status = 0;
+                        break;
+                    }
+                    break;
+                case 3: 
+                    if (combineSeparateTileSamples24bits(srcbuffs, bufp, ncol, nrow,
+                                                          imagewidth, tw, spp, bps, 
+                                                          NULL, 0, 0))
+                    {
+                        status = 0;
+                        break;
+                    }
+                    break;
+                case 4: 
+                case 5:
+                case 6:
+                case 7:
+                case 8: 
+                    if (combineSeparateTileSamples32bits(srcbuffs, bufp, ncol, nrow,
+                                                          imagewidth, tw, spp, bps, 
+                                                          NULL, 0, 0))
+                    {
+                        status = 0;
+                        break;
+                    }
                     break;
-       	            }
-                  break;
-          case 4: 
-          case 5:
-          case 6:
-          case 7:
-          case 8: if (combineSeparateTileSamples32bits (srcbuffs, bufp, ncol, nrow,
-                                                       imagewidth, tw, spp, bps, 
-						       NULL, 0, 0))
-	            {
+                default: 
+                    TIFFError("readSeparateTilesIntoBuffer", "Unsupported bit depth: %d", bps);
                     status = 0;
                     break;
-		    }
-	          break;
-          default: TIFFError ("readSeparateTilesIntoBuffer", "Unsupported bit depth: %d", bps);
-                  status = 0;
-                  break;
-          }
+                }
+            }
         }
-      }
     }
 
-  for (sample = 0; (sample < spp) && (sample < MAX_SAMPLES); sample++)
+    for (sample = 0; (sample < spp) && (sample < MAX_SAMPLES); sample++)
     {
-    tbuff = srcbuffs[sample];
-    if (tbuff != NULL)
-      _TIFFfree(tbuff);
+        tbuff = srcbuffs[sample];
+        if (tbuff != NULL)
+            _TIFFfree(tbuff);
     }
- 
-  return status;
-  }
+
+    return status;
+}
+
 
 static int writeBufferToContigStrips(TIFF* out, uint8* buf, uint32 imagelength)
   {

2025-02-03 22:07:42.470 | DEBUG    | scenario:rebuild:369 - original environment: environ({'CONDA_SHLVL': '2', 'LC_ALL': 'C.UTF-8', 'LS_COLORS': 'rs=0:di=01;34:ln=01;36:mh=00:pi=40;33:so=01;35:do=01;35:bd=40;33;01:cd=40;33;01:or=40;31;01:mi=00:su=37;41:sg=30;43:ca=30;41:tw=30;42:ow=34;42:st=37;44:ex=01;32:*.tar=01;31:*.tgz=01;31:*.arc=01;31:*.arj=01;31:*.taz=01;31:*.lha=01;31:*.lz4=01;31:*.lzh=01;31:*.lzma=01;31:*.tlz=01;31:*.txz=01;31:*.tzo=01;31:*.t7z=01;31:*.zip=01;31:*.z=01;31:*.Z=01;31:*.dz=01;31:*.gz=01;31:*.lrz=01;31:*.lz=01;31:*.lzo=01;31:*.xz=01;31:*.zst=01;31:*.tzst=01;31:*.bz2=01;31:*.bz=01;31:*.tbz=01;31:*.tbz2=01;31:*.tz=01;31:*.deb=01;31:*.rpm=01;31:*.jar=01;31:*.war=01;31:*.ear=01;31:*.sar=01;31:*.rar=01;31:*.alz=01;31:*.ace=01;31:*.zoo=01;31:*.cpio=01;31:*.7z=01;31:*.rz=01;31:*.cab=01;31:*.wim=01;31:*.swm=01;31:*.dwm=01;31:*.esd=01;31:*.jpg=01;35:*.jpeg=01;35:*.mjpg=01;35:*.mjpeg=01;35:*.gif=01;35:*.bmp=01;35:*.pbm=01;35:*.pgm=01;35:*.ppm=01;35:*.tga=01;35:*.xbm=01;35:*.xpm=01;35:*.tif=01;35:*.tiff=01;35:*.png=01;35:*.svg=01;35:*.svgz=01;35:*.mng=01;35:*.pcx=01;35:*.mov=01;35:*.mpg=01;35:*.mpeg=01;35:*.m2v=01;35:*.mkv=01;35:*.webm=01;35:*.ogm=01;35:*.mp4=01;35:*.m4v=01;35:*.mp4v=01;35:*.vob=01;35:*.qt=01;35:*.nuv=01;35:*.wmv=01;35:*.asf=01;35:*.rm=01;35:*.rmvb=01;35:*.flc=01;35:*.avi=01;35:*.fli=01;35:*.flv=01;35:*.gl=01;35:*.dl=01;35:*.xcf=01;35:*.xwd=01;35:*.yuv=01;35:*.cgm=01;35:*.emf=01;35:*.ogv=01;35:*.ogx=01;35:*.aac=00;36:*.au=00;36:*.flac=00;36:*.m4a=00;36:*.mid=00;36:*.midi=00;36:*.mka=00;36:*.mp3=00;36:*.mpc=00;36:*.ogg=00;36:*.ra=00;36:*.wav=00;36:*.oga=00;36:*.opus=00;36:*.spx=00;36:*.xspf=00;36:', 'LD_LIBRARY_PATH': '/opt/crashrepair/lib:/CrashRepair/lib:/klee/build/lib:', 'CONDA_EXE': '/root/anaconda3/bin/conda', 'LANG': 'C.UTF-8', 'TZ': 'Asia/Shanghai', 'HOSTNAME': 'fea22102047d', 'OLDPWD': '/orchestrator', 'CONDA_PREFIX': '/root/anaconda3/envs/CrashRepair', '_CE_M': '', 'CC': 'crepair-cc', 'LLVM_COMPILER': 'clang', 'CONDA_PREFIX_1': '/root/anaconda3', 'PWD': '/orchestrator/crashrepair', 'HOME': '/root', 'CONDA_PYTHON_EXE': '/root/anaconda3/bin/python', '_CE_CONDA': '', 'CONDA_PROMPT_MODIFIER': '(CrashRepair) ', 'CXX': 'crepair-cxx', 'TERM': 'xterm', 'SHLVL': '2', 'PYTHONPATH': '/usr/lib/python3.8/site-packages:', 'PATH': '/root/anaconda3/envs/CrashRepair/bin:/root/anaconda3/condabin:~/anaconda3/bin:/opt/crashrepair/bin:/CrashRepair/compiler:/klee/build/bin:/opt/llvm-6/bin:/klee/build/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', 'CONDA_DEFAULT_ENV': 'CrashRepair', '_': '/root/anaconda3/envs/CrashRepair/bin/python'})
2025-02-03 22:07:42.470 | DEBUG    | scenario:rebuild:382 - injecting ghost function into CFLAGS during build: -lcrepair_ghost
2025-02-03 22:07:42.470 | DEBUG    | scenario:rebuild:398 - using environment: {'INJECT_CFLAGS': '-g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address', 'INJECT_CXXFLAGS': '-g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address', 'INJECT_LDFLAGS': '-g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address'}
2025-02-03 22:07:42.471 | DEBUG    | shell:__call__:41 - executing: make CFLAGS="${INJECT_CFLAGS}" CXXFLAGS="${INJECT_CXXFLAGS}" LDFLAGS="${INJECT_LDFLAGS}"
Making all in port
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/port'
make[1]: Nothing to be done for 'all'.
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/port'
Making all in libtiff
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/libtiff'
make  all-am
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/libtiff'
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/libtiff'
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/libtiff'
Making all in tools
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/tools'
crepair-cc -DHAVE_CONFIG_H -I. -I../libtiff  -I../libtiff   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -MT tiffcrop.o -MD -MP -MF .deps/tiffcrop.Tpo -c -o tiffcrop.o tiffcrop.c
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_ghost: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
mv -f .deps/tiffcrop.Tpo .deps/tiffcrop.Po
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address  -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -o tiffcrop tiffcrop.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -g -O0 -Wno-error -I/CrashRepair/lib -fsanitize=address -g -O0 -Wno-error -I/CrashRepair/lib -fsanitize=address -o tiffcrop tiffcrop.o  -L/klee/build/lib -L/CrashRepair/lib -lkleeRuntest -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost ../libtiff/.libs/libtiff.a ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/tools'
Making all in build
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/build'
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/build'
make[2]: Nothing to be done for 'all-am'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/build'
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/build'
Making all in contrib
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib'
Making all in addtiffo
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/addtiffo'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/addtiffo'
Making all in dbs
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/dbs'
Making all in xtiff
make[3]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/dbs/xtiff'
make[3]: Nothing to be done for 'all'.
make[3]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/dbs/xtiff'
make[3]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/dbs'
make[3]: Nothing to be done for 'all-am'.
make[3]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/dbs'
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/dbs'
Making all in iptcutil
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/iptcutil'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/iptcutil'
Making all in mfs
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/mfs'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/mfs'
Making all in pds
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/pds'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/pds'
Making all in ras
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/ras'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/ras'
Making all in stream
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/stream'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/stream'
Making all in tags
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/tags'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/tags'
Making all in win_dib
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/win_dib'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/win_dib'
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib'
make[2]: Nothing to be done for 'all-am'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib'
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib'
Making all in test
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/test'
make[1]: Nothing to be done for 'all'.
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/test'
Making all in man
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/man'
make[1]: Nothing to be done for 'all'.
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/man'
Making all in html
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html'
Making all in images
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html/images'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html/images'
Making all in man
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html/man'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html/man'
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html'
make[2]: Nothing to be done for 'all-am'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html'
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html'
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src'
make[1]: Nothing to be done for 'all-am'.
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src'
2025-02-03 22:07:42.977 | INFO     | analyzer:run:114 - running analysis with timeout: 60 minutes
2025-02-03 22:07:42.977 | DEBUG    | analyzer:write_config_to_file:88 - generated analyzer config:

dir_exp:/data/vulnloc/libtiff/CVE-2016-5321
tag_id:libtiff_CVE-2016-5321
src_directory:/data/vulnloc/libtiff/CVE-2016-5321/src
binary_path:/data/vulnloc/libtiff/CVE-2016-5321/src/tools/tiffcrop
config_command:./configure --enable-static --disable-shared
build_command:make CFLAGS="${INJECT_CFLAGS}" CXXFLAGS="${INJECT_CXXFLAGS}" LDFLAGS="${INJECT_LDFLAGS}"
test_input_list:$POC foo.tif
poc_list:/CrashRepair/experiments/vulnloc/libtiff/CVE-2016-5321/tests/1.tif
klee_flags:--link-llvm-lib=/CrashRepair/lib/libcrepair_proxy.bca 

2025-02-03 22:07:42.977 | DEBUG    | analyzer:run:124 - wrote analyzer config file to: /tmp/tmpdmn0pvmk
2025-02-03 22:07:42.977 | DEBUG    | shell:__call__:41 - executing: crepair --conf=/tmp/tmpdmn0pvmk
[K[1;36m
====================================================================================================

	Starting CRepair (C Crash Repair) 
====================================================================================================
[0m
[K[1;36m
	Loading Configurations
	__________________________________________________________________________________________
[0m
[K	[1;34mreading configuration values from arguments[0m
[K	[1;34mreading configuration values form configuration file[0m
[K	[1;37m	[file] /tmp/tmpdmn0pvmk[0m
[K	[1;34mupdating configuration values[0m
[K	[1;34mreading test configuration[0m
[K	[1;34mreading seed information[0m
[K	[1;37m	[config] stack size: 15000[0m
[K	[1;37m	[config] collecting stats: False[0m
[K	[1;37m	[config] number of tests: 1[0m
[K	[1;37m	[config] number of cores: 8[0m
[K	[1;37m	[config] klee concrete execution timeout: 600[0m
[K	[1;37m	[config] klee concolic execution timeout: 1200[0m
[K	[1;37m	[config] synthesize subset expressions: True[0m
[K	[1;37m	[config] window size for taint locations: 500[0m
[K	[1;37m	[config] window size for taint values: 500000[0m
[K[1;36m

	Analyzing Program
====================================================================================================
[0m
[K[1;36m
	Test Case #1
	__________________________________________________________________________________________
[0m
[K[1;36m
		Running Concrete Execution
		------------------------------------------------------------------------------------------
[0m
[K	[1;37m	[0m[K     [1;37mUsing Arguments: ['$POC', 'foo.tif'][0m
[K	[1;37m	[0m[K     [1;37mUsing Input File: /CrashRepair/experiments/vulnloc/libtiff/CVE-2016-5321/tests/1.tif[0m
[K	[1;34m	building program[0m
[K	[1;34m		setting environment variables[0m
[K	[1;34m		cleaning files[0m
[K	[1;34m		configuring program[0m
[K	[1;34m		compiling program[0m
[K	[1;37m	[0m[K     [1;37mUsing Binary: /data/vulnloc/libtiff/CVE-2016-5321/src/tools/tiffcrop[0m
[K	[1;34m	extracting bytecode[0m
[K	[1;34m	executing klee in concrete mode[0m
[K	[1;34m	extracting instruction trace[0m
[K	[1;37m		[note] program crashed[0m
[K	[1;34m	collecting tainted expressions[0m
[K	[1;34m	collecting tainted concrete values[0m
[K	[1;34m	collecting memory allocations/de-allocations[0m
[K	[1;34m	collecting pointer mapping[0m
[K	[1;34m	extracting crash information[0m
[K	[1;37m		[0m[K     [1;37m[info] crash type: memory read overflow[0m
[K	[1;37m		[0m[K     [1;37m[info] crash location:
                             /data/vulnloc/libtiff/CVE-2016-5321/src/tools/tiffcrop.c:995:43[0m
[K	[1;37m		[0m[K     [1;37m[info] crash function: readSeparateTilesIntoBuffer[0m
[K	[1;37m		[0m[K     [1;37m[info] crash address: 116502[0m
[K	[1;37m		[0m[K     [1;37m[info] crash free constraint: ((8 * @var(integer, s)) < 64)[0m
[K	[1;37m		[0m[K     [1;37m[info] crash inducing variables: s[0m
[K	[1;37m			[info] identified crash type: memory read overflow[0m
[K[1;36m
		Running Concolic Execution
		------------------------------------------------------------------------------------------
[0m
[K	[1;37m	[0m[K     [1;37mUsing Arguments: ['$POC', 'foo.tif'][0m
[K	[1;37m	[0m[K     [1;37mUsing Input File: /CrashRepair/experiments/vulnloc/libtiff/CVE-2016-5321/tests/1.tif[0m
[K	[1;34m	building program[0m
[K	[1;34m		setting environment variables[0m
[K	[1;34m		cleaning files[0m
[K	[1;34m		configuring program[0m
[K	[1;34m		compiling program[0m
[K	[1;34m	extracting bytecode[0m
[K	[1;34m	generating ktest file[0m
[K	[1;34m	executing klee in concolic mode[0m
[K	[1;34m	extracting largest symbolic path[0m
[K	[1;34m	extracting instruction trace[0m
[K	[1;37m		[note] program crashed[0m
[K	[1;34m	collecting tainted expressions[0m
[K	[1;34m	collecting memory allocations/de-allocations[0m
[K	[1;34m	collecting pointer mapping[0m
[K	[1;37m		[0m[K     [1;37m[info] Symbolic Mapping: s -> [][0m
[K[1;36m

	Fix Localization
====================================================================================================
[0m
[K[1;36m
	Generating Fix Locations
	__________________________________________________________________________________________
[0m
[K	[1;34m	generating taint map[0m
[K	[1;37m		[0m[K     [1;37m[info] found 10854 tainted locations[0m
[K	[1;34m		starting parallel computing[0m
[K	[1;34m		waiting for thread completion[0m
[K	[1;37m		[0m[K     [1;37m[info] found 5 source files[0m
[K	[1;37m		[0m[K     [1;37m[info] found 12 executed functions[0m
[K	[1;34m	generating possible fix locations[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] readSeparateTilesIntoBuffer,
                             /data/vulnloc/libtiff/CVE-2016-5321/src/tools/tiffcrop.c:993:35[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] readSeparateTilesIntoBuffer,
                             /data/vulnloc/libtiff/CVE-2016-5321/src/tools/tiffcrop.c:996:28[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] readSeparateTilesIntoBuffer,
                             /data/vulnloc/libtiff/CVE-2016-5321/src/tools/tiffcrop.c:996:21[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] readSeparateTilesIntoBuffer,
                             /data/vulnloc/libtiff/CVE-2016-5321/src/tools/tiffcrop.c:995:24[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] readSeparateTilesIntoBuffer,
                             /data/vulnloc/libtiff/CVE-2016-5321/src/tools/tiffcrop.c:995:26[0m
[K[1;36m
	Localizing Constraints
	__________________________________________________________________________________________
[0m
[K[1;36m
		[fix-loc] /data/vulnloc/libtiff/CVE-2016-5321/src/tools/tiffcrop.c:993:13
		------------------------------------------------------------------------------------------
[0m
[K	[1;37m	[0m[K     [1;37m[constraint] ((8 * @var(integer, s)) < 64)[0m
[K[1;36m
		[fix-loc] /data/vulnloc/libtiff/CVE-2016-5321/src/tools/tiffcrop.c:995:26
		------------------------------------------------------------------------------------------
[0m
[K	[1;37m	[0m[K     [1;37m[constraint] ((8 * @var(integer, s)) < 64)[0m
[K[1;36m
		[fix-loc] /data/vulnloc/libtiff/CVE-2016-5321/src/tools/tiffcrop.c:996:17
		------------------------------------------------------------------------------------------
[0m
[K	[1;37m	[0m[K     [1;37m[constraint] ((8 * @var(integer, s)) < 64)[0m
[K[1;36m
		[fix-loc] /data/vulnloc/libtiff/CVE-2016-5321/src/tools/tiffcrop.c:995:17
		------------------------------------------------------------------------------------------
[0m
[K	[1;37m	[0m[K     [1;37m[constraint] ((8 * @var(integer, s)) < 64)[0m
[K[1;32m
	localization information saved at /CrashRepair/output/libtiff_CVE-2016-5321/localization.json[0m
[K[1;32m
	state values saved at /CrashRepair/output/libtiff_CVE-2016-5321/values/[0m
[K	[1;37m
Run time statistics:
-----------------------
[0m
[K	[1;37mStartup: 0.000 minutes[0m
[K	[1;37mBuild: 0 minutes[0m
[K	[1;37mConcrete Analysis: 0.667 minutes[0m
[K	[1;37mConcolic Analysis: 0.588 minutes[0m
[K	[1;37mTotal Analysis: 1.287 minutes[0m
[K	[1;37mLocalization: 0.295 minutes[0m
[K[1;32m
CRepair finished successfully after 1.630 minutes 
[0m
2025-02-03 22:09:21.716 | WARNING  | analyzer:run:143 - analysis output directory does not exist [/data/vulnloc/libtiff/CVE-2016-5321/analysis]: creating...
2025-02-03 22:09:21.846 | INFO     | scenario:analyze_for_guide:558 - reanalyzing candidate patch: #6:
@@ -948,11 +948,12 @@
   return status;
   }
 
+
 static int  readSeparateTilesIntoBuffer (TIFF* in, uint8 *obuf, 
 					 uint32 imagelength, uint32 imagewidth, 
                                          uint32 tw, uint32 tl,
                                          uint16 spp, uint16 bps)
-  {
+{
   int     i, status = 1, sample;
   int     shift_width, bytes_per_pixel;
   uint16  bytes_per_sample;
@@ -968,51 +969,46 @@
   bytes_per_sample = (bps + 7) / 8;
 
   for (sample = 0; (sample < spp) && (sample < MAX_SAMPLES); sample++)
-    {
+  {
     srcbuffs[sample] = NULL;
     tbuff = (unsigned char *)_TIFFmalloc(tilesize + 8);
     if (!tbuff)
-      {
+    {
       TIFFError ("readSeparateTilesIntoBuffer", 
                  "Unable to allocate tile read buffer for sample %d", sample);
       for (i = 0; i < sample; i++)
         _TIFFfree (srcbuffs[i]);
       return 0;
-      }
+    }
     srcbuffs[sample] = tbuff;
-    } 
-  /* Each tile contains only the data for a single plane
-   * arranged in scanlines of tw * bytes_per_sample bytes.
-   */
+  } 
+
   for (row = 0; row < imagelength; row += tl)
-    {
+  {
     nrow = (row + tl > imagelength) ? imagelength - row : tl;
     for (col = 0; col < imagewidth; col += tw)
-      {
+    {
       for (s = 0; s < spp; s++)
-        {  /* Read each plane of a tile set into srcbuffs[s] */
-	tbytes = TIFFReadTile(in, srcbuffs[s], col, row, 0, s);
+      {  
+        tbytes = TIFFReadTile(in, srcbuffs[s], col, row, 0, s);
         if (tbytes < 0  && !ignore)
-          {
-	  TIFFError(TIFFFileName(in),
+        {
+          TIFFError(TIFFFileName(in),
                  "Error, can't read tile for row %lu col %lu, "
 		 "sample %lu",
 		 (unsigned long) col, (unsigned long) row,
 		 (unsigned long) s);
-		 status = 0;
+          status = 0;
           for (sample = 0; (sample < spp) && (sample < MAX_SAMPLES); sample++)
-            {
+          {
             tbuff = srcbuffs[sample];
             if (tbuff != NULL)
               _TIFFfree(tbuff);
-            }
+          }
           return status;
-	  }
-	}
-     /* Tiles on the right edge may be padded out to tw 
-      * which must be a multiple of 16.
-      * Ncol represents the visible (non padding) portion.  
-      */
+        }
+      }
+     
       if (col + tw > imagewidth)
         ncol = imagewidth - col;
       else
@@ -1023,16 +1019,16 @@
       bufp = obuf + row_offset + col_offset;
 
       if ((bps % 8) == 0)
-        {
+      {
         if (combineSeparateTileSamplesBytes(srcbuffs, bufp, ncol, nrow, imagewidth,
 					    tw, spp, bps, NULL, 0, 0))
-	  {
+	{
           status = 0;
           break;
-      	  }
-	}
+        }
+      }
       else
-        {
+      {
         bytes_per_pixel  = ((bps * spp) + 7) / 8;
         if (bytes_per_pixel < (bytes_per_sample + 1))
           shift_width = bytes_per_pixel;
@@ -1040,7 +1036,7 @@
           shift_width = bytes_per_sample + 1;
 
         switch (shift_width)
-          {
+        {
           case 1: if (combineSeparateTileSamples8bits (srcbuffs, bufp, ncol, nrow,
                                                        imagewidth, tw, spp, bps, 
 						       NULL, 0, 0))
@@ -1080,20 +1076,21 @@
           default: TIFFError ("readSeparateTilesIntoBuffer", "Unsupported bit depth: %d", bps);
                   status = 0;
                   break;
-          }
         }
       }
     }
+  }
 
   for (sample = 0; (sample < spp) && (sample < MAX_SAMPLES); sample++)
-    {
+  {
     tbuff = srcbuffs[sample];
     if (tbuff != NULL)
       _TIFFfree(tbuff);
-    }
+  }
  
   return status;
-  }
+}
+
 
 static int writeBufferToContigStrips(TIFF* out, uint8* buf, uint32 imagelength)
   {

2025-02-03 22:09:21.858 | DEBUG    | scenario:rebuild:369 - original environment: environ({'CONDA_SHLVL': '2', 'LC_ALL': 'C.UTF-8', 'LS_COLORS': 'rs=0:di=01;34:ln=01;36:mh=00:pi=40;33:so=01;35:do=01;35:bd=40;33;01:cd=40;33;01:or=40;31;01:mi=00:su=37;41:sg=30;43:ca=30;41:tw=30;42:ow=34;42:st=37;44:ex=01;32:*.tar=01;31:*.tgz=01;31:*.arc=01;31:*.arj=01;31:*.taz=01;31:*.lha=01;31:*.lz4=01;31:*.lzh=01;31:*.lzma=01;31:*.tlz=01;31:*.txz=01;31:*.tzo=01;31:*.t7z=01;31:*.zip=01;31:*.z=01;31:*.Z=01;31:*.dz=01;31:*.gz=01;31:*.lrz=01;31:*.lz=01;31:*.lzo=01;31:*.xz=01;31:*.zst=01;31:*.tzst=01;31:*.bz2=01;31:*.bz=01;31:*.tbz=01;31:*.tbz2=01;31:*.tz=01;31:*.deb=01;31:*.rpm=01;31:*.jar=01;31:*.war=01;31:*.ear=01;31:*.sar=01;31:*.rar=01;31:*.alz=01;31:*.ace=01;31:*.zoo=01;31:*.cpio=01;31:*.7z=01;31:*.rz=01;31:*.cab=01;31:*.wim=01;31:*.swm=01;31:*.dwm=01;31:*.esd=01;31:*.jpg=01;35:*.jpeg=01;35:*.mjpg=01;35:*.mjpeg=01;35:*.gif=01;35:*.bmp=01;35:*.pbm=01;35:*.pgm=01;35:*.ppm=01;35:*.tga=01;35:*.xbm=01;35:*.xpm=01;35:*.tif=01;35:*.tiff=01;35:*.png=01;35:*.svg=01;35:*.svgz=01;35:*.mng=01;35:*.pcx=01;35:*.mov=01;35:*.mpg=01;35:*.mpeg=01;35:*.m2v=01;35:*.mkv=01;35:*.webm=01;35:*.ogm=01;35:*.mp4=01;35:*.m4v=01;35:*.mp4v=01;35:*.vob=01;35:*.qt=01;35:*.nuv=01;35:*.wmv=01;35:*.asf=01;35:*.rm=01;35:*.rmvb=01;35:*.flc=01;35:*.avi=01;35:*.fli=01;35:*.flv=01;35:*.gl=01;35:*.dl=01;35:*.xcf=01;35:*.xwd=01;35:*.yuv=01;35:*.cgm=01;35:*.emf=01;35:*.ogv=01;35:*.ogx=01;35:*.aac=00;36:*.au=00;36:*.flac=00;36:*.m4a=00;36:*.mid=00;36:*.midi=00;36:*.mka=00;36:*.mp3=00;36:*.mpc=00;36:*.ogg=00;36:*.ra=00;36:*.wav=00;36:*.oga=00;36:*.opus=00;36:*.spx=00;36:*.xspf=00;36:', 'LD_LIBRARY_PATH': '/opt/crashrepair/lib:/CrashRepair/lib:/klee/build/lib:', 'CONDA_EXE': '/root/anaconda3/bin/conda', 'LANG': 'C.UTF-8', 'TZ': 'Asia/Shanghai', 'HOSTNAME': 'fea22102047d', 'OLDPWD': '/orchestrator', 'CONDA_PREFIX': '/root/anaconda3/envs/CrashRepair', '_CE_M': '', 'CC': 'crepair-cc', 'LLVM_COMPILER': 'clang', 'CONDA_PREFIX_1': '/root/anaconda3', 'PWD': '/orchestrator/crashrepair', 'HOME': '/root', 'CONDA_PYTHON_EXE': '/root/anaconda3/bin/python', '_CE_CONDA': '', 'CONDA_PROMPT_MODIFIER': '(CrashRepair) ', 'CXX': 'crepair-cxx', 'TERM': 'xterm', 'SHLVL': '2', 'PYTHONPATH': '/usr/lib/python3.8/site-packages:', 'PATH': '/root/anaconda3/envs/CrashRepair/bin:/root/anaconda3/condabin:~/anaconda3/bin:/opt/crashrepair/bin:/CrashRepair/compiler:/klee/build/bin:/opt/llvm-6/bin:/klee/build/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', 'CONDA_DEFAULT_ENV': 'CrashRepair', '_': '/root/anaconda3/envs/CrashRepair/bin/python'})
2025-02-03 22:09:21.858 | DEBUG    | scenario:rebuild:382 - injecting ghost function into CFLAGS during build: -lcrepair_ghost
2025-02-03 22:09:21.858 | DEBUG    | scenario:rebuild:398 - using environment: {'INJECT_CFLAGS': '-g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address', 'INJECT_CXXFLAGS': '-g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address', 'INJECT_LDFLAGS': '-g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address'}
2025-02-03 22:09:21.858 | DEBUG    | shell:__call__:41 - executing: make CFLAGS="${INJECT_CFLAGS}" CXXFLAGS="${INJECT_CXXFLAGS}" LDFLAGS="${INJECT_LDFLAGS}"
Making all in port
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/port'
make[1]: Nothing to be done for 'all'.
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/port'
Making all in libtiff
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/libtiff'
make  all-am
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/libtiff'
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/libtiff'
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/libtiff'
Making all in tools
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/tools'
crepair-cc -DHAVE_CONFIG_H -I. -I../libtiff  -I../libtiff   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -MT tiffcrop.o -MD -MP -MF .deps/tiffcrop.Tpo -c -o tiffcrop.o tiffcrop.c
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_ghost: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
mv -f .deps/tiffcrop.Tpo .deps/tiffcrop.Po
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address  -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -o tiffcrop tiffcrop.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -g -O0 -Wno-error -I/CrashRepair/lib -fsanitize=address -g -O0 -Wno-error -I/CrashRepair/lib -fsanitize=address -o tiffcrop tiffcrop.o  -L/klee/build/lib -L/CrashRepair/lib -lkleeRuntest -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost ../libtiff/.libs/libtiff.a ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/tools'
Making all in build
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/build'
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/build'
make[2]: Nothing to be done for 'all-am'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/build'
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/build'
Making all in contrib
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib'
Making all in addtiffo
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/addtiffo'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/addtiffo'
Making all in dbs
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/dbs'
Making all in xtiff
make[3]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/dbs/xtiff'
make[3]: Nothing to be done for 'all'.
make[3]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/dbs/xtiff'
make[3]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/dbs'
make[3]: Nothing to be done for 'all-am'.
make[3]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/dbs'
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/dbs'
Making all in iptcutil
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/iptcutil'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/iptcutil'
Making all in mfs
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/mfs'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/mfs'
Making all in pds
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/pds'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/pds'
Making all in ras
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/ras'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/ras'
Making all in stream
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/stream'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/stream'
Making all in tags
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/tags'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/tags'
Making all in win_dib
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/win_dib'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/win_dib'
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib'
make[2]: Nothing to be done for 'all-am'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib'
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib'
Making all in test
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/test'
make[1]: Nothing to be done for 'all'.
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/test'
Making all in man
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/man'
make[1]: Nothing to be done for 'all'.
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/man'
Making all in html
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html'
Making all in images
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html/images'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html/images'
Making all in man
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html/man'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html/man'
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html'
make[2]: Nothing to be done for 'all-am'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html'
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html'
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src'
make[1]: Nothing to be done for 'all-am'.
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src'
2025-02-03 22:09:22.354 | INFO     | analyzer:run:114 - running analysis with timeout: 60 minutes
2025-02-03 22:09:22.354 | DEBUG    | analyzer:write_config_to_file:88 - generated analyzer config:

dir_exp:/data/vulnloc/libtiff/CVE-2016-5321
tag_id:libtiff_CVE-2016-5321
src_directory:/data/vulnloc/libtiff/CVE-2016-5321/src
binary_path:/data/vulnloc/libtiff/CVE-2016-5321/src/tools/tiffcrop
config_command:./configure --enable-static --disable-shared
build_command:make CFLAGS="${INJECT_CFLAGS}" CXXFLAGS="${INJECT_CXXFLAGS}" LDFLAGS="${INJECT_LDFLAGS}"
test_input_list:$POC foo.tif
poc_list:/CrashRepair/experiments/vulnloc/libtiff/CVE-2016-5321/tests/1.tif
klee_flags:--link-llvm-lib=/CrashRepair/lib/libcrepair_proxy.bca 

2025-02-03 22:09:22.354 | DEBUG    | analyzer:run:124 - wrote analyzer config file to: /tmp/tmpnigq0uir
2025-02-03 22:09:22.354 | DEBUG    | shell:__call__:41 - executing: crepair --conf=/tmp/tmpnigq0uir
[K[1;36m
====================================================================================================

	Starting CRepair (C Crash Repair) 
====================================================================================================
[0m
[K[1;36m
	Loading Configurations
	__________________________________________________________________________________________
[0m
[K	[1;34mreading configuration values from arguments[0m
[K	[1;34mreading configuration values form configuration file[0m
[K	[1;37m	[file] /tmp/tmpnigq0uir[0m
[K	[1;34mupdating configuration values[0m
[K	[1;34mreading test configuration[0m
[K	[1;34mreading seed information[0m
[K	[1;37m	[config] stack size: 15000[0m
[K	[1;37m	[config] collecting stats: False[0m
[K	[1;37m	[config] number of tests: 1[0m
[K	[1;37m	[config] number of cores: 8[0m
[K	[1;37m	[config] klee concrete execution timeout: 600[0m
[K	[1;37m	[config] klee concolic execution timeout: 1200[0m
[K	[1;37m	[config] synthesize subset expressions: True[0m
[K	[1;37m	[config] window size for taint locations: 500[0m
[K	[1;37m	[config] window size for taint values: 500000[0m
[K[1;36m

	Analyzing Program
====================================================================================================
[0m
[K[1;36m
	Test Case #1
	__________________________________________________________________________________________
[0m
[K[1;36m
		Running Concrete Execution
		------------------------------------------------------------------------------------------
[0m
[K	[1;37m	[0m[K     [1;37mUsing Arguments: ['$POC', 'foo.tif'][0m
[K	[1;37m	[0m[K     [1;37mUsing Input File: /CrashRepair/experiments/vulnloc/libtiff/CVE-2016-5321/tests/1.tif[0m
[K	[1;34m	building program[0m
[K	[1;34m		setting environment variables[0m
[K	[1;34m		cleaning files[0m
[K	[1;34m		configuring program[0m
[K	[1;34m		compiling program[0m
[K	[1;37m	[0m[K     [1;37mUsing Binary: /data/vulnloc/libtiff/CVE-2016-5321/src/tools/tiffcrop[0m
[K	[1;34m	extracting bytecode[0m
[K	[1;34m	executing klee in concrete mode[0m
[K	[1;34m	extracting instruction trace[0m
[K	[1;37m		[note] program crashed[0m
[K	[1;34m	collecting tainted expressions[0m
[K	[1;34m	collecting tainted concrete values[0m
[K	[1;34m	collecting memory allocations/de-allocations[0m
[K	[1;34m	collecting pointer mapping[0m
[K	[1;34m	extracting crash information[0m
[K	[1;37m		[0m[K     [1;37m[info] crash type: memory read overflow[0m
[K	[1;37m		[0m[K     [1;37m[info] crash location:
                             /data/vulnloc/libtiff/CVE-2016-5321/src/tools/tiffcrop.c:993:35[0m
[K	[1;37m		[0m[K     [1;37m[info] crash function: readSeparateTilesIntoBuffer[0m
[K	[1;37m		[0m[K     [1;37m[info] crash address: 116502[0m
[K	[1;37m		[0m[K     [1;37m[info] crash free constraint: ((8 * @var(integer, s)) < 64)[0m
[K	[1;37m		[0m[K     [1;37m[info] crash inducing variables: s[0m
[K	[1;37m			[info] identified crash type: memory read overflow[0m
[K[1;36m
		Running Concolic Execution
		------------------------------------------------------------------------------------------
[0m
[K	[1;37m	[0m[K     [1;37mUsing Arguments: ['$POC', 'foo.tif'][0m
[K	[1;37m	[0m[K     [1;37mUsing Input File: /CrashRepair/experiments/vulnloc/libtiff/CVE-2016-5321/tests/1.tif[0m
[K	[1;34m	building program[0m
[K	[1;34m		setting environment variables[0m
[K	[1;34m		cleaning files[0m
[K	[1;34m		configuring program[0m
[K	[1;34m		compiling program[0m
[K	[1;34m	extracting bytecode[0m
[K	[1;34m	generating ktest file[0m
[K	[1;34m	executing klee in concolic mode[0m
[K	[1;34m	extracting largest symbolic path[0m
[K	[1;34m	extracting instruction trace[0m
[K	[1;37m		[note] program crashed[0m
[K	[1;34m	collecting tainted expressions[0m
[K	[1;34m	collecting memory allocations/de-allocations[0m
[K	[1;34m	collecting pointer mapping[0m
[K	[1;37m		[0m[K     [1;37m[info] Symbolic Mapping: s -> [][0m
[K[1;36m

	Fix Localization
====================================================================================================
[0m
[K[1;36m
	Generating Fix Locations
	__________________________________________________________________________________________
[0m
[K	[1;34m	generating taint map[0m
[K	[1;37m		[0m[K     [1;37m[info] found 10854 tainted locations[0m
[K	[1;34m		starting parallel computing[0m
[K	[1;34m		waiting for thread completion[0m
[K	[1;37m		[0m[K     [1;37m[info] found 5 source files[0m
[K	[1;37m		[0m[K     [1;37m[info] found 12 executed functions[0m
[K	[1;34m	generating possible fix locations[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] readSeparateTilesIntoBuffer,
                             /data/vulnloc/libtiff/CVE-2016-5321/src/tools/tiffcrop.c:991:29[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] readSeparateTilesIntoBuffer,
                             /data/vulnloc/libtiff/CVE-2016-5321/src/tools/tiffcrop.c:994:20[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] readSeparateTilesIntoBuffer,
                             /data/vulnloc/libtiff/CVE-2016-5321/src/tools/tiffcrop.c:994:13[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] readSeparateTilesIntoBuffer,
                             /data/vulnloc/libtiff/CVE-2016-5321/src/tools/tiffcrop.c:993:16[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] readSeparateTilesIntoBuffer,
                             /data/vulnloc/libtiff/CVE-2016-5321/src/tools/tiffcrop.c:993:18[0m
[K[1;36m
	Localizing Constraints
	__________________________________________________________________________________________
[0m
[K[1;36m
		[fix-loc] /data/vulnloc/libtiff/CVE-2016-5321/src/tools/tiffcrop.c:991:7
		------------------------------------------------------------------------------------------
[0m
[K	[1;37m	[0m[K     [1;37m[constraint] ((8 * @var(integer, s)) < 64)[0m
[K[1;36m
		[fix-loc] /data/vulnloc/libtiff/CVE-2016-5321/src/tools/tiffcrop.c:993:18
		------------------------------------------------------------------------------------------
[0m
[K	[1;37m	[0m[K     [1;37m[constraint] ((8 * @var(integer, s)) < 64)[0m
[K[1;36m
		[fix-loc] /data/vulnloc/libtiff/CVE-2016-5321/src/tools/tiffcrop.c:994:9
		------------------------------------------------------------------------------------------
[0m
[K	[1;37m	[0m[K     [1;37m[constraint] ((8 * @var(integer, s)) < 64)[0m
[K[1;36m
		[fix-loc] /data/vulnloc/libtiff/CVE-2016-5321/src/tools/tiffcrop.c:993:9
		------------------------------------------------------------------------------------------
[0m
[K	[1;37m	[0m[K     [1;37m[constraint] ((8 * @var(integer, s)) < 64)[0m
[K[1;32m
	localization information saved at /CrashRepair/output/libtiff_CVE-2016-5321/localization.json[0m
[K[1;32m
	state values saved at /CrashRepair/output/libtiff_CVE-2016-5321/values/[0m
[K	[1;37m
Run time statistics:
-----------------------
[0m
[K	[1;37mStartup: 0.000 minutes[0m
[K	[1;37mBuild: 0 minutes[0m
[K	[1;37mConcrete Analysis: 0.683 minutes[0m
[K	[1;37mConcolic Analysis: 0.563 minutes[0m
[K	[1;37mTotal Analysis: 1.277 minutes[0m
[K	[1;37mLocalization: 0.306 minutes[0m
[K[1;32m
CRepair finished successfully after 1.619 minutes 
[0m
2025-02-03 22:11:00.460 | WARNING  | analyzer:run:143 - analysis output directory does not exist [/data/vulnloc/libtiff/CVE-2016-5321/analysis]: creating...
2025-02-03 22:11:00.569 | INFO     | scenario:analyze_for_guide:558 - reanalyzing candidate patch: #7:
@@ -948,152 +948,147 @@
   return status;
   }
 
-static int  readSeparateTilesIntoBuffer (TIFF* in, uint8 *obuf, 
-					 uint32 imagelength, uint32 imagewidth, 
-                                         uint32 tw, uint32 tl,
-                                         uint16 spp, uint16 bps)
-  {
-  int     i, status = 1, sample;
-  int     shift_width, bytes_per_pixel;
-  uint16  bytes_per_sample;
-  uint32  row, col;     /* Current row and col of image */
-  uint32  nrow, ncol;   /* Number of rows and cols in current tile */
-  uint32  row_offset, col_offset; /* Output buffer offsets */
-  tsize_t tbytes = 0, tilesize = TIFFTileSize(in);
-  tsample_t s;
-  uint8*  bufp = (uint8*)obuf;
-  unsigned char *srcbuffs[MAX_SAMPLES];
-  unsigned char *tbuff = NULL;
 
-  bytes_per_sample = (bps + 7) / 8;
+static int readSeparateTilesIntoBuffer(TIFF* in, uint8 *obuf, 
+                                        uint32 imagelength, uint32 imagewidth, 
+                                        uint32 tw, uint32 tl,
+                                        uint16 spp, uint16 bps)
+{
+    int     i, status = 1, sample;
+    int     shift_width, bytes_per_pixel;
+    uint16  bytes_per_sample;
+    uint32  row, col;     /* Current row and col of image */
+    uint32  nrow, ncol;   /* Number of rows and cols in current tile */
+    uint32  row_offset, col_offset; /* Output buffer offsets */
+    tsize_t tbytes = 0, tilesize = TIFFTileSize(in);
+    tsample_t s;
+    uint8*  bufp = (uint8*)obuf;
+    unsigned char *srcbuffs[MAX_SAMPLES];
+    unsigned char *tbuff = NULL;
+
+    bytes_per_sample = (bps + 7) / 8;
 
-  for (sample = 0; (sample < spp) && (sample < MAX_SAMPLES); sample++)
+    for (sample = 0; (sample < spp) && (sample < MAX_SAMPLES); sample++)
     {
-    srcbuffs[sample] = NULL;
-    tbuff = (unsigned char *)_TIFFmalloc(tilesize + 8);
-    if (!tbuff)
-      {
-      TIFFError ("readSeparateTilesIntoBuffer", 
-                 "Unable to allocate tile read buffer for sample %d", sample);
-      for (i = 0; i < sample; i++)
-        _TIFFfree (srcbuffs[i]);
-      return 0;
-      }
-    srcbuffs[sample] = tbuff;
+        srcbuffs[sample] = NULL;
+        tbuff = (unsigned char *)_TIFFmalloc(tilesize + 8);
+        if (!tbuff)
+        {
+            TIFFError ("readSeparateTilesIntoBuffer", 
+                        "Unable to allocate tile read buffer for sample %d", sample);
+            for (i = 0; i < sample; i++)
+                _TIFFfree(srcbuffs[i]);
+            return 0;
+        }
+        srcbuffs[sample] = tbuff;
     } 
-  /* Each tile contains only the data for a single plane
-   * arranged in scanlines of tw * bytes_per_sample bytes.
-   */
-  for (row = 0; row < imagelength; row += tl)
-    {
-    nrow = (row + tl > imagelength) ? imagelength - row : tl;
-    for (col = 0; col < imagewidth; col += tw)
-      {
-      for (s = 0; s < spp; s++)
-        {  /* Read each plane of a tile set into srcbuffs[s] */
-	tbytes = TIFFReadTile(in, srcbuffs[s], col, row, 0, s);
-        if (tbytes < 0  && !ignore)
-          {
-	  TIFFError(TIFFFileName(in),
-                 "Error, can't read tile for row %lu col %lu, "
-		 "sample %lu",
-		 (unsigned long) col, (unsigned long) row,
-		 (unsigned long) s);
-		 status = 0;
-          for (sample = 0; (sample < spp) && (sample < MAX_SAMPLES); sample++)
-            {
-            tbuff = srcbuffs[sample];
-            if (tbuff != NULL)
-              _TIFFfree(tbuff);
-            }
-          return status;
-	  }
-	}
-     /* Tiles on the right edge may be padded out to tw 
-      * which must be a multiple of 16.
-      * Ncol represents the visible (non padding) portion.  
-      */
-      if (col + tw > imagewidth)
-        ncol = imagewidth - col;
-      else
-        ncol = tw;
-
-      row_offset = row * (((imagewidth * spp * bps) + 7) / 8);
-      col_offset = ((col * spp * bps) + 7) / 8;
-      bufp = obuf + row_offset + col_offset;
 
-      if ((bps % 8) == 0)
-        {
-        if (combineSeparateTileSamplesBytes(srcbuffs, bufp, ncol, nrow, imagewidth,
-					    tw, spp, bps, NULL, 0, 0))
-	  {
-          status = 0;
-          break;
-      	  }
-	}
-      else
+    for (row = 0; row < imagelength; row += tl)
+    {
+        nrow = (row + tl > imagelength) ? imagelength - row : tl;
+        for (col = 0; col < imagewidth; col += tw)
         {
-        bytes_per_pixel  = ((bps * spp) + 7) / 8;
-        if (bytes_per_pixel < (bytes_per_sample + 1))
-          shift_width = bytes_per_pixel;
-        else
-          shift_width = bytes_per_sample + 1;
-
-        switch (shift_width)
-          {
-          case 1: if (combineSeparateTileSamples8bits (srcbuffs, bufp, ncol, nrow,
-                                                       imagewidth, tw, spp, bps, 
-						       NULL, 0, 0))
-	            {
+            for (s = 0; s < spp; s++)
+            {  
+                /* Read each plane of a tile set into srcbuffs[s], adding error checks */
+                tbytes = TIFFReadTile(in, srcbuffs[s], col, row, 0, s);
+                if (tbytes == (tsize_t)-1 || tbytes == 0)
+                {
+                    TIFFError(TIFFFileName(in),
+                               "Error, can't read tile for row %lu col %lu, "
+                               "sample %lu",
+                               (unsigned long) col, (unsigned long) row,
+                               (unsigned long) s);
                     status = 0;
                     break;
-      	            }
-	          break;
-          case 2: if (combineSeparateTileSamples16bits (srcbuffs, bufp, ncol, nrow,
-                                                       imagewidth, tw, spp, bps, 
-						       NULL, 0, 0))
-	            {
+                }
+            }
+            if (status == 0) break;
+
+            if (col + tw > imagewidth)
+                ncol = imagewidth - col;
+            else
+                ncol = tw;
+
+            row_offset = row * (((imagewidth * spp * bps) + 7) / 8);
+            col_offset = ((col * spp * bps) + 7) / 8;
+            bufp = obuf + row_offset + col_offset;
+
+            if ((bps % 8) == 0)
+            {
+                if (combineSeparateTileSamplesBytes(srcbuffs, bufp, ncol, nrow, imagewidth,
+                                                     tw, spp, bps, NULL, 0, 0))
+                {
                     status = 0;
                     break;
-		    }
-	          break;
-          case 3: if (combineSeparateTileSamples24bits (srcbuffs, bufp, ncol, nrow,
-                                                       imagewidth, tw, spp, bps, 
-						       NULL, 0, 0))
-	            {
-                    status = 0;
+                }
+            }
+            else
+            {
+                bytes_per_pixel  = ((bps * spp) + 7) / 8;
+                if (bytes_per_pixel < (bytes_per_sample + 1))
+                    shift_width = bytes_per_pixel;
+                else
+                    shift_width = bytes_per_sample + 1;
+
+                switch (shift_width)
+                {
+                case 1: if (combineSeparateTileSamples8bits(srcbuffs, bufp, ncol, nrow,
+                                                             imagewidth, tw, spp, bps, 
+                                                             NULL, 0, 0))
+                    {
+                        status = 0;
+                        break;
+                    }
                     break;
-       	            }
-                  break;
-          case 4: 
-          case 5:
-          case 6:
-          case 7:
-          case 8: if (combineSeparateTileSamples32bits (srcbuffs, bufp, ncol, nrow,
-                                                       imagewidth, tw, spp, bps, 
-						       NULL, 0, 0))
-	            {
-                    status = 0;
+                case 2: if (combineSeparateTileSamples16bits(srcbuffs, bufp, ncol, nrow,
+                                                             imagewidth, tw, spp, bps, 
+                                                             NULL, 0, 0))
+                    {
+                        status = 0;
+                        break;
+                    }
+                    break;
+                case 3: if (combineSeparateTileSamples24bits(srcbuffs, bufp, ncol, nrow,
+                                                             imagewidth, tw, spp, bps, 
+                                                             NULL, 0, 0))
+                    {
+                        status = 0;
+                        break;
+                    }
                     break;
-		    }
-	          break;
-          default: TIFFError ("readSeparateTilesIntoBuffer", "Unsupported bit depth: %d", bps);
-                  status = 0;
-                  break;
-          }
+                case 4: 
+                case 5:
+                case 6:
+                case 7:
+                case 8: if (combineSeparateTileSamples32bits(srcbuffs, bufp, ncol, nrow,
+                                                             imagewidth, tw, spp, bps, 
+                                                             NULL, 0, 0))
+                    {
+                        status = 0;
+                        break;
+                    }
+                    break;
+                default: TIFFError ("readSeparateTilesIntoBuffer", "Unsupported bit depth: %d", bps);
+                         status = 0;
+                         break;
+                }
+            }
+            if (status == 0) break;
         }
-      }
+        if (status == 0) break;
     }
 
-  for (sample = 0; (sample < spp) && (sample < MAX_SAMPLES); sample++)
+    for (sample = 0; (sample < spp) && (sample < MAX_SAMPLES); sample++)
     {
-    tbuff = srcbuffs[sample];
-    if (tbuff != NULL)
-      _TIFFfree(tbuff);
+        tbuff = srcbuffs[sample];
+        if (tbuff != NULL)
+            _TIFFfree(tbuff);
     }
- 
-  return status;
-  }
+
+    return status;
+}
+
 
 static int writeBufferToContigStrips(TIFF* out, uint8* buf, uint32 imagelength)
   {

2025-02-03 22:11:00.577 | DEBUG    | scenario:rebuild:369 - original environment: environ({'CONDA_SHLVL': '2', 'LC_ALL': 'C.UTF-8', 'LS_COLORS': 'rs=0:di=01;34:ln=01;36:mh=00:pi=40;33:so=01;35:do=01;35:bd=40;33;01:cd=40;33;01:or=40;31;01:mi=00:su=37;41:sg=30;43:ca=30;41:tw=30;42:ow=34;42:st=37;44:ex=01;32:*.tar=01;31:*.tgz=01;31:*.arc=01;31:*.arj=01;31:*.taz=01;31:*.lha=01;31:*.lz4=01;31:*.lzh=01;31:*.lzma=01;31:*.tlz=01;31:*.txz=01;31:*.tzo=01;31:*.t7z=01;31:*.zip=01;31:*.z=01;31:*.Z=01;31:*.dz=01;31:*.gz=01;31:*.lrz=01;31:*.lz=01;31:*.lzo=01;31:*.xz=01;31:*.zst=01;31:*.tzst=01;31:*.bz2=01;31:*.bz=01;31:*.tbz=01;31:*.tbz2=01;31:*.tz=01;31:*.deb=01;31:*.rpm=01;31:*.jar=01;31:*.war=01;31:*.ear=01;31:*.sar=01;31:*.rar=01;31:*.alz=01;31:*.ace=01;31:*.zoo=01;31:*.cpio=01;31:*.7z=01;31:*.rz=01;31:*.cab=01;31:*.wim=01;31:*.swm=01;31:*.dwm=01;31:*.esd=01;31:*.jpg=01;35:*.jpeg=01;35:*.mjpg=01;35:*.mjpeg=01;35:*.gif=01;35:*.bmp=01;35:*.pbm=01;35:*.pgm=01;35:*.ppm=01;35:*.tga=01;35:*.xbm=01;35:*.xpm=01;35:*.tif=01;35:*.tiff=01;35:*.png=01;35:*.svg=01;35:*.svgz=01;35:*.mng=01;35:*.pcx=01;35:*.mov=01;35:*.mpg=01;35:*.mpeg=01;35:*.m2v=01;35:*.mkv=01;35:*.webm=01;35:*.ogm=01;35:*.mp4=01;35:*.m4v=01;35:*.mp4v=01;35:*.vob=01;35:*.qt=01;35:*.nuv=01;35:*.wmv=01;35:*.asf=01;35:*.rm=01;35:*.rmvb=01;35:*.flc=01;35:*.avi=01;35:*.fli=01;35:*.flv=01;35:*.gl=01;35:*.dl=01;35:*.xcf=01;35:*.xwd=01;35:*.yuv=01;35:*.cgm=01;35:*.emf=01;35:*.ogv=01;35:*.ogx=01;35:*.aac=00;36:*.au=00;36:*.flac=00;36:*.m4a=00;36:*.mid=00;36:*.midi=00;36:*.mka=00;36:*.mp3=00;36:*.mpc=00;36:*.ogg=00;36:*.ra=00;36:*.wav=00;36:*.oga=00;36:*.opus=00;36:*.spx=00;36:*.xspf=00;36:', 'LD_LIBRARY_PATH': '/opt/crashrepair/lib:/CrashRepair/lib:/klee/build/lib:', 'CONDA_EXE': '/root/anaconda3/bin/conda', 'LANG': 'C.UTF-8', 'TZ': 'Asia/Shanghai', 'HOSTNAME': 'fea22102047d', 'OLDPWD': '/orchestrator', 'CONDA_PREFIX': '/root/anaconda3/envs/CrashRepair', '_CE_M': '', 'CC': 'crepair-cc', 'LLVM_COMPILER': 'clang', 'CONDA_PREFIX_1': '/root/anaconda3', 'PWD': '/orchestrator/crashrepair', 'HOME': '/root', 'CONDA_PYTHON_EXE': '/root/anaconda3/bin/python', '_CE_CONDA': '', 'CONDA_PROMPT_MODIFIER': '(CrashRepair) ', 'CXX': 'crepair-cxx', 'TERM': 'xterm', 'SHLVL': '2', 'PYTHONPATH': '/usr/lib/python3.8/site-packages:', 'PATH': '/root/anaconda3/envs/CrashRepair/bin:/root/anaconda3/condabin:~/anaconda3/bin:/opt/crashrepair/bin:/CrashRepair/compiler:/klee/build/bin:/opt/llvm-6/bin:/klee/build/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', 'CONDA_DEFAULT_ENV': 'CrashRepair', '_': '/root/anaconda3/envs/CrashRepair/bin/python'})
2025-02-03 22:11:00.578 | DEBUG    | scenario:rebuild:382 - injecting ghost function into CFLAGS during build: -lcrepair_ghost
2025-02-03 22:11:00.578 | DEBUG    | scenario:rebuild:398 - using environment: {'INJECT_CFLAGS': '-g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address', 'INJECT_CXXFLAGS': '-g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address', 'INJECT_LDFLAGS': '-g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address'}
2025-02-03 22:11:00.578 | DEBUG    | shell:__call__:41 - executing: make CFLAGS="${INJECT_CFLAGS}" CXXFLAGS="${INJECT_CXXFLAGS}" LDFLAGS="${INJECT_LDFLAGS}"
Making all in port
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/port'
make[1]: Nothing to be done for 'all'.
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/port'
Making all in libtiff
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/libtiff'
make  all-am
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/libtiff'
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/libtiff'
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/libtiff'
Making all in tools
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/tools'
crepair-cc -DHAVE_CONFIG_H -I. -I../libtiff  -I../libtiff   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -MT tiffcrop.o -MD -MP -MF .deps/tiffcrop.Tpo -c -o tiffcrop.o tiffcrop.c
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_ghost: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
mv -f .deps/tiffcrop.Tpo .deps/tiffcrop.Po
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address  -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -o tiffcrop tiffcrop.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -g -O0 -Wno-error -I/CrashRepair/lib -fsanitize=address -g -O0 -Wno-error -I/CrashRepair/lib -fsanitize=address -o tiffcrop tiffcrop.o  -L/klee/build/lib -L/CrashRepair/lib -lkleeRuntest -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost ../libtiff/.libs/libtiff.a ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/tools'
Making all in build
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/build'
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/build'
make[2]: Nothing to be done for 'all-am'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/build'
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/build'
Making all in contrib
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib'
Making all in addtiffo
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/addtiffo'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/addtiffo'
Making all in dbs
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/dbs'
Making all in xtiff
make[3]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/dbs/xtiff'
make[3]: Nothing to be done for 'all'.
make[3]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/dbs/xtiff'
make[3]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/dbs'
make[3]: Nothing to be done for 'all-am'.
make[3]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/dbs'
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/dbs'
Making all in iptcutil
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/iptcutil'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/iptcutil'
Making all in mfs
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/mfs'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/mfs'
Making all in pds
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/pds'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/pds'
Making all in ras
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/ras'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/ras'
Making all in stream
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/stream'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/stream'
Making all in tags
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/tags'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/tags'
Making all in win_dib
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/win_dib'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/win_dib'
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib'
make[2]: Nothing to be done for 'all-am'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib'
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib'
Making all in test
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/test'
make[1]: Nothing to be done for 'all'.
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/test'
Making all in man
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/man'
make[1]: Nothing to be done for 'all'.
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/man'
Making all in html
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html'
Making all in images
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html/images'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html/images'
Making all in man
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html/man'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html/man'
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html'
make[2]: Nothing to be done for 'all-am'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html'
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html'
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src'
make[1]: Nothing to be done for 'all-am'.
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src'
2025-02-03 22:11:01.034 | INFO     | analyzer:run:114 - running analysis with timeout: 60 minutes
2025-02-03 22:11:01.034 | DEBUG    | analyzer:write_config_to_file:88 - generated analyzer config:

dir_exp:/data/vulnloc/libtiff/CVE-2016-5321
tag_id:libtiff_CVE-2016-5321
src_directory:/data/vulnloc/libtiff/CVE-2016-5321/src
binary_path:/data/vulnloc/libtiff/CVE-2016-5321/src/tools/tiffcrop
config_command:./configure --enable-static --disable-shared
build_command:make CFLAGS="${INJECT_CFLAGS}" CXXFLAGS="${INJECT_CXXFLAGS}" LDFLAGS="${INJECT_LDFLAGS}"
test_input_list:$POC foo.tif
poc_list:/CrashRepair/experiments/vulnloc/libtiff/CVE-2016-5321/tests/1.tif
klee_flags:--link-llvm-lib=/CrashRepair/lib/libcrepair_proxy.bca 

2025-02-03 22:11:01.034 | DEBUG    | analyzer:run:124 - wrote analyzer config file to: /tmp/tmpfoo6p4qh
2025-02-03 22:11:01.034 | DEBUG    | shell:__call__:41 - executing: crepair --conf=/tmp/tmpfoo6p4qh
[K[1;36m
====================================================================================================

	Starting CRepair (C Crash Repair) 
====================================================================================================
[0m
[K[1;36m
	Loading Configurations
	__________________________________________________________________________________________
[0m
[K	[1;34mreading configuration values from arguments[0m
[K	[1;34mreading configuration values form configuration file[0m
[K	[1;37m	[file] /tmp/tmpfoo6p4qh[0m
[K	[1;34mupdating configuration values[0m
[K	[1;34mreading test configuration[0m
[K	[1;34mreading seed information[0m
[K	[1;37m	[config] stack size: 15000[0m
[K	[1;37m	[config] collecting stats: False[0m
[K	[1;37m	[config] number of tests: 1[0m
[K	[1;37m	[config] number of cores: 8[0m
[K	[1;37m	[config] klee concrete execution timeout: 600[0m
[K	[1;37m	[config] klee concolic execution timeout: 1200[0m
[K	[1;37m	[config] synthesize subset expressions: True[0m
[K	[1;37m	[config] window size for taint locations: 500[0m
[K	[1;37m	[config] window size for taint values: 500000[0m
[K[1;36m

	Analyzing Program
====================================================================================================
[0m
[K[1;36m
	Test Case #1
	__________________________________________________________________________________________
[0m
[K[1;36m
		Running Concrete Execution
		------------------------------------------------------------------------------------------
[0m
[K	[1;37m	[0m[K     [1;37mUsing Arguments: ['$POC', 'foo.tif'][0m
[K	[1;37m	[0m[K     [1;37mUsing Input File: /CrashRepair/experiments/vulnloc/libtiff/CVE-2016-5321/tests/1.tif[0m
[K	[1;34m	building program[0m
[K	[1;34m		setting environment variables[0m
[K	[1;34m		cleaning files[0m
[K	[1;34m		configuring program[0m
[K	[1;34m		compiling program[0m
[K	[1;37m	[0m[K     [1;37mUsing Binary: /data/vulnloc/libtiff/CVE-2016-5321/src/tools/tiffcrop[0m
[K	[1;34m	extracting bytecode[0m
[K	[1;34m	executing klee in concrete mode[0m
[K	[1;34m	extracting instruction trace[0m
[K	[1;37m		[note] program crashed[0m
[K	[1;34m	collecting tainted expressions[0m
[K	[1;34m	collecting tainted concrete values[0m
[K	[1;34m	collecting memory allocations/de-allocations[0m
[K	[1;34m	collecting pointer mapping[0m
[K	[1;34m	extracting crash information[0m
[K	[1;37m		[0m[K     [1;37m[info] crash type: memory read overflow[0m
[K	[1;37m		[0m[K     [1;37m[info] crash location:
                             /data/vulnloc/libtiff/CVE-2016-5321/src/tools/tiffcrop.c:994:43[0m
[K	[1;37m		[0m[K     [1;37m[info] crash function: readSeparateTilesIntoBuffer[0m
[K	[1;37m		[0m[K     [1;37m[info] crash address: 116502[0m
[K	[1;37m		[0m[K     [1;37m[info] crash free constraint: ((8 * @var(integer, s)) < 64)[0m
[K	[1;37m		[0m[K     [1;37m[info] crash inducing variables: s[0m
[K	[1;37m			[info] identified crash type: memory read overflow[0m
[K[1;36m
		Running Concolic Execution
		------------------------------------------------------------------------------------------
[0m
[K	[1;37m	[0m[K     [1;37mUsing Arguments: ['$POC', 'foo.tif'][0m
[K	[1;37m	[0m[K     [1;37mUsing Input File: /CrashRepair/experiments/vulnloc/libtiff/CVE-2016-5321/tests/1.tif[0m
[K	[1;34m	building program[0m
[K	[1;34m		setting environment variables[0m
[K	[1;34m		cleaning files[0m
[K	[1;34m		configuring program[0m
[K	[1;34m		compiling program[0m
[K	[1;34m	extracting bytecode[0m
[K	[1;34m	generating ktest file[0m
[K	[1;34m	executing klee in concolic mode[0m
[K	[1;34m	extracting largest symbolic path[0m
[K	[1;34m	extracting instruction trace[0m
[K	[1;37m		[note] program crashed[0m
[K	[1;34m	collecting tainted expressions[0m
[K	[1;34m	collecting memory allocations/de-allocations[0m
[K	[1;34m	collecting pointer mapping[0m
[K	[1;37m		[0m[K     [1;37m[info] Symbolic Mapping: s -> [][0m
[K[1;36m

	Fix Localization
====================================================================================================
[0m
[K[1;36m
	Generating Fix Locations
	__________________________________________________________________________________________
[0m
[K	[1;34m	generating taint map[0m
[K	[1;37m		[0m[K     [1;37m[info] found 10856 tainted locations[0m
[K	[1;34m		starting parallel computing[0m
[K	[1;34m		waiting for thread completion[0m
[K	[1;37m		[0m[K     [1;37m[info] found 5 source files[0m
[K	[1;37m		[0m[K     [1;37m[info] found 12 executed functions[0m
[K	[1;34m	generating possible fix locations[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] readSeparateTilesIntoBuffer,
                             /data/vulnloc/libtiff/CVE-2016-5321/src/tools/tiffcrop.c:991:35[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] readSeparateTilesIntoBuffer,
                             /data/vulnloc/libtiff/CVE-2016-5321/src/tools/tiffcrop.c:995:53[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] readSeparateTilesIntoBuffer,
                             /data/vulnloc/libtiff/CVE-2016-5321/src/tools/tiffcrop.c:995:46[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] readSeparateTilesIntoBuffer,
                             /data/vulnloc/libtiff/CVE-2016-5321/src/tools/tiffcrop.c:995:28[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] readSeparateTilesIntoBuffer,
                             /data/vulnloc/libtiff/CVE-2016-5321/src/tools/tiffcrop.c:995:21[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] readSeparateTilesIntoBuffer,
                             /data/vulnloc/libtiff/CVE-2016-5321/src/tools/tiffcrop.c:994:24[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] readSeparateTilesIntoBuffer,
                             /data/vulnloc/libtiff/CVE-2016-5321/src/tools/tiffcrop.c:994:26[0m
[K[1;36m
	Localizing Constraints
	__________________________________________________________________________________________
[0m
[K[1;36m
		[fix-loc] /data/vulnloc/libtiff/CVE-2016-5321/src/tools/tiffcrop.c:991:13
		------------------------------------------------------------------------------------------
[0m
[K	[1;37m	[0m[K     [1;37m[constraint] ((8 * @var(integer, s)) < 64)[0m
[K[1;36m
		[fix-loc] /data/vulnloc/libtiff/CVE-2016-5321/src/tools/tiffcrop.c:994:26
		------------------------------------------------------------------------------------------
[0m
[K	[1;37m	[0m[K     [1;37m[constraint] ((8 * @var(integer, s)) < 64)[0m
[K[1;36m
		[fix-loc] /data/vulnloc/libtiff/CVE-2016-5321/src/tools/tiffcrop.c:995:17
		------------------------------------------------------------------------------------------
[0m
[K	[1;37m	[0m[K     [1;37m[constraint] ((8 * @var(integer, s)) < 64)[0m
[K[1;36m
		[fix-loc] /data/vulnloc/libtiff/CVE-2016-5321/src/tools/tiffcrop.c:994:17
		------------------------------------------------------------------------------------------
[0m
[K	[1;37m	[0m[K     [1;37m[constraint] ((8 * @var(integer, s)) < 64)[0m
[K[1;32m
	localization information saved at /CrashRepair/output/libtiff_CVE-2016-5321/localization.json[0m
[K[1;32m
	state values saved at /CrashRepair/output/libtiff_CVE-2016-5321/values/[0m
[K	[1;37m
Run time statistics:
-----------------------
[0m
[K	[1;37mStartup: 0.000 minutes[0m
[K	[1;37mBuild: 0 minutes[0m
[K	[1;37mConcrete Analysis: 0.683 minutes[0m
[K	[1;37mConcolic Analysis: 0.580 minutes[0m
[K	[1;37mTotal Analysis: 1.296 minutes[0m
[K	[1;37mLocalization: 0.313 minutes[0m
[K[1;32m
CRepair finished successfully after 1.650 minutes 
[0m
2025-02-03 22:12:40.960 | WARNING  | analyzer:run:143 - analysis output directory does not exist [/data/vulnloc/libtiff/CVE-2016-5321/analysis]: creating...
2025-02-03 22:12:41.070 | INFO     | scenario:analyze_for_guide:558 - reanalyzing candidate patch: #8:
@@ -948,6 +948,7 @@
   return status;
   }
 
+
 static int  readSeparateTilesIntoBuffer (TIFF* in, uint8 *obuf, 
 					 uint32 imagelength, uint32 imagewidth, 
                                          uint32 tw, uint32 tl,
@@ -991,24 +992,15 @@
       {
       for (s = 0; s < spp; s++)
         {  /* Read each plane of a tile set into srcbuffs[s] */
-	tbytes = TIFFReadTile(in, srcbuffs[s], col, row, 0, s);
-        if (tbytes < 0  && !ignore)
-          {
+	if (!(tbytes = TIFFReadTile(in, srcbuffs[s], col, row, 0, s))) {
 	  TIFFError(TIFFFileName(in),
                  "Error, can't read tile for row %lu col %lu, "
 		 "sample %lu",
 		 (unsigned long) col, (unsigned long) row,
 		 (unsigned long) s);
-		 status = 0;
-          for (sample = 0; (sample < spp) && (sample < MAX_SAMPLES); sample++)
-            {
-            tbuff = srcbuffs[sample];
-            if (tbuff != NULL)
-              _TIFFfree(tbuff);
-            }
-          return status;
-	  }
-	}
+	  status = 0;
+        }
+        }
      /* Tiles on the right edge may be padded out to tw 
       * which must be a multiple of 16.
       * Ncol represents the visible (non padding) portion.  
@@ -1095,6 +1087,7 @@
   return status;
   }
 
+
 static int writeBufferToContigStrips(TIFF* out, uint8* buf, uint32 imagelength)
   {
   uint32 row, nrows, rowsperstrip;

2025-02-03 22:12:41.077 | DEBUG    | scenario:rebuild:369 - original environment: environ({'CONDA_SHLVL': '2', 'LC_ALL': 'C.UTF-8', 'LS_COLORS': 'rs=0:di=01;34:ln=01;36:mh=00:pi=40;33:so=01;35:do=01;35:bd=40;33;01:cd=40;33;01:or=40;31;01:mi=00:su=37;41:sg=30;43:ca=30;41:tw=30;42:ow=34;42:st=37;44:ex=01;32:*.tar=01;31:*.tgz=01;31:*.arc=01;31:*.arj=01;31:*.taz=01;31:*.lha=01;31:*.lz4=01;31:*.lzh=01;31:*.lzma=01;31:*.tlz=01;31:*.txz=01;31:*.tzo=01;31:*.t7z=01;31:*.zip=01;31:*.z=01;31:*.Z=01;31:*.dz=01;31:*.gz=01;31:*.lrz=01;31:*.lz=01;31:*.lzo=01;31:*.xz=01;31:*.zst=01;31:*.tzst=01;31:*.bz2=01;31:*.bz=01;31:*.tbz=01;31:*.tbz2=01;31:*.tz=01;31:*.deb=01;31:*.rpm=01;31:*.jar=01;31:*.war=01;31:*.ear=01;31:*.sar=01;31:*.rar=01;31:*.alz=01;31:*.ace=01;31:*.zoo=01;31:*.cpio=01;31:*.7z=01;31:*.rz=01;31:*.cab=01;31:*.wim=01;31:*.swm=01;31:*.dwm=01;31:*.esd=01;31:*.jpg=01;35:*.jpeg=01;35:*.mjpg=01;35:*.mjpeg=01;35:*.gif=01;35:*.bmp=01;35:*.pbm=01;35:*.pgm=01;35:*.ppm=01;35:*.tga=01;35:*.xbm=01;35:*.xpm=01;35:*.tif=01;35:*.tiff=01;35:*.png=01;35:*.svg=01;35:*.svgz=01;35:*.mng=01;35:*.pcx=01;35:*.mov=01;35:*.mpg=01;35:*.mpeg=01;35:*.m2v=01;35:*.mkv=01;35:*.webm=01;35:*.ogm=01;35:*.mp4=01;35:*.m4v=01;35:*.mp4v=01;35:*.vob=01;35:*.qt=01;35:*.nuv=01;35:*.wmv=01;35:*.asf=01;35:*.rm=01;35:*.rmvb=01;35:*.flc=01;35:*.avi=01;35:*.fli=01;35:*.flv=01;35:*.gl=01;35:*.dl=01;35:*.xcf=01;35:*.xwd=01;35:*.yuv=01;35:*.cgm=01;35:*.emf=01;35:*.ogv=01;35:*.ogx=01;35:*.aac=00;36:*.au=00;36:*.flac=00;36:*.m4a=00;36:*.mid=00;36:*.midi=00;36:*.mka=00;36:*.mp3=00;36:*.mpc=00;36:*.ogg=00;36:*.ra=00;36:*.wav=00;36:*.oga=00;36:*.opus=00;36:*.spx=00;36:*.xspf=00;36:', 'LD_LIBRARY_PATH': '/opt/crashrepair/lib:/CrashRepair/lib:/klee/build/lib:', 'CONDA_EXE': '/root/anaconda3/bin/conda', 'LANG': 'C.UTF-8', 'TZ': 'Asia/Shanghai', 'HOSTNAME': 'fea22102047d', 'OLDPWD': '/orchestrator', 'CONDA_PREFIX': '/root/anaconda3/envs/CrashRepair', '_CE_M': '', 'CC': 'crepair-cc', 'LLVM_COMPILER': 'clang', 'CONDA_PREFIX_1': '/root/anaconda3', 'PWD': '/orchestrator/crashrepair', 'HOME': '/root', 'CONDA_PYTHON_EXE': '/root/anaconda3/bin/python', '_CE_CONDA': '', 'CONDA_PROMPT_MODIFIER': '(CrashRepair) ', 'CXX': 'crepair-cxx', 'TERM': 'xterm', 'SHLVL': '2', 'PYTHONPATH': '/usr/lib/python3.8/site-packages:', 'PATH': '/root/anaconda3/envs/CrashRepair/bin:/root/anaconda3/condabin:~/anaconda3/bin:/opt/crashrepair/bin:/CrashRepair/compiler:/klee/build/bin:/opt/llvm-6/bin:/klee/build/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', 'CONDA_DEFAULT_ENV': 'CrashRepair', '_': '/root/anaconda3/envs/CrashRepair/bin/python'})
2025-02-03 22:12:41.077 | DEBUG    | scenario:rebuild:382 - injecting ghost function into CFLAGS during build: -lcrepair_ghost
2025-02-03 22:12:41.077 | DEBUG    | scenario:rebuild:398 - using environment: {'INJECT_CFLAGS': '-g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address', 'INJECT_CXXFLAGS': '-g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address', 'INJECT_LDFLAGS': '-g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address'}
2025-02-03 22:12:41.077 | DEBUG    | shell:__call__:41 - executing: make CFLAGS="${INJECT_CFLAGS}" CXXFLAGS="${INJECT_CXXFLAGS}" LDFLAGS="${INJECT_LDFLAGS}"
Making all in port
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/port'
make[1]: Nothing to be done for 'all'.
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/port'
Making all in libtiff
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/libtiff'
make  all-am
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/libtiff'
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/libtiff'
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/libtiff'
Making all in tools
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/tools'
crepair-cc -DHAVE_CONFIG_H -I. -I../libtiff  -I../libtiff   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -MT tiffcrop.o -MD -MP -MF .deps/tiffcrop.Tpo -c -o tiffcrop.o tiffcrop.c
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_ghost: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
mv -f .deps/tiffcrop.Tpo .deps/tiffcrop.Po
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address  -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -o tiffcrop tiffcrop.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -g -O0 -Wno-error -I/CrashRepair/lib -fsanitize=address -g -O0 -Wno-error -I/CrashRepair/lib -fsanitize=address -o tiffcrop tiffcrop.o  -L/klee/build/lib -L/CrashRepair/lib -lkleeRuntest -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost ../libtiff/.libs/libtiff.a ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/tools'
Making all in build
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/build'
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/build'
make[2]: Nothing to be done for 'all-am'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/build'
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/build'
Making all in contrib
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib'
Making all in addtiffo
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/addtiffo'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/addtiffo'
Making all in dbs
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/dbs'
Making all in xtiff
make[3]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/dbs/xtiff'
make[3]: Nothing to be done for 'all'.
make[3]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/dbs/xtiff'
make[3]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/dbs'
make[3]: Nothing to be done for 'all-am'.
make[3]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/dbs'
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/dbs'
Making all in iptcutil
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/iptcutil'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/iptcutil'
Making all in mfs
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/mfs'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/mfs'
Making all in pds
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/pds'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/pds'
Making all in ras
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/ras'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/ras'
Making all in stream
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/stream'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/stream'
Making all in tags
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/tags'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/tags'
Making all in win_dib
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/win_dib'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/win_dib'
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib'
make[2]: Nothing to be done for 'all-am'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib'
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib'
Making all in test
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/test'
make[1]: Nothing to be done for 'all'.
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/test'
Making all in man
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/man'
make[1]: Nothing to be done for 'all'.
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/man'
Making all in html
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html'
Making all in images
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html/images'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html/images'
Making all in man
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html/man'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html/man'
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html'
make[2]: Nothing to be done for 'all-am'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html'
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html'
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src'
make[1]: Nothing to be done for 'all-am'.
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src'
2025-02-03 22:12:41.557 | INFO     | analyzer:run:114 - running analysis with timeout: 60 minutes
2025-02-03 22:12:41.557 | DEBUG    | analyzer:write_config_to_file:88 - generated analyzer config:

dir_exp:/data/vulnloc/libtiff/CVE-2016-5321
tag_id:libtiff_CVE-2016-5321
src_directory:/data/vulnloc/libtiff/CVE-2016-5321/src
binary_path:/data/vulnloc/libtiff/CVE-2016-5321/src/tools/tiffcrop
config_command:./configure --enable-static --disable-shared
build_command:make CFLAGS="${INJECT_CFLAGS}" CXXFLAGS="${INJECT_CXXFLAGS}" LDFLAGS="${INJECT_LDFLAGS}"
test_input_list:$POC foo.tif
poc_list:/CrashRepair/experiments/vulnloc/libtiff/CVE-2016-5321/tests/1.tif
klee_flags:--link-llvm-lib=/CrashRepair/lib/libcrepair_proxy.bca 

2025-02-03 22:12:41.557 | DEBUG    | analyzer:run:124 - wrote analyzer config file to: /tmp/tmpdu07a5o3
2025-02-03 22:12:41.557 | DEBUG    | shell:__call__:41 - executing: crepair --conf=/tmp/tmpdu07a5o3
[K[1;36m
====================================================================================================

	Starting CRepair (C Crash Repair) 
====================================================================================================
[0m
[K[1;36m
	Loading Configurations
	__________________________________________________________________________________________
[0m
[K	[1;34mreading configuration values from arguments[0m
[K	[1;34mreading configuration values form configuration file[0m
[K	[1;37m	[file] /tmp/tmpdu07a5o3[0m
[K	[1;34mupdating configuration values[0m
[K	[1;34mreading test configuration[0m
[K	[1;34mreading seed information[0m
[K	[1;37m	[config] stack size: 15000[0m
[K	[1;37m	[config] collecting stats: False[0m
[K	[1;37m	[config] number of tests: 1[0m
[K	[1;37m	[config] number of cores: 8[0m
[K	[1;37m	[config] klee concrete execution timeout: 600[0m
[K	[1;37m	[config] klee concolic execution timeout: 1200[0m
[K	[1;37m	[config] synthesize subset expressions: True[0m
[K	[1;37m	[config] window size for taint locations: 500[0m
[K	[1;37m	[config] window size for taint values: 500000[0m
[K[1;36m

	Analyzing Program
====================================================================================================
[0m
[K[1;36m
	Test Case #1
	__________________________________________________________________________________________
[0m
[K[1;36m
		Running Concrete Execution
		------------------------------------------------------------------------------------------
[0m
[K	[1;37m	[0m[K     [1;37mUsing Arguments: ['$POC', 'foo.tif'][0m
[K	[1;37m	[0m[K     [1;37mUsing Input File: /CrashRepair/experiments/vulnloc/libtiff/CVE-2016-5321/tests/1.tif[0m
[K	[1;34m	building program[0m
[K	[1;34m		setting environment variables[0m
[K	[1;34m		cleaning files[0m
[K	[1;34m		configuring program[0m
[K	[1;34m		compiling program[0m
[K	[1;37m	[0m[K     [1;37mUsing Binary: /data/vulnloc/libtiff/CVE-2016-5321/src/tools/tiffcrop[0m
[K	[1;34m	extracting bytecode[0m
[K	[1;34m	executing klee in concrete mode[0m
[K	[1;34m	extracting instruction trace[0m
[K	[1;37m		[note] program crashed[0m
[K	[1;34m	collecting tainted expressions[0m
[K	[1;34m	collecting tainted concrete values[0m
[K	[1;34m	collecting memory allocations/de-allocations[0m
[K	[1;34m	collecting pointer mapping[0m
[K	[1;34m	extracting crash information[0m
[K	[1;37m		[0m[K     [1;37m[info] crash type: memory read overflow[0m
[K	[1;37m		[0m[K     [1;37m[info] crash location:
                             /data/vulnloc/libtiff/CVE-2016-5321/src/tools/tiffcrop.c:995:34[0m
[K	[1;37m		[0m[K     [1;37m[info] crash function: readSeparateTilesIntoBuffer[0m
[K	[1;37m		[0m[K     [1;37m[info] crash address: 116502[0m
[K	[1;37m		[0m[K     [1;37m[info] crash free constraint: ((8 * @var(integer, s)) < 64)[0m
[K	[1;37m		[0m[K     [1;37m[info] crash inducing variables: s[0m
[K	[1;37m			[info] identified crash type: memory read overflow[0m
[K[1;36m
		Running Concolic Execution
		------------------------------------------------------------------------------------------
[0m
[K	[1;37m	[0m[K     [1;37mUsing Arguments: ['$POC', 'foo.tif'][0m
[K	[1;37m	[0m[K     [1;37mUsing Input File: /CrashRepair/experiments/vulnloc/libtiff/CVE-2016-5321/tests/1.tif[0m
[K	[1;34m	building program[0m
[K	[1;34m		setting environment variables[0m
[K	[1;34m		cleaning files[0m
[K	[1;34m		configuring program[0m
[K	[1;34m		compiling program[0m
[K	[1;34m	extracting bytecode[0m
[K	[1;34m	generating ktest file[0m
[K	[1;34m	executing klee in concolic mode[0m
[K	[1;34m	extracting largest symbolic path[0m
[K	[1;34m	extracting instruction trace[0m
[K	[1;37m		[note] program crashed[0m
[K	[1;34m	collecting tainted expressions[0m
[K	[1;34m	collecting memory allocations/de-allocations[0m
[K	[1;34m	collecting pointer mapping[0m
[K	[1;37m		[0m[K     [1;37m[info] Symbolic Mapping: s -> [][0m
[K[1;36m

	Fix Localization
====================================================================================================
[0m
[K[1;36m
	Generating Fix Locations
	__________________________________________________________________________________________
[0m
[K	[1;34m	generating taint map[0m
[K	[1;37m		[0m[K     [1;37m[info] found 10853 tainted locations[0m
[K	[1;34m		starting parallel computing[0m
[K	[1;34m		waiting for thread completion[0m
[K	[1;37m		[0m[K     [1;37m[info] found 5 source files[0m
[K	[1;37m		[0m[K     [1;37m[info] found 12 executed functions[0m
[K	[1;34m	generating possible fix locations[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] readSeparateTilesIntoBuffer,
                             /data/vulnloc/libtiff/CVE-2016-5321/src/tools/tiffcrop.c:993:29[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] readSeparateTilesIntoBuffer,
                             /data/vulnloc/libtiff/CVE-2016-5321/src/tools/tiffcrop.c:995:15[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] readSeparateTilesIntoBuffer,
                             /data/vulnloc/libtiff/CVE-2016-5321/src/tools/tiffcrop.c:995:17[0m
[K[1;36m
	Localizing Constraints
	__________________________________________________________________________________________
[0m
[K[1;36m
		[fix-loc] /data/vulnloc/libtiff/CVE-2016-5321/src/tools/tiffcrop.c:993:7
		------------------------------------------------------------------------------------------
[0m
[K	[1;37m	[0m[K     [1;37m[constraint] ((8 * @var(integer, s)) < 64)[0m
[K[1;36m
		[fix-loc] /data/vulnloc/libtiff/CVE-2016-5321/src/tools/tiffcrop.c:995:17
		------------------------------------------------------------------------------------------
[0m
[K	[1;37m	[0m[K     [1;37m[constraint] ((8 * @var(integer, s)) < 64)[0m
[K[1;36m
		[fix-loc] /data/vulnloc/libtiff/CVE-2016-5321/src/tools/tiffcrop.c:995:8
		------------------------------------------------------------------------------------------
[0m
[K	[1;37m	[0m[K     [1;37m[constraint] ((8 * @var(integer, s)) < 64)[0m
[K[1;32m
	localization information saved at /CrashRepair/output/libtiff_CVE-2016-5321/localization.json[0m
[K[1;32m
	state values saved at /CrashRepair/output/libtiff_CVE-2016-5321/values/[0m
[K	[1;37m
Run time statistics:
-----------------------
[0m
[K	[1;37mStartup: 0.000 minutes[0m
[K	[1;37mBuild: 0 minutes[0m
[K	[1;37mConcrete Analysis: 0.678 minutes[0m
[K	[1;37mConcolic Analysis: 0.586 minutes[0m
[K	[1;37mTotal Analysis: 1.298 minutes[0m
[K	[1;37mLocalization: 0.248 minutes[0m
[K[1;32m
CRepair finished successfully after 1.594 minutes 
[0m
2025-02-03 22:14:18.109 | WARNING  | analyzer:run:143 - analysis output directory does not exist [/data/vulnloc/libtiff/CVE-2016-5321/analysis]: creating...
2025-02-03 22:14:18.216 | INFO     | scenario:analyze_for_guide:558 - reanalyzing candidate patch: #9:
@@ -948,152 +948,154 @@
   return status;
   }
 
-static int  readSeparateTilesIntoBuffer (TIFF* in, uint8 *obuf, 
-					 uint32 imagelength, uint32 imagewidth, 
-                                         uint32 tw, uint32 tl,
-                                         uint16 spp, uint16 bps)
-  {
-  int     i, status = 1, sample;
-  int     shift_width, bytes_per_pixel;
-  uint16  bytes_per_sample;
-  uint32  row, col;     /* Current row and col of image */
-  uint32  nrow, ncol;   /* Number of rows and cols in current tile */
-  uint32  row_offset, col_offset; /* Output buffer offsets */
-  tsize_t tbytes = 0, tilesize = TIFFTileSize(in);
-  tsample_t s;
-  uint8*  bufp = (uint8*)obuf;
-  unsigned char *srcbuffs[MAX_SAMPLES];
-  unsigned char *tbuff = NULL;
 
-  bytes_per_sample = (bps + 7) / 8;
+static int readSeparateTilesIntoBuffer(TIFF* in, uint8 *obuf, 
+                                       uint32 imagelength, uint32 imagewidth, 
+                                       uint32 tw, uint32 tl,
+                                       uint16 spp, uint16 bps)
+{
+    int i, status = 1, sample;
+    int shift_width, bytes_per_pixel;
+    uint16 bytes_per_sample;
+    uint32 row, col;     /* Current row and col of image */
+    uint32 nrow, ncol;   /* Number of rows and cols in current tile */
+    uint32 row_offset, col_offset; /* Output buffer offsets */
+    tsize_t tbytes = 0, tilesize = TIFFTileSize(in);
+    tsample_t s;
+    uint8* bufp = (uint8*)obuf;
+    unsigned char *srcbuffs[MAX_SAMPLES];
+    unsigned char *tbuff = NULL;
 
-  for (sample = 0; (sample < spp) && (sample < MAX_SAMPLES); sample++)
-    {
-    srcbuffs[sample] = NULL;
-    tbuff = (unsigned char *)_TIFFmalloc(tilesize + 8);
-    if (!tbuff)
-      {
-      TIFFError ("readSeparateTilesIntoBuffer", 
-                 "Unable to allocate tile read buffer for sample %d", sample);
-      for (i = 0; i < sample; i++)
-        _TIFFfree (srcbuffs[i]);
-      return 0;
-      }
-    srcbuffs[sample] = tbuff;
-    } 
-  /* Each tile contains only the data for a single plane
-   * arranged in scanlines of tw * bytes_per_sample bytes.
-   */
-  for (row = 0; row < imagelength; row += tl)
-    {
-    nrow = (row + tl > imagelength) ? imagelength - row : tl;
-    for (col = 0; col < imagewidth; col += tw)
-      {
-      for (s = 0; s < spp; s++)
-        {  /* Read each plane of a tile set into srcbuffs[s] */
-	tbytes = TIFFReadTile(in, srcbuffs[s], col, row, 0, s);
-        if (tbytes < 0  && !ignore)
-          {
-	  TIFFError(TIFFFileName(in),
-                 "Error, can't read tile for row %lu col %lu, "
-		 "sample %lu",
-		 (unsigned long) col, (unsigned long) row,
-		 (unsigned long) s);
-		 status = 0;
-          for (sample = 0; (sample < spp) && (sample < MAX_SAMPLES); sample++)
-            {
-            tbuff = srcbuffs[sample];
-            if (tbuff != NULL)
-              _TIFFfree(tbuff);
-            }
-          return status;
-	  }
-	}
-     /* Tiles on the right edge may be padded out to tw 
-      * which must be a multiple of 16.
-      * Ncol represents the visible (non padding) portion.  
-      */
-      if (col + tw > imagewidth)
-        ncol = imagewidth - col;
-      else
-        ncol = tw;
-
-      row_offset = row * (((imagewidth * spp * bps) + 7) / 8);
-      col_offset = ((col * spp * bps) + 7) / 8;
-      bufp = obuf + row_offset + col_offset;
+    bytes_per_sample = (bps + 7) / 8;
 
-      if ((bps % 8) == 0)
+    for (sample = 0; (sample < spp) && (sample < MAX_SAMPLES); sample++)
+    {
+        srcbuffs[sample] = NULL;
+        tbuff = (unsigned char *)_TIFFmalloc(tilesize + 8);
+        if (!tbuff)
         {
-        if (combineSeparateTileSamplesBytes(srcbuffs, bufp, ncol, nrow, imagewidth,
-					    tw, spp, bps, NULL, 0, 0))
-	  {
-          status = 0;
-          break;
-      	  }
-	}
-      else
+            TIFFError("readSeparateTilesIntoBuffer", 
+                       "Unable to allocate tile read buffer for sample %d", sample);
+            for (i = 0; i < sample; i++)
+                _TIFFfree(srcbuffs[i]);
+            return 0;
+        }
+        srcbuffs[sample] = tbuff;
+    }
+    /* Each tile contains only the data for a single plane
+     * arranged in scanlines of tw * bytes_per_sample bytes.
+     */
+    for (row = 0; row < imagelength; row += tl)
+    {
+        nrow = (row + tl > imagelength) ? imagelength - row : tl;
+        for (col = 0; col < imagewidth; col += tw)
         {
-        bytes_per_pixel  = ((bps * spp) + 7) / 8;
-        if (bytes_per_pixel < (bytes_per_sample + 1))
-          shift_width = bytes_per_pixel;
-        else
-          shift_width = bytes_per_sample + 1;
-
-        switch (shift_width)
-          {
-          case 1: if (combineSeparateTileSamples8bits (srcbuffs, bufp, ncol, nrow,
-                                                       imagewidth, tw, spp, bps, 
-						       NULL, 0, 0))
-	            {
-                    status = 0;
-                    break;
-      	            }
-	          break;
-          case 2: if (combineSeparateTileSamples16bits (srcbuffs, bufp, ncol, nrow,
-                                                       imagewidth, tw, spp, bps, 
-						       NULL, 0, 0))
-	            {
-                    status = 0;
-                    break;
-		    }
-	          break;
-          case 3: if (combineSeparateTileSamples24bits (srcbuffs, bufp, ncol, nrow,
-                                                       imagewidth, tw, spp, bps, 
-						       NULL, 0, 0))
-	            {
+            for (s = 0; s < spp; s++)
+            {  
+                tbytes = TIFFReadTile(in, srcbuffs[s], col, row, 0, s);
+                if (tbytes == (tsize_t)-1 && !ignore)
+                {
+                    TIFFError(TIFFFileName(in),
+                               "Error, can't read tile for row %lu col %lu, "
+                               "sample %lu",
+                               (unsigned long)col, (unsigned long)row,
+                               (unsigned long)s);
                     status = 0;
-                    break;
-       	            }
-                  break;
-          case 4: 
-          case 5:
-          case 6:
-          case 7:
-          case 8: if (combineSeparateTileSamples32bits (srcbuffs, bufp, ncol, nrow,
-                                                       imagewidth, tw, spp, bps, 
-						       NULL, 0, 0))
-	            {
+                    for (sample = 0; (sample < spp) && (sample < MAX_SAMPLES); sample++)
+                    {
+                        tbuff = srcbuffs[sample];
+                        if (tbuff != NULL)
+                            _TIFFfree(tbuff);
+                    }
+                    return status;
+                }
+            }
+            /* Tiles on the right edge may be padded out to tw 
+             * which must be a multiple of 16.
+             * Ncol represents the visible (non padding) portion.  
+             */
+            if (col + tw > imagewidth)
+                ncol = imagewidth - col;
+            else
+                ncol = tw;
+
+            row_offset = row * (((imagewidth * spp * bps) + 7) / 8);
+            col_offset = ((col * spp * bps) + 7) / 8;
+            bufp = obuf + row_offset + col_offset;
+
+            if ((bps % 8) == 0)
+            {
+                if (combineSeparateTileSamplesBytes(srcbuffs, bufp, ncol, nrow, imagewidth,
+                                                    tw, spp, bps, NULL, 0, 0))
+                {
                     status = 0;
                     break;
-		    }
-	          break;
-          default: TIFFError ("readSeparateTilesIntoBuffer", "Unsupported bit depth: %d", bps);
-                  status = 0;
-                  break;
-          }
+                }
+            }
+            else
+            {
+                bytes_per_pixel = ((bps * spp) + 7) / 8;
+                if (bytes_per_pixel < (bytes_per_sample + 1))
+                    shift_width = bytes_per_pixel;
+                else
+                    shift_width = bytes_per_sample + 1;
+
+                switch (shift_width)
+                {
+                    case 1: if (combineSeparateTileSamples8bits (srcbuffs, bufp, ncol, nrow,
+                                                                 imagewidth, tw, spp, bps, 
+                                                                 NULL, 0, 0))
+                        {
+                            status = 0;
+                            break;
+                        }
+                        break;
+                    case 2: if (combineSeparateTileSamples16bits (srcbuffs, bufp, ncol, nrow,
+                                                                 imagewidth, tw, spp, bps, 
+                                                                 NULL, 0, 0))
+                        {
+                            status = 0;
+                            break;
+                        }
+                        break;
+                    case 3: if (combineSeparateTileSamples24bits (srcbuffs, bufp, ncol, nrow,
+                                                                 imagewidth, tw, spp, bps, 
+                                                                 NULL, 0, 0))
+                        {
+                            status = 0;
+                            break;
+                        }
+                        break;
+                    case 4: 
+                    case 5:
+                    case 6:
+                    case 7:
+                    case 8: if (combineSeparateTileSamples32bits (srcbuffs, bufp, ncol, nrow,
+                                                                 imagewidth, tw, spp, bps, 
+                                                                 NULL, 0, 0))
+                        {
+                            status = 0;
+                            break;
+                        }
+                        break;
+                    default: TIFFError("readSeparateTilesIntoBuffer", "Unsupported bit depth: %d", bps);
+                             status = 0;
+                             break;
+                }
+            }
         }
-      }
     }
 
-  for (sample = 0; (sample < spp) && (sample < MAX_SAMPLES); sample++)
+    for (sample = 0; (sample < spp) && (sample < MAX_SAMPLES); sample++)
     {
-    tbuff = srcbuffs[sample];
-    if (tbuff != NULL)
-      _TIFFfree(tbuff);
+        tbuff = srcbuffs[sample];
+        if (tbuff != NULL)
+            _TIFFfree(tbuff);
     }
- 
-  return status;
-  }
+
+    return status;
+}
+
 
 static int writeBufferToContigStrips(TIFF* out, uint8* buf, uint32 imagelength)
   {

2025-02-03 22:14:18.224 | DEBUG    | scenario:rebuild:369 - original environment: environ({'CONDA_SHLVL': '2', 'LC_ALL': 'C.UTF-8', 'LS_COLORS': 'rs=0:di=01;34:ln=01;36:mh=00:pi=40;33:so=01;35:do=01;35:bd=40;33;01:cd=40;33;01:or=40;31;01:mi=00:su=37;41:sg=30;43:ca=30;41:tw=30;42:ow=34;42:st=37;44:ex=01;32:*.tar=01;31:*.tgz=01;31:*.arc=01;31:*.arj=01;31:*.taz=01;31:*.lha=01;31:*.lz4=01;31:*.lzh=01;31:*.lzma=01;31:*.tlz=01;31:*.txz=01;31:*.tzo=01;31:*.t7z=01;31:*.zip=01;31:*.z=01;31:*.Z=01;31:*.dz=01;31:*.gz=01;31:*.lrz=01;31:*.lz=01;31:*.lzo=01;31:*.xz=01;31:*.zst=01;31:*.tzst=01;31:*.bz2=01;31:*.bz=01;31:*.tbz=01;31:*.tbz2=01;31:*.tz=01;31:*.deb=01;31:*.rpm=01;31:*.jar=01;31:*.war=01;31:*.ear=01;31:*.sar=01;31:*.rar=01;31:*.alz=01;31:*.ace=01;31:*.zoo=01;31:*.cpio=01;31:*.7z=01;31:*.rz=01;31:*.cab=01;31:*.wim=01;31:*.swm=01;31:*.dwm=01;31:*.esd=01;31:*.jpg=01;35:*.jpeg=01;35:*.mjpg=01;35:*.mjpeg=01;35:*.gif=01;35:*.bmp=01;35:*.pbm=01;35:*.pgm=01;35:*.ppm=01;35:*.tga=01;35:*.xbm=01;35:*.xpm=01;35:*.tif=01;35:*.tiff=01;35:*.png=01;35:*.svg=01;35:*.svgz=01;35:*.mng=01;35:*.pcx=01;35:*.mov=01;35:*.mpg=01;35:*.mpeg=01;35:*.m2v=01;35:*.mkv=01;35:*.webm=01;35:*.ogm=01;35:*.mp4=01;35:*.m4v=01;35:*.mp4v=01;35:*.vob=01;35:*.qt=01;35:*.nuv=01;35:*.wmv=01;35:*.asf=01;35:*.rm=01;35:*.rmvb=01;35:*.flc=01;35:*.avi=01;35:*.fli=01;35:*.flv=01;35:*.gl=01;35:*.dl=01;35:*.xcf=01;35:*.xwd=01;35:*.yuv=01;35:*.cgm=01;35:*.emf=01;35:*.ogv=01;35:*.ogx=01;35:*.aac=00;36:*.au=00;36:*.flac=00;36:*.m4a=00;36:*.mid=00;36:*.midi=00;36:*.mka=00;36:*.mp3=00;36:*.mpc=00;36:*.ogg=00;36:*.ra=00;36:*.wav=00;36:*.oga=00;36:*.opus=00;36:*.spx=00;36:*.xspf=00;36:', 'LD_LIBRARY_PATH': '/opt/crashrepair/lib:/CrashRepair/lib:/klee/build/lib:', 'CONDA_EXE': '/root/anaconda3/bin/conda', 'LANG': 'C.UTF-8', 'TZ': 'Asia/Shanghai', 'HOSTNAME': 'fea22102047d', 'OLDPWD': '/orchestrator', 'CONDA_PREFIX': '/root/anaconda3/envs/CrashRepair', '_CE_M': '', 'CC': 'crepair-cc', 'LLVM_COMPILER': 'clang', 'CONDA_PREFIX_1': '/root/anaconda3', 'PWD': '/orchestrator/crashrepair', 'HOME': '/root', 'CONDA_PYTHON_EXE': '/root/anaconda3/bin/python', '_CE_CONDA': '', 'CONDA_PROMPT_MODIFIER': '(CrashRepair) ', 'CXX': 'crepair-cxx', 'TERM': 'xterm', 'SHLVL': '2', 'PYTHONPATH': '/usr/lib/python3.8/site-packages:', 'PATH': '/root/anaconda3/envs/CrashRepair/bin:/root/anaconda3/condabin:~/anaconda3/bin:/opt/crashrepair/bin:/CrashRepair/compiler:/klee/build/bin:/opt/llvm-6/bin:/klee/build/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', 'CONDA_DEFAULT_ENV': 'CrashRepair', '_': '/root/anaconda3/envs/CrashRepair/bin/python'})
2025-02-03 22:14:18.224 | DEBUG    | scenario:rebuild:382 - injecting ghost function into CFLAGS during build: -lcrepair_ghost
2025-02-03 22:14:18.225 | DEBUG    | scenario:rebuild:398 - using environment: {'INJECT_CFLAGS': '-g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address', 'INJECT_CXXFLAGS': '-g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address', 'INJECT_LDFLAGS': '-g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address'}
2025-02-03 22:14:18.225 | DEBUG    | shell:__call__:41 - executing: make CFLAGS="${INJECT_CFLAGS}" CXXFLAGS="${INJECT_CXXFLAGS}" LDFLAGS="${INJECT_LDFLAGS}"
Making all in port
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/port'
make[1]: Nothing to be done for 'all'.
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/port'
Making all in libtiff
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/libtiff'
make  all-am
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/libtiff'
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/libtiff'
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/libtiff'
Making all in tools
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/tools'
crepair-cc -DHAVE_CONFIG_H -I. -I../libtiff  -I../libtiff   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -MT tiffcrop.o -MD -MP -MF .deps/tiffcrop.Tpo -c -o tiffcrop.o tiffcrop.c
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_ghost: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
mv -f .deps/tiffcrop.Tpo .deps/tiffcrop.Po
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address  -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -o tiffcrop tiffcrop.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -g -O0 -Wno-error -I/CrashRepair/lib -fsanitize=address -g -O0 -Wno-error -I/CrashRepair/lib -fsanitize=address -o tiffcrop tiffcrop.o  -L/klee/build/lib -L/CrashRepair/lib -lkleeRuntest -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost ../libtiff/.libs/libtiff.a ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/tools'
Making all in build
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/build'
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/build'
make[2]: Nothing to be done for 'all-am'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/build'
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/build'
Making all in contrib
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib'
Making all in addtiffo
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/addtiffo'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/addtiffo'
Making all in dbs
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/dbs'
Making all in xtiff
make[3]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/dbs/xtiff'
make[3]: Nothing to be done for 'all'.
make[3]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/dbs/xtiff'
make[3]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/dbs'
make[3]: Nothing to be done for 'all-am'.
make[3]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/dbs'
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/dbs'
Making all in iptcutil
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/iptcutil'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/iptcutil'
Making all in mfs
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/mfs'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/mfs'
Making all in pds
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/pds'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/pds'
Making all in ras
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/ras'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/ras'
Making all in stream
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/stream'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/stream'
Making all in tags
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/tags'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/tags'
Making all in win_dib
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/win_dib'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/win_dib'
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib'
make[2]: Nothing to be done for 'all-am'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib'
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib'
Making all in test
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/test'
make[1]: Nothing to be done for 'all'.
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/test'
Making all in man
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/man'
make[1]: Nothing to be done for 'all'.
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/man'
Making all in html
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html'
Making all in images
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html/images'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html/images'
Making all in man
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html/man'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html/man'
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html'
make[2]: Nothing to be done for 'all-am'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html'
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html'
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src'
make[1]: Nothing to be done for 'all-am'.
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src'
2025-02-03 22:14:18.686 | INFO     | analyzer:run:114 - running analysis with timeout: 60 minutes
2025-02-03 22:14:18.686 | DEBUG    | analyzer:write_config_to_file:88 - generated analyzer config:

dir_exp:/data/vulnloc/libtiff/CVE-2016-5321
tag_id:libtiff_CVE-2016-5321
src_directory:/data/vulnloc/libtiff/CVE-2016-5321/src
binary_path:/data/vulnloc/libtiff/CVE-2016-5321/src/tools/tiffcrop
config_command:./configure --enable-static --disable-shared
build_command:make CFLAGS="${INJECT_CFLAGS}" CXXFLAGS="${INJECT_CXXFLAGS}" LDFLAGS="${INJECT_LDFLAGS}"
test_input_list:$POC foo.tif
poc_list:/CrashRepair/experiments/vulnloc/libtiff/CVE-2016-5321/tests/1.tif
klee_flags:--link-llvm-lib=/CrashRepair/lib/libcrepair_proxy.bca 

2025-02-03 22:14:18.686 | DEBUG    | analyzer:run:124 - wrote analyzer config file to: /tmp/tmpzs4mjuqz
2025-02-03 22:14:18.687 | DEBUG    | shell:__call__:41 - executing: crepair --conf=/tmp/tmpzs4mjuqz
[K[1;36m
====================================================================================================

	Starting CRepair (C Crash Repair) 
====================================================================================================
[0m
[K[1;36m
	Loading Configurations
	__________________________________________________________________________________________
[0m
[K	[1;34mreading configuration values from arguments[0m
[K	[1;34mreading configuration values form configuration file[0m
[K	[1;37m	[file] /tmp/tmpzs4mjuqz[0m
[K	[1;34mupdating configuration values[0m
[K	[1;34mreading test configuration[0m
[K	[1;34mreading seed information[0m
[K	[1;37m	[config] stack size: 15000[0m
[K	[1;37m	[config] collecting stats: False[0m
[K	[1;37m	[config] number of tests: 1[0m
[K	[1;37m	[config] number of cores: 8[0m
[K	[1;37m	[config] klee concrete execution timeout: 600[0m
[K	[1;37m	[config] klee concolic execution timeout: 1200[0m
[K	[1;37m	[config] synthesize subset expressions: True[0m
[K	[1;37m	[config] window size for taint locations: 500[0m
[K	[1;37m	[config] window size for taint values: 500000[0m
[K[1;36m

	Analyzing Program
====================================================================================================
[0m
[K[1;36m
	Test Case #1
	__________________________________________________________________________________________
[0m
[K[1;36m
		Running Concrete Execution
		------------------------------------------------------------------------------------------
[0m
[K	[1;37m	[0m[K     [1;37mUsing Arguments: ['$POC', 'foo.tif'][0m
[K	[1;37m	[0m[K     [1;37mUsing Input File: /CrashRepair/experiments/vulnloc/libtiff/CVE-2016-5321/tests/1.tif[0m
[K	[1;34m	building program[0m
[K	[1;34m		setting environment variables[0m
[K	[1;34m		cleaning files[0m
[K	[1;34m		configuring program[0m
[K	[1;34m		compiling program[0m
[K	[1;37m	[0m[K     [1;37mUsing Binary: /data/vulnloc/libtiff/CVE-2016-5321/src/tools/tiffcrop[0m
[K	[1;34m	extracting bytecode[0m
[K	[1;34m	executing klee in concrete mode[0m
[K	[1;34m	extracting instruction trace[0m
[K	[1;37m		[note] program crashed[0m
[K	[1;34m	collecting tainted expressions[0m
[K	[1;34m	collecting tainted concrete values[0m
[K	[1;34m	collecting memory allocations/de-allocations[0m
[K	[1;34m	collecting pointer mapping[0m
[K	[1;34m	extracting crash information[0m
[K	[1;37m		[0m[K     [1;37m[info] crash type: memory read overflow[0m
[K	[1;37m		[0m[K     [1;37m[info] crash location:
                             /data/vulnloc/libtiff/CVE-2016-5321/src/tools/tiffcrop.c:995:43[0m
[K	[1;37m		[0m[K     [1;37m[info] crash function: readSeparateTilesIntoBuffer[0m
[K	[1;37m		[0m[K     [1;37m[info] crash address: 116502[0m
[K	[1;37m		[0m[K     [1;37m[info] crash free constraint: ((8 * @var(integer, s)) < 64)[0m
[K	[1;37m		[0m[K     [1;37m[info] crash inducing variables: s[0m
[K	[1;37m			[info] identified crash type: memory read overflow[0m
[K[1;36m
		Running Concolic Execution
		------------------------------------------------------------------------------------------
[0m
[K	[1;37m	[0m[K     [1;37mUsing Arguments: ['$POC', 'foo.tif'][0m
[K	[1;37m	[0m[K     [1;37mUsing Input File: /CrashRepair/experiments/vulnloc/libtiff/CVE-2016-5321/tests/1.tif[0m
[K	[1;34m	building program[0m
[K	[1;34m		setting environment variables[0m
[K	[1;34m		cleaning files[0m
[K	[1;34m		configuring program[0m
[K	[1;34m		compiling program[0m
[K	[1;34m	extracting bytecode[0m
[K	[1;34m	generating ktest file[0m
[K	[1;34m	executing klee in concolic mode[0m
[K	[1;34m	extracting largest symbolic path[0m
[K	[1;34m	extracting instruction trace[0m
[K	[1;37m		[note] program crashed[0m
[K	[1;34m	collecting tainted expressions[0m
[K	[1;34m	collecting memory allocations/de-allocations[0m
[K	[1;34m	collecting pointer mapping[0m
[K	[1;37m		[0m[K     [1;37m[info] Symbolic Mapping: s -> [][0m
[K[1;36m

	Fix Localization
====================================================================================================
[0m
[K[1;36m
	Generating Fix Locations
	__________________________________________________________________________________________
[0m
[K	[1;34m	generating taint map[0m
[K	[1;37m		[0m[K     [1;37m[info] found 10854 tainted locations[0m
[K	[1;34m		starting parallel computing[0m
[K	[1;34m		waiting for thread completion[0m
[K	[1;37m		[0m[K     [1;37m[info] found 5 source files[0m
[K	[1;37m		[0m[K     [1;37m[info] found 12 executed functions[0m
[K	[1;34m	generating possible fix locations[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] readSeparateTilesIntoBuffer,
                             /data/vulnloc/libtiff/CVE-2016-5321/src/tools/tiffcrop.c:993:35[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] readSeparateTilesIntoBuffer,
                             /data/vulnloc/libtiff/CVE-2016-5321/src/tools/tiffcrop.c:996:28[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] readSeparateTilesIntoBuffer,
                             /data/vulnloc/libtiff/CVE-2016-5321/src/tools/tiffcrop.c:996:21[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] readSeparateTilesIntoBuffer,
                             /data/vulnloc/libtiff/CVE-2016-5321/src/tools/tiffcrop.c:995:24[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] readSeparateTilesIntoBuffer,
                             /data/vulnloc/libtiff/CVE-2016-5321/src/tools/tiffcrop.c:995:26[0m
[K[1;36m
	Localizing Constraints
	__________________________________________________________________________________________
[0m
[K[1;36m
		[fix-loc] /data/vulnloc/libtiff/CVE-2016-5321/src/tools/tiffcrop.c:993:13
		------------------------------------------------------------------------------------------
[0m
[K	[1;37m	[0m[K     [1;37m[constraint] ((8 * @var(integer, s)) < 64)[0m
[K[1;36m
		[fix-loc] /data/vulnloc/libtiff/CVE-2016-5321/src/tools/tiffcrop.c:995:26
		------------------------------------------------------------------------------------------
[0m
[K	[1;37m	[0m[K     [1;37m[constraint] ((8 * @var(integer, s)) < 64)[0m
[K[1;36m
		[fix-loc] /data/vulnloc/libtiff/CVE-2016-5321/src/tools/tiffcrop.c:996:17
		------------------------------------------------------------------------------------------
[0m
[K	[1;37m	[0m[K     [1;37m[constraint] ((8 * @var(integer, s)) < 64)[0m
[K[1;36m
		[fix-loc] /data/vulnloc/libtiff/CVE-2016-5321/src/tools/tiffcrop.c:995:17
		------------------------------------------------------------------------------------------
[0m
[K	[1;37m	[0m[K     [1;37m[constraint] ((8 * @var(integer, s)) < 64)[0m
[K[1;32m
	localization information saved at /CrashRepair/output/libtiff_CVE-2016-5321/localization.json[0m
[K[1;32m
	state values saved at /CrashRepair/output/libtiff_CVE-2016-5321/values/[0m
[K	[1;37m
Run time statistics:
-----------------------
[0m
[K	[1;37mStartup: 0.000 minutes[0m
[K	[1;37mBuild: 0 minutes[0m
[K	[1;37mConcrete Analysis: 0.675 minutes[0m
[K	[1;37mConcolic Analysis: 0.584 minutes[0m
[K	[1;37mTotal Analysis: 1.293 minutes[0m
[K	[1;37mLocalization: 0.292 minutes[0m
[K[1;32m
CRepair finished successfully after 1.629 minutes 
[0m
2025-02-03 22:15:57.291 | WARNING  | analyzer:run:143 - analysis output directory does not exist [/data/vulnloc/libtiff/CVE-2016-5321/analysis]: creating...
2025-02-03 22:15:57.395 | INFO     | scenario:analyze_for_guide:558 - reanalyzing candidate patch: #10:
@@ -948,11 +948,12 @@
   return status;
   }
 
-static int  readSeparateTilesIntoBuffer (TIFF* in, uint8 *obuf, 
-					 uint32 imagelength, uint32 imagewidth, 
-                                         uint32 tw, uint32 tl,
-                                         uint16 spp, uint16 bps)
-  {
+
+static int readSeparateTilesIntoBuffer (TIFF* in, uint8 *obuf, 
+                                        uint32 imagelength, uint32 imagewidth, 
+                                        uint32 tw, uint32 tl,
+                                        uint16 spp, uint16 bps)
+{
   int     i, status = 1, sample;
   int     shift_width, bytes_per_pixel;
   uint16  bytes_per_sample;
@@ -968,51 +969,53 @@
   bytes_per_sample = (bps + 7) / 8;
 
   for (sample = 0; (sample < spp) && (sample < MAX_SAMPLES); sample++)
-    {
+  {
     srcbuffs[sample] = NULL;
     tbuff = (unsigned char *)_TIFFmalloc(tilesize + 8);
     if (!tbuff)
-      {
+    {
       TIFFError ("readSeparateTilesIntoBuffer", 
                  "Unable to allocate tile read buffer for sample %d", sample);
       for (i = 0; i < sample; i++)
         _TIFFfree (srcbuffs[i]);
       return 0;
-      }
+    }
     srcbuffs[sample] = tbuff;
-    } 
+  } 
   /* Each tile contains only the data for a single plane
    * arranged in scanlines of tw * bytes_per_sample bytes.
    */
   for (row = 0; row < imagelength; row += tl)
-    {
+  {
     nrow = (row + tl > imagelength) ? imagelength - row : tl;
     for (col = 0; col < imagewidth; col += tw)
-      {
+    {
       for (s = 0; s < spp; s++)
-        {  /* Read each plane of a tile set into srcbuffs[s] */
-	tbytes = TIFFReadTile(in, srcbuffs[s], col, row, 0, s);
-        if (tbytes < 0  && !ignore)
-          {
-	  TIFFError(TIFFFileName(in),
-                 "Error, can't read tile for row %lu col %lu, "
-		 "sample %lu",
-		 (unsigned long) col, (unsigned long) row,
-		 (unsigned long) s);
-		 status = 0;
+      {  /* Read each plane of a tile set into srcbuffs[s] */
+        tbytes = TIFFReadTile(in, srcbuffs[s], col, row, 0, s);
+        if (tbytes < 0)
+        {
+          if (!ignore) {
+            TIFFError(TIFFFileName(in),
+                       "Error, can't read tile for row %lu col %lu, "
+                       "sample %lu",
+                       (unsigned long) col, (unsigned long) row,
+                       (unsigned long) s);
+            status = 0;
+          }
           for (sample = 0; (sample < spp) && (sample < MAX_SAMPLES); sample++)
-            {
+          {
             tbuff = srcbuffs[sample];
             if (tbuff != NULL)
               _TIFFfree(tbuff);
-            }
+          }
           return status;
-	  }
-	}
-     /* Tiles on the right edge may be padded out to tw 
-      * which must be a multiple of 16.
-      * Ncol represents the visible (non padding) portion.  
-      */
+        }
+      }
+      /* Tiles on the right edge may be padded out to tw 
+       * which must be a multiple of 16.
+       * Ncol represents the visible (non padding) portion.  
+       */
       if (col + tw > imagewidth)
         ncol = imagewidth - col;
       else
@@ -1023,16 +1026,16 @@
       bufp = obuf + row_offset + col_offset;
 
       if ((bps % 8) == 0)
-        {
+      {
         if (combineSeparateTileSamplesBytes(srcbuffs, bufp, ncol, nrow, imagewidth,
-					    tw, spp, bps, NULL, 0, 0))
-	  {
+                                             tw, spp, bps, NULL, 0, 0))
+        {
           status = 0;
           break;
-      	  }
-	}
+        }
+      }
       else
-        {
+      {
         bytes_per_pixel  = ((bps * spp) + 7) / 8;
         if (bytes_per_pixel < (bytes_per_sample + 1))
           shift_width = bytes_per_pixel;
@@ -1040,61 +1043,62 @@
           shift_width = bytes_per_sample + 1;
 
         switch (shift_width)
-          {
+        {
           case 1: if (combineSeparateTileSamples8bits (srcbuffs, bufp, ncol, nrow,
                                                        imagewidth, tw, spp, bps, 
-						       NULL, 0, 0))
-	            {
-                    status = 0;
-                    break;
-      	            }
-	          break;
+                                                       NULL, 0, 0))
+            {
+              status = 0;
+              break;
+            }
+            break;
           case 2: if (combineSeparateTileSamples16bits (srcbuffs, bufp, ncol, nrow,
                                                        imagewidth, tw, spp, bps, 
-						       NULL, 0, 0))
-	            {
-                    status = 0;
-                    break;
-		    }
-	          break;
+                                                       NULL, 0, 0))
+            {
+              status = 0;
+              break;
+            }
+            break;
           case 3: if (combineSeparateTileSamples24bits (srcbuffs, bufp, ncol, nrow,
                                                        imagewidth, tw, spp, bps, 
-						       NULL, 0, 0))
-	            {
-                    status = 0;
-                    break;
-       	            }
-                  break;
+                                                       NULL, 0, 0))
+            {
+              status = 0;
+              break;
+            }
+            break;
           case 4: 
           case 5:
           case 6:
           case 7:
           case 8: if (combineSeparateTileSamples32bits (srcbuffs, bufp, ncol, nrow,
                                                        imagewidth, tw, spp, bps, 
-						       NULL, 0, 0))
-	            {
-                    status = 0;
-                    break;
-		    }
-	          break;
+                                                       NULL, 0, 0))
+            {
+              status = 0;
+              break;
+            }
+            break;
           default: TIFFError ("readSeparateTilesIntoBuffer", "Unsupported bit depth: %d", bps);
                   status = 0;
                   break;
-          }
         }
       }
     }
+  }
 
   for (sample = 0; (sample < spp) && (sample < MAX_SAMPLES); sample++)
-    {
+  {
     tbuff = srcbuffs[sample];
     if (tbuff != NULL)
       _TIFFfree(tbuff);
-    }
- 
-  return status;
   }
 
+  return status;
+}
+
+
 static int writeBufferToContigStrips(TIFF* out, uint8* buf, uint32 imagelength)
   {
   uint32 row, nrows, rowsperstrip;

2025-02-03 22:15:57.406 | DEBUG    | scenario:rebuild:369 - original environment: environ({'CONDA_SHLVL': '2', 'LC_ALL': 'C.UTF-8', 'LS_COLORS': 'rs=0:di=01;34:ln=01;36:mh=00:pi=40;33:so=01;35:do=01;35:bd=40;33;01:cd=40;33;01:or=40;31;01:mi=00:su=37;41:sg=30;43:ca=30;41:tw=30;42:ow=34;42:st=37;44:ex=01;32:*.tar=01;31:*.tgz=01;31:*.arc=01;31:*.arj=01;31:*.taz=01;31:*.lha=01;31:*.lz4=01;31:*.lzh=01;31:*.lzma=01;31:*.tlz=01;31:*.txz=01;31:*.tzo=01;31:*.t7z=01;31:*.zip=01;31:*.z=01;31:*.Z=01;31:*.dz=01;31:*.gz=01;31:*.lrz=01;31:*.lz=01;31:*.lzo=01;31:*.xz=01;31:*.zst=01;31:*.tzst=01;31:*.bz2=01;31:*.bz=01;31:*.tbz=01;31:*.tbz2=01;31:*.tz=01;31:*.deb=01;31:*.rpm=01;31:*.jar=01;31:*.war=01;31:*.ear=01;31:*.sar=01;31:*.rar=01;31:*.alz=01;31:*.ace=01;31:*.zoo=01;31:*.cpio=01;31:*.7z=01;31:*.rz=01;31:*.cab=01;31:*.wim=01;31:*.swm=01;31:*.dwm=01;31:*.esd=01;31:*.jpg=01;35:*.jpeg=01;35:*.mjpg=01;35:*.mjpeg=01;35:*.gif=01;35:*.bmp=01;35:*.pbm=01;35:*.pgm=01;35:*.ppm=01;35:*.tga=01;35:*.xbm=01;35:*.xpm=01;35:*.tif=01;35:*.tiff=01;35:*.png=01;35:*.svg=01;35:*.svgz=01;35:*.mng=01;35:*.pcx=01;35:*.mov=01;35:*.mpg=01;35:*.mpeg=01;35:*.m2v=01;35:*.mkv=01;35:*.webm=01;35:*.ogm=01;35:*.mp4=01;35:*.m4v=01;35:*.mp4v=01;35:*.vob=01;35:*.qt=01;35:*.nuv=01;35:*.wmv=01;35:*.asf=01;35:*.rm=01;35:*.rmvb=01;35:*.flc=01;35:*.avi=01;35:*.fli=01;35:*.flv=01;35:*.gl=01;35:*.dl=01;35:*.xcf=01;35:*.xwd=01;35:*.yuv=01;35:*.cgm=01;35:*.emf=01;35:*.ogv=01;35:*.ogx=01;35:*.aac=00;36:*.au=00;36:*.flac=00;36:*.m4a=00;36:*.mid=00;36:*.midi=00;36:*.mka=00;36:*.mp3=00;36:*.mpc=00;36:*.ogg=00;36:*.ra=00;36:*.wav=00;36:*.oga=00;36:*.opus=00;36:*.spx=00;36:*.xspf=00;36:', 'LD_LIBRARY_PATH': '/opt/crashrepair/lib:/CrashRepair/lib:/klee/build/lib:', 'CONDA_EXE': '/root/anaconda3/bin/conda', 'LANG': 'C.UTF-8', 'TZ': 'Asia/Shanghai', 'HOSTNAME': 'fea22102047d', 'OLDPWD': '/orchestrator', 'CONDA_PREFIX': '/root/anaconda3/envs/CrashRepair', '_CE_M': '', 'CC': 'crepair-cc', 'LLVM_COMPILER': 'clang', 'CONDA_PREFIX_1': '/root/anaconda3', 'PWD': '/orchestrator/crashrepair', 'HOME': '/root', 'CONDA_PYTHON_EXE': '/root/anaconda3/bin/python', '_CE_CONDA': '', 'CONDA_PROMPT_MODIFIER': '(CrashRepair) ', 'CXX': 'crepair-cxx', 'TERM': 'xterm', 'SHLVL': '2', 'PYTHONPATH': '/usr/lib/python3.8/site-packages:', 'PATH': '/root/anaconda3/envs/CrashRepair/bin:/root/anaconda3/condabin:~/anaconda3/bin:/opt/crashrepair/bin:/CrashRepair/compiler:/klee/build/bin:/opt/llvm-6/bin:/klee/build/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', 'CONDA_DEFAULT_ENV': 'CrashRepair', '_': '/root/anaconda3/envs/CrashRepair/bin/python'})
2025-02-03 22:15:57.406 | DEBUG    | scenario:rebuild:382 - injecting ghost function into CFLAGS during build: -lcrepair_ghost
2025-02-03 22:15:57.406 | DEBUG    | scenario:rebuild:398 - using environment: {'INJECT_CFLAGS': '-g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address', 'INJECT_CXXFLAGS': '-g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address', 'INJECT_LDFLAGS': '-g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address'}
2025-02-03 22:15:57.406 | DEBUG    | shell:__call__:41 - executing: make CFLAGS="${INJECT_CFLAGS}" CXXFLAGS="${INJECT_CXXFLAGS}" LDFLAGS="${INJECT_LDFLAGS}"
Making all in port
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/port'
make[1]: Nothing to be done for 'all'.
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/port'
Making all in libtiff
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/libtiff'
make  all-am
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/libtiff'
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/libtiff'
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/libtiff'
Making all in tools
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/tools'
crepair-cc -DHAVE_CONFIG_H -I. -I../libtiff  -I../libtiff   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -MT tiffcrop.o -MD -MP -MF .deps/tiffcrop.Tpo -c -o tiffcrop.o tiffcrop.c
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_ghost: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
mv -f .deps/tiffcrop.Tpo .deps/tiffcrop.Po
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address  -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -o tiffcrop tiffcrop.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -g -O0 -Wno-error -I/CrashRepair/lib -fsanitize=address -g -O0 -Wno-error -I/CrashRepair/lib -fsanitize=address -o tiffcrop tiffcrop.o  -L/klee/build/lib -L/CrashRepair/lib -lkleeRuntest -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost ../libtiff/.libs/libtiff.a ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/tools'
Making all in build
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/build'
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/build'
make[2]: Nothing to be done for 'all-am'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/build'
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/build'
Making all in contrib
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib'
Making all in addtiffo
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/addtiffo'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/addtiffo'
Making all in dbs
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/dbs'
Making all in xtiff
make[3]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/dbs/xtiff'
make[3]: Nothing to be done for 'all'.
make[3]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/dbs/xtiff'
make[3]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/dbs'
make[3]: Nothing to be done for 'all-am'.
make[3]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/dbs'
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/dbs'
Making all in iptcutil
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/iptcutil'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/iptcutil'
Making all in mfs
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/mfs'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/mfs'
Making all in pds
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/pds'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/pds'
Making all in ras
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/ras'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/ras'
Making all in stream
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/stream'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/stream'
Making all in tags
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/tags'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/tags'
Making all in win_dib
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/win_dib'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/win_dib'
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib'
make[2]: Nothing to be done for 'all-am'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib'
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib'
Making all in test
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/test'
make[1]: Nothing to be done for 'all'.
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/test'
Making all in man
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/man'
make[1]: Nothing to be done for 'all'.
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/man'
Making all in html
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html'
Making all in images
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html/images'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html/images'
Making all in man
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html/man'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html/man'
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html'
make[2]: Nothing to be done for 'all-am'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html'
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html'
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src'
make[1]: Nothing to be done for 'all-am'.
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src'
2025-02-03 22:15:57.883 | INFO     | analyzer:run:114 - running analysis with timeout: 60 minutes
2025-02-03 22:15:57.883 | DEBUG    | analyzer:write_config_to_file:88 - generated analyzer config:

dir_exp:/data/vulnloc/libtiff/CVE-2016-5321
tag_id:libtiff_CVE-2016-5321
src_directory:/data/vulnloc/libtiff/CVE-2016-5321/src
binary_path:/data/vulnloc/libtiff/CVE-2016-5321/src/tools/tiffcrop
config_command:./configure --enable-static --disable-shared
build_command:make CFLAGS="${INJECT_CFLAGS}" CXXFLAGS="${INJECT_CXXFLAGS}" LDFLAGS="${INJECT_LDFLAGS}"
test_input_list:$POC foo.tif
poc_list:/CrashRepair/experiments/vulnloc/libtiff/CVE-2016-5321/tests/1.tif
klee_flags:--link-llvm-lib=/CrashRepair/lib/libcrepair_proxy.bca 

2025-02-03 22:15:57.884 | DEBUG    | analyzer:run:124 - wrote analyzer config file to: /tmp/tmpssd73wux
2025-02-03 22:15:57.884 | DEBUG    | shell:__call__:41 - executing: crepair --conf=/tmp/tmpssd73wux
[K[1;36m
====================================================================================================

	Starting CRepair (C Crash Repair) 
====================================================================================================
[0m
[K[1;36m
	Loading Configurations
	__________________________________________________________________________________________
[0m
[K	[1;34mreading configuration values from arguments[0m
[K	[1;34mreading configuration values form configuration file[0m
[K	[1;37m	[file] /tmp/tmpssd73wux[0m
[K	[1;34mupdating configuration values[0m
[K	[1;34mreading test configuration[0m
[K	[1;34mreading seed information[0m
[K	[1;37m	[config] stack size: 15000[0m
[K	[1;37m	[config] collecting stats: False[0m
[K	[1;37m	[config] number of tests: 1[0m
[K	[1;37m	[config] number of cores: 8[0m
[K	[1;37m	[config] klee concrete execution timeout: 600[0m
[K	[1;37m	[config] klee concolic execution timeout: 1200[0m
[K	[1;37m	[config] synthesize subset expressions: True[0m
[K	[1;37m	[config] window size for taint locations: 500[0m
[K	[1;37m	[config] window size for taint values: 500000[0m
[K[1;36m

	Analyzing Program
====================================================================================================
[0m
[K[1;36m
	Test Case #1
	__________________________________________________________________________________________
[0m
[K[1;36m
		Running Concrete Execution
		------------------------------------------------------------------------------------------
[0m
[K	[1;37m	[0m[K     [1;37mUsing Arguments: ['$POC', 'foo.tif'][0m
[K	[1;37m	[0m[K     [1;37mUsing Input File: /CrashRepair/experiments/vulnloc/libtiff/CVE-2016-5321/tests/1.tif[0m
[K	[1;34m	building program[0m
[K	[1;34m		setting environment variables[0m
[K	[1;34m		cleaning files[0m
[K	[1;34m		configuring program[0m
[K	[1;34m		compiling program[0m
[K	[1;37m	[0m[K     [1;37mUsing Binary: /data/vulnloc/libtiff/CVE-2016-5321/src/tools/tiffcrop[0m
[K	[1;34m	extracting bytecode[0m
[K	[1;34m	executing klee in concrete mode[0m
[K	[1;34m	extracting instruction trace[0m
[K	[1;37m		[note] program crashed[0m
[K	[1;34m	collecting tainted expressions[0m
[K	[1;34m	collecting tainted concrete values[0m
[K	[1;34m	collecting memory allocations/de-allocations[0m
[K	[1;34m	collecting pointer mapping[0m
[K	[1;34m	extracting crash information[0m
[K	[1;37m		[0m[K     [1;37m[info] crash type: memory read overflow[0m
[K	[1;37m		[0m[K     [1;37m[info] crash location:
                             /data/vulnloc/libtiff/CVE-2016-5321/src/tools/tiffcrop.c:995:35[0m
[K	[1;37m		[0m[K     [1;37m[info] crash function: readSeparateTilesIntoBuffer[0m
[K	[1;37m		[0m[K     [1;37m[info] crash address: 116502[0m
[K	[1;37m		[0m[K     [1;37m[info] crash free constraint: ((8 * @var(integer, s)) < 64)[0m
[K	[1;37m		[0m[K     [1;37m[info] crash inducing variables: s[0m
[K	[1;37m			[info] identified crash type: memory read overflow[0m
[K[1;36m
		Running Concolic Execution
		------------------------------------------------------------------------------------------
[0m
[K	[1;37m	[0m[K     [1;37mUsing Arguments: ['$POC', 'foo.tif'][0m
[K	[1;37m	[0m[K     [1;37mUsing Input File: /CrashRepair/experiments/vulnloc/libtiff/CVE-2016-5321/tests/1.tif[0m
[K	[1;34m	building program[0m
[K	[1;34m		setting environment variables[0m
[K	[1;34m		cleaning files[0m
[K	[1;34m		configuring program[0m
[K	[1;34m		compiling program[0m
[K	[1;34m	extracting bytecode[0m
[K	[1;34m	generating ktest file[0m
[K	[1;34m	executing klee in concolic mode[0m
[K	[1;34m	extracting largest symbolic path[0m
[K	[1;34m	extracting instruction trace[0m
[K	[1;37m		[note] program crashed[0m
[K	[1;34m	collecting tainted expressions[0m
[K	[1;34m	collecting memory allocations/de-allocations[0m
[K	[1;34m	collecting pointer mapping[0m
[K	[1;37m		[0m[K     [1;37m[info] Symbolic Mapping: s -> [][0m
[K[1;36m

	Fix Localization
====================================================================================================
[0m
[K[1;36m
	Generating Fix Locations
	__________________________________________________________________________________________
[0m
[K	[1;34m	generating taint map[0m
[K	[1;37m		[0m[K     [1;37m[info] found 10854 tainted locations[0m
[K	[1;34m		starting parallel computing[0m
[K	[1;34m		waiting for thread completion[0m
[K	[1;37m		[0m[K     [1;37m[info] found 5 source files[0m
[K	[1;37m		[0m[K     [1;37m[info] found 12 executed functions[0m
[K	[1;34m	generating possible fix locations[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] readSeparateTilesIntoBuffer,
                             /data/vulnloc/libtiff/CVE-2016-5321/src/tools/tiffcrop.c:993:29[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] readSeparateTilesIntoBuffer,
                             /data/vulnloc/libtiff/CVE-2016-5321/src/tools/tiffcrop.c:996:20[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] readSeparateTilesIntoBuffer,
                             /data/vulnloc/libtiff/CVE-2016-5321/src/tools/tiffcrop.c:996:13[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] readSeparateTilesIntoBuffer,
                             /data/vulnloc/libtiff/CVE-2016-5321/src/tools/tiffcrop.c:995:16[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] readSeparateTilesIntoBuffer,
                             /data/vulnloc/libtiff/CVE-2016-5321/src/tools/tiffcrop.c:995:18[0m
[K[1;36m
	Localizing Constraints
	__________________________________________________________________________________________
[0m
[K[1;36m
		[fix-loc] /data/vulnloc/libtiff/CVE-2016-5321/src/tools/tiffcrop.c:993:7
		------------------------------------------------------------------------------------------
[0m
[K	[1;37m	[0m[K     [1;37m[constraint] ((8 * @var(integer, s)) < 64)[0m
[K[1;36m
		[fix-loc] /data/vulnloc/libtiff/CVE-2016-5321/src/tools/tiffcrop.c:995:18
		------------------------------------------------------------------------------------------
[0m
[K	[1;37m	[0m[K     [1;37m[constraint] ((8 * @var(integer, s)) < 64)[0m
[K[1;36m
		[fix-loc] /data/vulnloc/libtiff/CVE-2016-5321/src/tools/tiffcrop.c:996:9
		------------------------------------------------------------------------------------------
[0m
[K	[1;37m	[0m[K     [1;37m[constraint] ((8 * @var(integer, s)) < 64)[0m
[K[1;36m
		[fix-loc] /data/vulnloc/libtiff/CVE-2016-5321/src/tools/tiffcrop.c:995:9
		------------------------------------------------------------------------------------------
[0m
[K	[1;37m	[0m[K     [1;37m[constraint] ((8 * @var(integer, s)) < 64)[0m
[K[1;32m
	localization information saved at /CrashRepair/output/libtiff_CVE-2016-5321/localization.json[0m
[K[1;32m
	state values saved at /CrashRepair/output/libtiff_CVE-2016-5321/values/[0m
[K	[1;37m
Run time statistics:
-----------------------
[0m
[K	[1;37mStartup: 0.000 minutes[0m
[K	[1;37mBuild: 0 minutes[0m
[K	[1;37mConcrete Analysis: 0.675 minutes[0m
[K	[1;37mConcolic Analysis: 0.584 minutes[0m
[K	[1;37mTotal Analysis: 1.294 minutes[0m
[K	[1;37mLocalization: 0.298 minutes[0m
[K[1;32m
CRepair finished successfully after 1.634 minutes 
[0m
2025-02-03 22:17:36.805 | WARNING  | analyzer:run:143 - analysis output directory does not exist [/data/vulnloc/libtiff/CVE-2016-5321/analysis]: creating...
2025-02-03 22:17:36.927 | INFO     | scenario:analyze_for_guide:558 - reanalyzing candidate patch: #11:
@@ -948,152 +948,161 @@
   return status;
   }
 
-static int  readSeparateTilesIntoBuffer (TIFF* in, uint8 *obuf, 
-					 uint32 imagelength, uint32 imagewidth, 
-                                         uint32 tw, uint32 tl,
-                                         uint16 spp, uint16 bps)
-  {
-  int     i, status = 1, sample;
-  int     shift_width, bytes_per_pixel;
-  uint16  bytes_per_sample;
-  uint32  row, col;     /* Current row and col of image */
-  uint32  nrow, ncol;   /* Number of rows and cols in current tile */
-  uint32  row_offset, col_offset; /* Output buffer offsets */
-  tsize_t tbytes = 0, tilesize = TIFFTileSize(in);
-  tsample_t s;
-  uint8*  bufp = (uint8*)obuf;
-  unsigned char *srcbuffs[MAX_SAMPLES];
-  unsigned char *tbuff = NULL;
 
-  bytes_per_sample = (bps + 7) / 8;
+static int readSeparateTilesIntoBuffer(TIFF* in, uint8 *obuf, 
+                                        uint32 imagelength, uint32 imagewidth, 
+                                        uint32 tw, uint32 tl,
+                                        uint16 spp, uint16 bps)
+{
+    int i, status = 1, sample;
+    int shift_width, bytes_per_pixel;
+    uint16 bytes_per_sample;
+    uint32 row, col;     /* Current row and col of image */
+    uint32 nrow, ncol;   /* Number of rows and cols in current tile */
+    uint32 row_offset, col_offset; /* Output buffer offsets */
+    tsize_t tbytes = 0, tilesize = TIFFTileSize(in);
+    tsample_t s;
+    uint8* bufp = (uint8*)obuf;
+    unsigned char *srcbuffs[MAX_SAMPLES];
+    unsigned char *tbuff = NULL;
+
+    bytes_per_sample = (bps + 7) / 8;
 
-  for (sample = 0; (sample < spp) && (sample < MAX_SAMPLES); sample++)
+    for (sample = 0; (sample < spp) && (sample < MAX_SAMPLES); sample++)
     {
-    srcbuffs[sample] = NULL;
-    tbuff = (unsigned char *)_TIFFmalloc(tilesize + 8);
-    if (!tbuff)
-      {
-      TIFFError ("readSeparateTilesIntoBuffer", 
-                 "Unable to allocate tile read buffer for sample %d", sample);
-      for (i = 0; i < sample; i++)
-        _TIFFfree (srcbuffs[i]);
-      return 0;
-      }
-    srcbuffs[sample] = tbuff;
+        srcbuffs[sample] = NULL;
+        tbuff = (unsigned char *)_TIFFmalloc(tilesize + 8);
+        if (!tbuff)
+        {
+            TIFFError ("readSeparateTilesIntoBuffer", 
+                        "Unable to allocate tile read buffer for sample %d", sample);
+            for (i = 0; i < sample; i++)
+                _TIFFfree(srcbuffs[i]);
+            return 0;
+        }
+        srcbuffs[sample] = tbuff;
     } 
-  /* Each tile contains only the data for a single plane
-   * arranged in scanlines of tw * bytes_per_sample bytes.
-   */
-  for (row = 0; row < imagelength; row += tl)
+    /* Each tile contains only the data for a single plane
+       arranged in scanlines of tw * bytes_per_sample bytes.
+    */
+    for (row = 0; row < imagelength; row += tl)
     {
-    nrow = (row + tl > imagelength) ? imagelength - row : tl;
-    for (col = 0; col < imagewidth; col += tw)
-      {
-      for (s = 0; s < spp; s++)
-        {  /* Read each plane of a tile set into srcbuffs[s] */
-	tbytes = TIFFReadTile(in, srcbuffs[s], col, row, 0, s);
-        if (tbytes < 0  && !ignore)
-          {
-	  TIFFError(TIFFFileName(in),
-                 "Error, can't read tile for row %lu col %lu, "
-		 "sample %lu",
-		 (unsigned long) col, (unsigned long) row,
-		 (unsigned long) s);
-		 status = 0;
-          for (sample = 0; (sample < spp) && (sample < MAX_SAMPLES); sample++)
-            {
-            tbuff = srcbuffs[sample];
-            if (tbuff != NULL)
-              _TIFFfree(tbuff);
+        nrow = (row + tl > imagelength) ? imagelength - row : tl;
+        for (col = 0; col < imagewidth; col += tw)
+        {
+            for (s = 0; s < spp; s++)
+            {  /* Read each plane of a tile set into srcbuffs[s] */
+                tbytes = TIFFReadTile(in, srcbuffs[s], col, row, 0, s);
+                if (tbytes < 0)
+                {
+                    if (!ignore)
+                    {
+                        TIFFError(TIFFFileName(in),
+                                  "Error, can't read tile for row %lu col %lu, "
+                                  "sample %lu",
+                                  (unsigned long) col, (unsigned long) row,
+                                  (unsigned long) s);
+                        status = 0;
+                    }
+                    else
+                    {
+                        // Handle the scenario where reading a tile is ignored
+                        // An update to handle `ignore` variable appropriately
+                        continue; // Skip further processing for this tile/sample
+                    }
+                }
             }
-          return status;
-	  }
-	}
-     /* Tiles on the right edge may be padded out to tw 
-      * which must be a multiple of 16.
-      * Ncol represents the visible (non padding) portion.  
-      */
-      if (col + tw > imagewidth)
-        ncol = imagewidth - col;
-      else
-        ncol = tw;
-
-      row_offset = row * (((imagewidth * spp * bps) + 7) / 8);
-      col_offset = ((col * spp * bps) + 7) / 8;
-      bufp = obuf + row_offset + col_offset;
+            /* Tiles on the right edge may be padded out to tw 
+               which must be a multiple of 16.
+               Ncol represents the visible (non padding) portion.  
+            */
+            if (col + tw > imagewidth)
+                ncol = imagewidth - col;
+            else
+                ncol = tw;
+
+            row_offset = row * (((imagewidth * spp * bps) + 7) / 8);
+            col_offset = ((col * spp * bps) + 7) / 8;
+            bufp = obuf + row_offset + col_offset;
 
-      if ((bps % 8) == 0)
-        {
-        if (combineSeparateTileSamplesBytes(srcbuffs, bufp, ncol, nrow, imagewidth,
-					    tw, spp, bps, NULL, 0, 0))
-	  {
-          status = 0;
-          break;
-      	  }
-	}
-      else
-        {
-        bytes_per_pixel  = ((bps * spp) + 7) / 8;
-        if (bytes_per_pixel < (bytes_per_sample + 1))
-          shift_width = bytes_per_pixel;
-        else
-          shift_width = bytes_per_sample + 1;
-
-        switch (shift_width)
-          {
-          case 1: if (combineSeparateTileSamples8bits (srcbuffs, bufp, ncol, nrow,
-                                                       imagewidth, tw, spp, bps, 
-						       NULL, 0, 0))
-	            {
-                    status = 0;
-                    break;
-      	            }
-	          break;
-          case 2: if (combineSeparateTileSamples16bits (srcbuffs, bufp, ncol, nrow,
-                                                       imagewidth, tw, spp, bps, 
-						       NULL, 0, 0))
-	            {
-                    status = 0;
-                    break;
-		    }
-	          break;
-          case 3: if (combineSeparateTileSamples24bits (srcbuffs, bufp, ncol, nrow,
-                                                       imagewidth, tw, spp, bps, 
-						       NULL, 0, 0))
-	            {
-                    status = 0;
-                    break;
-       	            }
-                  break;
-          case 4: 
-          case 5:
-          case 6:
-          case 7:
-          case 8: if (combineSeparateTileSamples32bits (srcbuffs, bufp, ncol, nrow,
-                                                       imagewidth, tw, spp, bps, 
-						       NULL, 0, 0))
-	            {
+            if ((bps % 8) == 0)
+            {
+                if (combineSeparateTileSamplesBytes(srcbuffs, bufp, ncol, nrow, imagewidth,
+                                                    tw, spp, bps, NULL, 0, 0))
+                {
                     status = 0;
                     break;
-		    }
-	          break;
-          default: TIFFError ("readSeparateTilesIntoBuffer", "Unsupported bit depth: %d", bps);
-                  status = 0;
-                  break;
-          }
+                }
+            }
+            else
+            {
+                bytes_per_pixel  = ((bps * spp) + 7) / 8;
+                if (bytes_per_pixel < (bytes_per_sample + 1))
+                    shift_width = bytes_per_pixel;
+                else
+                    shift_width = bytes_per_sample + 1;
+
+                switch (shift_width)
+                {
+                    case 1: 
+                        if (combineSeparateTileSamples8bits(srcbuffs, bufp, ncol, nrow,
+                                                            imagewidth, tw, spp, bps, 
+                                                            NULL, 0, 0))
+                        {
+                            status = 0;
+                            break;
+                        }
+                        break;
+                    case 2: 
+                        if (combineSeparateTileSamples16bits(srcbuffs, bufp, ncol, nrow,
+                                                            imagewidth, tw, spp, bps, 
+                                                            NULL, 0, 0))
+                        {
+                            status = 0;
+                            break;
+                        }
+                        break;
+                    case 3: 
+                        if (combineSeparateTileSamples24bits(srcbuffs, bufp, ncol, nrow,
+                                                            imagewidth, tw, spp, bps, 
+                                                            NULL, 0, 0))
+                        {
+                            status = 0;
+                            break;
+                        }
+                        break;
+                    case 4: 
+                    case 5:
+                    case 6:
+                    case 7:
+                    case 8: 
+                        if (combineSeparateTileSamples32bits(srcbuffs, bufp, ncol, nrow,
+                                                            imagewidth, tw, spp, bps, 
+                                                            NULL, 0, 0))
+                        {
+                            status = 0;
+                            break;
+                        }
+                        break;
+                    default:
+                        TIFFError("readSeparateTilesIntoBuffer", "Unsupported bit depth: %d", bps);
+                        status = 0;
+                        break;
+                }
+            }
         }
-      }
     }
 
-  for (sample = 0; (sample < spp) && (sample < MAX_SAMPLES); sample++)
+    for (sample = 0; (sample < spp) && (sample < MAX_SAMPLES); sample++)
     {
-    tbuff = srcbuffs[sample];
-    if (tbuff != NULL)
-      _TIFFfree(tbuff);
+        tbuff = srcbuffs[sample];
+        if (tbuff != NULL)
+            _TIFFfree(tbuff);
     }
- 
-  return status;
-  }
+
+    return status;
+}
+
 
 static int writeBufferToContigStrips(TIFF* out, uint8* buf, uint32 imagelength)
   {

2025-02-03 22:17:36.936 | DEBUG    | scenario:rebuild:369 - original environment: environ({'CONDA_SHLVL': '2', 'LC_ALL': 'C.UTF-8', 'LS_COLORS': 'rs=0:di=01;34:ln=01;36:mh=00:pi=40;33:so=01;35:do=01;35:bd=40;33;01:cd=40;33;01:or=40;31;01:mi=00:su=37;41:sg=30;43:ca=30;41:tw=30;42:ow=34;42:st=37;44:ex=01;32:*.tar=01;31:*.tgz=01;31:*.arc=01;31:*.arj=01;31:*.taz=01;31:*.lha=01;31:*.lz4=01;31:*.lzh=01;31:*.lzma=01;31:*.tlz=01;31:*.txz=01;31:*.tzo=01;31:*.t7z=01;31:*.zip=01;31:*.z=01;31:*.Z=01;31:*.dz=01;31:*.gz=01;31:*.lrz=01;31:*.lz=01;31:*.lzo=01;31:*.xz=01;31:*.zst=01;31:*.tzst=01;31:*.bz2=01;31:*.bz=01;31:*.tbz=01;31:*.tbz2=01;31:*.tz=01;31:*.deb=01;31:*.rpm=01;31:*.jar=01;31:*.war=01;31:*.ear=01;31:*.sar=01;31:*.rar=01;31:*.alz=01;31:*.ace=01;31:*.zoo=01;31:*.cpio=01;31:*.7z=01;31:*.rz=01;31:*.cab=01;31:*.wim=01;31:*.swm=01;31:*.dwm=01;31:*.esd=01;31:*.jpg=01;35:*.jpeg=01;35:*.mjpg=01;35:*.mjpeg=01;35:*.gif=01;35:*.bmp=01;35:*.pbm=01;35:*.pgm=01;35:*.ppm=01;35:*.tga=01;35:*.xbm=01;35:*.xpm=01;35:*.tif=01;35:*.tiff=01;35:*.png=01;35:*.svg=01;35:*.svgz=01;35:*.mng=01;35:*.pcx=01;35:*.mov=01;35:*.mpg=01;35:*.mpeg=01;35:*.m2v=01;35:*.mkv=01;35:*.webm=01;35:*.ogm=01;35:*.mp4=01;35:*.m4v=01;35:*.mp4v=01;35:*.vob=01;35:*.qt=01;35:*.nuv=01;35:*.wmv=01;35:*.asf=01;35:*.rm=01;35:*.rmvb=01;35:*.flc=01;35:*.avi=01;35:*.fli=01;35:*.flv=01;35:*.gl=01;35:*.dl=01;35:*.xcf=01;35:*.xwd=01;35:*.yuv=01;35:*.cgm=01;35:*.emf=01;35:*.ogv=01;35:*.ogx=01;35:*.aac=00;36:*.au=00;36:*.flac=00;36:*.m4a=00;36:*.mid=00;36:*.midi=00;36:*.mka=00;36:*.mp3=00;36:*.mpc=00;36:*.ogg=00;36:*.ra=00;36:*.wav=00;36:*.oga=00;36:*.opus=00;36:*.spx=00;36:*.xspf=00;36:', 'LD_LIBRARY_PATH': '/opt/crashrepair/lib:/CrashRepair/lib:/klee/build/lib:', 'CONDA_EXE': '/root/anaconda3/bin/conda', 'LANG': 'C.UTF-8', 'TZ': 'Asia/Shanghai', 'HOSTNAME': 'fea22102047d', 'OLDPWD': '/orchestrator', 'CONDA_PREFIX': '/root/anaconda3/envs/CrashRepair', '_CE_M': '', 'CC': 'crepair-cc', 'LLVM_COMPILER': 'clang', 'CONDA_PREFIX_1': '/root/anaconda3', 'PWD': '/orchestrator/crashrepair', 'HOME': '/root', 'CONDA_PYTHON_EXE': '/root/anaconda3/bin/python', '_CE_CONDA': '', 'CONDA_PROMPT_MODIFIER': '(CrashRepair) ', 'CXX': 'crepair-cxx', 'TERM': 'xterm', 'SHLVL': '2', 'PYTHONPATH': '/usr/lib/python3.8/site-packages:', 'PATH': '/root/anaconda3/envs/CrashRepair/bin:/root/anaconda3/condabin:~/anaconda3/bin:/opt/crashrepair/bin:/CrashRepair/compiler:/klee/build/bin:/opt/llvm-6/bin:/klee/build/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', 'CONDA_DEFAULT_ENV': 'CrashRepair', '_': '/root/anaconda3/envs/CrashRepair/bin/python'})
2025-02-03 22:17:36.936 | DEBUG    | scenario:rebuild:382 - injecting ghost function into CFLAGS during build: -lcrepair_ghost
2025-02-03 22:17:36.936 | DEBUG    | scenario:rebuild:398 - using environment: {'INJECT_CFLAGS': '-g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address', 'INJECT_CXXFLAGS': '-g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address', 'INJECT_LDFLAGS': '-g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address'}
2025-02-03 22:17:36.936 | DEBUG    | shell:__call__:41 - executing: make CFLAGS="${INJECT_CFLAGS}" CXXFLAGS="${INJECT_CXXFLAGS}" LDFLAGS="${INJECT_LDFLAGS}"
Making all in port
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/port'
make[1]: Nothing to be done for 'all'.
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/port'
Making all in libtiff
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/libtiff'
make  all-am
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/libtiff'
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/libtiff'
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/libtiff'
Making all in tools
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/tools'
crepair-cc -DHAVE_CONFIG_H -I. -I../libtiff  -I../libtiff   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -MT tiffcrop.o -MD -MP -MF .deps/tiffcrop.Tpo -c -o tiffcrop.o tiffcrop.c
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_ghost: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
mv -f .deps/tiffcrop.Tpo .deps/tiffcrop.Po
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address  -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -o tiffcrop tiffcrop.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -g -O0 -Wno-error -I/CrashRepair/lib -fsanitize=address -g -O0 -Wno-error -I/CrashRepair/lib -fsanitize=address -o tiffcrop tiffcrop.o  -L/klee/build/lib -L/CrashRepair/lib -lkleeRuntest -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost ../libtiff/.libs/libtiff.a ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/tools'
Making all in build
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/build'
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/build'
make[2]: Nothing to be done for 'all-am'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/build'
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/build'
Making all in contrib
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib'
Making all in addtiffo
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/addtiffo'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/addtiffo'
Making all in dbs
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/dbs'
Making all in xtiff
make[3]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/dbs/xtiff'
make[3]: Nothing to be done for 'all'.
make[3]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/dbs/xtiff'
make[3]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/dbs'
make[3]: Nothing to be done for 'all-am'.
make[3]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/dbs'
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/dbs'
Making all in iptcutil
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/iptcutil'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/iptcutil'
Making all in mfs
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/mfs'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/mfs'
Making all in pds
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/pds'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/pds'
Making all in ras
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/ras'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/ras'
Making all in stream
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/stream'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/stream'
Making all in tags
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/tags'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/tags'
Making all in win_dib
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/win_dib'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/win_dib'
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib'
make[2]: Nothing to be done for 'all-am'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib'
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib'
Making all in test
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/test'
make[1]: Nothing to be done for 'all'.
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/test'
Making all in man
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/man'
make[1]: Nothing to be done for 'all'.
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/man'
Making all in html
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html'
Making all in images
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html/images'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html/images'
Making all in man
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html/man'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html/man'
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html'
make[2]: Nothing to be done for 'all-am'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html'
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html'
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src'
make[1]: Nothing to be done for 'all-am'.
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src'
2025-02-03 22:17:37.397 | INFO     | analyzer:run:114 - running analysis with timeout: 60 minutes
2025-02-03 22:17:37.397 | DEBUG    | analyzer:write_config_to_file:88 - generated analyzer config:

dir_exp:/data/vulnloc/libtiff/CVE-2016-5321
tag_id:libtiff_CVE-2016-5321
src_directory:/data/vulnloc/libtiff/CVE-2016-5321/src
binary_path:/data/vulnloc/libtiff/CVE-2016-5321/src/tools/tiffcrop
config_command:./configure --enable-static --disable-shared
build_command:make CFLAGS="${INJECT_CFLAGS}" CXXFLAGS="${INJECT_CXXFLAGS}" LDFLAGS="${INJECT_LDFLAGS}"
test_input_list:$POC foo.tif
poc_list:/CrashRepair/experiments/vulnloc/libtiff/CVE-2016-5321/tests/1.tif
klee_flags:--link-llvm-lib=/CrashRepair/lib/libcrepair_proxy.bca 

2025-02-03 22:17:37.397 | DEBUG    | analyzer:run:124 - wrote analyzer config file to: /tmp/tmpiirwephp
2025-02-03 22:17:37.397 | DEBUG    | shell:__call__:41 - executing: crepair --conf=/tmp/tmpiirwephp
[K[1;36m
====================================================================================================

	Starting CRepair (C Crash Repair) 
====================================================================================================
[0m
[K[1;36m
	Loading Configurations
	__________________________________________________________________________________________
[0m
[K	[1;34mreading configuration values from arguments[0m
[K	[1;34mreading configuration values form configuration file[0m
[K	[1;37m	[file] /tmp/tmpiirwephp[0m
[K	[1;34mupdating configuration values[0m
[K	[1;34mreading test configuration[0m
[K	[1;34mreading seed information[0m
[K	[1;37m	[config] stack size: 15000[0m
[K	[1;37m	[config] collecting stats: False[0m
[K	[1;37m	[config] number of tests: 1[0m
[K	[1;37m	[config] number of cores: 8[0m
[K	[1;37m	[config] klee concrete execution timeout: 600[0m
[K	[1;37m	[config] klee concolic execution timeout: 1200[0m
[K	[1;37m	[config] synthesize subset expressions: True[0m
[K	[1;37m	[config] window size for taint locations: 500[0m
[K	[1;37m	[config] window size for taint values: 500000[0m
[K[1;36m

	Analyzing Program
====================================================================================================
[0m
[K[1;36m
	Test Case #1
	__________________________________________________________________________________________
[0m
[K[1;36m
		Running Concrete Execution
		------------------------------------------------------------------------------------------
[0m
[K	[1;37m	[0m[K     [1;37mUsing Arguments: ['$POC', 'foo.tif'][0m
[K	[1;37m	[0m[K     [1;37mUsing Input File: /CrashRepair/experiments/vulnloc/libtiff/CVE-2016-5321/tests/1.tif[0m
[K	[1;34m	building program[0m
[K	[1;34m		setting environment variables[0m
[K	[1;34m		cleaning files[0m
[K	[1;34m		configuring program[0m
[K	[1;34m		compiling program[0m
[K	[1;37m	[0m[K     [1;37mUsing Binary: /data/vulnloc/libtiff/CVE-2016-5321/src/tools/tiffcrop[0m
[K	[1;34m	extracting bytecode[0m
[K	[1;34m	executing klee in concrete mode[0m
[K	[1;34m	extracting instruction trace[0m
[K	[1;37m		[note] program crashed[0m
[K	[1;34m	collecting tainted expressions[0m
[K	[1;34m	collecting tainted concrete values[0m
[K	[1;34m	collecting memory allocations/de-allocations[0m
[K	[1;34m	collecting pointer mapping[0m
[K	[1;34m	extracting crash information[0m
[K	[1;37m		[0m[K     [1;37m[info] crash type: memory read overflow[0m
[K	[1;37m		[0m[K     [1;37m[info] crash location:
                             /data/vulnloc/libtiff/CVE-2016-5321/src/tools/tiffcrop.c:995:43[0m
[K	[1;37m		[0m[K     [1;37m[info] crash function: readSeparateTilesIntoBuffer[0m
[K	[1;37m		[0m[K     [1;37m[info] crash address: 116502[0m
[K	[1;37m		[0m[K     [1;37m[info] crash free constraint: ((8 * @var(integer, s)) < 64)[0m
[K	[1;37m		[0m[K     [1;37m[info] crash inducing variables: s[0m
[K	[1;37m			[info] identified crash type: memory read overflow[0m
[K[1;36m
		Running Concolic Execution
		------------------------------------------------------------------------------------------
[0m
[K	[1;37m	[0m[K     [1;37mUsing Arguments: ['$POC', 'foo.tif'][0m
[K	[1;37m	[0m[K     [1;37mUsing Input File: /CrashRepair/experiments/vulnloc/libtiff/CVE-2016-5321/tests/1.tif[0m
[K	[1;34m	building program[0m
[K	[1;34m		setting environment variables[0m
[K	[1;34m		cleaning files[0m
[K	[1;34m		configuring program[0m
[K	[1;34m		compiling program[0m
[K	[1;34m	extracting bytecode[0m
[K	[1;34m	generating ktest file[0m
[K	[1;34m	executing klee in concolic mode[0m
[K	[1;34m	extracting largest symbolic path[0m
[K	[1;34m	extracting instruction trace[0m
[K	[1;37m		[note] program crashed[0m
[K	[1;34m	collecting tainted expressions[0m
[K	[1;34m	collecting memory allocations/de-allocations[0m
[K	[1;34m	collecting pointer mapping[0m
[K	[1;37m		[0m[K     [1;37m[info] Symbolic Mapping: s -> [][0m
[K[1;36m

	Fix Localization
====================================================================================================
[0m
[K[1;36m
	Generating Fix Locations
	__________________________________________________________________________________________
[0m
[K	[1;34m	generating taint map[0m
[K	[1;37m		[0m[K     [1;37m[info] found 10854 tainted locations[0m
[K	[1;34m		starting parallel computing[0m
[K	[1;34m		waiting for thread completion[0m
[K	[1;37m		[0m[K     [1;37m[info] found 5 source files[0m
[K	[1;37m		[0m[K     [1;37m[info] found 12 executed functions[0m
[K	[1;34m	generating possible fix locations[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] readSeparateTilesIntoBuffer,
                             /data/vulnloc/libtiff/CVE-2016-5321/src/tools/tiffcrop.c:993:35[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] readSeparateTilesIntoBuffer,
                             /data/vulnloc/libtiff/CVE-2016-5321/src/tools/tiffcrop.c:996:28[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] readSeparateTilesIntoBuffer,
                             /data/vulnloc/libtiff/CVE-2016-5321/src/tools/tiffcrop.c:996:21[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] readSeparateTilesIntoBuffer,
                             /data/vulnloc/libtiff/CVE-2016-5321/src/tools/tiffcrop.c:995:24[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] readSeparateTilesIntoBuffer,
                             /data/vulnloc/libtiff/CVE-2016-5321/src/tools/tiffcrop.c:995:26[0m
[K[1;36m
	Localizing Constraints
	__________________________________________________________________________________________
[0m
[K[1;36m
		[fix-loc] /data/vulnloc/libtiff/CVE-2016-5321/src/tools/tiffcrop.c:993:13
		------------------------------------------------------------------------------------------
[0m
[K	[1;37m	[0m[K     [1;37m[constraint] ((8 * @var(integer, s)) < 64)[0m
[K[1;36m
		[fix-loc] /data/vulnloc/libtiff/CVE-2016-5321/src/tools/tiffcrop.c:995:26
		------------------------------------------------------------------------------------------
[0m
[K	[1;37m	[0m[K     [1;37m[constraint] ((8 * @var(integer, s)) < 64)[0m
[K[1;36m
		[fix-loc] /data/vulnloc/libtiff/CVE-2016-5321/src/tools/tiffcrop.c:996:17
		------------------------------------------------------------------------------------------
[0m
[K	[1;37m	[0m[K     [1;37m[constraint] ((8 * @var(integer, s)) < 64)[0m
[K[1;36m
		[fix-loc] /data/vulnloc/libtiff/CVE-2016-5321/src/tools/tiffcrop.c:995:17
		------------------------------------------------------------------------------------------
[0m
[K	[1;37m	[0m[K     [1;37m[constraint] ((8 * @var(integer, s)) < 64)[0m
[K[1;32m
	localization information saved at /CrashRepair/output/libtiff_CVE-2016-5321/localization.json[0m
[K[1;32m
	state values saved at /CrashRepair/output/libtiff_CVE-2016-5321/values/[0m
[K	[1;37m
Run time statistics:
-----------------------
[0m
[K	[1;37mStartup: 0.000 minutes[0m
[K	[1;37mBuild: 0 minutes[0m
[K	[1;37mConcrete Analysis: 0.678 minutes[0m
[K	[1;37mConcolic Analysis: 0.596 minutes[0m
[K	[1;37mTotal Analysis: 1.310 minutes[0m
[K	[1;37mLocalization: 0.299 minutes[0m
[K[1;32m
CRepair finished successfully after 1.651 minutes 
[0m
2025-02-03 22:19:17.404 | WARNING  | analyzer:run:143 - analysis output directory does not exist [/data/vulnloc/libtiff/CVE-2016-5321/analysis]: creating...
2025-02-03 22:19:17.517 | INFO     | scenario:analyze_for_guide:558 - reanalyzing candidate patch: #12:
@@ -948,152 +948,150 @@
   return status;
   }
 
-static int  readSeparateTilesIntoBuffer (TIFF* in, uint8 *obuf, 
-					 uint32 imagelength, uint32 imagewidth, 
-                                         uint32 tw, uint32 tl,
-                                         uint16 spp, uint16 bps)
-  {
-  int     i, status = 1, sample;
-  int     shift_width, bytes_per_pixel;
-  uint16  bytes_per_sample;
-  uint32  row, col;     /* Current row and col of image */
-  uint32  nrow, ncol;   /* Number of rows and cols in current tile */
-  uint32  row_offset, col_offset; /* Output buffer offsets */
-  tsize_t tbytes = 0, tilesize = TIFFTileSize(in);
-  tsample_t s;
-  uint8*  bufp = (uint8*)obuf;
-  unsigned char *srcbuffs[MAX_SAMPLES];
-  unsigned char *tbuff = NULL;
 
-  bytes_per_sample = (bps + 7) / 8;
+static int readSeparateTilesIntoBuffer(TIFF* in, uint8 *obuf,
+                                       uint32 imagelength, uint32 imagewidth,
+                                       uint32 tw, uint32 tl,
+                                       uint16 spp, uint16 bps)
+{
+    int i, status = 1, sample;
+    int shift_width, bytes_per_pixel;
+    uint16 bytes_per_sample;
+    uint32 row, col; /* Current row and col of image */
+    uint32 nrow, ncol; /* Number of rows and cols in current tile */
+    uint32 row_offset, col_offset; /* Output buffer offsets */
+    tsize_t tbytes = 0, tilesize = TIFFTileSize(in);
+    tsample_t s;
+    uint8* bufp = (uint8*)obuf;
+    unsigned char *srcbuffs[MAX_SAMPLES];
+    unsigned char *tbuff = NULL;
+
+    bytes_per_sample = (bps + 7) / 8;
 
-  for (sample = 0; (sample < spp) && (sample < MAX_SAMPLES); sample++)
+    for (sample = 0; (sample < spp) && (sample < MAX_SAMPLES); sample++)
     {
-    srcbuffs[sample] = NULL;
-    tbuff = (unsigned char *)_TIFFmalloc(tilesize + 8);
-    if (!tbuff)
-      {
-      TIFFError ("readSeparateTilesIntoBuffer", 
-                 "Unable to allocate tile read buffer for sample %d", sample);
-      for (i = 0; i < sample; i++)
-        _TIFFfree (srcbuffs[i]);
-      return 0;
-      }
-    srcbuffs[sample] = tbuff;
+        srcbuffs[sample] = NULL;
+        tbuff = (unsigned char *)_TIFFmalloc(tilesize + 8);
+        if (!tbuff)
+        {
+            TIFFError("readSeparateTilesIntoBuffer",
+                       "Unable to allocate tile read buffer for sample %d", sample);
+            for (i = 0; i < sample; i++)
+                _TIFFfree(srcbuffs[i]);
+            return 0;
+        }
+        srcbuffs[sample] = tbuff;
     } 
-  /* Each tile contains only the data for a single plane
-   * arranged in scanlines of tw * bytes_per_sample bytes.
-   */
-  for (row = 0; row < imagelength; row += tl)
+    for (row = 0; row < imagelength; row += tl)
     {
-    nrow = (row + tl > imagelength) ? imagelength - row : tl;
-    for (col = 0; col < imagewidth; col += tw)
-      {
-      for (s = 0; s < spp; s++)
-        {  /* Read each plane of a tile set into srcbuffs[s] */
-	tbytes = TIFFReadTile(in, srcbuffs[s], col, row, 0, s);
-        if (tbytes < 0  && !ignore)
-          {
-	  TIFFError(TIFFFileName(in),
-                 "Error, can't read tile for row %lu col %lu, "
-		 "sample %lu",
-		 (unsigned long) col, (unsigned long) row,
-		 (unsigned long) s);
-		 status = 0;
-          for (sample = 0; (sample < spp) && (sample < MAX_SAMPLES); sample++)
+        nrow = (row + tl > imagelength) ? imagelength - row : tl;
+        for (col = 0; col < imagewidth; col += tw)
+        {
+            for (s = 0; s < spp; s++)
             {
-            tbuff = srcbuffs[sample];
-            if (tbuff != NULL)
-              _TIFFfree(tbuff);
+                tbytes = TIFFReadTile(in, srcbuffs[s], col, row, 0, s);
+                if (tbytes < 0)
+                {
+                    TIFFError(TIFFFileName(in),
+                               "Error, can't read tile for row %lu col %lu, "
+                               "sample %lu",
+                               (unsigned long)col, (unsigned long)row,
+                               (unsigned long)s);
+                    status = 0;
+                    break; // Exit the current sample loop
+                }
             }
-          return status;
-	  }
-	}
-     /* Tiles on the right edge may be padded out to tw 
-      * which must be a multiple of 16.
-      * Ncol represents the visible (non padding) portion.  
-      */
-      if (col + tw > imagewidth)
-        ncol = imagewidth - col;
-      else
-        ncol = tw;
-
-      row_offset = row * (((imagewidth * spp * bps) + 7) / 8);
-      col_offset = ((col * spp * bps) + 7) / 8;
-      bufp = obuf + row_offset + col_offset;
+            if (status == 0) break; // Exit the current col loop if error occurred
+            
+            if (col + tw > imagewidth)
+                ncol = imagewidth - col;
+            else
+                ncol = tw;
+
+            row_offset = row * (((imagewidth * spp * bps) + 7) / 8);
+            col_offset = ((col * spp * bps) + 7) / 8;
+            bufp = obuf + row_offset + col_offset;
 
-      if ((bps % 8) == 0)
-        {
-        if (combineSeparateTileSamplesBytes(srcbuffs, bufp, ncol, nrow, imagewidth,
-					    tw, spp, bps, NULL, 0, 0))
-	  {
-          status = 0;
-          break;
-      	  }
-	}
-      else
-        {
-        bytes_per_pixel  = ((bps * spp) + 7) / 8;
-        if (bytes_per_pixel < (bytes_per_sample + 1))
-          shift_width = bytes_per_pixel;
-        else
-          shift_width = bytes_per_sample + 1;
-
-        switch (shift_width)
-          {
-          case 1: if (combineSeparateTileSamples8bits (srcbuffs, bufp, ncol, nrow,
-                                                       imagewidth, tw, spp, bps, 
-						       NULL, 0, 0))
-	            {
-                    status = 0;
-                    break;
-      	            }
-	          break;
-          case 2: if (combineSeparateTileSamples16bits (srcbuffs, bufp, ncol, nrow,
-                                                       imagewidth, tw, spp, bps, 
-						       NULL, 0, 0))
-	            {
-                    status = 0;
-                    break;
-		    }
-	          break;
-          case 3: if (combineSeparateTileSamples24bits (srcbuffs, bufp, ncol, nrow,
-                                                       imagewidth, tw, spp, bps, 
-						       NULL, 0, 0))
-	            {
-                    status = 0;
-                    break;
-       	            }
-                  break;
-          case 4: 
-          case 5:
-          case 6:
-          case 7:
-          case 8: if (combineSeparateTileSamples32bits (srcbuffs, bufp, ncol, nrow,
-                                                       imagewidth, tw, spp, bps, 
-						       NULL, 0, 0))
-	            {
+            if ((bps % 8) == 0)
+            {
+                if (combineSeparateTileSamplesBytes(srcbuffs, bufp, ncol, nrow, imagewidth,
+                                                     tw, spp, bps, NULL, 0, 0))
+                {
                     status = 0;
                     break;
-		    }
-	          break;
-          default: TIFFError ("readSeparateTilesIntoBuffer", "Unsupported bit depth: %d", bps);
-                  status = 0;
-                  break;
-          }
+                }
+            }
+            else
+            {
+                bytes_per_pixel  = ((bps * spp) + 7) / 8;
+                if (bytes_per_pixel < (bytes_per_sample + 1))
+                    shift_width = bytes_per_pixel;
+                else
+                    shift_width = bytes_per_sample + 1;
+
+                switch (shift_width)
+                {
+                    case 1: 
+                        if (combineSeparateTileSamples8bits(srcbuffs, bufp, ncol, nrow,
+                                                            imagewidth, tw, spp, bps, 
+                                                            NULL, 0, 0))
+                        {
+                            status = 0;
+                            break;
+                        }
+                        break;
+                    case 2: 
+                        if (combineSeparateTileSamples16bits(srcbuffs, bufp, ncol, nrow,
+                                                             imagewidth, tw, spp, bps, 
+                                                             NULL, 0, 0))
+                        {
+                            status = 0;
+                            break;
+                        }
+                        break;
+                    case 3: 
+                        if (combineSeparateTileSamples24bits(srcbuffs, bufp, ncol, nrow,
+                                                             imagewidth, tw, spp, bps, 
+                                                             NULL, 0, 0))
+                        {
+                            status = 0;
+                            break;
+                        }
+                        break;
+                    case 4: 
+                    case 5:
+                    case 6:
+                    case 7:
+                    case 8: 
+                        if (combineSeparateTileSamples32bits(srcbuffs, bufp, ncol, nrow,
+                                                             imagewidth, tw, spp, bps, 
+                                                             NULL, 0, 0))
+                        {
+                            status = 0;
+                            break;
+                        }
+                        break;
+                    default: 
+                        TIFFError("readSeparateTilesIntoBuffer", "Unsupported bit depth: %d", bps);
+                        status = 0;
+                        break;
+                }
+            }
+            if (status == 0) break; // Exit the current col loop if error occurred
         }
-      }
+        if (status == 0) break; // Exit the row loop if error occurred
     }
 
-  for (sample = 0; (sample < spp) && (sample < MAX_SAMPLES); sample++)
+    for (sample = 0; (sample < spp) && (sample < MAX_SAMPLES); sample++)
     {
-    tbuff = srcbuffs[sample];
-    if (tbuff != NULL)
-      _TIFFfree(tbuff);
+        tbuff = srcbuffs[sample];
+        if (tbuff != NULL)
+            _TIFFfree(tbuff);
     }
- 
-  return status;
-  }
+
+    return status;
+}
+
 
 static int writeBufferToContigStrips(TIFF* out, uint8* buf, uint32 imagelength)
   {

2025-02-03 22:19:17.524 | DEBUG    | scenario:rebuild:369 - original environment: environ({'CONDA_SHLVL': '2', 'LC_ALL': 'C.UTF-8', 'LS_COLORS': 'rs=0:di=01;34:ln=01;36:mh=00:pi=40;33:so=01;35:do=01;35:bd=40;33;01:cd=40;33;01:or=40;31;01:mi=00:su=37;41:sg=30;43:ca=30;41:tw=30;42:ow=34;42:st=37;44:ex=01;32:*.tar=01;31:*.tgz=01;31:*.arc=01;31:*.arj=01;31:*.taz=01;31:*.lha=01;31:*.lz4=01;31:*.lzh=01;31:*.lzma=01;31:*.tlz=01;31:*.txz=01;31:*.tzo=01;31:*.t7z=01;31:*.zip=01;31:*.z=01;31:*.Z=01;31:*.dz=01;31:*.gz=01;31:*.lrz=01;31:*.lz=01;31:*.lzo=01;31:*.xz=01;31:*.zst=01;31:*.tzst=01;31:*.bz2=01;31:*.bz=01;31:*.tbz=01;31:*.tbz2=01;31:*.tz=01;31:*.deb=01;31:*.rpm=01;31:*.jar=01;31:*.war=01;31:*.ear=01;31:*.sar=01;31:*.rar=01;31:*.alz=01;31:*.ace=01;31:*.zoo=01;31:*.cpio=01;31:*.7z=01;31:*.rz=01;31:*.cab=01;31:*.wim=01;31:*.swm=01;31:*.dwm=01;31:*.esd=01;31:*.jpg=01;35:*.jpeg=01;35:*.mjpg=01;35:*.mjpeg=01;35:*.gif=01;35:*.bmp=01;35:*.pbm=01;35:*.pgm=01;35:*.ppm=01;35:*.tga=01;35:*.xbm=01;35:*.xpm=01;35:*.tif=01;35:*.tiff=01;35:*.png=01;35:*.svg=01;35:*.svgz=01;35:*.mng=01;35:*.pcx=01;35:*.mov=01;35:*.mpg=01;35:*.mpeg=01;35:*.m2v=01;35:*.mkv=01;35:*.webm=01;35:*.ogm=01;35:*.mp4=01;35:*.m4v=01;35:*.mp4v=01;35:*.vob=01;35:*.qt=01;35:*.nuv=01;35:*.wmv=01;35:*.asf=01;35:*.rm=01;35:*.rmvb=01;35:*.flc=01;35:*.avi=01;35:*.fli=01;35:*.flv=01;35:*.gl=01;35:*.dl=01;35:*.xcf=01;35:*.xwd=01;35:*.yuv=01;35:*.cgm=01;35:*.emf=01;35:*.ogv=01;35:*.ogx=01;35:*.aac=00;36:*.au=00;36:*.flac=00;36:*.m4a=00;36:*.mid=00;36:*.midi=00;36:*.mka=00;36:*.mp3=00;36:*.mpc=00;36:*.ogg=00;36:*.ra=00;36:*.wav=00;36:*.oga=00;36:*.opus=00;36:*.spx=00;36:*.xspf=00;36:', 'LD_LIBRARY_PATH': '/opt/crashrepair/lib:/CrashRepair/lib:/klee/build/lib:', 'CONDA_EXE': '/root/anaconda3/bin/conda', 'LANG': 'C.UTF-8', 'TZ': 'Asia/Shanghai', 'HOSTNAME': 'fea22102047d', 'OLDPWD': '/orchestrator', 'CONDA_PREFIX': '/root/anaconda3/envs/CrashRepair', '_CE_M': '', 'CC': 'crepair-cc', 'LLVM_COMPILER': 'clang', 'CONDA_PREFIX_1': '/root/anaconda3', 'PWD': '/orchestrator/crashrepair', 'HOME': '/root', 'CONDA_PYTHON_EXE': '/root/anaconda3/bin/python', '_CE_CONDA': '', 'CONDA_PROMPT_MODIFIER': '(CrashRepair) ', 'CXX': 'crepair-cxx', 'TERM': 'xterm', 'SHLVL': '2', 'PYTHONPATH': '/usr/lib/python3.8/site-packages:', 'PATH': '/root/anaconda3/envs/CrashRepair/bin:/root/anaconda3/condabin:~/anaconda3/bin:/opt/crashrepair/bin:/CrashRepair/compiler:/klee/build/bin:/opt/llvm-6/bin:/klee/build/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', 'CONDA_DEFAULT_ENV': 'CrashRepair', '_': '/root/anaconda3/envs/CrashRepair/bin/python'})
2025-02-03 22:19:17.524 | DEBUG    | scenario:rebuild:382 - injecting ghost function into CFLAGS during build: -lcrepair_ghost
2025-02-03 22:19:17.524 | DEBUG    | scenario:rebuild:398 - using environment: {'INJECT_CFLAGS': '-g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address', 'INJECT_CXXFLAGS': '-g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address', 'INJECT_LDFLAGS': '-g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address'}
2025-02-03 22:19:17.524 | DEBUG    | shell:__call__:41 - executing: make CFLAGS="${INJECT_CFLAGS}" CXXFLAGS="${INJECT_CXXFLAGS}" LDFLAGS="${INJECT_LDFLAGS}"
Making all in port
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/port'
make[1]: Nothing to be done for 'all'.
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/port'
Making all in libtiff
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/libtiff'
make  all-am
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/libtiff'
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/libtiff'
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/libtiff'
Making all in tools
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/tools'
crepair-cc -DHAVE_CONFIG_H -I. -I../libtiff  -I../libtiff   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -MT tiffcrop.o -MD -MP -MF .deps/tiffcrop.Tpo -c -o tiffcrop.o tiffcrop.c
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_ghost: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
mv -f .deps/tiffcrop.Tpo .deps/tiffcrop.Po
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address  -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -o tiffcrop tiffcrop.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -g -O0 -Wno-error -I/CrashRepair/lib -fsanitize=address -g -O0 -Wno-error -I/CrashRepair/lib -fsanitize=address -o tiffcrop tiffcrop.o  -L/klee/build/lib -L/CrashRepair/lib -lkleeRuntest -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost ../libtiff/.libs/libtiff.a ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/tools'
Making all in build
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/build'
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/build'
make[2]: Nothing to be done for 'all-am'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/build'
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/build'
Making all in contrib
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib'
Making all in addtiffo
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/addtiffo'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/addtiffo'
Making all in dbs
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/dbs'
Making all in xtiff
make[3]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/dbs/xtiff'
make[3]: Nothing to be done for 'all'.
make[3]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/dbs/xtiff'
make[3]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/dbs'
make[3]: Nothing to be done for 'all-am'.
make[3]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/dbs'
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/dbs'
Making all in iptcutil
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/iptcutil'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/iptcutil'
Making all in mfs
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/mfs'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/mfs'
Making all in pds
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/pds'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/pds'
Making all in ras
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/ras'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/ras'
Making all in stream
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/stream'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/stream'
Making all in tags
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/tags'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/tags'
Making all in win_dib
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/win_dib'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/win_dib'
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib'
make[2]: Nothing to be done for 'all-am'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib'
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib'
Making all in test
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/test'
make[1]: Nothing to be done for 'all'.
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/test'
Making all in man
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/man'
make[1]: Nothing to be done for 'all'.
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/man'
Making all in html
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html'
Making all in images
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html/images'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html/images'
Making all in man
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html/man'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html/man'
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html'
make[2]: Nothing to be done for 'all-am'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html'
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html'
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src'
make[1]: Nothing to be done for 'all-am'.
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src'
2025-02-03 22:19:17.986 | INFO     | analyzer:run:114 - running analysis with timeout: 60 minutes
2025-02-03 22:19:17.986 | DEBUG    | analyzer:write_config_to_file:88 - generated analyzer config:

dir_exp:/data/vulnloc/libtiff/CVE-2016-5321
tag_id:libtiff_CVE-2016-5321
src_directory:/data/vulnloc/libtiff/CVE-2016-5321/src
binary_path:/data/vulnloc/libtiff/CVE-2016-5321/src/tools/tiffcrop
config_command:./configure --enable-static --disable-shared
build_command:make CFLAGS="${INJECT_CFLAGS}" CXXFLAGS="${INJECT_CXXFLAGS}" LDFLAGS="${INJECT_LDFLAGS}"
test_input_list:$POC foo.tif
poc_list:/CrashRepair/experiments/vulnloc/libtiff/CVE-2016-5321/tests/1.tif
klee_flags:--link-llvm-lib=/CrashRepair/lib/libcrepair_proxy.bca 

2025-02-03 22:19:17.986 | DEBUG    | analyzer:run:124 - wrote analyzer config file to: /tmp/tmpyw6uj4c1
2025-02-03 22:19:17.986 | DEBUG    | shell:__call__:41 - executing: crepair --conf=/tmp/tmpyw6uj4c1
[K[1;36m
====================================================================================================

	Starting CRepair (C Crash Repair) 
====================================================================================================
[0m
[K[1;36m
	Loading Configurations
	__________________________________________________________________________________________
[0m
[K	[1;34mreading configuration values from arguments[0m
[K	[1;34mreading configuration values form configuration file[0m
[K	[1;37m	[file] /tmp/tmpyw6uj4c1[0m
[K	[1;34mupdating configuration values[0m
[K	[1;34mreading test configuration[0m
[K	[1;34mreading seed information[0m
[K	[1;37m	[config] stack size: 15000[0m
[K	[1;37m	[config] collecting stats: False[0m
[K	[1;37m	[config] number of tests: 1[0m
[K	[1;37m	[config] number of cores: 8[0m
[K	[1;37m	[config] klee concrete execution timeout: 600[0m
[K	[1;37m	[config] klee concolic execution timeout: 1200[0m
[K	[1;37m	[config] synthesize subset expressions: True[0m
[K	[1;37m	[config] window size for taint locations: 500[0m
[K	[1;37m	[config] window size for taint values: 500000[0m
[K[1;36m

	Analyzing Program
====================================================================================================
[0m
[K[1;36m
	Test Case #1
	__________________________________________________________________________________________
[0m
[K[1;36m
		Running Concrete Execution
		------------------------------------------------------------------------------------------
[0m
[K	[1;37m	[0m[K     [1;37mUsing Arguments: ['$POC', 'foo.tif'][0m
[K	[1;37m	[0m[K     [1;37mUsing Input File: /CrashRepair/experiments/vulnloc/libtiff/CVE-2016-5321/tests/1.tif[0m
[K	[1;34m	building program[0m
[K	[1;34m		setting environment variables[0m
[K	[1;34m		cleaning files[0m
[K	[1;34m		configuring program[0m
[K	[1;34m		compiling program[0m
[K	[1;37m	[0m[K     [1;37mUsing Binary: /data/vulnloc/libtiff/CVE-2016-5321/src/tools/tiffcrop[0m
[K	[1;34m	extracting bytecode[0m
[K	[1;34m	executing klee in concrete mode[0m
[K	[1;34m	extracting instruction trace[0m
[K	[1;37m		[note] program crashed[0m
[K	[1;34m	collecting tainted expressions[0m
[K	[1;34m	collecting tainted concrete values[0m
[K	[1;34m	collecting memory allocations/de-allocations[0m
[K	[1;34m	collecting pointer mapping[0m
[K	[1;34m	extracting crash information[0m
[K	[1;37m		[0m[K     [1;37m[info] crash type: memory read overflow[0m
[K	[1;37m		[0m[K     [1;37m[info] crash location:
                             /data/vulnloc/libtiff/CVE-2016-5321/src/tools/tiffcrop.c:992:43[0m
[K	[1;37m		[0m[K     [1;37m[info] crash function: readSeparateTilesIntoBuffer[0m
[K	[1;37m		[0m[K     [1;37m[info] crash address: 116502[0m
[K	[1;37m		[0m[K     [1;37m[info] crash free constraint: ((8 * @var(integer, s)) < 64)[0m
[K	[1;37m		[0m[K     [1;37m[info] crash inducing variables: s[0m
[K	[1;37m			[info] identified crash type: memory read overflow[0m
[K[1;36m
		Running Concolic Execution
		------------------------------------------------------------------------------------------
[0m
[K	[1;37m	[0m[K     [1;37mUsing Arguments: ['$POC', 'foo.tif'][0m
[K	[1;37m	[0m[K     [1;37mUsing Input File: /CrashRepair/experiments/vulnloc/libtiff/CVE-2016-5321/tests/1.tif[0m
[K	[1;34m	building program[0m
[K	[1;34m		setting environment variables[0m
[K	[1;34m		cleaning files[0m
[K	[1;34m		configuring program[0m
[K	[1;34m		compiling program[0m
[K	[1;34m	extracting bytecode[0m
[K	[1;34m	generating ktest file[0m
[K	[1;34m	executing klee in concolic mode[0m
[K	[1;34m	extracting largest symbolic path[0m
[K	[1;34m	extracting instruction trace[0m
[K	[1;37m		[note] program crashed[0m
[K	[1;34m	collecting tainted expressions[0m
[K	[1;34m	collecting memory allocations/de-allocations[0m
[K	[1;34m	collecting pointer mapping[0m
[K	[1;37m		[0m[K     [1;37m[info] Symbolic Mapping: s -> [][0m
[K[1;36m

	Fix Localization
====================================================================================================
[0m
[K[1;36m
	Generating Fix Locations
	__________________________________________________________________________________________
[0m
[K	[1;34m	generating taint map[0m
[K	[1;37m		[0m[K     [1;37m[info] found 10854 tainted locations[0m
[K	[1;34m		starting parallel computing[0m
[K	[1;34m		waiting for thread completion[0m
[K	[1;37m		[0m[K     [1;37m[info] found 5 source files[0m
[K	[1;37m		[0m[K     [1;37m[info] found 12 executed functions[0m
[K	[1;34m	generating possible fix locations[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] readSeparateTilesIntoBuffer,
                             /data/vulnloc/libtiff/CVE-2016-5321/src/tools/tiffcrop.c:990:35[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] readSeparateTilesIntoBuffer,
                             /data/vulnloc/libtiff/CVE-2016-5321/src/tools/tiffcrop.c:993:28[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] readSeparateTilesIntoBuffer,
                             /data/vulnloc/libtiff/CVE-2016-5321/src/tools/tiffcrop.c:993:21[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] readSeparateTilesIntoBuffer,
                             /data/vulnloc/libtiff/CVE-2016-5321/src/tools/tiffcrop.c:992:24[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] readSeparateTilesIntoBuffer,
                             /data/vulnloc/libtiff/CVE-2016-5321/src/tools/tiffcrop.c:992:26[0m
[K[1;36m
	Localizing Constraints
	__________________________________________________________________________________________
[0m
[K[1;36m
		[fix-loc] /data/vulnloc/libtiff/CVE-2016-5321/src/tools/tiffcrop.c:990:13
		------------------------------------------------------------------------------------------
[0m
[K	[1;37m	[0m[K     [1;37m[constraint] ((8 * @var(integer, s)) < 64)[0m
[K[1;36m
		[fix-loc] /data/vulnloc/libtiff/CVE-2016-5321/src/tools/tiffcrop.c:992:26
		------------------------------------------------------------------------------------------
[0m
[K	[1;37m	[0m[K     [1;37m[constraint] ((8 * @var(integer, s)) < 64)[0m
[K[1;36m
		[fix-loc] /data/vulnloc/libtiff/CVE-2016-5321/src/tools/tiffcrop.c:993:17
		------------------------------------------------------------------------------------------
[0m
[K	[1;37m	[0m[K     [1;37m[constraint] ((8 * @var(integer, s)) < 64)[0m
[K[1;36m
		[fix-loc] /data/vulnloc/libtiff/CVE-2016-5321/src/tools/tiffcrop.c:992:17
		------------------------------------------------------------------------------------------
[0m
[K	[1;37m	[0m[K     [1;37m[constraint] ((8 * @var(integer, s)) < 64)[0m
[K[1;32m
	localization information saved at /CrashRepair/output/libtiff_CVE-2016-5321/localization.json[0m
[K[1;32m
	state values saved at /CrashRepair/output/libtiff_CVE-2016-5321/values/[0m
[K	[1;37m
Run time statistics:
-----------------------
[0m
[K	[1;37mStartup: 0.000 minutes[0m
[K	[1;37mBuild: 0 minutes[0m
[K	[1;37mConcrete Analysis: 0.665 minutes[0m
[K	[1;37mConcolic Analysis: 0.586 minutes[0m
[K	[1;37mTotal Analysis: 1.283 minutes[0m
[K	[1;37mLocalization: 0.290 minutes[0m
[K[1;32m
CRepair finished successfully after 1.615 minutes 
[0m
2025-02-03 22:20:55.836 | WARNING  | analyzer:run:143 - analysis output directory does not exist [/data/vulnloc/libtiff/CVE-2016-5321/analysis]: creating...
2025-02-03 22:20:56.001 | INFO     | scenario:analyze_for_guide:558 - reanalyzing candidate patch: #13:
@@ -948,11 +948,12 @@
   return status;
   }
 
+
 static int  readSeparateTilesIntoBuffer (TIFF* in, uint8 *obuf, 
 					 uint32 imagelength, uint32 imagewidth, 
                                          uint32 tw, uint32 tl,
                                          uint16 spp, uint16 bps)
-  {
+{
   int     i, status = 1, sample;
   int     shift_width, bytes_per_pixel;
   uint16  bytes_per_sample;
@@ -968,51 +969,49 @@
   bytes_per_sample = (bps + 7) / 8;
 
   for (sample = 0; (sample < spp) && (sample < MAX_SAMPLES); sample++)
-    {
+  {
     srcbuffs[sample] = NULL;
     tbuff = (unsigned char *)_TIFFmalloc(tilesize + 8);
     if (!tbuff)
-      {
+    {
       TIFFError ("readSeparateTilesIntoBuffer", 
                  "Unable to allocate tile read buffer for sample %d", sample);
       for (i = 0; i < sample; i++)
         _TIFFfree (srcbuffs[i]);
       return 0;
-      }
+    }
     srcbuffs[sample] = tbuff;
-    } 
+  } 
   /* Each tile contains only the data for a single plane
    * arranged in scanlines of tw * bytes_per_sample bytes.
    */
   for (row = 0; row < imagelength; row += tl)
-    {
+  {
     nrow = (row + tl > imagelength) ? imagelength - row : tl;
     for (col = 0; col < imagewidth; col += tw)
-      {
+    {
       for (s = 0; s < spp; s++)
-        {  /* Read each plane of a tile set into srcbuffs[s] */
-	tbytes = TIFFReadTile(in, srcbuffs[s], col, row, 0, s);
-        if (tbytes < 0  && !ignore)
-          {
-	  TIFFError(TIFFFileName(in),
+      {  /* Read each plane of a tile set into srcbuffs[s] */
+        tbytes = TIFFReadTile(in, srcbuffs[s], col, row, 0, s);
+        if (tbytes < 0)
+        {
+          TIFFError(TIFFFileName(in),
                  "Error, can't read tile for row %lu col %lu, "
-		 "sample %lu",
-		 (unsigned long) col, (unsigned long) row,
-		 (unsigned long) s);
-		 status = 0;
-          for (sample = 0; (sample < spp) && (sample < MAX_SAMPLES); sample++)
-            {
-            tbuff = srcbuffs[sample];
-            if (tbuff != NULL)
-              _TIFFfree(tbuff);
-            }
-          return status;
-	  }
-	}
-     /* Tiles on the right edge may be padded out to tw 
-      * which must be a multiple of 16.
-      * Ncol represents the visible (non padding) portion.  
-      */
+                 "sample %lu",
+                 (unsigned long) col, (unsigned long) row,
+                 (unsigned long) s);
+          status = 0;
+          break; // Exit the loop as reading failed for this tile
+        }
+      }
+      if (status == 0) {
+        break; // Exit outer loop if there was an error
+      }
+     
+      /* Tiles on the right edge may be padded out to tw 
+       * which must be a multiple of 16.
+       * Ncol represents the visible (non padding) portion.  
+       */
       if (col + tw > imagewidth)
         ncol = imagewidth - col;
       else
@@ -1023,16 +1022,16 @@
       bufp = obuf + row_offset + col_offset;
 
       if ((bps % 8) == 0)
-        {
+      {
         if (combineSeparateTileSamplesBytes(srcbuffs, bufp, ncol, nrow, imagewidth,
 					    tw, spp, bps, NULL, 0, 0))
-	  {
+        {
           status = 0;
           break;
-      	  }
-	}
+        }
+      }
       else
-        {
+      {
         bytes_per_pixel  = ((bps * spp) + 7) / 8;
         if (bytes_per_pixel < (bytes_per_sample + 1))
           shift_width = bytes_per_pixel;
@@ -1040,60 +1039,69 @@
           shift_width = bytes_per_sample + 1;
 
         switch (shift_width)
-          {
-          case 1: if (combineSeparateTileSamples8bits (srcbuffs, bufp, ncol, nrow,
-                                                       imagewidth, tw, spp, bps, 
-						       NULL, 0, 0))
-	            {
-                    status = 0;
-                    break;
-      	            }
-	          break;
-          case 2: if (combineSeparateTileSamples16bits (srcbuffs, bufp, ncol, nrow,
-                                                       imagewidth, tw, spp, bps, 
-						       NULL, 0, 0))
-	            {
-                    status = 0;
-                    break;
-		    }
-	          break;
-          case 3: if (combineSeparateTileSamples24bits (srcbuffs, bufp, ncol, nrow,
-                                                       imagewidth, tw, spp, bps, 
-						       NULL, 0, 0))
-	            {
-                    status = 0;
-                    break;
-       	            }
-                  break;
+        {
+          case 1: 
+            if (combineSeparateTileSamples8bits (srcbuffs, bufp, ncol, nrow,
+                                                 imagewidth, tw, spp, bps, 
+						 NULL, 0, 0))
+            {
+              status = 0;
+              break;
+            }
+            break;
+          case 2: 
+            if (combineSeparateTileSamples16bits (srcbuffs, bufp, ncol, nrow,
+                                                  imagewidth, tw, spp, bps, 
+                                                  NULL, 0, 0))
+            {
+              status = 0;
+              break;
+            }
+            break;
+          case 3: 
+            if (combineSeparateTileSamples24bits (srcbuffs, bufp, ncol, nrow,
+                                                  imagewidth, tw, spp, bps, 
+                                                  NULL, 0, 0))
+            {
+              status = 0;
+              break;
+            }
+            break;
           case 4: 
           case 5:
           case 6:
           case 7:
-          case 8: if (combineSeparateTileSamples32bits (srcbuffs, bufp, ncol, nrow,
-                                                       imagewidth, tw, spp, bps, 
-						       NULL, 0, 0))
-	            {
-                    status = 0;
-                    break;
-		    }
-	          break;
-          default: TIFFError ("readSeparateTilesIntoBuffer", "Unsupported bit depth: %d", bps);
-                  status = 0;
-                  break;
-          }
+          case 8: 
+            if (combineSeparateTileSamples32bits (srcbuffs, bufp, ncol, nrow,
+                                                  imagewidth, tw, spp, bps, 
+                                                  NULL, 0, 0))
+            {
+              status = 0;
+              break;
+            }
+            break;
+          default: 
+            TIFFError ("readSeparateTilesIntoBuffer", "Unsupported bit depth: %d", bps);
+            status = 0;
+            break;
         }
       }
     }
+    if (status == 0) {
+      break; // Exit if there was an overall error
+    }
+  }
 
   for (sample = 0; (sample < spp) && (sample < MAX_SAMPLES); sample++)
-    {
+  {
     tbuff = srcbuffs[sample];
     if (tbuff != NULL)
       _TIFFfree(tbuff);
-    }
+  }
  
   return status;
-  }
+}
+
 
 static int writeBufferToContigStrips(TIFF* out, uint8* buf, uint32 imagelength)
   {

2025-02-03 22:20:56.025 | DEBUG    | scenario:rebuild:369 - original environment: environ({'CONDA_SHLVL': '2', 'LC_ALL': 'C.UTF-8', 'LS_COLORS': 'rs=0:di=01;34:ln=01;36:mh=00:pi=40;33:so=01;35:do=01;35:bd=40;33;01:cd=40;33;01:or=40;31;01:mi=00:su=37;41:sg=30;43:ca=30;41:tw=30;42:ow=34;42:st=37;44:ex=01;32:*.tar=01;31:*.tgz=01;31:*.arc=01;31:*.arj=01;31:*.taz=01;31:*.lha=01;31:*.lz4=01;31:*.lzh=01;31:*.lzma=01;31:*.tlz=01;31:*.txz=01;31:*.tzo=01;31:*.t7z=01;31:*.zip=01;31:*.z=01;31:*.Z=01;31:*.dz=01;31:*.gz=01;31:*.lrz=01;31:*.lz=01;31:*.lzo=01;31:*.xz=01;31:*.zst=01;31:*.tzst=01;31:*.bz2=01;31:*.bz=01;31:*.tbz=01;31:*.tbz2=01;31:*.tz=01;31:*.deb=01;31:*.rpm=01;31:*.jar=01;31:*.war=01;31:*.ear=01;31:*.sar=01;31:*.rar=01;31:*.alz=01;31:*.ace=01;31:*.zoo=01;31:*.cpio=01;31:*.7z=01;31:*.rz=01;31:*.cab=01;31:*.wim=01;31:*.swm=01;31:*.dwm=01;31:*.esd=01;31:*.jpg=01;35:*.jpeg=01;35:*.mjpg=01;35:*.mjpeg=01;35:*.gif=01;35:*.bmp=01;35:*.pbm=01;35:*.pgm=01;35:*.ppm=01;35:*.tga=01;35:*.xbm=01;35:*.xpm=01;35:*.tif=01;35:*.tiff=01;35:*.png=01;35:*.svg=01;35:*.svgz=01;35:*.mng=01;35:*.pcx=01;35:*.mov=01;35:*.mpg=01;35:*.mpeg=01;35:*.m2v=01;35:*.mkv=01;35:*.webm=01;35:*.ogm=01;35:*.mp4=01;35:*.m4v=01;35:*.mp4v=01;35:*.vob=01;35:*.qt=01;35:*.nuv=01;35:*.wmv=01;35:*.asf=01;35:*.rm=01;35:*.rmvb=01;35:*.flc=01;35:*.avi=01;35:*.fli=01;35:*.flv=01;35:*.gl=01;35:*.dl=01;35:*.xcf=01;35:*.xwd=01;35:*.yuv=01;35:*.cgm=01;35:*.emf=01;35:*.ogv=01;35:*.ogx=01;35:*.aac=00;36:*.au=00;36:*.flac=00;36:*.m4a=00;36:*.mid=00;36:*.midi=00;36:*.mka=00;36:*.mp3=00;36:*.mpc=00;36:*.ogg=00;36:*.ra=00;36:*.wav=00;36:*.oga=00;36:*.opus=00;36:*.spx=00;36:*.xspf=00;36:', 'LD_LIBRARY_PATH': '/opt/crashrepair/lib:/CrashRepair/lib:/klee/build/lib:', 'CONDA_EXE': '/root/anaconda3/bin/conda', 'LANG': 'C.UTF-8', 'TZ': 'Asia/Shanghai', 'HOSTNAME': 'fea22102047d', 'OLDPWD': '/orchestrator', 'CONDA_PREFIX': '/root/anaconda3/envs/CrashRepair', '_CE_M': '', 'CC': 'crepair-cc', 'LLVM_COMPILER': 'clang', 'CONDA_PREFIX_1': '/root/anaconda3', 'PWD': '/orchestrator/crashrepair', 'HOME': '/root', 'CONDA_PYTHON_EXE': '/root/anaconda3/bin/python', '_CE_CONDA': '', 'CONDA_PROMPT_MODIFIER': '(CrashRepair) ', 'CXX': 'crepair-cxx', 'TERM': 'xterm', 'SHLVL': '2', 'PYTHONPATH': '/usr/lib/python3.8/site-packages:', 'PATH': '/root/anaconda3/envs/CrashRepair/bin:/root/anaconda3/condabin:~/anaconda3/bin:/opt/crashrepair/bin:/CrashRepair/compiler:/klee/build/bin:/opt/llvm-6/bin:/klee/build/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', 'CONDA_DEFAULT_ENV': 'CrashRepair', '_': '/root/anaconda3/envs/CrashRepair/bin/python'})
2025-02-03 22:20:56.025 | DEBUG    | scenario:rebuild:382 - injecting ghost function into CFLAGS during build: -lcrepair_ghost
2025-02-03 22:20:56.025 | DEBUG    | scenario:rebuild:398 - using environment: {'INJECT_CFLAGS': '-g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address', 'INJECT_CXXFLAGS': '-g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address', 'INJECT_LDFLAGS': '-g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address'}
2025-02-03 22:20:56.025 | DEBUG    | shell:__call__:41 - executing: make CFLAGS="${INJECT_CFLAGS}" CXXFLAGS="${INJECT_CXXFLAGS}" LDFLAGS="${INJECT_LDFLAGS}"
Making all in port
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/port'
make[1]: Nothing to be done for 'all'.
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/port'
Making all in libtiff
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/libtiff'
make  all-am
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/libtiff'
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/libtiff'
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/libtiff'
Making all in tools
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/tools'
crepair-cc -DHAVE_CONFIG_H -I. -I../libtiff  -I../libtiff   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -MT tiffcrop.o -MD -MP -MF .deps/tiffcrop.Tpo -c -o tiffcrop.o tiffcrop.c
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_ghost: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
mv -f .deps/tiffcrop.Tpo .deps/tiffcrop.Po
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address  -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -o tiffcrop tiffcrop.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -g -O0 -Wno-error -I/CrashRepair/lib -fsanitize=address -g -O0 -Wno-error -I/CrashRepair/lib -fsanitize=address -o tiffcrop tiffcrop.o  -L/klee/build/lib -L/CrashRepair/lib -lkleeRuntest -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost ../libtiff/.libs/libtiff.a ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/tools'
Making all in build
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/build'
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/build'
make[2]: Nothing to be done for 'all-am'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/build'
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/build'
Making all in contrib
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib'
Making all in addtiffo
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/addtiffo'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/addtiffo'
Making all in dbs
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/dbs'
Making all in xtiff
make[3]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/dbs/xtiff'
make[3]: Nothing to be done for 'all'.
make[3]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/dbs/xtiff'
make[3]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/dbs'
make[3]: Nothing to be done for 'all-am'.
make[3]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/dbs'
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/dbs'
Making all in iptcutil
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/iptcutil'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/iptcutil'
Making all in mfs
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/mfs'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/mfs'
Making all in pds
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/pds'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/pds'
Making all in ras
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/ras'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/ras'
Making all in stream
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/stream'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/stream'
Making all in tags
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/tags'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/tags'
Making all in win_dib
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/win_dib'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/win_dib'
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib'
make[2]: Nothing to be done for 'all-am'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib'
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib'
Making all in test
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/test'
make[1]: Nothing to be done for 'all'.
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/test'
Making all in man
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/man'
make[1]: Nothing to be done for 'all'.
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/man'
Making all in html
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html'
Making all in images
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html/images'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html/images'
Making all in man
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html/man'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html/man'
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html'
make[2]: Nothing to be done for 'all-am'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html'
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html'
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src'
make[1]: Nothing to be done for 'all-am'.
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src'
2025-02-03 22:20:56.518 | INFO     | analyzer:run:114 - running analysis with timeout: 60 minutes
2025-02-03 22:20:56.519 | DEBUG    | analyzer:write_config_to_file:88 - generated analyzer config:

dir_exp:/data/vulnloc/libtiff/CVE-2016-5321
tag_id:libtiff_CVE-2016-5321
src_directory:/data/vulnloc/libtiff/CVE-2016-5321/src
binary_path:/data/vulnloc/libtiff/CVE-2016-5321/src/tools/tiffcrop
config_command:./configure --enable-static --disable-shared
build_command:make CFLAGS="${INJECT_CFLAGS}" CXXFLAGS="${INJECT_CXXFLAGS}" LDFLAGS="${INJECT_LDFLAGS}"
test_input_list:$POC foo.tif
poc_list:/CrashRepair/experiments/vulnloc/libtiff/CVE-2016-5321/tests/1.tif
klee_flags:--link-llvm-lib=/CrashRepair/lib/libcrepair_proxy.bca 

2025-02-03 22:20:56.519 | DEBUG    | analyzer:run:124 - wrote analyzer config file to: /tmp/tmpng3zpjlg
2025-02-03 22:20:56.519 | DEBUG    | shell:__call__:41 - executing: crepair --conf=/tmp/tmpng3zpjlg
[K[1;36m
====================================================================================================

	Starting CRepair (C Crash Repair) 
====================================================================================================
[0m
[K[1;36m
	Loading Configurations
	__________________________________________________________________________________________
[0m
[K	[1;34mreading configuration values from arguments[0m
[K	[1;34mreading configuration values form configuration file[0m
[K	[1;37m	[file] /tmp/tmpng3zpjlg[0m
[K	[1;34mupdating configuration values[0m
[K	[1;34mreading test configuration[0m
[K	[1;34mreading seed information[0m
[K	[1;37m	[config] stack size: 15000[0m
[K	[1;37m	[config] collecting stats: False[0m
[K	[1;37m	[config] number of tests: 1[0m
[K	[1;37m	[config] number of cores: 8[0m
[K	[1;37m	[config] klee concrete execution timeout: 600[0m
[K	[1;37m	[config] klee concolic execution timeout: 1200[0m
[K	[1;37m	[config] synthesize subset expressions: True[0m
[K	[1;37m	[config] window size for taint locations: 500[0m
[K	[1;37m	[config] window size for taint values: 500000[0m
[K[1;36m

	Analyzing Program
====================================================================================================
[0m
[K[1;36m
	Test Case #1
	__________________________________________________________________________________________
[0m
[K[1;36m
		Running Concrete Execution
		------------------------------------------------------------------------------------------
[0m
[K	[1;37m	[0m[K     [1;37mUsing Arguments: ['$POC', 'foo.tif'][0m
[K	[1;37m	[0m[K     [1;37mUsing Input File: /CrashRepair/experiments/vulnloc/libtiff/CVE-2016-5321/tests/1.tif[0m
[K	[1;34m	building program[0m
[K	[1;34m		setting environment variables[0m
[K	[1;34m		cleaning files[0m
[K	[1;34m		configuring program[0m
[K	[1;34m		compiling program[0m
[K	[1;37m	[0m[K     [1;37mUsing Binary: /data/vulnloc/libtiff/CVE-2016-5321/src/tools/tiffcrop[0m
[K	[1;34m	extracting bytecode[0m
[K	[1;34m	executing klee in concrete mode[0m
[K	[1;34m	extracting instruction trace[0m
[K	[1;37m		[note] program crashed[0m
[K	[1;34m	collecting tainted expressions[0m
[K	[1;34m	collecting tainted concrete values[0m
[K	[1;34m	collecting memory allocations/de-allocations[0m
[K	[1;34m	collecting pointer mapping[0m
[K	[1;34m	extracting crash information[0m
[K	[1;37m		[0m[K     [1;37m[info] crash type: memory read overflow[0m
[K	[1;37m		[0m[K     [1;37m[info] crash location:
                             /data/vulnloc/libtiff/CVE-2016-5321/src/tools/tiffcrop.c:995:35[0m
[K	[1;37m		[0m[K     [1;37m[info] crash function: readSeparateTilesIntoBuffer[0m
[K	[1;37m		[0m[K     [1;37m[info] crash address: 116502[0m
[K	[1;37m		[0m[K     [1;37m[info] crash free constraint: ((8 * @var(integer, s)) < 64)[0m
[K	[1;37m		[0m[K     [1;37m[info] crash inducing variables: s[0m
[K	[1;37m			[info] identified crash type: memory read overflow[0m
[K[1;36m
		Running Concolic Execution
		------------------------------------------------------------------------------------------
[0m
[K	[1;37m	[0m[K     [1;37mUsing Arguments: ['$POC', 'foo.tif'][0m
[K	[1;37m	[0m[K     [1;37mUsing Input File: /CrashRepair/experiments/vulnloc/libtiff/CVE-2016-5321/tests/1.tif[0m
[K	[1;34m	building program[0m
[K	[1;34m		setting environment variables[0m
[K	[1;34m		cleaning files[0m
[K	[1;34m		configuring program[0m
[K	[1;34m		compiling program[0m
[K	[1;34m	extracting bytecode[0m
[K	[1;34m	generating ktest file[0m
[K	[1;34m	executing klee in concolic mode[0m
[K	[1;34m	extracting largest symbolic path[0m
[K	[1;34m	extracting instruction trace[0m
[K	[1;37m		[note] program crashed[0m
[K	[1;34m	collecting tainted expressions[0m
[K	[1;34m	collecting memory allocations/de-allocations[0m
[K	[1;34m	collecting pointer mapping[0m
[K	[1;37m		[0m[K     [1;37m[info] Symbolic Mapping: s -> [][0m
[K[1;36m

	Fix Localization
====================================================================================================
[0m
[K[1;36m
	Generating Fix Locations
	__________________________________________________________________________________________
[0m
[K	[1;34m	generating taint map[0m
[K	[1;37m		[0m[K     [1;37m[info] found 10854 tainted locations[0m
[K	[1;34m		starting parallel computing[0m
[K	[1;34m		waiting for thread completion[0m
[K	[1;37m		[0m[K     [1;37m[info] found 5 source files[0m
[K	[1;37m		[0m[K     [1;37m[info] found 12 executed functions[0m
[K	[1;34m	generating possible fix locations[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] readSeparateTilesIntoBuffer,
                             /data/vulnloc/libtiff/CVE-2016-5321/src/tools/tiffcrop.c:993:29[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] readSeparateTilesIntoBuffer,
                             /data/vulnloc/libtiff/CVE-2016-5321/src/tools/tiffcrop.c:996:20[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] readSeparateTilesIntoBuffer,
                             /data/vulnloc/libtiff/CVE-2016-5321/src/tools/tiffcrop.c:996:13[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] readSeparateTilesIntoBuffer,
                             /data/vulnloc/libtiff/CVE-2016-5321/src/tools/tiffcrop.c:995:16[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] readSeparateTilesIntoBuffer,
                             /data/vulnloc/libtiff/CVE-2016-5321/src/tools/tiffcrop.c:995:18[0m
[K[1;36m
	Localizing Constraints
	__________________________________________________________________________________________
[0m
[K[1;36m
		[fix-loc] /data/vulnloc/libtiff/CVE-2016-5321/src/tools/tiffcrop.c:993:7
		------------------------------------------------------------------------------------------
[0m
[K	[1;37m	[0m[K     [1;37m[constraint] ((8 * @var(integer, s)) < 64)[0m
[K[1;36m
		[fix-loc] /data/vulnloc/libtiff/CVE-2016-5321/src/tools/tiffcrop.c:995:18
		------------------------------------------------------------------------------------------
[0m
[K	[1;37m	[0m[K     [1;37m[constraint] ((8 * @var(integer, s)) < 64)[0m
[K[1;36m
		[fix-loc] /data/vulnloc/libtiff/CVE-2016-5321/src/tools/tiffcrop.c:996:9
		------------------------------------------------------------------------------------------
[0m
[K	[1;37m	[0m[K     [1;37m[constraint] ((8 * @var(integer, s)) < 64)[0m
[K[1;36m
		[fix-loc] /data/vulnloc/libtiff/CVE-2016-5321/src/tools/tiffcrop.c:995:9
		------------------------------------------------------------------------------------------
[0m
[K	[1;37m	[0m[K     [1;37m[constraint] ((8 * @var(integer, s)) < 64)[0m
[K[1;32m
	localization information saved at /CrashRepair/output/libtiff_CVE-2016-5321/localization.json[0m
[K[1;32m
	state values saved at /CrashRepair/output/libtiff_CVE-2016-5321/values/[0m
[K	[1;37m
Run time statistics:
-----------------------
[0m
[K	[1;37mStartup: 0.000 minutes[0m
[K	[1;37mBuild: 0 minutes[0m
[K	[1;37mConcrete Analysis: 0.680 minutes[0m
[K	[1;37mConcolic Analysis: 0.584 minutes[0m
[K	[1;37mTotal Analysis: 1.297 minutes[0m
[K	[1;37mLocalization: 0.294 minutes[0m
[K[1;32m
CRepair finished successfully after 1.636 minutes 
[0m
2025-02-03 22:22:35.614 | WARNING  | analyzer:run:143 - analysis output directory does not exist [/data/vulnloc/libtiff/CVE-2016-5321/analysis]: creating...
2025-02-03 22:22:35.722 | INFO     | scenario:analyze_for_guide:558 - reanalyzing candidate patch: #14:
@@ -948,152 +948,162 @@
   return status;
   }
 
-static int  readSeparateTilesIntoBuffer (TIFF* in, uint8 *obuf, 
-					 uint32 imagelength, uint32 imagewidth, 
-                                         uint32 tw, uint32 tl,
-                                         uint16 spp, uint16 bps)
-  {
-  int     i, status = 1, sample;
-  int     shift_width, bytes_per_pixel;
-  uint16  bytes_per_sample;
-  uint32  row, col;     /* Current row and col of image */
-  uint32  nrow, ncol;   /* Number of rows and cols in current tile */
-  uint32  row_offset, col_offset; /* Output buffer offsets */
-  tsize_t tbytes = 0, tilesize = TIFFTileSize(in);
-  tsample_t s;
-  uint8*  bufp = (uint8*)obuf;
-  unsigned char *srcbuffs[MAX_SAMPLES];
-  unsigned char *tbuff = NULL;
 
-  bytes_per_sample = (bps + 7) / 8;
+static int readSeparateTilesIntoBuffer(TIFF* in, uint8 *obuf, 
+                                        uint32 imagelength, uint32 imagewidth, 
+                                        uint32 tw, uint32 tl,
+                                        uint16 spp, uint16 bps)
+{
+    int i, status = 1, sample;
+    int shift_width, bytes_per_pixel;
+    uint16 bytes_per_sample;
+    uint32 row, col;     /* Current row and col of image */
+    uint32 nrow, ncol;   /* Number of rows and cols in current tile */
+    uint32 row_offset, col_offset; /* Output buffer offsets */
+    tsize_t tbytes = 0, tilesize = TIFFTileSize(in);
+    tsample_t s;
+    uint8* bufp = (uint8*)obuf;
+    unsigned char *srcbuffs[MAX_SAMPLES];
+    unsigned char *tbuff = NULL;
+
+    bytes_per_sample = (bps + 7) / 8;
 
-  for (sample = 0; (sample < spp) && (sample < MAX_SAMPLES); sample++)
+    for (sample = 0; (sample < spp) && (sample < MAX_SAMPLES); sample++)
     {
-    srcbuffs[sample] = NULL;
-    tbuff = (unsigned char *)_TIFFmalloc(tilesize + 8);
-    if (!tbuff)
-      {
-      TIFFError ("readSeparateTilesIntoBuffer", 
-                 "Unable to allocate tile read buffer for sample %d", sample);
-      for (i = 0; i < sample; i++)
-        _TIFFfree (srcbuffs[i]);
-      return 0;
-      }
-    srcbuffs[sample] = tbuff;
+        srcbuffs[sample] = NULL;
+        tbuff = (unsigned char *)_TIFFmalloc(tilesize + 8);
+        if (!tbuff)
+        {
+            TIFFError("readSeparateTilesIntoBuffer", 
+                       "Unable to allocate tile read buffer for sample %d", sample);
+            for (i = 0; i < sample; i++)
+                _TIFFfree(srcbuffs[i]);
+            return 0;
+        }
+        srcbuffs[sample] = tbuff;
     } 
-  /* Each tile contains only the data for a single plane
-   * arranged in scanlines of tw * bytes_per_sample bytes.
-   */
-  for (row = 0; row < imagelength; row += tl)
+    /* Each tile contains only the data for a single plane
+     * arranged in scanlines of tw * bytes_per_sample bytes.
+     */
+    for (row = 0; row < imagelength; row += tl)
     {
-    nrow = (row + tl > imagelength) ? imagelength - row : tl;
-    for (col = 0; col < imagewidth; col += tw)
-      {
-      for (s = 0; s < spp; s++)
-        {  /* Read each plane of a tile set into srcbuffs[s] */
-	tbytes = TIFFReadTile(in, srcbuffs[s], col, row, 0, s);
-        if (tbytes < 0  && !ignore)
-          {
-	  TIFFError(TIFFFileName(in),
-                 "Error, can't read tile for row %lu col %lu, "
-		 "sample %lu",
-		 (unsigned long) col, (unsigned long) row,
-		 (unsigned long) s);
-		 status = 0;
-          for (sample = 0; (sample < spp) && (sample < MAX_SAMPLES); sample++)
-            {
-            tbuff = srcbuffs[sample];
-            if (tbuff != NULL)
-              _TIFFfree(tbuff);
+        nrow = (row + tl > imagelength) ? imagelength - row : tl;
+        for (col = 0; col < imagewidth; col += tw)
+        {
+            for (s = 0; s < spp; s++)
+            {  /* Read each plane of a tile set into srcbuffs[s] */
+                tbytes = TIFFReadTile(in, srcbuffs[s], col, row, 0, s);
+                if (tbytes < 0)
+                {
+                    if (!ignore)
+                    {
+                        TIFFError(TIFFFileName(in),
+                                   "Error, can't read tile for row %lu col %lu, "
+                                   "sample %lu",
+                                   (unsigned long)col, (unsigned long)row,
+                                   (unsigned long)s);
+                        status = 0;
+                    }
+                    for (sample = 0; (sample < spp) && (sample < MAX_SAMPLES); sample++)
+                    {
+                        tbuff = srcbuffs[sample];
+                        if (tbuff != NULL)
+                            _TIFFfree(tbuff);
+                    }
+                    return status;
+                }
             }
-          return status;
-	  }
-	}
-     /* Tiles on the right edge may be padded out to tw 
-      * which must be a multiple of 16.
-      * Ncol represents the visible (non padding) portion.  
-      */
-      if (col + tw > imagewidth)
-        ncol = imagewidth - col;
-      else
-        ncol = tw;
-
-      row_offset = row * (((imagewidth * spp * bps) + 7) / 8);
-      col_offset = ((col * spp * bps) + 7) / 8;
-      bufp = obuf + row_offset + col_offset;
+            /* Tiles on the right edge may be padded out to tw 
+             * which must be a multiple of 16.
+             * Ncol represents the visible (non padding) portion.  
+             */
+            if (col + tw > imagewidth)
+                ncol = imagewidth - col;
+            else
+                ncol = tw;
+
+            row_offset = row * (((imagewidth * spp * bps) + 7) / 8);
+            col_offset = ((col * spp * bps) + 7) / 8;
+            bufp = obuf + row_offset + col_offset;
 
-      if ((bps % 8) == 0)
-        {
-        if (combineSeparateTileSamplesBytes(srcbuffs, bufp, ncol, nrow, imagewidth,
-					    tw, spp, bps, NULL, 0, 0))
-	  {
-          status = 0;
-          break;
-      	  }
-	}
-      else
-        {
-        bytes_per_pixel  = ((bps * spp) + 7) / 8;
-        if (bytes_per_pixel < (bytes_per_sample + 1))
-          shift_width = bytes_per_pixel;
-        else
-          shift_width = bytes_per_sample + 1;
-
-        switch (shift_width)
-          {
-          case 1: if (combineSeparateTileSamples8bits (srcbuffs, bufp, ncol, nrow,
-                                                       imagewidth, tw, spp, bps, 
-						       NULL, 0, 0))
-	            {
+            if ((bps % 8) == 0)
+            {
+                if (combineSeparateTileSamplesBytes(srcbuffs, bufp, ncol, nrow, imagewidth,
+                                                    tw, spp, bps, NULL, 0, 0))
+                {
                     status = 0;
                     break;
-      	            }
-	          break;
-          case 2: if (combineSeparateTileSamples16bits (srcbuffs, bufp, ncol, nrow,
-                                                       imagewidth, tw, spp, bps, 
-						       NULL, 0, 0))
-	            {
-                    status = 0;
+                }
+            }
+            else
+            {
+                bytes_per_pixel = ((bps * spp) + 7) / 8;
+                if (bytes_per_pixel < (bytes_per_sample + 1))
+                    shift_width = bytes_per_pixel;
+                else
+                    shift_width = bytes_per_sample + 1;
+
+                switch (shift_width)
+                {
+                case 1: 
+                    if (combineSeparateTileSamples8bits(srcbuffs, bufp, ncol, nrow,
+                                                         imagewidth, tw, spp, bps, 
+                                                         NULL, 0, 0))
+                    {
+                        status = 0;
+                        break;
+                    }
                     break;
-		    }
-	          break;
-          case 3: if (combineSeparateTileSamples24bits (srcbuffs, bufp, ncol, nrow,
-                                                       imagewidth, tw, spp, bps, 
-						       NULL, 0, 0))
-	            {
-                    status = 0;
+                case 2: 
+                    if (combineSeparateTileSamples16bits(srcbuffs, bufp, ncol, nrow,
+                                                         imagewidth, tw, spp, bps, 
+                                                         NULL, 0, 0))
+                    {
+                        status = 0;
+                        break;
+                    }
+                    break;
+                case 3: 
+                    if (combineSeparateTileSamples24bits(srcbuffs, bufp, ncol, nrow,
+                                                         imagewidth, tw, spp, bps, 
+                                                         NULL, 0, 0))
+                    {
+                        status = 0;
+                        break;
+                    }
+                    break;
+                case 4: 
+                case 5:
+                case 6:
+                case 7:
+                case 8: 
+                    if (combineSeparateTileSamples32bits(srcbuffs, bufp, ncol, nrow,
+                                                         imagewidth, tw, spp, bps, 
+                                                         NULL, 0, 0))
+                    {
+                        status = 0;
+                        break;
+                    }
                     break;
-       	            }
-                  break;
-          case 4: 
-          case 5:
-          case 6:
-          case 7:
-          case 8: if (combineSeparateTileSamples32bits (srcbuffs, bufp, ncol, nrow,
-                                                       imagewidth, tw, spp, bps, 
-						       NULL, 0, 0))
-	            {
+                default: 
+                    TIFFError("readSeparateTilesIntoBuffer", "Unsupported bit depth: %d", bps);
                     status = 0;
                     break;
-		    }
-	          break;
-          default: TIFFError ("readSeparateTilesIntoBuffer", "Unsupported bit depth: %d", bps);
-                  status = 0;
-                  break;
-          }
+                }
+            }
         }
-      }
     }
 
-  for (sample = 0; (sample < spp) && (sample < MAX_SAMPLES); sample++)
+    for (sample = 0; (sample < spp) && (sample < MAX_SAMPLES); sample++)
     {
-    tbuff = srcbuffs[sample];
-    if (tbuff != NULL)
-      _TIFFfree(tbuff);
+        tbuff = srcbuffs[sample];
+        if (tbuff != NULL)
+            _TIFFfree(tbuff);
     }
- 
-  return status;
-  }
+
+    return status;
+}
+
 
 static int writeBufferToContigStrips(TIFF* out, uint8* buf, uint32 imagelength)
   {

2025-02-03 22:22:35.731 | DEBUG    | scenario:rebuild:369 - original environment: environ({'CONDA_SHLVL': '2', 'LC_ALL': 'C.UTF-8', 'LS_COLORS': 'rs=0:di=01;34:ln=01;36:mh=00:pi=40;33:so=01;35:do=01;35:bd=40;33;01:cd=40;33;01:or=40;31;01:mi=00:su=37;41:sg=30;43:ca=30;41:tw=30;42:ow=34;42:st=37;44:ex=01;32:*.tar=01;31:*.tgz=01;31:*.arc=01;31:*.arj=01;31:*.taz=01;31:*.lha=01;31:*.lz4=01;31:*.lzh=01;31:*.lzma=01;31:*.tlz=01;31:*.txz=01;31:*.tzo=01;31:*.t7z=01;31:*.zip=01;31:*.z=01;31:*.Z=01;31:*.dz=01;31:*.gz=01;31:*.lrz=01;31:*.lz=01;31:*.lzo=01;31:*.xz=01;31:*.zst=01;31:*.tzst=01;31:*.bz2=01;31:*.bz=01;31:*.tbz=01;31:*.tbz2=01;31:*.tz=01;31:*.deb=01;31:*.rpm=01;31:*.jar=01;31:*.war=01;31:*.ear=01;31:*.sar=01;31:*.rar=01;31:*.alz=01;31:*.ace=01;31:*.zoo=01;31:*.cpio=01;31:*.7z=01;31:*.rz=01;31:*.cab=01;31:*.wim=01;31:*.swm=01;31:*.dwm=01;31:*.esd=01;31:*.jpg=01;35:*.jpeg=01;35:*.mjpg=01;35:*.mjpeg=01;35:*.gif=01;35:*.bmp=01;35:*.pbm=01;35:*.pgm=01;35:*.ppm=01;35:*.tga=01;35:*.xbm=01;35:*.xpm=01;35:*.tif=01;35:*.tiff=01;35:*.png=01;35:*.svg=01;35:*.svgz=01;35:*.mng=01;35:*.pcx=01;35:*.mov=01;35:*.mpg=01;35:*.mpeg=01;35:*.m2v=01;35:*.mkv=01;35:*.webm=01;35:*.ogm=01;35:*.mp4=01;35:*.m4v=01;35:*.mp4v=01;35:*.vob=01;35:*.qt=01;35:*.nuv=01;35:*.wmv=01;35:*.asf=01;35:*.rm=01;35:*.rmvb=01;35:*.flc=01;35:*.avi=01;35:*.fli=01;35:*.flv=01;35:*.gl=01;35:*.dl=01;35:*.xcf=01;35:*.xwd=01;35:*.yuv=01;35:*.cgm=01;35:*.emf=01;35:*.ogv=01;35:*.ogx=01;35:*.aac=00;36:*.au=00;36:*.flac=00;36:*.m4a=00;36:*.mid=00;36:*.midi=00;36:*.mka=00;36:*.mp3=00;36:*.mpc=00;36:*.ogg=00;36:*.ra=00;36:*.wav=00;36:*.oga=00;36:*.opus=00;36:*.spx=00;36:*.xspf=00;36:', 'LD_LIBRARY_PATH': '/opt/crashrepair/lib:/CrashRepair/lib:/klee/build/lib:', 'CONDA_EXE': '/root/anaconda3/bin/conda', 'LANG': 'C.UTF-8', 'TZ': 'Asia/Shanghai', 'HOSTNAME': 'fea22102047d', 'OLDPWD': '/orchestrator', 'CONDA_PREFIX': '/root/anaconda3/envs/CrashRepair', '_CE_M': '', 'CC': 'crepair-cc', 'LLVM_COMPILER': 'clang', 'CONDA_PREFIX_1': '/root/anaconda3', 'PWD': '/orchestrator/crashrepair', 'HOME': '/root', 'CONDA_PYTHON_EXE': '/root/anaconda3/bin/python', '_CE_CONDA': '', 'CONDA_PROMPT_MODIFIER': '(CrashRepair) ', 'CXX': 'crepair-cxx', 'TERM': 'xterm', 'SHLVL': '2', 'PYTHONPATH': '/usr/lib/python3.8/site-packages:', 'PATH': '/root/anaconda3/envs/CrashRepair/bin:/root/anaconda3/condabin:~/anaconda3/bin:/opt/crashrepair/bin:/CrashRepair/compiler:/klee/build/bin:/opt/llvm-6/bin:/klee/build/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', 'CONDA_DEFAULT_ENV': 'CrashRepair', '_': '/root/anaconda3/envs/CrashRepair/bin/python'})
2025-02-03 22:22:35.731 | DEBUG    | scenario:rebuild:382 - injecting ghost function into CFLAGS during build: -lcrepair_ghost
2025-02-03 22:22:35.731 | DEBUG    | scenario:rebuild:398 - using environment: {'INJECT_CFLAGS': '-g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address', 'INJECT_CXXFLAGS': '-g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address', 'INJECT_LDFLAGS': '-g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address'}
2025-02-03 22:22:35.731 | DEBUG    | shell:__call__:41 - executing: make CFLAGS="${INJECT_CFLAGS}" CXXFLAGS="${INJECT_CXXFLAGS}" LDFLAGS="${INJECT_LDFLAGS}"
Making all in port
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/port'
make[1]: Nothing to be done for 'all'.
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/port'
Making all in libtiff
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/libtiff'
make  all-am
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/libtiff'
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/libtiff'
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/libtiff'
Making all in tools
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/tools'
crepair-cc -DHAVE_CONFIG_H -I. -I../libtiff  -I../libtiff   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -MT tiffcrop.o -MD -MP -MF .deps/tiffcrop.Tpo -c -o tiffcrop.o tiffcrop.c
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_ghost: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
mv -f .deps/tiffcrop.Tpo .deps/tiffcrop.Po
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address  -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -o tiffcrop tiffcrop.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -g -O0 -Wno-error -I/CrashRepair/lib -fsanitize=address -g -O0 -Wno-error -I/CrashRepair/lib -fsanitize=address -o tiffcrop tiffcrop.o  -L/klee/build/lib -L/CrashRepair/lib -lkleeRuntest -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost ../libtiff/.libs/libtiff.a ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/tools'
Making all in build
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/build'
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/build'
make[2]: Nothing to be done for 'all-am'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/build'
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/build'
Making all in contrib
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib'
Making all in addtiffo
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/addtiffo'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/addtiffo'
Making all in dbs
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/dbs'
Making all in xtiff
make[3]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/dbs/xtiff'
make[3]: Nothing to be done for 'all'.
make[3]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/dbs/xtiff'
make[3]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/dbs'
make[3]: Nothing to be done for 'all-am'.
make[3]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/dbs'
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/dbs'
Making all in iptcutil
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/iptcutil'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/iptcutil'
Making all in mfs
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/mfs'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/mfs'
Making all in pds
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/pds'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/pds'
Making all in ras
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/ras'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/ras'
Making all in stream
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/stream'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/stream'
Making all in tags
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/tags'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/tags'
Making all in win_dib
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/win_dib'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/win_dib'
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib'
make[2]: Nothing to be done for 'all-am'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib'
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib'
Making all in test
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/test'
make[1]: Nothing to be done for 'all'.
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/test'
Making all in man
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/man'
make[1]: Nothing to be done for 'all'.
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/man'
Making all in html
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html'
Making all in images
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html/images'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html/images'
Making all in man
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html/man'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html/man'
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html'
make[2]: Nothing to be done for 'all-am'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html'
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html'
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src'
make[1]: Nothing to be done for 'all-am'.
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src'
2025-02-03 22:22:36.208 | INFO     | analyzer:run:114 - running analysis with timeout: 60 minutes
2025-02-03 22:22:36.208 | DEBUG    | analyzer:write_config_to_file:88 - generated analyzer config:

dir_exp:/data/vulnloc/libtiff/CVE-2016-5321
tag_id:libtiff_CVE-2016-5321
src_directory:/data/vulnloc/libtiff/CVE-2016-5321/src
binary_path:/data/vulnloc/libtiff/CVE-2016-5321/src/tools/tiffcrop
config_command:./configure --enable-static --disable-shared
build_command:make CFLAGS="${INJECT_CFLAGS}" CXXFLAGS="${INJECT_CXXFLAGS}" LDFLAGS="${INJECT_LDFLAGS}"
test_input_list:$POC foo.tif
poc_list:/CrashRepair/experiments/vulnloc/libtiff/CVE-2016-5321/tests/1.tif
klee_flags:--link-llvm-lib=/CrashRepair/lib/libcrepair_proxy.bca 

2025-02-03 22:22:36.208 | DEBUG    | analyzer:run:124 - wrote analyzer config file to: /tmp/tmpqtof_s2p
2025-02-03 22:22:36.208 | DEBUG    | shell:__call__:41 - executing: crepair --conf=/tmp/tmpqtof_s2p
[K[1;36m
====================================================================================================

	Starting CRepair (C Crash Repair) 
====================================================================================================
[0m
[K[1;36m
	Loading Configurations
	__________________________________________________________________________________________
[0m
[K	[1;34mreading configuration values from arguments[0m
[K	[1;34mreading configuration values form configuration file[0m
[K	[1;37m	[file] /tmp/tmpqtof_s2p[0m
[K	[1;34mupdating configuration values[0m
[K	[1;34mreading test configuration[0m
[K	[1;34mreading seed information[0m
[K	[1;37m	[config] stack size: 15000[0m
[K	[1;37m	[config] collecting stats: False[0m
[K	[1;37m	[config] number of tests: 1[0m
[K	[1;37m	[config] number of cores: 8[0m
[K	[1;37m	[config] klee concrete execution timeout: 600[0m
[K	[1;37m	[config] klee concolic execution timeout: 1200[0m
[K	[1;37m	[config] synthesize subset expressions: True[0m
[K	[1;37m	[config] window size for taint locations: 500[0m
[K	[1;37m	[config] window size for taint values: 500000[0m
[K[1;36m

	Analyzing Program
====================================================================================================
[0m
[K[1;36m
	Test Case #1
	__________________________________________________________________________________________
[0m
[K[1;36m
		Running Concrete Execution
		------------------------------------------------------------------------------------------
[0m
[K	[1;37m	[0m[K     [1;37mUsing Arguments: ['$POC', 'foo.tif'][0m
[K	[1;37m	[0m[K     [1;37mUsing Input File: /CrashRepair/experiments/vulnloc/libtiff/CVE-2016-5321/tests/1.tif[0m
[K	[1;34m	building program[0m
[K	[1;34m		setting environment variables[0m
[K	[1;34m		cleaning files[0m
[K	[1;34m		configuring program[0m
[K	[1;34m		compiling program[0m
[K	[1;37m	[0m[K     [1;37mUsing Binary: /data/vulnloc/libtiff/CVE-2016-5321/src/tools/tiffcrop[0m
[K	[1;34m	extracting bytecode[0m
[K	[1;34m	executing klee in concrete mode[0m
[K	[1;34m	extracting instruction trace[0m
[K	[1;37m		[note] program crashed[0m
[K	[1;34m	collecting tainted expressions[0m
[K	[1;34m	collecting tainted concrete values[0m
[K	[1;34m	collecting memory allocations/de-allocations[0m
[K	[1;34m	collecting pointer mapping[0m
[K	[1;34m	extracting crash information[0m
[K	[1;37m		[0m[K     [1;37m[info] crash type: memory read overflow[0m
[K	[1;37m		[0m[K     [1;37m[info] crash location:
                             /data/vulnloc/libtiff/CVE-2016-5321/src/tools/tiffcrop.c:995:43[0m
[K	[1;37m		[0m[K     [1;37m[info] crash function: readSeparateTilesIntoBuffer[0m
[K	[1;37m		[0m[K     [1;37m[info] crash address: 116502[0m
[K	[1;37m		[0m[K     [1;37m[info] crash free constraint: ((8 * @var(integer, s)) < 64)[0m
[K	[1;37m		[0m[K     [1;37m[info] crash inducing variables: s[0m
[K	[1;37m			[info] identified crash type: memory read overflow[0m
[K[1;36m
		Running Concolic Execution
		------------------------------------------------------------------------------------------
[0m
[K	[1;37m	[0m[K     [1;37mUsing Arguments: ['$POC', 'foo.tif'][0m
[K	[1;37m	[0m[K     [1;37mUsing Input File: /CrashRepair/experiments/vulnloc/libtiff/CVE-2016-5321/tests/1.tif[0m
[K	[1;34m	building program[0m
[K	[1;34m		setting environment variables[0m
[K	[1;34m		cleaning files[0m
[K	[1;34m		configuring program[0m
[K	[1;34m		compiling program[0m
[K	[1;34m	extracting bytecode[0m
[K	[1;34m	generating ktest file[0m
[K	[1;34m	executing klee in concolic mode[0m
[K	[1;34m	extracting largest symbolic path[0m
[K	[1;34m	extracting instruction trace[0m
[K	[1;37m		[note] program crashed[0m
[K	[1;34m	collecting tainted expressions[0m
[K	[1;34m	collecting memory allocations/de-allocations[0m
[K	[1;34m	collecting pointer mapping[0m
[K	[1;37m		[0m[K     [1;37m[info] Symbolic Mapping: s -> [][0m
[K[1;36m

	Fix Localization
====================================================================================================
[0m
[K[1;36m
	Generating Fix Locations
	__________________________________________________________________________________________
[0m
[K	[1;34m	generating taint map[0m
[K	[1;37m		[0m[K     [1;37m[info] found 10854 tainted locations[0m
[K	[1;34m		starting parallel computing[0m
[K	[1;34m		waiting for thread completion[0m
[K	[1;37m		[0m[K     [1;37m[info] found 5 source files[0m
[K	[1;37m		[0m[K     [1;37m[info] found 12 executed functions[0m
[K	[1;34m	generating possible fix locations[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] readSeparateTilesIntoBuffer,
                             /data/vulnloc/libtiff/CVE-2016-5321/src/tools/tiffcrop.c:993:35[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] readSeparateTilesIntoBuffer,
                             /data/vulnloc/libtiff/CVE-2016-5321/src/tools/tiffcrop.c:996:28[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] readSeparateTilesIntoBuffer,
                             /data/vulnloc/libtiff/CVE-2016-5321/src/tools/tiffcrop.c:996:21[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] readSeparateTilesIntoBuffer,
                             /data/vulnloc/libtiff/CVE-2016-5321/src/tools/tiffcrop.c:995:24[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] readSeparateTilesIntoBuffer,
                             /data/vulnloc/libtiff/CVE-2016-5321/src/tools/tiffcrop.c:995:26[0m
[K[1;36m
	Localizing Constraints
	__________________________________________________________________________________________
[0m
[K[1;36m
		[fix-loc] /data/vulnloc/libtiff/CVE-2016-5321/src/tools/tiffcrop.c:993:13
		------------------------------------------------------------------------------------------
[0m
[K	[1;37m	[0m[K     [1;37m[constraint] ((8 * @var(integer, s)) < 64)[0m
[K[1;36m
		[fix-loc] /data/vulnloc/libtiff/CVE-2016-5321/src/tools/tiffcrop.c:995:26
		------------------------------------------------------------------------------------------
[0m
[K	[1;37m	[0m[K     [1;37m[constraint] ((8 * @var(integer, s)) < 64)[0m
[K[1;36m
		[fix-loc] /data/vulnloc/libtiff/CVE-2016-5321/src/tools/tiffcrop.c:996:17
		------------------------------------------------------------------------------------------
[0m
[K	[1;37m	[0m[K     [1;37m[constraint] ((8 * @var(integer, s)) < 64)[0m
[K[1;36m
		[fix-loc] /data/vulnloc/libtiff/CVE-2016-5321/src/tools/tiffcrop.c:995:17
		------------------------------------------------------------------------------------------
[0m
[K	[1;37m	[0m[K     [1;37m[constraint] ((8 * @var(integer, s)) < 64)[0m
[K[1;32m
	localization information saved at /CrashRepair/output/libtiff_CVE-2016-5321/localization.json[0m
[K[1;32m
	state values saved at /CrashRepair/output/libtiff_CVE-2016-5321/values/[0m
[K	[1;37m
Run time statistics:
-----------------------
[0m
[K	[1;37mStartup: 0.000 minutes[0m
[K	[1;37mBuild: 0 minutes[0m
[K	[1;37mConcrete Analysis: 0.668 minutes[0m
[K	[1;37mConcolic Analysis: 0.578 minutes[0m
[K	[1;37mTotal Analysis: 1.279 minutes[0m
[K	[1;37mLocalization: 0.301 minutes[0m
[K[1;32m
CRepair finished successfully after 1.623 minutes 
[0m
2025-02-03 22:24:14.537 | WARNING  | analyzer:run:143 - analysis output directory does not exist [/data/vulnloc/libtiff/CVE-2016-5321/analysis]: creating...
2025-02-03 22:24:14.648 | INFO     | scenario:analyze_for_guide:558 - reanalyzing candidate patch: #15:
@@ -948,152 +948,154 @@
   return status;
   }
 
-static int  readSeparateTilesIntoBuffer (TIFF* in, uint8 *obuf, 
-					 uint32 imagelength, uint32 imagewidth, 
+
+static int readSeparateTilesIntoBuffer (TIFF* in, uint8 *obuf, 
+                                         uint32 imagelength, uint32 imagewidth, 
                                          uint32 tw, uint32 tl,
                                          uint16 spp, uint16 bps)
-  {
-  int     i, status = 1, sample;
-  int     shift_width, bytes_per_pixel;
-  uint16  bytes_per_sample;
-  uint32  row, col;     /* Current row and col of image */
-  uint32  nrow, ncol;   /* Number of rows and cols in current tile */
-  uint32  row_offset, col_offset; /* Output buffer offsets */
-  tsize_t tbytes = 0, tilesize = TIFFTileSize(in);
-  tsample_t s;
-  uint8*  bufp = (uint8*)obuf;
-  unsigned char *srcbuffs[MAX_SAMPLES];
-  unsigned char *tbuff = NULL;
+{
+    int     i, status = 1, sample;
+    int     shift_width, bytes_per_pixel;
+    uint16  bytes_per_sample;
+    uint32  row, col;     /* Current row and col of image */
+    uint32  nrow, ncol;   /* Number of rows and cols in current tile */
+    uint32  row_offset, col_offset; /* Output buffer offsets */
+    tsize_t tbytes = 0, tilesize = TIFFTileSize(in);
+    tsample_t s;
+    uint8*  bufp = (uint8*)obuf;
+    unsigned char *srcbuffs[MAX_SAMPLES];
+    unsigned char *tbuff = NULL;
 
-  bytes_per_sample = (bps + 7) / 8;
+    bytes_per_sample = (bps + 7) / 8;
 
-  for (sample = 0; (sample < spp) && (sample < MAX_SAMPLES); sample++)
+    for (sample = 0; (sample < spp) && (sample < MAX_SAMPLES); sample++)
     {
-    srcbuffs[sample] = NULL;
-    tbuff = (unsigned char *)_TIFFmalloc(tilesize + 8);
-    if (!tbuff)
-      {
-      TIFFError ("readSeparateTilesIntoBuffer", 
-                 "Unable to allocate tile read buffer for sample %d", sample);
-      for (i = 0; i < sample; i++)
-        _TIFFfree (srcbuffs[i]);
-      return 0;
-      }
-    srcbuffs[sample] = tbuff;
+        srcbuffs[sample] = NULL;
+        tbuff = (unsigned char *)_TIFFmalloc(tilesize + 8);
+        if (!tbuff)
+        {
+            TIFFError ("readSeparateTilesIntoBuffer", 
+                        "Unable to allocate tile read buffer for sample %d", sample);
+            for (i = 0; i < sample; i++)
+                _TIFFfree (srcbuffs[i]);
+            return 0;
+        }
+        srcbuffs[sample] = tbuff;
     } 
-  /* Each tile contains only the data for a single plane
-   * arranged in scanlines of tw * bytes_per_sample bytes.
-   */
-  for (row = 0; row < imagelength; row += tl)
+
+    for (row = 0; row < imagelength; row += tl)
     {
-    nrow = (row + tl > imagelength) ? imagelength - row : tl;
-    for (col = 0; col < imagewidth; col += tw)
-      {
-      for (s = 0; s < spp; s++)
-        {  /* Read each plane of a tile set into srcbuffs[s] */
-	tbytes = TIFFReadTile(in, srcbuffs[s], col, row, 0, s);
-        if (tbytes < 0  && !ignore)
-          {
-	  TIFFError(TIFFFileName(in),
-                 "Error, can't read tile for row %lu col %lu, "
-		 "sample %lu",
-		 (unsigned long) col, (unsigned long) row,
-		 (unsigned long) s);
-		 status = 0;
-          for (sample = 0; (sample < spp) && (sample < MAX_SAMPLES); sample++)
+        nrow = (row + tl > imagelength) ? imagelength - row : tl;
+        for (col = 0; col < imagewidth; col += tw)
+        {
+            for (s = 0; s < spp; s++)
             {
-            tbuff = srcbuffs[sample];
-            if (tbuff != NULL)
-              _TIFFfree(tbuff);
+                tbytes = TIFFReadTile(in, srcbuffs[s], col, row, 0, s);
+                if (tbytes < 0)
+                {
+                    TIFFError(TIFFFileName(in),
+                              "Error, can't read tile for row %lu col %lu, "
+                              "sample %lu",
+                              (unsigned long) col, (unsigned long) row,
+                              (unsigned long) s);
+                    status = 0;
+                    for (sample = 0; (sample < spp) && (sample < MAX_SAMPLES); sample++)
+                    {
+                        tbuff = srcbuffs[sample];
+                        if (tbuff != NULL)
+                            _TIFFfree(tbuff);
+                    }
+                    return status;
+                }
             }
-          return status;
-	  }
-	}
-     /* Tiles on the right edge may be padded out to tw 
-      * which must be a multiple of 16.
-      * Ncol represents the visible (non padding) portion.  
-      */
-      if (col + tw > imagewidth)
-        ncol = imagewidth - col;
-      else
-        ncol = tw;
-
-      row_offset = row * (((imagewidth * spp * bps) + 7) / 8);
-      col_offset = ((col * spp * bps) + 7) / 8;
-      bufp = obuf + row_offset + col_offset;
 
-      if ((bps % 8) == 0)
-        {
-        if (combineSeparateTileSamplesBytes(srcbuffs, bufp, ncol, nrow, imagewidth,
-					    tw, spp, bps, NULL, 0, 0))
-	  {
-          status = 0;
-          break;
-      	  }
-	}
-      else
-        {
-        bytes_per_pixel  = ((bps * spp) + 7) / 8;
-        if (bytes_per_pixel < (bytes_per_sample + 1))
-          shift_width = bytes_per_pixel;
-        else
-          shift_width = bytes_per_sample + 1;
-
-        switch (shift_width)
-          {
-          case 1: if (combineSeparateTileSamples8bits (srcbuffs, bufp, ncol, nrow,
-                                                       imagewidth, tw, spp, bps, 
-						       NULL, 0, 0))
-	            {
-                    status = 0;
-                    break;
-      	            }
-	          break;
-          case 2: if (combineSeparateTileSamples16bits (srcbuffs, bufp, ncol, nrow,
-                                                       imagewidth, tw, spp, bps, 
-						       NULL, 0, 0))
-	            {
-                    status = 0;
-                    break;
-		    }
-	          break;
-          case 3: if (combineSeparateTileSamples24bits (srcbuffs, bufp, ncol, nrow,
-                                                       imagewidth, tw, spp, bps, 
-						       NULL, 0, 0))
-	            {
-                    status = 0;
-                    break;
-       	            }
-                  break;
-          case 4: 
-          case 5:
-          case 6:
-          case 7:
-          case 8: if (combineSeparateTileSamples32bits (srcbuffs, bufp, ncol, nrow,
-                                                       imagewidth, tw, spp, bps, 
-						       NULL, 0, 0))
-	            {
+            if (col + tw > imagewidth)
+                ncol = imagewidth - col;
+            else
+                ncol = tw;
+
+            row_offset = row * (((imagewidth * spp * bps) + 7) / 8);
+            col_offset = ((col * spp * bps) + 7) / 8;
+            bufp = obuf + row_offset + col_offset;
+
+            if ((bps % 8) == 0)
+            {
+                if (combineSeparateTileSamplesBytes(srcbuffs, bufp, ncol, nrow, imagewidth,
+                                                     tw, spp, bps, NULL, 0, 0))
+                {
                     status = 0;
                     break;
-		    }
-	          break;
-          default: TIFFError ("readSeparateTilesIntoBuffer", "Unsupported bit depth: %d", bps);
-                  status = 0;
-                  break;
-          }
+                }
+            }
+            else
+            {
+                bytes_per_pixel  = ((bps * spp) + 7) / 8;
+                if (bytes_per_pixel < (bytes_per_sample + 1))
+                    shift_width = bytes_per_pixel;
+                else
+                    shift_width = bytes_per_sample + 1;
+
+                switch (shift_width)
+                {
+                    case 1: 
+                        if (combineSeparateTileSamples8bits (srcbuffs, bufp, ncol, nrow,
+                                                             imagewidth, tw, spp, bps, 
+                                                             NULL, 0, 0))
+                        {
+                            status = 0;
+                            break;
+                        }
+                        break;
+                    case 2: 
+                        if (combineSeparateTileSamples16bits (srcbuffs, bufp, ncol, nrow,
+                                                              imagewidth, tw, spp, bps, 
+                                                              NULL, 0, 0))
+                        {
+                            status = 0;
+                            break;
+                        }
+                        break;
+                    case 3: 
+                        if (combineSeparateTileSamples24bits (srcbuffs, bufp, ncol, nrow,
+                                                              imagewidth, tw, spp, bps, 
+                                                              NULL, 0, 0))
+                        {
+                            status = 0;
+                            break;
+                        }
+                        break;
+                    case 4: 
+                    case 5:
+                    case 6:
+                    case 7:
+                    case 8: 
+                        if (combineSeparateTileSamples32bits (srcbuffs, bufp, ncol, nrow,
+                                                              imagewidth, tw, spp, bps, 
+                                                              NULL, 0, 0))
+                        {
+                            status = 0;
+                            break;
+                        }
+                        break;
+                    default: 
+                        TIFFError ("readSeparateTilesIntoBuffer", "Unsupported bit depth: %d", bps);
+                        status = 0;
+                        break;
+                }
+            }
         }
-      }
     }
 
-  for (sample = 0; (sample < spp) && (sample < MAX_SAMPLES); sample++)
+    for (sample = 0; (sample < spp) && (sample < MAX_SAMPLES); sample++)
     {
-    tbuff = srcbuffs[sample];
-    if (tbuff != NULL)
-      _TIFFfree(tbuff);
+        tbuff = srcbuffs[sample];
+        if (tbuff != NULL)
+            _TIFFfree(tbuff);
     }
- 
-  return status;
-  }
+
+    return status;
+}
+
 
 static int writeBufferToContigStrips(TIFF* out, uint8* buf, uint32 imagelength)
   {

2025-02-03 22:24:14.658 | DEBUG    | scenario:rebuild:369 - original environment: environ({'CONDA_SHLVL': '2', 'LC_ALL': 'C.UTF-8', 'LS_COLORS': 'rs=0:di=01;34:ln=01;36:mh=00:pi=40;33:so=01;35:do=01;35:bd=40;33;01:cd=40;33;01:or=40;31;01:mi=00:su=37;41:sg=30;43:ca=30;41:tw=30;42:ow=34;42:st=37;44:ex=01;32:*.tar=01;31:*.tgz=01;31:*.arc=01;31:*.arj=01;31:*.taz=01;31:*.lha=01;31:*.lz4=01;31:*.lzh=01;31:*.lzma=01;31:*.tlz=01;31:*.txz=01;31:*.tzo=01;31:*.t7z=01;31:*.zip=01;31:*.z=01;31:*.Z=01;31:*.dz=01;31:*.gz=01;31:*.lrz=01;31:*.lz=01;31:*.lzo=01;31:*.xz=01;31:*.zst=01;31:*.tzst=01;31:*.bz2=01;31:*.bz=01;31:*.tbz=01;31:*.tbz2=01;31:*.tz=01;31:*.deb=01;31:*.rpm=01;31:*.jar=01;31:*.war=01;31:*.ear=01;31:*.sar=01;31:*.rar=01;31:*.alz=01;31:*.ace=01;31:*.zoo=01;31:*.cpio=01;31:*.7z=01;31:*.rz=01;31:*.cab=01;31:*.wim=01;31:*.swm=01;31:*.dwm=01;31:*.esd=01;31:*.jpg=01;35:*.jpeg=01;35:*.mjpg=01;35:*.mjpeg=01;35:*.gif=01;35:*.bmp=01;35:*.pbm=01;35:*.pgm=01;35:*.ppm=01;35:*.tga=01;35:*.xbm=01;35:*.xpm=01;35:*.tif=01;35:*.tiff=01;35:*.png=01;35:*.svg=01;35:*.svgz=01;35:*.mng=01;35:*.pcx=01;35:*.mov=01;35:*.mpg=01;35:*.mpeg=01;35:*.m2v=01;35:*.mkv=01;35:*.webm=01;35:*.ogm=01;35:*.mp4=01;35:*.m4v=01;35:*.mp4v=01;35:*.vob=01;35:*.qt=01;35:*.nuv=01;35:*.wmv=01;35:*.asf=01;35:*.rm=01;35:*.rmvb=01;35:*.flc=01;35:*.avi=01;35:*.fli=01;35:*.flv=01;35:*.gl=01;35:*.dl=01;35:*.xcf=01;35:*.xwd=01;35:*.yuv=01;35:*.cgm=01;35:*.emf=01;35:*.ogv=01;35:*.ogx=01;35:*.aac=00;36:*.au=00;36:*.flac=00;36:*.m4a=00;36:*.mid=00;36:*.midi=00;36:*.mka=00;36:*.mp3=00;36:*.mpc=00;36:*.ogg=00;36:*.ra=00;36:*.wav=00;36:*.oga=00;36:*.opus=00;36:*.spx=00;36:*.xspf=00;36:', 'LD_LIBRARY_PATH': '/opt/crashrepair/lib:/CrashRepair/lib:/klee/build/lib:', 'CONDA_EXE': '/root/anaconda3/bin/conda', 'LANG': 'C.UTF-8', 'TZ': 'Asia/Shanghai', 'HOSTNAME': 'fea22102047d', 'OLDPWD': '/orchestrator', 'CONDA_PREFIX': '/root/anaconda3/envs/CrashRepair', '_CE_M': '', 'CC': 'crepair-cc', 'LLVM_COMPILER': 'clang', 'CONDA_PREFIX_1': '/root/anaconda3', 'PWD': '/orchestrator/crashrepair', 'HOME': '/root', 'CONDA_PYTHON_EXE': '/root/anaconda3/bin/python', '_CE_CONDA': '', 'CONDA_PROMPT_MODIFIER': '(CrashRepair) ', 'CXX': 'crepair-cxx', 'TERM': 'xterm', 'SHLVL': '2', 'PYTHONPATH': '/usr/lib/python3.8/site-packages:', 'PATH': '/root/anaconda3/envs/CrashRepair/bin:/root/anaconda3/condabin:~/anaconda3/bin:/opt/crashrepair/bin:/CrashRepair/compiler:/klee/build/bin:/opt/llvm-6/bin:/klee/build/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', 'CONDA_DEFAULT_ENV': 'CrashRepair', '_': '/root/anaconda3/envs/CrashRepair/bin/python'})
2025-02-03 22:24:14.658 | DEBUG    | scenario:rebuild:382 - injecting ghost function into CFLAGS during build: -lcrepair_ghost
2025-02-03 22:24:14.658 | DEBUG    | scenario:rebuild:398 - using environment: {'INJECT_CFLAGS': '-g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address', 'INJECT_CXXFLAGS': '-g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address', 'INJECT_LDFLAGS': '-g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address'}
2025-02-03 22:24:14.658 | DEBUG    | shell:__call__:41 - executing: make CFLAGS="${INJECT_CFLAGS}" CXXFLAGS="${INJECT_CXXFLAGS}" LDFLAGS="${INJECT_LDFLAGS}"
Making all in port
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/port'
make[1]: Nothing to be done for 'all'.
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/port'
Making all in libtiff
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/libtiff'
make  all-am
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/libtiff'
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/libtiff'
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/libtiff'
Making all in tools
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/tools'
crepair-cc -DHAVE_CONFIG_H -I. -I../libtiff  -I../libtiff   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -MT tiffcrop.o -MD -MP -MF .deps/tiffcrop.Tpo -c -o tiffcrop.o tiffcrop.c
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_ghost: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
mv -f .deps/tiffcrop.Tpo .deps/tiffcrop.Po
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address  -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -o tiffcrop tiffcrop.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -g -O0 -Wno-error -I/CrashRepair/lib -fsanitize=address -g -O0 -Wno-error -I/CrashRepair/lib -fsanitize=address -o tiffcrop tiffcrop.o  -L/klee/build/lib -L/CrashRepair/lib -lkleeRuntest -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost ../libtiff/.libs/libtiff.a ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/tools'
Making all in build
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/build'
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/build'
make[2]: Nothing to be done for 'all-am'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/build'
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/build'
Making all in contrib
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib'
Making all in addtiffo
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/addtiffo'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/addtiffo'
Making all in dbs
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/dbs'
Making all in xtiff
make[3]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/dbs/xtiff'
make[3]: Nothing to be done for 'all'.
make[3]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/dbs/xtiff'
make[3]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/dbs'
make[3]: Nothing to be done for 'all-am'.
make[3]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/dbs'
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/dbs'
Making all in iptcutil
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/iptcutil'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/iptcutil'
Making all in mfs
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/mfs'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/mfs'
Making all in pds
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/pds'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/pds'
Making all in ras
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/ras'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/ras'
Making all in stream
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/stream'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/stream'
Making all in tags
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/tags'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/tags'
Making all in win_dib
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/win_dib'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/win_dib'
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib'
make[2]: Nothing to be done for 'all-am'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib'
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib'
Making all in test
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/test'
make[1]: Nothing to be done for 'all'.
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/test'
Making all in man
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/man'
make[1]: Nothing to be done for 'all'.
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/man'
Making all in html
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html'
Making all in images
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html/images'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html/images'
Making all in man
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html/man'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html/man'
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html'
make[2]: Nothing to be done for 'all-am'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html'
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html'
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src'
make[1]: Nothing to be done for 'all-am'.
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src'
2025-02-03 22:24:15.146 | INFO     | analyzer:run:114 - running analysis with timeout: 60 minutes
2025-02-03 22:24:15.146 | DEBUG    | analyzer:write_config_to_file:88 - generated analyzer config:

dir_exp:/data/vulnloc/libtiff/CVE-2016-5321
tag_id:libtiff_CVE-2016-5321
src_directory:/data/vulnloc/libtiff/CVE-2016-5321/src
binary_path:/data/vulnloc/libtiff/CVE-2016-5321/src/tools/tiffcrop
config_command:./configure --enable-static --disable-shared
build_command:make CFLAGS="${INJECT_CFLAGS}" CXXFLAGS="${INJECT_CXXFLAGS}" LDFLAGS="${INJECT_LDFLAGS}"
test_input_list:$POC foo.tif
poc_list:/CrashRepair/experiments/vulnloc/libtiff/CVE-2016-5321/tests/1.tif
klee_flags:--link-llvm-lib=/CrashRepair/lib/libcrepair_proxy.bca 

2025-02-03 22:24:15.146 | DEBUG    | analyzer:run:124 - wrote analyzer config file to: /tmp/tmp71y7crkw
2025-02-03 22:24:15.146 | DEBUG    | shell:__call__:41 - executing: crepair --conf=/tmp/tmp71y7crkw
[K[1;36m
====================================================================================================

	Starting CRepair (C Crash Repair) 
====================================================================================================
[0m
[K[1;36m
	Loading Configurations
	__________________________________________________________________________________________
[0m
[K	[1;34mreading configuration values from arguments[0m
[K	[1;34mreading configuration values form configuration file[0m
[K	[1;37m	[file] /tmp/tmp71y7crkw[0m
[K	[1;34mupdating configuration values[0m
[K	[1;34mreading test configuration[0m
[K	[1;34mreading seed information[0m
[K	[1;37m	[config] stack size: 15000[0m
[K	[1;37m	[config] collecting stats: False[0m
[K	[1;37m	[config] number of tests: 1[0m
[K	[1;37m	[config] number of cores: 8[0m
[K	[1;37m	[config] klee concrete execution timeout: 600[0m
[K	[1;37m	[config] klee concolic execution timeout: 1200[0m
[K	[1;37m	[config] synthesize subset expressions: True[0m
[K	[1;37m	[config] window size for taint locations: 500[0m
[K	[1;37m	[config] window size for taint values: 500000[0m
[K[1;36m

	Analyzing Program
====================================================================================================
[0m
[K[1;36m
	Test Case #1
	__________________________________________________________________________________________
[0m
[K[1;36m
		Running Concrete Execution
		------------------------------------------------------------------------------------------
[0m
[K	[1;37m	[0m[K     [1;37mUsing Arguments: ['$POC', 'foo.tif'][0m
[K	[1;37m	[0m[K     [1;37mUsing Input File: /CrashRepair/experiments/vulnloc/libtiff/CVE-2016-5321/tests/1.tif[0m
[K	[1;34m	building program[0m
[K	[1;34m		setting environment variables[0m
[K	[1;34m		cleaning files[0m
[K	[1;34m		configuring program[0m
[K	[1;34m		compiling program[0m
[K	[1;37m	[0m[K     [1;37mUsing Binary: /data/vulnloc/libtiff/CVE-2016-5321/src/tools/tiffcrop[0m
[K	[1;34m	extracting bytecode[0m
[K	[1;34m	executing klee in concrete mode[0m
[K	[1;34m	extracting instruction trace[0m
[K	[1;37m		[note] program crashed[0m
[K	[1;34m	collecting tainted expressions[0m
[K	[1;34m	collecting tainted concrete values[0m
[K	[1;34m	collecting memory allocations/de-allocations[0m
[K	[1;34m	collecting pointer mapping[0m
[K	[1;34m	extracting crash information[0m
[K	[1;37m		[0m[K     [1;37m[info] crash type: memory read overflow[0m
[K	[1;37m		[0m[K     [1;37m[info] crash location:
                             /data/vulnloc/libtiff/CVE-2016-5321/src/tools/tiffcrop.c:993:43[0m
[K	[1;37m		[0m[K     [1;37m[info] crash function: readSeparateTilesIntoBuffer[0m
[K	[1;37m		[0m[K     [1;37m[info] crash address: 116502[0m
[K	[1;37m		[0m[K     [1;37m[info] crash free constraint: ((8 * @var(integer, s)) < 64)[0m
[K	[1;37m		[0m[K     [1;37m[info] crash inducing variables: s[0m
[K	[1;37m			[info] identified crash type: memory read overflow[0m
[K[1;36m
		Running Concolic Execution
		------------------------------------------------------------------------------------------
[0m
[K	[1;37m	[0m[K     [1;37mUsing Arguments: ['$POC', 'foo.tif'][0m
[K	[1;37m	[0m[K     [1;37mUsing Input File: /CrashRepair/experiments/vulnloc/libtiff/CVE-2016-5321/tests/1.tif[0m
[K	[1;34m	building program[0m
[K	[1;34m		setting environment variables[0m
[K	[1;34m		cleaning files[0m
[K	[1;34m		configuring program[0m
[K	[1;34m		compiling program[0m
[K	[1;34m	extracting bytecode[0m
[K	[1;34m	generating ktest file[0m
[K	[1;34m	executing klee in concolic mode[0m
[K	[1;34m	extracting largest symbolic path[0m
[K	[1;34m	extracting instruction trace[0m
[K	[1;37m		[note] program crashed[0m
[K	[1;34m	collecting tainted expressions[0m
[K	[1;34m	collecting memory allocations/de-allocations[0m
[K	[1;34m	collecting pointer mapping[0m
[K	[1;37m		[0m[K     [1;37m[info] Symbolic Mapping: s -> [][0m
[K[1;36m

	Fix Localization
====================================================================================================
[0m
[K[1;36m
	Generating Fix Locations
	__________________________________________________________________________________________
[0m
[K	[1;34m	generating taint map[0m
[K	[1;37m		[0m[K     [1;37m[info] found 10854 tainted locations[0m
[K	[1;34m		starting parallel computing[0m
[K	[1;34m		waiting for thread completion[0m
[K	[1;37m		[0m[K     [1;37m[info] found 5 source files[0m
[K	[1;37m		[0m[K     [1;37m[info] found 12 executed functions[0m
[K	[1;34m	generating possible fix locations[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] readSeparateTilesIntoBuffer,
                             /data/vulnloc/libtiff/CVE-2016-5321/src/tools/tiffcrop.c:991:35[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] readSeparateTilesIntoBuffer,
                             /data/vulnloc/libtiff/CVE-2016-5321/src/tools/tiffcrop.c:994:28[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] readSeparateTilesIntoBuffer,
                             /data/vulnloc/libtiff/CVE-2016-5321/src/tools/tiffcrop.c:994:21[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] readSeparateTilesIntoBuffer,
                             /data/vulnloc/libtiff/CVE-2016-5321/src/tools/tiffcrop.c:993:24[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] readSeparateTilesIntoBuffer,
                             /data/vulnloc/libtiff/CVE-2016-5321/src/tools/tiffcrop.c:993:26[0m
[K[1;36m
	Localizing Constraints
	__________________________________________________________________________________________
[0m
[K[1;36m
		[fix-loc] /data/vulnloc/libtiff/CVE-2016-5321/src/tools/tiffcrop.c:991:13
		------------------------------------------------------------------------------------------
[0m
[K	[1;37m	[0m[K     [1;37m[constraint] ((8 * @var(integer, s)) < 64)[0m
[K[1;36m
		[fix-loc] /data/vulnloc/libtiff/CVE-2016-5321/src/tools/tiffcrop.c:993:26
		------------------------------------------------------------------------------------------
[0m
[K	[1;37m	[0m[K     [1;37m[constraint] ((8 * @var(integer, s)) < 64)[0m
[K[1;36m
		[fix-loc] /data/vulnloc/libtiff/CVE-2016-5321/src/tools/tiffcrop.c:994:17
		------------------------------------------------------------------------------------------
[0m
[K	[1;37m	[0m[K     [1;37m[constraint] ((8 * @var(integer, s)) < 64)[0m
[K[1;36m
		[fix-loc] /data/vulnloc/libtiff/CVE-2016-5321/src/tools/tiffcrop.c:993:17
		------------------------------------------------------------------------------------------
[0m
[K	[1;37m	[0m[K     [1;37m[constraint] ((8 * @var(integer, s)) < 64)[0m
[K[1;32m
	localization information saved at /CrashRepair/output/libtiff_CVE-2016-5321/localization.json[0m
[K[1;32m
	state values saved at /CrashRepair/output/libtiff_CVE-2016-5321/values/[0m
[K	[1;37m
Run time statistics:
-----------------------
[0m
[K	[1;37mStartup: 0.000 minutes[0m
[K	[1;37mBuild: 0 minutes[0m
[K	[1;37mConcrete Analysis: 0.666 minutes[0m
[K	[1;37mConcolic Analysis: 0.586 minutes[0m
[K	[1;37mTotal Analysis: 1.284 minutes[0m
[K	[1;37mLocalization: 0.294 minutes[0m
[K[1;32m
CRepair finished successfully after 1.617 minutes 
[0m
2025-02-03 22:25:53.087 | WARNING  | analyzer:run:143 - analysis output directory does not exist [/data/vulnloc/libtiff/CVE-2016-5321/analysis]: creating...
2025-02-03 22:25:53.197 | INFO     | scenario:analyze_for_guide:558 - reanalyzing candidate patch: #16:
@@ -948,11 +948,12 @@
   return status;
   }
 
-static int  readSeparateTilesIntoBuffer (TIFF* in, uint8 *obuf, 
-					 uint32 imagelength, uint32 imagewidth, 
+
+static int readSeparateTilesIntoBuffer (TIFF* in, uint8 *obuf, 
+                                         uint32 imagelength, uint32 imagewidth, 
                                          uint32 tw, uint32 tl,
                                          uint16 spp, uint16 bps)
-  {
+{
   int     i, status = 1, sample;
   int     shift_width, bytes_per_pixel;
   uint16  bytes_per_sample;
@@ -968,51 +969,51 @@
   bytes_per_sample = (bps + 7) / 8;
 
   for (sample = 0; (sample < spp) && (sample < MAX_SAMPLES); sample++)
-    {
+  {
     srcbuffs[sample] = NULL;
     tbuff = (unsigned char *)_TIFFmalloc(tilesize + 8);
     if (!tbuff)
-      {
+    {
       TIFFError ("readSeparateTilesIntoBuffer", 
                  "Unable to allocate tile read buffer for sample %d", sample);
       for (i = 0; i < sample; i++)
         _TIFFfree (srcbuffs[i]);
       return 0;
-      }
+    }
     srcbuffs[sample] = tbuff;
-    } 
+  } 
   /* Each tile contains only the data for a single plane
    * arranged in scanlines of tw * bytes_per_sample bytes.
    */
   for (row = 0; row < imagelength; row += tl)
-    {
+  {
     nrow = (row + tl > imagelength) ? imagelength - row : tl;
     for (col = 0; col < imagewidth; col += tw)
-      {
+    {
       for (s = 0; s < spp; s++)
-        {  /* Read each plane of a tile set into srcbuffs[s] */
-	tbytes = TIFFReadTile(in, srcbuffs[s], col, row, 0, s);
-        if (tbytes < 0  && !ignore)
-          {
-	  TIFFError(TIFFFileName(in),
+      {  
+        tbytes = TIFFReadTile(in, srcbuffs[s], col, row, 0, s);
+        if (tbytes == (tsize_t)-1  && !ignore)  // Change to check for -1 instead of < 0
+        {
+          TIFFError(TIFFFileName(in),
                  "Error, can't read tile for row %lu col %lu, "
-		 "sample %lu",
-		 (unsigned long) col, (unsigned long) row,
-		 (unsigned long) s);
-		 status = 0;
+                 "sample %lu",
+                 (unsigned long) col, (unsigned long) row,
+                 (unsigned long) s);
+          status = 0;
           for (sample = 0; (sample < spp) && (sample < MAX_SAMPLES); sample++)
-            {
+          {
             tbuff = srcbuffs[sample];
             if (tbuff != NULL)
               _TIFFfree(tbuff);
-            }
+          }
           return status;
-	  }
-	}
-     /* Tiles on the right edge may be padded out to tw 
-      * which must be a multiple of 16.
-      * Ncol represents the visible (non padding) portion.  
-      */
+        }
+      }
+      /* Tiles on the right edge may be padded out to tw 
+       * which must be a multiple of 16.
+       * Ncol represents the visible (non padding) portion.  
+       */
       if (col + tw > imagewidth)
         ncol = imagewidth - col;
       else
@@ -1023,16 +1024,16 @@
       bufp = obuf + row_offset + col_offset;
 
       if ((bps % 8) == 0)
-        {
+      {
         if (combineSeparateTileSamplesBytes(srcbuffs, bufp, ncol, nrow, imagewidth,
-					    tw, spp, bps, NULL, 0, 0))
-	  {
+                                            tw, spp, bps, NULL, 0, 0))
+        {
           status = 0;
           break;
-      	  }
-	}
+        }
+      }
       else
-        {
+      {
         bytes_per_pixel  = ((bps * spp) + 7) / 8;
         if (bytes_per_pixel < (bytes_per_sample + 1))
           shift_width = bytes_per_pixel;
@@ -1040,30 +1041,30 @@
           shift_width = bytes_per_sample + 1;
 
         switch (shift_width)
-          {
+        {
           case 1: if (combineSeparateTileSamples8bits (srcbuffs, bufp, ncol, nrow,
                                                        imagewidth, tw, spp, bps, 
-						       NULL, 0, 0))
-	            {
+                                                       NULL, 0, 0))
+                  {
                     status = 0;
                     break;
-      	            }
-	          break;
+                  }
+                  break;
           case 2: if (combineSeparateTileSamples16bits (srcbuffs, bufp, ncol, nrow,
                                                        imagewidth, tw, spp, bps, 
-						       NULL, 0, 0))
-	            {
+                                                       NULL, 0, 0))
+                  {
                     status = 0;
                     break;
-		    }
-	          break;
+                  }
+                  break;
           case 3: if (combineSeparateTileSamples24bits (srcbuffs, bufp, ncol, nrow,
                                                        imagewidth, tw, spp, bps, 
-						       NULL, 0, 0))
-	            {
+                                                       NULL, 0, 0))
+                  {
                     status = 0;
                     break;
-       	            }
+                  }
                   break;
           case 4: 
           case 5:
@@ -1071,29 +1072,30 @@
           case 7:
           case 8: if (combineSeparateTileSamples32bits (srcbuffs, bufp, ncol, nrow,
                                                        imagewidth, tw, spp, bps, 
-						       NULL, 0, 0))
-	            {
+                                                       NULL, 0, 0))
+                  {
                     status = 0;
                     break;
-		    }
-	          break;
+                  }
+                  break;
           default: TIFFError ("readSeparateTilesIntoBuffer", "Unsupported bit depth: %d", bps);
                   status = 0;
                   break;
-          }
         }
       }
     }
+  }
 
   for (sample = 0; (sample < spp) && (sample < MAX_SAMPLES); sample++)
-    {
+  {
     tbuff = srcbuffs[sample];
     if (tbuff != NULL)
       _TIFFfree(tbuff);
-    }
+  }
  
   return status;
-  }
+}
+
 
 static int writeBufferToContigStrips(TIFF* out, uint8* buf, uint32 imagelength)
   {

2025-02-03 22:25:53.204 | DEBUG    | scenario:rebuild:369 - original environment: environ({'CONDA_SHLVL': '2', 'LC_ALL': 'C.UTF-8', 'LS_COLORS': 'rs=0:di=01;34:ln=01;36:mh=00:pi=40;33:so=01;35:do=01;35:bd=40;33;01:cd=40;33;01:or=40;31;01:mi=00:su=37;41:sg=30;43:ca=30;41:tw=30;42:ow=34;42:st=37;44:ex=01;32:*.tar=01;31:*.tgz=01;31:*.arc=01;31:*.arj=01;31:*.taz=01;31:*.lha=01;31:*.lz4=01;31:*.lzh=01;31:*.lzma=01;31:*.tlz=01;31:*.txz=01;31:*.tzo=01;31:*.t7z=01;31:*.zip=01;31:*.z=01;31:*.Z=01;31:*.dz=01;31:*.gz=01;31:*.lrz=01;31:*.lz=01;31:*.lzo=01;31:*.xz=01;31:*.zst=01;31:*.tzst=01;31:*.bz2=01;31:*.bz=01;31:*.tbz=01;31:*.tbz2=01;31:*.tz=01;31:*.deb=01;31:*.rpm=01;31:*.jar=01;31:*.war=01;31:*.ear=01;31:*.sar=01;31:*.rar=01;31:*.alz=01;31:*.ace=01;31:*.zoo=01;31:*.cpio=01;31:*.7z=01;31:*.rz=01;31:*.cab=01;31:*.wim=01;31:*.swm=01;31:*.dwm=01;31:*.esd=01;31:*.jpg=01;35:*.jpeg=01;35:*.mjpg=01;35:*.mjpeg=01;35:*.gif=01;35:*.bmp=01;35:*.pbm=01;35:*.pgm=01;35:*.ppm=01;35:*.tga=01;35:*.xbm=01;35:*.xpm=01;35:*.tif=01;35:*.tiff=01;35:*.png=01;35:*.svg=01;35:*.svgz=01;35:*.mng=01;35:*.pcx=01;35:*.mov=01;35:*.mpg=01;35:*.mpeg=01;35:*.m2v=01;35:*.mkv=01;35:*.webm=01;35:*.ogm=01;35:*.mp4=01;35:*.m4v=01;35:*.mp4v=01;35:*.vob=01;35:*.qt=01;35:*.nuv=01;35:*.wmv=01;35:*.asf=01;35:*.rm=01;35:*.rmvb=01;35:*.flc=01;35:*.avi=01;35:*.fli=01;35:*.flv=01;35:*.gl=01;35:*.dl=01;35:*.xcf=01;35:*.xwd=01;35:*.yuv=01;35:*.cgm=01;35:*.emf=01;35:*.ogv=01;35:*.ogx=01;35:*.aac=00;36:*.au=00;36:*.flac=00;36:*.m4a=00;36:*.mid=00;36:*.midi=00;36:*.mka=00;36:*.mp3=00;36:*.mpc=00;36:*.ogg=00;36:*.ra=00;36:*.wav=00;36:*.oga=00;36:*.opus=00;36:*.spx=00;36:*.xspf=00;36:', 'LD_LIBRARY_PATH': '/opt/crashrepair/lib:/CrashRepair/lib:/klee/build/lib:', 'CONDA_EXE': '/root/anaconda3/bin/conda', 'LANG': 'C.UTF-8', 'TZ': 'Asia/Shanghai', 'HOSTNAME': 'fea22102047d', 'OLDPWD': '/orchestrator', 'CONDA_PREFIX': '/root/anaconda3/envs/CrashRepair', '_CE_M': '', 'CC': 'crepair-cc', 'LLVM_COMPILER': 'clang', 'CONDA_PREFIX_1': '/root/anaconda3', 'PWD': '/orchestrator/crashrepair', 'HOME': '/root', 'CONDA_PYTHON_EXE': '/root/anaconda3/bin/python', '_CE_CONDA': '', 'CONDA_PROMPT_MODIFIER': '(CrashRepair) ', 'CXX': 'crepair-cxx', 'TERM': 'xterm', 'SHLVL': '2', 'PYTHONPATH': '/usr/lib/python3.8/site-packages:', 'PATH': '/root/anaconda3/envs/CrashRepair/bin:/root/anaconda3/condabin:~/anaconda3/bin:/opt/crashrepair/bin:/CrashRepair/compiler:/klee/build/bin:/opt/llvm-6/bin:/klee/build/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', 'CONDA_DEFAULT_ENV': 'CrashRepair', '_': '/root/anaconda3/envs/CrashRepair/bin/python'})
2025-02-03 22:25:53.204 | DEBUG    | scenario:rebuild:382 - injecting ghost function into CFLAGS during build: -lcrepair_ghost
2025-02-03 22:25:53.204 | DEBUG    | scenario:rebuild:398 - using environment: {'INJECT_CFLAGS': '-g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address', 'INJECT_CXXFLAGS': '-g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address', 'INJECT_LDFLAGS': '-g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address'}
2025-02-03 22:25:53.204 | DEBUG    | shell:__call__:41 - executing: make CFLAGS="${INJECT_CFLAGS}" CXXFLAGS="${INJECT_CXXFLAGS}" LDFLAGS="${INJECT_LDFLAGS}"
Making all in port
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/port'
make[1]: Nothing to be done for 'all'.
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/port'
Making all in libtiff
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/libtiff'
make  all-am
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/libtiff'
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/libtiff'
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/libtiff'
Making all in tools
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/tools'
crepair-cc -DHAVE_CONFIG_H -I. -I../libtiff  -I../libtiff   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -MT tiffcrop.o -MD -MP -MF .deps/tiffcrop.Tpo -c -o tiffcrop.o tiffcrop.c
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_ghost: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
mv -f .deps/tiffcrop.Tpo .deps/tiffcrop.Po
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address  -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -o tiffcrop tiffcrop.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -g -O0 -Wno-error -I/CrashRepair/lib -fsanitize=address -g -O0 -Wno-error -I/CrashRepair/lib -fsanitize=address -o tiffcrop tiffcrop.o  -L/klee/build/lib -L/CrashRepair/lib -lkleeRuntest -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost ../libtiff/.libs/libtiff.a ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/tools'
Making all in build
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/build'
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/build'
make[2]: Nothing to be done for 'all-am'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/build'
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/build'
Making all in contrib
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib'
Making all in addtiffo
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/addtiffo'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/addtiffo'
Making all in dbs
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/dbs'
Making all in xtiff
make[3]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/dbs/xtiff'
make[3]: Nothing to be done for 'all'.
make[3]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/dbs/xtiff'
make[3]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/dbs'
make[3]: Nothing to be done for 'all-am'.
make[3]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/dbs'
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/dbs'
Making all in iptcutil
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/iptcutil'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/iptcutil'
Making all in mfs
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/mfs'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/mfs'
Making all in pds
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/pds'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/pds'
Making all in ras
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/ras'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/ras'
Making all in stream
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/stream'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/stream'
Making all in tags
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/tags'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/tags'
Making all in win_dib
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/win_dib'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/win_dib'
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib'
make[2]: Nothing to be done for 'all-am'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib'
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib'
Making all in test
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/test'
make[1]: Nothing to be done for 'all'.
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/test'
Making all in man
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/man'
make[1]: Nothing to be done for 'all'.
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/man'
Making all in html
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html'
Making all in images
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html/images'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html/images'
Making all in man
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html/man'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html/man'
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html'
make[2]: Nothing to be done for 'all-am'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html'
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html'
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src'
make[1]: Nothing to be done for 'all-am'.
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src'
2025-02-03 22:25:53.680 | INFO     | analyzer:run:114 - running analysis with timeout: 60 minutes
2025-02-03 22:25:53.680 | DEBUG    | analyzer:write_config_to_file:88 - generated analyzer config:

dir_exp:/data/vulnloc/libtiff/CVE-2016-5321
tag_id:libtiff_CVE-2016-5321
src_directory:/data/vulnloc/libtiff/CVE-2016-5321/src
binary_path:/data/vulnloc/libtiff/CVE-2016-5321/src/tools/tiffcrop
config_command:./configure --enable-static --disable-shared
build_command:make CFLAGS="${INJECT_CFLAGS}" CXXFLAGS="${INJECT_CXXFLAGS}" LDFLAGS="${INJECT_LDFLAGS}"
test_input_list:$POC foo.tif
poc_list:/CrashRepair/experiments/vulnloc/libtiff/CVE-2016-5321/tests/1.tif
klee_flags:--link-llvm-lib=/CrashRepair/lib/libcrepair_proxy.bca 

2025-02-03 22:25:53.680 | DEBUG    | analyzer:run:124 - wrote analyzer config file to: /tmp/tmptlykcj9b
2025-02-03 22:25:53.681 | DEBUG    | shell:__call__:41 - executing: crepair --conf=/tmp/tmptlykcj9b
[K[1;36m
====================================================================================================

	Starting CRepair (C Crash Repair) 
====================================================================================================
[0m
[K[1;36m
	Loading Configurations
	__________________________________________________________________________________________
[0m
[K	[1;34mreading configuration values from arguments[0m
[K	[1;34mreading configuration values form configuration file[0m
[K	[1;37m	[file] /tmp/tmptlykcj9b[0m
[K	[1;34mupdating configuration values[0m
[K	[1;34mreading test configuration[0m
[K	[1;34mreading seed information[0m
[K	[1;37m	[config] stack size: 15000[0m
[K	[1;37m	[config] collecting stats: False[0m
[K	[1;37m	[config] number of tests: 1[0m
[K	[1;37m	[config] number of cores: 8[0m
[K	[1;37m	[config] klee concrete execution timeout: 600[0m
[K	[1;37m	[config] klee concolic execution timeout: 1200[0m
[K	[1;37m	[config] synthesize subset expressions: True[0m
[K	[1;37m	[config] window size for taint locations: 500[0m
[K	[1;37m	[config] window size for taint values: 500000[0m
[K[1;36m

	Analyzing Program
====================================================================================================
[0m
[K[1;36m
	Test Case #1
	__________________________________________________________________________________________
[0m
[K[1;36m
		Running Concrete Execution
		------------------------------------------------------------------------------------------
[0m
[K	[1;37m	[0m[K     [1;37mUsing Arguments: ['$POC', 'foo.tif'][0m
[K	[1;37m	[0m[K     [1;37mUsing Input File: /CrashRepair/experiments/vulnloc/libtiff/CVE-2016-5321/tests/1.tif[0m
[K	[1;34m	building program[0m
[K	[1;34m		setting environment variables[0m
[K	[1;34m		cleaning files[0m
[K	[1;34m		configuring program[0m
[K	[1;34m		compiling program[0m
[K	[1;37m	[0m[K     [1;37mUsing Binary: /data/vulnloc/libtiff/CVE-2016-5321/src/tools/tiffcrop[0m
[K	[1;34m	extracting bytecode[0m
[K	[1;34m	executing klee in concrete mode[0m
[K	[1;34m	extracting instruction trace[0m
[K	[1;37m		[note] program crashed[0m
[K	[1;34m	collecting tainted expressions[0m
[K	[1;34m	collecting tainted concrete values[0m
[K	[1;34m	collecting memory allocations/de-allocations[0m
[K	[1;34m	collecting pointer mapping[0m
[K	[1;34m	extracting crash information[0m
[K	[1;37m		[0m[K     [1;37m[info] crash type: memory read overflow[0m
[K	[1;37m		[0m[K     [1;37m[info] crash location:
                             /data/vulnloc/libtiff/CVE-2016-5321/src/tools/tiffcrop.c:995:35[0m
[K	[1;37m		[0m[K     [1;37m[info] crash function: readSeparateTilesIntoBuffer[0m
[K	[1;37m		[0m[K     [1;37m[info] crash address: 116502[0m
[K	[1;37m		[0m[K     [1;37m[info] crash free constraint: ((8 * @var(integer, s)) < 64)[0m
[K	[1;37m		[0m[K     [1;37m[info] crash inducing variables: s[0m
[K	[1;37m			[info] identified crash type: memory read overflow[0m
[K[1;36m
		Running Concolic Execution
		------------------------------------------------------------------------------------------
[0m
[K	[1;37m	[0m[K     [1;37mUsing Arguments: ['$POC', 'foo.tif'][0m
[K	[1;37m	[0m[K     [1;37mUsing Input File: /CrashRepair/experiments/vulnloc/libtiff/CVE-2016-5321/tests/1.tif[0m
[K	[1;34m	building program[0m
[K	[1;34m		setting environment variables[0m
[K	[1;34m		cleaning files[0m
[K	[1;34m		configuring program[0m
[K	[1;34m		compiling program[0m
[K	[1;34m	extracting bytecode[0m
[K	[1;34m	generating ktest file[0m
[K	[1;34m	executing klee in concolic mode[0m
[K	[1;34m	extracting largest symbolic path[0m
[K	[1;34m	extracting instruction trace[0m
[K	[1;37m		[note] program crashed[0m
[K	[1;34m	collecting tainted expressions[0m
[K	[1;34m	collecting memory allocations/de-allocations[0m
[K	[1;34m	collecting pointer mapping[0m
[K	[1;37m		[0m[K     [1;37m[info] Symbolic Mapping: s -> [][0m
[K[1;36m

	Fix Localization
====================================================================================================
[0m
[K[1;36m
	Generating Fix Locations
	__________________________________________________________________________________________
[0m
[K	[1;34m	generating taint map[0m
[K	[1;37m		[0m[K     [1;37m[info] found 10854 tainted locations[0m
[K	[1;34m		starting parallel computing[0m
[K	[1;34m		waiting for thread completion[0m
[K	[1;37m		[0m[K     [1;37m[info] found 5 source files[0m
[K	[1;37m		[0m[K     [1;37m[info] found 12 executed functions[0m
[K	[1;34m	generating possible fix locations[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] readSeparateTilesIntoBuffer,
                             /data/vulnloc/libtiff/CVE-2016-5321/src/tools/tiffcrop.c:993:29[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] readSeparateTilesIntoBuffer,
                             /data/vulnloc/libtiff/CVE-2016-5321/src/tools/tiffcrop.c:996:20[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] readSeparateTilesIntoBuffer,
                             /data/vulnloc/libtiff/CVE-2016-5321/src/tools/tiffcrop.c:996:13[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] readSeparateTilesIntoBuffer,
                             /data/vulnloc/libtiff/CVE-2016-5321/src/tools/tiffcrop.c:995:16[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] readSeparateTilesIntoBuffer,
                             /data/vulnloc/libtiff/CVE-2016-5321/src/tools/tiffcrop.c:995:18[0m
[K[1;36m
	Localizing Constraints
	__________________________________________________________________________________________
[0m
[K[1;36m
		[fix-loc] /data/vulnloc/libtiff/CVE-2016-5321/src/tools/tiffcrop.c:993:7
		------------------------------------------------------------------------------------------
[0m
[K	[1;37m	[0m[K     [1;37m[constraint] ((8 * @var(integer, s)) < 64)[0m
[K[1;36m
		[fix-loc] /data/vulnloc/libtiff/CVE-2016-5321/src/tools/tiffcrop.c:995:18
		------------------------------------------------------------------------------------------
[0m
[K	[1;37m	[0m[K     [1;37m[constraint] ((8 * @var(integer, s)) < 64)[0m
[K[1;36m
		[fix-loc] /data/vulnloc/libtiff/CVE-2016-5321/src/tools/tiffcrop.c:996:9
		------------------------------------------------------------------------------------------
[0m
[K	[1;37m	[0m[K     [1;37m[constraint] ((8 * @var(integer, s)) < 64)[0m
[K[1;36m
		[fix-loc] /data/vulnloc/libtiff/CVE-2016-5321/src/tools/tiffcrop.c:995:9
		------------------------------------------------------------------------------------------
[0m
[K	[1;37m	[0m[K     [1;37m[constraint] ((8 * @var(integer, s)) < 64)[0m
[K[1;32m
	localization information saved at /CrashRepair/output/libtiff_CVE-2016-5321/localization.json[0m
[K[1;32m
	state values saved at /CrashRepair/output/libtiff_CVE-2016-5321/values/[0m
[K	[1;37m
Run time statistics:
-----------------------
[0m
[K	[1;37mStartup: 0.000 minutes[0m
[K	[1;37mBuild: 0 minutes[0m
[K	[1;37mConcrete Analysis: 0.666 minutes[0m
[K	[1;37mConcolic Analysis: 0.582 minutes[0m
[K	[1;37mTotal Analysis: 1.281 minutes[0m
[K	[1;37mLocalization: 0.293 minutes[0m
[K[1;32m
CRepair finished successfully after 1.615 minutes 
[0m
2025-02-03 22:27:31.582 | WARNING  | analyzer:run:143 - analysis output directory does not exist [/data/vulnloc/libtiff/CVE-2016-5321/analysis]: creating...
2025-02-03 22:27:31.693 | INFO     | scenario:analyze_for_guide:558 - reanalyzing candidate patch: #17:
@@ -948,152 +948,149 @@
   return status;
   }
 
-static int  readSeparateTilesIntoBuffer (TIFF* in, uint8 *obuf, 
-					 uint32 imagelength, uint32 imagewidth, 
+
+static int readSeparateTilesIntoBuffer (TIFF* in, uint8 *obuf, 
+                                         uint32 imagelength, uint32 imagewidth, 
                                          uint32 tw, uint32 tl,
                                          uint16 spp, uint16 bps)
-  {
-  int     i, status = 1, sample;
-  int     shift_width, bytes_per_pixel;
-  uint16  bytes_per_sample;
-  uint32  row, col;     /* Current row and col of image */
-  uint32  nrow, ncol;   /* Number of rows and cols in current tile */
-  uint32  row_offset, col_offset; /* Output buffer offsets */
-  tsize_t tbytes = 0, tilesize = TIFFTileSize(in);
-  tsample_t s;
-  uint8*  bufp = (uint8*)obuf;
-  unsigned char *srcbuffs[MAX_SAMPLES];
-  unsigned char *tbuff = NULL;
+{
+    int     i, status = 1, sample;
+    int     shift_width, bytes_per_pixel;
+    uint16  bytes_per_sample;
+    uint32  row, col;     /* Current row and col of image */
+    uint32  nrow, ncol;   /* Number of rows and cols in current tile */
+    uint32  row_offset, col_offset; /* Output buffer offsets */
+    tsize_t tbytes = 0, tilesize = TIFFTileSize(in);
+    tsample_t s;
+    uint8*  bufp = (uint8*)obuf;
+    unsigned char *srcbuffs[MAX_SAMPLES];
+    unsigned char *tbuff = NULL;
 
-  bytes_per_sample = (bps + 7) / 8;
+    bytes_per_sample = (bps + 7) / 8;
 
-  for (sample = 0; (sample < spp) && (sample < MAX_SAMPLES); sample++)
+    for (sample = 0; (sample < spp) && (sample < MAX_SAMPLES); sample++)
     {
-    srcbuffs[sample] = NULL;
-    tbuff = (unsigned char *)_TIFFmalloc(tilesize + 8);
-    if (!tbuff)
-      {
-      TIFFError ("readSeparateTilesIntoBuffer", 
-                 "Unable to allocate tile read buffer for sample %d", sample);
-      for (i = 0; i < sample; i++)
-        _TIFFfree (srcbuffs[i]);
-      return 0;
-      }
-    srcbuffs[sample] = tbuff;
+        srcbuffs[sample] = NULL;
+        tbuff = (unsigned char *)_TIFFmalloc(tilesize + 8);
+        if (!tbuff)
+        {
+            TIFFError ("readSeparateTilesIntoBuffer", 
+                "Unable to allocate tile read buffer for sample %d", sample);
+            for (i = 0; i < sample; i++)
+                _TIFFfree (srcbuffs[i]);
+            return 0;
+        }
+        srcbuffs[sample] = tbuff;
     } 
-  /* Each tile contains only the data for a single plane
-   * arranged in scanlines of tw * bytes_per_sample bytes.
-   */
-  for (row = 0; row < imagelength; row += tl)
+    /* Each tile contains only the data for a single plane
+     * arranged in scanlines of tw * bytes_per_sample bytes.
+     */
+    for (row = 0; row < imagelength; row += tl)
     {
-    nrow = (row + tl > imagelength) ? imagelength - row : tl;
-    for (col = 0; col < imagewidth; col += tw)
-      {
-      for (s = 0; s < spp; s++)
-        {  /* Read each plane of a tile set into srcbuffs[s] */
-	tbytes = TIFFReadTile(in, srcbuffs[s], col, row, 0, s);
-        if (tbytes < 0  && !ignore)
-          {
-	  TIFFError(TIFFFileName(in),
-                 "Error, can't read tile for row %lu col %lu, "
-		 "sample %lu",
-		 (unsigned long) col, (unsigned long) row,
-		 (unsigned long) s);
-		 status = 0;
-          for (sample = 0; (sample < spp) && (sample < MAX_SAMPLES); sample++)
-            {
-            tbuff = srcbuffs[sample];
-            if (tbuff != NULL)
-              _TIFFfree(tbuff);
-            }
-          return status;
-	  }
-	}
-     /* Tiles on the right edge may be padded out to tw 
-      * which must be a multiple of 16.
-      * Ncol represents the visible (non padding) portion.  
-      */
-      if (col + tw > imagewidth)
-        ncol = imagewidth - col;
-      else
-        ncol = tw;
-
-      row_offset = row * (((imagewidth * spp * bps) + 7) / 8);
-      col_offset = ((col * spp * bps) + 7) / 8;
-      bufp = obuf + row_offset + col_offset;
-
-      if ((bps % 8) == 0)
-        {
-        if (combineSeparateTileSamplesBytes(srcbuffs, bufp, ncol, nrow, imagewidth,
-					    tw, spp, bps, NULL, 0, 0))
-	  {
-          status = 0;
-          break;
-      	  }
-	}
-      else
+        nrow = (row + tl > imagelength) ? imagelength - row : tl;
+        for (col = 0; col < imagewidth; col += tw)
         {
-        bytes_per_pixel  = ((bps * spp) + 7) / 8;
-        if (bytes_per_pixel < (bytes_per_sample + 1))
-          shift_width = bytes_per_pixel;
-        else
-          shift_width = bytes_per_sample + 1;
-
-        switch (shift_width)
-          {
-          case 1: if (combineSeparateTileSamples8bits (srcbuffs, bufp, ncol, nrow,
-                                                       imagewidth, tw, spp, bps, 
-						       NULL, 0, 0))
-	            {
-                    status = 0;
-                    break;
-      	            }
-	          break;
-          case 2: if (combineSeparateTileSamples16bits (srcbuffs, bufp, ncol, nrow,
-                                                       imagewidth, tw, spp, bps, 
-						       NULL, 0, 0))
-	            {
-                    status = 0;
-                    break;
-		    }
-	          break;
-          case 3: if (combineSeparateTileSamples24bits (srcbuffs, bufp, ncol, nrow,
-                                                       imagewidth, tw, spp, bps, 
-						       NULL, 0, 0))
-	            {
+            for (s = 0; s < spp; s++)
+            {  /* Read each plane of a tile set into srcbuffs[s] */
+                tbytes = TIFFReadTile(in, srcbuffs[s], col, row, 0, s);
+                if (tbytes == (tsize_t)(-1)) 
+                {
+                    TIFFError(TIFFFileName(in),
+                        "Error, can't read tile for row %lu col %lu, "
+                        "sample %lu",
+                        (unsigned long) col, (unsigned long) row,
+                        (unsigned long) s);
                     status = 0;
                     break;
-       	            }
-                  break;
-          case 4: 
-          case 5:
-          case 6:
-          case 7:
-          case 8: if (combineSeparateTileSamples32bits (srcbuffs, bufp, ncol, nrow,
-                                                       imagewidth, tw, spp, bps, 
-						       NULL, 0, 0))
-	            {
+                }
+            }
+        
+            /* Tiles on the right edge may be padded out to tw 
+             * which must be a multiple of 16.
+             * Ncol represents the visible (non padding) portion.  
+             */
+            if (col + tw > imagewidth)
+                ncol = imagewidth - col;
+            else
+                ncol = tw;
+
+            row_offset = row * (((imagewidth * spp * bps) + 7) / 8);
+            col_offset = ((col * spp * bps) + 7) / 8;
+            bufp = obuf + row_offset + col_offset;
+
+            if ((bps % 8) == 0)
+            {
+                if (combineSeparateTileSamplesBytes(srcbuffs, bufp, ncol, nrow, imagewidth,
+                                                     tw, spp, bps, NULL, 0, 0))
+                {
                     status = 0;
                     break;
-		    }
-	          break;
-          default: TIFFError ("readSeparateTilesIntoBuffer", "Unsupported bit depth: %d", bps);
-                  status = 0;
-                  break;
-          }
+                }
+            }
+            else
+            {
+                bytes_per_pixel  = ((bps * spp) + 7) / 8;
+                if (bytes_per_pixel < (bytes_per_sample + 1))
+                    shift_width = bytes_per_pixel;
+                else
+                    shift_width = bytes_per_sample + 1;
+
+                switch (shift_width)
+                {
+                    case 1: if (combineSeparateTileSamples8bits (srcbuffs, bufp, ncol, nrow,
+                                                                 imagewidth, tw, spp, bps, 
+                                                                 NULL, 0, 0))
+                            {
+                                status = 0;
+                                break;
+                            }
+                            break;
+                    case 2: if (combineSeparateTileSamples16bits (srcbuffs, bufp, ncol, nrow,
+                                                                 imagewidth, tw, spp, bps, 
+                                                                 NULL, 0, 0))
+                            {
+                                status = 0;
+                                break;
+                            }
+                            break;
+                    case 3: if (combineSeparateTileSamples24bits (srcbuffs, bufp, ncol, nrow,
+                                                                 imagewidth, tw, spp, bps, 
+                                                                 NULL, 0, 0))
+                            {
+                                status = 0;
+                                break;
+                            }
+                            break;
+                    case 4: 
+                    case 5:
+                    case 6:
+                    case 7:
+                    case 8: if (combineSeparateTileSamples32bits (srcbuffs, bufp, ncol, nrow,
+                                                                 imagewidth, tw, spp, bps, 
+                                                                 NULL, 0, 0))
+                            {
+                                status = 0;
+                                break;
+                            }
+                            break;
+                    default: TIFFError ("readSeparateTilesIntoBuffer", "Unsupported bit depth: %d", bps);
+                             status = 0;
+                             break;
+                }
+            }
         }
-      }
     }
 
-  for (sample = 0; (sample < spp) && (sample < MAX_SAMPLES); sample++)
+    for (sample = 0; (sample < spp) && (sample < MAX_SAMPLES); sample++)
     {
-    tbuff = srcbuffs[sample];
-    if (tbuff != NULL)
-      _TIFFfree(tbuff);
+        tbuff = srcbuffs[sample];
+        if (tbuff != NULL)
+            _TIFFfree(tbuff);
     }
- 
-  return status;
-  }
+
+    return status;
+}
+
 
 static int writeBufferToContigStrips(TIFF* out, uint8* buf, uint32 imagelength)
   {

2025-02-03 22:27:31.701 | DEBUG    | scenario:rebuild:369 - original environment: environ({'CONDA_SHLVL': '2', 'LC_ALL': 'C.UTF-8', 'LS_COLORS': 'rs=0:di=01;34:ln=01;36:mh=00:pi=40;33:so=01;35:do=01;35:bd=40;33;01:cd=40;33;01:or=40;31;01:mi=00:su=37;41:sg=30;43:ca=30;41:tw=30;42:ow=34;42:st=37;44:ex=01;32:*.tar=01;31:*.tgz=01;31:*.arc=01;31:*.arj=01;31:*.taz=01;31:*.lha=01;31:*.lz4=01;31:*.lzh=01;31:*.lzma=01;31:*.tlz=01;31:*.txz=01;31:*.tzo=01;31:*.t7z=01;31:*.zip=01;31:*.z=01;31:*.Z=01;31:*.dz=01;31:*.gz=01;31:*.lrz=01;31:*.lz=01;31:*.lzo=01;31:*.xz=01;31:*.zst=01;31:*.tzst=01;31:*.bz2=01;31:*.bz=01;31:*.tbz=01;31:*.tbz2=01;31:*.tz=01;31:*.deb=01;31:*.rpm=01;31:*.jar=01;31:*.war=01;31:*.ear=01;31:*.sar=01;31:*.rar=01;31:*.alz=01;31:*.ace=01;31:*.zoo=01;31:*.cpio=01;31:*.7z=01;31:*.rz=01;31:*.cab=01;31:*.wim=01;31:*.swm=01;31:*.dwm=01;31:*.esd=01;31:*.jpg=01;35:*.jpeg=01;35:*.mjpg=01;35:*.mjpeg=01;35:*.gif=01;35:*.bmp=01;35:*.pbm=01;35:*.pgm=01;35:*.ppm=01;35:*.tga=01;35:*.xbm=01;35:*.xpm=01;35:*.tif=01;35:*.tiff=01;35:*.png=01;35:*.svg=01;35:*.svgz=01;35:*.mng=01;35:*.pcx=01;35:*.mov=01;35:*.mpg=01;35:*.mpeg=01;35:*.m2v=01;35:*.mkv=01;35:*.webm=01;35:*.ogm=01;35:*.mp4=01;35:*.m4v=01;35:*.mp4v=01;35:*.vob=01;35:*.qt=01;35:*.nuv=01;35:*.wmv=01;35:*.asf=01;35:*.rm=01;35:*.rmvb=01;35:*.flc=01;35:*.avi=01;35:*.fli=01;35:*.flv=01;35:*.gl=01;35:*.dl=01;35:*.xcf=01;35:*.xwd=01;35:*.yuv=01;35:*.cgm=01;35:*.emf=01;35:*.ogv=01;35:*.ogx=01;35:*.aac=00;36:*.au=00;36:*.flac=00;36:*.m4a=00;36:*.mid=00;36:*.midi=00;36:*.mka=00;36:*.mp3=00;36:*.mpc=00;36:*.ogg=00;36:*.ra=00;36:*.wav=00;36:*.oga=00;36:*.opus=00;36:*.spx=00;36:*.xspf=00;36:', 'LD_LIBRARY_PATH': '/opt/crashrepair/lib:/CrashRepair/lib:/klee/build/lib:', 'CONDA_EXE': '/root/anaconda3/bin/conda', 'LANG': 'C.UTF-8', 'TZ': 'Asia/Shanghai', 'HOSTNAME': 'fea22102047d', 'OLDPWD': '/orchestrator', 'CONDA_PREFIX': '/root/anaconda3/envs/CrashRepair', '_CE_M': '', 'CC': 'crepair-cc', 'LLVM_COMPILER': 'clang', 'CONDA_PREFIX_1': '/root/anaconda3', 'PWD': '/orchestrator/crashrepair', 'HOME': '/root', 'CONDA_PYTHON_EXE': '/root/anaconda3/bin/python', '_CE_CONDA': '', 'CONDA_PROMPT_MODIFIER': '(CrashRepair) ', 'CXX': 'crepair-cxx', 'TERM': 'xterm', 'SHLVL': '2', 'PYTHONPATH': '/usr/lib/python3.8/site-packages:', 'PATH': '/root/anaconda3/envs/CrashRepair/bin:/root/anaconda3/condabin:~/anaconda3/bin:/opt/crashrepair/bin:/CrashRepair/compiler:/klee/build/bin:/opt/llvm-6/bin:/klee/build/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', 'CONDA_DEFAULT_ENV': 'CrashRepair', '_': '/root/anaconda3/envs/CrashRepair/bin/python'})
2025-02-03 22:27:31.702 | DEBUG    | scenario:rebuild:382 - injecting ghost function into CFLAGS during build: -lcrepair_ghost
2025-02-03 22:27:31.702 | DEBUG    | scenario:rebuild:398 - using environment: {'INJECT_CFLAGS': '-g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address', 'INJECT_CXXFLAGS': '-g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address', 'INJECT_LDFLAGS': '-g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address'}
2025-02-03 22:27:31.702 | DEBUG    | shell:__call__:41 - executing: make CFLAGS="${INJECT_CFLAGS}" CXXFLAGS="${INJECT_CXXFLAGS}" LDFLAGS="${INJECT_LDFLAGS}"
Making all in port
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/port'
make[1]: Nothing to be done for 'all'.
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/port'
Making all in libtiff
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/libtiff'
make  all-am
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/libtiff'
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/libtiff'
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/libtiff'
Making all in tools
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/tools'
crepair-cc -DHAVE_CONFIG_H -I. -I../libtiff  -I../libtiff   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -MT tiffcrop.o -MD -MP -MF .deps/tiffcrop.Tpo -c -o tiffcrop.o tiffcrop.c
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_ghost: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
mv -f .deps/tiffcrop.Tpo .deps/tiffcrop.Po
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address  -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -o tiffcrop tiffcrop.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -g -O0 -Wno-error -I/CrashRepair/lib -fsanitize=address -g -O0 -Wno-error -I/CrashRepair/lib -fsanitize=address -o tiffcrop tiffcrop.o  -L/klee/build/lib -L/CrashRepair/lib -lkleeRuntest -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost ../libtiff/.libs/libtiff.a ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/tools'
Making all in build
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/build'
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/build'
make[2]: Nothing to be done for 'all-am'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/build'
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/build'
Making all in contrib
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib'
Making all in addtiffo
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/addtiffo'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/addtiffo'
Making all in dbs
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/dbs'
Making all in xtiff
make[3]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/dbs/xtiff'
make[3]: Nothing to be done for 'all'.
make[3]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/dbs/xtiff'
make[3]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/dbs'
make[3]: Nothing to be done for 'all-am'.
make[3]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/dbs'
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/dbs'
Making all in iptcutil
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/iptcutil'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/iptcutil'
Making all in mfs
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/mfs'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/mfs'
Making all in pds
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/pds'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/pds'
Making all in ras
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/ras'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/ras'
Making all in stream
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/stream'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/stream'
Making all in tags
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/tags'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/tags'
Making all in win_dib
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/win_dib'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/win_dib'
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib'
make[2]: Nothing to be done for 'all-am'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib'
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib'
Making all in test
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/test'
make[1]: Nothing to be done for 'all'.
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/test'
Making all in man
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/man'
make[1]: Nothing to be done for 'all'.
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/man'
Making all in html
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html'
Making all in images
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html/images'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html/images'
Making all in man
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html/man'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html/man'
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html'
make[2]: Nothing to be done for 'all-am'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html'
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html'
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src'
make[1]: Nothing to be done for 'all-am'.
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src'
2025-02-03 22:27:32.201 | INFO     | analyzer:run:114 - running analysis with timeout: 60 minutes
2025-02-03 22:27:32.201 | DEBUG    | analyzer:write_config_to_file:88 - generated analyzer config:

dir_exp:/data/vulnloc/libtiff/CVE-2016-5321
tag_id:libtiff_CVE-2016-5321
src_directory:/data/vulnloc/libtiff/CVE-2016-5321/src
binary_path:/data/vulnloc/libtiff/CVE-2016-5321/src/tools/tiffcrop
config_command:./configure --enable-static --disable-shared
build_command:make CFLAGS="${INJECT_CFLAGS}" CXXFLAGS="${INJECT_CXXFLAGS}" LDFLAGS="${INJECT_LDFLAGS}"
test_input_list:$POC foo.tif
poc_list:/CrashRepair/experiments/vulnloc/libtiff/CVE-2016-5321/tests/1.tif
klee_flags:--link-llvm-lib=/CrashRepair/lib/libcrepair_proxy.bca 

2025-02-03 22:27:32.201 | DEBUG    | analyzer:run:124 - wrote analyzer config file to: /tmp/tmp5vyk3aoz
2025-02-03 22:27:32.201 | DEBUG    | shell:__call__:41 - executing: crepair --conf=/tmp/tmp5vyk3aoz
[K[1;36m
====================================================================================================

	Starting CRepair (C Crash Repair) 
====================================================================================================
[0m
[K[1;36m
	Loading Configurations
	__________________________________________________________________________________________
[0m
[K	[1;34mreading configuration values from arguments[0m
[K	[1;34mreading configuration values form configuration file[0m
[K	[1;37m	[file] /tmp/tmp5vyk3aoz[0m
[K	[1;34mupdating configuration values[0m
[K	[1;34mreading test configuration[0m
[K	[1;34mreading seed information[0m
[K	[1;37m	[config] stack size: 15000[0m
[K	[1;37m	[config] collecting stats: False[0m
[K	[1;37m	[config] number of tests: 1[0m
[K	[1;37m	[config] number of cores: 8[0m
[K	[1;37m	[config] klee concrete execution timeout: 600[0m
[K	[1;37m	[config] klee concolic execution timeout: 1200[0m
[K	[1;37m	[config] synthesize subset expressions: True[0m
[K	[1;37m	[config] window size for taint locations: 500[0m
[K	[1;37m	[config] window size for taint values: 500000[0m
[K[1;36m

	Analyzing Program
====================================================================================================
[0m
[K[1;36m
	Test Case #1
	__________________________________________________________________________________________
[0m
[K[1;36m
		Running Concrete Execution
		------------------------------------------------------------------------------------------
[0m
[K	[1;37m	[0m[K     [1;37mUsing Arguments: ['$POC', 'foo.tif'][0m
[K	[1;37m	[0m[K     [1;37mUsing Input File: /CrashRepair/experiments/vulnloc/libtiff/CVE-2016-5321/tests/1.tif[0m
[K	[1;34m	building program[0m
[K	[1;34m		setting environment variables[0m
[K	[1;34m		cleaning files[0m
[K	[1;34m		configuring program[0m
[K	[1;34m		compiling program[0m
[K	[1;37m	[0m[K     [1;37mUsing Binary: /data/vulnloc/libtiff/CVE-2016-5321/src/tools/tiffcrop[0m
[K	[1;34m	extracting bytecode[0m
[K	[1;34m	executing klee in concrete mode[0m
[K	[1;34m	extracting instruction trace[0m
[K	[1;37m		[note] program crashed[0m
[K	[1;34m	collecting tainted expressions[0m
[K	[1;34m	collecting tainted concrete values[0m
[K	[1;34m	collecting memory allocations/de-allocations[0m
[K	[1;34m	collecting pointer mapping[0m
[K	[1;34m	extracting crash information[0m
[K	[1;37m		[0m[K     [1;37m[info] crash type: memory read overflow[0m
[K	[1;37m		[0m[K     [1;37m[info] crash location:
                             /data/vulnloc/libtiff/CVE-2016-5321/src/tools/tiffcrop.c:995:43[0m
[K	[1;37m		[0m[K     [1;37m[info] crash function: readSeparateTilesIntoBuffer[0m
[K	[1;37m		[0m[K     [1;37m[info] crash address: 116502[0m
[K	[1;37m		[0m[K     [1;37m[info] crash free constraint: ((8 * @var(integer, s)) < 64)[0m
[K	[1;37m		[0m[K     [1;37m[info] crash inducing variables: s[0m
[K	[1;37m			[info] identified crash type: memory read overflow[0m
[K[1;36m
		Running Concolic Execution
		------------------------------------------------------------------------------------------
[0m
[K	[1;37m	[0m[K     [1;37mUsing Arguments: ['$POC', 'foo.tif'][0m
[K	[1;37m	[0m[K     [1;37mUsing Input File: /CrashRepair/experiments/vulnloc/libtiff/CVE-2016-5321/tests/1.tif[0m
[K	[1;34m	building program[0m
[K	[1;34m		setting environment variables[0m
[K	[1;34m		cleaning files[0m
[K	[1;34m		configuring program[0m
[K	[1;34m		compiling program[0m
[K	[1;34m	extracting bytecode[0m
[K	[1;34m	generating ktest file[0m
[K	[1;34m	executing klee in concolic mode[0m
[K	[1;34m	extracting largest symbolic path[0m
[K	[1;34m	extracting instruction trace[0m
[K	[1;37m		[note] program crashed[0m
[K	[1;34m	collecting tainted expressions[0m
[K	[1;34m	collecting memory allocations/de-allocations[0m
[K	[1;34m	collecting pointer mapping[0m
[K	[1;37m		[0m[K     [1;37m[info] Symbolic Mapping: s -> [][0m
[K[1;36m

	Fix Localization
====================================================================================================
[0m
[K[1;36m
	Generating Fix Locations
	__________________________________________________________________________________________
[0m
[K	[1;34m	generating taint map[0m
[K	[1;37m		[0m[K     [1;37m[info] found 10854 tainted locations[0m
[K	[1;34m		starting parallel computing[0m
[K	[1;34m		waiting for thread completion[0m
[K	[1;37m		[0m[K     [1;37m[info] found 5 source files[0m
[K	[1;37m		[0m[K     [1;37m[info] found 12 executed functions[0m
[K	[1;34m	generating possible fix locations[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] readSeparateTilesIntoBuffer,
                             /data/vulnloc/libtiff/CVE-2016-5321/src/tools/tiffcrop.c:993:35[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] readSeparateTilesIntoBuffer,
                             /data/vulnloc/libtiff/CVE-2016-5321/src/tools/tiffcrop.c:996:28[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] readSeparateTilesIntoBuffer,
                             /data/vulnloc/libtiff/CVE-2016-5321/src/tools/tiffcrop.c:996:21[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] readSeparateTilesIntoBuffer,
                             /data/vulnloc/libtiff/CVE-2016-5321/src/tools/tiffcrop.c:995:24[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] readSeparateTilesIntoBuffer,
                             /data/vulnloc/libtiff/CVE-2016-5321/src/tools/tiffcrop.c:995:26[0m
[K[1;36m
	Localizing Constraints
	__________________________________________________________________________________________
[0m
[K[1;36m
		[fix-loc] /data/vulnloc/libtiff/CVE-2016-5321/src/tools/tiffcrop.c:993:13
		------------------------------------------------------------------------------------------
[0m
[K	[1;37m	[0m[K     [1;37m[constraint] ((8 * @var(integer, s)) < 64)[0m
[K[1;36m
		[fix-loc] /data/vulnloc/libtiff/CVE-2016-5321/src/tools/tiffcrop.c:995:26
		------------------------------------------------------------------------------------------
[0m
[K	[1;37m	[0m[K     [1;37m[constraint] ((8 * @var(integer, s)) < 64)[0m
[K[1;36m
		[fix-loc] /data/vulnloc/libtiff/CVE-2016-5321/src/tools/tiffcrop.c:996:17
		------------------------------------------------------------------------------------------
[0m
[K	[1;37m	[0m[K     [1;37m[constraint] ((8 * @var(integer, s)) < 64)[0m
[K[1;36m
		[fix-loc] /data/vulnloc/libtiff/CVE-2016-5321/src/tools/tiffcrop.c:995:17
		------------------------------------------------------------------------------------------
[0m
[K	[1;37m	[0m[K     [1;37m[constraint] ((8 * @var(integer, s)) < 64)[0m
[K[1;32m
	localization information saved at /CrashRepair/output/libtiff_CVE-2016-5321/localization.json[0m
[K[1;32m
	state values saved at /CrashRepair/output/libtiff_CVE-2016-5321/values/[0m
[K	[1;37m
Run time statistics:
-----------------------
[0m
[K	[1;37mStartup: 0.000 minutes[0m
[K	[1;37mBuild: 0 minutes[0m
[K	[1;37mConcrete Analysis: 0.677 minutes[0m
[K	[1;37mConcolic Analysis: 0.585 minutes[0m
[K	[1;37mTotal Analysis: 1.294 minutes[0m
[K	[1;37mLocalization: 0.297 minutes[0m
[K[1;32m
CRepair finished successfully after 1.632 minutes 
[0m
2025-02-03 22:29:11.076 | WARNING  | analyzer:run:143 - analysis output directory does not exist [/data/vulnloc/libtiff/CVE-2016-5321/analysis]: creating...
2025-02-03 22:29:11.198 | INFO     | scenario:analyze_for_guide:558 - reanalyzing candidate patch: #18:
@@ -948,11 +948,12 @@
   return status;
   }
 
-static int  readSeparateTilesIntoBuffer (TIFF* in, uint8 *obuf, 
-					 uint32 imagelength, uint32 imagewidth, 
+
+static int readSeparateTilesIntoBuffer (TIFF* in, uint8 *obuf, 
+                                         uint32 imagelength, uint32 imagewidth, 
                                          uint32 tw, uint32 tl,
                                          uint16 spp, uint16 bps)
-  {
+{
   int     i, status = 1, sample;
   int     shift_width, bytes_per_pixel;
   uint16  bytes_per_sample;
@@ -968,51 +969,42 @@
   bytes_per_sample = (bps + 7) / 8;
 
   for (sample = 0; (sample < spp) && (sample < MAX_SAMPLES); sample++)
-    {
+  {
     srcbuffs[sample] = NULL;
     tbuff = (unsigned char *)_TIFFmalloc(tilesize + 8);
     if (!tbuff)
-      {
+    {
       TIFFError ("readSeparateTilesIntoBuffer", 
                  "Unable to allocate tile read buffer for sample %d", sample);
       for (i = 0; i < sample; i++)
         _TIFFfree (srcbuffs[i]);
       return 0;
-      }
+    }
     srcbuffs[sample] = tbuff;
-    } 
-  /* Each tile contains only the data for a single plane
-   * arranged in scanlines of tw * bytes_per_sample bytes.
-   */
+  } 
+
   for (row = 0; row < imagelength; row += tl)
-    {
+  {
     nrow = (row + tl > imagelength) ? imagelength - row : tl;
     for (col = 0; col < imagewidth; col += tw)
-      {
+    {
       for (s = 0; s < spp; s++)
-        {  /* Read each plane of a tile set into srcbuffs[s] */
-	tbytes = TIFFReadTile(in, srcbuffs[s], col, row, 0, s);
-        if (tbytes < 0  && !ignore)
-          {
-	  TIFFError(TIFFFileName(in),
-                 "Error, can't read tile for row %lu col %lu, "
-		 "sample %lu",
-		 (unsigned long) col, (unsigned long) row,
-		 (unsigned long) s);
-		 status = 0;
-          for (sample = 0; (sample < spp) && (sample < MAX_SAMPLES); sample++)
-            {
-            tbuff = srcbuffs[sample];
-            if (tbuff != NULL)
-              _TIFFfree(tbuff);
-            }
-          return status;
-	  }
-	}
-     /* Tiles on the right edge may be padded out to tw 
-      * which must be a multiple of 16.
-      * Ncol represents the visible (non padding) portion.  
-      */
+      {
+        tbytes = TIFFReadTile(in, srcbuffs[s], col, row, 0, s);
+        if (tbytes < 0)
+        {
+          TIFFError(TIFFFileName(in),
+                     "Error, can't read tile for row %lu col %lu, "
+                     "sample %lu",
+                     (unsigned long) col, (unsigned long) row,
+                     (unsigned long) s);
+          status = 0;
+          break; // Added break to avoid fallthrough on error
+        }
+      }
+
+      if (status == 0) break; // Added break to exit outer loop on error
+
       if (col + tw > imagewidth)
         ncol = imagewidth - col;
       else
@@ -1023,16 +1015,16 @@
       bufp = obuf + row_offset + col_offset;
 
       if ((bps % 8) == 0)
-        {
+      {
         if (combineSeparateTileSamplesBytes(srcbuffs, bufp, ncol, nrow, imagewidth,
-					    tw, spp, bps, NULL, 0, 0))
-	  {
+                                             tw, spp, bps, NULL, 0, 0))
+        {
           status = 0;
           break;
-      	  }
-	}
+        }
+      }
       else
-        {
+      {
         bytes_per_pixel  = ((bps * spp) + 7) / 8;
         if (bytes_per_pixel < (bytes_per_sample + 1))
           shift_width = bytes_per_pixel;
@@ -1040,30 +1032,30 @@
           shift_width = bytes_per_sample + 1;
 
         switch (shift_width)
-          {
+        {
           case 1: if (combineSeparateTileSamples8bits (srcbuffs, bufp, ncol, nrow,
                                                        imagewidth, tw, spp, bps, 
-						       NULL, 0, 0))
-	            {
+                                                       NULL, 0, 0))
+                  {
                     status = 0;
                     break;
-      	            }
-	          break;
+                  }
+                  break;
           case 2: if (combineSeparateTileSamples16bits (srcbuffs, bufp, ncol, nrow,
                                                        imagewidth, tw, spp, bps, 
-						       NULL, 0, 0))
-	            {
+                                                       NULL, 0, 0))
+                  {
                     status = 0;
                     break;
-		    }
-	          break;
+                  }
+                  break;
           case 3: if (combineSeparateTileSamples24bits (srcbuffs, bufp, ncol, nrow,
                                                        imagewidth, tw, spp, bps, 
-						       NULL, 0, 0))
-	            {
+                                                       NULL, 0, 0))
+                  {
                     status = 0;
                     break;
-       	            }
+                  }
                   break;
           case 4: 
           case 5:
@@ -1071,30 +1063,32 @@
           case 7:
           case 8: if (combineSeparateTileSamples32bits (srcbuffs, bufp, ncol, nrow,
                                                        imagewidth, tw, spp, bps, 
-						       NULL, 0, 0))
-	            {
+                                                       NULL, 0, 0))
+                  {
                     status = 0;
                     break;
-		    }
-	          break;
+                  }
+                  break;
           default: TIFFError ("readSeparateTilesIntoBuffer", "Unsupported bit depth: %d", bps);
                   status = 0;
                   break;
-          }
         }
       }
     }
+    if (status == 0) break; // Added break to exit the row loop on error
+  }
 
   for (sample = 0; (sample < spp) && (sample < MAX_SAMPLES); sample++)
-    {
+  {
     tbuff = srcbuffs[sample];
     if (tbuff != NULL)
       _TIFFfree(tbuff);
-    }
- 
-  return status;
   }
 
+  return status;
+}
+
+
 static int writeBufferToContigStrips(TIFF* out, uint8* buf, uint32 imagelength)
   {
   uint32 row, nrows, rowsperstrip;

2025-02-03 22:29:11.206 | DEBUG    | scenario:rebuild:369 - original environment: environ({'CONDA_SHLVL': '2', 'LC_ALL': 'C.UTF-8', 'LS_COLORS': 'rs=0:di=01;34:ln=01;36:mh=00:pi=40;33:so=01;35:do=01;35:bd=40;33;01:cd=40;33;01:or=40;31;01:mi=00:su=37;41:sg=30;43:ca=30;41:tw=30;42:ow=34;42:st=37;44:ex=01;32:*.tar=01;31:*.tgz=01;31:*.arc=01;31:*.arj=01;31:*.taz=01;31:*.lha=01;31:*.lz4=01;31:*.lzh=01;31:*.lzma=01;31:*.tlz=01;31:*.txz=01;31:*.tzo=01;31:*.t7z=01;31:*.zip=01;31:*.z=01;31:*.Z=01;31:*.dz=01;31:*.gz=01;31:*.lrz=01;31:*.lz=01;31:*.lzo=01;31:*.xz=01;31:*.zst=01;31:*.tzst=01;31:*.bz2=01;31:*.bz=01;31:*.tbz=01;31:*.tbz2=01;31:*.tz=01;31:*.deb=01;31:*.rpm=01;31:*.jar=01;31:*.war=01;31:*.ear=01;31:*.sar=01;31:*.rar=01;31:*.alz=01;31:*.ace=01;31:*.zoo=01;31:*.cpio=01;31:*.7z=01;31:*.rz=01;31:*.cab=01;31:*.wim=01;31:*.swm=01;31:*.dwm=01;31:*.esd=01;31:*.jpg=01;35:*.jpeg=01;35:*.mjpg=01;35:*.mjpeg=01;35:*.gif=01;35:*.bmp=01;35:*.pbm=01;35:*.pgm=01;35:*.ppm=01;35:*.tga=01;35:*.xbm=01;35:*.xpm=01;35:*.tif=01;35:*.tiff=01;35:*.png=01;35:*.svg=01;35:*.svgz=01;35:*.mng=01;35:*.pcx=01;35:*.mov=01;35:*.mpg=01;35:*.mpeg=01;35:*.m2v=01;35:*.mkv=01;35:*.webm=01;35:*.ogm=01;35:*.mp4=01;35:*.m4v=01;35:*.mp4v=01;35:*.vob=01;35:*.qt=01;35:*.nuv=01;35:*.wmv=01;35:*.asf=01;35:*.rm=01;35:*.rmvb=01;35:*.flc=01;35:*.avi=01;35:*.fli=01;35:*.flv=01;35:*.gl=01;35:*.dl=01;35:*.xcf=01;35:*.xwd=01;35:*.yuv=01;35:*.cgm=01;35:*.emf=01;35:*.ogv=01;35:*.ogx=01;35:*.aac=00;36:*.au=00;36:*.flac=00;36:*.m4a=00;36:*.mid=00;36:*.midi=00;36:*.mka=00;36:*.mp3=00;36:*.mpc=00;36:*.ogg=00;36:*.ra=00;36:*.wav=00;36:*.oga=00;36:*.opus=00;36:*.spx=00;36:*.xspf=00;36:', 'LD_LIBRARY_PATH': '/opt/crashrepair/lib:/CrashRepair/lib:/klee/build/lib:', 'CONDA_EXE': '/root/anaconda3/bin/conda', 'LANG': 'C.UTF-8', 'TZ': 'Asia/Shanghai', 'HOSTNAME': 'fea22102047d', 'OLDPWD': '/orchestrator', 'CONDA_PREFIX': '/root/anaconda3/envs/CrashRepair', '_CE_M': '', 'CC': 'crepair-cc', 'LLVM_COMPILER': 'clang', 'CONDA_PREFIX_1': '/root/anaconda3', 'PWD': '/orchestrator/crashrepair', 'HOME': '/root', 'CONDA_PYTHON_EXE': '/root/anaconda3/bin/python', '_CE_CONDA': '', 'CONDA_PROMPT_MODIFIER': '(CrashRepair) ', 'CXX': 'crepair-cxx', 'TERM': 'xterm', 'SHLVL': '2', 'PYTHONPATH': '/usr/lib/python3.8/site-packages:', 'PATH': '/root/anaconda3/envs/CrashRepair/bin:/root/anaconda3/condabin:~/anaconda3/bin:/opt/crashrepair/bin:/CrashRepair/compiler:/klee/build/bin:/opt/llvm-6/bin:/klee/build/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', 'CONDA_DEFAULT_ENV': 'CrashRepair', '_': '/root/anaconda3/envs/CrashRepair/bin/python'})
2025-02-03 22:29:11.206 | DEBUG    | scenario:rebuild:382 - injecting ghost function into CFLAGS during build: -lcrepair_ghost
2025-02-03 22:29:11.206 | DEBUG    | scenario:rebuild:398 - using environment: {'INJECT_CFLAGS': '-g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address', 'INJECT_CXXFLAGS': '-g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address', 'INJECT_LDFLAGS': '-g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address'}
2025-02-03 22:29:11.207 | DEBUG    | shell:__call__:41 - executing: make CFLAGS="${INJECT_CFLAGS}" CXXFLAGS="${INJECT_CXXFLAGS}" LDFLAGS="${INJECT_LDFLAGS}"
Making all in port
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/port'
make[1]: Nothing to be done for 'all'.
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/port'
Making all in libtiff
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/libtiff'
make  all-am
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/libtiff'
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/libtiff'
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/libtiff'
Making all in tools
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/tools'
crepair-cc -DHAVE_CONFIG_H -I. -I../libtiff  -I../libtiff   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -MT tiffcrop.o -MD -MP -MF .deps/tiffcrop.Tpo -c -o tiffcrop.o tiffcrop.c
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_ghost: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
mv -f .deps/tiffcrop.Tpo .deps/tiffcrop.Po
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address  -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -o tiffcrop tiffcrop.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -g -O0 -Wno-error -I/CrashRepair/lib -fsanitize=address -g -O0 -Wno-error -I/CrashRepair/lib -fsanitize=address -o tiffcrop tiffcrop.o  -L/klee/build/lib -L/CrashRepair/lib -lkleeRuntest -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost ../libtiff/.libs/libtiff.a ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/tools'
Making all in build
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/build'
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/build'
make[2]: Nothing to be done for 'all-am'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/build'
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/build'
Making all in contrib
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib'
Making all in addtiffo
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/addtiffo'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/addtiffo'
Making all in dbs
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/dbs'
Making all in xtiff
make[3]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/dbs/xtiff'
make[3]: Nothing to be done for 'all'.
make[3]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/dbs/xtiff'
make[3]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/dbs'
make[3]: Nothing to be done for 'all-am'.
make[3]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/dbs'
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/dbs'
Making all in iptcutil
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/iptcutil'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/iptcutil'
Making all in mfs
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/mfs'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/mfs'
Making all in pds
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/pds'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/pds'
Making all in ras
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/ras'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/ras'
Making all in stream
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/stream'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/stream'
Making all in tags
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/tags'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/tags'
Making all in win_dib
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/win_dib'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/win_dib'
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib'
make[2]: Nothing to be done for 'all-am'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib'
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib'
Making all in test
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/test'
make[1]: Nothing to be done for 'all'.
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/test'
Making all in man
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/man'
make[1]: Nothing to be done for 'all'.
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/man'
Making all in html
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html'
Making all in images
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html/images'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html/images'
Making all in man
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html/man'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html/man'
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html'
make[2]: Nothing to be done for 'all-am'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html'
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html'
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src'
make[1]: Nothing to be done for 'all-am'.
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src'
2025-02-03 22:29:11.691 | INFO     | analyzer:run:114 - running analysis with timeout: 60 minutes
2025-02-03 22:29:11.691 | DEBUG    | analyzer:write_config_to_file:88 - generated analyzer config:

dir_exp:/data/vulnloc/libtiff/CVE-2016-5321
tag_id:libtiff_CVE-2016-5321
src_directory:/data/vulnloc/libtiff/CVE-2016-5321/src
binary_path:/data/vulnloc/libtiff/CVE-2016-5321/src/tools/tiffcrop
config_command:./configure --enable-static --disable-shared
build_command:make CFLAGS="${INJECT_CFLAGS}" CXXFLAGS="${INJECT_CXXFLAGS}" LDFLAGS="${INJECT_LDFLAGS}"
test_input_list:$POC foo.tif
poc_list:/CrashRepair/experiments/vulnloc/libtiff/CVE-2016-5321/tests/1.tif
klee_flags:--link-llvm-lib=/CrashRepair/lib/libcrepair_proxy.bca 

2025-02-03 22:29:11.692 | DEBUG    | analyzer:run:124 - wrote analyzer config file to: /tmp/tmp02kg2paa
2025-02-03 22:29:11.692 | DEBUG    | shell:__call__:41 - executing: crepair --conf=/tmp/tmp02kg2paa
[K[1;36m
====================================================================================================

	Starting CRepair (C Crash Repair) 
====================================================================================================
[0m
[K[1;36m
	Loading Configurations
	__________________________________________________________________________________________
[0m
[K	[1;34mreading configuration values from arguments[0m
[K	[1;34mreading configuration values form configuration file[0m
[K	[1;37m	[file] /tmp/tmp02kg2paa[0m
[K	[1;34mupdating configuration values[0m
[K	[1;34mreading test configuration[0m
[K	[1;34mreading seed information[0m
[K	[1;37m	[config] stack size: 15000[0m
[K	[1;37m	[config] collecting stats: False[0m
[K	[1;37m	[config] number of tests: 1[0m
[K	[1;37m	[config] number of cores: 8[0m
[K	[1;37m	[config] klee concrete execution timeout: 600[0m
[K	[1;37m	[config] klee concolic execution timeout: 1200[0m
[K	[1;37m	[config] synthesize subset expressions: True[0m
[K	[1;37m	[config] window size for taint locations: 500[0m
[K	[1;37m	[config] window size for taint values: 500000[0m
[K[1;36m

	Analyzing Program
====================================================================================================
[0m
[K[1;36m
	Test Case #1
	__________________________________________________________________________________________
[0m
[K[1;36m
		Running Concrete Execution
		------------------------------------------------------------------------------------------
[0m
[K	[1;37m	[0m[K     [1;37mUsing Arguments: ['$POC', 'foo.tif'][0m
[K	[1;37m	[0m[K     [1;37mUsing Input File: /CrashRepair/experiments/vulnloc/libtiff/CVE-2016-5321/tests/1.tif[0m
[K	[1;34m	building program[0m
[K	[1;34m		setting environment variables[0m
[K	[1;34m		cleaning files[0m
[K	[1;34m		configuring program[0m
[K	[1;34m		compiling program[0m
[K	[1;37m	[0m[K     [1;37mUsing Binary: /data/vulnloc/libtiff/CVE-2016-5321/src/tools/tiffcrop[0m
[K	[1;34m	extracting bytecode[0m
[K	[1;34m	executing klee in concrete mode[0m
[K	[1;34m	extracting instruction trace[0m
[K	[1;37m		[note] program crashed[0m
[K	[1;34m	collecting tainted expressions[0m
[K	[1;34m	collecting tainted concrete values[0m
[K	[1;34m	collecting memory allocations/de-allocations[0m
[K	[1;34m	collecting pointer mapping[0m
[K	[1;34m	extracting crash information[0m
[K	[1;37m		[0m[K     [1;37m[info] crash type: memory read overflow[0m
[K	[1;37m		[0m[K     [1;37m[info] crash location:
                             /data/vulnloc/libtiff/CVE-2016-5321/src/tools/tiffcrop.c:993:35[0m
[K	[1;37m		[0m[K     [1;37m[info] crash function: readSeparateTilesIntoBuffer[0m
[K	[1;37m		[0m[K     [1;37m[info] crash address: 116502[0m
[K	[1;37m		[0m[K     [1;37m[info] crash free constraint: ((8 * @var(integer, s)) < 64)[0m
[K	[1;37m		[0m[K     [1;37m[info] crash inducing variables: s[0m
[K	[1;37m			[info] identified crash type: memory read overflow[0m
[K[1;36m
		Running Concolic Execution
		------------------------------------------------------------------------------------------
[0m
[K	[1;37m	[0m[K     [1;37mUsing Arguments: ['$POC', 'foo.tif'][0m
[K	[1;37m	[0m[K     [1;37mUsing Input File: /CrashRepair/experiments/vulnloc/libtiff/CVE-2016-5321/tests/1.tif[0m
[K	[1;34m	building program[0m
[K	[1;34m		setting environment variables[0m
[K	[1;34m		cleaning files[0m
[K	[1;34m		configuring program[0m
[K	[1;34m		compiling program[0m
[K	[1;34m	extracting bytecode[0m
[K	[1;34m	generating ktest file[0m
[K	[1;34m	executing klee in concolic mode[0m
[K	[1;34m	extracting largest symbolic path[0m
[K	[1;34m	extracting instruction trace[0m
[K	[1;37m		[note] program crashed[0m
[K	[1;34m	collecting tainted expressions[0m
[K	[1;34m	collecting memory allocations/de-allocations[0m
[K	[1;34m	collecting pointer mapping[0m
[K	[1;37m		[0m[K     [1;37m[info] Symbolic Mapping: s -> [][0m
[K[1;36m

	Fix Localization
====================================================================================================
[0m
[K[1;36m
	Generating Fix Locations
	__________________________________________________________________________________________
[0m
[K	[1;34m	generating taint map[0m
[K	[1;37m		[0m[K     [1;37m[info] found 10854 tainted locations[0m
[K	[1;34m		starting parallel computing[0m
[K	[1;34m		waiting for thread completion[0m
[K	[1;37m		[0m[K     [1;37m[info] found 5 source files[0m
[K	[1;37m		[0m[K     [1;37m[info] found 12 executed functions[0m
[K	[1;34m	generating possible fix locations[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] readSeparateTilesIntoBuffer,
                             /data/vulnloc/libtiff/CVE-2016-5321/src/tools/tiffcrop.c:991:29[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] readSeparateTilesIntoBuffer,
                             /data/vulnloc/libtiff/CVE-2016-5321/src/tools/tiffcrop.c:994:20[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] readSeparateTilesIntoBuffer,
                             /data/vulnloc/libtiff/CVE-2016-5321/src/tools/tiffcrop.c:994:13[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] readSeparateTilesIntoBuffer,
                             /data/vulnloc/libtiff/CVE-2016-5321/src/tools/tiffcrop.c:993:16[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] readSeparateTilesIntoBuffer,
                             /data/vulnloc/libtiff/CVE-2016-5321/src/tools/tiffcrop.c:993:18[0m
[K[1;36m
	Localizing Constraints
	__________________________________________________________________________________________
[0m
[K[1;36m
		[fix-loc] /data/vulnloc/libtiff/CVE-2016-5321/src/tools/tiffcrop.c:991:7
		------------------------------------------------------------------------------------------
[0m
[K	[1;37m	[0m[K     [1;37m[constraint] ((8 * @var(integer, s)) < 64)[0m
[K[1;36m
		[fix-loc] /data/vulnloc/libtiff/CVE-2016-5321/src/tools/tiffcrop.c:993:18
		------------------------------------------------------------------------------------------
[0m
[K	[1;37m	[0m[K     [1;37m[constraint] ((8 * @var(integer, s)) < 64)[0m
[K[1;36m
		[fix-loc] /data/vulnloc/libtiff/CVE-2016-5321/src/tools/tiffcrop.c:994:9
		------------------------------------------------------------------------------------------
[0m
[K	[1;37m	[0m[K     [1;37m[constraint] ((8 * @var(integer, s)) < 64)[0m
[K[1;36m
		[fix-loc] /data/vulnloc/libtiff/CVE-2016-5321/src/tools/tiffcrop.c:993:9
		------------------------------------------------------------------------------------------
[0m
[K	[1;37m	[0m[K     [1;37m[constraint] ((8 * @var(integer, s)) < 64)[0m
[K[1;32m
	localization information saved at /CrashRepair/output/libtiff_CVE-2016-5321/localization.json[0m
[K[1;32m
	state values saved at /CrashRepair/output/libtiff_CVE-2016-5321/values/[0m
[K	[1;37m
Run time statistics:
-----------------------
[0m
[K	[1;37mStartup: 0.000 minutes[0m
[K	[1;37mBuild: 0 minutes[0m
[K	[1;37mConcrete Analysis: 0.661 minutes[0m
[K	[1;37mConcolic Analysis: 0.584 minutes[0m
[K	[1;37mTotal Analysis: 1.279 minutes[0m
[K	[1;37mLocalization: 0.297 minutes[0m
[K[1;32m
CRepair finished successfully after 1.614 minutes 
[0m
2025-02-03 22:30:49.458 | WARNING  | analyzer:run:143 - analysis output directory does not exist [/data/vulnloc/libtiff/CVE-2016-5321/analysis]: creating...
2025-02-03 22:30:49.567 | INFO     | scenario:analyze_for_guide:558 - reanalyzing candidate patch: #19:
@@ -948,152 +948,160 @@
   return status;
   }
 
-static int  readSeparateTilesIntoBuffer (TIFF* in, uint8 *obuf, 
-					 uint32 imagelength, uint32 imagewidth, 
+
+static int readSeparateTilesIntoBuffer (TIFF* in, uint8 *obuf, 
+                                         uint32 imagelength, uint32 imagewidth, 
                                          uint32 tw, uint32 tl,
                                          uint16 spp, uint16 bps)
-  {
-  int     i, status = 1, sample;
-  int     shift_width, bytes_per_pixel;
-  uint16  bytes_per_sample;
-  uint32  row, col;     /* Current row and col of image */
-  uint32  nrow, ncol;   /* Number of rows and cols in current tile */
-  uint32  row_offset, col_offset; /* Output buffer offsets */
-  tsize_t tbytes = 0, tilesize = TIFFTileSize(in);
-  tsample_t s;
-  uint8*  bufp = (uint8*)obuf;
-  unsigned char *srcbuffs[MAX_SAMPLES];
-  unsigned char *tbuff = NULL;
+{
+    int     i, status = 1, sample;
+    int     shift_width, bytes_per_pixel;
+    uint16  bytes_per_sample;
+    uint32  row, col;     /* Current row and col of image */
+    uint32  nrow, ncol;   /* Number of rows and cols in current tile */
+    uint32  row_offset, col_offset; /* Output buffer offsets */
+    tsize_t tbytes = 0, tilesize = TIFFTileSize(in);
+    tsample_t s;
+    uint8*  bufp = (uint8*)obuf;
+    unsigned char *srcbuffs[MAX_SAMPLES];
+    unsigned char *tbuff = NULL;
 
-  bytes_per_sample = (bps + 7) / 8;
+    bytes_per_sample = (bps + 7) / 8;
 
-  for (sample = 0; (sample < spp) && (sample < MAX_SAMPLES); sample++)
+    for (sample = 0; (sample < spp) && (sample < MAX_SAMPLES); sample++)
     {
-    srcbuffs[sample] = NULL;
-    tbuff = (unsigned char *)_TIFFmalloc(tilesize + 8);
-    if (!tbuff)
-      {
-      TIFFError ("readSeparateTilesIntoBuffer", 
-                 "Unable to allocate tile read buffer for sample %d", sample);
-      for (i = 0; i < sample; i++)
-        _TIFFfree (srcbuffs[i]);
-      return 0;
-      }
-    srcbuffs[sample] = tbuff;
+        srcbuffs[sample] = NULL;
+        tbuff = (unsigned char *)_TIFFmalloc(tilesize + 8);
+        if (!tbuff)
+        {
+            TIFFError ("readSeparateTilesIntoBuffer", 
+                        "Unable to allocate tile read buffer for sample %d", sample);
+            for (i = 0; i < sample; i++)
+                _TIFFfree (srcbuffs[i]);
+            return 0;
+        }
+        srcbuffs[sample] = tbuff;
     } 
-  /* Each tile contains only the data for a single plane
-   * arranged in scanlines of tw * bytes_per_sample bytes.
-   */
-  for (row = 0; row < imagelength; row += tl)
+    /* Each tile contains only the data for a single plane
+     * arranged in scanlines of tw * bytes_per_sample bytes.
+     */
+    for (row = 0; row < imagelength; row += tl)
     {
-    nrow = (row + tl > imagelength) ? imagelength - row : tl;
-    for (col = 0; col < imagewidth; col += tw)
-      {
-      for (s = 0; s < spp; s++)
-        {  /* Read each plane of a tile set into srcbuffs[s] */
-	tbytes = TIFFReadTile(in, srcbuffs[s], col, row, 0, s);
-        if (tbytes < 0  && !ignore)
-          {
-	  TIFFError(TIFFFileName(in),
-                 "Error, can't read tile for row %lu col %lu, "
-		 "sample %lu",
-		 (unsigned long) col, (unsigned long) row,
-		 (unsigned long) s);
-		 status = 0;
-          for (sample = 0; (sample < spp) && (sample < MAX_SAMPLES); sample++)
-            {
-            tbuff = srcbuffs[sample];
-            if (tbuff != NULL)
-              _TIFFfree(tbuff);
-            }
-          return status;
-	  }
-	}
-     /* Tiles on the right edge may be padded out to tw 
-      * which must be a multiple of 16.
-      * Ncol represents the visible (non padding) portion.  
-      */
-      if (col + tw > imagewidth)
-        ncol = imagewidth - col;
-      else
-        ncol = tw;
-
-      row_offset = row * (((imagewidth * spp * bps) + 7) / 8);
-      col_offset = ((col * spp * bps) + 7) / 8;
-      bufp = obuf + row_offset + col_offset;
-
-      if ((bps % 8) == 0)
-        {
-        if (combineSeparateTileSamplesBytes(srcbuffs, bufp, ncol, nrow, imagewidth,
-					    tw, spp, bps, NULL, 0, 0))
-	  {
-          status = 0;
-          break;
-      	  }
-	}
-      else
+        nrow = (row + tl > imagelength) ? imagelength - row : tl;
+        for (col = 0; col < imagewidth; col += tw)
         {
-        bytes_per_pixel  = ((bps * spp) + 7) / 8;
-        if (bytes_per_pixel < (bytes_per_sample + 1))
-          shift_width = bytes_per_pixel;
-        else
-          shift_width = bytes_per_sample + 1;
-
-        switch (shift_width)
-          {
-          case 1: if (combineSeparateTileSamples8bits (srcbuffs, bufp, ncol, nrow,
-                                                       imagewidth, tw, spp, bps, 
-						       NULL, 0, 0))
-	            {
-                    status = 0;
-                    break;
-      	            }
-	          break;
-          case 2: if (combineSeparateTileSamples16bits (srcbuffs, bufp, ncol, nrow,
-                                                       imagewidth, tw, spp, bps, 
-						       NULL, 0, 0))
-	            {
-                    status = 0;
-                    break;
-		    }
-	          break;
-          case 3: if (combineSeparateTileSamples24bits (srcbuffs, bufp, ncol, nrow,
-                                                       imagewidth, tw, spp, bps, 
-						       NULL, 0, 0))
-	            {
+            for (s = 0; s < spp; s++)
+            {  
+                /* Validate TIFFReadTile return value to avoid processing errors */
+                tbytes = TIFFReadTile(in, srcbuffs[s], col, row, 0, s);
+                if (tbytes == (tsize_t)-1) // Handle error condition
+                {
+                    TIFFError(TIFFFileName(in),
+                              "Error, can't read tile for row %lu col %lu, "
+                              "sample %lu",
+                              (unsigned long) col, (unsigned long) row,
+                              (unsigned long) s);
                     status = 0;
                     break;
-       	            }
-                  break;
-          case 4: 
-          case 5:
-          case 6:
-          case 7:
-          case 8: if (combineSeparateTileSamples32bits (srcbuffs, bufp, ncol, nrow,
-                                                       imagewidth, tw, spp, bps, 
-						       NULL, 0, 0))
-	            {
+                }
+                else if (tbytes == 0) // Handle a potential read failure
+                {
+                    TIFFError(TIFFFileName(in),
+                              "Warning, read no bytes for tile at row %lu col %lu, "
+                              "sample %lu",
+                              (unsigned long) col, (unsigned long) row,
+                              (unsigned long) s);
+                    // Continue without breaking the loop
+                }
+            }
+            if (status == 0) break; // Exit outer loop if there was an error
+            /* Tiles on the right edge may be padded out to tw 
+             * which must be a multiple of 16.
+             * Ncol represents the visible (non padding) portion.  
+             */
+            if (col + tw > imagewidth)
+                ncol = imagewidth - col;
+            else
+                ncol = tw;
+
+            row_offset = row * (((imagewidth * spp * bps) + 7) / 8);
+            col_offset = ((col * spp * bps) + 7) / 8;
+            bufp = obuf + row_offset + col_offset;
+
+            if ((bps % 8) == 0)
+            {
+                if (combineSeparateTileSamplesBytes(srcbuffs, bufp, ncol, nrow, imagewidth,
+                                                     tw, spp, bps, NULL, 0, 0))
+                {
                     status = 0;
                     break;
-		    }
-	          break;
-          default: TIFFError ("readSeparateTilesIntoBuffer", "Unsupported bit depth: %d", bps);
-                  status = 0;
-                  break;
-          }
+                }
+            }
+            else
+            {
+                bytes_per_pixel  = ((bps * spp) + 7) / 8;
+                if (bytes_per_pixel < (bytes_per_sample + 1))
+                    shift_width = bytes_per_pixel;
+                else
+                    shift_width = bytes_per_sample + 1;
+
+                switch (shift_width)
+                {
+                    case 1: if (combineSeparateTileSamples8bits (srcbuffs, bufp, ncol, nrow,
+                                                                 imagewidth, tw, spp, bps, 
+                                                                 NULL, 0, 0))
+                            {
+                                status = 0;
+                                break;
+                            }
+                            break;
+                    case 2: if (combineSeparateTileSamples16bits (srcbuffs, bufp, ncol, nrow,
+                                                                  imagewidth, tw, spp, bps, 
+                                                                  NULL, 0, 0))
+                            {
+                                status = 0;
+                                break;
+                            }
+                            break;
+                    case 3: if (combineSeparateTileSamples24bits (srcbuffs, bufp, ncol, nrow,
+                                                                  imagewidth, tw, spp, bps, 
+                                                                  NULL, 0, 0))
+                            {
+                                status = 0;
+                                break;
+                            }
+                            break;
+                    case 4: 
+                    case 5:
+                    case 6:
+                    case 7:
+                    case 8: if (combineSeparateTileSamples32bits (srcbuffs, bufp, ncol, nrow,
+                                                                  imagewidth, tw, spp, bps, 
+                                                                  NULL, 0, 0))
+                            {
+                                status = 0;
+                                break;
+                            }
+                            break;
+                    default: TIFFError ("readSeparateTilesIntoBuffer", "Unsupported bit depth: %d", bps);
+                             status = 0;
+                             break;
+                }
+            }
         }
-      }
+        if (status == 0) break; // Exit if there's an error in tile processing
     }
 
-  for (sample = 0; (sample < spp) && (sample < MAX_SAMPLES); sample++)
+    for (sample = 0; (sample < spp) && (sample < MAX_SAMPLES); sample++)
     {
-    tbuff = srcbuffs[sample];
-    if (tbuff != NULL)
-      _TIFFfree(tbuff);
+        tbuff = srcbuffs[sample];
+        if (tbuff != NULL)
+            _TIFFfree(tbuff);
     }
- 
-  return status;
-  }
+
+    return status;
+}
+
 
 static int writeBufferToContigStrips(TIFF* out, uint8* buf, uint32 imagelength)
   {

2025-02-03 22:30:49.575 | DEBUG    | scenario:rebuild:369 - original environment: environ({'CONDA_SHLVL': '2', 'LC_ALL': 'C.UTF-8', 'LS_COLORS': 'rs=0:di=01;34:ln=01;36:mh=00:pi=40;33:so=01;35:do=01;35:bd=40;33;01:cd=40;33;01:or=40;31;01:mi=00:su=37;41:sg=30;43:ca=30;41:tw=30;42:ow=34;42:st=37;44:ex=01;32:*.tar=01;31:*.tgz=01;31:*.arc=01;31:*.arj=01;31:*.taz=01;31:*.lha=01;31:*.lz4=01;31:*.lzh=01;31:*.lzma=01;31:*.tlz=01;31:*.txz=01;31:*.tzo=01;31:*.t7z=01;31:*.zip=01;31:*.z=01;31:*.Z=01;31:*.dz=01;31:*.gz=01;31:*.lrz=01;31:*.lz=01;31:*.lzo=01;31:*.xz=01;31:*.zst=01;31:*.tzst=01;31:*.bz2=01;31:*.bz=01;31:*.tbz=01;31:*.tbz2=01;31:*.tz=01;31:*.deb=01;31:*.rpm=01;31:*.jar=01;31:*.war=01;31:*.ear=01;31:*.sar=01;31:*.rar=01;31:*.alz=01;31:*.ace=01;31:*.zoo=01;31:*.cpio=01;31:*.7z=01;31:*.rz=01;31:*.cab=01;31:*.wim=01;31:*.swm=01;31:*.dwm=01;31:*.esd=01;31:*.jpg=01;35:*.jpeg=01;35:*.mjpg=01;35:*.mjpeg=01;35:*.gif=01;35:*.bmp=01;35:*.pbm=01;35:*.pgm=01;35:*.ppm=01;35:*.tga=01;35:*.xbm=01;35:*.xpm=01;35:*.tif=01;35:*.tiff=01;35:*.png=01;35:*.svg=01;35:*.svgz=01;35:*.mng=01;35:*.pcx=01;35:*.mov=01;35:*.mpg=01;35:*.mpeg=01;35:*.m2v=01;35:*.mkv=01;35:*.webm=01;35:*.ogm=01;35:*.mp4=01;35:*.m4v=01;35:*.mp4v=01;35:*.vob=01;35:*.qt=01;35:*.nuv=01;35:*.wmv=01;35:*.asf=01;35:*.rm=01;35:*.rmvb=01;35:*.flc=01;35:*.avi=01;35:*.fli=01;35:*.flv=01;35:*.gl=01;35:*.dl=01;35:*.xcf=01;35:*.xwd=01;35:*.yuv=01;35:*.cgm=01;35:*.emf=01;35:*.ogv=01;35:*.ogx=01;35:*.aac=00;36:*.au=00;36:*.flac=00;36:*.m4a=00;36:*.mid=00;36:*.midi=00;36:*.mka=00;36:*.mp3=00;36:*.mpc=00;36:*.ogg=00;36:*.ra=00;36:*.wav=00;36:*.oga=00;36:*.opus=00;36:*.spx=00;36:*.xspf=00;36:', 'LD_LIBRARY_PATH': '/opt/crashrepair/lib:/CrashRepair/lib:/klee/build/lib:', 'CONDA_EXE': '/root/anaconda3/bin/conda', 'LANG': 'C.UTF-8', 'TZ': 'Asia/Shanghai', 'HOSTNAME': 'fea22102047d', 'OLDPWD': '/orchestrator', 'CONDA_PREFIX': '/root/anaconda3/envs/CrashRepair', '_CE_M': '', 'CC': 'crepair-cc', 'LLVM_COMPILER': 'clang', 'CONDA_PREFIX_1': '/root/anaconda3', 'PWD': '/orchestrator/crashrepair', 'HOME': '/root', 'CONDA_PYTHON_EXE': '/root/anaconda3/bin/python', '_CE_CONDA': '', 'CONDA_PROMPT_MODIFIER': '(CrashRepair) ', 'CXX': 'crepair-cxx', 'TERM': 'xterm', 'SHLVL': '2', 'PYTHONPATH': '/usr/lib/python3.8/site-packages:', 'PATH': '/root/anaconda3/envs/CrashRepair/bin:/root/anaconda3/condabin:~/anaconda3/bin:/opt/crashrepair/bin:/CrashRepair/compiler:/klee/build/bin:/opt/llvm-6/bin:/klee/build/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', 'CONDA_DEFAULT_ENV': 'CrashRepair', '_': '/root/anaconda3/envs/CrashRepair/bin/python'})
2025-02-03 22:30:49.575 | DEBUG    | scenario:rebuild:382 - injecting ghost function into CFLAGS during build: -lcrepair_ghost
2025-02-03 22:30:49.575 | DEBUG    | scenario:rebuild:398 - using environment: {'INJECT_CFLAGS': '-g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address', 'INJECT_CXXFLAGS': '-g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address', 'INJECT_LDFLAGS': '-g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address'}
2025-02-03 22:30:49.575 | DEBUG    | shell:__call__:41 - executing: make CFLAGS="${INJECT_CFLAGS}" CXXFLAGS="${INJECT_CXXFLAGS}" LDFLAGS="${INJECT_LDFLAGS}"
Making all in port
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/port'
make[1]: Nothing to be done for 'all'.
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/port'
Making all in libtiff
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/libtiff'
make  all-am
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/libtiff'
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/libtiff'
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/libtiff'
Making all in tools
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/tools'
crepair-cc -DHAVE_CONFIG_H -I. -I../libtiff  -I../libtiff   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -MT tiffcrop.o -MD -MP -MF .deps/tiffcrop.Tpo -c -o tiffcrop.o tiffcrop.c
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_ghost: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
mv -f .deps/tiffcrop.Tpo .deps/tiffcrop.Po
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address  -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -o tiffcrop tiffcrop.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -g -O0 -Wno-error -I/CrashRepair/lib -fsanitize=address -g -O0 -Wno-error -I/CrashRepair/lib -fsanitize=address -o tiffcrop tiffcrop.o  -L/klee/build/lib -L/CrashRepair/lib -lkleeRuntest -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost ../libtiff/.libs/libtiff.a ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/tools'
Making all in build
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/build'
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/build'
make[2]: Nothing to be done for 'all-am'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/build'
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/build'
Making all in contrib
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib'
Making all in addtiffo
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/addtiffo'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/addtiffo'
Making all in dbs
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/dbs'
Making all in xtiff
make[3]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/dbs/xtiff'
make[3]: Nothing to be done for 'all'.
make[3]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/dbs/xtiff'
make[3]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/dbs'
make[3]: Nothing to be done for 'all-am'.
make[3]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/dbs'
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/dbs'
Making all in iptcutil
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/iptcutil'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/iptcutil'
Making all in mfs
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/mfs'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/mfs'
Making all in pds
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/pds'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/pds'
Making all in ras
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/ras'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/ras'
Making all in stream
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/stream'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/stream'
Making all in tags
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/tags'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/tags'
Making all in win_dib
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/win_dib'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/win_dib'
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib'
make[2]: Nothing to be done for 'all-am'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib'
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib'
Making all in test
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/test'
make[1]: Nothing to be done for 'all'.
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/test'
Making all in man
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/man'
make[1]: Nothing to be done for 'all'.
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/man'
Making all in html
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html'
Making all in images
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html/images'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html/images'
Making all in man
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html/man'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html/man'
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html'
make[2]: Nothing to be done for 'all-am'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html'
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html'
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src'
make[1]: Nothing to be done for 'all-am'.
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src'
2025-02-03 22:30:50.082 | INFO     | analyzer:run:114 - running analysis with timeout: 60 minutes
2025-02-03 22:30:50.082 | DEBUG    | analyzer:write_config_to_file:88 - generated analyzer config:

dir_exp:/data/vulnloc/libtiff/CVE-2016-5321
tag_id:libtiff_CVE-2016-5321
src_directory:/data/vulnloc/libtiff/CVE-2016-5321/src
binary_path:/data/vulnloc/libtiff/CVE-2016-5321/src/tools/tiffcrop
config_command:./configure --enable-static --disable-shared
build_command:make CFLAGS="${INJECT_CFLAGS}" CXXFLAGS="${INJECT_CXXFLAGS}" LDFLAGS="${INJECT_LDFLAGS}"
test_input_list:$POC foo.tif
poc_list:/CrashRepair/experiments/vulnloc/libtiff/CVE-2016-5321/tests/1.tif
klee_flags:--link-llvm-lib=/CrashRepair/lib/libcrepair_proxy.bca 

2025-02-03 22:30:50.082 | DEBUG    | analyzer:run:124 - wrote analyzer config file to: /tmp/tmpeeyzwv3s
2025-02-03 22:30:50.082 | DEBUG    | shell:__call__:41 - executing: crepair --conf=/tmp/tmpeeyzwv3s
[K[1;36m
====================================================================================================

	Starting CRepair (C Crash Repair) 
====================================================================================================
[0m
[K[1;36m
	Loading Configurations
	__________________________________________________________________________________________
[0m
[K	[1;34mreading configuration values from arguments[0m
[K	[1;34mreading configuration values form configuration file[0m
[K	[1;37m	[file] /tmp/tmpeeyzwv3s[0m
[K	[1;34mupdating configuration values[0m
[K	[1;34mreading test configuration[0m
[K	[1;34mreading seed information[0m
[K	[1;37m	[config] stack size: 15000[0m
[K	[1;37m	[config] collecting stats: False[0m
[K	[1;37m	[config] number of tests: 1[0m
[K	[1;37m	[config] number of cores: 8[0m
[K	[1;37m	[config] klee concrete execution timeout: 600[0m
[K	[1;37m	[config] klee concolic execution timeout: 1200[0m
[K	[1;37m	[config] synthesize subset expressions: True[0m
[K	[1;37m	[config] window size for taint locations: 500[0m
[K	[1;37m	[config] window size for taint values: 500000[0m
[K[1;36m

	Analyzing Program
====================================================================================================
[0m
[K[1;36m
	Test Case #1
	__________________________________________________________________________________________
[0m
[K[1;36m
		Running Concrete Execution
		------------------------------------------------------------------------------------------
[0m
[K	[1;37m	[0m[K     [1;37mUsing Arguments: ['$POC', 'foo.tif'][0m
[K	[1;37m	[0m[K     [1;37mUsing Input File: /CrashRepair/experiments/vulnloc/libtiff/CVE-2016-5321/tests/1.tif[0m
[K	[1;34m	building program[0m
[K	[1;34m		setting environment variables[0m
[K	[1;34m		cleaning files[0m
[K	[1;34m		configuring program[0m
[K	[1;34m		compiling program[0m
[K	[1;37m	[0m[K     [1;37mUsing Binary: /data/vulnloc/libtiff/CVE-2016-5321/src/tools/tiffcrop[0m
[K	[1;34m	extracting bytecode[0m
[K	[1;34m	executing klee in concrete mode[0m
[K	[1;34m	extracting instruction trace[0m
[K	[1;37m		[note] program crashed[0m
[K	[1;34m	collecting tainted expressions[0m
[K	[1;34m	collecting tainted concrete values[0m
[K	[1;34m	collecting memory allocations/de-allocations[0m
[K	[1;34m	collecting pointer mapping[0m
[K	[1;34m	extracting crash information[0m
[K	[1;37m		[0m[K     [1;37m[info] crash type: memory read overflow[0m
[K	[1;37m		[0m[K     [1;37m[info] crash location:
                             /data/vulnloc/libtiff/CVE-2016-5321/src/tools/tiffcrop.c:996:43[0m
[K	[1;37m		[0m[K     [1;37m[info] crash function: readSeparateTilesIntoBuffer[0m
[K	[1;37m		[0m[K     [1;37m[info] crash address: 116503[0m
[K	[1;37m		[0m[K     [1;37m[info] crash free constraint: ((8 * @var(integer, s)) < 64)[0m
[K	[1;37m		[0m[K     [1;37m[info] crash inducing variables: s[0m
[K	[1;37m			[info] identified crash type: memory read overflow[0m
[K[1;36m
		Running Concolic Execution
		------------------------------------------------------------------------------------------
[0m
[K	[1;37m	[0m[K     [1;37mUsing Arguments: ['$POC', 'foo.tif'][0m
[K	[1;37m	[0m[K     [1;37mUsing Input File: /CrashRepair/experiments/vulnloc/libtiff/CVE-2016-5321/tests/1.tif[0m
[K	[1;34m	building program[0m
[K	[1;34m		setting environment variables[0m
[K	[1;34m		cleaning files[0m
[K	[1;34m		configuring program[0m
[K	[1;34m		compiling program[0m
[K	[1;34m	extracting bytecode[0m
[K	[1;34m	generating ktest file[0m
[K	[1;34m	executing klee in concolic mode[0m
[K	[1;34m	extracting largest symbolic path[0m
[K	[1;34m	extracting instruction trace[0m
[K	[1;37m		[note] program crashed[0m
[K	[1;34m	collecting tainted expressions[0m
[K	[1;34m	collecting memory allocations/de-allocations[0m
[K	[1;34m	collecting pointer mapping[0m
[K	[1;37m		[0m[K     [1;37m[info] Symbolic Mapping: s -> [][0m
[K[1;36m

	Fix Localization
====================================================================================================
[0m
[K[1;36m
	Generating Fix Locations
	__________________________________________________________________________________________
[0m
[K	[1;34m	generating taint map[0m
[K	[1;37m		[0m[K     [1;37m[info] found 10856 tainted locations[0m
[K	[1;34m		starting parallel computing[0m
[K	[1;34m		waiting for thread completion[0m
[K	[1;37m		[0m[K     [1;37m[info] found 5 source files[0m
[K	[1;37m		[0m[K     [1;37m[info] found 12 executed functions[0m
[K	[1;34m	generating possible fix locations[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] readSeparateTilesIntoBuffer,
                             /data/vulnloc/libtiff/CVE-2016-5321/src/tools/tiffcrop.c:993:35[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] readSeparateTilesIntoBuffer,
                             /data/vulnloc/libtiff/CVE-2016-5321/src/tools/tiffcrop.c:1007:33[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] readSeparateTilesIntoBuffer,
                             /data/vulnloc/libtiff/CVE-2016-5321/src/tools/tiffcrop.c:1007:26[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] readSeparateTilesIntoBuffer,
                             /data/vulnloc/libtiff/CVE-2016-5321/src/tools/tiffcrop.c:997:28[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] readSeparateTilesIntoBuffer,
                             /data/vulnloc/libtiff/CVE-2016-5321/src/tools/tiffcrop.c:997:21[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] readSeparateTilesIntoBuffer,
                             /data/vulnloc/libtiff/CVE-2016-5321/src/tools/tiffcrop.c:996:24[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] readSeparateTilesIntoBuffer,
                             /data/vulnloc/libtiff/CVE-2016-5321/src/tools/tiffcrop.c:996:26[0m
[K[1;36m
	Localizing Constraints
	__________________________________________________________________________________________
[0m
[K[1;36m
		[fix-loc] /data/vulnloc/libtiff/CVE-2016-5321/src/tools/tiffcrop.c:993:13
		------------------------------------------------------------------------------------------
[0m
[K	[1;37m	[0m[K     [1;37m[constraint] ((8 * @var(integer, s)) < 64)[0m
[K[1;36m
		[fix-loc] /data/vulnloc/libtiff/CVE-2016-5321/src/tools/tiffcrop.c:996:26
		------------------------------------------------------------------------------------------
[0m
[K	[1;37m	[0m[K     [1;37m[constraint] ((8 * @var(integer, s)) < 64)[0m
[K[1;36m
		[fix-loc] /data/vulnloc/libtiff/CVE-2016-5321/src/tools/tiffcrop.c:1007:22
		------------------------------------------------------------------------------------------
[0m
[K	[1;37m	[0m[K     [1;37m[constraint] ((8 * @var(integer, s)) < 64)[0m
[K[1;36m
		[fix-loc] /data/vulnloc/libtiff/CVE-2016-5321/src/tools/tiffcrop.c:997:17
		------------------------------------------------------------------------------------------
[0m
[K	[1;37m	[0m[K     [1;37m[constraint] ((8 * @var(integer, s)) < 64)[0m
[K[1;36m
		[fix-loc] /data/vulnloc/libtiff/CVE-2016-5321/src/tools/tiffcrop.c:996:17
		------------------------------------------------------------------------------------------
[0m
[K	[1;37m	[0m[K     [1;37m[constraint] ((8 * @var(integer, s)) < 64)[0m
[K[1;32m
	localization information saved at /CrashRepair/output/libtiff_CVE-2016-5321/localization.json[0m
[K[1;32m
	state values saved at /CrashRepair/output/libtiff_CVE-2016-5321/values/[0m
[K	[1;37m
Run time statistics:
-----------------------
[0m
[K	[1;37mStartup: 0.000 minutes[0m
[K	[1;37mBuild: 0 minutes[0m
[K	[1;37mConcrete Analysis: 0.663 minutes[0m
[K	[1;37mConcolic Analysis: 0.587 minutes[0m
[K	[1;37mTotal Analysis: 1.283 minutes[0m
[K	[1;37mLocalization: 0.340 minutes[0m
[K[1;32m
CRepair finished successfully after 1.663 minutes 
[0m
2025-02-03 22:32:30.808 | WARNING  | analyzer:run:143 - analysis output directory does not exist [/data/vulnloc/libtiff/CVE-2016-5321/analysis]: creating...
2025-02-03 22:32:30.924 | INFO     | scenario:iterative_repair:770 - iteratively repairing the vulnerability scenario
2025-02-03 22:32:30.924 | INFO     | scenario:iterative_repair:795 - generating candidate patches for iteration 0...
2025-02-03 22:32:30.931 | INFO     | scenario:iterative_repair:812 - applying candidate patch #19...
2025-02-03 22:32:30.931 | INFO     | scenario:iterative_repair:818 - generating candidate patches for 19 in iteration 0...
2025-02-03 22:32:30.931 | INFO     | LLMrepair:generate_use_llms_from_localization_list:219 - Generating candidates from localization dict
2025-02-03 22:36:34.439 | INFO     | LLMrepair:generate_use_llms_from_localization_list:263 - total_candidates:#[{'diff': '@@ -949,6 +949,7 @@\n   }\n \n \n+\n static int readSeparateTilesIntoBuffer (TIFF* in, uint8 *obuf, \n                                          uint32 imagelength, uint32 imagewidth, \n                                          uint32 tw, uint32 tl,\n@@ -968,6 +969,11 @@\n \n     bytes_per_sample = (bps + 7) / 8;\n \n+    if (spp >= 8) { // Enforce constraint\n+        TIFFError("readSeparateTilesIntoBuffer", "Sample per pixel too high: %d", spp);\n+        return 0;\n+    }\n+\n     for (sample = 0; (sample < spp) && (sample < MAX_SAMPLES); sample++)\n     {\n         srcbuffs[sample] = NULL;\n@@ -1103,6 +1109,7 @@\n }\n \n \n+\n static int writeBufferToContigStrips(TIFF* out, uint8* buf, uint32 imagelength)\n   {\n   uint32 row, nrows, rowsperstrip;\n', 'id': 0, 'location': '/data/vulnloc/libtiff/CVE-2016-5321/src/tools/tiffcrop.c:993:13'}, {'diff': '@@ -949,6 +949,7 @@\n   }\n \n \n+\n static int readSeparateTilesIntoBuffer (TIFF* in, uint8 *obuf, \n                                          uint32 imagelength, uint32 imagewidth, \n                                          uint32 tw, uint32 tl,\n@@ -968,6 +969,11 @@\n \n     bytes_per_sample = (bps + 7) / 8;\n \n+    if (spp > (64 / 8)) { // Prevent exceeding maximum sample size\n+        TIFFError("readSeparateTilesIntoBuffer", "Sample plane count exceeds maximum allowed.");\n+        return 0;\n+    }\n+\n     for (sample = 0; (sample < spp) && (sample < MAX_SAMPLES); sample++)\n     {\n         srcbuffs[sample] = NULL;\n@@ -1103,6 +1109,7 @@\n }\n \n \n+\n static int writeBufferToContigStrips(TIFF* out, uint8* buf, uint32 imagelength)\n   {\n   uint32 row, nrows, rowsperstrip;\n', 'id': 1, 'location': '/data/vulnloc/libtiff/CVE-2016-5321/src/tools/tiffcrop.c:993:13'}, {'diff': '@@ -949,6 +949,7 @@\n   }\n \n \n+\n static int readSeparateTilesIntoBuffer (TIFF* in, uint8 *obuf, \n                                          uint32 imagelength, uint32 imagewidth, \n                                          uint32 tw, uint32 tl,\n@@ -990,7 +991,7 @@\n         nrow = (row + tl > imagelength) ? imagelength - row : tl;\n         for (col = 0; col < imagewidth; col += tw)\n         {\n-            for (s = 0; s < spp; s++)\n+            for (s = 0; s < spp && s < 8; s++) // Restricting the maximum samples processed\n             {  \n                 /* Validate TIFFReadTile return value to avoid processing errors */\n                 tbytes = TIFFReadTile(in, srcbuffs[s], col, row, 0, s);\n@@ -1103,6 +1104,7 @@\n }\n \n \n+\n static int writeBufferToContigStrips(TIFF* out, uint8* buf, uint32 imagelength)\n   {\n   uint32 row, nrows, rowsperstrip;\n', 'id': 2, 'location': '/data/vulnloc/libtiff/CVE-2016-5321/src/tools/tiffcrop.c:993:13'}, {'diff': '@@ -949,6 +949,7 @@\n   }\n \n \n+\n static int readSeparateTilesIntoBuffer (TIFF* in, uint8 *obuf, \n                                          uint32 imagelength, uint32 imagewidth, \n                                          uint32 tw, uint32 tl,\n@@ -990,7 +991,7 @@\n         nrow = (row + tl > imagelength) ? imagelength - row : tl;\n         for (col = 0; col < imagewidth; col += tw)\n         {\n-            for (s = 0; s < spp; s++)\n+            for (s = 0; s < spp && s < (64 / 8); s++) // Fixed constraint\n             {  \n                 /* Validate TIFFReadTile return value to avoid processing errors */\n                 tbytes = TIFFReadTile(in, srcbuffs[s], col, row, 0, s);\n@@ -1103,6 +1104,7 @@\n }\n \n \n+\n static int writeBufferToContigStrips(TIFF* out, uint8* buf, uint32 imagelength)\n   {\n   uint32 row, nrows, rowsperstrip;\n', 'id': 3, 'location': '/data/vulnloc/libtiff/CVE-2016-5321/src/tools/tiffcrop.c:993:13'}, {'diff': '@@ -949,6 +949,7 @@\n   }\n \n \n+\n static int readSeparateTilesIntoBuffer (TIFF* in, uint8 *obuf, \n                                          uint32 imagelength, uint32 imagewidth, \n                                          uint32 tw, uint32 tl,\n@@ -990,30 +991,39 @@\n         nrow = (row + tl > imagelength) ? imagelength - row : tl;\n         for (col = 0; col < imagewidth; col += tw)\n         {\n-            for (s = 0; s < spp; s++)\n-            {  \n-                /* Validate TIFFReadTile return value to avoid processing errors */\n-                tbytes = TIFFReadTile(in, srcbuffs[s], col, row, 0, s);\n-                if (tbytes == (tsize_t)-1) // Handle error condition\n-                {\n-                    TIFFError(TIFFFileName(in),\n-                              "Error, can\'t read tile for row %lu col %lu, "\n-                              "sample %lu",\n-                              (unsigned long) col, (unsigned long) row,\n-                              (unsigned long) s);\n-                    status = 0;\n-                    break;\n-                }\n-                else if (tbytes == 0) // Handle a potential read failure\n-                {\n-                    TIFFError(TIFFFileName(in),\n-                              "Warning, read no bytes for tile at row %lu col %lu, "\n-                              "sample %lu",\n-                              (unsigned long) col, (unsigned long) row,\n-                              (unsigned long) s);\n-                    // Continue without breaking the loop\n+            if (spp * 8 >= 64) // Add constraint to prevent overflow\n+            {\n+                for (s = 0; s < spp; s++)\n+                {  \n+                    /* Validate TIFFReadTile return value to avoid processing errors */\n+                    tbytes = TIFFReadTile(in, srcbuffs[s], col, row, 0, s);\n+                    if (tbytes == (tsize_t)-1) // Handle error condition\n+                    {\n+                        TIFFError(TIFFFileName(in),\n+                                  "Error, can\'t read tile for row %lu col %lu, "\n+                                  "sample %lu",\n+                                  (unsigned long) col, (unsigned long) row,\n+                                  (unsigned long) s);\n+                        status = 0;\n+                        break;\n+                    }\n+                    else if (tbytes == 0) // Handle a potential read failure\n+                    {\n+                        TIFFError(TIFFFileName(in),\n+                                  "Warning, read no bytes for tile at row %lu col %lu, "\n+                                  "sample %lu",\n+                                  (unsigned long) col, (unsigned long) row,\n+                                  (unsigned long) s);\n+                        // Continue without breaking the loop\n+                    }\n                 }\n             }\n+            else\n+            {\n+                TIFFError("readSeparateTilesIntoBuffer", "Sample size too large: %d", spp);\n+                return 0; // Early exit on constraint violation\n+            }\n+\n             if (status == 0) break; // Exit outer loop if there was an error\n             /* Tiles on the right edge may be padded out to tw \n              * which must be a multiple of 16.\n@@ -1103,6 +1113,7 @@\n }\n \n \n+\n static int writeBufferToContigStrips(TIFF* out, uint8* buf, uint32 imagelength)\n   {\n   uint32 row, nrows, rowsperstrip;\n', 'id': 4, 'location': '/data/vulnloc/libtiff/CVE-2016-5321/src/tools/tiffcrop.c:993:13'}, {'diff': "@@ -949,6 +949,7 @@\n   }\n \n \n+\n static int readSeparateTilesIntoBuffer (TIFF* in, uint8 *obuf, \n                                          uint32 imagelength, uint32 imagewidth, \n                                          uint32 tw, uint32 tl,\n@@ -990,7 +991,7 @@\n         nrow = (row + tl > imagelength) ? imagelength - row : tl;\n         for (col = 0; col < imagewidth; col += tw)\n         {\n-            for (s = 0; s < spp; s++)\n+            for (s = 0; (s < spp) && (s < MAX_SAMPLES); s++) // Modify here to limit 's' to MAX_SAMPLES\n             {  \n                 /* Validate TIFFReadTile return value to avoid processing errors */\n                 tbytes = TIFFReadTile(in, srcbuffs[s], col, row, 0, s);\n@@ -1103,6 +1104,7 @@\n }\n \n \n+\n static int writeBufferToContigStrips(TIFF* out, uint8* buf, uint32 imagelength)\n   {\n   uint32 row, nrows, rowsperstrip;\n", 'id': 5, 'location': '/data/vulnloc/libtiff/CVE-2016-5321/src/tools/tiffcrop.c:996:26'}, {'diff': "@@ -949,6 +949,7 @@\n   }\n \n \n+\n static int readSeparateTilesIntoBuffer (TIFF* in, uint8 *obuf, \n                                          uint32 imagelength, uint32 imagewidth, \n                                          uint32 tw, uint32 tl,\n@@ -990,7 +991,7 @@\n         nrow = (row + tl > imagelength) ? imagelength - row : tl;\n         for (col = 0; col < imagewidth; col += tw)\n         {\n-            for (s = 0; s < spp; s++)\n+            for (s = 0; s < spp && s < 8; s++) // Added boundary check for 's'\n             {  \n                 /* Validate TIFFReadTile return value to avoid processing errors */\n                 tbytes = TIFFReadTile(in, srcbuffs[s], col, row, 0, s);\n@@ -1103,6 +1104,7 @@\n }\n \n \n+\n static int writeBufferToContigStrips(TIFF* out, uint8* buf, uint32 imagelength)\n   {\n   uint32 row, nrows, rowsperstrip;\n", 'id': 6, 'location': '/data/vulnloc/libtiff/CVE-2016-5321/src/tools/tiffcrop.c:996:26'}, {'diff': '@@ -949,6 +949,7 @@\n   }\n \n \n+\n static int readSeparateTilesIntoBuffer (TIFF* in, uint8 *obuf, \n                                          uint32 imagelength, uint32 imagewidth, \n                                          uint32 tw, uint32 tl,\n@@ -992,6 +993,14 @@\n         {\n             for (s = 0; s < spp; s++)\n             {  \n+                if (s >= 64) // Add check for sample index to prevent buffer overflow\n+                {\n+                    TIFFError("readSeparateTilesIntoBuffer",\n+                               "Sample index %d exceeds maximum allowed value", s);\n+                    status = 0;\n+                    break;\n+                }\n+\n                 /* Validate TIFFReadTile return value to avoid processing errors */\n                 tbytes = TIFFReadTile(in, srcbuffs[s], col, row, 0, s);\n                 if (tbytes == (tsize_t)-1) // Handle error condition\n@@ -1103,6 +1112,7 @@\n }\n \n \n+\n static int writeBufferToContigStrips(TIFF* out, uint8* buf, uint32 imagelength)\n   {\n   uint32 row, nrows, rowsperstrip;\n', 'id': 7, 'location': '/data/vulnloc/libtiff/CVE-2016-5321/src/tools/tiffcrop.c:996:26'}, {'diff': "@@ -949,6 +949,7 @@\n   }\n \n \n+\n static int readSeparateTilesIntoBuffer (TIFF* in, uint8 *obuf, \n                                          uint32 imagelength, uint32 imagewidth, \n                                          uint32 tw, uint32 tl,\n@@ -990,7 +991,7 @@\n         nrow = (row + tl > imagelength) ? imagelength - row : tl;\n         for (col = 0; col < imagewidth; col += tw)\n         {\n-            for (s = 0; s < spp; s++)\n+            for (s = 0; s < spp && s < 64 / 8; s++) // Added constraint check for 's'\n             {  \n                 /* Validate TIFFReadTile return value to avoid processing errors */\n                 tbytes = TIFFReadTile(in, srcbuffs[s], col, row, 0, s);\n@@ -1103,6 +1104,7 @@\n }\n \n \n+\n static int writeBufferToContigStrips(TIFF* out, uint8* buf, uint32 imagelength)\n   {\n   uint32 row, nrows, rowsperstrip;\n", 'id': 8, 'location': '/data/vulnloc/libtiff/CVE-2016-5321/src/tools/tiffcrop.c:996:26'}, {'diff': '@@ -949,6 +949,7 @@\n   }\n \n \n+\n static int readSeparateTilesIntoBuffer (TIFF* in, uint8 *obuf, \n                                          uint32 imagelength, uint32 imagewidth, \n                                          uint32 tw, uint32 tl,\n@@ -990,7 +991,7 @@\n         nrow = (row + tl > imagelength) ? imagelength - row : tl;\n         for (col = 0; col < imagewidth; col += tw)\n         {\n-            for (s = 0; s < spp; s++)\n+            for (s = 0; s < spp && (8 * s) < 64; s++) // Added bound check for s\n             {  \n                 /* Validate TIFFReadTile return value to avoid processing errors */\n                 tbytes = TIFFReadTile(in, srcbuffs[s], col, row, 0, s);\n@@ -1103,6 +1104,7 @@\n }\n \n \n+\n static int writeBufferToContigStrips(TIFF* out, uint8* buf, uint32 imagelength)\n   {\n   uint32 row, nrows, rowsperstrip;\n', 'id': 9, 'location': '/data/vulnloc/libtiff/CVE-2016-5321/src/tools/tiffcrop.c:996:26'}]
2025-02-03 22:36:34.440 | INFO     | scenario:validate:475 - beginning candidate patch evaluation with time limit: 45 minutes
2025-02-03 22:36:34.440 | DEBUG    | scenario:rebuild:369 - original environment: environ({'CONDA_SHLVL': '2', 'LC_ALL': 'C.UTF-8', 'LS_COLORS': 'rs=0:di=01;34:ln=01;36:mh=00:pi=40;33:so=01;35:do=01;35:bd=40;33;01:cd=40;33;01:or=40;31;01:mi=00:su=37;41:sg=30;43:ca=30;41:tw=30;42:ow=34;42:st=37;44:ex=01;32:*.tar=01;31:*.tgz=01;31:*.arc=01;31:*.arj=01;31:*.taz=01;31:*.lha=01;31:*.lz4=01;31:*.lzh=01;31:*.lzma=01;31:*.tlz=01;31:*.txz=01;31:*.tzo=01;31:*.t7z=01;31:*.zip=01;31:*.z=01;31:*.Z=01;31:*.dz=01;31:*.gz=01;31:*.lrz=01;31:*.lz=01;31:*.lzo=01;31:*.xz=01;31:*.zst=01;31:*.tzst=01;31:*.bz2=01;31:*.bz=01;31:*.tbz=01;31:*.tbz2=01;31:*.tz=01;31:*.deb=01;31:*.rpm=01;31:*.jar=01;31:*.war=01;31:*.ear=01;31:*.sar=01;31:*.rar=01;31:*.alz=01;31:*.ace=01;31:*.zoo=01;31:*.cpio=01;31:*.7z=01;31:*.rz=01;31:*.cab=01;31:*.wim=01;31:*.swm=01;31:*.dwm=01;31:*.esd=01;31:*.jpg=01;35:*.jpeg=01;35:*.mjpg=01;35:*.mjpeg=01;35:*.gif=01;35:*.bmp=01;35:*.pbm=01;35:*.pgm=01;35:*.ppm=01;35:*.tga=01;35:*.xbm=01;35:*.xpm=01;35:*.tif=01;35:*.tiff=01;35:*.png=01;35:*.svg=01;35:*.svgz=01;35:*.mng=01;35:*.pcx=01;35:*.mov=01;35:*.mpg=01;35:*.mpeg=01;35:*.m2v=01;35:*.mkv=01;35:*.webm=01;35:*.ogm=01;35:*.mp4=01;35:*.m4v=01;35:*.mp4v=01;35:*.vob=01;35:*.qt=01;35:*.nuv=01;35:*.wmv=01;35:*.asf=01;35:*.rm=01;35:*.rmvb=01;35:*.flc=01;35:*.avi=01;35:*.fli=01;35:*.flv=01;35:*.gl=01;35:*.dl=01;35:*.xcf=01;35:*.xwd=01;35:*.yuv=01;35:*.cgm=01;35:*.emf=01;35:*.ogv=01;35:*.ogx=01;35:*.aac=00;36:*.au=00;36:*.flac=00;36:*.m4a=00;36:*.mid=00;36:*.midi=00;36:*.mka=00;36:*.mp3=00;36:*.mpc=00;36:*.ogg=00;36:*.ra=00;36:*.wav=00;36:*.oga=00;36:*.opus=00;36:*.spx=00;36:*.xspf=00;36:', 'LD_LIBRARY_PATH': '/opt/crashrepair/lib:/CrashRepair/lib:/klee/build/lib:', 'CONDA_EXE': '/root/anaconda3/bin/conda', 'LANG': 'C.UTF-8', 'TZ': 'Asia/Shanghai', 'HOSTNAME': 'fea22102047d', 'OLDPWD': '/orchestrator', 'CONDA_PREFIX': '/root/anaconda3/envs/CrashRepair', '_CE_M': '', 'CC': 'crepair-cc', 'LLVM_COMPILER': 'clang', 'CONDA_PREFIX_1': '/root/anaconda3', 'PWD': '/orchestrator/crashrepair', 'HOME': '/root', 'CONDA_PYTHON_EXE': '/root/anaconda3/bin/python', '_CE_CONDA': '', 'CONDA_PROMPT_MODIFIER': '(CrashRepair) ', 'CXX': 'crepair-cxx', 'TERM': 'xterm', 'SHLVL': '2', 'PYTHONPATH': '/usr/lib/python3.8/site-packages:', 'PATH': '/root/anaconda3/envs/CrashRepair/bin:/root/anaconda3/condabin:~/anaconda3/bin:/opt/crashrepair/bin:/CrashRepair/compiler:/klee/build/bin:/opt/llvm-6/bin:/klee/build/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', 'CONDA_DEFAULT_ENV': 'CrashRepair', '_': '/root/anaconda3/envs/CrashRepair/bin/python'})
2025-02-03 22:36:34.440 | DEBUG    | scenario:rebuild:382 - injecting ghost function into CFLAGS during build: -lcrepair_ghost
2025-02-03 22:36:34.440 | DEBUG    | scenario:rebuild:398 - using environment: {'INJECT_CFLAGS': '-g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address', 'INJECT_CXXFLAGS': '-g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address', 'INJECT_LDFLAGS': '-g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address'}
2025-02-03 22:36:34.440 | DEBUG    | shell:__call__:41 - executing: make clean
Making clean in port
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/port'
rm -rf .libs _libs
test -z "libport.la" || rm -f libport.la
rm -f ./so_locations
rm -f *.o
rm -f *.lo
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/port'
Making clean in libtiff
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/libtiff'
test -z "libtiff.la libtiffxx.la" || rm -f libtiff.la libtiffxx.la
rm -f ./so_locations
rm -rf .libs _libs
 rm -f mkg3states
rm -f *.o
rm -f *.lo
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/libtiff'
Making clean in tools
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/tools'
 rm -f bmp2tiff fax2ps fax2tiff gif2tiff pal2rgb ppm2tiff ras2tiff raw2tiff rgb2ycbcr thumbnail tiff2bw tiff2pdf tiff2ps tiff2rgba tiffcmp tiffcp tiffcrop tiffdither tiffdump tiffinfo tiffmedian tiffset tiffsplit
rm -rf .libs _libs
rm -f *.o
rm -f *.lo
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/tools'
Making clean in build
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/build'
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/build'
rm -rf .libs _libs
rm -f *.lo
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/build'
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/build'
Making clean in contrib
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib'
Making clean in addtiffo
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/addtiffo'
rm -rf .libs _libs
 rm -f addtiffo
rm -f *.o
rm -f *.lo
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/addtiffo'
Making clean in dbs
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/dbs'
Making clean in xtiff
make[3]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/dbs/xtiff'
rm -rf .libs _libs
rm -f *.lo
make[3]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/dbs/xtiff'
make[3]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/dbs'
rm -rf .libs _libs
 rm -f tiff-bi tiff-grayscale tiff-palette tiff-rgb
rm -f *.o
rm -f *.lo
make[3]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/dbs'
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/dbs'
Making clean in iptcutil
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/iptcutil'
rm -rf .libs _libs
 rm -f iptcutil
rm -f *.o
rm -f *.lo
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/iptcutil'
Making clean in mfs
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/mfs'
rm -rf .libs _libs
rm -f *.lo
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/mfs'
Making clean in pds
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/pds'
rm -rf .libs _libs
rm -f *.lo
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/pds'
Making clean in ras
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/ras'
rm -rf .libs _libs
rm -f *.lo
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/ras'
Making clean in stream
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/stream'
rm -rf .libs _libs
rm -f *.lo
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/stream'
Making clean in tags
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/tags'
rm -rf .libs _libs
rm -f *.lo
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/tags'
Making clean in win_dib
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/win_dib'
rm -rf .libs _libs
rm -f *.lo
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/win_dib'
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib'
rm -rf .libs _libs
rm -f *.lo
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib'
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib'
Making clean in test
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/test'
 rm -f ascii_tag long_tag short_tag strip_rw rewrite custom_dir raw_decode
test -z "test_packbits.tif o-*" || rm -f test_packbits.tif o-*
rm -rf .libs _libs
rm -f *.o
test -z "ascii_tag.log long_tag.log short_tag.log strip_rw.log rewrite.log custom_dir.log raw_decode.log bmp2tiff_palette.sh.log bmp2tiff_rgb.sh.log gif2tiff.sh.log ppm2tiff_pbm.sh.log ppm2tiff_pgm.sh.log ppm2tiff_ppm.sh.log tiffcp-g3.sh.log tiffcp-g3-1d.sh.log tiffcp-g3-1d-fill.sh.log tiffcp-g3-2d.sh.log tiffcp-g3-2d-fill.sh.log tiffcp-g4.sh.log tiffcp-logluv.sh.log tiffcp-thumbnail.sh.log tiffdump.sh.log tiffinfo.sh.log tiffcp-split.sh.log tiffcp-split-join.sh.log tiff2ps-PS1.sh.log tiff2ps-PS2.sh.log tiff2ps-PS3.sh.log tiff2ps-EPS1.sh.log tiff2pdf.sh.log tiffcrop-doubleflip-logluv-3c-16b.sh.log tiffcrop-doubleflip-minisblack-1c-16b.sh.log tiffcrop-doubleflip-minisblack-1c-8b.sh.log tiffcrop-doubleflip-minisblack-2c-8b-alpha.sh.log tiffcrop-doubleflip-miniswhite-1c-1b.sh.log tiffcrop-doubleflip-palette-1c-1b.sh.log tiffcrop-doubleflip-palette-1c-4b.sh.log tiffcrop-doubleflip-palette-1c-8b.sh.log tiffcrop-doubleflip-rgb-3c-16b.sh.log tiffcrop-doubleflip-rgb-3c-8b.sh.log tiffcrop-extract-logluv-3c-16b.sh.log tiffcrop-extract-minisblack-1c-16b.sh.log tiffcrop-extract-minisblack-1c-8b.sh.log tiffcrop-extract-minisblack-2c-8b-alpha.sh.log tiffcrop-extract-miniswhite-1c-1b.sh.log tiffcrop-extract-palette-1c-1b.sh.log tiffcrop-extract-palette-1c-4b.sh.log tiffcrop-extract-palette-1c-8b.sh.log tiffcrop-extract-rgb-3c-16b.sh.log tiffcrop-extract-rgb-3c-8b.sh.log tiffcrop-extractz14-logluv-3c-16b.sh.log tiffcrop-extractz14-minisblack-1c-16b.sh.log tiffcrop-extractz14-minisblack-1c-8b.sh.log tiffcrop-extractz14-minisblack-2c-8b-alpha.sh.log tiffcrop-extractz14-miniswhite-1c-1b.sh.log tiffcrop-extractz14-palette-1c-1b.sh.log tiffcrop-extractz14-palette-1c-4b.sh.log tiffcrop-extractz14-palette-1c-8b.sh.log tiffcrop-extractz14-rgb-3c-16b.sh.log tiffcrop-extractz14-rgb-3c-8b.sh.log tiffcrop-R90-logluv-3c-16b.sh.log tiffcrop-R90-minisblack-1c-16b.sh.log tiffcrop-R90-minisblack-1c-8b.sh.log tiffcrop-R90-minisblack-2c-8b-alpha.sh.log tiffcrop-R90-miniswhite-1c-1b.sh.log tiffcrop-R90-palette-1c-1b.sh.log tiffcrop-R90-palette-1c-4b.sh.log tiffcrop-R90-palette-1c-8b.sh.log tiffcrop-R90-rgb-3c-16b.sh.log tiffcrop-R90-rgb-3c-8b.sh.log tiff2rgba-logluv-3c-16b.sh.log tiff2rgba-minisblack-1c-16b.sh.log tiff2rgba-minisblack-1c-8b.sh.log tiff2rgba-minisblack-2c-8b-alpha.sh.log tiff2rgba-miniswhite-1c-1b.sh.log tiff2rgba-palette-1c-1b.sh.log tiff2rgba-palette-1c-4b.sh.log tiff2rgba-palette-1c-8b.sh.log tiff2rgba-rgb-3c-16b.sh.log tiff2rgba-rgb-3c-8b.sh.log tiff2rgba-quad-tile.jpg.sh.log" || rm -f ascii_tag.log long_tag.log short_tag.log strip_rw.log rewrite.log custom_dir.log raw_decode.log bmp2tiff_palette.sh.log bmp2tiff_rgb.sh.log gif2tiff.sh.log ppm2tiff_pbm.sh.log ppm2tiff_pgm.sh.log ppm2tiff_ppm.sh.log tiffcp-g3.sh.log tiffcp-g3-1d.sh.log tiffcp-g3-1d-fill.sh.log tiffcp-g3-2d.sh.log tiffcp-g3-2d-fill.sh.log tiffcp-g4.sh.log tiffcp-logluv.sh.log tiffcp-thumbnail.sh.log tiffdump.sh.log tiffinfo.sh.log tiffcp-split.sh.log tiffcp-split-join.sh.log tiff2ps-PS1.sh.log tiff2ps-PS2.sh.log tiff2ps-PS3.sh.log tiff2ps-EPS1.sh.log tiff2pdf.sh.log tiffcrop-doubleflip-logluv-3c-16b.sh.log tiffcrop-doubleflip-minisblack-1c-16b.sh.log tiffcrop-doubleflip-minisblack-1c-8b.sh.log tiffcrop-doubleflip-minisblack-2c-8b-alpha.sh.log tiffcrop-doubleflip-miniswhite-1c-1b.sh.log tiffcrop-doubleflip-palette-1c-1b.sh.log tiffcrop-doubleflip-palette-1c-4b.sh.log tiffcrop-doubleflip-palette-1c-8b.sh.log tiffcrop-doubleflip-rgb-3c-16b.sh.log tiffcrop-doubleflip-rgb-3c-8b.sh.log tiffcrop-extract-logluv-3c-16b.sh.log tiffcrop-extract-minisblack-1c-16b.sh.log tiffcrop-extract-minisblack-1c-8b.sh.log tiffcrop-extract-minisblack-2c-8b-alpha.sh.log tiffcrop-extract-miniswhite-1c-1b.sh.log tiffcrop-extract-palette-1c-1b.sh.log tiffcrop-extract-palette-1c-4b.sh.log tiffcrop-extract-palette-1c-8b.sh.log tiffcrop-extract-rgb-3c-16b.sh.log tiffcrop-extract-rgb-3c-8b.sh.log tiffcrop-extractz14-logluv-3c-16b.sh.log tiffcrop-extractz14-minisblack-1c-16b.sh.log tiffcrop-extractz14-minisblack-1c-8b.sh.log tiffcrop-extractz14-minisblack-2c-8b-alpha.sh.log tiffcrop-extractz14-miniswhite-1c-1b.sh.log tiffcrop-extractz14-palette-1c-1b.sh.log tiffcrop-extractz14-palette-1c-4b.sh.log tiffcrop-extractz14-palette-1c-8b.sh.log tiffcrop-extractz14-rgb-3c-16b.sh.log tiffcrop-extractz14-rgb-3c-8b.sh.log tiffcrop-R90-logluv-3c-16b.sh.log tiffcrop-R90-minisblack-1c-16b.sh.log tiffcrop-R90-minisblack-1c-8b.sh.log tiffcrop-R90-minisblack-2c-8b-alpha.sh.log tiffcrop-R90-miniswhite-1c-1b.sh.log tiffcrop-R90-palette-1c-1b.sh.log tiffcrop-R90-palette-1c-4b.sh.log tiffcrop-R90-palette-1c-8b.sh.log tiffcrop-R90-rgb-3c-16b.sh.log tiffcrop-R90-rgb-3c-8b.sh.log tiff2rgba-logluv-3c-16b.sh.log tiff2rgba-minisblack-1c-16b.sh.log tiff2rgba-minisblack-1c-8b.sh.log tiff2rgba-minisblack-2c-8b-alpha.sh.log tiff2rgba-miniswhite-1c-1b.sh.log tiff2rgba-palette-1c-1b.sh.log tiff2rgba-palette-1c-4b.sh.log tiff2rgba-palette-1c-8b.sh.log tiff2rgba-rgb-3c-16b.sh.log tiff2rgba-rgb-3c-8b.sh.log tiff2rgba-quad-tile.jpg.sh.log
test -z "ascii_tag.trs long_tag.trs short_tag.trs strip_rw.trs rewrite.trs custom_dir.trs raw_decode.trs bmp2tiff_palette.sh.trs bmp2tiff_rgb.sh.trs gif2tiff.sh.trs ppm2tiff_pbm.sh.trs ppm2tiff_pgm.sh.trs ppm2tiff_ppm.sh.trs tiffcp-g3.sh.trs tiffcp-g3-1d.sh.trs tiffcp-g3-1d-fill.sh.trs tiffcp-g3-2d.sh.trs tiffcp-g3-2d-fill.sh.trs tiffcp-g4.sh.trs tiffcp-logluv.sh.trs tiffcp-thumbnail.sh.trs tiffdump.sh.trs tiffinfo.sh.trs tiffcp-split.sh.trs tiffcp-split-join.sh.trs tiff2ps-PS1.sh.trs tiff2ps-PS2.sh.trs tiff2ps-PS3.sh.trs tiff2ps-EPS1.sh.trs tiff2pdf.sh.trs tiffcrop-doubleflip-logluv-3c-16b.sh.trs tiffcrop-doubleflip-minisblack-1c-16b.sh.trs tiffcrop-doubleflip-minisblack-1c-8b.sh.trs tiffcrop-doubleflip-minisblack-2c-8b-alpha.sh.trs tiffcrop-doubleflip-miniswhite-1c-1b.sh.trs tiffcrop-doubleflip-palette-1c-1b.sh.trs tiffcrop-doubleflip-palette-1c-4b.sh.trs tiffcrop-doubleflip-palette-1c-8b.sh.trs tiffcrop-doubleflip-rgb-3c-16b.sh.trs tiffcrop-doubleflip-rgb-3c-8b.sh.trs tiffcrop-extract-logluv-3c-16b.sh.trs tiffcrop-extract-minisblack-1c-16b.sh.trs tiffcrop-extract-minisblack-1c-8b.sh.trs tiffcrop-extract-minisblack-2c-8b-alpha.sh.trs tiffcrop-extract-miniswhite-1c-1b.sh.trs tiffcrop-extract-palette-1c-1b.sh.trs tiffcrop-extract-palette-1c-4b.sh.trs tiffcrop-extract-palette-1c-8b.sh.trs tiffcrop-extract-rgb-3c-16b.sh.trs tiffcrop-extract-rgb-3c-8b.sh.trs tiffcrop-extractz14-logluv-3c-16b.sh.trs tiffcrop-extractz14-minisblack-1c-16b.sh.trs tiffcrop-extractz14-minisblack-1c-8b.sh.trs tiffcrop-extractz14-minisblack-2c-8b-alpha.sh.trs tiffcrop-extractz14-miniswhite-1c-1b.sh.trs tiffcrop-extractz14-palette-1c-1b.sh.trs tiffcrop-extractz14-palette-1c-4b.sh.trs tiffcrop-extractz14-palette-1c-8b.sh.trs tiffcrop-extractz14-rgb-3c-16b.sh.trs tiffcrop-extractz14-rgb-3c-8b.sh.trs tiffcrop-R90-logluv-3c-16b.sh.trs tiffcrop-R90-minisblack-1c-16b.sh.trs tiffcrop-R90-minisblack-1c-8b.sh.trs tiffcrop-R90-minisblack-2c-8b-alpha.sh.trs tiffcrop-R90-miniswhite-1c-1b.sh.trs tiffcrop-R90-palette-1c-1b.sh.trs tiffcrop-R90-palette-1c-4b.sh.trs tiffcrop-R90-palette-1c-8b.sh.trs tiffcrop-R90-rgb-3c-16b.sh.trs tiffcrop-R90-rgb-3c-8b.sh.trs tiff2rgba-logluv-3c-16b.sh.trs tiff2rgba-minisblack-1c-16b.sh.trs tiff2rgba-minisblack-1c-8b.sh.trs tiff2rgba-minisblack-2c-8b-alpha.sh.trs tiff2rgba-miniswhite-1c-1b.sh.trs tiff2rgba-palette-1c-1b.sh.trs tiff2rgba-palette-1c-4b.sh.trs tiff2rgba-palette-1c-8b.sh.trs tiff2rgba-rgb-3c-16b.sh.trs tiff2rgba-rgb-3c-8b.sh.trs tiff2rgba-quad-tile.jpg.sh.trs" || rm -f ascii_tag.trs long_tag.trs short_tag.trs strip_rw.trs rewrite.trs custom_dir.trs raw_decode.trs bmp2tiff_palette.sh.trs bmp2tiff_rgb.sh.trs gif2tiff.sh.trs ppm2tiff_pbm.sh.trs ppm2tiff_pgm.sh.trs ppm2tiff_ppm.sh.trs tiffcp-g3.sh.trs tiffcp-g3-1d.sh.trs tiffcp-g3-1d-fill.sh.trs tiffcp-g3-2d.sh.trs tiffcp-g3-2d-fill.sh.trs tiffcp-g4.sh.trs tiffcp-logluv.sh.trs tiffcp-thumbnail.sh.trs tiffdump.sh.trs tiffinfo.sh.trs tiffcp-split.sh.trs tiffcp-split-join.sh.trs tiff2ps-PS1.sh.trs tiff2ps-PS2.sh.trs tiff2ps-PS3.sh.trs tiff2ps-EPS1.sh.trs tiff2pdf.sh.trs tiffcrop-doubleflip-logluv-3c-16b.sh.trs tiffcrop-doubleflip-minisblack-1c-16b.sh.trs tiffcrop-doubleflip-minisblack-1c-8b.sh.trs tiffcrop-doubleflip-minisblack-2c-8b-alpha.sh.trs tiffcrop-doubleflip-miniswhite-1c-1b.sh.trs tiffcrop-doubleflip-palette-1c-1b.sh.trs tiffcrop-doubleflip-palette-1c-4b.sh.trs tiffcrop-doubleflip-palette-1c-8b.sh.trs tiffcrop-doubleflip-rgb-3c-16b.sh.trs tiffcrop-doubleflip-rgb-3c-8b.sh.trs tiffcrop-extract-logluv-3c-16b.sh.trs tiffcrop-extract-minisblack-1c-16b.sh.trs tiffcrop-extract-minisblack-1c-8b.sh.trs tiffcrop-extract-minisblack-2c-8b-alpha.sh.trs tiffcrop-extract-miniswhite-1c-1b.sh.trs tiffcrop-extract-palette-1c-1b.sh.trs tiffcrop-extract-palette-1c-4b.sh.trs tiffcrop-extract-palette-1c-8b.sh.trs tiffcrop-extract-rgb-3c-16b.sh.trs tiffcrop-extract-rgb-3c-8b.sh.trs tiffcrop-extractz14-logluv-3c-16b.sh.trs tiffcrop-extractz14-minisblack-1c-16b.sh.trs tiffcrop-extractz14-minisblack-1c-8b.sh.trs tiffcrop-extractz14-minisblack-2c-8b-alpha.sh.trs tiffcrop-extractz14-miniswhite-1c-1b.sh.trs tiffcrop-extractz14-palette-1c-1b.sh.trs tiffcrop-extractz14-palette-1c-4b.sh.trs tiffcrop-extractz14-palette-1c-8b.sh.trs tiffcrop-extractz14-rgb-3c-16b.sh.trs tiffcrop-extractz14-rgb-3c-8b.sh.trs tiffcrop-R90-logluv-3c-16b.sh.trs tiffcrop-R90-minisblack-1c-16b.sh.trs tiffcrop-R90-minisblack-1c-8b.sh.trs tiffcrop-R90-minisblack-2c-8b-alpha.sh.trs tiffcrop-R90-miniswhite-1c-1b.sh.trs tiffcrop-R90-palette-1c-1b.sh.trs tiffcrop-R90-palette-1c-4b.sh.trs tiffcrop-R90-palette-1c-8b.sh.trs tiffcrop-R90-rgb-3c-16b.sh.trs tiffcrop-R90-rgb-3c-8b.sh.trs tiff2rgba-logluv-3c-16b.sh.trs tiff2rgba-minisblack-1c-16b.sh.trs tiff2rgba-minisblack-1c-8b.sh.trs tiff2rgba-minisblack-2c-8b-alpha.sh.trs tiff2rgba-miniswhite-1c-1b.sh.trs tiff2rgba-palette-1c-1b.sh.trs tiff2rgba-palette-1c-4b.sh.trs tiff2rgba-palette-1c-8b.sh.trs tiff2rgba-rgb-3c-16b.sh.trs tiff2rgba-rgb-3c-8b.sh.trs tiff2rgba-quad-tile.jpg.sh.trs
test -z "test-suite.log" || rm -f test-suite.log
rm -f *.lo
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/test'
Making clean in man
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/man'
rm -rf .libs _libs
rm -f *.lo
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/man'
Making clean in html
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html'
Making clean in images
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html/images'
rm -rf .libs _libs
rm -f *.lo
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html/images'
Making clean in man
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html/man'
rm -rf .libs _libs
rm -f *.lo
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html/man'
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html'
rm -rf .libs _libs
rm -f *.lo
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html'
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html'
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src'
rm -rf .libs _libs
rm -f *.lo
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src'
2025-02-03 22:36:34.574 | DEBUG    | shell:__call__:41 - executing: make CFLAGS="${INJECT_CFLAGS}" CXXFLAGS="${INJECT_CXXFLAGS}" LDFLAGS="${INJECT_LDFLAGS}"
Making all in port
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/port'
/bin/bash ../libtool  --tag=CC   --mode=compile crepair-cc -DHAVE_CONFIG_H -I. -I../libtiff     -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -MT dummy.lo -MD -MP -MF .deps/dummy.Tpo -c -o dummy.lo dummy.c
libtool: compile:  crepair-cc -DHAVE_CONFIG_H -I. -I../libtiff -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -MT dummy.lo -MD -MP -MF .deps/dummy.Tpo -c dummy.c -o dummy.o
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_ghost: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
mv -f .deps/dummy.Tpo .deps/dummy.Plo
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address  -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -o libport.la  dummy.lo  -llzma -ljbig -ljpeg -lz -lm 
libtool: link: ar cru .libs/libport.a  dummy.o
ar: `u' modifier ignored since `D' is the default (see `U')
libtool: link: ranlib .libs/libport.a
libtool: link: ( cd ".libs" && rm -f "libport.la" && ln -s "../libport.la" "libport.la" )
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/port'
Making all in libtiff
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/libtiff'
make  all-am
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/libtiff'
/bin/bash ../libtool  --tag=CC   --mode=compile crepair-cc -DHAVE_CONFIG_H -I.     -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -MT tif_aux.lo -MD -MP -MF .deps/tif_aux.Tpo -c -o tif_aux.lo tif_aux.c
libtool: compile:  crepair-cc -DHAVE_CONFIG_H -I. -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -MT tif_aux.lo -MD -MP -MF .deps/tif_aux.Tpo -c tif_aux.c -o tif_aux.o
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_ghost: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
mv -f .deps/tif_aux.Tpo .deps/tif_aux.Plo
/bin/bash ../libtool  --tag=CC   --mode=compile crepair-cc -DHAVE_CONFIG_H -I.     -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -MT tif_close.lo -MD -MP -MF .deps/tif_close.Tpo -c -o tif_close.lo tif_close.c
libtool: compile:  crepair-cc -DHAVE_CONFIG_H -I. -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -MT tif_close.lo -MD -MP -MF .deps/tif_close.Tpo -c tif_close.c -o tif_close.o
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_ghost: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
mv -f .deps/tif_close.Tpo .deps/tif_close.Plo
/bin/bash ../libtool  --tag=CC   --mode=compile crepair-cc -DHAVE_CONFIG_H -I.     -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -MT tif_codec.lo -MD -MP -MF .deps/tif_codec.Tpo -c -o tif_codec.lo tif_codec.c
libtool: compile:  crepair-cc -DHAVE_CONFIG_H -I. -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -MT tif_codec.lo -MD -MP -MF .deps/tif_codec.Tpo -c tif_codec.c -o tif_codec.o
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_ghost: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
mv -f .deps/tif_codec.Tpo .deps/tif_codec.Plo
/bin/bash ../libtool  --tag=CC   --mode=compile crepair-cc -DHAVE_CONFIG_H -I.     -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -MT tif_color.lo -MD -MP -MF .deps/tif_color.Tpo -c -o tif_color.lo tif_color.c
libtool: compile:  crepair-cc -DHAVE_CONFIG_H -I. -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -MT tif_color.lo -MD -MP -MF .deps/tif_color.Tpo -c tif_color.c -o tif_color.o
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_ghost: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
mv -f .deps/tif_color.Tpo .deps/tif_color.Plo
/bin/bash ../libtool  --tag=CC   --mode=compile crepair-cc -DHAVE_CONFIG_H -I.     -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -MT tif_compress.lo -MD -MP -MF .deps/tif_compress.Tpo -c -o tif_compress.lo tif_compress.c
libtool: compile:  crepair-cc -DHAVE_CONFIG_H -I. -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -MT tif_compress.lo -MD -MP -MF .deps/tif_compress.Tpo -c tif_compress.c -o tif_compress.o
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_ghost: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
mv -f .deps/tif_compress.Tpo .deps/tif_compress.Plo
/bin/bash ../libtool  --tag=CC   --mode=compile crepair-cc -DHAVE_CONFIG_H -I.     -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -MT tif_dir.lo -MD -MP -MF .deps/tif_dir.Tpo -c -o tif_dir.lo tif_dir.c
libtool: compile:  crepair-cc -DHAVE_CONFIG_H -I. -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -MT tif_dir.lo -MD -MP -MF .deps/tif_dir.Tpo -c tif_dir.c -o tif_dir.o
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_ghost: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
mv -f .deps/tif_dir.Tpo .deps/tif_dir.Plo
/bin/bash ../libtool  --tag=CC   --mode=compile crepair-cc -DHAVE_CONFIG_H -I.     -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -MT tif_dirinfo.lo -MD -MP -MF .deps/tif_dirinfo.Tpo -c -o tif_dirinfo.lo tif_dirinfo.c
libtool: compile:  crepair-cc -DHAVE_CONFIG_H -I. -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -MT tif_dirinfo.lo -MD -MP -MF .deps/tif_dirinfo.Tpo -c tif_dirinfo.c -o tif_dirinfo.o
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_ghost: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
mv -f .deps/tif_dirinfo.Tpo .deps/tif_dirinfo.Plo
/bin/bash ../libtool  --tag=CC   --mode=compile crepair-cc -DHAVE_CONFIG_H -I.     -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -MT tif_dirread.lo -MD -MP -MF .deps/tif_dirread.Tpo -c -o tif_dirread.lo tif_dirread.c
libtool: compile:  crepair-cc -DHAVE_CONFIG_H -I. -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -MT tif_dirread.lo -MD -MP -MF .deps/tif_dirread.Tpo -c tif_dirread.c -o tif_dirread.o
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_ghost: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
mv -f .deps/tif_dirread.Tpo .deps/tif_dirread.Plo
/bin/bash ../libtool  --tag=CC   --mode=compile crepair-cc -DHAVE_CONFIG_H -I.     -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -MT tif_dirwrite.lo -MD -MP -MF .deps/tif_dirwrite.Tpo -c -o tif_dirwrite.lo tif_dirwrite.c
libtool: compile:  crepair-cc -DHAVE_CONFIG_H -I. -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -MT tif_dirwrite.lo -MD -MP -MF .deps/tif_dirwrite.Tpo -c tif_dirwrite.c -o tif_dirwrite.o
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_ghost: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
mv -f .deps/tif_dirwrite.Tpo .deps/tif_dirwrite.Plo
/bin/bash ../libtool  --tag=CC   --mode=compile crepair-cc -DHAVE_CONFIG_H -I.     -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -MT tif_dumpmode.lo -MD -MP -MF .deps/tif_dumpmode.Tpo -c -o tif_dumpmode.lo tif_dumpmode.c
libtool: compile:  crepair-cc -DHAVE_CONFIG_H -I. -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -MT tif_dumpmode.lo -MD -MP -MF .deps/tif_dumpmode.Tpo -c tif_dumpmode.c -o tif_dumpmode.o
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_ghost: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
mv -f .deps/tif_dumpmode.Tpo .deps/tif_dumpmode.Plo
/bin/bash ../libtool  --tag=CC   --mode=compile crepair-cc -DHAVE_CONFIG_H -I.     -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -MT tif_error.lo -MD -MP -MF .deps/tif_error.Tpo -c -o tif_error.lo tif_error.c
libtool: compile:  crepair-cc -DHAVE_CONFIG_H -I. -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -MT tif_error.lo -MD -MP -MF .deps/tif_error.Tpo -c tif_error.c -o tif_error.o
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_ghost: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
mv -f .deps/tif_error.Tpo .deps/tif_error.Plo
/bin/bash ../libtool  --tag=CC   --mode=compile crepair-cc -DHAVE_CONFIG_H -I.     -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -MT tif_extension.lo -MD -MP -MF .deps/tif_extension.Tpo -c -o tif_extension.lo tif_extension.c
libtool: compile:  crepair-cc -DHAVE_CONFIG_H -I. -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -MT tif_extension.lo -MD -MP -MF .deps/tif_extension.Tpo -c tif_extension.c -o tif_extension.o
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_ghost: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
mv -f .deps/tif_extension.Tpo .deps/tif_extension.Plo
/bin/bash ../libtool  --tag=CC   --mode=compile crepair-cc -DHAVE_CONFIG_H -I.     -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -MT tif_fax3.lo -MD -MP -MF .deps/tif_fax3.Tpo -c -o tif_fax3.lo tif_fax3.c
libtool: compile:  crepair-cc -DHAVE_CONFIG_H -I. -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -MT tif_fax3.lo -MD -MP -MF .deps/tif_fax3.Tpo -c tif_fax3.c -o tif_fax3.o
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_ghost: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
mv -f .deps/tif_fax3.Tpo .deps/tif_fax3.Plo
/bin/bash ../libtool  --tag=CC   --mode=compile crepair-cc -DHAVE_CONFIG_H -I.     -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -MT tif_fax3sm.lo -MD -MP -MF .deps/tif_fax3sm.Tpo -c -o tif_fax3sm.lo tif_fax3sm.c
libtool: compile:  crepair-cc -DHAVE_CONFIG_H -I. -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -MT tif_fax3sm.lo -MD -MP -MF .deps/tif_fax3sm.Tpo -c tif_fax3sm.c -o tif_fax3sm.o
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_ghost: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
mv -f .deps/tif_fax3sm.Tpo .deps/tif_fax3sm.Plo
/bin/bash ../libtool  --tag=CC   --mode=compile crepair-cc -DHAVE_CONFIG_H -I.     -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -MT tif_flush.lo -MD -MP -MF .deps/tif_flush.Tpo -c -o tif_flush.lo tif_flush.c
libtool: compile:  crepair-cc -DHAVE_CONFIG_H -I. -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -MT tif_flush.lo -MD -MP -MF .deps/tif_flush.Tpo -c tif_flush.c -o tif_flush.o
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_ghost: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
mv -f .deps/tif_flush.Tpo .deps/tif_flush.Plo
/bin/bash ../libtool  --tag=CC   --mode=compile crepair-cc -DHAVE_CONFIG_H -I.     -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -MT tif_getimage.lo -MD -MP -MF .deps/tif_getimage.Tpo -c -o tif_getimage.lo tif_getimage.c
libtool: compile:  crepair-cc -DHAVE_CONFIG_H -I. -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -MT tif_getimage.lo -MD -MP -MF .deps/tif_getimage.Tpo -c tif_getimage.c -o tif_getimage.o
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_ghost: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
mv -f .deps/tif_getimage.Tpo .deps/tif_getimage.Plo
/bin/bash ../libtool  --tag=CC   --mode=compile crepair-cc -DHAVE_CONFIG_H -I.     -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -MT tif_jbig.lo -MD -MP -MF .deps/tif_jbig.Tpo -c -o tif_jbig.lo tif_jbig.c
libtool: compile:  crepair-cc -DHAVE_CONFIG_H -I. -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -MT tif_jbig.lo -MD -MP -MF .deps/tif_jbig.Tpo -c tif_jbig.c -o tif_jbig.o
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_ghost: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
mv -f .deps/tif_jbig.Tpo .deps/tif_jbig.Plo
/bin/bash ../libtool  --tag=CC   --mode=compile crepair-cc -DHAVE_CONFIG_H -I.     -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -MT tif_jpeg.lo -MD -MP -MF .deps/tif_jpeg.Tpo -c -o tif_jpeg.lo tif_jpeg.c
libtool: compile:  crepair-cc -DHAVE_CONFIG_H -I. -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -MT tif_jpeg.lo -MD -MP -MF .deps/tif_jpeg.Tpo -c tif_jpeg.c -o tif_jpeg.o
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_ghost: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
mv -f .deps/tif_jpeg.Tpo .deps/tif_jpeg.Plo
/bin/bash ../libtool  --tag=CC   --mode=compile crepair-cc -DHAVE_CONFIG_H -I.     -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -MT tif_jpeg_12.lo -MD -MP -MF .deps/tif_jpeg_12.Tpo -c -o tif_jpeg_12.lo tif_jpeg_12.c
libtool: compile:  crepair-cc -DHAVE_CONFIG_H -I. -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -MT tif_jpeg_12.lo -MD -MP -MF .deps/tif_jpeg_12.Tpo -c tif_jpeg_12.c -o tif_jpeg_12.o
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_ghost: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
mv -f .deps/tif_jpeg_12.Tpo .deps/tif_jpeg_12.Plo
/bin/bash ../libtool  --tag=CC   --mode=compile crepair-cc -DHAVE_CONFIG_H -I.     -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -MT tif_luv.lo -MD -MP -MF .deps/tif_luv.Tpo -c -o tif_luv.lo tif_luv.c
libtool: compile:  crepair-cc -DHAVE_CONFIG_H -I. -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -MT tif_luv.lo -MD -MP -MF .deps/tif_luv.Tpo -c tif_luv.c -o tif_luv.o
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_ghost: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
tif_luv.c:872:12: warning: implicit declaration of function 'fabs_crepair' is invalid in C99 [-Wimplicit-function-declaration]
                                epsa = fabs_crepair(ang - (i+.5));
                                       ^
1 warning generated.
tif_luv.c:872:12: warning: implicit declaration of function 'fabs_crepair' is invalid in C99 [-Wimplicit-function-declaration]
                                epsa = fabs_crepair(ang - (i+.5));
                                       ^
1 warning generated.
mv -f .deps/tif_luv.Tpo .deps/tif_luv.Plo
/bin/bash ../libtool  --tag=CC   --mode=compile crepair-cc -DHAVE_CONFIG_H -I.     -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -MT tif_lzma.lo -MD -MP -MF .deps/tif_lzma.Tpo -c -o tif_lzma.lo tif_lzma.c
libtool: compile:  crepair-cc -DHAVE_CONFIG_H -I. -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -MT tif_lzma.lo -MD -MP -MF .deps/tif_lzma.Tpo -c tif_lzma.c -o tif_lzma.o
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_ghost: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
mv -f .deps/tif_lzma.Tpo .deps/tif_lzma.Plo
/bin/bash ../libtool  --tag=CC   --mode=compile crepair-cc -DHAVE_CONFIG_H -I.     -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -MT tif_lzw.lo -MD -MP -MF .deps/tif_lzw.Tpo -c -o tif_lzw.lo tif_lzw.c
libtool: compile:  crepair-cc -DHAVE_CONFIG_H -I. -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -MT tif_lzw.lo -MD -MP -MF .deps/tif_lzw.Tpo -c tif_lzw.c -o tif_lzw.o
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_ghost: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
mv -f .deps/tif_lzw.Tpo .deps/tif_lzw.Plo
/bin/bash ../libtool  --tag=CC   --mode=compile crepair-cc -DHAVE_CONFIG_H -I.     -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -MT tif_next.lo -MD -MP -MF .deps/tif_next.Tpo -c -o tif_next.lo tif_next.c
libtool: compile:  crepair-cc -DHAVE_CONFIG_H -I. -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -MT tif_next.lo -MD -MP -MF .deps/tif_next.Tpo -c tif_next.c -o tif_next.o
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_ghost: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
mv -f .deps/tif_next.Tpo .deps/tif_next.Plo
/bin/bash ../libtool  --tag=CC   --mode=compile crepair-cc -DHAVE_CONFIG_H -I.     -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -MT tif_ojpeg.lo -MD -MP -MF .deps/tif_ojpeg.Tpo -c -o tif_ojpeg.lo tif_ojpeg.c
libtool: compile:  crepair-cc -DHAVE_CONFIG_H -I. -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -MT tif_ojpeg.lo -MD -MP -MF .deps/tif_ojpeg.Tpo -c tif_ojpeg.c -o tif_ojpeg.o
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_ghost: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
mv -f .deps/tif_ojpeg.Tpo .deps/tif_ojpeg.Plo
/bin/bash ../libtool  --tag=CC   --mode=compile crepair-cc -DHAVE_CONFIG_H -I.     -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -MT tif_open.lo -MD -MP -MF .deps/tif_open.Tpo -c -o tif_open.lo tif_open.c
libtool: compile:  crepair-cc -DHAVE_CONFIG_H -I. -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -MT tif_open.lo -MD -MP -MF .deps/tif_open.Tpo -c tif_open.c -o tif_open.o
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_ghost: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
mv -f .deps/tif_open.Tpo .deps/tif_open.Plo
/bin/bash ../libtool  --tag=CC   --mode=compile crepair-cc -DHAVE_CONFIG_H -I.     -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -MT tif_packbits.lo -MD -MP -MF .deps/tif_packbits.Tpo -c -o tif_packbits.lo tif_packbits.c
libtool: compile:  crepair-cc -DHAVE_CONFIG_H -I. -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -MT tif_packbits.lo -MD -MP -MF .deps/tif_packbits.Tpo -c tif_packbits.c -o tif_packbits.o
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_ghost: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
mv -f .deps/tif_packbits.Tpo .deps/tif_packbits.Plo
/bin/bash ../libtool  --tag=CC   --mode=compile crepair-cc -DHAVE_CONFIG_H -I.     -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -MT tif_pixarlog.lo -MD -MP -MF .deps/tif_pixarlog.Tpo -c -o tif_pixarlog.lo tif_pixarlog.c
libtool: compile:  crepair-cc -DHAVE_CONFIG_H -I. -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -MT tif_pixarlog.lo -MD -MP -MF .deps/tif_pixarlog.Tpo -c tif_pixarlog.c -o tif_pixarlog.o
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_ghost: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
mv -f .deps/tif_pixarlog.Tpo .deps/tif_pixarlog.Plo
/bin/bash ../libtool  --tag=CC   --mode=compile crepair-cc -DHAVE_CONFIG_H -I.     -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -MT tif_predict.lo -MD -MP -MF .deps/tif_predict.Tpo -c -o tif_predict.lo tif_predict.c
libtool: compile:  crepair-cc -DHAVE_CONFIG_H -I. -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -MT tif_predict.lo -MD -MP -MF .deps/tif_predict.Tpo -c tif_predict.c -o tif_predict.o
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_ghost: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
mv -f .deps/tif_predict.Tpo .deps/tif_predict.Plo
/bin/bash ../libtool  --tag=CC   --mode=compile crepair-cc -DHAVE_CONFIG_H -I.     -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -MT tif_print.lo -MD -MP -MF .deps/tif_print.Tpo -c -o tif_print.lo tif_print.c
libtool: compile:  crepair-cc -DHAVE_CONFIG_H -I. -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -MT tif_print.lo -MD -MP -MF .deps/tif_print.Tpo -c tif_print.c -o tif_print.o
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_ghost: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
mv -f .deps/tif_print.Tpo .deps/tif_print.Plo
/bin/bash ../libtool  --tag=CC   --mode=compile crepair-cc -DHAVE_CONFIG_H -I.     -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -MT tif_read.lo -MD -MP -MF .deps/tif_read.Tpo -c -o tif_read.lo tif_read.c
libtool: compile:  crepair-cc -DHAVE_CONFIG_H -I. -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -MT tif_read.lo -MD -MP -MF .deps/tif_read.Tpo -c tif_read.c -o tif_read.o
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_ghost: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
mv -f .deps/tif_read.Tpo .deps/tif_read.Plo
/bin/bash ../libtool  --tag=CC   --mode=compile crepair-cc -DHAVE_CONFIG_H -I.     -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -MT tif_strip.lo -MD -MP -MF .deps/tif_strip.Tpo -c -o tif_strip.lo tif_strip.c
libtool: compile:  crepair-cc -DHAVE_CONFIG_H -I. -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -MT tif_strip.lo -MD -MP -MF .deps/tif_strip.Tpo -c tif_strip.c -o tif_strip.o
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_ghost: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
mv -f .deps/tif_strip.Tpo .deps/tif_strip.Plo
/bin/bash ../libtool  --tag=CC   --mode=compile crepair-cc -DHAVE_CONFIG_H -I.     -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -MT tif_swab.lo -MD -MP -MF .deps/tif_swab.Tpo -c -o tif_swab.lo tif_swab.c
libtool: compile:  crepair-cc -DHAVE_CONFIG_H -I. -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -MT tif_swab.lo -MD -MP -MF .deps/tif_swab.Tpo -c tif_swab.c -o tif_swab.o
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_ghost: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
mv -f .deps/tif_swab.Tpo .deps/tif_swab.Plo
/bin/bash ../libtool  --tag=CC   --mode=compile crepair-cc -DHAVE_CONFIG_H -I.     -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -MT tif_thunder.lo -MD -MP -MF .deps/tif_thunder.Tpo -c -o tif_thunder.lo tif_thunder.c
libtool: compile:  crepair-cc -DHAVE_CONFIG_H -I. -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -MT tif_thunder.lo -MD -MP -MF .deps/tif_thunder.Tpo -c tif_thunder.c -o tif_thunder.o
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_ghost: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
mv -f .deps/tif_thunder.Tpo .deps/tif_thunder.Plo
/bin/bash ../libtool  --tag=CC   --mode=compile crepair-cc -DHAVE_CONFIG_H -I.     -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -MT tif_tile.lo -MD -MP -MF .deps/tif_tile.Tpo -c -o tif_tile.lo tif_tile.c
libtool: compile:  crepair-cc -DHAVE_CONFIG_H -I. -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -MT tif_tile.lo -MD -MP -MF .deps/tif_tile.Tpo -c tif_tile.c -o tif_tile.o
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_ghost: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
mv -f .deps/tif_tile.Tpo .deps/tif_tile.Plo
/bin/bash ../libtool  --tag=CC   --mode=compile crepair-cc -DHAVE_CONFIG_H -I.     -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -MT tif_version.lo -MD -MP -MF .deps/tif_version.Tpo -c -o tif_version.lo tif_version.c
libtool: compile:  crepair-cc -DHAVE_CONFIG_H -I. -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -MT tif_version.lo -MD -MP -MF .deps/tif_version.Tpo -c tif_version.c -o tif_version.o
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_ghost: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
mv -f .deps/tif_version.Tpo .deps/tif_version.Plo
/bin/bash ../libtool  --tag=CC   --mode=compile crepair-cc -DHAVE_CONFIG_H -I.     -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -MT tif_warning.lo -MD -MP -MF .deps/tif_warning.Tpo -c -o tif_warning.lo tif_warning.c
libtool: compile:  crepair-cc -DHAVE_CONFIG_H -I. -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -MT tif_warning.lo -MD -MP -MF .deps/tif_warning.Tpo -c tif_warning.c -o tif_warning.o
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_ghost: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
mv -f .deps/tif_warning.Tpo .deps/tif_warning.Plo
/bin/bash ../libtool  --tag=CC   --mode=compile crepair-cc -DHAVE_CONFIG_H -I.     -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -MT tif_write.lo -MD -MP -MF .deps/tif_write.Tpo -c -o tif_write.lo tif_write.c
libtool: compile:  crepair-cc -DHAVE_CONFIG_H -I. -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -MT tif_write.lo -MD -MP -MF .deps/tif_write.Tpo -c tif_write.c -o tif_write.o
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_ghost: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
mv -f .deps/tif_write.Tpo .deps/tif_write.Plo
/bin/bash ../libtool  --tag=CC   --mode=compile crepair-cc -DHAVE_CONFIG_H -I.     -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -MT tif_zip.lo -MD -MP -MF .deps/tif_zip.Tpo -c -o tif_zip.lo tif_zip.c
libtool: compile:  crepair-cc -DHAVE_CONFIG_H -I. -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -MT tif_zip.lo -MD -MP -MF .deps/tif_zip.Tpo -c tif_zip.c -o tif_zip.o
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_ghost: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
mv -f .deps/tif_zip.Tpo .deps/tif_zip.Plo
/bin/bash ../libtool  --tag=CC   --mode=compile crepair-cc -DHAVE_CONFIG_H -I.     -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -MT tif_unix.lo -MD -MP -MF .deps/tif_unix.Tpo -c -o tif_unix.lo tif_unix.c
libtool: compile:  crepair-cc -DHAVE_CONFIG_H -I. -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -MT tif_unix.lo -MD -MP -MF .deps/tif_unix.Tpo -c tif_unix.c -o tif_unix.o
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_ghost: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
mv -f .deps/tif_unix.Tpo .deps/tif_unix.Plo
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -no-undefined -version-info 7:4:2   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -o libtiff.la -rpath /usr/local/lib tif_aux.lo tif_close.lo tif_codec.lo tif_color.lo tif_compress.lo tif_dir.lo tif_dirinfo.lo tif_dirread.lo tif_dirwrite.lo tif_dumpmode.lo tif_error.lo tif_extension.lo tif_fax3.lo tif_fax3sm.lo tif_flush.lo tif_getimage.lo tif_jbig.lo tif_jpeg.lo tif_jpeg_12.lo tif_luv.lo tif_lzma.lo tif_lzw.lo tif_next.lo tif_ojpeg.lo tif_open.lo tif_packbits.lo tif_pixarlog.lo tif_predict.lo tif_print.lo tif_read.lo tif_strip.lo tif_swab.lo tif_thunder.lo tif_tile.lo tif_version.lo tif_warning.lo tif_write.lo tif_zip.lo  tif_unix.lo ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: (cd .libs/libtiff.lax/libport.a && ar x "/data/vulnloc/libtiff/CVE-2016-5321/src/libtiff/../port/.libs/libport.a")
libtool: link: ar cru .libs/libtiff.a  tif_aux.o tif_close.o tif_codec.o tif_color.o tif_compress.o tif_dir.o tif_dirinfo.o tif_dirread.o tif_dirwrite.o tif_dumpmode.o tif_error.o tif_extension.o tif_fax3.o tif_fax3sm.o tif_flush.o tif_getimage.o tif_jbig.o tif_jpeg.o tif_jpeg_12.o tif_luv.o tif_lzma.o tif_lzw.o tif_next.o tif_ojpeg.o tif_open.o tif_packbits.o tif_pixarlog.o tif_predict.o tif_print.o tif_read.o tif_strip.o tif_swab.o tif_thunder.o tif_tile.o tif_version.o tif_warning.o tif_write.o tif_zip.o tif_unix.o  .libs/libtiff.lax/libport.a/dummy.o 
ar: `u' modifier ignored since `D' is the default (see `U')
libtool: link: ranlib .libs/libtiff.a
libtool: link: rm -fr .libs/libtiff.lax
libtool: link: ( cd ".libs" && rm -f "libtiff.la" && ln -s "../libtiff.la" "libtiff.la" )
/bin/bash ../libtool  --tag=CXX   --mode=compile crepair-cxx -DHAVE_CONFIG_H -I.     -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -MT tif_stream.lo -MD -MP -MF .deps/tif_stream.Tpo -c -o tif_stream.lo tif_stream.cxx
libtool: compile:  crepair-cxx -DHAVE_CONFIG_H -I. -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -MT tif_stream.lo -MD -MP -MF .deps/tif_stream.Tpo -c tif_stream.cxx -o tif_stream.o
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_ghost: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
mv -f .deps/tif_stream.Tpo .deps/tif_stream.Plo
/bin/bash ../libtool  --tag=CXX   --mode=link crepair-cxx  -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -no-undefined -version-info 7:4:2   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -o libtiffxx.la -rpath /usr/local/lib tif_stream.lo ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: (cd .libs/libtiffxx.lax/libport.a && ar x "/data/vulnloc/libtiff/CVE-2016-5321/src/libtiff/../port/.libs/libport.a")
libtool: link: ar cru .libs/libtiffxx.a  tif_stream.o  .libs/libtiffxx.lax/libport.a/dummy.o 
ar: `u' modifier ignored since `D' is the default (see `U')
libtool: link: ranlib .libs/libtiffxx.a
libtool: link: rm -fr .libs/libtiffxx.lax
libtool: link: ( cd ".libs" && rm -f "libtiffxx.la" && ln -s "../libtiffxx.la" "libtiffxx.la" )
crepair-cc -DHAVE_CONFIG_H -I.     -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -MT mkg3states.o -MD -MP -MF .deps/mkg3states.Tpo -c -o mkg3states.o mkg3states.c
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_ghost: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
mv -f .deps/mkg3states.Tpo .deps/mkg3states.Po
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address  -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -o mkg3states mkg3states.o ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -g -O0 -Wno-error -I/CrashRepair/lib -fsanitize=address -g -O0 -Wno-error -I/CrashRepair/lib -fsanitize=address -o mkg3states mkg3states.o  -L/klee/build/lib -L/CrashRepair/lib ../port/.libs/libport.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -llzma -ljbig -ljpeg -lz -lm
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/libtiff'
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/libtiff'
Making all in tools
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/tools'
crepair-cc -DHAVE_CONFIG_H -I. -I../libtiff  -I../libtiff   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -MT bmp2tiff.o -MD -MP -MF .deps/bmp2tiff.Tpo -c -o bmp2tiff.o bmp2tiff.c
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_ghost: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
mv -f .deps/bmp2tiff.Tpo .deps/bmp2tiff.Po
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address  -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -o bmp2tiff bmp2tiff.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -g -O0 -Wno-error -I/CrashRepair/lib -fsanitize=address -g -O0 -Wno-error -I/CrashRepair/lib -fsanitize=address -o bmp2tiff bmp2tiff.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a ../port/.libs/libport.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -llzma -ljbig -ljpeg -lz -lm
crepair-cc -DHAVE_CONFIG_H -I. -I../libtiff  -I../libtiff   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -MT fax2ps.o -MD -MP -MF .deps/fax2ps.Tpo -c -o fax2ps.o fax2ps.c
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_ghost: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
mv -f .deps/fax2ps.Tpo .deps/fax2ps.Po
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address  -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -o fax2ps fax2ps.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -g -O0 -Wno-error -I/CrashRepair/lib -fsanitize=address -g -O0 -Wno-error -I/CrashRepair/lib -fsanitize=address -o fax2ps fax2ps.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a ../port/.libs/libport.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -llzma -ljbig -ljpeg -lz -lm
crepair-cc -DHAVE_CONFIG_H -I. -I../libtiff  -I../libtiff   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -MT fax2tiff.o -MD -MP -MF .deps/fax2tiff.Tpo -c -o fax2tiff.o fax2tiff.c
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_ghost: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
mv -f .deps/fax2tiff.Tpo .deps/fax2tiff.Po
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address  -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -o fax2tiff fax2tiff.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -g -O0 -Wno-error -I/CrashRepair/lib -fsanitize=address -g -O0 -Wno-error -I/CrashRepair/lib -fsanitize=address -o fax2tiff fax2tiff.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a ../port/.libs/libport.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -llzma -ljbig -ljpeg -lz -lm
crepair-cc -DHAVE_CONFIG_H -I. -I../libtiff  -I../libtiff   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -MT gif2tiff.o -MD -MP -MF .deps/gif2tiff.Tpo -c -o gif2tiff.o gif2tiff.c
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_ghost: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
mv -f .deps/gif2tiff.Tpo .deps/gif2tiff.Po
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address  -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -o gif2tiff gif2tiff.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -g -O0 -Wno-error -I/CrashRepair/lib -fsanitize=address -g -O0 -Wno-error -I/CrashRepair/lib -fsanitize=address -o gif2tiff gif2tiff.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a ../port/.libs/libport.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -llzma -ljbig -ljpeg -lz -lm
crepair-cc -DHAVE_CONFIG_H -I. -I../libtiff  -I../libtiff   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -MT pal2rgb.o -MD -MP -MF .deps/pal2rgb.Tpo -c -o pal2rgb.o pal2rgb.c
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_ghost: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
mv -f .deps/pal2rgb.Tpo .deps/pal2rgb.Po
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address  -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -o pal2rgb pal2rgb.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -g -O0 -Wno-error -I/CrashRepair/lib -fsanitize=address -g -O0 -Wno-error -I/CrashRepair/lib -fsanitize=address -o pal2rgb pal2rgb.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a ../port/.libs/libport.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -llzma -ljbig -ljpeg -lz -lm
crepair-cc -DHAVE_CONFIG_H -I. -I../libtiff  -I../libtiff   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -MT ppm2tiff.o -MD -MP -MF .deps/ppm2tiff.Tpo -c -o ppm2tiff.o ppm2tiff.c
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_ghost: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
mv -f .deps/ppm2tiff.Tpo .deps/ppm2tiff.Po
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address  -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -o ppm2tiff ppm2tiff.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -g -O0 -Wno-error -I/CrashRepair/lib -fsanitize=address -g -O0 -Wno-error -I/CrashRepair/lib -fsanitize=address -o ppm2tiff ppm2tiff.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a ../port/.libs/libport.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -llzma -ljbig -ljpeg -lz -lm
crepair-cc -DHAVE_CONFIG_H -I. -I../libtiff  -I../libtiff   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -MT ras2tiff.o -MD -MP -MF .deps/ras2tiff.Tpo -c -o ras2tiff.o ras2tiff.c
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_ghost: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
mv -f .deps/ras2tiff.Tpo .deps/ras2tiff.Po
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address  -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -o ras2tiff ras2tiff.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -g -O0 -Wno-error -I/CrashRepair/lib -fsanitize=address -g -O0 -Wno-error -I/CrashRepair/lib -fsanitize=address -o ras2tiff ras2tiff.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a ../port/.libs/libport.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -llzma -ljbig -ljpeg -lz -lm
crepair-cc -DHAVE_CONFIG_H -I. -I../libtiff  -I../libtiff   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -MT raw2tiff.o -MD -MP -MF .deps/raw2tiff.Tpo -c -o raw2tiff.o raw2tiff.c
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_ghost: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
mv -f .deps/raw2tiff.Tpo .deps/raw2tiff.Po
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address  -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -o raw2tiff raw2tiff.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -g -O0 -Wno-error -I/CrashRepair/lib -fsanitize=address -g -O0 -Wno-error -I/CrashRepair/lib -fsanitize=address -o raw2tiff raw2tiff.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a ../port/.libs/libport.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -llzma -ljbig -ljpeg -lz -lm
crepair-cc -DHAVE_CONFIG_H -I. -I../libtiff  -I../libtiff   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -MT rgb2ycbcr.o -MD -MP -MF .deps/rgb2ycbcr.Tpo -c -o rgb2ycbcr.o rgb2ycbcr.c
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_ghost: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
mv -f .deps/rgb2ycbcr.Tpo .deps/rgb2ycbcr.Po
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address  -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -o rgb2ycbcr rgb2ycbcr.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -g -O0 -Wno-error -I/CrashRepair/lib -fsanitize=address -g -O0 -Wno-error -I/CrashRepair/lib -fsanitize=address -o rgb2ycbcr rgb2ycbcr.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a ../port/.libs/libport.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -llzma -ljbig -ljpeg -lz -lm
crepair-cc -DHAVE_CONFIG_H -I. -I../libtiff  -I../libtiff   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -MT thumbnail.o -MD -MP -MF .deps/thumbnail.Tpo -c -o thumbnail.o thumbnail.c
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_ghost: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
mv -f .deps/thumbnail.Tpo .deps/thumbnail.Po
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address  -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -o thumbnail thumbnail.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -g -O0 -Wno-error -I/CrashRepair/lib -fsanitize=address -g -O0 -Wno-error -I/CrashRepair/lib -fsanitize=address -o thumbnail thumbnail.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a ../port/.libs/libport.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -llzma -ljbig -ljpeg -lz -lm
crepair-cc -DHAVE_CONFIG_H -I. -I../libtiff  -I../libtiff   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -MT tiff2bw.o -MD -MP -MF .deps/tiff2bw.Tpo -c -o tiff2bw.o tiff2bw.c
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_ghost: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
mv -f .deps/tiff2bw.Tpo .deps/tiff2bw.Po
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address  -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -o tiff2bw tiff2bw.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -g -O0 -Wno-error -I/CrashRepair/lib -fsanitize=address -g -O0 -Wno-error -I/CrashRepair/lib -fsanitize=address -o tiff2bw tiff2bw.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a ../port/.libs/libport.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -llzma -ljbig -ljpeg -lz -lm
crepair-cc -DHAVE_CONFIG_H -I. -I../libtiff  -I../libtiff   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -MT tiff2pdf.o -MD -MP -MF .deps/tiff2pdf.Tpo -c -o tiff2pdf.o tiff2pdf.c
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_ghost: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
mv -f .deps/tiff2pdf.Tpo .deps/tiff2pdf.Po
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address  -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -o tiff2pdf tiff2pdf.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -g -O0 -Wno-error -I/CrashRepair/lib -fsanitize=address -g -O0 -Wno-error -I/CrashRepair/lib -fsanitize=address -o tiff2pdf tiff2pdf.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a ../port/.libs/libport.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -llzma -ljbig -ljpeg -lz -lm
crepair-cc -DHAVE_CONFIG_H -I. -I../libtiff  -I../libtiff   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -MT tiff2ps.o -MD -MP -MF .deps/tiff2ps.Tpo -c -o tiff2ps.o tiff2ps.c
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_ghost: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
mv -f .deps/tiff2ps.Tpo .deps/tiff2ps.Po
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address  -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -o tiff2ps tiff2ps.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -g -O0 -Wno-error -I/CrashRepair/lib -fsanitize=address -g -O0 -Wno-error -I/CrashRepair/lib -fsanitize=address -o tiff2ps tiff2ps.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a ../port/.libs/libport.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -llzma -ljbig -ljpeg -lz -lm
crepair-cc -DHAVE_CONFIG_H -I. -I../libtiff  -I../libtiff   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -MT tiff2rgba.o -MD -MP -MF .deps/tiff2rgba.Tpo -c -o tiff2rgba.o tiff2rgba.c
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_ghost: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
mv -f .deps/tiff2rgba.Tpo .deps/tiff2rgba.Po
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address  -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -o tiff2rgba tiff2rgba.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -g -O0 -Wno-error -I/CrashRepair/lib -fsanitize=address -g -O0 -Wno-error -I/CrashRepair/lib -fsanitize=address -o tiff2rgba tiff2rgba.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a ../port/.libs/libport.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -llzma -ljbig -ljpeg -lz -lm
crepair-cc -DHAVE_CONFIG_H -I. -I../libtiff  -I../libtiff   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -MT tiffcmp.o -MD -MP -MF .deps/tiffcmp.Tpo -c -o tiffcmp.o tiffcmp.c
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_ghost: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
mv -f .deps/tiffcmp.Tpo .deps/tiffcmp.Po
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address  -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -o tiffcmp tiffcmp.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -g -O0 -Wno-error -I/CrashRepair/lib -fsanitize=address -g -O0 -Wno-error -I/CrashRepair/lib -fsanitize=address -o tiffcmp tiffcmp.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a ../port/.libs/libport.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -llzma -ljbig -ljpeg -lz -lm
crepair-cc -DHAVE_CONFIG_H -I. -I../libtiff  -I../libtiff   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -MT tiffcp.o -MD -MP -MF .deps/tiffcp.Tpo -c -o tiffcp.o tiffcp.c
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_ghost: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
mv -f .deps/tiffcp.Tpo .deps/tiffcp.Po
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address  -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -o tiffcp tiffcp.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -g -O0 -Wno-error -I/CrashRepair/lib -fsanitize=address -g -O0 -Wno-error -I/CrashRepair/lib -fsanitize=address -o tiffcp tiffcp.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a ../port/.libs/libport.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -llzma -ljbig -ljpeg -lz -lm
crepair-cc -DHAVE_CONFIG_H -I. -I../libtiff  -I../libtiff   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -MT tiffcrop.o -MD -MP -MF .deps/tiffcrop.Tpo -c -o tiffcrop.o tiffcrop.c
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_ghost: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
mv -f .deps/tiffcrop.Tpo .deps/tiffcrop.Po
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address  -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -o tiffcrop tiffcrop.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -g -O0 -Wno-error -I/CrashRepair/lib -fsanitize=address -g -O0 -Wno-error -I/CrashRepair/lib -fsanitize=address -o tiffcrop tiffcrop.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a ../port/.libs/libport.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -llzma -ljbig -ljpeg -lz -lm
crepair-cc -DHAVE_CONFIG_H -I. -I../libtiff  -I../libtiff   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -MT tiffdither.o -MD -MP -MF .deps/tiffdither.Tpo -c -o tiffdither.o tiffdither.c
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_ghost: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
mv -f .deps/tiffdither.Tpo .deps/tiffdither.Po
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address  -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -o tiffdither tiffdither.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -g -O0 -Wno-error -I/CrashRepair/lib -fsanitize=address -g -O0 -Wno-error -I/CrashRepair/lib -fsanitize=address -o tiffdither tiffdither.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a ../port/.libs/libport.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -llzma -ljbig -ljpeg -lz -lm
crepair-cc -DHAVE_CONFIG_H -I. -I../libtiff  -I../libtiff   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -MT tiffdump.o -MD -MP -MF .deps/tiffdump.Tpo -c -o tiffdump.o tiffdump.c
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_ghost: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
mv -f .deps/tiffdump.Tpo .deps/tiffdump.Po
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address  -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -o tiffdump tiffdump.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -g -O0 -Wno-error -I/CrashRepair/lib -fsanitize=address -g -O0 -Wno-error -I/CrashRepair/lib -fsanitize=address -o tiffdump tiffdump.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a ../port/.libs/libport.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -llzma -ljbig -ljpeg -lz -lm
crepair-cc -DHAVE_CONFIG_H -I. -I../libtiff  -I../libtiff   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -MT tiffinfo.o -MD -MP -MF .deps/tiffinfo.Tpo -c -o tiffinfo.o tiffinfo.c
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_ghost: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
mv -f .deps/tiffinfo.Tpo .deps/tiffinfo.Po
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address  -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -o tiffinfo tiffinfo.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -g -O0 -Wno-error -I/CrashRepair/lib -fsanitize=address -g -O0 -Wno-error -I/CrashRepair/lib -fsanitize=address -o tiffinfo tiffinfo.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a ../port/.libs/libport.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -llzma -ljbig -ljpeg -lz -lm
crepair-cc -DHAVE_CONFIG_H -I. -I../libtiff  -I../libtiff   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -MT tiffmedian.o -MD -MP -MF .deps/tiffmedian.Tpo -c -o tiffmedian.o tiffmedian.c
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_ghost: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
mv -f .deps/tiffmedian.Tpo .deps/tiffmedian.Po
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address  -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -o tiffmedian tiffmedian.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -g -O0 -Wno-error -I/CrashRepair/lib -fsanitize=address -g -O0 -Wno-error -I/CrashRepair/lib -fsanitize=address -o tiffmedian tiffmedian.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a ../port/.libs/libport.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -llzma -ljbig -ljpeg -lz -lm
crepair-cc -DHAVE_CONFIG_H -I. -I../libtiff  -I../libtiff   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -MT tiffset.o -MD -MP -MF .deps/tiffset.Tpo -c -o tiffset.o tiffset.c
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_ghost: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
mv -f .deps/tiffset.Tpo .deps/tiffset.Po
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address  -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -o tiffset tiffset.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -g -O0 -Wno-error -I/CrashRepair/lib -fsanitize=address -g -O0 -Wno-error -I/CrashRepair/lib -fsanitize=address -o tiffset tiffset.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a ../port/.libs/libport.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -llzma -ljbig -ljpeg -lz -lm
crepair-cc -DHAVE_CONFIG_H -I. -I../libtiff  -I../libtiff   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -MT tiffsplit.o -MD -MP -MF .deps/tiffsplit.Tpo -c -o tiffsplit.o tiffsplit.c
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_ghost: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
mv -f .deps/tiffsplit.Tpo .deps/tiffsplit.Po
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address  -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -o tiffsplit tiffsplit.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -g -O0 -Wno-error -I/CrashRepair/lib -fsanitize=address -g -O0 -Wno-error -I/CrashRepair/lib -fsanitize=address -o tiffsplit tiffsplit.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a ../port/.libs/libport.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -llzma -ljbig -ljpeg -lz -lm
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/tools'
Making all in build
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/build'
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/build'
make[2]: Nothing to be done for 'all-am'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/build'
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/build'
Making all in contrib
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib'
Making all in addtiffo
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/addtiffo'
crepair-cc -DHAVE_CONFIG_H -I. -I../../libtiff  -I../../libtiff   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -MT addtiffo.o -MD -MP -MF .deps/addtiffo.Tpo -c -o addtiffo.o addtiffo.c
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_ghost: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
mv -f .deps/addtiffo.Tpo .deps/addtiffo.Po
crepair-cc -DHAVE_CONFIG_H -I. -I../../libtiff  -I../../libtiff   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -MT tif_overview.o -MD -MP -MF .deps/tif_overview.Tpo -c -o tif_overview.o tif_overview.c
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_ghost: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
mv -f .deps/tif_overview.Tpo .deps/tif_overview.Po
crepair-cc -DHAVE_CONFIG_H -I. -I../../libtiff  -I../../libtiff   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -MT tif_ovrcache.o -MD -MP -MF .deps/tif_ovrcache.Tpo -c -o tif_ovrcache.o tif_ovrcache.c
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_ghost: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
mv -f .deps/tif_ovrcache.Tpo .deps/tif_ovrcache.Po
/bin/bash ../../libtool  --tag=CC   --mode=link crepair-cc  -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address  -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -o addtiffo addtiffo.o tif_overview.o tif_ovrcache.o ../../libtiff/libtiff.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -g -O0 -Wno-error -I/CrashRepair/lib -fsanitize=address -g -O0 -Wno-error -I/CrashRepair/lib -fsanitize=address -o addtiffo addtiffo.o tif_overview.o tif_ovrcache.o  -L/klee/build/lib -L/CrashRepair/lib ../../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -llzma -ljbig -ljpeg -lz -lm
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/addtiffo'
Making all in dbs
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/dbs'
Making all in xtiff
make[3]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/dbs/xtiff'
make[3]: Nothing to be done for 'all'.
make[3]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/dbs/xtiff'
make[3]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/dbs'
crepair-cc -DHAVE_CONFIG_H -I. -I../../libtiff  -I../../libtiff   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -MT tiff-bi.o -MD -MP -MF .deps/tiff-bi.Tpo -c -o tiff-bi.o tiff-bi.c
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_ghost: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
mv -f .deps/tiff-bi.Tpo .deps/tiff-bi.Po
/bin/bash ../../libtool  --tag=CC   --mode=link crepair-cc  -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address  -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -o tiff-bi tiff-bi.o ../../libtiff/libtiff.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -g -O0 -Wno-error -I/CrashRepair/lib -fsanitize=address -g -O0 -Wno-error -I/CrashRepair/lib -fsanitize=address -o tiff-bi tiff-bi.o  -L/klee/build/lib -L/CrashRepair/lib ../../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -llzma -ljbig -ljpeg -lz -lm
crepair-cc -DHAVE_CONFIG_H -I. -I../../libtiff  -I../../libtiff   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -MT tiff-grayscale.o -MD -MP -MF .deps/tiff-grayscale.Tpo -c -o tiff-grayscale.o tiff-grayscale.c
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_ghost: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
mv -f .deps/tiff-grayscale.Tpo .deps/tiff-grayscale.Po
/bin/bash ../../libtool  --tag=CC   --mode=link crepair-cc  -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address  -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -o tiff-grayscale tiff-grayscale.o ../../libtiff/libtiff.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -g -O0 -Wno-error -I/CrashRepair/lib -fsanitize=address -g -O0 -Wno-error -I/CrashRepair/lib -fsanitize=address -o tiff-grayscale tiff-grayscale.o  -L/klee/build/lib -L/CrashRepair/lib ../../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -llzma -ljbig -ljpeg -lz -lm
crepair-cc -DHAVE_CONFIG_H -I. -I../../libtiff  -I../../libtiff   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -MT tiff-palette.o -MD -MP -MF .deps/tiff-palette.Tpo -c -o tiff-palette.o tiff-palette.c
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_ghost: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
mv -f .deps/tiff-palette.Tpo .deps/tiff-palette.Po
/bin/bash ../../libtool  --tag=CC   --mode=link crepair-cc  -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address  -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -o tiff-palette tiff-palette.o ../../libtiff/libtiff.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -g -O0 -Wno-error -I/CrashRepair/lib -fsanitize=address -g -O0 -Wno-error -I/CrashRepair/lib -fsanitize=address -o tiff-palette tiff-palette.o  -L/klee/build/lib -L/CrashRepair/lib ../../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -llzma -ljbig -ljpeg -lz -lm
crepair-cc -DHAVE_CONFIG_H -I. -I../../libtiff  -I../../libtiff   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -MT tiff-rgb.o -MD -MP -MF .deps/tiff-rgb.Tpo -c -o tiff-rgb.o tiff-rgb.c
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_ghost: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
mv -f .deps/tiff-rgb.Tpo .deps/tiff-rgb.Po
/bin/bash ../../libtool  --tag=CC   --mode=link crepair-cc  -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address  -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -o tiff-rgb tiff-rgb.o ../../libtiff/libtiff.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -g -O0 -Wno-error -I/CrashRepair/lib -fsanitize=address -g -O0 -Wno-error -I/CrashRepair/lib -fsanitize=address -o tiff-rgb tiff-rgb.o  -L/klee/build/lib -L/CrashRepair/lib ../../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -llzma -ljbig -ljpeg -lz -lm
make[3]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/dbs'
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/dbs'
Making all in iptcutil
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/iptcutil'
crepair-cc -DHAVE_CONFIG_H -I. -I../../libtiff  -I../../libtiff   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -MT iptcutil.o -MD -MP -MF .deps/iptcutil.Tpo -c -o iptcutil.o iptcutil.c
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_ghost: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
mv -f .deps/iptcutil.Tpo .deps/iptcutil.Po
/bin/bash ../../libtool  --tag=CC   --mode=link crepair-cc  -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address  -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -o iptcutil iptcutil.o ../../libtiff/libtiff.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -g -O0 -Wno-error -I/CrashRepair/lib -fsanitize=address -g -O0 -Wno-error -I/CrashRepair/lib -fsanitize=address -o iptcutil iptcutil.o  -L/klee/build/lib -L/CrashRepair/lib ../../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -llzma -ljbig -ljpeg -lz -lm
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/iptcutil'
Making all in mfs
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/mfs'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/mfs'
Making all in pds
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/pds'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/pds'
Making all in ras
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/ras'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/ras'
Making all in stream
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/stream'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/stream'
Making all in tags
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/tags'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/tags'
Making all in win_dib
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/win_dib'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/win_dib'
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib'
make[2]: Nothing to be done for 'all-am'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib'
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib'
Making all in test
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/test'
make[1]: Nothing to be done for 'all'.
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/test'
Making all in man
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/man'
make[1]: Nothing to be done for 'all'.
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/man'
Making all in html
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html'
Making all in images
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html/images'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html/images'
Making all in man
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html/man'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html/man'
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html'
make[2]: Nothing to be done for 'all-am'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html'
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html'
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src'
make[1]: Nothing to be done for 'all-am'.
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src'
2025-02-03 22:36:47.291 | INFO     | scenario:evaluate:635 - evaluating candidate patch #0:
@@ -949,6 +949,7 @@
   }
 
 
+
 static int readSeparateTilesIntoBuffer (TIFF* in, uint8 *obuf, 
                                          uint32 imagelength, uint32 imagewidth, 
                                          uint32 tw, uint32 tl,
@@ -968,6 +969,11 @@
 
     bytes_per_sample = (bps + 7) / 8;
 
+    if (spp >= 8) { // Enforce constraint
+        TIFFError("readSeparateTilesIntoBuffer", "Sample per pixel too high: %d", spp);
+        return 0;
+    }
+
     for (sample = 0; (sample < spp) && (sample < MAX_SAMPLES); sample++)
     {
         srcbuffs[sample] = NULL;
@@ -1103,6 +1109,7 @@
 }
 
 
+
 static int writeBufferToContigStrips(TIFF* out, uint8* buf, uint32 imagelength)
   {
   uint32 row, nrows, rowsperstrip;

2025-02-03 22:36:47.298 | DEBUG    | scenario:rebuild:369 - original environment: environ({'CONDA_SHLVL': '2', 'LC_ALL': 'C.UTF-8', 'LS_COLORS': 'rs=0:di=01;34:ln=01;36:mh=00:pi=40;33:so=01;35:do=01;35:bd=40;33;01:cd=40;33;01:or=40;31;01:mi=00:su=37;41:sg=30;43:ca=30;41:tw=30;42:ow=34;42:st=37;44:ex=01;32:*.tar=01;31:*.tgz=01;31:*.arc=01;31:*.arj=01;31:*.taz=01;31:*.lha=01;31:*.lz4=01;31:*.lzh=01;31:*.lzma=01;31:*.tlz=01;31:*.txz=01;31:*.tzo=01;31:*.t7z=01;31:*.zip=01;31:*.z=01;31:*.Z=01;31:*.dz=01;31:*.gz=01;31:*.lrz=01;31:*.lz=01;31:*.lzo=01;31:*.xz=01;31:*.zst=01;31:*.tzst=01;31:*.bz2=01;31:*.bz=01;31:*.tbz=01;31:*.tbz2=01;31:*.tz=01;31:*.deb=01;31:*.rpm=01;31:*.jar=01;31:*.war=01;31:*.ear=01;31:*.sar=01;31:*.rar=01;31:*.alz=01;31:*.ace=01;31:*.zoo=01;31:*.cpio=01;31:*.7z=01;31:*.rz=01;31:*.cab=01;31:*.wim=01;31:*.swm=01;31:*.dwm=01;31:*.esd=01;31:*.jpg=01;35:*.jpeg=01;35:*.mjpg=01;35:*.mjpeg=01;35:*.gif=01;35:*.bmp=01;35:*.pbm=01;35:*.pgm=01;35:*.ppm=01;35:*.tga=01;35:*.xbm=01;35:*.xpm=01;35:*.tif=01;35:*.tiff=01;35:*.png=01;35:*.svg=01;35:*.svgz=01;35:*.mng=01;35:*.pcx=01;35:*.mov=01;35:*.mpg=01;35:*.mpeg=01;35:*.m2v=01;35:*.mkv=01;35:*.webm=01;35:*.ogm=01;35:*.mp4=01;35:*.m4v=01;35:*.mp4v=01;35:*.vob=01;35:*.qt=01;35:*.nuv=01;35:*.wmv=01;35:*.asf=01;35:*.rm=01;35:*.rmvb=01;35:*.flc=01;35:*.avi=01;35:*.fli=01;35:*.flv=01;35:*.gl=01;35:*.dl=01;35:*.xcf=01;35:*.xwd=01;35:*.yuv=01;35:*.cgm=01;35:*.emf=01;35:*.ogv=01;35:*.ogx=01;35:*.aac=00;36:*.au=00;36:*.flac=00;36:*.m4a=00;36:*.mid=00;36:*.midi=00;36:*.mka=00;36:*.mp3=00;36:*.mpc=00;36:*.ogg=00;36:*.ra=00;36:*.wav=00;36:*.oga=00;36:*.opus=00;36:*.spx=00;36:*.xspf=00;36:', 'LD_LIBRARY_PATH': '/opt/crashrepair/lib:/CrashRepair/lib:/klee/build/lib:', 'CONDA_EXE': '/root/anaconda3/bin/conda', 'LANG': 'C.UTF-8', 'TZ': 'Asia/Shanghai', 'HOSTNAME': 'fea22102047d', 'OLDPWD': '/orchestrator', 'CONDA_PREFIX': '/root/anaconda3/envs/CrashRepair', '_CE_M': '', 'CC': 'crepair-cc', 'LLVM_COMPILER': 'clang', 'CONDA_PREFIX_1': '/root/anaconda3', 'PWD': '/orchestrator/crashrepair', 'HOME': '/root', 'CONDA_PYTHON_EXE': '/root/anaconda3/bin/python', '_CE_CONDA': '', 'CONDA_PROMPT_MODIFIER': '(CrashRepair) ', 'CXX': 'crepair-cxx', 'TERM': 'xterm', 'SHLVL': '2', 'PYTHONPATH': '/usr/lib/python3.8/site-packages:', 'PATH': '/root/anaconda3/envs/CrashRepair/bin:/root/anaconda3/condabin:~/anaconda3/bin:/opt/crashrepair/bin:/CrashRepair/compiler:/klee/build/bin:/opt/llvm-6/bin:/klee/build/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', 'CONDA_DEFAULT_ENV': 'CrashRepair', '_': '/root/anaconda3/envs/CrashRepair/bin/python'})
2025-02-03 22:36:47.299 | DEBUG    | scenario:rebuild:382 - injecting ghost function into CFLAGS during build: -lcrepair_ghost
2025-02-03 22:36:47.299 | DEBUG    | scenario:rebuild:398 - using environment: {'INJECT_CFLAGS': '-g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address', 'INJECT_CXXFLAGS': '-g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address', 'INJECT_LDFLAGS': '-g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address'}
2025-02-03 22:36:47.299 | DEBUG    | shell:__call__:41 - executing: make CFLAGS="${INJECT_CFLAGS}" CXXFLAGS="${INJECT_CXXFLAGS}" LDFLAGS="${INJECT_LDFLAGS}"
Making all in port
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/port'
make[1]: Nothing to be done for 'all'.
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/port'
Making all in libtiff
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/libtiff'
make  all-am
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/libtiff'
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/libtiff'
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/libtiff'
Making all in tools
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/tools'
crepair-cc -DHAVE_CONFIG_H -I. -I../libtiff  -I../libtiff   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -MT tiffcrop.o -MD -MP -MF .deps/tiffcrop.Tpo -c -o tiffcrop.o tiffcrop.c
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_ghost: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
mv -f .deps/tiffcrop.Tpo .deps/tiffcrop.Po
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address  -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -o tiffcrop tiffcrop.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -g -O0 -Wno-error -I/CrashRepair/lib -fsanitize=address -g -O0 -Wno-error -I/CrashRepair/lib -fsanitize=address -o tiffcrop tiffcrop.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a ../port/.libs/libport.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -llzma -ljbig -ljpeg -lz -lm
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/tools'
Making all in build
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/build'
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/build'
make[2]: Nothing to be done for 'all-am'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/build'
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/build'
Making all in contrib
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib'
Making all in addtiffo
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/addtiffo'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/addtiffo'
Making all in dbs
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/dbs'
Making all in xtiff
make[3]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/dbs/xtiff'
make[3]: Nothing to be done for 'all'.
make[3]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/dbs/xtiff'
make[3]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/dbs'
make[3]: Nothing to be done for 'all-am'.
make[3]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/dbs'
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/dbs'
Making all in iptcutil
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/iptcutil'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/iptcutil'
Making all in mfs
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/mfs'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/mfs'
Making all in pds
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/pds'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/pds'
Making all in ras
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/ras'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/ras'
Making all in stream
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/stream'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/stream'
Making all in tags
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/tags'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/tags'
Making all in win_dib
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/win_dib'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/win_dib'
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib'
make[2]: Nothing to be done for 'all-am'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib'
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib'
Making all in test
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/test'
make[1]: Nothing to be done for 'all'.
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/test'
Making all in man
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/man'
make[1]: Nothing to be done for 'all'.
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/man'
Making all in html
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html'
Making all in images
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html/images'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html/images'
Making all in man
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html/man'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html/man'
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html'
make[2]: Nothing to be done for 'all-am'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html'
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html'
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src'
make[1]: Nothing to be done for 'all-am'.
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src'
2025-02-03 22:36:47.782 | DEBUG    | scenario:evaluate:655 - testing candidate #0 against test #crash...
2025-02-03 22:36:47.782 | DEBUG    | shell:__call__:41 - executing: /data/vulnloc/libtiff/CVE-2016-5321/src/tools/tiffcrop /CrashRepair/experiments/vulnloc/libtiff/CVE-2016-5321/tests/1.tif foo.tif
2025-02-03 22:36:47.786 | DEBUG    | test:run:189 - test failed: unexpected exit code (actual: 255, expected: 0)
2025-02-03 22:36:47.786 | INFO     | scenario:evaluate:662 - candidate #0 fails test #crash
2025-02-03 22:36:47.790 | INFO     | scenario:evaluate:635 - evaluating candidate patch #1:
@@ -949,6 +949,7 @@
   }
 
 
+
 static int readSeparateTilesIntoBuffer (TIFF* in, uint8 *obuf, 
                                          uint32 imagelength, uint32 imagewidth, 
                                          uint32 tw, uint32 tl,
@@ -968,6 +969,11 @@
 
     bytes_per_sample = (bps + 7) / 8;
 
+    if (spp > (64 / 8)) { // Prevent exceeding maximum sample size
+        TIFFError("readSeparateTilesIntoBuffer", "Sample plane count exceeds maximum allowed.");
+        return 0;
+    }
+
     for (sample = 0; (sample < spp) && (sample < MAX_SAMPLES); sample++)
     {
         srcbuffs[sample] = NULL;
@@ -1103,6 +1109,7 @@
 }
 
 
+
 static int writeBufferToContigStrips(TIFF* out, uint8* buf, uint32 imagelength)
   {
   uint32 row, nrows, rowsperstrip;

2025-02-03 22:36:47.796 | DEBUG    | scenario:rebuild:369 - original environment: environ({'CONDA_SHLVL': '2', 'LC_ALL': 'C.UTF-8', 'LS_COLORS': 'rs=0:di=01;34:ln=01;36:mh=00:pi=40;33:so=01;35:do=01;35:bd=40;33;01:cd=40;33;01:or=40;31;01:mi=00:su=37;41:sg=30;43:ca=30;41:tw=30;42:ow=34;42:st=37;44:ex=01;32:*.tar=01;31:*.tgz=01;31:*.arc=01;31:*.arj=01;31:*.taz=01;31:*.lha=01;31:*.lz4=01;31:*.lzh=01;31:*.lzma=01;31:*.tlz=01;31:*.txz=01;31:*.tzo=01;31:*.t7z=01;31:*.zip=01;31:*.z=01;31:*.Z=01;31:*.dz=01;31:*.gz=01;31:*.lrz=01;31:*.lz=01;31:*.lzo=01;31:*.xz=01;31:*.zst=01;31:*.tzst=01;31:*.bz2=01;31:*.bz=01;31:*.tbz=01;31:*.tbz2=01;31:*.tz=01;31:*.deb=01;31:*.rpm=01;31:*.jar=01;31:*.war=01;31:*.ear=01;31:*.sar=01;31:*.rar=01;31:*.alz=01;31:*.ace=01;31:*.zoo=01;31:*.cpio=01;31:*.7z=01;31:*.rz=01;31:*.cab=01;31:*.wim=01;31:*.swm=01;31:*.dwm=01;31:*.esd=01;31:*.jpg=01;35:*.jpeg=01;35:*.mjpg=01;35:*.mjpeg=01;35:*.gif=01;35:*.bmp=01;35:*.pbm=01;35:*.pgm=01;35:*.ppm=01;35:*.tga=01;35:*.xbm=01;35:*.xpm=01;35:*.tif=01;35:*.tiff=01;35:*.png=01;35:*.svg=01;35:*.svgz=01;35:*.mng=01;35:*.pcx=01;35:*.mov=01;35:*.mpg=01;35:*.mpeg=01;35:*.m2v=01;35:*.mkv=01;35:*.webm=01;35:*.ogm=01;35:*.mp4=01;35:*.m4v=01;35:*.mp4v=01;35:*.vob=01;35:*.qt=01;35:*.nuv=01;35:*.wmv=01;35:*.asf=01;35:*.rm=01;35:*.rmvb=01;35:*.flc=01;35:*.avi=01;35:*.fli=01;35:*.flv=01;35:*.gl=01;35:*.dl=01;35:*.xcf=01;35:*.xwd=01;35:*.yuv=01;35:*.cgm=01;35:*.emf=01;35:*.ogv=01;35:*.ogx=01;35:*.aac=00;36:*.au=00;36:*.flac=00;36:*.m4a=00;36:*.mid=00;36:*.midi=00;36:*.mka=00;36:*.mp3=00;36:*.mpc=00;36:*.ogg=00;36:*.ra=00;36:*.wav=00;36:*.oga=00;36:*.opus=00;36:*.spx=00;36:*.xspf=00;36:', 'LD_LIBRARY_PATH': '/opt/crashrepair/lib:/CrashRepair/lib:/klee/build/lib:', 'CONDA_EXE': '/root/anaconda3/bin/conda', 'LANG': 'C.UTF-8', 'TZ': 'Asia/Shanghai', 'HOSTNAME': 'fea22102047d', 'OLDPWD': '/orchestrator', 'CONDA_PREFIX': '/root/anaconda3/envs/CrashRepair', '_CE_M': '', 'CC': 'crepair-cc', 'LLVM_COMPILER': 'clang', 'CONDA_PREFIX_1': '/root/anaconda3', 'PWD': '/orchestrator/crashrepair', 'HOME': '/root', 'CONDA_PYTHON_EXE': '/root/anaconda3/bin/python', '_CE_CONDA': '', 'CONDA_PROMPT_MODIFIER': '(CrashRepair) ', 'CXX': 'crepair-cxx', 'TERM': 'xterm', 'SHLVL': '2', 'PYTHONPATH': '/usr/lib/python3.8/site-packages:', 'PATH': '/root/anaconda3/envs/CrashRepair/bin:/root/anaconda3/condabin:~/anaconda3/bin:/opt/crashrepair/bin:/CrashRepair/compiler:/klee/build/bin:/opt/llvm-6/bin:/klee/build/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', 'CONDA_DEFAULT_ENV': 'CrashRepair', '_': '/root/anaconda3/envs/CrashRepair/bin/python'})
2025-02-03 22:36:47.796 | DEBUG    | scenario:rebuild:382 - injecting ghost function into CFLAGS during build: -lcrepair_ghost
2025-02-03 22:36:47.796 | DEBUG    | scenario:rebuild:398 - using environment: {'INJECT_CFLAGS': '-g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address', 'INJECT_CXXFLAGS': '-g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address', 'INJECT_LDFLAGS': '-g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address'}
2025-02-03 22:36:47.796 | DEBUG    | shell:__call__:41 - executing: make CFLAGS="${INJECT_CFLAGS}" CXXFLAGS="${INJECT_CXXFLAGS}" LDFLAGS="${INJECT_LDFLAGS}"
Making all in port
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/port'
make[1]: Nothing to be done for 'all'.
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/port'
Making all in libtiff
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/libtiff'
make  all-am
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/libtiff'
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/libtiff'
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/libtiff'
Making all in tools
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/tools'
crepair-cc -DHAVE_CONFIG_H -I. -I../libtiff  -I../libtiff   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -MT tiffcrop.o -MD -MP -MF .deps/tiffcrop.Tpo -c -o tiffcrop.o tiffcrop.c
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_ghost: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
mv -f .deps/tiffcrop.Tpo .deps/tiffcrop.Po
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address  -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -o tiffcrop tiffcrop.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -g -O0 -Wno-error -I/CrashRepair/lib -fsanitize=address -g -O0 -Wno-error -I/CrashRepair/lib -fsanitize=address -o tiffcrop tiffcrop.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a ../port/.libs/libport.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -llzma -ljbig -ljpeg -lz -lm
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/tools'
Making all in build
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/build'
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/build'
make[2]: Nothing to be done for 'all-am'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/build'
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/build'
Making all in contrib
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib'
Making all in addtiffo
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/addtiffo'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/addtiffo'
Making all in dbs
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/dbs'
Making all in xtiff
make[3]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/dbs/xtiff'
make[3]: Nothing to be done for 'all'.
make[3]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/dbs/xtiff'
make[3]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/dbs'
make[3]: Nothing to be done for 'all-am'.
make[3]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/dbs'
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/dbs'
Making all in iptcutil
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/iptcutil'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/iptcutil'
Making all in mfs
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/mfs'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/mfs'
Making all in pds
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/pds'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/pds'
Making all in ras
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/ras'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/ras'
Making all in stream
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/stream'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/stream'
Making all in tags
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/tags'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/tags'
Making all in win_dib
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/win_dib'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/win_dib'
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib'
make[2]: Nothing to be done for 'all-am'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib'
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib'
Making all in test
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/test'
make[1]: Nothing to be done for 'all'.
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/test'
Making all in man
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/man'
make[1]: Nothing to be done for 'all'.
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/man'
Making all in html
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html'
Making all in images
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html/images'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html/images'
Making all in man
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html/man'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html/man'
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html'
make[2]: Nothing to be done for 'all-am'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html'
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html'
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src'
make[1]: Nothing to be done for 'all-am'.
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src'
2025-02-03 22:36:48.282 | DEBUG    | scenario:evaluate:655 - testing candidate #1 against test #crash...
2025-02-03 22:36:48.282 | DEBUG    | shell:__call__:41 - executing: /data/vulnloc/libtiff/CVE-2016-5321/src/tools/tiffcrop /CrashRepair/experiments/vulnloc/libtiff/CVE-2016-5321/tests/1.tif foo.tif
2025-02-03 22:36:48.287 | DEBUG    | test:run:189 - test failed: unexpected exit code (actual: 255, expected: 0)
2025-02-03 22:36:48.287 | INFO     | scenario:evaluate:662 - candidate #1 fails test #crash
2025-02-03 22:36:48.292 | INFO     | scenario:evaluate:635 - evaluating candidate patch #2:
@@ -949,6 +949,7 @@
   }
 
 
+
 static int readSeparateTilesIntoBuffer (TIFF* in, uint8 *obuf, 
                                          uint32 imagelength, uint32 imagewidth, 
                                          uint32 tw, uint32 tl,
@@ -990,7 +991,7 @@
         nrow = (row + tl > imagelength) ? imagelength - row : tl;
         for (col = 0; col < imagewidth; col += tw)
         {
-            for (s = 0; s < spp; s++)
+            for (s = 0; s < spp && s < 8; s++) // Restricting the maximum samples processed
             {  
                 /* Validate TIFFReadTile return value to avoid processing errors */
                 tbytes = TIFFReadTile(in, srcbuffs[s], col, row, 0, s);
@@ -1103,6 +1104,7 @@
 }
 
 
+
 static int writeBufferToContigStrips(TIFF* out, uint8* buf, uint32 imagelength)
   {
   uint32 row, nrows, rowsperstrip;

2025-02-03 22:36:48.298 | DEBUG    | scenario:rebuild:369 - original environment: environ({'CONDA_SHLVL': '2', 'LC_ALL': 'C.UTF-8', 'LS_COLORS': 'rs=0:di=01;34:ln=01;36:mh=00:pi=40;33:so=01;35:do=01;35:bd=40;33;01:cd=40;33;01:or=40;31;01:mi=00:su=37;41:sg=30;43:ca=30;41:tw=30;42:ow=34;42:st=37;44:ex=01;32:*.tar=01;31:*.tgz=01;31:*.arc=01;31:*.arj=01;31:*.taz=01;31:*.lha=01;31:*.lz4=01;31:*.lzh=01;31:*.lzma=01;31:*.tlz=01;31:*.txz=01;31:*.tzo=01;31:*.t7z=01;31:*.zip=01;31:*.z=01;31:*.Z=01;31:*.dz=01;31:*.gz=01;31:*.lrz=01;31:*.lz=01;31:*.lzo=01;31:*.xz=01;31:*.zst=01;31:*.tzst=01;31:*.bz2=01;31:*.bz=01;31:*.tbz=01;31:*.tbz2=01;31:*.tz=01;31:*.deb=01;31:*.rpm=01;31:*.jar=01;31:*.war=01;31:*.ear=01;31:*.sar=01;31:*.rar=01;31:*.alz=01;31:*.ace=01;31:*.zoo=01;31:*.cpio=01;31:*.7z=01;31:*.rz=01;31:*.cab=01;31:*.wim=01;31:*.swm=01;31:*.dwm=01;31:*.esd=01;31:*.jpg=01;35:*.jpeg=01;35:*.mjpg=01;35:*.mjpeg=01;35:*.gif=01;35:*.bmp=01;35:*.pbm=01;35:*.pgm=01;35:*.ppm=01;35:*.tga=01;35:*.xbm=01;35:*.xpm=01;35:*.tif=01;35:*.tiff=01;35:*.png=01;35:*.svg=01;35:*.svgz=01;35:*.mng=01;35:*.pcx=01;35:*.mov=01;35:*.mpg=01;35:*.mpeg=01;35:*.m2v=01;35:*.mkv=01;35:*.webm=01;35:*.ogm=01;35:*.mp4=01;35:*.m4v=01;35:*.mp4v=01;35:*.vob=01;35:*.qt=01;35:*.nuv=01;35:*.wmv=01;35:*.asf=01;35:*.rm=01;35:*.rmvb=01;35:*.flc=01;35:*.avi=01;35:*.fli=01;35:*.flv=01;35:*.gl=01;35:*.dl=01;35:*.xcf=01;35:*.xwd=01;35:*.yuv=01;35:*.cgm=01;35:*.emf=01;35:*.ogv=01;35:*.ogx=01;35:*.aac=00;36:*.au=00;36:*.flac=00;36:*.m4a=00;36:*.mid=00;36:*.midi=00;36:*.mka=00;36:*.mp3=00;36:*.mpc=00;36:*.ogg=00;36:*.ra=00;36:*.wav=00;36:*.oga=00;36:*.opus=00;36:*.spx=00;36:*.xspf=00;36:', 'LD_LIBRARY_PATH': '/opt/crashrepair/lib:/CrashRepair/lib:/klee/build/lib:', 'CONDA_EXE': '/root/anaconda3/bin/conda', 'LANG': 'C.UTF-8', 'TZ': 'Asia/Shanghai', 'HOSTNAME': 'fea22102047d', 'OLDPWD': '/orchestrator', 'CONDA_PREFIX': '/root/anaconda3/envs/CrashRepair', '_CE_M': '', 'CC': 'crepair-cc', 'LLVM_COMPILER': 'clang', 'CONDA_PREFIX_1': '/root/anaconda3', 'PWD': '/orchestrator/crashrepair', 'HOME': '/root', 'CONDA_PYTHON_EXE': '/root/anaconda3/bin/python', '_CE_CONDA': '', 'CONDA_PROMPT_MODIFIER': '(CrashRepair) ', 'CXX': 'crepair-cxx', 'TERM': 'xterm', 'SHLVL': '2', 'PYTHONPATH': '/usr/lib/python3.8/site-packages:', 'PATH': '/root/anaconda3/envs/CrashRepair/bin:/root/anaconda3/condabin:~/anaconda3/bin:/opt/crashrepair/bin:/CrashRepair/compiler:/klee/build/bin:/opt/llvm-6/bin:/klee/build/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', 'CONDA_DEFAULT_ENV': 'CrashRepair', '_': '/root/anaconda3/envs/CrashRepair/bin/python'})
2025-02-03 22:36:48.298 | DEBUG    | scenario:rebuild:382 - injecting ghost function into CFLAGS during build: -lcrepair_ghost
2025-02-03 22:36:48.298 | DEBUG    | scenario:rebuild:398 - using environment: {'INJECT_CFLAGS': '-g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address', 'INJECT_CXXFLAGS': '-g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address', 'INJECT_LDFLAGS': '-g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address'}
2025-02-03 22:36:48.298 | DEBUG    | shell:__call__:41 - executing: make CFLAGS="${INJECT_CFLAGS}" CXXFLAGS="${INJECT_CXXFLAGS}" LDFLAGS="${INJECT_LDFLAGS}"
Making all in port
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/port'
make[1]: Nothing to be done for 'all'.
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/port'
Making all in libtiff
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/libtiff'
make  all-am
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/libtiff'
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/libtiff'
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/libtiff'
Making all in tools
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/tools'
crepair-cc -DHAVE_CONFIG_H -I. -I../libtiff  -I../libtiff   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -MT tiffcrop.o -MD -MP -MF .deps/tiffcrop.Tpo -c -o tiffcrop.o tiffcrop.c
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_ghost: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
mv -f .deps/tiffcrop.Tpo .deps/tiffcrop.Po
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address  -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -fsanitize=address -o tiffcrop tiffcrop.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -g -O0 -Wno-error -I/CrashRepair/lib -fsanitize=address -g -O0 -Wno-error -I/CrashRepair/lib -fsanitize=address -o tiffcrop tiffcrop.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a ../port/.libs/libport.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy -lcrepair_ghost -llzma -ljbig -ljpeg -lz -lm
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/tools'
Making all in build
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/build'
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/build'
make[2]: Nothing to be done for 'all-am'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/build'
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/build'
Making all in contrib
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib'
Making all in addtiffo
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/addtiffo'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/addtiffo'
Making all in dbs
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/dbs'
Making all in xtiff
make[3]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/dbs/xtiff'
make[3]: Nothing to be done for 'all'.
make[3]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/dbs/xtiff'
make[3]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/dbs'
make[3]: Nothing to be done for 'all-am'.
make[3]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/dbs'
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/dbs'
Making all in iptcutil
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/iptcutil'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/iptcutil'
Making all in mfs
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/mfs'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/mfs'
Making all in pds
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/pds'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/pds'
Making all in ras
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/ras'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/ras'
Making all in stream
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/stream'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/stream'
Making all in tags
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/tags'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/tags'
Making all in win_dib
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/win_dib'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib/win_dib'
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib'
make[2]: Nothing to be done for 'all-am'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib'
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/contrib'
Making all in test
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/test'
make[1]: Nothing to be done for 'all'.
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/test'
Making all in man
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/man'
make[1]: Nothing to be done for 'all'.
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/man'
Making all in html
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html'
Making all in images
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html/images'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html/images'
Making all in man
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html/man'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html/man'
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html'
make[2]: Nothing to be done for 'all-am'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html'
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src/html'
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2016-5321/src'
make[1]: Nothing to be done for 'all-am'.
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2016-5321/src'
2025-02-03 22:36:48.778 | DEBUG    | scenario:evaluate:655 - testing candidate #2 against test #crash...
2025-02-03 22:36:48.778 | DEBUG    | shell:__call__:41 - executing: /data/vulnloc/libtiff/CVE-2016-5321/src/tools/tiffcrop /CrashRepair/experiments/vulnloc/libtiff/CVE-2016-5321/tests/1.tif foo.tif
2025-02-03 22:36:48.782 | INFO     | scenario:evaluate:659 - candidate #2 passes test #crash
2025-02-03 22:36:48.782 | INFO     | scenario:evaluate:674 - repair found! candidate #2 passes all tests
2025-02-03 22:36:48.787 | INFO     | scenario:validate:513 - saving successful patch #2...
2025-02-03 22:36:48.788 | INFO     | scenario:validate:520 - stopping search: patch was found
2025-02-03 22:36:48.789 | INFO     | scenario:iterative_repair:831 - iteration_validation_report:#[{'summary': {'duration-minutes': {'overall': 0.23913440268370323, 'tests': 0.0002101687161484733, 'compilation': 0.024459570049657486}, 'num-patches-evaluated': 3, 'num-repairs-found': 1, 'num-compilation-failures': 0}, 'evaluations': [{'patch-id': 0, 'is-repair': False, 'candidate-diff': '@@ -949,6 +949,7 @@\n   }\n \n \n+\n static int readSeparateTilesIntoBuffer (TIFF* in, uint8 *obuf, \n                                          uint32 imagelength, uint32 imagewidth, \n                                          uint32 tw, uint32 tl,\n@@ -968,6 +969,11 @@\n \n     bytes_per_sample = (bps + 7) / 8;\n \n+    if (spp >= 8) { // Enforce constraint\n+        TIFFError("readSeparateTilesIntoBuffer", "Sample per pixel too high: %d", spp);\n+        return 0;\n+    }\n+\n     for (sample = 0; (sample < spp) && (sample < MAX_SAMPLES); sample++)\n     {\n         srcbuffs[sample] = NULL;\n@@ -1103,6 +1109,7 @@\n }\n \n \n+\n static int writeBufferToContigStrips(TIFF* out, uint8* buf, uint32 imagelength)\n   {\n   uint32 row, nrows, rowsperstrip;\n', 'location': '/data/vulnloc/libtiff/CVE-2016-5321/src/tools/tiffcrop.c:993:13', 'compiles': True, 'time-taken-seconds': {'total': 0.49472759396303445, 'compile': 0.49079158599488437, 'tests': 0.003936007968150079}, 'tests': {'executed': 1, 'passed': 0, 'failed': 1, 'outcomes': [{'successful': False, 'return-code': 255, 'duration': 0.0034632760216481984, 'failure-reason': 'bad-exit-code'}]}}, {'patch-id': 1, 'is-repair': False, 'candidate-diff': '@@ -949,6 +949,7 @@\n   }\n \n \n+\n static int readSeparateTilesIntoBuffer (TIFF* in, uint8 *obuf, \n                                          uint32 imagelength, uint32 imagewidth, \n                                          uint32 tw, uint32 tl,\n@@ -968,6 +969,11 @@\n \n     bytes_per_sample = (bps + 7) / 8;\n \n+    if (spp > (64 / 8)) { // Prevent exceeding maximum sample size\n+        TIFFError("readSeparateTilesIntoBuffer", "Sample plane count exceeds maximum allowed.");\n+        return 0;\n+    }\n+\n     for (sample = 0; (sample < spp) && (sample < MAX_SAMPLES); sample++)\n     {\n         srcbuffs[sample] = NULL;\n@@ -1103,6 +1109,7 @@\n }\n \n \n+\n static int writeBufferToContigStrips(TIFF* out, uint8* buf, uint32 imagelength)\n   {\n   uint32 row, nrows, rowsperstrip;\n', 'location': '/data/vulnloc/libtiff/CVE-2016-5321/src/tools/tiffcrop.c:993:13', 'compiles': True, 'time-taken-seconds': {'total': 0.49612905201502144, 'compile': 0.4915659970138222, 'tests': 0.0045630550011992455}, 'tests': {'executed': 1, 'passed': 0, 'failed': 1, 'outcomes': [{'successful': False, 'return-code': 255, 'duration': 0.004066049994435161, 'failure-reason': 'bad-exit-code'}]}}, {'patch-id': 2, 'is-repair': True, 'candidate-diff': '@@ -949,6 +949,7 @@\n   }\n \n \n+\n static int readSeparateTilesIntoBuffer (TIFF* in, uint8 *obuf, \n                                          uint32 imagelength, uint32 imagewidth, \n                                          uint32 tw, uint32 tl,\n@@ -990,7 +991,7 @@\n         nrow = (row + tl > imagelength) ? imagelength - row : tl;\n         for (col = 0; col < imagewidth; col += tw)\n         {\n-            for (s = 0; s < spp; s++)\n+            for (s = 0; s < spp && s < 8; s++) // Restricting the maximum samples processed\n             {  \n                 /* Validate TIFFReadTile return value to avoid processing errors */\n                 tbytes = TIFFReadTile(in, srcbuffs[s], col, row, 0, s);\n@@ -1103,6 +1104,7 @@\n }\n \n \n+\n static int writeBufferToContigStrips(TIFF* out, uint8* buf, uint32 imagelength)\n   {\n   uint32 row, nrows, rowsperstrip;\n', 'location': '/data/vulnloc/libtiff/CVE-2016-5321/src/tools/tiffcrop.c:993:13', 'compiles': True, 'time-taken-seconds': {'total': 0.4893276799703017, 'compile': 0.4852166199707426, 'tests': 0.004111059999559075}, 'tests': {'executed': 1, 'passed': 1, 'failed': 0, 'outcomes': [{'successful': True, 'return-code': 0, 'duration': 0.003715797036420554}]}}], 'repairs': [2]}]
2025-02-03 22:36:48.789 | INFO     | scenario:iterative_repair:832 - iteration_analysis_report:#[{'summary': {'duration-minutes': 0.0, 'num-candidates': 0}, 'candidates': []}]
2025-02-03 22:36:48.789 | INFO     | scenario:iterative_repair:834 - successful patch #19 found
2025-02-03 22:36:48.794 | INFO     | scenario:iterative_repair:843 - reverting candidate patch #19...

