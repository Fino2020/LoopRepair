2025-02-03 13:30:09.725 | INFO     | scenario:build:265 - loaded bug scenario: Scenario(subject='libtiff', name='CVE-2017-7595', directory='/data/vulnloc/libtiff/CVE-2017-7595', build_directory='/data/vulnloc/libtiff/CVE-2017-7595/src', source_directory='/data/vulnloc/libtiff/CVE-2017-7595/src', tag_id='libtiff_CVE-2017-7595', binary_path='/data/vulnloc/libtiff/CVE-2017-7595/src/tools/tiffcp', clean_command='make clean', prebuild_command='./configure --enable-static --disable-shared', build_command='make CFLAGS="${INJECT_CFLAGS}" CXXFLAGS="${INJECT_CXXFLAGS}" LDFLAGS="${INJECT_LDFLAGS}"', crashing_command='-i $POC out.tiff', crashing_input='/CrashRepair/experiments/vulnloc/libtiff/CVE-2017-7595/tests/1.tif', shell=Shell(cwd='/data/vulnloc/libtiff/CVE-2017-7595'), crash_test=Test(name='crash', command='/data/vulnloc/libtiff/CVE-2017-7595/src/tools/tiffcp -i /CrashRepair/experiments/vulnloc/libtiff/CVE-2017-7595/tests/1.tif out.tiff', expected_exit_code=1, expected_stdout=None, bad_output='UndefinedBehaviorSanitizer:', asan_options=None, ubsan_options=None), sanitizer_flags='-fsanitize=integer-divide-by-zero', additional_klee_flags='--link-llvm-lib=/CrashRepair/lib/libjpeg-8.4.bca', expected_exit_code_for_crashing_input=0, should_terminate_early=True, fuzzer_tests=[], fuzzer=None, time_limit_minutes_validation=None, time_limit_seconds_single_test=30, time_limit_minutes_analysis=3600, halt_on_error=True, rebuild_for_validation=False, asan_options=None, ubsan_options=None, use_ghost_functions=False, acceptable_patch_limit=None)
2025-02-03 13:30:09.725 | INFO     | scenario:fuzz:426 - skipping fuzzing: fuzzer disabled
2025-02-03 13:30:09.725 | INFO     | analyzer:run:114 - running analysis with timeout: 60 minutes
2025-02-03 13:30:09.726 | DEBUG    | analyzer:write_config_to_file:88 - generated analyzer config:

dir_exp:/data/vulnloc/libtiff/CVE-2017-7595
tag_id:libtiff_CVE-2017-7595
src_directory:/data/vulnloc/libtiff/CVE-2017-7595/src
binary_path:/data/vulnloc/libtiff/CVE-2017-7595/src/tools/tiffcp
config_command:./configure --enable-static --disable-shared
build_command:make CFLAGS="${INJECT_CFLAGS}" CXXFLAGS="${INJECT_CXXFLAGS}" LDFLAGS="${INJECT_LDFLAGS}"
test_input_list:-i $POC out.tiff
poc_list:/CrashRepair/experiments/vulnloc/libtiff/CVE-2017-7595/tests/1.tif
klee_flags:--link-llvm-lib=/CrashRepair/lib/libcrepair_proxy.bca --link-llvm-lib=/CrashRepair/lib/libjpeg-8.4.bca

2025-02-03 13:30:09.726 | DEBUG    | analyzer:run:124 - wrote analyzer config file to: /tmp/tmp5n6bl46x
2025-02-03 13:30:09.726 | DEBUG    | shell:__call__:41 - executing: crepair --conf=/tmp/tmp5n6bl46x
[K[1;36m
====================================================================================================

	Starting CRepair (C Crash Repair) 
====================================================================================================
[0m
[K[1;36m
	Loading Configurations
	__________________________________________________________________________________________
[0m
[K	[1;34mreading configuration values from arguments[0m
[K	[1;34mreading configuration values form configuration file[0m
[K	[1;37m	[file] /tmp/tmp5n6bl46x[0m
[K	[1;34mupdating configuration values[0m
[K	[1;34mreading test configuration[0m
[K	[1;34mreading seed information[0m
[K	[1;37m	[config] stack size: 15000[0m
[K	[1;37m	[config] collecting stats: False[0m
[K	[1;37m	[config] number of tests: 1[0m
[K	[1;37m	[config] number of cores: 8[0m
[K	[1;37m	[config] klee concrete execution timeout: 600[0m
[K	[1;37m	[config] klee concolic execution timeout: 1200[0m
[K	[1;37m	[config] synthesize subset expressions: True[0m
[K	[1;37m	[config] window size for taint locations: 500[0m
[K	[1;37m	[config] window size for taint values: 500000[0m
[K[1;36m

	Analyzing Program
====================================================================================================
[0m
[K[1;36m
	Test Case #1
	__________________________________________________________________________________________
[0m
[K[1;36m
		Running Concrete Execution
		------------------------------------------------------------------------------------------
[0m
[K	[1;37m	[0m[K     [1;37mUsing Arguments: ['-i', '$POC', 'out.tiff'][0m
[K	[1;37m	[0m[K     [1;37mUsing Input File: /CrashRepair/experiments/vulnloc/libtiff/CVE-2017-7595/tests/1.tif[0m
[K	[1;34m	building program[0m
[K	[1;34m		setting environment variables[0m
[K	[1;34m		cleaning files[0m
[K	[1;34m		configuring program[0m
[K	[1;34m		compiling program[0m
[K	[1;37m	[0m[K     [1;37mUsing Binary: /data/vulnloc/libtiff/CVE-2017-7595/src/tools/tiffcp[0m
[K	[1;34m	extracting bytecode[0m
[K	[1;34m	executing klee in concrete mode[0m
[K	[1;34m	extracting instruction trace[0m
[K	[1;37m		[note] program crashed[0m
[K	[1;34m	collecting tainted expressions[0m
[K	[1;34m	collecting tainted concrete values[0m
[K	[1;34m	collecting memory allocations/de-allocations[0m
[K	[1;34m	collecting pointer mapping[0m
[K	[1;34m	extracting crash information[0m
[K	[1;37m		[0m[K     [1;37m[info] crash type: division by zero[0m
[K	[1;37m		[0m[K     [1;37m[info] crash location:
                             /data/vulnloc/libtiff/CVE-2017-7595/src/libtiff/tif_jpeg.c:1685:26[0m
[K	[1;37m		[0m[K     [1;37m[info] crash function: JPEGSetupEncode[0m
[K	[1;37m		[0m[K     [1;37m[info] crash address: 63133[0m
[K	[1;37m		[0m[K     [1;37m[info] crash free constraint: ((@var(integer, sp->v_sampling) * 8) != 0)[0m
[K	[1;37m		[0m[K     [1;37m[info] crash inducing variables: sp->v_sampling[0m
[K	[1;37m			[info] identified crash type: division by zero[0m
[K[1;36m
		Running Concolic Execution
		------------------------------------------------------------------------------------------
[0m
[K	[1;37m	[0m[K     [1;37mUsing Arguments: ['-i', '$POC', 'out.tiff'][0m
[K	[1;37m	[0m[K     [1;37mUsing Input File: /CrashRepair/experiments/vulnloc/libtiff/CVE-2017-7595/tests/1.tif[0m
[K	[1;34m	building program[0m
[K	[1;34m		setting environment variables[0m
[K	[1;34m		cleaning files[0m
[K	[1;34m		configuring program[0m
[K	[1;34m		compiling program[0m
[K	[1;34m	extracting bytecode[0m
[K	[1;34m	generating ktest file[0m
[K	[1;34m	executing klee in concolic mode[0m
[K	[1;34m	extracting largest symbolic path[0m
[K	[1;34m	extracting instruction trace[0m
[K	[1;37m		[note] program crashed[0m
[K	[1;34m	collecting tainted expressions[0m
[K	[1;34m	collecting memory allocations/de-allocations[0m
[K	[1;34m	collecting pointer mapping[0m
[K	[1;37m		[0m[K     [1;37m[info] Symbolic Mapping: sp->v_sampling -> [A-data_182,A-data_183][0m
[K[1;36m

	Fix Localization
====================================================================================================
[0m
[K[1;36m
	Generating Fix Locations
	__________________________________________________________________________________________
[0m
[K	[1;34m	generating taint map[0m
[K	[1;37m		[0m[K     [1;37m[info] found 5218 tainted locations[0m
[K	[1;34m		starting parallel computing[0m
[K	[1;34m		waiting for thread completion[0m
[K	[1;37m		[0m[K     [1;37m[info] found 5 source files[0m
[K	[1;37m		[0m[K     [1;37m[info] found 11 executed functions[0m
[K	[1;34m	generating possible fix locations[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] JPEGSetupEncode,
                             /data/vulnloc/libtiff/CVE-2017-7595/src/libtiff/tif_jpeg.c:1685:26[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] JPEGSetupEncode,
                             /data/vulnloc/libtiff/CVE-2017-7595/src/libtiff/tif_jpeg.c:1685:44[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] JPEGSetupEncode,
                             /data/vulnloc/libtiff/CVE-2017-7595/src/libtiff/tif_jpeg.c:1685:29[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] JPEGSetupEncode,
                             /data/vulnloc/libtiff/CVE-2017-7595/src/libtiff/tif_jpeg.c:1685:33[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] JPEGSetupEncode,
                             /data/vulnloc/libtiff/CVE-2017-7595/src/libtiff/tif_jpeg.c:1685:12[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] JPEGSetupEncode,
                             /data/vulnloc/libtiff/CVE-2017-7595/src/libtiff/tif_jpeg.c:1685:8[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] JPEGSetupEncode,
                             /data/vulnloc/libtiff/CVE-2017-7595/src/libtiff/tif_jpeg.c:1684:37[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] JPEGSetupEncode,
                             /data/vulnloc/libtiff/CVE-2017-7595/src/libtiff/tif_jpeg.c:1684:25[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] JPEGSetupEncode,
                             /data/vulnloc/libtiff/CVE-2017-7595/src/libtiff/tif_jpeg.c:1684:15[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] JPEGSetupEncode,
                             /data/vulnloc/libtiff/CVE-2017-7595/src/libtiff/tif_jpeg.c:1684:9[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] JPEGSetupEncode,
                             /data/vulnloc/libtiff/CVE-2017-7595/src/libtiff/tif_jpeg.c:1680:29[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] JPEGSetupEncode,
                             /data/vulnloc/libtiff/CVE-2017-7595/src/libtiff/tif_jpeg.c:1680:14[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] JPEGSetupEncode,
                             /data/vulnloc/libtiff/CVE-2017-7595/src/libtiff/tif_jpeg.c:1680:12[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] JPEGSetupEncode,
                             /data/vulnloc/libtiff/CVE-2017-7595/src/libtiff/tif_jpeg.c:1680:6[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] JPEGSetupEncode,
                             /data/vulnloc/libtiff/CVE-2017-7595/src/libtiff/tif_jpeg.c:1680:2[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] JPEGSetupEncode,
                             /data/vulnloc/libtiff/CVE-2017-7595/src/libtiff/tif_jpeg.c:1680:31[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] JPEGSetupEncode,
                             /data/vulnloc/libtiff/CVE-2017-7595/src/libtiff/tif_jpeg.c:1680:35[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] JPEGSetupEncode,
                             /data/vulnloc/libtiff/CVE-2017-7595/src/libtiff/tif_jpeg.c:1673:27[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] JPEGSetupEncode,
                             /data/vulnloc/libtiff/CVE-2017-7595/src/libtiff/tif_jpeg.c:1673:6[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] JPEGSetupEncode,
                             /data/vulnloc/libtiff/CVE-2017-7595/src/libtiff/tif_jpeg.c:1673:10[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] JPEGSetupEncode,
                             /data/vulnloc/libtiff/CVE-2017-7595/src/libtiff/tif_jpeg.c:1644:5[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] JPEGSetupEncode,
                             /data/vulnloc/libtiff/CVE-2017-7595/src/libtiff/tif_jpeg.c:1645:11[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] JPEGSetupEncode,
                             /data/vulnloc/libtiff/CVE-2017-7595/src/libtiff/tif_jpeg.c:1644:18[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] JPEGSetupEncode,
                             /data/vulnloc/libtiff/CVE-2017-7595/src/libtiff/tif_jpeg.c:1643:14[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] JPEGSetupEncode,
                             /data/vulnloc/libtiff/CVE-2017-7595/src/libtiff/tif_jpeg.c:1643:5[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] JPEGSetupEncode,
                             /data/vulnloc/libtiff/CVE-2017-7595/src/libtiff/tif_jpeg.c:1643:16[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] JPEGSetupEncode,
                             /data/vulnloc/libtiff/CVE-2017-7595/src/libtiff/tif_jpeg.c:1642:14[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] JPEGSetupEncode,
                             /data/vulnloc/libtiff/CVE-2017-7595/src/libtiff/tif_jpeg.c:1642:5[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] JPEGSetupEncode,
                             /data/vulnloc/libtiff/CVE-2017-7595/src/libtiff/tif_jpeg.c:1642:16[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] JPEGSetupEncode,
                             /data/vulnloc/libtiff/CVE-2017-7595/src/libtiff/tif_jpeg.c:1641:14[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] JPEGSetupEncode,
                             /data/vulnloc/libtiff/CVE-2017-7595/src/libtiff/tif_jpeg.c:1641:5[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] JPEGSetupEncode,
                             /data/vulnloc/libtiff/CVE-2017-7595/src/libtiff/tif_jpeg.c:1641:16[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] JPEGSetupEncode,
                             /data/vulnloc/libtiff/CVE-2017-7595/src/libtiff/tif_jpeg.c:1640:14[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] JPEGSetupEncode,
                             /data/vulnloc/libtiff/CVE-2017-7595/src/libtiff/tif_jpeg.c:1640:5[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] JPEGSetupEncode,
                             /data/vulnloc/libtiff/CVE-2017-7595/src/libtiff/tif_jpeg.c:1640:16[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] JPEGSetupEncode,
                             /data/vulnloc/libtiff/CVE-2017-7595/src/libtiff/tif_jpeg.c:1640:27[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] JPEGSetupEncode,
                             /data/vulnloc/libtiff/CVE-2017-7595/src/libtiff/tif_jpeg.c:1640:24[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] JPEGSetupEncode,
                             /data/vulnloc/libtiff/CVE-2017-7595/src/libtiff/tif_jpeg.c:1639:14[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] JPEGSetupEncode,
                             /data/vulnloc/libtiff/CVE-2017-7595/src/libtiff/tif_jpeg.c:1639:5[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] JPEGSetupEncode,
                             /data/vulnloc/libtiff/CVE-2017-7595/src/libtiff/tif_jpeg.c:1639:16[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] JPEGSetupEncode,
                             /data/vulnloc/libtiff/CVE-2017-7595/src/libtiff/tif_jpeg.c:1639:27[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] JPEGSetupEncode,
                             /data/vulnloc/libtiff/CVE-2017-7595/src/libtiff/tif_jpeg.c:1639:24[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] JPEGSetupEncode,
                             /data/vulnloc/libtiff/CVE-2017-7595/src/libtiff/tif_jpeg.c:1638:14[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] JPEGSetupEncode,
                             /data/vulnloc/libtiff/CVE-2017-7595/src/libtiff/tif_jpeg.c:1638:5[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] JPEGSetupEncode,
                             /data/vulnloc/libtiff/CVE-2017-7595/src/libtiff/tif_jpeg.c:1637:10[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] JPEGSetupEncode,
                             /data/vulnloc/libtiff/CVE-2017-7595/src/libtiff/tif_jpeg.c:1637:19[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] JPEGSetupEncode,
                             /data/vulnloc/libtiff/CVE-2017-7595/src/libtiff/tif_jpeg.c:1637:22[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] JPEGSetupEncode,
                             /data/vulnloc/libtiff/CVE-2017-7595/src/libtiff/tif_jpeg.c:1637:26[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] JPEGSetupEncode,
                             /data/vulnloc/libtiff/CVE-2017-7595/src/libtiff/tif_jpeg.c:1634:9[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] JPEGSetupEncode,
                             /data/vulnloc/libtiff/CVE-2017-7595/src/libtiff/tif_jpeg.c:1634:22[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] JPEGSetupEncode,
                             /data/vulnloc/libtiff/CVE-2017-7595/src/libtiff/tif_jpeg.c:1626:18[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] JPEGSetupEncode,
                             /data/vulnloc/libtiff/CVE-2017-7595/src/libtiff/tif_jpeg.c:1626:7[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] JPEGSetupEncode,
                             /data/vulnloc/libtiff/CVE-2017-7595/src/libtiff/tif_jpeg.c:1626:3[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] JPEGSetupEncode,
                             /data/vulnloc/libtiff/CVE-2017-7595/src/libtiff/tif_jpeg.c:1626:20[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] JPEGSetupEncode,
                             /data/vulnloc/libtiff/CVE-2017-7595/src/libtiff/tif_jpeg.c:1626:24[0m
[K[1;36m
	Localizing Constraints
	__________________________________________________________________________________________
[0m
[K[1;36m
		[fix-loc] /data/vulnloc/libtiff/CVE-2017-7595/src/libtiff/tif_jpeg.c:1626:3
		------------------------------------------------------------------------------------------
[0m
[K	[1;37m	[0m[K     [1;37m[constraint] ((@var(integer, sp->v_sampling) * 8) != 0)[0m
[K[1;36m
		[fix-loc] /data/vulnloc/libtiff/CVE-2017-7595/src/libtiff/tif_jpeg.c:1685:3
		------------------------------------------------------------------------------------------
[0m
[K	[1;37m	[0m[K     [1;37m[constraint] ((@var(integer, sp->v_sampling) * 8) != 0)[0m
[K[1;36m
		[fix-loc] /data/vulnloc/libtiff/CVE-2017-7595/src/libtiff/tif_jpeg.c:1685:44
		------------------------------------------------------------------------------------------
[0m
[K	[1;37m	[0m[K     [1;37m[constraint] ((@result(integer)) != 0)[0m
[K[1;36m
		[fix-loc] /data/vulnloc/libtiff/CVE-2017-7595/src/libtiff/tif_jpeg.c:1684:2
		------------------------------------------------------------------------------------------
[0m
[K	[1;37m	[0m[K     [1;37m[constraint] ((@var(integer, sp->v_sampling) * 8) != 0)[0m
[K[1;36m
		[fix-loc] /data/vulnloc/libtiff/CVE-2017-7595/src/libtiff/tif_jpeg.c:1680:2
		------------------------------------------------------------------------------------------
[0m
[K	[1;37m	[0m[K     [1;37m[constraint] ((@var(integer, sp->v_sampling) * 8) != 0)[0m
[K[1;36m
		[fix-loc] /data/vulnloc/libtiff/CVE-2017-7595/src/libtiff/tif_jpeg.c:1673:2
		------------------------------------------------------------------------------------------
[0m
[K	[1;37m	[0m[K     [1;37m[constraint] ((@var(integer, sp->v_sampling) * 8) != 0)[0m
[K[1;36m
		[fix-loc] /data/vulnloc/libtiff/CVE-2017-7595/src/libtiff/tif_jpeg.c:1644:5
		------------------------------------------------------------------------------------------
[0m
[K	[1;37m	[0m[K     [1;37m[constraint] ((@var(integer, sp->v_sampling) * 8) != 0)[0m
[K[1;36m
		[fix-loc] /data/vulnloc/libtiff/CVE-2017-7595/src/libtiff/tif_jpeg.c:1643:5
		------------------------------------------------------------------------------------------
[0m
[K	[1;37m	[0m[K     [1;37m[constraint] ((@var(integer, sp->v_sampling) * 8) != 0)[0m
[K[1;36m
		[fix-loc] /data/vulnloc/libtiff/CVE-2017-7595/src/libtiff/tif_jpeg.c:1642:5
		------------------------------------------------------------------------------------------
[0m
[K	[1;37m	[0m[K     [1;37m[constraint] ((@var(integer, sp->v_sampling) * 8) != 0)[0m
[K[1;36m
		[fix-loc] /data/vulnloc/libtiff/CVE-2017-7595/src/libtiff/tif_jpeg.c:1641:5
		------------------------------------------------------------------------------------------
[0m
[K	[1;37m	[0m[K     [1;37m[constraint] ((@var(integer, sp->v_sampling) * 8) != 0)[0m
[K[1;36m
		[fix-loc] /data/vulnloc/libtiff/CVE-2017-7595/src/libtiff/tif_jpeg.c:1640:5
		------------------------------------------------------------------------------------------
[0m
[K	[1;37m	[0m[K     [1;37m[constraint] ((@var(integer, sp->v_sampling) * 8) != 0)[0m
[K[1;36m
		[fix-loc] /data/vulnloc/libtiff/CVE-2017-7595/src/libtiff/tif_jpeg.c:1639:5
		------------------------------------------------------------------------------------------
[0m
[K	[1;37m	[0m[K     [1;37m[constraint] ((@var(integer, sp->v_sampling) * 8) != 0)[0m
[K[1;36m
		[fix-loc] /data/vulnloc/libtiff/CVE-2017-7595/src/libtiff/tif_jpeg.c:1638:5
		------------------------------------------------------------------------------------------
[0m
[K	[1;37m	[0m[K     [1;37m[constraint] ((@var(integer, sp->v_sampling) * 8) != 0)[0m
[K[1;36m
		[fix-loc] /data/vulnloc/libtiff/CVE-2017-7595/src/libtiff/tif_jpeg.c:1637:5
		------------------------------------------------------------------------------------------
[0m
[K	[1;37m	[0m[K     [1;37m[constraint] ((@var(integer, sp->v_sampling) * 8) != 0)[0m
[K[1;36m
		[fix-loc] /data/vulnloc/libtiff/CVE-2017-7595/src/libtiff/tif_jpeg.c:1634:9
		------------------------------------------------------------------------------------------
[0m
[K	[1;37m	[0m[K     [1;37m[constraint] ((@var(integer, sp->v_sampling) * 8) != 0)[0m
[K[1;32m
	localization information saved at /CrashRepair/output/libtiff_CVE-2017-7595/localization.json[0m
[K[1;32m
	state values saved at /CrashRepair/output/libtiff_CVE-2017-7595/values/[0m
[K	[1;37m
Run time statistics:
-----------------------
[0m
[K	[1;37mStartup: 0.000 minutes[0m
[K	[1;37mBuild: 0 minutes[0m
[K	[1;37mConcrete Analysis: 0.702 minutes[0m
[K	[1;37mConcolic Analysis: 0.733 minutes[0m
[K	[1;37mTotal Analysis: 1.441 minutes[0m
[K	[1;37mLocalization: 0.473 minutes[0m
[K[1;32m
CRepair finished successfully after 1.970 minutes 
[0m
2025-02-03 13:32:08.787 | WARNING  | analyzer:run:143 - analysis output directory does not exist [/data/vulnloc/libtiff/CVE-2017-7595/analysis]: creating...
2025-02-03 13:32:08.949 | INFO     | scenario:generate:454 - generating candidate repairs in implicated files: {'/data/vulnloc/libtiff/CVE-2017-7595/src/libtiff/tif_jpeg.c'}
total_candidates:[{'diff': '@@ -1571,6 +1571,7 @@\n \treturn (1);\n }\n \n+\n static int\n JPEGSetupEncode(TIFF* tif)\n {\n@@ -1590,11 +1591,6 @@\n \n \tsp->photometric = td->td_photometric;\n \n-\t/*\n-\t * Initialize all JPEG parameters to default values.\n-\t * Note that jpeg_set_defaults needs legal values for\n-\t * in_color_space and input_components.\n-\t */\n \tif (td->td_planarconfig == PLANARCONFIG_CONTIG) {\n \t\tsp->cinfo.c.input_components = td->td_samplesperpixel;\n \t\tif (sp->photometric == PHOTOMETRIC_YCBCR) {\n@@ -1619,16 +1615,15 @@\n \t}\n \tif (!TIFFjpeg_set_defaults(sp))\n \t\treturn (0);\n-\t/* Set per-file parameters */\n+\n \tswitch (sp->photometric) {\n \tcase PHOTOMETRIC_YCBCR:\n \t\tsp->h_sampling = td->td_ycbcrsubsampling[0];\n+                if (td->td_ycbcrsubsampling[1] <= 0) { // Check for invalid vertical sampling\n+                    TIFFErrorExt(tif->tif_clientdata, module, "Invalid vertical sampling value.");\n+                    return (0);\n+                }\n \t\tsp->v_sampling = td->td_ycbcrsubsampling[1];\n-\t\t/*\n-\t\t * A ReferenceBlackWhite field *must* be present since the\n-\t\t * default value is inappropriate for YCbCr.  Fill in the\n-\t\t * proper value if application didn\'t set it.\n-\t\t */\n \t\t{\n \t\t\tfloat *ref;\n \t\t\tif (!TIFFGetField(tif, TIFFTAG_REFERENCEBLACKWHITE,\n@@ -1646,28 +1641,19 @@\n \t\t\t}\n \t\t}\n \t\tbreak;\n-\tcase PHOTOMETRIC_PALETTE:\t\t/* disallowed by Tech Note */\n+\tcase PHOTOMETRIC_PALETTE:\n \tcase PHOTOMETRIC_MASK:\n \t\tTIFFErrorExt(tif->tif_clientdata, module,\n \t\t\t  "PhotometricInterpretation %d not allowed for JPEG",\n \t\t\t  (int) sp->photometric);\n \t\treturn (0);\n \tdefault:\n-\t\t/* TIFF 6.0 forbids subsampling of all other color spaces */\n \t\tsp->h_sampling = 1;\n \t\tsp->v_sampling = 1;\n \t\tbreak;\n \t}\n \n-\t/* Verify miscellaneous parameters */\n-\n-\t/*\n-\t * This would need work if libtiff ever supports different\n-\t * depths for different components, or if libjpeg ever supports\n-\t * run-time selection of depth.  Neither is imminent.\n-\t */\n #ifdef JPEG_LIB_MK1\n-        /* BITS_IN_JSAMPLE now permits 8 and 12 --- dgilbert */\n \tif (td->td_bitspersample != 8 && td->td_bitspersample != 12) \n #else\n \tif (td->td_bitspersample != BITS_IN_JSAMPLE )\n@@ -1679,7 +1665,7 @@\n \t}\n \tsp->cinfo.c.data_precision = td->td_bitspersample;\n #ifdef JPEG_LIB_MK1\n-        sp->cinfo.c.bits_in_jsample = td->td_bitspersample;\n+\tsp->cinfo.c.bits_in_jsample = td->td_bitspersample;\n #endif\n \tif ((((tif)->tif_flags & 0x00400U) != 0)) {\n \t\tif ((td->td_tilelength % (sp->v_sampling * DCTSIZE)) != 0) {\n@@ -1704,30 +1690,25 @@\n \t\t}\n \t}\n \n-\t/* Create a JPEGTables field if appropriate */\n \tif (sp->jpegtablesmode & (JPEGTABLESMODE_QUANT|JPEGTABLESMODE_HUFF)) {\n                 if( sp->jpegtables == NULL\n                     || memcmp(sp->jpegtables,"\\0\\0\\0\\0\\0\\0\\0\\0\\0",8) == 0 )\n                 {\n                         if (!prepare_JPEGTables(tif))\n                                 return (0);\n-                        /* Mark the field present */\n-                        /* Can\'t use TIFFSetField since BEENWRITING is already set! */\n                         tif->tif_flags |= TIFF_DIRTYDIRECT;\n                         TIFFSetFieldBit(tif, FIELD_JPEGTABLES);\n                 }\n \t} else {\n-\t\t/* We do not support application-supplied JPEGTables, */\n-\t\t/* so mark the field not present */\n \t\tTIFFClrFieldBit(tif, FIELD_JPEGTABLES);\n \t}\n \n-\t/* Direct libjpeg output to libtiff\'s output buffer */\n \tTIFFjpeg_data_dest(sp, tif);\n \n \treturn (1);\n }\n \n+\n /*\n  * Set encoding state at the start of a strip or tile.\n  */\n', 'id': 0, 'location': '/data/vulnloc/libtiff/CVE-2017-7595/src/libtiff/tif_jpeg.c:1626:3'}, {'diff': '@@ -1571,6 +1571,7 @@\n \treturn (1);\n }\n \n+\n static int\n JPEGSetupEncode(TIFF* tif)\n {\n@@ -1623,7 +1624,14 @@\n \tswitch (sp->photometric) {\n \tcase PHOTOMETRIC_YCBCR:\n \t\tsp->h_sampling = td->td_ycbcrsubsampling[0];\n-\t\tsp->v_sampling = td->td_ycbcrsubsampling[1];\n+\t\tif (td->td_ycbcrsubsampling[1] > 0) { // Added check to prevent division by zero\n+\t\t\tsp->v_sampling = td->td_ycbcrsubsampling[1];\n+\t\t} else {\n+\t\t\tTIFFErrorExt(tif->tif_clientdata, module,\n+\t\t\t\t  "Invalid vertical subsampling value: %d",\n+\t\t\t\t  (int) td->td_ycbcrsubsampling[1]);\n+\t\t\treturn (0);\n+\t\t}\n \t\t/*\n \t\t * A ReferenceBlackWhite field *must* be present since the\n \t\t * default value is inappropriate for YCbCr.  Fill in the\n@@ -1728,6 +1736,7 @@\n \treturn (1);\n }\n \n+\n /*\n  * Set encoding state at the start of a strip or tile.\n  */\n', 'id': 1, 'location': '/data/vulnloc/libtiff/CVE-2017-7595/src/libtiff/tif_jpeg.c:1626:3'}, {'diff': '@@ -1571,6 +1571,7 @@\n \treturn (1);\n }\n \n+\n static int\n JPEGSetupEncode(TIFF* tif)\n {\n@@ -1622,6 +1623,10 @@\n \t/* Set per-file parameters */\n \tswitch (sp->photometric) {\n \tcase PHOTOMETRIC_YCBCR:\n+\t\tif (td->td_ycbcrsubsampling[1] == 0) {\n+\t\t\tTIFFErrorExt(tif->tif_clientdata, module, "YCBCR vertical subsampling cannot be zero");\n+\t\t\treturn (0);\n+\t\t}\n \t\tsp->h_sampling = td->td_ycbcrsubsampling[0];\n \t\tsp->v_sampling = td->td_ycbcrsubsampling[1];\n \t\t/*\n@@ -1728,6 +1733,7 @@\n \treturn (1);\n }\n \n+\n /*\n  * Set encoding state at the start of a strip or tile.\n  */\n', 'id': 2, 'location': '/data/vulnloc/libtiff/CVE-2017-7595/src/libtiff/tif_jpeg.c:1626:3'}, {'diff': '@@ -1571,163 +1571,169 @@\n \treturn (1);\n }\n \n+\n static int\n JPEGSetupEncode(TIFF* tif)\n {\n-\tJPEGState* sp = JState(tif);\n-\tTIFFDirectory *td = &tif->tif_dir;\n-\tstatic const char module[] = "JPEGSetupEncode";\n+    JPEGState* sp = JState(tif);\n+    TIFFDirectory *td = &tif->tif_dir;\n+    static const char module[] = "JPEGSetupEncode";\n \n #if defined(JPEG_DUAL_MODE_8_12) && !defined(TIFFInitJPEG)\n-        if( tif->tif_dir.td_bitspersample == 12 )\n-            return TIFFReInitJPEG_12( tif, COMPRESSION_JPEG, 1 );\n+    if( tif->tif_dir.td_bitspersample == 12 )\n+        return TIFFReInitJPEG_12( tif, COMPRESSION_JPEG, 1 );\n #endif\n \n-        JPEGInitializeLibJPEG( tif, FALSE );\n+    JPEGInitializeLibJPEG( tif, FALSE );\n \n-\tassert(sp != NULL);\n-\tassert(!sp->cinfo.comm.is_decompressor);\n+    assert(sp != NULL);\n+    assert(!sp->cinfo.comm.is_decompressor);\n \n-\tsp->photometric = td->td_photometric;\n+    sp->photometric = td->td_photometric;\n \n-\t/*\n-\t * Initialize all JPEG parameters to default values.\n-\t * Note that jpeg_set_defaults needs legal values for\n-\t * in_color_space and input_components.\n-\t */\n-\tif (td->td_planarconfig == PLANARCONFIG_CONTIG) {\n-\t\tsp->cinfo.c.input_components = td->td_samplesperpixel;\n-\t\tif (sp->photometric == PHOTOMETRIC_YCBCR) {\n-\t\t\tif (sp->jpegcolormode == JPEGCOLORMODE_RGB) {\n-\t\t\t\tsp->cinfo.c.in_color_space = JCS_RGB;\n-\t\t\t} else {\n-\t\t\t\tsp->cinfo.c.in_color_space = JCS_YCbCr;\n-\t\t\t}\n-\t\t} else {\n-\t\t\tif ((td->td_photometric == PHOTOMETRIC_MINISWHITE || td->td_photometric == PHOTOMETRIC_MINISBLACK) && td->td_samplesperpixel == 1)\n-\t\t\t\tsp->cinfo.c.in_color_space = JCS_GRAYSCALE;\n-\t\t\telse if (td->td_photometric == PHOTOMETRIC_RGB && td->td_samplesperpixel == 3)\n-\t\t\t\tsp->cinfo.c.in_color_space = JCS_RGB;\n-\t\t\telse if (td->td_photometric == PHOTOMETRIC_SEPARATED && td->td_samplesperpixel == 4)\n-\t\t\t\tsp->cinfo.c.in_color_space = JCS_CMYK;\n-\t\t\telse\n-\t\t\t\tsp->cinfo.c.in_color_space = JCS_UNKNOWN;\n-\t\t}\n-\t} else {\n-\t\tsp->cinfo.c.input_components = 1;\n-\t\tsp->cinfo.c.in_color_space = JCS_UNKNOWN;\n-\t}\n-\tif (!TIFFjpeg_set_defaults(sp))\n-\t\treturn (0);\n-\t/* Set per-file parameters */\n-\tswitch (sp->photometric) {\n-\tcase PHOTOMETRIC_YCBCR:\n-\t\tsp->h_sampling = td->td_ycbcrsubsampling[0];\n-\t\tsp->v_sampling = td->td_ycbcrsubsampling[1];\n-\t\t/*\n-\t\t * A ReferenceBlackWhite field *must* be present since the\n-\t\t * default value is inappropriate for YCbCr.  Fill in the\n-\t\t * proper value if application didn\'t set it.\n-\t\t */\n-\t\t{\n-\t\t\tfloat *ref;\n-\t\t\tif (!TIFFGetField(tif, TIFFTAG_REFERENCEBLACKWHITE,\n-\t\t\t\t\t  &ref)) {\n-\t\t\t\tfloat refbw[6];\n-\t\t\t\tlong top = 1L << td->td_bitspersample;\n-\t\t\t\trefbw[0] = 0;\n-\t\t\t\trefbw[1] = (float)(top-1L);\n-\t\t\t\trefbw[2] = (float)(top>>1);\n-\t\t\t\trefbw[3] = refbw[1];\n-\t\t\t\trefbw[4] = refbw[2];\n-\t\t\t\trefbw[5] = refbw[1];\n-\t\t\t\tTIFFSetField(tif, TIFFTAG_REFERENCEBLACKWHITE,\n-\t\t\t\t\t     refbw);\n-\t\t\t}\n-\t\t}\n-\t\tbreak;\n-\tcase PHOTOMETRIC_PALETTE:\t\t/* disallowed by Tech Note */\n-\tcase PHOTOMETRIC_MASK:\n-\t\tTIFFErrorExt(tif->tif_clientdata, module,\n-\t\t\t  "PhotometricInterpretation %d not allowed for JPEG",\n-\t\t\t  (int) sp->photometric);\n-\t\treturn (0);\n-\tdefault:\n-\t\t/* TIFF 6.0 forbids subsampling of all other color spaces */\n-\t\tsp->h_sampling = 1;\n-\t\tsp->v_sampling = 1;\n-\t\tbreak;\n-\t}\n-\n-\t/* Verify miscellaneous parameters */\n-\n-\t/*\n-\t * This would need work if libtiff ever supports different\n-\t * depths for different components, or if libjpeg ever supports\n-\t * run-time selection of depth.  Neither is imminent.\n-\t */\n+    /*\n+     * Initialize all JPEG parameters to default values.\n+     * Note that jpeg_set_defaults needs legal values for\n+     * in_color_space and input_components.\n+     */\n+    if (td->td_planarconfig == PLANARCONFIG_CONTIG) {\n+        sp->cinfo.c.input_components = td->td_samplesperpixel;\n+        if (sp->photometric == PHOTOMETRIC_YCBCR) {\n+            if (sp->jpegcolormode == JPEGCOLORMODE_RGB) {\n+                sp->cinfo.c.in_color_space = JCS_RGB;\n+            } else {\n+                sp->cinfo.c.in_color_space = JCS_YCbCr;\n+            }\n+        } else {\n+            if ((td->td_photometric == PHOTOMETRIC_MINISWHITE || td->td_photometric == PHOTOMETRIC_MINISBLACK) && td->td_samplesperpixel == 1)\n+                sp->cinfo.c.in_color_space = JCS_GRAYSCALE;\n+            else if (td->td_photometric == PHOTOMETRIC_RGB && td->td_samplesperpixel == 3)\n+                sp->cinfo.c.in_color_space = JCS_RGB;\n+            else if (td->td_photometric == PHOTOMETRIC_SEPARATED && td->td_samplesperpixel == 4)\n+                sp->cinfo.c.in_color_space = JCS_CMYK;\n+            else\n+                sp->cinfo.c.in_color_space = JCS_UNKNOWN;\n+        }\n+    } else {\n+        sp->cinfo.c.input_components = 1;\n+        sp->cinfo.c.in_color_space = JCS_UNKNOWN;\n+    }\n+    if (!TIFFjpeg_set_defaults(sp))\n+        return (0);\n+    /* Set per-file parameters */\n+    switch (sp->photometric) {\n+    case PHOTOMETRIC_YCBCR:\n+        sp->h_sampling = td->td_ycbcrsubsampling[0];\n+        if (td->td_ycbcrsubsampling[1] < 1) {\n+            TIFFErrorExt(tif->tif_clientdata, module, "Invalid vertical subsampling value: %d", td->td_ycbcrsubsampling[1]);\n+            return (0);\n+        }\n+        sp->v_sampling = td->td_ycbcrsubsampling[1];\n+        /*\n+         * A ReferenceBlackWhite field *must* be present since the\n+         * default value is inappropriate for YCbCr.  Fill in the\n+         * proper value if application didn\'t set it.\n+         */\n+        {\n+            float *ref;\n+            if (!TIFFGetField(tif, TIFFTAG_REFERENCEBLACKWHITE,\n+                      &ref)) {\n+                float refbw[6];\n+                long top = 1L << td->td_bitspersample;\n+                refbw[0] = 0;\n+                refbw[1] = (float)(top-1L);\n+                refbw[2] = (float)(top>>1);\n+                refbw[3] = refbw[1];\n+                refbw[4] = refbw[2];\n+                refbw[5] = refbw[1];\n+                TIFFSetField(tif, TIFFTAG_REFERENCEBLACKWHITE,\n+                         refbw);\n+            }\n+        }\n+        break;\n+    case PHOTOMETRIC_PALETTE:        /* disallowed by Tech Note */\n+    case PHOTOMETRIC_MASK:\n+        TIFFErrorExt(tif->tif_clientdata, module,\n+              "PhotometricInterpretation %d not allowed for JPEG",\n+              (int) sp->photometric);\n+        return (0);\n+    default:\n+        /* TIFF 6.0 forbids subsampling of all other color spaces */\n+        sp->h_sampling = 1;\n+        sp->v_sampling = 1;\n+        break;\n+    }\n+\n+    /* Verify miscellaneous parameters */\n+\n+    /*\n+     * This would need work if libtiff ever supports different\n+     * depths for different components, or if libjpeg ever supports\n+     * run-time selection of depth.  Neither is imminent.\n+     */\n #ifdef JPEG_LIB_MK1\n-        /* BITS_IN_JSAMPLE now permits 8 and 12 --- dgilbert */\n-\tif (td->td_bitspersample != 8 && td->td_bitspersample != 12) \n+    /* BITS_IN_JSAMPLE now permits 8 and 12 --- dgilbert */\n+    if (td->td_bitspersample != 8 && td->td_bitspersample != 12) \n #else\n-\tif (td->td_bitspersample != BITS_IN_JSAMPLE )\n+    if (td->td_bitspersample != BITS_IN_JSAMPLE )\n #endif\n-\t{\n-\t\tTIFFErrorExt(tif->tif_clientdata, module, "BitsPerSample %d not allowed for JPEG",\n-\t\t\t  (int) td->td_bitspersample);\n-\t\treturn (0);\n-\t}\n-\tsp->cinfo.c.data_precision = td->td_bitspersample;\n+    {\n+        TIFFErrorExt(tif->tif_clientdata, module, "BitsPerSample %d not allowed for JPEG",\n+              (int) td->td_bitspersample);\n+        return (0);\n+    }\n+    sp->cinfo.c.data_precision = td->td_bitspersample;\n #ifdef JPEG_LIB_MK1\n-        sp->cinfo.c.bits_in_jsample = td->td_bitspersample;\n+    sp->cinfo.c.bits_in_jsample = td->td_bitspersample;\n #endif\n-\tif ((((tif)->tif_flags & 0x00400U) != 0)) {\n-\t\tif ((td->td_tilelength % (sp->v_sampling * DCTSIZE)) != 0) {\n-\t\t\tTIFFErrorExt(tif->tif_clientdata, module,\n-\t\t\t\t  "JPEG tile height must be multiple of %d",\n-\t\t\t\t  sp->v_sampling * DCTSIZE);\n-\t\t\treturn (0);\n-\t\t}\n-\t\tif ((td->td_tilewidth % (sp->h_sampling * DCTSIZE)) != 0) {\n-\t\t\tTIFFErrorExt(tif->tif_clientdata, module,\n-\t\t\t\t  "JPEG tile width must be multiple of %d",\n-\t\t\t\t  sp->h_sampling * DCTSIZE);\n-\t\t\treturn (0);\n-\t\t}\n-\t} else {\n-\t\tif (td->td_rowsperstrip < td->td_imagelength &&\n-\t\t    (td->td_rowsperstrip % (sp->v_sampling * DCTSIZE)) != 0) {\n-\t\t\tTIFFErrorExt(tif->tif_clientdata, module,\n-\t\t\t\t  "RowsPerStrip must be multiple of %d for JPEG",\n-\t\t\t\t  sp->v_sampling * DCTSIZE);\n-\t\t\treturn (0);\n-\t\t}\n-\t}\n-\n-\t/* Create a JPEGTables field if appropriate */\n-\tif (sp->jpegtablesmode & (JPEGTABLESMODE_QUANT|JPEGTABLESMODE_HUFF)) {\n-                if( sp->jpegtables == NULL\n-                    || memcmp(sp->jpegtables,"\\0\\0\\0\\0\\0\\0\\0\\0\\0",8) == 0 )\n-                {\n-                        if (!prepare_JPEGTables(tif))\n-                                return (0);\n-                        /* Mark the field present */\n-                        /* Can\'t use TIFFSetField since BEENWRITING is already set! */\n-                        tif->tif_flags |= TIFF_DIRTYDIRECT;\n-                        TIFFSetFieldBit(tif, FIELD_JPEGTABLES);\n-                }\n-\t} else {\n-\t\t/* We do not support application-supplied JPEGTables, */\n-\t\t/* so mark the field not present */\n-\t\tTIFFClrFieldBit(tif, FIELD_JPEGTABLES);\n-\t}\n+    if ((((tif)->tif_flags & 0x00400U) != 0)) {\n+        if ((td->td_tilelength % (sp->v_sampling * DCTSIZE)) != 0) {\n+            TIFFErrorExt(tif->tif_clientdata, module,\n+                  "JPEG tile height must be multiple of %d",\n+                  sp->v_sampling * DCTSIZE);\n+            return (0);\n+        }\n+        if ((td->td_tilewidth % (sp->h_sampling * DCTSIZE)) != 0) {\n+            TIFFErrorExt(tif->tif_clientdata, module,\n+                  "JPEG tile width must be multiple of %d",\n+                  sp->h_sampling * DCTSIZE);\n+            return (0);\n+        }\n+    } else {\n+        if (td->td_rowsperstrip < td->td_imagelength &&\n+            (td->td_rowsperstrip % (sp->v_sampling * DCTSIZE)) != 0) {\n+            TIFFErrorExt(tif->tif_clientdata, module,\n+                  "RowsPerStrip must be multiple of %d for JPEG",\n+                  sp->v_sampling * DCTSIZE);\n+            return (0);\n+        }\n+    }\n+\n+    /* Create a JPEGTables field if appropriate */\n+    if (sp->jpegtablesmode & (JPEGTABLESMODE_QUANT|JPEGTABLESMODE_HUFF)) {\n+            if( sp->jpegtables == NULL\n+                || memcmp(sp->jpegtables,"\\0\\0\\0\\0\\0\\0\\0\\0\\0",8) == 0 )\n+            {\n+                    if (!prepare_JPEGTables(tif))\n+                        return (0);\n+                    /* Mark the field present */\n+                    /* Can\'t use TIFFSetField since BEENWRITING is already set! */\n+                    tif->tif_flags |= TIFF_DIRTYDIRECT;\n+                    TIFFSetFieldBit(tif, FIELD_JPEGTABLES);\n+            }\n+    } else {\n+        /* We do not support application-supplied JPEGTables, */\n+        /* so mark the field not present */\n+        TIFFClrFieldBit(tif, FIELD_JPEGTABLES);\n+    }\n \n-\t/* Direct libjpeg output to libtiff\'s output buffer */\n-\tTIFFjpeg_data_dest(sp, tif);\n+    /* Direct libjpeg output to libtiff\'s output buffer */\n+    TIFFjpeg_data_dest(sp, tif);\n \n-\treturn (1);\n+    return (1);\n }\n \n+\n /*\n  * Set encoding state at the start of a strip or tile.\n  */\n', 'id': 3, 'location': '/data/vulnloc/libtiff/CVE-2017-7595/src/libtiff/tif_jpeg.c:1626:3'}, {'diff': '@@ -1571,6 +1571,7 @@\n \treturn (1);\n }\n \n+\n static int\n JPEGSetupEncode(TIFF* tif)\n {\n@@ -1623,6 +1624,11 @@\n \tswitch (sp->photometric) {\n \tcase PHOTOMETRIC_YCBCR:\n \t\tsp->h_sampling = td->td_ycbcrsubsampling[0];\n+\t\tif (td->td_ycbcrsubsampling[1] <= 0) {\n+\t\t\tTIFFErrorExt(tif->tif_clientdata, module, "Invalid vertical subsampling value: %d",\n+\t\t\t\t\t(int) td->td_ycbcrsubsampling[1]);\n+\t\t\treturn (0);\n+\t\t}\n \t\tsp->v_sampling = td->td_ycbcrsubsampling[1];\n \t\t/*\n \t\t * A ReferenceBlackWhite field *must* be present since the\n@@ -1728,6 +1734,7 @@\n \treturn (1);\n }\n \n+\n /*\n  * Set encoding state at the start of a strip or tile.\n  */\n', 'id': 4, 'location': '/data/vulnloc/libtiff/CVE-2017-7595/src/libtiff/tif_jpeg.c:1626:3'}, {'diff': '@@ -1571,163 +1571,165 @@\n \treturn (1);\n }\n \n+\n static int\n JPEGSetupEncode(TIFF* tif)\n {\n-\tJPEGState* sp = JState(tif);\n-\tTIFFDirectory *td = &tif->tif_dir;\n-\tstatic const char module[] = "JPEGSetupEncode";\n+    JPEGState* sp = JState(tif);\n+    TIFFDirectory *td = &tif->tif_dir;\n+    static const char module[] = "JPEGSetupEncode";\n \n #if defined(JPEG_DUAL_MODE_8_12) && !defined(TIFFInitJPEG)\n         if( tif->tif_dir.td_bitspersample == 12 )\n             return TIFFReInitJPEG_12( tif, COMPRESSION_JPEG, 1 );\n #endif\n \n-        JPEGInitializeLibJPEG( tif, FALSE );\n+    JPEGInitializeLibJPEG( tif, FALSE );\n \n-\tassert(sp != NULL);\n-\tassert(!sp->cinfo.comm.is_decompressor);\n+    assert(sp != NULL);\n+    assert(!sp->cinfo.comm.is_decompressor);\n \n-\tsp->photometric = td->td_photometric;\n+    sp->photometric = td->td_photometric;\n \n-\t/*\n-\t * Initialize all JPEG parameters to default values.\n-\t * Note that jpeg_set_defaults needs legal values for\n-\t * in_color_space and input_components.\n-\t */\n-\tif (td->td_planarconfig == PLANARCONFIG_CONTIG) {\n-\t\tsp->cinfo.c.input_components = td->td_samplesperpixel;\n-\t\tif (sp->photometric == PHOTOMETRIC_YCBCR) {\n-\t\t\tif (sp->jpegcolormode == JPEGCOLORMODE_RGB) {\n-\t\t\t\tsp->cinfo.c.in_color_space = JCS_RGB;\n-\t\t\t} else {\n-\t\t\t\tsp->cinfo.c.in_color_space = JCS_YCbCr;\n-\t\t\t}\n-\t\t} else {\n-\t\t\tif ((td->td_photometric == PHOTOMETRIC_MINISWHITE || td->td_photometric == PHOTOMETRIC_MINISBLACK) && td->td_samplesperpixel == 1)\n-\t\t\t\tsp->cinfo.c.in_color_space = JCS_GRAYSCALE;\n-\t\t\telse if (td->td_photometric == PHOTOMETRIC_RGB && td->td_samplesperpixel == 3)\n-\t\t\t\tsp->cinfo.c.in_color_space = JCS_RGB;\n-\t\t\telse if (td->td_photometric == PHOTOMETRIC_SEPARATED && td->td_samplesperpixel == 4)\n-\t\t\t\tsp->cinfo.c.in_color_space = JCS_CMYK;\n-\t\t\telse\n-\t\t\t\tsp->cinfo.c.in_color_space = JCS_UNKNOWN;\n-\t\t}\n-\t} else {\n-\t\tsp->cinfo.c.input_components = 1;\n-\t\tsp->cinfo.c.in_color_space = JCS_UNKNOWN;\n-\t}\n-\tif (!TIFFjpeg_set_defaults(sp))\n-\t\treturn (0);\n-\t/* Set per-file parameters */\n-\tswitch (sp->photometric) {\n-\tcase PHOTOMETRIC_YCBCR:\n-\t\tsp->h_sampling = td->td_ycbcrsubsampling[0];\n-\t\tsp->v_sampling = td->td_ycbcrsubsampling[1];\n-\t\t/*\n-\t\t * A ReferenceBlackWhite field *must* be present since the\n-\t\t * default value is inappropriate for YCbCr.  Fill in the\n-\t\t * proper value if application didn\'t set it.\n-\t\t */\n-\t\t{\n-\t\t\tfloat *ref;\n-\t\t\tif (!TIFFGetField(tif, TIFFTAG_REFERENCEBLACKWHITE,\n-\t\t\t\t\t  &ref)) {\n-\t\t\t\tfloat refbw[6];\n-\t\t\t\tlong top = 1L << td->td_bitspersample;\n-\t\t\t\trefbw[0] = 0;\n-\t\t\t\trefbw[1] = (float)(top-1L);\n-\t\t\t\trefbw[2] = (float)(top>>1);\n-\t\t\t\trefbw[3] = refbw[1];\n-\t\t\t\trefbw[4] = refbw[2];\n-\t\t\t\trefbw[5] = refbw[1];\n-\t\t\t\tTIFFSetField(tif, TIFFTAG_REFERENCEBLACKWHITE,\n-\t\t\t\t\t     refbw);\n-\t\t\t}\n-\t\t}\n-\t\tbreak;\n-\tcase PHOTOMETRIC_PALETTE:\t\t/* disallowed by Tech Note */\n-\tcase PHOTOMETRIC_MASK:\n-\t\tTIFFErrorExt(tif->tif_clientdata, module,\n-\t\t\t  "PhotometricInterpretation %d not allowed for JPEG",\n-\t\t\t  (int) sp->photometric);\n-\t\treturn (0);\n-\tdefault:\n-\t\t/* TIFF 6.0 forbids subsampling of all other color spaces */\n-\t\tsp->h_sampling = 1;\n-\t\tsp->v_sampling = 1;\n-\t\tbreak;\n-\t}\n-\n-\t/* Verify miscellaneous parameters */\n-\n-\t/*\n-\t * This would need work if libtiff ever supports different\n-\t * depths for different components, or if libjpeg ever supports\n-\t * run-time selection of depth.  Neither is imminent.\n-\t */\n+    /*\n+     * Initialize all JPEG parameters to default values.\n+     * Note that jpeg_set_defaults needs legal values for\n+     * in_color_space and input_components.\n+     */\n+    if (td->td_planarconfig == PLANARCONFIG_CONTIG) {\n+        sp->cinfo.c.input_components = td->td_samplesperpixel;\n+        if (sp->photometric == PHOTOMETRIC_YCBCR) {\n+            if (sp->jpegcolormode == JPEGCOLORMODE_RGB) {\n+                sp->cinfo.c.in_color_space = JCS_RGB;\n+            } else {\n+                sp->cinfo.c.in_color_space = JCS_YCbCr;\n+            }\n+        } else {\n+            if ((td->td_photometric == PHOTOMETRIC_MINISWHITE || td->td_photometric == PHOTOMETRIC_MINISBLACK) && td->td_samplesperpixel == 1)\n+                sp->cinfo.c.in_color_space = JCS_GRAYSCALE;\n+            else if (td->td_photometric == PHOTOMETRIC_RGB && td->td_samplesperpixel == 3)\n+                sp->cinfo.c.in_color_space = JCS_RGB;\n+            else if (td->td_photometric == PHOTOMETRIC_SEPARATED && td->td_samplesperpixel == 4)\n+                sp->cinfo.c.in_color_space = JCS_CMYK;\n+            else\n+                sp->cinfo.c.in_color_space = JCS_UNKNOWN;\n+        }\n+    } else {\n+        sp->cinfo.c.input_components = 1;\n+        sp->cinfo.c.in_color_space = JCS_UNKNOWN;\n+    }\n+    if (!TIFFjpeg_set_defaults(sp))\n+        return (0);\n+    /* Set per-file parameters */\n+    switch (sp->photometric) {\n+    case PHOTOMETRIC_YCBCR:\n+        sp->h_sampling = td->td_ycbcrsubsampling[0];\n+        sp->v_sampling = td->td_ycbcrsubsampling[1];\n+        /*\n+         * A ReferenceBlackWhite field *must* be present since the\n+         * default value is inappropriate for YCbCr.  Fill in the\n+         * proper value if application didn\'t set it.\n+         */\n+        {\n+            float *ref;\n+            if (!TIFFGetField(tif, TIFFTAG_REFERENCEBLACKWHITE,\n+                      &ref)) {\n+                float refbw[6];\n+                long top = 1L << td->td_bitspersample;\n+                refbw[0] = 0;\n+                refbw[1] = (float)(top-1L);\n+                refbw[2] = (float)(top>>1);\n+                refbw[3] = refbw[1];\n+                refbw[4] = refbw[2];\n+                refbw[5] = refbw[1];\n+                TIFFSetField(tif, TIFFTAG_REFERENCEBLACKWHITE,\n+                         refbw);\n+            }\n+        }\n+        break;\n+    case PHOTOMETRIC_PALETTE:\t\t/* disallowed by Tech Note */\n+    case PHOTOMETRIC_MASK:\n+        TIFFErrorExt(tif->tif_clientdata, module,\n+              "PhotometricInterpretation %d not allowed for JPEG",\n+              (int) sp->photometric);\n+        return (0);\n+    default:\n+        /* TIFF 6.0 forbids subsampling of all other color spaces */\n+        sp->h_sampling = 1;\n+        sp->v_sampling = 1;\n+        break;\n+    }\n+\n+    /* Verify miscellaneous parameters */\n+\n+    /*\n+     * This would need work if libtiff ever supports different\n+     * depths for different components, or if libjpeg ever supports\n+     * run-time selection of depth.  Neither is imminent.\n+     */\n #ifdef JPEG_LIB_MK1\n         /* BITS_IN_JSAMPLE now permits 8 and 12 --- dgilbert */\n-\tif (td->td_bitspersample != 8 && td->td_bitspersample != 12) \n+    if (td->td_bitspersample != 8 && td->td_bitspersample != 12) \n #else\n-\tif (td->td_bitspersample != BITS_IN_JSAMPLE )\n+    if (td->td_bitspersample != BITS_IN_JSAMPLE )\n #endif\n-\t{\n-\t\tTIFFErrorExt(tif->tif_clientdata, module, "BitsPerSample %d not allowed for JPEG",\n-\t\t\t  (int) td->td_bitspersample);\n-\t\treturn (0);\n-\t}\n-\tsp->cinfo.c.data_precision = td->td_bitspersample;\n+    {\n+        TIFFErrorExt(tif->tif_clientdata, module, "BitsPerSample %d not allowed for JPEG",\n+              (int) td->td_bitspersample);\n+        return (0);\n+    }\n+    sp->cinfo.c.data_precision = td->td_bitspersample;\n #ifdef JPEG_LIB_MK1\n-        sp->cinfo.c.bits_in_jsample = td->td_bitspersample;\n+    sp->cinfo.c.bits_in_jsample = td->td_bitspersample;\n #endif\n-\tif ((((tif)->tif_flags & 0x00400U) != 0)) {\n-\t\tif ((td->td_tilelength % (sp->v_sampling * DCTSIZE)) != 0) {\n-\t\t\tTIFFErrorExt(tif->tif_clientdata, module,\n-\t\t\t\t  "JPEG tile height must be multiple of %d",\n-\t\t\t\t  sp->v_sampling * DCTSIZE);\n-\t\t\treturn (0);\n-\t\t}\n-\t\tif ((td->td_tilewidth % (sp->h_sampling * DCTSIZE)) != 0) {\n-\t\t\tTIFFErrorExt(tif->tif_clientdata, module,\n-\t\t\t\t  "JPEG tile width must be multiple of %d",\n-\t\t\t\t  sp->h_sampling * DCTSIZE);\n-\t\t\treturn (0);\n-\t\t}\n-\t} else {\n-\t\tif (td->td_rowsperstrip < td->td_imagelength &&\n-\t\t    (td->td_rowsperstrip % (sp->v_sampling * DCTSIZE)) != 0) {\n-\t\t\tTIFFErrorExt(tif->tif_clientdata, module,\n-\t\t\t\t  "RowsPerStrip must be multiple of %d for JPEG",\n-\t\t\t\t  sp->v_sampling * DCTSIZE);\n-\t\t\treturn (0);\n-\t\t}\n-\t}\n-\n-\t/* Create a JPEGTables field if appropriate */\n-\tif (sp->jpegtablesmode & (JPEGTABLESMODE_QUANT|JPEGTABLESMODE_HUFF)) {\n-                if( sp->jpegtables == NULL\n-                    || memcmp(sp->jpegtables,"\\0\\0\\0\\0\\0\\0\\0\\0\\0",8) == 0 )\n-                {\n-                        if (!prepare_JPEGTables(tif))\n-                                return (0);\n-                        /* Mark the field present */\n-                        /* Can\'t use TIFFSetField since BEENWRITING is already set! */\n-                        tif->tif_flags |= TIFF_DIRTYDIRECT;\n-                        TIFFSetFieldBit(tif, FIELD_JPEGTABLES);\n-                }\n-\t} else {\n-\t\t/* We do not support application-supplied JPEGTables, */\n-\t\t/* so mark the field not present */\n-\t\tTIFFClrFieldBit(tif, FIELD_JPEGTABLES);\n-\t}\n+    if ((((tif)->tif_flags & 0x00400U) != 0)) {\n+        if ((td->td_tilelength % (sp->v_sampling * DCTSIZE)) != 0) {\n+            TIFFErrorExt(tif->tif_clientdata, module,\n+                  "JPEG tile height must be multiple of %d",\n+                  sp->v_sampling * DCTSIZE);\n+            return (0);\n+        }\n+        if ((td->td_tilewidth % (sp->h_sampling * DCTSIZE)) != 0) {\n+            TIFFErrorExt(tif->tif_clientdata, module,\n+                  "JPEG tile width must be multiple of %d",\n+                  sp->h_sampling * DCTSIZE);\n+            return (0);\n+        }\n+    } else {\n+        if (td->td_rowsperstrip < td->td_imagelength &&\n+            (td->td_rowsperstrip % (sp->v_sampling * DCTSIZE)) != 0) {\n+            TIFFErrorExt(tif->tif_clientdata, module,\n+                  "RowsPerStrip must be multiple of %d for JPEG",\n+                  sp->v_sampling * DCTSIZE);\n+            return (0);\n+        }\n+    }\n+\n+    /* Create a JPEGTables field if appropriate */\n+    if (sp->jpegtablesmode & (JPEGTABLESMODE_QUANT|JPEGTABLESMODE_HUFF)) {\n+            if( sp->jpegtables == NULL\n+                || memcmp(sp->jpegtables,"\\0\\0\\0\\0\\0\\0\\0\\0\\0",8) == 0 )\n+            {\n+                    if (!prepare_JPEGTables(tif))\n+                        return (0);\n+                    /* Mark the field present */\n+                    /* Can\'t use TIFFSetField since BEENWRITING is already set! */\n+                    tif->tif_flags |= TIFF_DIRTYDIRECT;\n+                    TIFFSetFieldBit(tif, FIELD_JPEGTABLES);\n+            }\n+    } else {\n+        /* We do not support application-supplied JPEGTables, */\n+        /* so mark the field not present */\n+        TIFFClrFieldBit(tif, FIELD_JPEGTABLES);\n+    }\n \n-\t/* Direct libjpeg output to libtiff\'s output buffer */\n-\tTIFFjpeg_data_dest(sp, tif);\n+    /* Direct libjpeg output to libtiff\'s output buffer */\n+    TIFFjpeg_data_dest(sp, tif);\n \n-\treturn (1);\n+    return (1);\n }\n \n+\n /*\n  * Set encoding state at the start of a strip or tile.\n  */\n', 'id': 5, 'location': '/data/vulnloc/libtiff/CVE-2017-7595/src/libtiff/tif_jpeg.c:1685:3'}, {'diff': '@@ -1571,6 +1571,7 @@\n \treturn (1);\n }\n \n+\n static int\n JPEGSetupEncode(TIFF* tif)\n {\n@@ -1681,7 +1682,9 @@\n #ifdef JPEG_LIB_MK1\n         sp->cinfo.c.bits_in_jsample = td->td_bitspersample;\n #endif\n-\tif ((((tif)->tif_flags & 0x00400U) != 0)) {\n+\t\n+\t// Added checks for tile and strip dimensions\n+\tif ((tif)->tif_flags & TIFF_TILED) {\n \t\tif ((td->td_tilelength % (sp->v_sampling * DCTSIZE)) != 0) {\n \t\t\tTIFFErrorExt(tif->tif_clientdata, module,\n \t\t\t\t  "JPEG tile height must be multiple of %d",\n@@ -1728,6 +1731,7 @@\n \treturn (1);\n }\n \n+\n /*\n  * Set encoding state at the start of a strip or tile.\n  */\n', 'id': 6, 'location': '/data/vulnloc/libtiff/CVE-2017-7595/src/libtiff/tif_jpeg.c:1685:3'}, {'diff': '@@ -1571,6 +1571,7 @@\n \treturn (1);\n }\n \n+\n static int\n JPEGSetupEncode(TIFF* tif)\n {\n@@ -1590,11 +1591,6 @@\n \n \tsp->photometric = td->td_photometric;\n \n-\t/*\n-\t * Initialize all JPEG parameters to default values.\n-\t * Note that jpeg_set_defaults needs legal values for\n-\t * in_color_space and input_components.\n-\t */\n \tif (td->td_planarconfig == PLANARCONFIG_CONTIG) {\n \t\tsp->cinfo.c.input_components = td->td_samplesperpixel;\n \t\tif (sp->photometric == PHOTOMETRIC_YCBCR) {\n@@ -1624,11 +1620,6 @@\n \tcase PHOTOMETRIC_YCBCR:\n \t\tsp->h_sampling = td->td_ycbcrsubsampling[0];\n \t\tsp->v_sampling = td->td_ycbcrsubsampling[1];\n-\t\t/*\n-\t\t * A ReferenceBlackWhite field *must* be present since the\n-\t\t * default value is inappropriate for YCbCr.  Fill in the\n-\t\t * proper value if application didn\'t set it.\n-\t\t */\n \t\t{\n \t\t\tfloat *ref;\n \t\t\tif (!TIFFGetField(tif, TIFFTAG_REFERENCEBLACKWHITE,\n@@ -1653,44 +1644,21 @@\n \t\t\t  (int) sp->photometric);\n \t\treturn (0);\n \tdefault:\n-\t\t/* TIFF 6.0 forbids subsampling of all other color spaces */\n \t\tsp->h_sampling = 1;\n \t\tsp->v_sampling = 1;\n \t\tbreak;\n \t}\n \n-\t/* Verify miscellaneous parameters */\n-\n-\t/*\n-\t * This would need work if libtiff ever supports different\n-\t * depths for different components, or if libjpeg ever supports\n-\t * run-time selection of depth.  Neither is imminent.\n-\t */\n-#ifdef JPEG_LIB_MK1\n-        /* BITS_IN_JSAMPLE now permits 8 and 12 --- dgilbert */\n-\tif (td->td_bitspersample != 8 && td->td_bitspersample != 12) \n-#else\n-\tif (td->td_bitspersample != BITS_IN_JSAMPLE )\n-#endif\n-\t{\n-\t\tTIFFErrorExt(tif->tif_clientdata, module, "BitsPerSample %d not allowed for JPEG",\n-\t\t\t  (int) td->td_bitspersample);\n-\t\treturn (0);\n-\t}\n-\tsp->cinfo.c.data_precision = td->td_bitspersample;\n-#ifdef JPEG_LIB_MK1\n-        sp->cinfo.c.bits_in_jsample = td->td_bitspersample;\n-#endif\n \tif ((((tif)->tif_flags & 0x00400U) != 0)) {\n \t\tif ((td->td_tilelength % (sp->v_sampling * DCTSIZE)) != 0) {\n \t\t\tTIFFErrorExt(tif->tif_clientdata, module,\n-\t\t\t\t  "JPEG tile height must be multiple of %d",\n+\t\t\t\t  "JPEG tile height must be a positive multiple of %d",\n \t\t\t\t  sp->v_sampling * DCTSIZE);\n \t\t\treturn (0);\n \t\t}\n \t\tif ((td->td_tilewidth % (sp->h_sampling * DCTSIZE)) != 0) {\n \t\t\tTIFFErrorExt(tif->tif_clientdata, module,\n-\t\t\t\t  "JPEG tile width must be multiple of %d",\n+\t\t\t\t  "JPEG tile width must be a positive multiple of %d",\n \t\t\t\t  sp->h_sampling * DCTSIZE);\n \t\t\treturn (0);\n \t\t}\n@@ -1704,30 +1672,25 @@\n \t\t}\n \t}\n \n-\t/* Create a JPEGTables field if appropriate */\n \tif (sp->jpegtablesmode & (JPEGTABLESMODE_QUANT|JPEGTABLESMODE_HUFF)) {\n                 if( sp->jpegtables == NULL\n                     || memcmp(sp->jpegtables,"\\0\\0\\0\\0\\0\\0\\0\\0\\0",8) == 0 )\n                 {\n                         if (!prepare_JPEGTables(tif))\n                                 return (0);\n-                        /* Mark the field present */\n-                        /* Can\'t use TIFFSetField since BEENWRITING is already set! */\n                         tif->tif_flags |= TIFF_DIRTYDIRECT;\n                         TIFFSetFieldBit(tif, FIELD_JPEGTABLES);\n                 }\n \t} else {\n-\t\t/* We do not support application-supplied JPEGTables, */\n-\t\t/* so mark the field not present */\n \t\tTIFFClrFieldBit(tif, FIELD_JPEGTABLES);\n \t}\n \n-\t/* Direct libjpeg output to libtiff\'s output buffer */\n \tTIFFjpeg_data_dest(sp, tif);\n \n \treturn (1);\n }\n \n+\n /*\n  * Set encoding state at the start of a strip or tile.\n  */\n', 'id': 7, 'location': '/data/vulnloc/libtiff/CVE-2017-7595/src/libtiff/tif_jpeg.c:1685:3'}, {'diff': '@@ -1571,6 +1571,7 @@\n \treturn (1);\n }\n \n+\n static int\n JPEGSetupEncode(TIFF* tif)\n {\n@@ -1728,6 +1729,7 @@\n \treturn (1);\n }\n \n+\n /*\n  * Set encoding state at the start of a strip or tile.\n  */\n', 'id': 8, 'location': '/data/vulnloc/libtiff/CVE-2017-7595/src/libtiff/tif_jpeg.c:1685:3'}, {'diff': '@@ -1571,6 +1571,7 @@\n \treturn (1);\n }\n \n+\n static int\n JPEGSetupEncode(TIFF* tif)\n {\n@@ -1590,11 +1591,6 @@\n \n \tsp->photometric = td->td_photometric;\n \n-\t/*\n-\t * Initialize all JPEG parameters to default values.\n-\t * Note that jpeg_set_defaults needs legal values for\n-\t * in_color_space and input_components.\n-\t */\n \tif (td->td_planarconfig == PLANARCONFIG_CONTIG) {\n \t\tsp->cinfo.c.input_components = td->td_samplesperpixel;\n \t\tif (sp->photometric == PHOTOMETRIC_YCBCR) {\n@@ -1619,16 +1615,12 @@\n \t}\n \tif (!TIFFjpeg_set_defaults(sp))\n \t\treturn (0);\n-\t/* Set per-file parameters */\n+\n \tswitch (sp->photometric) {\n \tcase PHOTOMETRIC_YCBCR:\n \t\tsp->h_sampling = td->td_ycbcrsubsampling[0];\n \t\tsp->v_sampling = td->td_ycbcrsubsampling[1];\n-\t\t/*\n-\t\t * A ReferenceBlackWhite field *must* be present since the\n-\t\t * default value is inappropriate for YCbCr.  Fill in the\n-\t\t * proper value if application didn\'t set it.\n-\t\t */\n+\n \t\t{\n \t\t\tfloat *ref;\n \t\t\tif (!TIFFGetField(tif, TIFFTAG_REFERENCEBLACKWHITE,\n@@ -1646,29 +1638,20 @@\n \t\t\t}\n \t\t}\n \t\tbreak;\n-\tcase PHOTOMETRIC_PALETTE:\t\t/* disallowed by Tech Note */\n+\tcase PHOTOMETRIC_PALETTE:\n \tcase PHOTOMETRIC_MASK:\n \t\tTIFFErrorExt(tif->tif_clientdata, module,\n \t\t\t  "PhotometricInterpretation %d not allowed for JPEG",\n \t\t\t  (int) sp->photometric);\n \t\treturn (0);\n \tdefault:\n-\t\t/* TIFF 6.0 forbids subsampling of all other color spaces */\n \t\tsp->h_sampling = 1;\n \t\tsp->v_sampling = 1;\n \t\tbreak;\n \t}\n \n-\t/* Verify miscellaneous parameters */\n-\n-\t/*\n-\t * This would need work if libtiff ever supports different\n-\t * depths for different components, or if libjpeg ever supports\n-\t * run-time selection of depth.  Neither is imminent.\n-\t */\n #ifdef JPEG_LIB_MK1\n-        /* BITS_IN_JSAMPLE now permits 8 and 12 --- dgilbert */\n-\tif (td->td_bitspersample != 8 && td->td_bitspersample != 12) \n+\tif (td->td_bitspersample != 8 && td->td_bitspersample != 12)\n #else\n \tif (td->td_bitspersample != BITS_IN_JSAMPLE )\n #endif\n@@ -1679,7 +1662,7 @@\n \t}\n \tsp->cinfo.c.data_precision = td->td_bitspersample;\n #ifdef JPEG_LIB_MK1\n-        sp->cinfo.c.bits_in_jsample = td->td_bitspersample;\n+\tsp->cinfo.c.bits_in_jsample = td->td_bitspersample;\n #endif\n \tif ((((tif)->tif_flags & 0x00400U) != 0)) {\n \t\tif ((td->td_tilelength % (sp->v_sampling * DCTSIZE)) != 0) {\n@@ -1704,30 +1687,25 @@\n \t\t}\n \t}\n \n-\t/* Create a JPEGTables field if appropriate */\n \tif (sp->jpegtablesmode & (JPEGTABLESMODE_QUANT|JPEGTABLESMODE_HUFF)) {\n                 if( sp->jpegtables == NULL\n                     || memcmp(sp->jpegtables,"\\0\\0\\0\\0\\0\\0\\0\\0\\0",8) == 0 )\n                 {\n                         if (!prepare_JPEGTables(tif))\n                                 return (0);\n-                        /* Mark the field present */\n-                        /* Can\'t use TIFFSetField since BEENWRITING is already set! */\n                         tif->tif_flags |= TIFF_DIRTYDIRECT;\n                         TIFFSetFieldBit(tif, FIELD_JPEGTABLES);\n                 }\n \t} else {\n-\t\t/* We do not support application-supplied JPEGTables, */\n-\t\t/* so mark the field not present */\n \t\tTIFFClrFieldBit(tif, FIELD_JPEGTABLES);\n \t}\n \n-\t/* Direct libjpeg output to libtiff\'s output buffer */\n \tTIFFjpeg_data_dest(sp, tif);\n \n \treturn (1);\n }\n \n+\n /*\n  * Set encoding state at the start of a strip or tile.\n  */\n', 'id': 9, 'location': '/data/vulnloc/libtiff/CVE-2017-7595/src/libtiff/tif_jpeg.c:1685:3'}, {'diff': '@@ -1571,6 +1571,7 @@\n \treturn (1);\n }\n \n+\n static int\n JPEGSetupEncode(TIFF* tif)\n {\n@@ -1728,6 +1729,7 @@\n \treturn (1);\n }\n \n+\n /*\n  * Set encoding state at the start of a strip or tile.\n  */\n', 'id': 10, 'location': '/data/vulnloc/libtiff/CVE-2017-7595/src/libtiff/tif_jpeg.c:1685:44'}, {'diff': "@@ -1571,6 +1571,7 @@\n \treturn (1);\n }\n \n+\n static int\n JPEGSetupEncode(TIFF* tif)\n {\n@@ -1590,11 +1591,6 @@\n \n \tsp->photometric = td->td_photometric;\n \n-\t/*\n-\t * Initialize all JPEG parameters to default values.\n-\t * Note that jpeg_set_defaults needs legal values for\n-\t * in_color_space and input_components.\n-\t */\n \tif (td->td_planarconfig == PLANARCONFIG_CONTIG) {\n \t\tsp->cinfo.c.input_components = td->td_samplesperpixel;\n \t\tif (sp->photometric == PHOTOMETRIC_YCBCR) {\n@@ -1624,11 +1620,6 @@\n \tcase PHOTOMETRIC_YCBCR:\n \t\tsp->h_sampling = td->td_ycbcrsubsampling[0];\n \t\tsp->v_sampling = td->td_ycbcrsubsampling[1];\n-\t\t/*\n-\t\t * A ReferenceBlackWhite field *must* be present since the\n-\t\t * default value is inappropriate for YCbCr.  Fill in the\n-\t\t * proper value if application didn't set it.\n-\t\t */\n \t\t{\n \t\t\tfloat *ref;\n \t\t\tif (!TIFFGetField(tif, TIFFTAG_REFERENCEBLACKWHITE,\n@@ -1653,21 +1644,13 @@\n \t\t\t  (int) sp->photometric);\n \t\treturn (0);\n \tdefault:\n-\t\t/* TIFF 6.0 forbids subsampling of all other color spaces */\n \t\tsp->h_sampling = 1;\n \t\tsp->v_sampling = 1;\n \t\tbreak;\n \t}\n \n \t/* Verify miscellaneous parameters */\n-\n-\t/*\n-\t * This would need work if libtiff ever supports different\n-\t * depths for different components, or if libjpeg ever supports\n-\t * run-time selection of depth.  Neither is imminent.\n-\t */\n #ifdef JPEG_LIB_MK1\n-        /* BITS_IN_JSAMPLE now permits 8 and 12 --- dgilbert */\n \tif (td->td_bitspersample != 8 && td->td_bitspersample != 12) \n #else\n \tif (td->td_bitspersample != BITS_IN_JSAMPLE )\n@@ -1679,7 +1662,7 @@\n \t}\n \tsp->cinfo.c.data_precision = td->td_bitspersample;\n #ifdef JPEG_LIB_MK1\n-        sp->cinfo.c.bits_in_jsample = td->td_bitspersample;\n+\tsp->cinfo.c.bits_in_jsample = td->td_bitspersample;\n #endif\n \tif ((((tif)->tif_flags & 0x00400U) != 0)) {\n \t\tif ((td->td_tilelength % (sp->v_sampling * DCTSIZE)) != 0) {\n@@ -1711,23 +1694,19 @@\n                 {\n                         if (!prepare_JPEGTables(tif))\n                                 return (0);\n-                        /* Mark the field present */\n-                        /* Can't use TIFFSetField since BEENWRITING is already set! */\n                         tif->tif_flags |= TIFF_DIRTYDIRECT;\n                         TIFFSetFieldBit(tif, FIELD_JPEGTABLES);\n                 }\n \t} else {\n-\t\t/* We do not support application-supplied JPEGTables, */\n-\t\t/* so mark the field not present */\n \t\tTIFFClrFieldBit(tif, FIELD_JPEGTABLES);\n \t}\n \n-\t/* Direct libjpeg output to libtiff's output buffer */\n \tTIFFjpeg_data_dest(sp, tif);\n \n \treturn (1);\n }\n \n+\n /*\n  * Set encoding state at the start of a strip or tile.\n  */\n", 'id': 11, 'location': '/data/vulnloc/libtiff/CVE-2017-7595/src/libtiff/tif_jpeg.c:1685:44'}, {'diff': '@@ -1571,6 +1571,7 @@\n \treturn (1);\n }\n \n+\n static int\n JPEGSetupEncode(TIFF* tif)\n {\n@@ -1661,11 +1662,6 @@\n \n \t/* Verify miscellaneous parameters */\n \n-\t/*\n-\t * This would need work if libtiff ever supports different\n-\t * depths for different components, or if libjpeg ever supports\n-\t * run-time selection of depth.  Neither is imminent.\n-\t */\n #ifdef JPEG_LIB_MK1\n         /* BITS_IN_JSAMPLE now permits 8 and 12 --- dgilbert */\n \tif (td->td_bitspersample != 8 && td->td_bitspersample != 12) \n@@ -1683,12 +1679,22 @@\n #endif\n \tif ((((tif)->tif_flags & 0x00400U) != 0)) {\n \t\tif ((td->td_tilelength % (sp->v_sampling * DCTSIZE)) != 0) {\n+\t\t\tif (td->td_tilelength <= 0 || sp->v_sampling <= 0) {\n+\t\t\t\tTIFFErrorExt(tif->tif_clientdata, module,\n+\t\t\t\t\t  "Invalid parameters for tile length or vertical sampling.");\n+\t\t\t\treturn (0);\n+\t\t\t}\n \t\t\tTIFFErrorExt(tif->tif_clientdata, module,\n \t\t\t\t  "JPEG tile height must be multiple of %d",\n \t\t\t\t  sp->v_sampling * DCTSIZE);\n \t\t\treturn (0);\n \t\t}\n \t\tif ((td->td_tilewidth % (sp->h_sampling * DCTSIZE)) != 0) {\n+\t\t\tif (td->td_tilewidth <= 0 || sp->h_sampling <= 0) {\n+\t\t\t\tTIFFErrorExt(tif->tif_clientdata, module,\n+\t\t\t\t\t  "Invalid parameters for tile width or horizontal sampling.");\n+\t\t\t\treturn (0);\n+\t\t\t}\n \t\t\tTIFFErrorExt(tif->tif_clientdata, module,\n \t\t\t\t  "JPEG tile width must be multiple of %d",\n \t\t\t\t  sp->h_sampling * DCTSIZE);\n@@ -1728,6 +1734,7 @@\n \treturn (1);\n }\n \n+\n /*\n  * Set encoding state at the start of a strip or tile.\n  */\n', 'id': 12, 'location': '/data/vulnloc/libtiff/CVE-2017-7595/src/libtiff/tif_jpeg.c:1685:44'}, {'diff': '@@ -1571,163 +1571,115 @@\n \treturn (1);\n }\n \n+\n static int\n JPEGSetupEncode(TIFF* tif)\n {\n-\tJPEGState* sp = JState(tif);\n-\tTIFFDirectory *td = &tif->tif_dir;\n-\tstatic const char module[] = "JPEGSetupEncode";\n+    JPEGState* sp = JState(tif);\n+    TIFFDirectory *td = &tif->tif_dir;\n+    static const char module[] = "JPEGSetupEncode";\n \n #if defined(JPEG_DUAL_MODE_8_12) && !defined(TIFFInitJPEG)\n-        if( tif->tif_dir.td_bitspersample == 12 )\n-            return TIFFReInitJPEG_12( tif, COMPRESSION_JPEG, 1 );\n+    if( tif->tif_dir.td_bitspersample == 12 )\n+        return TIFFReInitJPEG_12( tif, COMPRESSION_JPEG, 1 );\n #endif\n \n-        JPEGInitializeLibJPEG( tif, FALSE );\n+    JPEGInitializeLibJPEG( tif, FALSE );\n \n-\tassert(sp != NULL);\n-\tassert(!sp->cinfo.comm.is_decompressor);\n+    assert(sp != NULL);\n+    assert(!sp->cinfo.comm.is_decompressor);\n \n-\tsp->photometric = td->td_photometric;\n+    sp->photometric = td->td_photometric;\n \n-\t/*\n-\t * Initialize all JPEG parameters to default values.\n-\t * Note that jpeg_set_defaults needs legal values for\n-\t * in_color_space and input_components.\n-\t */\n-\tif (td->td_planarconfig == PLANARCONFIG_CONTIG) {\n-\t\tsp->cinfo.c.input_components = td->td_samplesperpixel;\n-\t\tif (sp->photometric == PHOTOMETRIC_YCBCR) {\n-\t\t\tif (sp->jpegcolormode == JPEGCOLORMODE_RGB) {\n-\t\t\t\tsp->cinfo.c.in_color_space = JCS_RGB;\n-\t\t\t} else {\n-\t\t\t\tsp->cinfo.c.in_color_space = JCS_YCbCr;\n-\t\t\t}\n-\t\t} else {\n-\t\t\tif ((td->td_photometric == PHOTOMETRIC_MINISWHITE || td->td_photometric == PHOTOMETRIC_MINISBLACK) && td->td_samplesperpixel == 1)\n-\t\t\t\tsp->cinfo.c.in_color_space = JCS_GRAYSCALE;\n-\t\t\telse if (td->td_photometric == PHOTOMETRIC_RGB && td->td_samplesperpixel == 3)\n-\t\t\t\tsp->cinfo.c.in_color_space = JCS_RGB;\n-\t\t\telse if (td->td_photometric == PHOTOMETRIC_SEPARATED && td->td_samplesperpixel == 4)\n-\t\t\t\tsp->cinfo.c.in_color_space = JCS_CMYK;\n-\t\t\telse\n-\t\t\t\tsp->cinfo.c.in_color_space = JCS_UNKNOWN;\n-\t\t}\n-\t} else {\n-\t\tsp->cinfo.c.input_components = 1;\n-\t\tsp->cinfo.c.in_color_space = JCS_UNKNOWN;\n-\t}\n-\tif (!TIFFjpeg_set_defaults(sp))\n-\t\treturn (0);\n-\t/* Set per-file parameters */\n-\tswitch (sp->photometric) {\n-\tcase PHOTOMETRIC_YCBCR:\n-\t\tsp->h_sampling = td->td_ycbcrsubsampling[0];\n-\t\tsp->v_sampling = td->td_ycbcrsubsampling[1];\n-\t\t/*\n-\t\t * A ReferenceBlackWhite field *must* be present since the\n-\t\t * default value is inappropriate for YCbCr.  Fill in the\n-\t\t * proper value if application didn\'t set it.\n-\t\t */\n-\t\t{\n-\t\t\tfloat *ref;\n-\t\t\tif (!TIFFGetField(tif, TIFFTAG_REFERENCEBLACKWHITE,\n-\t\t\t\t\t  &ref)) {\n-\t\t\t\tfloat refbw[6];\n-\t\t\t\tlong top = 1L << td->td_bitspersample;\n-\t\t\t\trefbw[0] = 0;\n-\t\t\t\trefbw[1] = (float)(top-1L);\n-\t\t\t\trefbw[2] = (float)(top>>1);\n-\t\t\t\trefbw[3] = refbw[1];\n-\t\t\t\trefbw[4] = refbw[2];\n-\t\t\t\trefbw[5] = refbw[1];\n-\t\t\t\tTIFFSetField(tif, TIFFTAG_REFERENCEBLACKWHITE,\n-\t\t\t\t\t     refbw);\n-\t\t\t}\n-\t\t}\n-\t\tbreak;\n-\tcase PHOTOMETRIC_PALETTE:\t\t/* disallowed by Tech Note */\n-\tcase PHOTOMETRIC_MASK:\n-\t\tTIFFErrorExt(tif->tif_clientdata, module,\n-\t\t\t  "PhotometricInterpretation %d not allowed for JPEG",\n-\t\t\t  (int) sp->photometric);\n-\t\treturn (0);\n-\tdefault:\n-\t\t/* TIFF 6.0 forbids subsampling of all other color spaces */\n-\t\tsp->h_sampling = 1;\n-\t\tsp->v_sampling = 1;\n-\t\tbreak;\n-\t}\n-\n-\t/* Verify miscellaneous parameters */\n-\n-\t/*\n-\t * This would need work if libtiff ever supports different\n-\t * depths for different components, or if libjpeg ever supports\n-\t * run-time selection of depth.  Neither is imminent.\n-\t */\n-#ifdef JPEG_LIB_MK1\n-        /* BITS_IN_JSAMPLE now permits 8 and 12 --- dgilbert */\n-\tif (td->td_bitspersample != 8 && td->td_bitspersample != 12) \n-#else\n-\tif (td->td_bitspersample != BITS_IN_JSAMPLE )\n-#endif\n-\t{\n-\t\tTIFFErrorExt(tif->tif_clientdata, module, "BitsPerSample %d not allowed for JPEG",\n-\t\t\t  (int) td->td_bitspersample);\n-\t\treturn (0);\n-\t}\n-\tsp->cinfo.c.data_precision = td->td_bitspersample;\n-#ifdef JPEG_LIB_MK1\n-        sp->cinfo.c.bits_in_jsample = td->td_bitspersample;\n-#endif\n-\tif ((((tif)->tif_flags & 0x00400U) != 0)) {\n-\t\tif ((td->td_tilelength % (sp->v_sampling * DCTSIZE)) != 0) {\n-\t\t\tTIFFErrorExt(tif->tif_clientdata, module,\n-\t\t\t\t  "JPEG tile height must be multiple of %d",\n-\t\t\t\t  sp->v_sampling * DCTSIZE);\n-\t\t\treturn (0);\n-\t\t}\n-\t\tif ((td->td_tilewidth % (sp->h_sampling * DCTSIZE)) != 0) {\n-\t\t\tTIFFErrorExt(tif->tif_clientdata, module,\n-\t\t\t\t  "JPEG tile width must be multiple of %d",\n-\t\t\t\t  sp->h_sampling * DCTSIZE);\n-\t\t\treturn (0);\n-\t\t}\n-\t} else {\n-\t\tif (td->td_rowsperstrip < td->td_imagelength &&\n-\t\t    (td->td_rowsperstrip % (sp->v_sampling * DCTSIZE)) != 0) {\n-\t\t\tTIFFErrorExt(tif->tif_clientdata, module,\n-\t\t\t\t  "RowsPerStrip must be multiple of %d for JPEG",\n-\t\t\t\t  sp->v_sampling * DCTSIZE);\n-\t\t\treturn (0);\n-\t\t}\n-\t}\n-\n-\t/* Create a JPEGTables field if appropriate */\n-\tif (sp->jpegtablesmode & (JPEGTABLESMODE_QUANT|JPEGTABLESMODE_HUFF)) {\n-                if( sp->jpegtables == NULL\n-                    || memcmp(sp->jpegtables,"\\0\\0\\0\\0\\0\\0\\0\\0\\0",8) == 0 )\n-                {\n-                        if (!prepare_JPEGTables(tif))\n-                                return (0);\n-                        /* Mark the field present */\n-                        /* Can\'t use TIFFSetField since BEENWRITING is already set! */\n-                        tif->tif_flags |= TIFF_DIRTYDIRECT;\n-                        TIFFSetFieldBit(tif, FIELD_JPEGTABLES);\n-                }\n-\t} else {\n-\t\t/* We do not support application-supplied JPEGTables, */\n-\t\t/* so mark the field not present */\n-\t\tTIFFClrFieldBit(tif, FIELD_JPEGTABLES);\n-\t}\n+    if (td->td_planarconfig == PLANARCONFIG_CONTIG) {\n+        sp->cinfo.c.input_components = td->td_samplesperpixel;\n+        if (sp->photometric == PHOTOMETRIC_YCBCR) {\n+            if (sp->jpegcolormode == JPEGCOLORMODE_RGB) {\n+                sp->cinfo.c.in_color_space = JCS_RGB;\n+            } else {\n+                sp->cinfo.c.in_color_space = JCS_YCbCr;\n+            }\n+        } else {\n+            if ((td->td_photometric == PHOTOMETRIC_MINISWHITE || td->td_photometric == PHOTOMETRIC_MINISBLACK) && td->td_samplesperpixel == 1)\n+                sp->cinfo.c.in_color_space = JCS_GRAYSCALE;\n+            else if (td->td_photometric == PHOTOMETRIC_RGB && td->td_samplesperpixel == 3)\n+                sp->cinfo.c.in_color_space = JCS_RGB;\n+            else if (td->td_photometric == PHOTOMETRIC_SEPARATED && td->td_samplesperpixel == 4)\n+                sp->cinfo.c.in_color_space = JCS_CMYK;\n+            else\n+                sp->cinfo.c.in_color_space = JCS_UNKNOWN;\n+        }\n+    } else {\n+        sp->cinfo.c.input_components = 1;\n+        sp->cinfo.c.in_color_space = JCS_UNKNOWN;\n+    }\n+    \n+    if (!TIFFjpeg_set_defaults(sp))\n+        return (0);\n+\n+    switch (sp->photometric) {\n+    case PHOTOMETRIC_YCBCR:\n+        sp->h_sampling = td->td_ycbcrsubsampling[0];\n+        sp->v_sampling = td->td_ycbcrsubsampling[1];\n+\n+        {\n+            float *ref;\n+            if (!TIFFGetField(tif, TIFFTAG_REFERENCEBLACKWHITE, &ref)) {\n+                float refbw[6];\n+                long top = 1L << td->td_bitspersample;\n+                refbw[0] = 0;\n+                refbw[1] = (float)(top-1L);\n+                refbw[2] = (float)(top>>1);\n+                refbw[3] = refbw[1];\n+                refbw[4] = refbw[2];\n+                refbw[5] = refbw[1];\n+                TIFFSetField(tif, TIFFTAG_REFERENCEBLACKWHITE, refbw);\n+            }\n+        }\n+        break;\n+    case PHOTOMETRIC_PALETTE:\n+    case PHOTOMETRIC_MASK:\n+        TIFFErrorExt(tif->tif_clientdata, module, "PhotometricInterpretation %d not allowed for JPEG", (int) sp->photometric);\n+        return (0);\n+    default:\n+        sp->h_sampling = 1;\n+        sp->v_sampling = 1;\n+        break;\n+    }\n+\n+    if (td->td_tilelength % (sp->v_sampling * DCTSIZE) != 0) {\n+        TIFFErrorExt(tif->tif_clientdata, module, "JPEG tile height must be multiple of %d", sp->v_sampling * DCTSIZE);\n+        return (0);\n+    }\n+\n+    if ((td->td_tilewidth % (sp->h_sampling * DCTSIZE)) != 0) {\n+        TIFFErrorExt(tif->tif_clientdata, module, "JPEG tile width must be multiple of %d", sp->h_sampling * DCTSIZE);\n+        return (0);\n+    }\n+\n+    if (td->td_rowsperstrip < td->td_imagelength &&\n+        (td->td_rowsperstrip % (sp->v_sampling * DCTSIZE)) != 0) {\n+        TIFFErrorExt(tif->tif_clientdata, module, "RowsPerStrip must be multiple of %d for JPEG", sp->v_sampling * DCTSIZE);\n+        return (0);\n+    }\n+\n+    if (sp->jpegtablesmode & (JPEGTABLESMODE_QUANT|JPEGTABLESMODE_HUFF)) {\n+        if( sp->jpegtables == NULL || memcmp(sp->jpegtables,"\\0\\0\\0\\0\\0\\0\\0\\0\\0",8) == 0 ) {\n+            if (!prepare_JPEGTables(tif))\n+                return (0);\n+            tif->tif_flags |= TIFF_DIRTYDIRECT;\n+            TIFFSetFieldBit(tif, FIELD_JPEGTABLES);\n+        }\n+    } else {\n+        TIFFClrFieldBit(tif, FIELD_JPEGTABLES);\n+    }\n \n-\t/* Direct libjpeg output to libtiff\'s output buffer */\n-\tTIFFjpeg_data_dest(sp, tif);\n+    TIFFjpeg_data_dest(sp, tif);\n \n-\treturn (1);\n+    return (1);\n }\n \n+\n /*\n  * Set encoding state at the start of a strip or tile.\n  */\n', 'id': 13, 'location': '/data/vulnloc/libtiff/CVE-2017-7595/src/libtiff/tif_jpeg.c:1685:44'}, {'diff': '@@ -1571,6 +1571,7 @@\n \treturn (1);\n }\n \n+\n static int\n JPEGSetupEncode(TIFF* tif)\n {\n@@ -1684,13 +1685,13 @@\n \tif ((((tif)->tif_flags & 0x00400U) != 0)) {\n \t\tif ((td->td_tilelength % (sp->v_sampling * DCTSIZE)) != 0) {\n \t\t\tTIFFErrorExt(tif->tif_clientdata, module,\n-\t\t\t\t  "JPEG tile height must be multiple of %d",\n+\t\t\t\t  "JPEG tile height must be a multiple of %d",\n \t\t\t\t  sp->v_sampling * DCTSIZE);\n \t\t\treturn (0);\n \t\t}\n \t\tif ((td->td_tilewidth % (sp->h_sampling * DCTSIZE)) != 0) {\n \t\t\tTIFFErrorExt(tif->tif_clientdata, module,\n-\t\t\t\t  "JPEG tile width must be multiple of %d",\n+\t\t\t\t  "JPEG tile width must be a multiple of %d",\n \t\t\t\t  sp->h_sampling * DCTSIZE);\n \t\t\treturn (0);\n \t\t}\n@@ -1698,7 +1699,7 @@\n \t\tif (td->td_rowsperstrip < td->td_imagelength &&\n \t\t    (td->td_rowsperstrip % (sp->v_sampling * DCTSIZE)) != 0) {\n \t\t\tTIFFErrorExt(tif->tif_clientdata, module,\n-\t\t\t\t  "RowsPerStrip must be multiple of %d for JPEG",\n+\t\t\t\t  "RowsPerStrip must be a multiple of %d for JPEG",\n \t\t\t\t  sp->v_sampling * DCTSIZE);\n \t\t\treturn (0);\n \t\t}\n@@ -1728,6 +1729,7 @@\n \treturn (1);\n }\n \n+\n /*\n  * Set encoding state at the start of a strip or tile.\n  */\n', 'id': 14, 'location': '/data/vulnloc/libtiff/CVE-2017-7595/src/libtiff/tif_jpeg.c:1685:44'}, {'diff': '@@ -1571,6 +1571,7 @@\n \treturn (1);\n }\n \n+\n static int\n JPEGSetupEncode(TIFF* tif)\n {\n@@ -1681,7 +1682,7 @@\n #ifdef JPEG_LIB_MK1\n         sp->cinfo.c.bits_in_jsample = td->td_bitspersample;\n #endif\n-\tif ((((tif)->tif_flags & 0x00400U) != 0)) {\n+\tif ((((tif)->tif_flags & TIFF_DIR_TILE) != 0)) { // Changed flag check for clarity\n \t\tif ((td->td_tilelength % (sp->v_sampling * DCTSIZE)) != 0) {\n \t\t\tTIFFErrorExt(tif->tif_clientdata, module,\n \t\t\t\t  "JPEG tile height must be multiple of %d",\n@@ -1728,6 +1729,7 @@\n \treturn (1);\n }\n \n+\n /*\n  * Set encoding state at the start of a strip or tile.\n  */\n', 'id': 15, 'location': '/data/vulnloc/libtiff/CVE-2017-7595/src/libtiff/tif_jpeg.c:1684:2'}, {'diff': '@@ -1571,6 +1571,7 @@\n \treturn (1);\n }\n \n+\n static int\n JPEGSetupEncode(TIFF* tif)\n {\n@@ -1590,11 +1591,6 @@\n \n \tsp->photometric = td->td_photometric;\n \n-\t/*\n-\t * Initialize all JPEG parameters to default values.\n-\t * Note that jpeg_set_defaults needs legal values for\n-\t * in_color_space and input_components.\n-\t */\n \tif (td->td_planarconfig == PLANARCONFIG_CONTIG) {\n \t\tsp->cinfo.c.input_components = td->td_samplesperpixel;\n \t\tif (sp->photometric == PHOTOMETRIC_YCBCR) {\n@@ -1619,16 +1615,10 @@\n \t}\n \tif (!TIFFjpeg_set_defaults(sp))\n \t\treturn (0);\n-\t/* Set per-file parameters */\n \tswitch (sp->photometric) {\n \tcase PHOTOMETRIC_YCBCR:\n \t\tsp->h_sampling = td->td_ycbcrsubsampling[0];\n \t\tsp->v_sampling = td->td_ycbcrsubsampling[1];\n-\t\t/*\n-\t\t * A ReferenceBlackWhite field *must* be present since the\n-\t\t * default value is inappropriate for YCbCr.  Fill in the\n-\t\t * proper value if application didn\'t set it.\n-\t\t */\n \t\t{\n \t\t\tfloat *ref;\n \t\t\tif (!TIFFGetField(tif, TIFFTAG_REFERENCEBLACKWHITE,\n@@ -1646,28 +1636,19 @@\n \t\t\t}\n \t\t}\n \t\tbreak;\n-\tcase PHOTOMETRIC_PALETTE:\t\t/* disallowed by Tech Note */\n+\tcase PHOTOMETRIC_PALETTE:\n \tcase PHOTOMETRIC_MASK:\n \t\tTIFFErrorExt(tif->tif_clientdata, module,\n \t\t\t  "PhotometricInterpretation %d not allowed for JPEG",\n \t\t\t  (int) sp->photometric);\n \t\treturn (0);\n \tdefault:\n-\t\t/* TIFF 6.0 forbids subsampling of all other color spaces */\n \t\tsp->h_sampling = 1;\n \t\tsp->v_sampling = 1;\n \t\tbreak;\n \t}\n \n-\t/* Verify miscellaneous parameters */\n-\n-\t/*\n-\t * This would need work if libtiff ever supports different\n-\t * depths for different components, or if libjpeg ever supports\n-\t * run-time selection of depth.  Neither is imminent.\n-\t */\n #ifdef JPEG_LIB_MK1\n-        /* BITS_IN_JSAMPLE now permits 8 and 12 --- dgilbert */\n \tif (td->td_bitspersample != 8 && td->td_bitspersample != 12) \n #else\n \tif (td->td_bitspersample != BITS_IN_JSAMPLE )\n@@ -1679,9 +1660,9 @@\n \t}\n \tsp->cinfo.c.data_precision = td->td_bitspersample;\n #ifdef JPEG_LIB_MK1\n-        sp->cinfo.c.bits_in_jsample = td->td_bitspersample;\n+\tsp->cinfo.c.bits_in_jsample = td->td_bitspersample;\n #endif\n-\tif ((((tif)->tif_flags & 0x00400U) != 0)) {\n+\tif ((((tif)->tif_flags & 0x00400U) != 0) && (td->td_tilelength > 0 && td->td_tilewidth > 0)) {\n \t\tif ((td->td_tilelength % (sp->v_sampling * DCTSIZE)) != 0) {\n \t\t\tTIFFErrorExt(tif->tif_clientdata, module,\n \t\t\t\t  "JPEG tile height must be multiple of %d",\n@@ -1704,30 +1685,25 @@\n \t\t}\n \t}\n \n-\t/* Create a JPEGTables field if appropriate */\n \tif (sp->jpegtablesmode & (JPEGTABLESMODE_QUANT|JPEGTABLESMODE_HUFF)) {\n-                if( sp->jpegtables == NULL\n-                    || memcmp(sp->jpegtables,"\\0\\0\\0\\0\\0\\0\\0\\0\\0",8) == 0 )\n-                {\n-                        if (!prepare_JPEGTables(tif))\n-                                return (0);\n-                        /* Mark the field present */\n-                        /* Can\'t use TIFFSetField since BEENWRITING is already set! */\n-                        tif->tif_flags |= TIFF_DIRTYDIRECT;\n-                        TIFFSetFieldBit(tif, FIELD_JPEGTABLES);\n-                }\n+\t\tif( sp->jpegtables == NULL\n+\t\t\t|| memcmp(sp->jpegtables,"\\0\\0\\0\\0\\0\\0\\0\\0\\0",8) == 0 )\n+\t\t{\n+\t\t\tif (!prepare_JPEGTables(tif))\n+\t\t\t\treturn (0);\n+\t\t\ttif->tif_flags |= TIFF_DIRTYDIRECT;\n+\t\t\tTIFFSetFieldBit(tif, FIELD_JPEGTABLES);\n+\t\t}\n \t} else {\n-\t\t/* We do not support application-supplied JPEGTables, */\n-\t\t/* so mark the field not present */\n \t\tTIFFClrFieldBit(tif, FIELD_JPEGTABLES);\n \t}\n \n-\t/* Direct libjpeg output to libtiff\'s output buffer */\n \tTIFFjpeg_data_dest(sp, tif);\n \n \treturn (1);\n }\n \n+\n /*\n  * Set encoding state at the start of a strip or tile.\n  */\n', 'id': 16, 'location': '/data/vulnloc/libtiff/CVE-2017-7595/src/libtiff/tif_jpeg.c:1684:2'}, {'diff': '@@ -1571,6 +1571,7 @@\n \treturn (1);\n }\n \n+\n static int\n JPEGSetupEncode(TIFF* tif)\n {\n@@ -1728,6 +1729,7 @@\n \treturn (1);\n }\n \n+\n /*\n  * Set encoding state at the start of a strip or tile.\n  */\n', 'id': 17, 'location': '/data/vulnloc/libtiff/CVE-2017-7595/src/libtiff/tif_jpeg.c:1684:2'}, {'diff': '@@ -1571,6 +1571,7 @@\n \treturn (1);\n }\n \n+\n static int\n JPEGSetupEncode(TIFF* tif)\n {\n@@ -1728,6 +1729,7 @@\n \treturn (1);\n }\n \n+\n /*\n  * Set encoding state at the start of a strip or tile.\n  */\n', 'id': 18, 'location': '/data/vulnloc/libtiff/CVE-2017-7595/src/libtiff/tif_jpeg.c:1684:2'}, {'diff': '@@ -1571,6 +1571,7 @@\n \treturn (1);\n }\n \n+\n static int\n JPEGSetupEncode(TIFF* tif)\n {\n@@ -1681,7 +1682,7 @@\n #ifdef JPEG_LIB_MK1\n         sp->cinfo.c.bits_in_jsample = td->td_bitspersample;\n #endif\n-\tif ((((tif)->tif_flags & 0x00400U) != 0)) {\n+\tif ((((tif)->tif_flags & TIFF_PREFERENCE_JPEG) != 0)) {\n \t\tif ((td->td_tilelength % (sp->v_sampling * DCTSIZE)) != 0) {\n \t\t\tTIFFErrorExt(tif->tif_clientdata, module,\n \t\t\t\t  "JPEG tile height must be multiple of %d",\n@@ -1728,6 +1729,7 @@\n \treturn (1);\n }\n \n+\n /*\n  * Set encoding state at the start of a strip or tile.\n  */\n', 'id': 19, 'location': '/data/vulnloc/libtiff/CVE-2017-7595/src/libtiff/tif_jpeg.c:1684:2'}, {'diff': '@@ -1571,6 +1571,7 @@\n \treturn (1);\n }\n \n+\n static int\n JPEGSetupEncode(TIFF* tif)\n {\n@@ -1590,11 +1591,6 @@\n \n \tsp->photometric = td->td_photometric;\n \n-\t/*\n-\t * Initialize all JPEG parameters to default values.\n-\t * Note that jpeg_set_defaults needs legal values for\n-\t * in_color_space and input_components.\n-\t */\n \tif (td->td_planarconfig == PLANARCONFIG_CONTIG) {\n \t\tsp->cinfo.c.input_components = td->td_samplesperpixel;\n \t\tif (sp->photometric == PHOTOMETRIC_YCBCR) {\n@@ -1617,18 +1613,14 @@\n \t\tsp->cinfo.c.input_components = 1;\n \t\tsp->cinfo.c.in_color_space = JCS_UNKNOWN;\n \t}\n+\n \tif (!TIFFjpeg_set_defaults(sp))\n \t\treturn (0);\n-\t/* Set per-file parameters */\n+\n \tswitch (sp->photometric) {\n \tcase PHOTOMETRIC_YCBCR:\n \t\tsp->h_sampling = td->td_ycbcrsubsampling[0];\n \t\tsp->v_sampling = td->td_ycbcrsubsampling[1];\n-\t\t/*\n-\t\t * A ReferenceBlackWhite field *must* be present since the\n-\t\t * default value is inappropriate for YCbCr.  Fill in the\n-\t\t * proper value if application didn\'t set it.\n-\t\t */\n \t\t{\n \t\t\tfloat *ref;\n \t\t\tif (!TIFFGetField(tif, TIFFTAG_REFERENCEBLACKWHITE,\n@@ -1646,28 +1638,20 @@\n \t\t\t}\n \t\t}\n \t\tbreak;\n-\tcase PHOTOMETRIC_PALETTE:\t\t/* disallowed by Tech Note */\n+\n+\tcase PHOTOMETRIC_PALETTE:\n \tcase PHOTOMETRIC_MASK:\n \t\tTIFFErrorExt(tif->tif_clientdata, module,\n \t\t\t  "PhotometricInterpretation %d not allowed for JPEG",\n \t\t\t  (int) sp->photometric);\n \t\treturn (0);\n \tdefault:\n-\t\t/* TIFF 6.0 forbids subsampling of all other color spaces */\n \t\tsp->h_sampling = 1;\n \t\tsp->v_sampling = 1;\n \t\tbreak;\n \t}\n \n-\t/* Verify miscellaneous parameters */\n-\n-\t/*\n-\t * This would need work if libtiff ever supports different\n-\t * depths for different components, or if libjpeg ever supports\n-\t * run-time selection of depth.  Neither is imminent.\n-\t */\n #ifdef JPEG_LIB_MK1\n-        /* BITS_IN_JSAMPLE now permits 8 and 12 --- dgilbert */\n \tif (td->td_bitspersample != 8 && td->td_bitspersample != 12) \n #else\n \tif (td->td_bitspersample != BITS_IN_JSAMPLE )\n@@ -1677,10 +1661,12 @@\n \t\t\t  (int) td->td_bitspersample);\n \t\treturn (0);\n \t}\n-\tsp->cinfo.c.data_precision = td->td_bitspersample;\n+\n+\tsp->cinfo.c.data_precision = (td->td_bitspersample == 8) ? 8 : 12; // Only allow 8 or 12 bits\n #ifdef JPEG_LIB_MK1\n-        sp->cinfo.c.bits_in_jsample = td->td_bitspersample;\n+\tsp->cinfo.c.bits_in_jsample = td->td_bitspersample;\n #endif\n+\n \tif ((((tif)->tif_flags & 0x00400U) != 0)) {\n \t\tif ((td->td_tilelength % (sp->v_sampling * DCTSIZE)) != 0) {\n \t\t\tTIFFErrorExt(tif->tif_clientdata, module,\n@@ -1704,30 +1690,25 @@\n \t\t}\n \t}\n \n-\t/* Create a JPEGTables field if appropriate */\n \tif (sp->jpegtablesmode & (JPEGTABLESMODE_QUANT|JPEGTABLESMODE_HUFF)) {\n                 if( sp->jpegtables == NULL\n                     || memcmp(sp->jpegtables,"\\0\\0\\0\\0\\0\\0\\0\\0\\0",8) == 0 )\n                 {\n                         if (!prepare_JPEGTables(tif))\n                                 return (0);\n-                        /* Mark the field present */\n-                        /* Can\'t use TIFFSetField since BEENWRITING is already set! */\n                         tif->tif_flags |= TIFF_DIRTYDIRECT;\n                         TIFFSetFieldBit(tif, FIELD_JPEGTABLES);\n                 }\n \t} else {\n-\t\t/* We do not support application-supplied JPEGTables, */\n-\t\t/* so mark the field not present */\n \t\tTIFFClrFieldBit(tif, FIELD_JPEGTABLES);\n \t}\n \n-\t/* Direct libjpeg output to libtiff\'s output buffer */\n \tTIFFjpeg_data_dest(sp, tif);\n \n \treturn (1);\n }\n \n+\n /*\n  * Set encoding state at the start of a strip or tile.\n  */\n', 'id': 20, 'location': '/data/vulnloc/libtiff/CVE-2017-7595/src/libtiff/tif_jpeg.c:1680:2'}, {'diff': "@@ -1571,6 +1571,7 @@\n \treturn (1);\n }\n \n+\n static int\n JPEGSetupEncode(TIFF* tif)\n {\n@@ -1629,7 +1630,7 @@\n \t\t * default value is inappropriate for YCbCr.  Fill in the\n \t\t * proper value if application didn't set it.\n \t\t */\n-\t\t{\n+\t\t {\n \t\t\tfloat *ref;\n \t\t\tif (!TIFFGetField(tif, TIFFTAG_REFERENCEBLACKWHITE,\n \t\t\t\t\t  &ref)) {\n@@ -1677,10 +1678,13 @@\n \t\t\t  (int) td->td_bitspersample);\n \t\treturn (0);\n \t}\n-\tsp->cinfo.c.data_precision = td->td_bitspersample;\n+\tif (td->td_bitspersample == 8 || td->td_bitspersample == 12) {\n+\t\tsp->cinfo.c.data_precision = td->td_bitspersample;\n #ifdef JPEG_LIB_MK1\n         sp->cinfo.c.bits_in_jsample = td->td_bitspersample;\n #endif\n+\t}\n+\n \tif ((((tif)->tif_flags & 0x00400U) != 0)) {\n \t\tif ((td->td_tilelength % (sp->v_sampling * DCTSIZE)) != 0) {\n \t\t\tTIFFErrorExt(tif->tif_clientdata, module,\n@@ -1728,6 +1732,7 @@\n \treturn (1);\n }\n \n+\n /*\n  * Set encoding state at the start of a strip or tile.\n  */\n", 'id': 21, 'location': '/data/vulnloc/libtiff/CVE-2017-7595/src/libtiff/tif_jpeg.c:1680:2'}, {'diff': '@@ -1571,6 +1571,7 @@\n \treturn (1);\n }\n \n+\n static int\n JPEGSetupEncode(TIFF* tif)\n {\n@@ -1677,6 +1678,13 @@\n \t\t\t  (int) td->td_bitspersample);\n \t\treturn (0);\n \t}\n+\n+\t/* Added safety check for data precision */\n+\tif (td->td_bitspersample < 1 || td->td_bitspersample > 16) {\n+\t\tTIFFErrorExt(tif->tif_clientdata, module, "BitsPerSample %d is out of valid range for JPEG", (int) td->td_bitspersample);\n+\t\treturn (0);\n+\t}\n+\n \tsp->cinfo.c.data_precision = td->td_bitspersample;\n #ifdef JPEG_LIB_MK1\n         sp->cinfo.c.bits_in_jsample = td->td_bitspersample;\n@@ -1728,6 +1736,7 @@\n \treturn (1);\n }\n \n+\n /*\n  * Set encoding state at the start of a strip or tile.\n  */\n', 'id': 22, 'location': '/data/vulnloc/libtiff/CVE-2017-7595/src/libtiff/tif_jpeg.c:1680:2'}, {'diff': '@@ -1571,6 +1571,7 @@\n \treturn (1);\n }\n \n+\n static int\n JPEGSetupEncode(TIFF* tif)\n {\n@@ -1677,7 +1678,13 @@\n \t\t\t  (int) td->td_bitspersample);\n \t\treturn (0);\n \t}\n-\tsp->cinfo.c.data_precision = td->td_bitspersample;\n+\t// Check for a valid depth before assigning to data_precision\n+\tif (td->td_bitspersample == 8 || td->td_bitspersample == 12) {\n+\t\tsp->cinfo.c.data_precision = td->td_bitspersample;\n+\t} else {\n+\t\tTIFFErrorExt(tif->tif_clientdata, module, "Invalid data precision");\n+\t\treturn (0);\n+\t}\n #ifdef JPEG_LIB_MK1\n         sp->cinfo.c.bits_in_jsample = td->td_bitspersample;\n #endif\n@@ -1728,6 +1735,7 @@\n \treturn (1);\n }\n \n+\n /*\n  * Set encoding state at the start of a strip or tile.\n  */\n', 'id': 23, 'location': '/data/vulnloc/libtiff/CVE-2017-7595/src/libtiff/tif_jpeg.c:1680:2'}, {'diff': '@@ -1571,6 +1571,7 @@\n \treturn (1);\n }\n \n+\n static int\n JPEGSetupEncode(TIFF* tif)\n {\n@@ -1677,7 +1678,12 @@\n \t\t\t  (int) td->td_bitspersample);\n \t\treturn (0);\n \t}\n-\tsp->cinfo.c.data_precision = td->td_bitspersample;\n+\tif (td->td_bitspersample == 8 || td->td_bitspersample == 12) {\n+\t\tsp->cinfo.c.data_precision = td->td_bitspersample;\n+\t} else {\n+\t\tTIFFErrorExt(tif->tif_clientdata, module, "Invalid BitsPerSample setting");\n+\t\treturn (0);\n+\t}\n #ifdef JPEG_LIB_MK1\n         sp->cinfo.c.bits_in_jsample = td->td_bitspersample;\n #endif\n@@ -1728,6 +1734,7 @@\n \treturn (1);\n }\n \n+\n /*\n  * Set encoding state at the start of a strip or tile.\n  */\n', 'id': 24, 'location': '/data/vulnloc/libtiff/CVE-2017-7595/src/libtiff/tif_jpeg.c:1680:2'}, {'diff': '@@ -1571,6 +1571,7 @@\n \treturn (1);\n }\n \n+\n static int\n JPEGSetupEncode(TIFF* tif)\n {\n@@ -1668,7 +1669,7 @@\n \t */\n #ifdef JPEG_LIB_MK1\n         /* BITS_IN_JSAMPLE now permits 8 and 12 --- dgilbert */\n-\tif (td->td_bitspersample != 8 && td->td_bitspersample != 12) \n+\tif (td->td_bitspersample < 8 || td->td_bitspersample > 12) \n #else\n \tif (td->td_bitspersample != BITS_IN_JSAMPLE )\n #endif\n@@ -1728,6 +1729,7 @@\n \treturn (1);\n }\n \n+\n /*\n  * Set encoding state at the start of a strip or tile.\n  */\n', 'id': 25, 'location': '/data/vulnloc/libtiff/CVE-2017-7595/src/libtiff/tif_jpeg.c:1673:2'}, {'diff': '@@ -1571,6 +1571,7 @@\n \treturn (1);\n }\n \n+\n static int\n JPEGSetupEncode(TIFF* tif)\n {\n@@ -1668,7 +1669,8 @@\n \t */\n #ifdef JPEG_LIB_MK1\n         /* BITS_IN_JSAMPLE now permits 8 and 12 --- dgilbert */\n-\tif (td->td_bitspersample != 8 && td->td_bitspersample != 12) \n+\tif (td->td_bitspersample != 8 && td->td_bitspersample != 12 && \n+\t    td->td_bitspersample != BITS_IN_JSAMPLE)\n #else\n \tif (td->td_bitspersample != BITS_IN_JSAMPLE )\n #endif\n@@ -1728,6 +1730,7 @@\n \treturn (1);\n }\n \n+\n /*\n  * Set encoding state at the start of a strip or tile.\n  */\n', 'id': 26, 'location': '/data/vulnloc/libtiff/CVE-2017-7595/src/libtiff/tif_jpeg.c:1673:2'}, {'diff': '@@ -1571,6 +1571,7 @@\n \treturn (1);\n }\n \n+\n static int\n JPEGSetupEncode(TIFF* tif)\n {\n@@ -1590,89 +1591,13 @@\n \n \tsp->photometric = td->td_photometric;\n \n-\t/*\n-\t * Initialize all JPEG parameters to default values.\n-\t * Note that jpeg_set_defaults needs legal values for\n-\t * in_color_space and input_components.\n-\t */\n-\tif (td->td_planarconfig == PLANARCONFIG_CONTIG) {\n-\t\tsp->cinfo.c.input_components = td->td_samplesperpixel;\n-\t\tif (sp->photometric == PHOTOMETRIC_YCBCR) {\n-\t\t\tif (sp->jpegcolormode == JPEGCOLORMODE_RGB) {\n-\t\t\t\tsp->cinfo.c.in_color_space = JCS_RGB;\n-\t\t\t} else {\n-\t\t\t\tsp->cinfo.c.in_color_space = JCS_YCbCr;\n-\t\t\t}\n-\t\t} else {\n-\t\t\tif ((td->td_photometric == PHOTOMETRIC_MINISWHITE || td->td_photometric == PHOTOMETRIC_MINISBLACK) && td->td_samplesperpixel == 1)\n-\t\t\t\tsp->cinfo.c.in_color_space = JCS_GRAYSCALE;\n-\t\t\telse if (td->td_photometric == PHOTOMETRIC_RGB && td->td_samplesperpixel == 3)\n-\t\t\t\tsp->cinfo.c.in_color_space = JCS_RGB;\n-\t\t\telse if (td->td_photometric == PHOTOMETRIC_SEPARATED && td->td_samplesperpixel == 4)\n-\t\t\t\tsp->cinfo.c.in_color_space = JCS_CMYK;\n-\t\t\telse\n-\t\t\t\tsp->cinfo.c.in_color_space = JCS_UNKNOWN;\n-\t\t}\n-\t} else {\n-\t\tsp->cinfo.c.input_components = 1;\n-\t\tsp->cinfo.c.in_color_space = JCS_UNKNOWN;\n-\t}\n-\tif (!TIFFjpeg_set_defaults(sp))\n-\t\treturn (0);\n-\t/* Set per-file parameters */\n-\tswitch (sp->photometric) {\n-\tcase PHOTOMETRIC_YCBCR:\n-\t\tsp->h_sampling = td->td_ycbcrsubsampling[0];\n-\t\tsp->v_sampling = td->td_ycbcrsubsampling[1];\n-\t\t/*\n-\t\t * A ReferenceBlackWhite field *must* be present since the\n-\t\t * default value is inappropriate for YCbCr.  Fill in the\n-\t\t * proper value if application didn\'t set it.\n-\t\t */\n-\t\t{\n-\t\t\tfloat *ref;\n-\t\t\tif (!TIFFGetField(tif, TIFFTAG_REFERENCEBLACKWHITE,\n-\t\t\t\t\t  &ref)) {\n-\t\t\t\tfloat refbw[6];\n-\t\t\t\tlong top = 1L << td->td_bitspersample;\n-\t\t\t\trefbw[0] = 0;\n-\t\t\t\trefbw[1] = (float)(top-1L);\n-\t\t\t\trefbw[2] = (float)(top>>1);\n-\t\t\t\trefbw[3] = refbw[1];\n-\t\t\t\trefbw[4] = refbw[2];\n-\t\t\t\trefbw[5] = refbw[1];\n-\t\t\t\tTIFFSetField(tif, TIFFTAG_REFERENCEBLACKWHITE,\n-\t\t\t\t\t     refbw);\n-\t\t\t}\n-\t\t}\n-\t\tbreak;\n-\tcase PHOTOMETRIC_PALETTE:\t\t/* disallowed by Tech Note */\n-\tcase PHOTOMETRIC_MASK:\n-\t\tTIFFErrorExt(tif->tif_clientdata, module,\n-\t\t\t  "PhotometricInterpretation %d not allowed for JPEG",\n-\t\t\t  (int) sp->photometric);\n+\tif (td->td_bitspersample < 1 || td->td_bitspersample > 16) {\n+\t\tTIFFErrorExt(tif->tif_clientdata, module, "BitsPerSample %d not allowed. Must be between 1 and 16.",\n+\t\t\t  (int) td->td_bitspersample);\n \t\treturn (0);\n-\tdefault:\n-\t\t/* TIFF 6.0 forbids subsampling of all other color spaces */\n-\t\tsp->h_sampling = 1;\n-\t\tsp->v_sampling = 1;\n-\t\tbreak;\n \t}\n \n-\t/* Verify miscellaneous parameters */\n-\n-\t/*\n-\t * This would need work if libtiff ever supports different\n-\t * depths for different components, or if libjpeg ever supports\n-\t * run-time selection of depth.  Neither is imminent.\n-\t */\n-#ifdef JPEG_LIB_MK1\n-        /* BITS_IN_JSAMPLE now permits 8 and 12 --- dgilbert */\n-\tif (td->td_bitspersample != 8 && td->td_bitspersample != 12) \n-#else\n-\tif (td->td_bitspersample != BITS_IN_JSAMPLE )\n-#endif\n-\t{\n+\tif (td->td_bitspersample != BITS_IN_JSAMPLE) {\n \t\tTIFFErrorExt(tif->tif_clientdata, module, "BitsPerSample %d not allowed for JPEG",\n \t\t\t  (int) td->td_bitspersample);\n \t\treturn (0);\n@@ -1728,6 +1653,7 @@\n \treturn (1);\n }\n \n+\n /*\n  * Set encoding state at the start of a strip or tile.\n  */\n', 'id': 27, 'location': '/data/vulnloc/libtiff/CVE-2017-7595/src/libtiff/tif_jpeg.c:1673:2'}, {'diff': '@@ -1571,6 +1571,7 @@\n \treturn (1);\n }\n \n+\n static int\n JPEGSetupEncode(TIFF* tif)\n {\n@@ -1583,18 +1584,13 @@\n             return TIFFReInitJPEG_12( tif, COMPRESSION_JPEG, 1 );\n #endif\n \n-        JPEGInitializeLibJPEG( tif, FALSE );\n+\tJPEGInitializeLibJPEG( tif, FALSE );\n \n \tassert(sp != NULL);\n \tassert(!sp->cinfo.comm.is_decompressor);\n \n \tsp->photometric = td->td_photometric;\n \n-\t/*\n-\t * Initialize all JPEG parameters to default values.\n-\t * Note that jpeg_set_defaults needs legal values for\n-\t * in_color_space and input_components.\n-\t */\n \tif (td->td_planarconfig == PLANARCONFIG_CONTIG) {\n \t\tsp->cinfo.c.input_components = td->td_samplesperpixel;\n \t\tif (sp->photometric == PHOTOMETRIC_YCBCR) {\n@@ -1619,16 +1615,10 @@\n \t}\n \tif (!TIFFjpeg_set_defaults(sp))\n \t\treturn (0);\n-\t/* Set per-file parameters */\n \tswitch (sp->photometric) {\n \tcase PHOTOMETRIC_YCBCR:\n \t\tsp->h_sampling = td->td_ycbcrsubsampling[0];\n \t\tsp->v_sampling = td->td_ycbcrsubsampling[1];\n-\t\t/*\n-\t\t * A ReferenceBlackWhite field *must* be present since the\n-\t\t * default value is inappropriate for YCbCr.  Fill in the\n-\t\t * proper value if application didn\'t set it.\n-\t\t */\n \t\t{\n \t\t\tfloat *ref;\n \t\t\tif (!TIFFGetField(tif, TIFFTAG_REFERENCEBLACKWHITE,\n@@ -1653,24 +1643,15 @@\n \t\t\t  (int) sp->photometric);\n \t\treturn (0);\n \tdefault:\n-\t\t/* TIFF 6.0 forbids subsampling of all other color spaces */\n \t\tsp->h_sampling = 1;\n \t\tsp->v_sampling = 1;\n \t\tbreak;\n \t}\n \n-\t/* Verify miscellaneous parameters */\n-\n-\t/*\n-\t * This would need work if libtiff ever supports different\n-\t * depths for different components, or if libjpeg ever supports\n-\t * run-time selection of depth.  Neither is imminent.\n-\t */\n #ifdef JPEG_LIB_MK1\n-        /* BITS_IN_JSAMPLE now permits 8 and 12 --- dgilbert */\n \tif (td->td_bitspersample != 8 && td->td_bitspersample != 12) \n #else\n-\tif (td->td_bitspersample != BITS_IN_JSAMPLE )\n+\tif (td->td_bitspersample != BITS_IN_JSAMPLE && td->td_bitspersample != 12)\n #endif\n \t{\n \t\tTIFFErrorExt(tif->tif_clientdata, module, "BitsPerSample %d not allowed for JPEG",\n@@ -1679,7 +1660,7 @@\n \t}\n \tsp->cinfo.c.data_precision = td->td_bitspersample;\n #ifdef JPEG_LIB_MK1\n-        sp->cinfo.c.bits_in_jsample = td->td_bitspersample;\n+\tsp->cinfo.c.bits_in_jsample = td->td_bitspersample;\n #endif\n \tif ((((tif)->tif_flags & 0x00400U) != 0)) {\n \t\tif ((td->td_tilelength % (sp->v_sampling * DCTSIZE)) != 0) {\n@@ -1704,30 +1685,25 @@\n \t\t}\n \t}\n \n-\t/* Create a JPEGTables field if appropriate */\n \tif (sp->jpegtablesmode & (JPEGTABLESMODE_QUANT|JPEGTABLESMODE_HUFF)) {\n                 if( sp->jpegtables == NULL\n                     || memcmp(sp->jpegtables,"\\0\\0\\0\\0\\0\\0\\0\\0\\0",8) == 0 )\n                 {\n                         if (!prepare_JPEGTables(tif))\n                                 return (0);\n-                        /* Mark the field present */\n-                        /* Can\'t use TIFFSetField since BEENWRITING is already set! */\n                         tif->tif_flags |= TIFF_DIRTYDIRECT;\n                         TIFFSetFieldBit(tif, FIELD_JPEGTABLES);\n                 }\n \t} else {\n-\t\t/* We do not support application-supplied JPEGTables, */\n-\t\t/* so mark the field not present */\n \t\tTIFFClrFieldBit(tif, FIELD_JPEGTABLES);\n \t}\n \n-\t/* Direct libjpeg output to libtiff\'s output buffer */\n \tTIFFjpeg_data_dest(sp, tif);\n \n \treturn (1);\n }\n \n+\n /*\n  * Set encoding state at the start of a strip or tile.\n  */\n', 'id': 28, 'location': '/data/vulnloc/libtiff/CVE-2017-7595/src/libtiff/tif_jpeg.c:1673:2'}, {'diff': '@@ -1571,6 +1571,7 @@\n \treturn (1);\n }\n \n+\n static int\n JPEGSetupEncode(TIFF* tif)\n {\n@@ -1590,89 +1591,7 @@\n \n \tsp->photometric = td->td_photometric;\n \n-\t/*\n-\t * Initialize all JPEG parameters to default values.\n-\t * Note that jpeg_set_defaults needs legal values for\n-\t * in_color_space and input_components.\n-\t */\n-\tif (td->td_planarconfig == PLANARCONFIG_CONTIG) {\n-\t\tsp->cinfo.c.input_components = td->td_samplesperpixel;\n-\t\tif (sp->photometric == PHOTOMETRIC_YCBCR) {\n-\t\t\tif (sp->jpegcolormode == JPEGCOLORMODE_RGB) {\n-\t\t\t\tsp->cinfo.c.in_color_space = JCS_RGB;\n-\t\t\t} else {\n-\t\t\t\tsp->cinfo.c.in_color_space = JCS_YCbCr;\n-\t\t\t}\n-\t\t} else {\n-\t\t\tif ((td->td_photometric == PHOTOMETRIC_MINISWHITE || td->td_photometric == PHOTOMETRIC_MINISBLACK) && td->td_samplesperpixel == 1)\n-\t\t\t\tsp->cinfo.c.in_color_space = JCS_GRAYSCALE;\n-\t\t\telse if (td->td_photometric == PHOTOMETRIC_RGB && td->td_samplesperpixel == 3)\n-\t\t\t\tsp->cinfo.c.in_color_space = JCS_RGB;\n-\t\t\telse if (td->td_photometric == PHOTOMETRIC_SEPARATED && td->td_samplesperpixel == 4)\n-\t\t\t\tsp->cinfo.c.in_color_space = JCS_CMYK;\n-\t\t\telse\n-\t\t\t\tsp->cinfo.c.in_color_space = JCS_UNKNOWN;\n-\t\t}\n-\t} else {\n-\t\tsp->cinfo.c.input_components = 1;\n-\t\tsp->cinfo.c.in_color_space = JCS_UNKNOWN;\n-\t}\n-\tif (!TIFFjpeg_set_defaults(sp))\n-\t\treturn (0);\n-\t/* Set per-file parameters */\n-\tswitch (sp->photometric) {\n-\tcase PHOTOMETRIC_YCBCR:\n-\t\tsp->h_sampling = td->td_ycbcrsubsampling[0];\n-\t\tsp->v_sampling = td->td_ycbcrsubsampling[1];\n-\t\t/*\n-\t\t * A ReferenceBlackWhite field *must* be present since the\n-\t\t * default value is inappropriate for YCbCr.  Fill in the\n-\t\t * proper value if application didn\'t set it.\n-\t\t */\n-\t\t{\n-\t\t\tfloat *ref;\n-\t\t\tif (!TIFFGetField(tif, TIFFTAG_REFERENCEBLACKWHITE,\n-\t\t\t\t\t  &ref)) {\n-\t\t\t\tfloat refbw[6];\n-\t\t\t\tlong top = 1L << td->td_bitspersample;\n-\t\t\t\trefbw[0] = 0;\n-\t\t\t\trefbw[1] = (float)(top-1L);\n-\t\t\t\trefbw[2] = (float)(top>>1);\n-\t\t\t\trefbw[3] = refbw[1];\n-\t\t\t\trefbw[4] = refbw[2];\n-\t\t\t\trefbw[5] = refbw[1];\n-\t\t\t\tTIFFSetField(tif, TIFFTAG_REFERENCEBLACKWHITE,\n-\t\t\t\t\t     refbw);\n-\t\t\t}\n-\t\t}\n-\t\tbreak;\n-\tcase PHOTOMETRIC_PALETTE:\t\t/* disallowed by Tech Note */\n-\tcase PHOTOMETRIC_MASK:\n-\t\tTIFFErrorExt(tif->tif_clientdata, module,\n-\t\t\t  "PhotometricInterpretation %d not allowed for JPEG",\n-\t\t\t  (int) sp->photometric);\n-\t\treturn (0);\n-\tdefault:\n-\t\t/* TIFF 6.0 forbids subsampling of all other color spaces */\n-\t\tsp->h_sampling = 1;\n-\t\tsp->v_sampling = 1;\n-\t\tbreak;\n-\t}\n-\n-\t/* Verify miscellaneous parameters */\n-\n-\t/*\n-\t * This would need work if libtiff ever supports different\n-\t * depths for different components, or if libjpeg ever supports\n-\t * run-time selection of depth.  Neither is imminent.\n-\t */\n-#ifdef JPEG_LIB_MK1\n-        /* BITS_IN_JSAMPLE now permits 8 and 12 --- dgilbert */\n-\tif (td->td_bitspersample != 8 && td->td_bitspersample != 12) \n-#else\n-\tif (td->td_bitspersample != BITS_IN_JSAMPLE )\n-#endif\n-\t{\n+\tif (td->td_bitspersample != 8 && td->td_bitspersample != 12) {\n \t\tTIFFErrorExt(tif->tif_clientdata, module, "BitsPerSample %d not allowed for JPEG",\n \t\t\t  (int) td->td_bitspersample);\n \t\treturn (0);\n@@ -1711,23 +1630,19 @@\n                 {\n                         if (!prepare_JPEGTables(tif))\n                                 return (0);\n-                        /* Mark the field present */\n-                        /* Can\'t use TIFFSetField since BEENWRITING is already set! */\n                         tif->tif_flags |= TIFF_DIRTYDIRECT;\n                         TIFFSetFieldBit(tif, FIELD_JPEGTABLES);\n                 }\n \t} else {\n-\t\t/* We do not support application-supplied JPEGTables, */\n-\t\t/* so mark the field not present */\n \t\tTIFFClrFieldBit(tif, FIELD_JPEGTABLES);\n \t}\n \n-\t/* Direct libjpeg output to libtiff\'s output buffer */\n \tTIFFjpeg_data_dest(sp, tif);\n \n \treturn (1);\n }\n \n+\n /*\n  * Set encoding state at the start of a strip or tile.\n  */\n', 'id': 29, 'location': '/data/vulnloc/libtiff/CVE-2017-7595/src/libtiff/tif_jpeg.c:1673:2'}, {'diff': '@@ -1571,6 +1571,7 @@\n \treturn (1);\n }\n \n+\n static int\n JPEGSetupEncode(TIFF* tif)\n {\n@@ -1641,8 +1642,14 @@\n \t\t\t\trefbw[3] = refbw[1];\n \t\t\t\trefbw[4] = refbw[2];\n \t\t\t\trefbw[5] = refbw[1];\n-\t\t\t\tTIFFSetField(tif, TIFFTAG_REFERENCEBLACKWHITE,\n+\t\t\t\tif(refbw[1] >= 0) { // Validate the value before setting it\n+\t\t\t\t\tTIFFSetField(tif, TIFFTAG_REFERENCEBLACKWHITE,\n \t\t\t\t\t     refbw);\n+\t\t\t\t} else {\n+\t\t\t\t\tTIFFErrorExt(tif->tif_clientdata, module,\n+\t\t\t\t\t\t  "Invalid value for ReferenceBlackWhite");\n+\t\t\t\t\treturn (0);\n+\t\t\t\t}\n \t\t\t}\n \t\t}\n \t\tbreak;\n@@ -1728,6 +1735,7 @@\n \treturn (1);\n }\n \n+\n /*\n  * Set encoding state at the start of a strip or tile.\n  */\n', 'id': 30, 'location': '/data/vulnloc/libtiff/CVE-2017-7595/src/libtiff/tif_jpeg.c:1644:5'}, {'diff': '@@ -1571,6 +1571,7 @@\n \treturn (1);\n }\n \n+\n static int\n JPEGSetupEncode(TIFF* tif)\n {\n@@ -1590,11 +1591,6 @@\n \n \tsp->photometric = td->td_photometric;\n \n-\t/*\n-\t * Initialize all JPEG parameters to default values.\n-\t * Note that jpeg_set_defaults needs legal values for\n-\t * in_color_space and input_components.\n-\t */\n \tif (td->td_planarconfig == PLANARCONFIG_CONTIG) {\n \t\tsp->cinfo.c.input_components = td->td_samplesperpixel;\n \t\tif (sp->photometric == PHOTOMETRIC_YCBCR) {\n@@ -1619,20 +1615,13 @@\n \t}\n \tif (!TIFFjpeg_set_defaults(sp))\n \t\treturn (0);\n-\t/* Set per-file parameters */\n \tswitch (sp->photometric) {\n \tcase PHOTOMETRIC_YCBCR:\n \t\tsp->h_sampling = td->td_ycbcrsubsampling[0];\n \t\tsp->v_sampling = td->td_ycbcrsubsampling[1];\n-\t\t/*\n-\t\t * A ReferenceBlackWhite field *must* be present since the\n-\t\t * default value is inappropriate for YCbCr.  Fill in the\n-\t\t * proper value if application didn\'t set it.\n-\t\t */\n \t\t{\n \t\t\tfloat *ref;\n-\t\t\tif (!TIFFGetField(tif, TIFFTAG_REFERENCEBLACKWHITE,\n-\t\t\t\t\t  &ref)) {\n+\t\t\tif (!TIFFGetField(tif, TIFFTAG_REFERENCEBLACKWHITE, &ref)) {\n \t\t\t\tfloat refbw[6];\n \t\t\t\tlong top = 1L << td->td_bitspersample;\n \t\t\t\trefbw[0] = 0;\n@@ -1641,8 +1630,15 @@\n \t\t\t\trefbw[3] = refbw[1];\n \t\t\t\trefbw[4] = refbw[2];\n \t\t\t\trefbw[5] = refbw[1];\n-\t\t\t\tTIFFSetField(tif, TIFFTAG_REFERENCEBLACKWHITE,\n-\t\t\t\t\t     refbw);\n+\t\t\t\t// Ensure correct memory allocation for reference black and white field\n+\t\t\t\tfloat *temp_refbw = (float*)malloc(6 * sizeof(float));\n+\t\t\t\tif (temp_refbw) {\n+\t\t\t\t\tmemcpy(temp_refbw, refbw, 6 * sizeof(float));\n+\t\t\t\t\tTIFFSetField(tif, TIFFTAG_REFERENCEBLACKWHITE, temp_refbw);\n+\t\t\t\t} else {\n+\t\t\t\t\tTIFFErrorExt(tif->tif_clientdata, module, "Memory allocation failed for ReferenceBlackWhite");\n+\t\t\t\t\treturn (0);\n+\t\t\t\t}\n \t\t\t}\n \t\t}\n \t\tbreak;\n@@ -1653,21 +1649,12 @@\n \t\t\t  (int) sp->photometric);\n \t\treturn (0);\n \tdefault:\n-\t\t/* TIFF 6.0 forbids subsampling of all other color spaces */\n \t\tsp->h_sampling = 1;\n \t\tsp->v_sampling = 1;\n \t\tbreak;\n \t}\n \n-\t/* Verify miscellaneous parameters */\n-\n-\t/*\n-\t * This would need work if libtiff ever supports different\n-\t * depths for different components, or if libjpeg ever supports\n-\t * run-time selection of depth.  Neither is imminent.\n-\t */\n #ifdef JPEG_LIB_MK1\n-        /* BITS_IN_JSAMPLE now permits 8 and 12 --- dgilbert */\n \tif (td->td_bitspersample != 8 && td->td_bitspersample != 12) \n #else\n \tif (td->td_bitspersample != BITS_IN_JSAMPLE )\n@@ -1679,7 +1666,7 @@\n \t}\n \tsp->cinfo.c.data_precision = td->td_bitspersample;\n #ifdef JPEG_LIB_MK1\n-        sp->cinfo.c.bits_in_jsample = td->td_bitspersample;\n+\tsp->cinfo.c.bits_in_jsample = td->td_bitspersample;\n #endif\n \tif ((((tif)->tif_flags & 0x00400U) != 0)) {\n \t\tif ((td->td_tilelength % (sp->v_sampling * DCTSIZE)) != 0) {\n@@ -1704,30 +1691,25 @@\n \t\t}\n \t}\n \n-\t/* Create a JPEGTables field if appropriate */\n \tif (sp->jpegtablesmode & (JPEGTABLESMODE_QUANT|JPEGTABLESMODE_HUFF)) {\n                 if( sp->jpegtables == NULL\n                     || memcmp(sp->jpegtables,"\\0\\0\\0\\0\\0\\0\\0\\0\\0",8) == 0 )\n                 {\n                         if (!prepare_JPEGTables(tif))\n                                 return (0);\n-                        /* Mark the field present */\n-                        /* Can\'t use TIFFSetField since BEENWRITING is already set! */\n                         tif->tif_flags |= TIFF_DIRTYDIRECT;\n                         TIFFSetFieldBit(tif, FIELD_JPEGTABLES);\n                 }\n \t} else {\n-\t\t/* We do not support application-supplied JPEGTables, */\n-\t\t/* so mark the field not present */\n \t\tTIFFClrFieldBit(tif, FIELD_JPEGTABLES);\n \t}\n \n-\t/* Direct libjpeg output to libtiff\'s output buffer */\n \tTIFFjpeg_data_dest(sp, tif);\n \n \treturn (1);\n }\n \n+\n /*\n  * Set encoding state at the start of a strip or tile.\n  */\n', 'id': 31, 'location': '/data/vulnloc/libtiff/CVE-2017-7595/src/libtiff/tif_jpeg.c:1644:5'}, {'diff': '@@ -1571,6 +1571,7 @@\n \treturn (1);\n }\n \n+\n static int\n JPEGSetupEncode(TIFF* tif)\n {\n@@ -1633,6 +1634,10 @@\n \t\t\tfloat *ref;\n \t\t\tif (!TIFFGetField(tif, TIFFTAG_REFERENCEBLACKWHITE,\n \t\t\t\t\t  &ref)) {\n+\t\t\t\tif (td->td_bitspersample < 8 || td->td_bitspersample > 12) {\n+\t\t\t\t\tTIFFErrorExt(tif->tif_clientdata, module, "Invalid BitsPerSample %d for YCbCr", (int) td->td_bitspersample);\n+\t\t\t\t\treturn (0);\n+\t\t\t\t}\n \t\t\t\tfloat refbw[6];\n \t\t\t\tlong top = 1L << td->td_bitspersample;\n \t\t\t\trefbw[0] = 0;\n@@ -1641,8 +1646,7 @@\n \t\t\t\trefbw[3] = refbw[1];\n \t\t\t\trefbw[4] = refbw[2];\n \t\t\t\trefbw[5] = refbw[1];\n-\t\t\t\tTIFFSetField(tif, TIFFTAG_REFERENCEBLACKWHITE,\n-\t\t\t\t\t     refbw);\n+\t\t\t\tTIFFSetField(tif, TIFFTAG_REFERENCEBLACKWHITE, refbw);\n \t\t\t}\n \t\t}\n \t\tbreak;\n@@ -1728,6 +1732,7 @@\n \treturn (1);\n }\n \n+\n /*\n  * Set encoding state at the start of a strip or tile.\n  */\n', 'id': 32, 'location': '/data/vulnloc/libtiff/CVE-2017-7595/src/libtiff/tif_jpeg.c:1644:5'}, {'diff': '@@ -1571,6 +1571,7 @@\n \treturn (1);\n }\n \n+\n static int\n JPEGSetupEncode(TIFF* tif)\n {\n@@ -1590,11 +1591,6 @@\n \n \tsp->photometric = td->td_photometric;\n \n-\t/*\n-\t * Initialize all JPEG parameters to default values.\n-\t * Note that jpeg_set_defaults needs legal values for\n-\t * in_color_space and input_components.\n-\t */\n \tif (td->td_planarconfig == PLANARCONFIG_CONTIG) {\n \t\tsp->cinfo.c.input_components = td->td_samplesperpixel;\n \t\tif (sp->photometric == PHOTOMETRIC_YCBCR) {\n@@ -1619,20 +1615,13 @@\n \t}\n \tif (!TIFFjpeg_set_defaults(sp))\n \t\treturn (0);\n-\t/* Set per-file parameters */\n \tswitch (sp->photometric) {\n \tcase PHOTOMETRIC_YCBCR:\n \t\tsp->h_sampling = td->td_ycbcrsubsampling[0];\n \t\tsp->v_sampling = td->td_ycbcrsubsampling[1];\n-\t\t/*\n-\t\t * A ReferenceBlackWhite field *must* be present since the\n-\t\t * default value is inappropriate for YCbCr.  Fill in the\n-\t\t * proper value if application didn\'t set it.\n-\t\t */\n \t\t{\n \t\t\tfloat *ref;\n-\t\t\tif (!TIFFGetField(tif, TIFFTAG_REFERENCEBLACKWHITE,\n-\t\t\t\t\t  &ref)) {\n+\t\t\tif (!TIFFGetField(tif, TIFFTAG_REFERENCEBLACKWHITE, &ref)) {\n \t\t\t\tfloat refbw[6];\n \t\t\t\tlong top = 1L << td->td_bitspersample;\n \t\t\t\trefbw[0] = 0;\n@@ -1641,8 +1630,10 @@\n \t\t\t\trefbw[3] = refbw[1];\n \t\t\t\trefbw[4] = refbw[2];\n \t\t\t\trefbw[5] = refbw[1];\n-\t\t\t\tTIFFSetField(tif, TIFFTAG_REFERENCEBLACKWHITE,\n-\t\t\t\t\t     refbw);\n+\t\t\t\tif (!TIFFSetField(tif, TIFFTAG_REFERENCEBLACKWHITE, refbw)) {\n+\t\t\t\t\tTIFFErrorExt(tif->tif_clientdata, module, "Failed to set ReferenceBlackWhite field.");\n+\t\t\t\t\treturn (0);\n+\t\t\t\t}\n \t\t\t}\n \t\t}\n \t\tbreak;\n@@ -1653,22 +1644,13 @@\n \t\t\t  (int) sp->photometric);\n \t\treturn (0);\n \tdefault:\n-\t\t/* TIFF 6.0 forbids subsampling of all other color spaces */\n \t\tsp->h_sampling = 1;\n \t\tsp->v_sampling = 1;\n \t\tbreak;\n \t}\n \n-\t/* Verify miscellaneous parameters */\n-\n-\t/*\n-\t * This would need work if libtiff ever supports different\n-\t * depths for different components, or if libjpeg ever supports\n-\t * run-time selection of depth.  Neither is imminent.\n-\t */\n #ifdef JPEG_LIB_MK1\n-        /* BITS_IN_JSAMPLE now permits 8 and 12 --- dgilbert */\n-\tif (td->td_bitspersample != 8 && td->td_bitspersample != 12) \n+        if (td->td_bitspersample != 8 && td->td_bitspersample != 12) \n #else\n \tif (td->td_bitspersample != BITS_IN_JSAMPLE )\n #endif\n@@ -1704,30 +1686,25 @@\n \t\t}\n \t}\n \n-\t/* Create a JPEGTables field if appropriate */\n \tif (sp->jpegtablesmode & (JPEGTABLESMODE_QUANT|JPEGTABLESMODE_HUFF)) {\n                 if( sp->jpegtables == NULL\n                     || memcmp(sp->jpegtables,"\\0\\0\\0\\0\\0\\0\\0\\0\\0",8) == 0 )\n                 {\n                         if (!prepare_JPEGTables(tif))\n                                 return (0);\n-                        /* Mark the field present */\n-                        /* Can\'t use TIFFSetField since BEENWRITING is already set! */\n                         tif->tif_flags |= TIFF_DIRTYDIRECT;\n                         TIFFSetFieldBit(tif, FIELD_JPEGTABLES);\n                 }\n \t} else {\n-\t\t/* We do not support application-supplied JPEGTables, */\n-\t\t/* so mark the field not present */\n \t\tTIFFClrFieldBit(tif, FIELD_JPEGTABLES);\n \t}\n \n-\t/* Direct libjpeg output to libtiff\'s output buffer */\n \tTIFFjpeg_data_dest(sp, tif);\n \n \treturn (1);\n }\n \n+\n /*\n  * Set encoding state at the start of a strip or tile.\n  */\n', 'id': 33, 'location': '/data/vulnloc/libtiff/CVE-2017-7595/src/libtiff/tif_jpeg.c:1644:5'}, {'diff': '@@ -1571,12 +1571,13 @@\n \treturn (1);\n }\n \n+\n static int\n JPEGSetupEncode(TIFF* tif)\n {\n-\tJPEGState* sp = JState(tif);\n-\tTIFFDirectory *td = &tif->tif_dir;\n-\tstatic const char module[] = "JPEGSetupEncode";\n+    JPEGState* sp = JState(tif);\n+    TIFFDirectory *td = &tif->tif_dir;\n+    static const char module[] = "JPEGSetupEncode";\n \n #if defined(JPEG_DUAL_MODE_8_12) && !defined(TIFFInitJPEG)\n         if( tif->tif_dir.td_bitspersample == 12 )\n@@ -1585,127 +1586,130 @@\n \n         JPEGInitializeLibJPEG( tif, FALSE );\n \n-\tassert(sp != NULL);\n-\tassert(!sp->cinfo.comm.is_decompressor);\n+    assert(sp != NULL);\n+    assert(!sp->cinfo.comm.is_decompressor);\n \n-\tsp->photometric = td->td_photometric;\n+    sp->photometric = td->td_photometric;\n \n-\t/*\n-\t * Initialize all JPEG parameters to default values.\n-\t * Note that jpeg_set_defaults needs legal values for\n-\t * in_color_space and input_components.\n-\t */\n-\tif (td->td_planarconfig == PLANARCONFIG_CONTIG) {\n-\t\tsp->cinfo.c.input_components = td->td_samplesperpixel;\n-\t\tif (sp->photometric == PHOTOMETRIC_YCBCR) {\n-\t\t\tif (sp->jpegcolormode == JPEGCOLORMODE_RGB) {\n-\t\t\t\tsp->cinfo.c.in_color_space = JCS_RGB;\n-\t\t\t} else {\n-\t\t\t\tsp->cinfo.c.in_color_space = JCS_YCbCr;\n-\t\t\t}\n-\t\t} else {\n-\t\t\tif ((td->td_photometric == PHOTOMETRIC_MINISWHITE || td->td_photometric == PHOTOMETRIC_MINISBLACK) && td->td_samplesperpixel == 1)\n-\t\t\t\tsp->cinfo.c.in_color_space = JCS_GRAYSCALE;\n-\t\t\telse if (td->td_photometric == PHOTOMETRIC_RGB && td->td_samplesperpixel == 3)\n-\t\t\t\tsp->cinfo.c.in_color_space = JCS_RGB;\n-\t\t\telse if (td->td_photometric == PHOTOMETRIC_SEPARATED && td->td_samplesperpixel == 4)\n-\t\t\t\tsp->cinfo.c.in_color_space = JCS_CMYK;\n-\t\t\telse\n-\t\t\t\tsp->cinfo.c.in_color_space = JCS_UNKNOWN;\n-\t\t}\n-\t} else {\n-\t\tsp->cinfo.c.input_components = 1;\n-\t\tsp->cinfo.c.in_color_space = JCS_UNKNOWN;\n-\t}\n-\tif (!TIFFjpeg_set_defaults(sp))\n-\t\treturn (0);\n-\t/* Set per-file parameters */\n-\tswitch (sp->photometric) {\n-\tcase PHOTOMETRIC_YCBCR:\n-\t\tsp->h_sampling = td->td_ycbcrsubsampling[0];\n-\t\tsp->v_sampling = td->td_ycbcrsubsampling[1];\n-\t\t/*\n-\t\t * A ReferenceBlackWhite field *must* be present since the\n-\t\t * default value is inappropriate for YCbCr.  Fill in the\n-\t\t * proper value if application didn\'t set it.\n-\t\t */\n-\t\t{\n-\t\t\tfloat *ref;\n-\t\t\tif (!TIFFGetField(tif, TIFFTAG_REFERENCEBLACKWHITE,\n-\t\t\t\t\t  &ref)) {\n-\t\t\t\tfloat refbw[6];\n-\t\t\t\tlong top = 1L << td->td_bitspersample;\n-\t\t\t\trefbw[0] = 0;\n-\t\t\t\trefbw[1] = (float)(top-1L);\n-\t\t\t\trefbw[2] = (float)(top>>1);\n-\t\t\t\trefbw[3] = refbw[1];\n-\t\t\t\trefbw[4] = refbw[2];\n-\t\t\t\trefbw[5] = refbw[1];\n-\t\t\t\tTIFFSetField(tif, TIFFTAG_REFERENCEBLACKWHITE,\n-\t\t\t\t\t     refbw);\n-\t\t\t}\n-\t\t}\n-\t\tbreak;\n-\tcase PHOTOMETRIC_PALETTE:\t\t/* disallowed by Tech Note */\n-\tcase PHOTOMETRIC_MASK:\n-\t\tTIFFErrorExt(tif->tif_clientdata, module,\n-\t\t\t  "PhotometricInterpretation %d not allowed for JPEG",\n-\t\t\t  (int) sp->photometric);\n-\t\treturn (0);\n-\tdefault:\n-\t\t/* TIFF 6.0 forbids subsampling of all other color spaces */\n-\t\tsp->h_sampling = 1;\n-\t\tsp->v_sampling = 1;\n-\t\tbreak;\n-\t}\n-\n-\t/* Verify miscellaneous parameters */\n-\n-\t/*\n-\t * This would need work if libtiff ever supports different\n-\t * depths for different components, or if libjpeg ever supports\n-\t * run-time selection of depth.  Neither is imminent.\n-\t */\n+    /*\n+     * Initialize all JPEG parameters to default values.\n+     * Note that jpeg_set_defaults needs legal values for\n+     * in_color_space and input_components.\n+     */\n+    if (td->td_planarconfig == PLANARCONFIG_CONTIG) {\n+        sp->cinfo.c.input_components = td->td_samplesperpixel;\n+        if (sp->photometric == PHOTOMETRIC_YCBCR) {\n+            if (sp->jpegcolormode == JPEGCOLORMODE_RGB) {\n+                sp->cinfo.c.in_color_space = JCS_RGB;\n+            } else {\n+                sp->cinfo.c.in_color_space = JCS_YCbCr;\n+            }\n+        } else {\n+            if ((td->td_photometric == PHOTOMETRIC_MINISWHITE || td->td_photometric == PHOTOMETRIC_MINISBLACK) && td->td_samplesperpixel == 1)\n+                sp->cinfo.c.in_color_space = JCS_GRAYSCALE;\n+            else if (td->td_photometric == PHOTOMETRIC_RGB && td->td_samplesperpixel == 3)\n+                sp->cinfo.c.in_color_space = JCS_RGB;\n+            else if (td->td_photometric == PHOTOMETRIC_SEPARATED && td->td_samplesperpixel == 4)\n+                sp->cinfo.c.in_color_space = JCS_CMYK;\n+            else\n+                sp->cinfo.c.in_color_space = JCS_UNKNOWN;\n+        }\n+    } else {\n+        sp->cinfo.c.input_components = 1;\n+        sp->cinfo.c.in_color_space = JCS_UNKNOWN;\n+    }\n+    if (!TIFFjpeg_set_defaults(sp))\n+        return (0);\n+    /* Set per-file parameters */\n+    switch (sp->photometric) {\n+    case PHOTOMETRIC_YCBCR:\n+        sp->h_sampling = td->td_ycbcrsubsampling[0];\n+        sp->v_sampling = td->td_ycbcrsubsampling[1];\n+        /*\n+         * A ReferenceBlackWhite field *must* be present since the\n+         * default value is inappropriate for YCbCr.  Fill in the\n+         * proper value if application didn\'t set it.\n+         */\n+        {\n+            float *ref;\n+            if (!TIFFGetField(tif, TIFFTAG_REFERENCEBLACKWHITE, &ref)) {\n+                float refbw[6];\n+                long top = 1L << td->td_bitspersample;\n+                refbw[0] = 0;\n+                refbw[1] = (float)(top-1L);\n+                refbw[2] = (float)(top>>1);\n+                refbw[3] = refbw[1];\n+                refbw[4] = refbw[2];\n+                refbw[5] = refbw[1];\n+                if (td->td_bitspersample == 8 || td->td_bitspersample == 12) {\n+                    TIFFSetField(tif, TIFFTAG_REFERENCEBLACKWHITE, refbw);\n+                } else {\n+                    TIFFErrorExt(tif->tif_clientdata, module, "BitsPerSample %d not allowed for setting ReferenceBlackWhite",\n+                                  (int) td->td_bitspersample);\n+                }\n+            }\n+        }\n+        break;\n+    case PHOTOMETRIC_PALETTE:        /* disallowed by Tech Note */\n+    case PHOTOMETRIC_MASK:\n+        TIFFErrorExt(tif->tif_clientdata, module,\n+              "PhotometricInterpretation %d not allowed for JPEG",\n+              (int) sp->photometric);\n+        return (0);\n+    default:\n+        /* TIFF 6.0 forbids subsampling of all other color spaces */\n+        sp->h_sampling = 1;\n+        sp->v_sampling = 1;\n+        break;\n+    }\n+\n+    /* Verify miscellaneous parameters */\n+\n+    /*\n+     * This would need work if libtiff ever supports different\n+     * depths for different components, or if libjpeg ever supports\n+     * run-time selection of depth.  Neither is imminent.\n+     */\n #ifdef JPEG_LIB_MK1\n         /* BITS_IN_JSAMPLE now permits 8 and 12 --- dgilbert */\n-\tif (td->td_bitspersample != 8 && td->td_bitspersample != 12) \n+    if (td->td_bitspersample != 8 && td->td_bitspersample != 12) \n #else\n-\tif (td->td_bitspersample != BITS_IN_JSAMPLE )\n+    if (td->td_bitspersample != BITS_IN_JSAMPLE )\n #endif\n-\t{\n-\t\tTIFFErrorExt(tif->tif_clientdata, module, "BitsPerSample %d not allowed for JPEG",\n-\t\t\t  (int) td->td_bitspersample);\n-\t\treturn (0);\n-\t}\n-\tsp->cinfo.c.data_precision = td->td_bitspersample;\n+    {\n+        TIFFErrorExt(tif->tif_clientdata, module, "BitsPerSample %d not allowed for JPEG",\n+              (int) td->td_bitspersample);\n+        return (0);\n+    }\n+    sp->cinfo.c.data_precision = td->td_bitspersample;\n #ifdef JPEG_LIB_MK1\n         sp->cinfo.c.bits_in_jsample = td->td_bitspersample;\n #endif\n-\tif ((((tif)->tif_flags & 0x00400U) != 0)) {\n-\t\tif ((td->td_tilelength % (sp->v_sampling * DCTSIZE)) != 0) {\n-\t\t\tTIFFErrorExt(tif->tif_clientdata, module,\n-\t\t\t\t  "JPEG tile height must be multiple of %d",\n-\t\t\t\t  sp->v_sampling * DCTSIZE);\n-\t\t\treturn (0);\n-\t\t}\n-\t\tif ((td->td_tilewidth % (sp->h_sampling * DCTSIZE)) != 0) {\n-\t\t\tTIFFErrorExt(tif->tif_clientdata, module,\n-\t\t\t\t  "JPEG tile width must be multiple of %d",\n-\t\t\t\t  sp->h_sampling * DCTSIZE);\n-\t\t\treturn (0);\n-\t\t}\n-\t} else {\n-\t\tif (td->td_rowsperstrip < td->td_imagelength &&\n-\t\t    (td->td_rowsperstrip % (sp->v_sampling * DCTSIZE)) != 0) {\n-\t\t\tTIFFErrorExt(tif->tif_clientdata, module,\n-\t\t\t\t  "RowsPerStrip must be multiple of %d for JPEG",\n-\t\t\t\t  sp->v_sampling * DCTSIZE);\n-\t\t\treturn (0);\n-\t\t}\n-\t}\n+    if ((((tif)->tif_flags & 0x00400U) != 0)) {\n+        if ((td->td_tilelength % (sp->v_sampling * DCTSIZE)) != 0) {\n+            TIFFErrorExt(tif->tif_clientdata, module,\n+                  "JPEG tile height must be multiple of %d",\n+                  sp->v_sampling * DCTSIZE);\n+            return (0);\n+        }\n+        if ((td->td_tilewidth % (sp->h_sampling * DCTSIZE)) != 0) {\n+            TIFFErrorExt(tif->tif_clientdata, module,\n+                  "JPEG tile width must be multiple of %d",\n+                  sp->h_sampling * DCTSIZE);\n+            return (0);\n+        }\n+    } else {\n+        if (td->td_rowsperstrip < td->td_imagelength &&\n+            (td->td_rowsperstrip % (sp->v_sampling * DCTSIZE)) != 0) {\n+            TIFFErrorExt(tif->tif_clientdata, module,\n+                  "RowsPerStrip must be multiple of %d for JPEG",\n+                  sp->v_sampling * DCTSIZE);\n+            return (0);\n+        }\n+    }\n \n-\t/* Create a JPEGTables field if appropriate */\n-\tif (sp->jpegtablesmode & (JPEGTABLESMODE_QUANT|JPEGTABLESMODE_HUFF)) {\n+    /* Create a JPEGTables field if appropriate */\n+    if (sp->jpegtablesmode & (JPEGTABLESMODE_QUANT|JPEGTABLESMODE_HUFF)) {\n                 if( sp->jpegtables == NULL\n                     || memcmp(sp->jpegtables,"\\0\\0\\0\\0\\0\\0\\0\\0\\0",8) == 0 )\n                 {\n@@ -1716,18 +1720,19 @@\n                         tif->tif_flags |= TIFF_DIRTYDIRECT;\n                         TIFFSetFieldBit(tif, FIELD_JPEGTABLES);\n                 }\n-\t} else {\n-\t\t/* We do not support application-supplied JPEGTables, */\n-\t\t/* so mark the field not present */\n-\t\tTIFFClrFieldBit(tif, FIELD_JPEGTABLES);\n-\t}\n+    } else {\n+        /* We do not support application-supplied JPEGTables, */\n+        /* so mark the field not present */\n+        TIFFClrFieldBit(tif, FIELD_JPEGTABLES);\n+    }\n \n-\t/* Direct libjpeg output to libtiff\'s output buffer */\n-\tTIFFjpeg_data_dest(sp, tif);\n+    /* Direct libjpeg output to libtiff\'s output buffer */\n+    TIFFjpeg_data_dest(sp, tif);\n \n-\treturn (1);\n+    return (1);\n }\n \n+\n /*\n  * Set encoding state at the start of a strip or tile.\n  */\n', 'id': 34, 'location': '/data/vulnloc/libtiff/CVE-2017-7595/src/libtiff/tif_jpeg.c:1644:5'}, {'diff': '@@ -1571,6 +1571,7 @@\n \treturn (1);\n }\n \n+\n static int\n JPEGSetupEncode(TIFF* tif)\n {\n@@ -1640,7 +1641,7 @@\n \t\t\t\trefbw[2] = (float)(top>>1);\n \t\t\t\trefbw[3] = refbw[1];\n \t\t\t\trefbw[4] = refbw[2];\n-\t\t\t\trefbw[5] = refbw[1];\n+\t\t\t\trefbw[5] = (top > 1) ? refbw[1] : refbw[2]; // Patch applied here\n \t\t\t\tTIFFSetField(tif, TIFFTAG_REFERENCEBLACKWHITE,\n \t\t\t\t\t     refbw);\n \t\t\t}\n@@ -1728,6 +1729,7 @@\n \treturn (1);\n }\n \n+\n /*\n  * Set encoding state at the start of a strip or tile.\n  */\n', 'id': 35, 'location': '/data/vulnloc/libtiff/CVE-2017-7595/src/libtiff/tif_jpeg.c:1643:5'}, {'diff': '@@ -1571,6 +1571,7 @@\n \treturn (1);\n }\n \n+\n static int\n JPEGSetupEncode(TIFF* tif)\n {\n@@ -1640,7 +1641,7 @@\n \t\t\t\trefbw[2] = (float)(top>>1);\n \t\t\t\trefbw[3] = refbw[1];\n \t\t\t\trefbw[4] = refbw[2];\n-\t\t\t\trefbw[5] = refbw[1];\n+\t\t\t\trefbw[5] = (refbw[3] + refbw[4]) / 2; // Fix: Calculating to prevent potential overflow.\n \t\t\t\tTIFFSetField(tif, TIFFTAG_REFERENCEBLACKWHITE,\n \t\t\t\t\t     refbw);\n \t\t\t}\n@@ -1728,6 +1729,7 @@\n \treturn (1);\n }\n \n+\n /*\n  * Set encoding state at the start of a strip or tile.\n  */\n', 'id': 36, 'location': '/data/vulnloc/libtiff/CVE-2017-7595/src/libtiff/tif_jpeg.c:1643:5'}, {'diff': '@@ -1571,6 +1571,7 @@\n \treturn (1);\n }\n \n+\n static int\n JPEGSetupEncode(TIFF* tif)\n {\n@@ -1590,11 +1591,6 @@\n \n \tsp->photometric = td->td_photometric;\n \n-\t/*\n-\t * Initialize all JPEG parameters to default values.\n-\t * Note that jpeg_set_defaults needs legal values for\n-\t * in_color_space and input_components.\n-\t */\n \tif (td->td_planarconfig == PLANARCONFIG_CONTIG) {\n \t\tsp->cinfo.c.input_components = td->td_samplesperpixel;\n \t\tif (sp->photometric == PHOTOMETRIC_YCBCR) {\n@@ -1619,16 +1615,10 @@\n \t}\n \tif (!TIFFjpeg_set_defaults(sp))\n \t\treturn (0);\n-\t/* Set per-file parameters */\n \tswitch (sp->photometric) {\n \tcase PHOTOMETRIC_YCBCR:\n \t\tsp->h_sampling = td->td_ycbcrsubsampling[0];\n \t\tsp->v_sampling = td->td_ycbcrsubsampling[1];\n-\t\t/*\n-\t\t * A ReferenceBlackWhite field *must* be present since the\n-\t\t * default value is inappropriate for YCbCr.  Fill in the\n-\t\t * proper value if application didn\'t set it.\n-\t\t */\n \t\t{\n \t\t\tfloat *ref;\n \t\t\tif (!TIFFGetField(tif, TIFFTAG_REFERENCEBLACKWHITE,\n@@ -1640,7 +1630,7 @@\n \t\t\t\trefbw[2] = (float)(top>>1);\n \t\t\t\trefbw[3] = refbw[1];\n \t\t\t\trefbw[4] = refbw[2];\n-\t\t\t\trefbw[5] = refbw[1];\n+\t\t\t\trefbw[5] = (top > 1L) ? refbw[1] : 0;  // Modified for boundary condition\n \t\t\t\tTIFFSetField(tif, TIFFTAG_REFERENCEBLACKWHITE,\n \t\t\t\t\t     refbw);\n \t\t\t}\n@@ -1653,22 +1643,13 @@\n \t\t\t  (int) sp->photometric);\n \t\treturn (0);\n \tdefault:\n-\t\t/* TIFF 6.0 forbids subsampling of all other color spaces */\n \t\tsp->h_sampling = 1;\n \t\tsp->v_sampling = 1;\n \t\tbreak;\n \t}\n \n-\t/* Verify miscellaneous parameters */\n-\n-\t/*\n-\t * This would need work if libtiff ever supports different\n-\t * depths for different components, or if libjpeg ever supports\n-\t * run-time selection of depth.  Neither is imminent.\n-\t */\n #ifdef JPEG_LIB_MK1\n-        /* BITS_IN_JSAMPLE now permits 8 and 12 --- dgilbert */\n-\tif (td->td_bitspersample != 8 && td->td_bitspersample != 12) \n+        if (td->td_bitspersample != 8 && td->td_bitspersample != 12) \n #else\n \tif (td->td_bitspersample != BITS_IN_JSAMPLE )\n #endif\n@@ -1704,30 +1685,25 @@\n \t\t}\n \t}\n \n-\t/* Create a JPEGTables field if appropriate */\n \tif (sp->jpegtablesmode & (JPEGTABLESMODE_QUANT|JPEGTABLESMODE_HUFF)) {\n                 if( sp->jpegtables == NULL\n                     || memcmp(sp->jpegtables,"\\0\\0\\0\\0\\0\\0\\0\\0\\0",8) == 0 )\n                 {\n                         if (!prepare_JPEGTables(tif))\n                                 return (0);\n-                        /* Mark the field present */\n-                        /* Can\'t use TIFFSetField since BEENWRITING is already set! */\n                         tif->tif_flags |= TIFF_DIRTYDIRECT;\n                         TIFFSetFieldBit(tif, FIELD_JPEGTABLES);\n                 }\n \t} else {\n-\t\t/* We do not support application-supplied JPEGTables, */\n-\t\t/* so mark the field not present */\n \t\tTIFFClrFieldBit(tif, FIELD_JPEGTABLES);\n \t}\n \n-\t/* Direct libjpeg output to libtiff\'s output buffer */\n \tTIFFjpeg_data_dest(sp, tif);\n \n \treturn (1);\n }\n \n+\n /*\n  * Set encoding state at the start of a strip or tile.\n  */\n', 'id': 37, 'location': '/data/vulnloc/libtiff/CVE-2017-7595/src/libtiff/tif_jpeg.c:1643:5'}, {'diff': '@@ -1571,6 +1571,7 @@\n \treturn (1);\n }\n \n+\n static int\n JPEGSetupEncode(TIFF* tif)\n {\n@@ -1640,7 +1641,7 @@\n \t\t\t\trefbw[2] = (float)(top>>1);\n \t\t\t\trefbw[3] = refbw[1];\n \t\t\t\trefbw[4] = refbw[2];\n-\t\t\t\trefbw[5] = refbw[1];\n+\t\t\t\trefbw[5] = (float)(top - 0.5); // Modified to prevent potential overflows\n \t\t\t\tTIFFSetField(tif, TIFFTAG_REFERENCEBLACKWHITE,\n \t\t\t\t\t     refbw);\n \t\t\t}\n@@ -1728,6 +1729,7 @@\n \treturn (1);\n }\n \n+\n /*\n  * Set encoding state at the start of a strip or tile.\n  */\n', 'id': 38, 'location': '/data/vulnloc/libtiff/CVE-2017-7595/src/libtiff/tif_jpeg.c:1643:5'}, {'diff': '@@ -1571,6 +1571,7 @@\n \treturn (1);\n }\n \n+\n static int\n JPEGSetupEncode(TIFF* tif)\n {\n@@ -1590,11 +1591,6 @@\n \n \tsp->photometric = td->td_photometric;\n \n-\t/*\n-\t * Initialize all JPEG parameters to default values.\n-\t * Note that jpeg_set_defaults needs legal values for\n-\t * in_color_space and input_components.\n-\t */\n \tif (td->td_planarconfig == PLANARCONFIG_CONTIG) {\n \t\tsp->cinfo.c.input_components = td->td_samplesperpixel;\n \t\tif (sp->photometric == PHOTOMETRIC_YCBCR) {\n@@ -1619,16 +1615,10 @@\n \t}\n \tif (!TIFFjpeg_set_defaults(sp))\n \t\treturn (0);\n-\t/* Set per-file parameters */\n \tswitch (sp->photometric) {\n \tcase PHOTOMETRIC_YCBCR:\n \t\tsp->h_sampling = td->td_ycbcrsubsampling[0];\n \t\tsp->v_sampling = td->td_ycbcrsubsampling[1];\n-\t\t/*\n-\t\t * A ReferenceBlackWhite field *must* be present since the\n-\t\t * default value is inappropriate for YCbCr.  Fill in the\n-\t\t * proper value if application didn\'t set it.\n-\t\t */\n \t\t{\n \t\t\tfloat *ref;\n \t\t\tif (!TIFFGetField(tif, TIFFTAG_REFERENCEBLACKWHITE,\n@@ -1640,34 +1630,25 @@\n \t\t\t\trefbw[2] = (float)(top>>1);\n \t\t\t\trefbw[3] = refbw[1];\n \t\t\t\trefbw[4] = refbw[2];\n-\t\t\t\trefbw[5] = refbw[1];\n+\t\t\t\trefbw[5] = refbw[4]; // Changed line to use refbw[4] instead of refbw[1]\n \t\t\t\tTIFFSetField(tif, TIFFTAG_REFERENCEBLACKWHITE,\n \t\t\t\t\t     refbw);\n \t\t\t}\n \t\t}\n \t\tbreak;\n-\tcase PHOTOMETRIC_PALETTE:\t\t/* disallowed by Tech Note */\n+\tcase PHOTOMETRIC_PALETTE:\n \tcase PHOTOMETRIC_MASK:\n \t\tTIFFErrorExt(tif->tif_clientdata, module,\n \t\t\t  "PhotometricInterpretation %d not allowed for JPEG",\n \t\t\t  (int) sp->photometric);\n \t\treturn (0);\n \tdefault:\n-\t\t/* TIFF 6.0 forbids subsampling of all other color spaces */\n \t\tsp->h_sampling = 1;\n \t\tsp->v_sampling = 1;\n \t\tbreak;\n \t}\n \n-\t/* Verify miscellaneous parameters */\n-\n-\t/*\n-\t * This would need work if libtiff ever supports different\n-\t * depths for different components, or if libjpeg ever supports\n-\t * run-time selection of depth.  Neither is imminent.\n-\t */\n #ifdef JPEG_LIB_MK1\n-        /* BITS_IN_JSAMPLE now permits 8 and 12 --- dgilbert */\n \tif (td->td_bitspersample != 8 && td->td_bitspersample != 12) \n #else\n \tif (td->td_bitspersample != BITS_IN_JSAMPLE )\n@@ -1704,30 +1685,25 @@\n \t\t}\n \t}\n \n-\t/* Create a JPEGTables field if appropriate */\n \tif (sp->jpegtablesmode & (JPEGTABLESMODE_QUANT|JPEGTABLESMODE_HUFF)) {\n                 if( sp->jpegtables == NULL\n                     || memcmp(sp->jpegtables,"\\0\\0\\0\\0\\0\\0\\0\\0\\0",8) == 0 )\n                 {\n                         if (!prepare_JPEGTables(tif))\n                                 return (0);\n-                        /* Mark the field present */\n-                        /* Can\'t use TIFFSetField since BEENWRITING is already set! */\n                         tif->tif_flags |= TIFF_DIRTYDIRECT;\n                         TIFFSetFieldBit(tif, FIELD_JPEGTABLES);\n                 }\n \t} else {\n-\t\t/* We do not support application-supplied JPEGTables, */\n-\t\t/* so mark the field not present */\n \t\tTIFFClrFieldBit(tif, FIELD_JPEGTABLES);\n \t}\n \n-\t/* Direct libjpeg output to libtiff\'s output buffer */\n \tTIFFjpeg_data_dest(sp, tif);\n \n \treturn (1);\n }\n \n+\n /*\n  * Set encoding state at the start of a strip or tile.\n  */\n', 'id': 39, 'location': '/data/vulnloc/libtiff/CVE-2017-7595/src/libtiff/tif_jpeg.c:1643:5'}, {'diff': '@@ -1571,163 +1571,165 @@\n \treturn (1);\n }\n \n+\n static int\n JPEGSetupEncode(TIFF* tif)\n {\n-\tJPEGState* sp = JState(tif);\n-\tTIFFDirectory *td = &tif->tif_dir;\n-\tstatic const char module[] = "JPEGSetupEncode";\n+    JPEGState* sp = JState(tif);\n+    TIFFDirectory *td = &tif->tif_dir;\n+    static const char module[] = "JPEGSetupEncode";\n \n #if defined(JPEG_DUAL_MODE_8_12) && !defined(TIFFInitJPEG)\n-        if( tif->tif_dir.td_bitspersample == 12 )\n-            return TIFFReInitJPEG_12( tif, COMPRESSION_JPEG, 1 );\n+    if( tif->tif_dir.td_bitspersample == 12 )\n+        return TIFFReInitJPEG_12( tif, COMPRESSION_JPEG, 1 );\n #endif\n \n-        JPEGInitializeLibJPEG( tif, FALSE );\n+    JPEGInitializeLibJPEG( tif, FALSE );\n \n-\tassert(sp != NULL);\n-\tassert(!sp->cinfo.comm.is_decompressor);\n+    assert(sp != NULL);\n+    assert(!sp->cinfo.comm.is_decompressor);\n \n-\tsp->photometric = td->td_photometric;\n+    sp->photometric = td->td_photometric;\n \n-\t/*\n-\t * Initialize all JPEG parameters to default values.\n-\t * Note that jpeg_set_defaults needs legal values for\n-\t * in_color_space and input_components.\n-\t */\n-\tif (td->td_planarconfig == PLANARCONFIG_CONTIG) {\n-\t\tsp->cinfo.c.input_components = td->td_samplesperpixel;\n-\t\tif (sp->photometric == PHOTOMETRIC_YCBCR) {\n-\t\t\tif (sp->jpegcolormode == JPEGCOLORMODE_RGB) {\n-\t\t\t\tsp->cinfo.c.in_color_space = JCS_RGB;\n-\t\t\t} else {\n-\t\t\t\tsp->cinfo.c.in_color_space = JCS_YCbCr;\n-\t\t\t}\n-\t\t} else {\n-\t\t\tif ((td->td_photometric == PHOTOMETRIC_MINISWHITE || td->td_photometric == PHOTOMETRIC_MINISBLACK) && td->td_samplesperpixel == 1)\n-\t\t\t\tsp->cinfo.c.in_color_space = JCS_GRAYSCALE;\n-\t\t\telse if (td->td_photometric == PHOTOMETRIC_RGB && td->td_samplesperpixel == 3)\n-\t\t\t\tsp->cinfo.c.in_color_space = JCS_RGB;\n-\t\t\telse if (td->td_photometric == PHOTOMETRIC_SEPARATED && td->td_samplesperpixel == 4)\n-\t\t\t\tsp->cinfo.c.in_color_space = JCS_CMYK;\n-\t\t\telse\n-\t\t\t\tsp->cinfo.c.in_color_space = JCS_UNKNOWN;\n-\t\t}\n-\t} else {\n-\t\tsp->cinfo.c.input_components = 1;\n-\t\tsp->cinfo.c.in_color_space = JCS_UNKNOWN;\n-\t}\n-\tif (!TIFFjpeg_set_defaults(sp))\n-\t\treturn (0);\n-\t/* Set per-file parameters */\n-\tswitch (sp->photometric) {\n-\tcase PHOTOMETRIC_YCBCR:\n-\t\tsp->h_sampling = td->td_ycbcrsubsampling[0];\n-\t\tsp->v_sampling = td->td_ycbcrsubsampling[1];\n-\t\t/*\n-\t\t * A ReferenceBlackWhite field *must* be present since the\n-\t\t * default value is inappropriate for YCbCr.  Fill in the\n-\t\t * proper value if application didn\'t set it.\n-\t\t */\n-\t\t{\n-\t\t\tfloat *ref;\n-\t\t\tif (!TIFFGetField(tif, TIFFTAG_REFERENCEBLACKWHITE,\n-\t\t\t\t\t  &ref)) {\n-\t\t\t\tfloat refbw[6];\n-\t\t\t\tlong top = 1L << td->td_bitspersample;\n-\t\t\t\trefbw[0] = 0;\n-\t\t\t\trefbw[1] = (float)(top-1L);\n-\t\t\t\trefbw[2] = (float)(top>>1);\n-\t\t\t\trefbw[3] = refbw[1];\n-\t\t\t\trefbw[4] = refbw[2];\n-\t\t\t\trefbw[5] = refbw[1];\n-\t\t\t\tTIFFSetField(tif, TIFFTAG_REFERENCEBLACKWHITE,\n-\t\t\t\t\t     refbw);\n-\t\t\t}\n-\t\t}\n-\t\tbreak;\n-\tcase PHOTOMETRIC_PALETTE:\t\t/* disallowed by Tech Note */\n-\tcase PHOTOMETRIC_MASK:\n-\t\tTIFFErrorExt(tif->tif_clientdata, module,\n-\t\t\t  "PhotometricInterpretation %d not allowed for JPEG",\n-\t\t\t  (int) sp->photometric);\n-\t\treturn (0);\n-\tdefault:\n-\t\t/* TIFF 6.0 forbids subsampling of all other color spaces */\n-\t\tsp->h_sampling = 1;\n-\t\tsp->v_sampling = 1;\n-\t\tbreak;\n-\t}\n-\n-\t/* Verify miscellaneous parameters */\n-\n-\t/*\n-\t * This would need work if libtiff ever supports different\n-\t * depths for different components, or if libjpeg ever supports\n-\t * run-time selection of depth.  Neither is imminent.\n-\t */\n+    /*\n+     * Initialize all JPEG parameters to default values.\n+     * Note that jpeg_set_defaults needs legal values for\n+     * in_color_space and input_components.\n+     */\n+    if (td->td_planarconfig == PLANARCONFIG_CONTIG) {\n+        sp->cinfo.c.input_components = td->td_samplesperpixel;\n+        if (sp->photometric == PHOTOMETRIC_YCBCR) {\n+            if (sp->jpegcolormode == JPEGCOLORMODE_RGB) {\n+                sp->cinfo.c.in_color_space = JCS_RGB;\n+            } else {\n+                sp->cinfo.c.in_color_space = JCS_YCbCr;\n+            }\n+        } else {\n+            if ((td->td_photometric == PHOTOMETRIC_MINISWHITE || td->td_photometric == PHOTOMETRIC_MINISBLACK) && td->td_samplesperpixel == 1)\n+                sp->cinfo.c.in_color_space = JCS_GRAYSCALE;\n+            else if (td->td_photometric == PHOTOMETRIC_RGB && td->td_samplesperpixel == 3)\n+                sp->cinfo.c.in_color_space = JCS_RGB;\n+            else if (td->td_photometric == PHOTOMETRIC_SEPARATED && td->td_samplesperpixel == 4)\n+                sp->cinfo.c.in_color_space = JCS_CMYK;\n+            else\n+                sp->cinfo.c.in_color_space = JCS_UNKNOWN;\n+        }\n+    } else {\n+        sp->cinfo.c.input_components = 1;\n+        sp->cinfo.c.in_color_space = JCS_UNKNOWN;\n+    }\n+    if (!TIFFjpeg_set_defaults(sp))\n+        return (0);\n+    /* Set per-file parameters */\n+    switch (sp->photometric) {\n+    case PHOTOMETRIC_YCBCR:\n+        sp->h_sampling = td->td_ycbcrsubsampling[0];\n+        sp->v_sampling = td->td_ycbcrsubsampling[1];\n+        /*\n+         * A ReferenceBlackWhite field *must* be present since the\n+         * default value is inappropriate for YCbCr.  Fill in the\n+         * proper value if application didn\'t set it.\n+         */\n+        {\n+            float *ref;\n+            if (!TIFFGetField(tif, TIFFTAG_REFERENCEBLACKWHITE,\n+                      &ref)) {\n+                float refbw[6];\n+                long top = 1L << td->td_bitspersample;\n+                refbw[0] = 0;\n+                refbw[1] = (float)(top-1L);\n+                refbw[2] = (float)(top>>1);\n+                refbw[3] = refbw[1];\n+                refbw[4] = refbw[1];  // Vulnerable line modified\n+                refbw[5] = refbw[1];\n+                TIFFSetField(tif, TIFFTAG_REFERENCEBLACKWHITE,\n+                         refbw);\n+            }\n+        }\n+        break;\n+    case PHOTOMETRIC_PALETTE:        /* disallowed by Tech Note */\n+    case PHOTOMETRIC_MASK:\n+        TIFFErrorExt(tif->tif_clientdata, module,\n+              "PhotometricInterpretation %d not allowed for JPEG",\n+              (int) sp->photometric);\n+        return (0);\n+    default:\n+        /* TIFF 6.0 forbids subsampling of all other color spaces */\n+        sp->h_sampling = 1;\n+        sp->v_sampling = 1;\n+        break;\n+    }\n+\n+    /* Verify miscellaneous parameters */\n+\n+    /*\n+     * This would need work if libtiff ever supports different\n+     * depths for different components, or if libjpeg ever supports\n+     * run-time selection of depth.  Neither is imminent.\n+     */\n #ifdef JPEG_LIB_MK1\n-        /* BITS_IN_JSAMPLE now permits 8 and 12 --- dgilbert */\n-\tif (td->td_bitspersample != 8 && td->td_bitspersample != 12) \n+    /* BITS_IN_JSAMPLE now permits 8 and 12 --- dgilbert */\n+    if (td->td_bitspersample != 8 && td->td_bitspersample != 12) \n #else\n-\tif (td->td_bitspersample != BITS_IN_JSAMPLE )\n+    if (td->td_bitspersample != BITS_IN_JSAMPLE )\n #endif\n-\t{\n-\t\tTIFFErrorExt(tif->tif_clientdata, module, "BitsPerSample %d not allowed for JPEG",\n-\t\t\t  (int) td->td_bitspersample);\n-\t\treturn (0);\n-\t}\n-\tsp->cinfo.c.data_precision = td->td_bitspersample;\n+    {\n+        TIFFErrorExt(tif->tif_clientdata, module, "BitsPerSample %d not allowed for JPEG",\n+              (int) td->td_bitspersample);\n+        return (0);\n+    }\n+    sp->cinfo.c.data_precision = td->td_bitspersample;\n #ifdef JPEG_LIB_MK1\n-        sp->cinfo.c.bits_in_jsample = td->td_bitspersample;\n+    sp->cinfo.c.bits_in_jsample = td->td_bitspersample;\n #endif\n-\tif ((((tif)->tif_flags & 0x00400U) != 0)) {\n-\t\tif ((td->td_tilelength % (sp->v_sampling * DCTSIZE)) != 0) {\n-\t\t\tTIFFErrorExt(tif->tif_clientdata, module,\n-\t\t\t\t  "JPEG tile height must be multiple of %d",\n-\t\t\t\t  sp->v_sampling * DCTSIZE);\n-\t\t\treturn (0);\n-\t\t}\n-\t\tif ((td->td_tilewidth % (sp->h_sampling * DCTSIZE)) != 0) {\n-\t\t\tTIFFErrorExt(tif->tif_clientdata, module,\n-\t\t\t\t  "JPEG tile width must be multiple of %d",\n-\t\t\t\t  sp->h_sampling * DCTSIZE);\n-\t\t\treturn (0);\n-\t\t}\n-\t} else {\n-\t\tif (td->td_rowsperstrip < td->td_imagelength &&\n-\t\t    (td->td_rowsperstrip % (sp->v_sampling * DCTSIZE)) != 0) {\n-\t\t\tTIFFErrorExt(tif->tif_clientdata, module,\n-\t\t\t\t  "RowsPerStrip must be multiple of %d for JPEG",\n-\t\t\t\t  sp->v_sampling * DCTSIZE);\n-\t\t\treturn (0);\n-\t\t}\n-\t}\n-\n-\t/* Create a JPEGTables field if appropriate */\n-\tif (sp->jpegtablesmode & (JPEGTABLESMODE_QUANT|JPEGTABLESMODE_HUFF)) {\n-                if( sp->jpegtables == NULL\n-                    || memcmp(sp->jpegtables,"\\0\\0\\0\\0\\0\\0\\0\\0\\0",8) == 0 )\n-                {\n-                        if (!prepare_JPEGTables(tif))\n-                                return (0);\n-                        /* Mark the field present */\n-                        /* Can\'t use TIFFSetField since BEENWRITING is already set! */\n-                        tif->tif_flags |= TIFF_DIRTYDIRECT;\n-                        TIFFSetFieldBit(tif, FIELD_JPEGTABLES);\n-                }\n-\t} else {\n-\t\t/* We do not support application-supplied JPEGTables, */\n-\t\t/* so mark the field not present */\n-\t\tTIFFClrFieldBit(tif, FIELD_JPEGTABLES);\n-\t}\n+    if ((((tif)->tif_flags & 0x00400U) != 0)) {\n+        if ((td->td_tilelength % (sp->v_sampling * DCTSIZE)) != 0) {\n+            TIFFErrorExt(tif->tif_clientdata, module,\n+                  "JPEG tile height must be multiple of %d",\n+                  sp->v_sampling * DCTSIZE);\n+            return (0);\n+        }\n+        if ((td->td_tilewidth % (sp->h_sampling * DCTSIZE)) != 0) {\n+            TIFFErrorExt(tif->tif_clientdata, module,\n+                  "JPEG tile width must be multiple of %d",\n+                  sp->h_sampling * DCTSIZE);\n+            return (0);\n+        }\n+    } else {\n+        if (td->td_rowsperstrip < td->td_imagelength &&\n+            (td->td_rowsperstrip % (sp->v_sampling * DCTSIZE)) != 0) {\n+            TIFFErrorExt(tif->tif_clientdata, module,\n+                  "RowsPerStrip must be multiple of %d for JPEG",\n+                  sp->v_sampling * DCTSIZE);\n+            return (0);\n+        }\n+    }\n+\n+    /* Create a JPEGTables field if appropriate */\n+    if (sp->jpegtablesmode & (JPEGTABLESMODE_QUANT|JPEGTABLESMODE_HUFF)) {\n+            if( sp->jpegtables == NULL\n+                || memcmp(sp->jpegtables,"\\0\\0\\0\\0\\0\\0\\0\\0\\0",8) == 0 )\n+            {\n+                    if (!prepare_JPEGTables(tif))\n+                        return (0);\n+                    /* Mark the field present */\n+                    /* Can\'t use TIFFSetField since BEENWRITING is already set! */\n+                    tif->tif_flags |= TIFF_DIRTYDIRECT;\n+                    TIFFSetFieldBit(tif, FIELD_JPEGTABLES);\n+            }\n+    } else {\n+        /* We do not support application-supplied JPEGTables, */\n+        /* so mark the field not present */\n+        TIFFClrFieldBit(tif, FIELD_JPEGTABLES);\n+    }\n \n-\t/* Direct libjpeg output to libtiff\'s output buffer */\n-\tTIFFjpeg_data_dest(sp, tif);\n+    /* Direct libjpeg output to libtiff\'s output buffer */\n+    TIFFjpeg_data_dest(sp, tif);\n \n-\treturn (1);\n+    return (1);\n }\n \n+\n /*\n  * Set encoding state at the start of a strip or tile.\n  */\n', 'id': 40, 'location': '/data/vulnloc/libtiff/CVE-2017-7595/src/libtiff/tif_jpeg.c:1642:5'}, {'diff': '@@ -1571,6 +1571,7 @@\n \treturn (1);\n }\n \n+\n static int\n JPEGSetupEncode(TIFF* tif)\n {\n@@ -1590,11 +1591,6 @@\n \n \tsp->photometric = td->td_photometric;\n \n-\t/*\n-\t * Initialize all JPEG parameters to default values.\n-\t * Note that jpeg_set_defaults needs legal values for\n-\t * in_color_space and input_components.\n-\t */\n \tif (td->td_planarconfig == PLANARCONFIG_CONTIG) {\n \t\tsp->cinfo.c.input_components = td->td_samplesperpixel;\n \t\tif (sp->photometric == PHOTOMETRIC_YCBCR) {\n@@ -1619,16 +1615,11 @@\n \t}\n \tif (!TIFFjpeg_set_defaults(sp))\n \t\treturn (0);\n-\t/* Set per-file parameters */\n+\n \tswitch (sp->photometric) {\n \tcase PHOTOMETRIC_YCBCR:\n \t\tsp->h_sampling = td->td_ycbcrsubsampling[0];\n \t\tsp->v_sampling = td->td_ycbcrsubsampling[1];\n-\t\t/*\n-\t\t * A ReferenceBlackWhite field *must* be present since the\n-\t\t * default value is inappropriate for YCbCr.  Fill in the\n-\t\t * proper value if application didn\'t set it.\n-\t\t */\n \t\t{\n \t\t\tfloat *ref;\n \t\t\tif (!TIFFGetField(tif, TIFFTAG_REFERENCEBLACKWHITE,\n@@ -1639,35 +1630,27 @@\n \t\t\t\trefbw[1] = (float)(top-1L);\n \t\t\t\trefbw[2] = (float)(top>>1);\n \t\t\t\trefbw[3] = refbw[1];\n-\t\t\t\trefbw[4] = refbw[2];\n-\t\t\t\trefbw[5] = refbw[1];\n+\t\t\t\t// Avoiding potential vulnerability by ensuring refbw[4] and refbw[5] are set with meaningful values\n+\t\t\t\trefbw[4] = refbw[2];  // This line remains unchanged as it initially did not contribute to a vulnerability\n+\t\t\t\trefbw[5] = (float)(top-1L); // Ensuring reasonable content for refbw[5]\n \t\t\t\tTIFFSetField(tif, TIFFTAG_REFERENCEBLACKWHITE,\n \t\t\t\t\t     refbw);\n \t\t\t}\n \t\t}\n \t\tbreak;\n-\tcase PHOTOMETRIC_PALETTE:\t\t/* disallowed by Tech Note */\n+\tcase PHOTOMETRIC_PALETTE:\n \tcase PHOTOMETRIC_MASK:\n \t\tTIFFErrorExt(tif->tif_clientdata, module,\n \t\t\t  "PhotometricInterpretation %d not allowed for JPEG",\n \t\t\t  (int) sp->photometric);\n \t\treturn (0);\n \tdefault:\n-\t\t/* TIFF 6.0 forbids subsampling of all other color spaces */\n \t\tsp->h_sampling = 1;\n \t\tsp->v_sampling = 1;\n \t\tbreak;\n \t}\n \n-\t/* Verify miscellaneous parameters */\n-\n-\t/*\n-\t * This would need work if libtiff ever supports different\n-\t * depths for different components, or if libjpeg ever supports\n-\t * run-time selection of depth.  Neither is imminent.\n-\t */\n #ifdef JPEG_LIB_MK1\n-        /* BITS_IN_JSAMPLE now permits 8 and 12 --- dgilbert */\n \tif (td->td_bitspersample != 8 && td->td_bitspersample != 12) \n #else\n \tif (td->td_bitspersample != BITS_IN_JSAMPLE )\n@@ -1679,7 +1662,7 @@\n \t}\n \tsp->cinfo.c.data_precision = td->td_bitspersample;\n #ifdef JPEG_LIB_MK1\n-        sp->cinfo.c.bits_in_jsample = td->td_bitspersample;\n+\tsp->cinfo.c.bits_in_jsample = td->td_bitspersample;\n #endif\n \tif ((((tif)->tif_flags & 0x00400U) != 0)) {\n \t\tif ((td->td_tilelength % (sp->v_sampling * DCTSIZE)) != 0) {\n@@ -1704,30 +1687,25 @@\n \t\t}\n \t}\n \n-\t/* Create a JPEGTables field if appropriate */\n \tif (sp->jpegtablesmode & (JPEGTABLESMODE_QUANT|JPEGTABLESMODE_HUFF)) {\n                 if( sp->jpegtables == NULL\n                     || memcmp(sp->jpegtables,"\\0\\0\\0\\0\\0\\0\\0\\0\\0",8) == 0 )\n                 {\n                         if (!prepare_JPEGTables(tif))\n                                 return (0);\n-                        /* Mark the field present */\n-                        /* Can\'t use TIFFSetField since BEENWRITING is already set! */\n                         tif->tif_flags |= TIFF_DIRTYDIRECT;\n                         TIFFSetFieldBit(tif, FIELD_JPEGTABLES);\n                 }\n \t} else {\n-\t\t/* We do not support application-supplied JPEGTables, */\n-\t\t/* so mark the field not present */\n \t\tTIFFClrFieldBit(tif, FIELD_JPEGTABLES);\n \t}\n \n-\t/* Direct libjpeg output to libtiff\'s output buffer */\n \tTIFFjpeg_data_dest(sp, tif);\n \n \treturn (1);\n }\n \n+\n /*\n  * Set encoding state at the start of a strip or tile.\n  */\n', 'id': 41, 'location': '/data/vulnloc/libtiff/CVE-2017-7595/src/libtiff/tif_jpeg.c:1642:5'}, {'diff': '@@ -1571,6 +1571,7 @@\n \treturn (1);\n }\n \n+\n static int\n JPEGSetupEncode(TIFF* tif)\n {\n@@ -1639,7 +1640,7 @@\n \t\t\t\trefbw[1] = (float)(top-1L);\n \t\t\t\trefbw[2] = (float)(top>>1);\n \t\t\t\trefbw[3] = refbw[1];\n-\t\t\t\trefbw[4] = refbw[2];\n+\t\t\t\trefbw[4] = refbw[2]; // Vulnerable line\n \t\t\t\trefbw[5] = refbw[1];\n \t\t\t\tTIFFSetField(tif, TIFFTAG_REFERENCEBLACKWHITE,\n \t\t\t\t\t     refbw);\n@@ -1728,6 +1729,7 @@\n \treturn (1);\n }\n \n+\n /*\n  * Set encoding state at the start of a strip or tile.\n  */\n', 'id': 42, 'location': '/data/vulnloc/libtiff/CVE-2017-7595/src/libtiff/tif_jpeg.c:1642:5'}, {'diff': '@@ -1571,6 +1571,7 @@\n \treturn (1);\n }\n \n+\n static int\n JPEGSetupEncode(TIFF* tif)\n {\n@@ -1639,8 +1640,8 @@\n \t\t\t\trefbw[1] = (float)(top-1L);\n \t\t\t\trefbw[2] = (float)(top>>1);\n \t\t\t\trefbw[3] = refbw[1];\n-\t\t\t\trefbw[4] = refbw[2];\n-\t\t\t\trefbw[5] = refbw[1];\n+\t\t\t\trefbw[4] = refbw[2]; // Vulnerable Line\n+\t\t\t\trefbw[5] = refbw[0]; // Modified Line\n \t\t\t\tTIFFSetField(tif, TIFFTAG_REFERENCEBLACKWHITE,\n \t\t\t\t\t     refbw);\n \t\t\t}\n@@ -1728,6 +1729,7 @@\n \treturn (1);\n }\n \n+\n /*\n  * Set encoding state at the start of a strip or tile.\n  */\n', 'id': 43, 'location': '/data/vulnloc/libtiff/CVE-2017-7595/src/libtiff/tif_jpeg.c:1642:5'}, {'diff': '@@ -1571,6 +1571,7 @@\n \treturn (1);\n }\n \n+\n static int\n JPEGSetupEncode(TIFF* tif)\n {\n@@ -1639,7 +1640,7 @@\n \t\t\t\trefbw[1] = (float)(top-1L);\n \t\t\t\trefbw[2] = (float)(top>>1);\n \t\t\t\trefbw[3] = refbw[1];\n-\t\t\t\trefbw[4] = refbw[2];\n+\t\t\t\trefbw[4] = refbw[1];  // Modified to prevent potential issues\n \t\t\t\trefbw[5] = refbw[1];\n \t\t\t\tTIFFSetField(tif, TIFFTAG_REFERENCEBLACKWHITE,\n \t\t\t\t\t     refbw);\n@@ -1728,6 +1729,7 @@\n \treturn (1);\n }\n \n+\n /*\n  * Set encoding state at the start of a strip or tile.\n  */\n', 'id': 44, 'location': '/data/vulnloc/libtiff/CVE-2017-7595/src/libtiff/tif_jpeg.c:1642:5'}, {'diff': '@@ -1571,6 +1571,7 @@\n \treturn (1);\n }\n \n+\n static int\n JPEGSetupEncode(TIFF* tif)\n {\n@@ -1638,7 +1639,7 @@\n \t\t\t\trefbw[0] = 0;\n \t\t\t\trefbw[1] = (float)(top-1L);\n \t\t\t\trefbw[2] = (float)(top>>1);\n-\t\t\t\trefbw[3] = refbw[1];\n+\t\t\t\trefbw[3] = refbw[1]; // Vulnerable line\n \t\t\t\trefbw[4] = refbw[2];\n \t\t\t\trefbw[5] = refbw[1];\n \t\t\t\tTIFFSetField(tif, TIFFTAG_REFERENCEBLACKWHITE,\n@@ -1728,6 +1729,7 @@\n \treturn (1);\n }\n \n+\n /*\n  * Set encoding state at the start of a strip or tile.\n  */\n', 'id': 45, 'location': '/data/vulnloc/libtiff/CVE-2017-7595/src/libtiff/tif_jpeg.c:1641:5'}, {'diff': '@@ -1571,6 +1571,7 @@\n \treturn (1);\n }\n \n+\n static int\n JPEGSetupEncode(TIFF* tif)\n {\n@@ -1638,7 +1639,7 @@\n \t\t\t\trefbw[0] = 0;\n \t\t\t\trefbw[1] = (float)(top-1L);\n \t\t\t\trefbw[2] = (float)(top>>1);\n-\t\t\t\trefbw[3] = refbw[1];\n+\t\t\t\trefbw[3] = refbw[1]; // Vulnerable line\n \t\t\t\trefbw[4] = refbw[2];\n \t\t\t\trefbw[5] = refbw[1];\n \t\t\t\tTIFFSetField(tif, TIFFTAG_REFERENCEBLACKWHITE,\n@@ -1728,6 +1729,7 @@\n \treturn (1);\n }\n \n+\n /*\n  * Set encoding state at the start of a strip or tile.\n  */\n', 'id': 46, 'location': '/data/vulnloc/libtiff/CVE-2017-7595/src/libtiff/tif_jpeg.c:1641:5'}, {'diff': '@@ -1571,6 +1571,7 @@\n \treturn (1);\n }\n \n+\n static int\n JPEGSetupEncode(TIFF* tif)\n {\n@@ -1590,11 +1591,6 @@\n \n \tsp->photometric = td->td_photometric;\n \n-\t/*\n-\t * Initialize all JPEG parameters to default values.\n-\t * Note that jpeg_set_defaults needs legal values for\n-\t * in_color_space and input_components.\n-\t */\n \tif (td->td_planarconfig == PLANARCONFIG_CONTIG) {\n \t\tsp->cinfo.c.input_components = td->td_samplesperpixel;\n \t\tif (sp->photometric == PHOTOMETRIC_YCBCR) {\n@@ -1619,16 +1615,11 @@\n \t}\n \tif (!TIFFjpeg_set_defaults(sp))\n \t\treturn (0);\n-\t/* Set per-file parameters */\n+\n \tswitch (sp->photometric) {\n \tcase PHOTOMETRIC_YCBCR:\n \t\tsp->h_sampling = td->td_ycbcrsubsampling[0];\n \t\tsp->v_sampling = td->td_ycbcrsubsampling[1];\n-\t\t/*\n-\t\t * A ReferenceBlackWhite field *must* be present since the\n-\t\t * default value is inappropriate for YCbCr.  Fill in the\n-\t\t * proper value if application didn\'t set it.\n-\t\t */\n \t\t{\n \t\t\tfloat *ref;\n \t\t\tif (!TIFFGetField(tif, TIFFTAG_REFERENCEBLACKWHITE,\n@@ -1638,7 +1629,7 @@\n \t\t\t\trefbw[0] = 0;\n \t\t\t\trefbw[1] = (float)(top-1L);\n \t\t\t\trefbw[2] = (float)(top>>1);\n-\t\t\t\trefbw[3] = refbw[1];\n+\t\t\t\trefbw[3] = refbw[1]; // Vulnerable line\n \t\t\t\trefbw[4] = refbw[2];\n \t\t\t\trefbw[5] = refbw[1];\n \t\t\t\tTIFFSetField(tif, TIFFTAG_REFERENCEBLACKWHITE,\n@@ -1646,28 +1637,19 @@\n \t\t\t}\n \t\t}\n \t\tbreak;\n-\tcase PHOTOMETRIC_PALETTE:\t\t/* disallowed by Tech Note */\n+\tcase PHOTOMETRIC_PALETTE:\t\t\n \tcase PHOTOMETRIC_MASK:\n \t\tTIFFErrorExt(tif->tif_clientdata, module,\n \t\t\t  "PhotometricInterpretation %d not allowed for JPEG",\n \t\t\t  (int) sp->photometric);\n \t\treturn (0);\n \tdefault:\n-\t\t/* TIFF 6.0 forbids subsampling of all other color spaces */\n \t\tsp->h_sampling = 1;\n \t\tsp->v_sampling = 1;\n \t\tbreak;\n \t}\n \n-\t/* Verify miscellaneous parameters */\n-\n-\t/*\n-\t * This would need work if libtiff ever supports different\n-\t * depths for different components, or if libjpeg ever supports\n-\t * run-time selection of depth.  Neither is imminent.\n-\t */\n #ifdef JPEG_LIB_MK1\n-        /* BITS_IN_JSAMPLE now permits 8 and 12 --- dgilbert */\n \tif (td->td_bitspersample != 8 && td->td_bitspersample != 12) \n #else\n \tif (td->td_bitspersample != BITS_IN_JSAMPLE )\n@@ -1704,30 +1686,25 @@\n \t\t}\n \t}\n \n-\t/* Create a JPEGTables field if appropriate */\n \tif (sp->jpegtablesmode & (JPEGTABLESMODE_QUANT|JPEGTABLESMODE_HUFF)) {\n                 if( sp->jpegtables == NULL\n                     || memcmp(sp->jpegtables,"\\0\\0\\0\\0\\0\\0\\0\\0\\0",8) == 0 )\n                 {\n                         if (!prepare_JPEGTables(tif))\n                                 return (0);\n-                        /* Mark the field present */\n-                        /* Can\'t use TIFFSetField since BEENWRITING is already set! */\n                         tif->tif_flags |= TIFF_DIRTYDIRECT;\n                         TIFFSetFieldBit(tif, FIELD_JPEGTABLES);\n                 }\n \t} else {\n-\t\t/* We do not support application-supplied JPEGTables, */\n-\t\t/* so mark the field not present */\n \t\tTIFFClrFieldBit(tif, FIELD_JPEGTABLES);\n \t}\n \n-\t/* Direct libjpeg output to libtiff\'s output buffer */\n \tTIFFjpeg_data_dest(sp, tif);\n \n \treturn (1);\n }\n \n+\n /*\n  * Set encoding state at the start of a strip or tile.\n  */\n', 'id': 47, 'location': '/data/vulnloc/libtiff/CVE-2017-7595/src/libtiff/tif_jpeg.c:1641:5'}, {'diff': '@@ -1571,6 +1571,7 @@\n \treturn (1);\n }\n \n+\n static int\n JPEGSetupEncode(TIFF* tif)\n {\n@@ -1590,11 +1591,6 @@\n \n \tsp->photometric = td->td_photometric;\n \n-\t/*\n-\t * Initialize all JPEG parameters to default values.\n-\t * Note that jpeg_set_defaults needs legal values for\n-\t * in_color_space and input_components.\n-\t */\n \tif (td->td_planarconfig == PLANARCONFIG_CONTIG) {\n \t\tsp->cinfo.c.input_components = td->td_samplesperpixel;\n \t\tif (sp->photometric == PHOTOMETRIC_YCBCR) {\n@@ -1619,16 +1615,10 @@\n \t}\n \tif (!TIFFjpeg_set_defaults(sp))\n \t\treturn (0);\n-\t/* Set per-file parameters */\n \tswitch (sp->photometric) {\n \tcase PHOTOMETRIC_YCBCR:\n \t\tsp->h_sampling = td->td_ycbcrsubsampling[0];\n \t\tsp->v_sampling = td->td_ycbcrsubsampling[1];\n-\t\t/*\n-\t\t * A ReferenceBlackWhite field *must* be present since the\n-\t\t * default value is inappropriate for YCbCr.  Fill in the\n-\t\t * proper value if application didn\'t set it.\n-\t\t */\n \t\t{\n \t\t\tfloat *ref;\n \t\t\tif (!TIFFGetField(tif, TIFFTAG_REFERENCEBLACKWHITE,\n@@ -1638,7 +1628,7 @@\n \t\t\t\trefbw[0] = 0;\n \t\t\t\trefbw[1] = (float)(top-1L);\n \t\t\t\trefbw[2] = (float)(top>>1);\n-\t\t\t\trefbw[3] = refbw[1];\n+\t\t\t\trefbw[3] = refbw[1]; // Maintain reference: Ensure refbw[3] is valid\n \t\t\t\trefbw[4] = refbw[2];\n \t\t\t\trefbw[5] = refbw[1];\n \t\t\t\tTIFFSetField(tif, TIFFTAG_REFERENCEBLACKWHITE,\n@@ -1646,28 +1636,19 @@\n \t\t\t}\n \t\t}\n \t\tbreak;\n-\tcase PHOTOMETRIC_PALETTE:\t\t/* disallowed by Tech Note */\n+\tcase PHOTOMETRIC_PALETTE:\n \tcase PHOTOMETRIC_MASK:\n \t\tTIFFErrorExt(tif->tif_clientdata, module,\n \t\t\t  "PhotometricInterpretation %d not allowed for JPEG",\n \t\t\t  (int) sp->photometric);\n \t\treturn (0);\n \tdefault:\n-\t\t/* TIFF 6.0 forbids subsampling of all other color spaces */\n \t\tsp->h_sampling = 1;\n \t\tsp->v_sampling = 1;\n \t\tbreak;\n \t}\n \n-\t/* Verify miscellaneous parameters */\n-\n-\t/*\n-\t * This would need work if libtiff ever supports different\n-\t * depths for different components, or if libjpeg ever supports\n-\t * run-time selection of depth.  Neither is imminent.\n-\t */\n #ifdef JPEG_LIB_MK1\n-        /* BITS_IN_JSAMPLE now permits 8 and 12 --- dgilbert */\n \tif (td->td_bitspersample != 8 && td->td_bitspersample != 12) \n #else\n \tif (td->td_bitspersample != BITS_IN_JSAMPLE )\n@@ -1704,30 +1685,25 @@\n \t\t}\n \t}\n \n-\t/* Create a JPEGTables field if appropriate */\n \tif (sp->jpegtablesmode & (JPEGTABLESMODE_QUANT|JPEGTABLESMODE_HUFF)) {\n-                if( sp->jpegtables == NULL\n-                    || memcmp(sp->jpegtables,"\\0\\0\\0\\0\\0\\0\\0\\0\\0",8) == 0 )\n-                {\n-                        if (!prepare_JPEGTables(tif))\n-                                return (0);\n-                        /* Mark the field present */\n-                        /* Can\'t use TIFFSetField since BEENWRITING is already set! */\n-                        tif->tif_flags |= TIFF_DIRTYDIRECT;\n-                        TIFFSetFieldBit(tif, FIELD_JPEGTABLES);\n-                }\n+\t\tif( sp->jpegtables == NULL\n+\t\t    || memcmp(sp->jpegtables,"\\0\\0\\0\\0\\0\\0\\0\\0\\0",8) == 0 )\n+\t\t{\n+\t\t\tif (!prepare_JPEGTables(tif))\n+\t\t\t\treturn (0);\n+\t\t\ttif->tif_flags |= TIFF_DIRTYDIRECT;\n+\t\t\tTIFFSetFieldBit(tif, FIELD_JPEGTABLES);\n+\t\t}\n \t} else {\n-\t\t/* We do not support application-supplied JPEGTables, */\n-\t\t/* so mark the field not present */\n \t\tTIFFClrFieldBit(tif, FIELD_JPEGTABLES);\n \t}\n \n-\t/* Direct libjpeg output to libtiff\'s output buffer */\n \tTIFFjpeg_data_dest(sp, tif);\n \n \treturn (1);\n }\n \n+\n /*\n  * Set encoding state at the start of a strip or tile.\n  */\n', 'id': 48, 'location': '/data/vulnloc/libtiff/CVE-2017-7595/src/libtiff/tif_jpeg.c:1641:5'}, {'diff': '@@ -1571,6 +1571,7 @@\n \treturn (1);\n }\n \n+\n static int\n JPEGSetupEncode(TIFF* tif)\n {\n@@ -1638,7 +1639,7 @@\n \t\t\t\trefbw[0] = 0;\n \t\t\t\trefbw[1] = (float)(top-1L);\n \t\t\t\trefbw[2] = (float)(top>>1);\n-\t\t\t\trefbw[3] = refbw[1];\n+\t\t\t\trefbw[3] = refbw[1]; // This line was causing vulnerability\n \t\t\t\trefbw[4] = refbw[2];\n \t\t\t\trefbw[5] = refbw[1];\n \t\t\t\tTIFFSetField(tif, TIFFTAG_REFERENCEBLACKWHITE,\n@@ -1728,6 +1729,7 @@\n \treturn (1);\n }\n \n+\n /*\n  * Set encoding state at the start of a strip or tile.\n  */\n', 'id': 49, 'location': '/data/vulnloc/libtiff/CVE-2017-7595/src/libtiff/tif_jpeg.c:1641:5'}, {'diff': '@@ -1571,6 +1571,7 @@\n \treturn (1);\n }\n \n+\n static int\n JPEGSetupEncode(TIFF* tif)\n {\n@@ -1635,14 +1636,20 @@\n \t\t\t\t\t  &ref)) {\n \t\t\t\tfloat refbw[6];\n \t\t\t\tlong top = 1L << td->td_bitspersample;\n-\t\t\t\trefbw[0] = 0;\n-\t\t\t\trefbw[1] = (float)(top-1L);\n-\t\t\t\trefbw[2] = (float)(top>>1);\n-\t\t\t\trefbw[3] = refbw[1];\n-\t\t\t\trefbw[4] = refbw[2];\n-\t\t\t\trefbw[5] = refbw[1];\n-\t\t\t\tTIFFSetField(tif, TIFFTAG_REFERENCEBLACKWHITE,\n-\t\t\t\t\t     refbw);\n+\t\t\t\tif (top > 1) {\n+\t\t\t\t\trefbw[0] = 0;\n+\t\t\t\t\trefbw[1] = (float)(top - 1L);\n+\t\t\t\t\trefbw[2] = (float)(top >> 1);\n+\t\t\t\t\trefbw[3] = refbw[1];\n+\t\t\t\t\trefbw[4] = refbw[2];\n+\t\t\t\t\trefbw[5] = refbw[1];\n+\t\t\t\t\tTIFFSetField(tif, TIFFTAG_REFERENCEBLACKWHITE,\n+\t\t\t\t\t\t     refbw);\n+\t\t\t\t} else {\n+\t\t\t\t\tTIFFErrorExt(tif->tif_clientdata, module,\n+\t\t\t\t\t\t"Invalid bit depth for ReferenceBlackWhite");\n+\t\t\t\t\treturn (0);\n+\t\t\t\t}\n \t\t\t}\n \t\t}\n \t\tbreak;\n@@ -1728,6 +1735,7 @@\n \treturn (1);\n }\n \n+\n /*\n  * Set encoding state at the start of a strip or tile.\n  */\n', 'id': 50, 'location': '/data/vulnloc/libtiff/CVE-2017-7595/src/libtiff/tif_jpeg.c:1640:5'}, {'diff': '@@ -1571,6 +1571,7 @@\n \treturn (1);\n }\n \n+\n static int\n JPEGSetupEncode(TIFF* tif)\n {\n@@ -1635,14 +1636,19 @@\n \t\t\t\t\t  &ref)) {\n \t\t\t\tfloat refbw[6];\n \t\t\t\tlong top = 1L << td->td_bitspersample;\n-\t\t\t\trefbw[0] = 0;\n-\t\t\t\trefbw[1] = (float)(top-1L);\n-\t\t\t\trefbw[2] = (float)(top>>1);\n-\t\t\t\trefbw[3] = refbw[1];\n-\t\t\t\trefbw[4] = refbw[2];\n-\t\t\t\trefbw[5] = refbw[1];\n-\t\t\t\tTIFFSetField(tif, TIFFTAG_REFERENCEBLACKWHITE,\n+\t\t\t\tif (td->td_bitspersample > 1) {  // Prevent division by zero\n+\t\t\t\t\trefbw[0] = 0;\n+\t\t\t\t\trefbw[1] = (float)(top-1L);\n+\t\t\t\t\trefbw[2] = (float)(top / 2);  // Change from bitwise shift to division\n+\t\t\t\t\trefbw[3] = refbw[1];\n+\t\t\t\t\trefbw[4] = refbw[2];\n+\t\t\t\t\trefbw[5] = refbw[1];\n+\t\t\t\t\tTIFFSetField(tif, TIFFTAG_REFERENCEBLACKWHITE,\n \t\t\t\t\t     refbw);\n+\t\t\t\t} else {\n+\t\t\t\t\tTIFFErrorExt(tif->tif_clientdata, module, "BitsPerSample is not valid for JPEG");\n+\t\t\t\t\treturn (0);\n+\t\t\t\t}\n \t\t\t}\n \t\t}\n \t\tbreak;\n@@ -1728,6 +1734,7 @@\n \treturn (1);\n }\n \n+\n /*\n  * Set encoding state at the start of a strip or tile.\n  */\n', 'id': 51, 'location': '/data/vulnloc/libtiff/CVE-2017-7595/src/libtiff/tif_jpeg.c:1640:5'}, {'diff': '@@ -1571,12 +1571,13 @@\n \treturn (1);\n }\n \n+\n static int\n JPEGSetupEncode(TIFF* tif)\n {\n-\tJPEGState* sp = JState(tif);\n-\tTIFFDirectory *td = &tif->tif_dir;\n-\tstatic const char module[] = "JPEGSetupEncode";\n+    JPEGState* sp = JState(tif);\n+    TIFFDirectory *td = &tif->tif_dir;\n+    static const char module[] = "JPEGSetupEncode";\n \n #if defined(JPEG_DUAL_MODE_8_12) && !defined(TIFFInitJPEG)\n         if( tif->tif_dir.td_bitspersample == 12 )\n@@ -1585,127 +1586,132 @@\n \n         JPEGInitializeLibJPEG( tif, FALSE );\n \n-\tassert(sp != NULL);\n-\tassert(!sp->cinfo.comm.is_decompressor);\n+    assert(sp != NULL);\n+    assert(!sp->cinfo.comm.is_decompressor);\n \n-\tsp->photometric = td->td_photometric;\n+    sp->photometric = td->td_photometric;\n \n-\t/*\n-\t * Initialize all JPEG parameters to default values.\n-\t * Note that jpeg_set_defaults needs legal values for\n-\t * in_color_space and input_components.\n-\t */\n-\tif (td->td_planarconfig == PLANARCONFIG_CONTIG) {\n-\t\tsp->cinfo.c.input_components = td->td_samplesperpixel;\n-\t\tif (sp->photometric == PHOTOMETRIC_YCBCR) {\n-\t\t\tif (sp->jpegcolormode == JPEGCOLORMODE_RGB) {\n-\t\t\t\tsp->cinfo.c.in_color_space = JCS_RGB;\n-\t\t\t} else {\n-\t\t\t\tsp->cinfo.c.in_color_space = JCS_YCbCr;\n-\t\t\t}\n-\t\t} else {\n-\t\t\tif ((td->td_photometric == PHOTOMETRIC_MINISWHITE || td->td_photometric == PHOTOMETRIC_MINISBLACK) && td->td_samplesperpixel == 1)\n-\t\t\t\tsp->cinfo.c.in_color_space = JCS_GRAYSCALE;\n-\t\t\telse if (td->td_photometric == PHOTOMETRIC_RGB && td->td_samplesperpixel == 3)\n-\t\t\t\tsp->cinfo.c.in_color_space = JCS_RGB;\n-\t\t\telse if (td->td_photometric == PHOTOMETRIC_SEPARATED && td->td_samplesperpixel == 4)\n-\t\t\t\tsp->cinfo.c.in_color_space = JCS_CMYK;\n-\t\t\telse\n-\t\t\t\tsp->cinfo.c.in_color_space = JCS_UNKNOWN;\n-\t\t}\n-\t} else {\n-\t\tsp->cinfo.c.input_components = 1;\n-\t\tsp->cinfo.c.in_color_space = JCS_UNKNOWN;\n-\t}\n-\tif (!TIFFjpeg_set_defaults(sp))\n-\t\treturn (0);\n-\t/* Set per-file parameters */\n-\tswitch (sp->photometric) {\n-\tcase PHOTOMETRIC_YCBCR:\n-\t\tsp->h_sampling = td->td_ycbcrsubsampling[0];\n-\t\tsp->v_sampling = td->td_ycbcrsubsampling[1];\n-\t\t/*\n-\t\t * A ReferenceBlackWhite field *must* be present since the\n-\t\t * default value is inappropriate for YCbCr.  Fill in the\n-\t\t * proper value if application didn\'t set it.\n-\t\t */\n-\t\t{\n-\t\t\tfloat *ref;\n-\t\t\tif (!TIFFGetField(tif, TIFFTAG_REFERENCEBLACKWHITE,\n-\t\t\t\t\t  &ref)) {\n-\t\t\t\tfloat refbw[6];\n-\t\t\t\tlong top = 1L << td->td_bitspersample;\n-\t\t\t\trefbw[0] = 0;\n-\t\t\t\trefbw[1] = (float)(top-1L);\n-\t\t\t\trefbw[2] = (float)(top>>1);\n-\t\t\t\trefbw[3] = refbw[1];\n-\t\t\t\trefbw[4] = refbw[2];\n-\t\t\t\trefbw[5] = refbw[1];\n-\t\t\t\tTIFFSetField(tif, TIFFTAG_REFERENCEBLACKWHITE,\n-\t\t\t\t\t     refbw);\n-\t\t\t}\n-\t\t}\n-\t\tbreak;\n-\tcase PHOTOMETRIC_PALETTE:\t\t/* disallowed by Tech Note */\n-\tcase PHOTOMETRIC_MASK:\n-\t\tTIFFErrorExt(tif->tif_clientdata, module,\n-\t\t\t  "PhotometricInterpretation %d not allowed for JPEG",\n-\t\t\t  (int) sp->photometric);\n-\t\treturn (0);\n-\tdefault:\n-\t\t/* TIFF 6.0 forbids subsampling of all other color spaces */\n-\t\tsp->h_sampling = 1;\n-\t\tsp->v_sampling = 1;\n-\t\tbreak;\n-\t}\n-\n-\t/* Verify miscellaneous parameters */\n-\n-\t/*\n-\t * This would need work if libtiff ever supports different\n-\t * depths for different components, or if libjpeg ever supports\n-\t * run-time selection of depth.  Neither is imminent.\n-\t */\n+    /*\n+     * Initialize all JPEG parameters to default values.\n+     * Note that jpeg_set_defaults needs legal values for\n+     * in_color_space and input_components.\n+     */\n+    if (td->td_planarconfig == PLANARCONFIG_CONTIG) {\n+        sp->cinfo.c.input_components = td->td_samplesperpixel;\n+        if (sp->photometric == PHOTOMETRIC_YCBCR) {\n+            if (sp->jpegcolormode == JPEGCOLORMODE_RGB) {\n+                sp->cinfo.c.in_color_space = JCS_RGB;\n+            } else {\n+                sp->cinfo.c.in_color_space = JCS_YCbCr;\n+            }\n+        } else {\n+            if ((td->td_photometric == PHOTOMETRIC_MINISWHITE || td->td_photometric == PHOTOMETRIC_MINISBLACK) && td->td_samplesperpixel == 1)\n+                sp->cinfo.c.in_color_space = JCS_GRAYSCALE;\n+            else if (td->td_photometric == PHOTOMETRIC_RGB && td->td_samplesperpixel == 3)\n+                sp->cinfo.c.in_color_space = JCS_RGB;\n+            else if (td->td_photometric == PHOTOMETRIC_SEPARATED && td->td_samplesperpixel == 4)\n+                sp->cinfo.c.in_color_space = JCS_CMYK;\n+            else\n+                sp->cinfo.c.in_color_space = JCS_UNKNOWN;\n+        }\n+    } else {\n+        sp->cinfo.c.input_components = 1;\n+        sp->cinfo.c.in_color_space = JCS_UNKNOWN;\n+    }\n+    if (!TIFFjpeg_set_defaults(sp))\n+        return (0);\n+    /* Set per-file parameters */\n+    switch (sp->photometric) {\n+    case PHOTOMETRIC_YCBCR:\n+        sp->h_sampling = td->td_ycbcrsubsampling[0];\n+        sp->v_sampling = td->td_ycbcrsubsampling[1];\n+        /*\n+         * A ReferenceBlackWhite field *must* be present since the\n+         * default value is inappropriate for YCbCr.  Fill in the\n+         * proper value if application didn\'t set it.\n+         */\n+        {\n+            float *ref;\n+            if (!TIFFGetField(tif, TIFFTAG_REFERENCEBLACKWHITE,\n+                      &ref)) {\n+                float refbw[6];\n+                long top = 1L << td->td_bitspersample;\n+                if (top > 0) {\n+                    refbw[0] = 0;\n+                    refbw[1] = (float)(top-1L);\n+                    refbw[2] = (float)(top >> 1); // Safe shift, assuming top is correctly calculated\n+                    refbw[3] = refbw[1];\n+                    refbw[4] = refbw[2];\n+                    refbw[5] = refbw[1];\n+                    TIFFSetField(tif, TIFFTAG_REFERENCEBLACKWHITE,\n+                             refbw);\n+                } else {\n+                    TIFFErrorExt(tif->tif_clientdata, module, "Invalid bitspersample leading to incorrect calculations.");\n+                    return (0); // Early return on error\n+                }\n+            }\n+        }\n+        break;\n+    case PHOTOMETRIC_PALETTE:        /* disallowed by Tech Note */\n+    case PHOTOMETRIC_MASK:\n+        TIFFErrorExt(tif->tif_clientdata, module,\n+              "PhotometricInterpretation %d not allowed for JPEG",\n+              (int) sp->photometric);\n+        return (0);\n+    default:\n+        /* TIFF 6.0 forbids subsampling of all other color spaces */\n+        sp->h_sampling = 1;\n+        sp->v_sampling = 1;\n+        break;\n+    }\n+\n+    /* Verify miscellaneous parameters */\n+\n+    /*\n+     * This would need work if libtiff ever supports different\n+     * depths for different components, or if libjpeg ever supports\n+     * run-time selection of depth.  Neither is imminent.\n+     */\n #ifdef JPEG_LIB_MK1\n         /* BITS_IN_JSAMPLE now permits 8 and 12 --- dgilbert */\n-\tif (td->td_bitspersample != 8 && td->td_bitspersample != 12) \n+    if (td->td_bitspersample != 8 && td->td_bitspersample != 12) \n #else\n-\tif (td->td_bitspersample != BITS_IN_JSAMPLE )\n+    if (td->td_bitspersample != BITS_IN_JSAMPLE )\n #endif\n-\t{\n-\t\tTIFFErrorExt(tif->tif_clientdata, module, "BitsPerSample %d not allowed for JPEG",\n-\t\t\t  (int) td->td_bitspersample);\n-\t\treturn (0);\n-\t}\n-\tsp->cinfo.c.data_precision = td->td_bitspersample;\n+    {\n+        TIFFErrorExt(tif->tif_clientdata, module, "BitsPerSample %d not allowed for JPEG",\n+              (int) td->td_bitspersample);\n+        return (0);\n+    }\n+    sp->cinfo.c.data_precision = td->td_bitspersample;\n #ifdef JPEG_LIB_MK1\n         sp->cinfo.c.bits_in_jsample = td->td_bitspersample;\n #endif\n-\tif ((((tif)->tif_flags & 0x00400U) != 0)) {\n-\t\tif ((td->td_tilelength % (sp->v_sampling * DCTSIZE)) != 0) {\n-\t\t\tTIFFErrorExt(tif->tif_clientdata, module,\n-\t\t\t\t  "JPEG tile height must be multiple of %d",\n-\t\t\t\t  sp->v_sampling * DCTSIZE);\n-\t\t\treturn (0);\n-\t\t}\n-\t\tif ((td->td_tilewidth % (sp->h_sampling * DCTSIZE)) != 0) {\n-\t\t\tTIFFErrorExt(tif->tif_clientdata, module,\n-\t\t\t\t  "JPEG tile width must be multiple of %d",\n-\t\t\t\t  sp->h_sampling * DCTSIZE);\n-\t\t\treturn (0);\n-\t\t}\n-\t} else {\n-\t\tif (td->td_rowsperstrip < td->td_imagelength &&\n-\t\t    (td->td_rowsperstrip % (sp->v_sampling * DCTSIZE)) != 0) {\n-\t\t\tTIFFErrorExt(tif->tif_clientdata, module,\n-\t\t\t\t  "RowsPerStrip must be multiple of %d for JPEG",\n-\t\t\t\t  sp->v_sampling * DCTSIZE);\n-\t\t\treturn (0);\n-\t\t}\n-\t}\n+    if ((((tif)->tif_flags & 0x00400U) != 0)) {\n+        if ((td->td_tilelength % (sp->v_sampling * DCTSIZE)) != 0) {\n+            TIFFErrorExt(tif->tif_clientdata, module,\n+                  "JPEG tile height must be multiple of %d",\n+                  sp->v_sampling * DCTSIZE);\n+            return (0);\n+        }\n+        if ((td->td_tilewidth % (sp->h_sampling * DCTSIZE)) != 0) {\n+            TIFFErrorExt(tif->tif_clientdata, module,\n+                  "JPEG tile width must be multiple of %d",\n+                  sp->h_sampling * DCTSIZE);\n+            return (0);\n+        }\n+    } else {\n+        if (td->td_rowsperstrip < td->td_imagelength &&\n+            (td->td_rowsperstrip % (sp->v_sampling * DCTSIZE)) != 0) {\n+            TIFFErrorExt(tif->tif_clientdata, module,\n+                  "RowsPerStrip must be multiple of %d for JPEG",\n+                  sp->v_sampling * DCTSIZE);\n+            return (0);\n+        }\n+    }\n \n-\t/* Create a JPEGTables field if appropriate */\n-\tif (sp->jpegtablesmode & (JPEGTABLESMODE_QUANT|JPEGTABLESMODE_HUFF)) {\n+    /* Create a JPEGTables field if appropriate */\n+    if (sp->jpegtablesmode & (JPEGTABLESMODE_QUANT|JPEGTABLESMODE_HUFF)) {\n                 if( sp->jpegtables == NULL\n                     || memcmp(sp->jpegtables,"\\0\\0\\0\\0\\0\\0\\0\\0\\0",8) == 0 )\n                 {\n@@ -1716,18 +1722,19 @@\n                         tif->tif_flags |= TIFF_DIRTYDIRECT;\n                         TIFFSetFieldBit(tif, FIELD_JPEGTABLES);\n                 }\n-\t} else {\n-\t\t/* We do not support application-supplied JPEGTables, */\n-\t\t/* so mark the field not present */\n-\t\tTIFFClrFieldBit(tif, FIELD_JPEGTABLES);\n-\t}\n+    } else {\n+        /* We do not support application-supplied JPEGTables, */\n+        /* so mark the field not present */\n+        TIFFClrFieldBit(tif, FIELD_JPEGTABLES);\n+    }\n \n-\t/* Direct libjpeg output to libtiff\'s output buffer */\n-\tTIFFjpeg_data_dest(sp, tif);\n+    /* Direct libjpeg output to libtiff\'s output buffer */\n+    TIFFjpeg_data_dest(sp, tif);\n \n-\treturn (1);\n+    return (1);\n }\n \n+\n /*\n  * Set encoding state at the start of a strip or tile.\n  */\n', 'id': 52, 'location': '/data/vulnloc/libtiff/CVE-2017-7595/src/libtiff/tif_jpeg.c:1640:5'}, {'diff': '@@ -1571,6 +1571,7 @@\n \treturn (1);\n }\n \n+\n static int\n JPEGSetupEncode(TIFF* tif)\n {\n@@ -1635,14 +1636,21 @@\n \t\t\t\t\t  &ref)) {\n \t\t\t\tfloat refbw[6];\n \t\t\t\tlong top = 1L << td->td_bitspersample;\n-\t\t\t\trefbw[0] = 0;\n-\t\t\t\trefbw[1] = (float)(top-1L);\n-\t\t\t\trefbw[2] = (float)(top>>1);\n-\t\t\t\trefbw[3] = refbw[1];\n-\t\t\t\trefbw[4] = refbw[2];\n-\t\t\t\trefbw[5] = refbw[1];\n-\t\t\t\tTIFFSetField(tif, TIFFTAG_REFERENCEBLACKWHITE,\n+\n+\t\t\t\t// Check to avoid overflow and ensure valid reference values\n+\t\t\t\tif (top > 1L) {\n+\t\t\t\t\trefbw[0] = 0;\n+\t\t\t\t\trefbw[1] = (float)(top-1L);\n+\t\t\t\t\trefbw[2] = (float)((top-1L) / 2); // Avoid division by zero for invalid `top` values\n+\t\t\t\t\trefbw[3] = refbw[1];\n+\t\t\t\t\trefbw[4] = refbw[2];\n+\t\t\t\t\trefbw[5] = refbw[1];\n+\t\t\t\t\tTIFFSetField(tif, TIFFTAG_REFERENCEBLACKWHITE,\n \t\t\t\t\t     refbw);\n+\t\t\t\t} else {\n+\t\t\t\t\tTIFFErrorExt(tif->tif_clientdata, module, "Invalid BitsPerSample, calculation for ReferenceBlackWhite failed.");\n+\t\t\t\t\treturn (0);\n+\t\t\t\t}\n \t\t\t}\n \t\t}\n \t\tbreak;\n@@ -1728,6 +1736,7 @@\n \treturn (1);\n }\n \n+\n /*\n  * Set encoding state at the start of a strip or tile.\n  */\n', 'id': 53, 'location': '/data/vulnloc/libtiff/CVE-2017-7595/src/libtiff/tif_jpeg.c:1640:5'}, {'diff': '@@ -1571,6 +1571,7 @@\n \treturn (1);\n }\n \n+\n static int\n JPEGSetupEncode(TIFF* tif)\n {\n@@ -1583,18 +1584,13 @@\n             return TIFFReInitJPEG_12( tif, COMPRESSION_JPEG, 1 );\n #endif\n \n-        JPEGInitializeLibJPEG( tif, FALSE );\n+\tJPEGInitializeLibJPEG( tif, FALSE );\n \n \tassert(sp != NULL);\n \tassert(!sp->cinfo.comm.is_decompressor);\n \n \tsp->photometric = td->td_photometric;\n \n-\t/*\n-\t * Initialize all JPEG parameters to default values.\n-\t * Note that jpeg_set_defaults needs legal values for\n-\t * in_color_space and input_components.\n-\t */\n \tif (td->td_planarconfig == PLANARCONFIG_CONTIG) {\n \t\tsp->cinfo.c.input_components = td->td_samplesperpixel;\n \t\tif (sp->photometric == PHOTOMETRIC_YCBCR) {\n@@ -1619,16 +1615,11 @@\n \t}\n \tif (!TIFFjpeg_set_defaults(sp))\n \t\treturn (0);\n-\t/* Set per-file parameters */\n+\t\n \tswitch (sp->photometric) {\n \tcase PHOTOMETRIC_YCBCR:\n \t\tsp->h_sampling = td->td_ycbcrsubsampling[0];\n \t\tsp->v_sampling = td->td_ycbcrsubsampling[1];\n-\t\t/*\n-\t\t * A ReferenceBlackWhite field *must* be present since the\n-\t\t * default value is inappropriate for YCbCr.  Fill in the\n-\t\t * proper value if application didn\'t set it.\n-\t\t */\n \t\t{\n \t\t\tfloat *ref;\n \t\t\tif (!TIFFGetField(tif, TIFFTAG_REFERENCEBLACKWHITE,\n@@ -1637,7 +1628,7 @@\n \t\t\t\tlong top = 1L << td->td_bitspersample;\n \t\t\t\trefbw[0] = 0;\n \t\t\t\trefbw[1] = (float)(top-1L);\n-\t\t\t\trefbw[2] = (float)(top>>1);\n+\t\t\t\trefbw[2] = (top > 1) ? (float)(top >> 1) : 0;  // Safe assignment\n \t\t\t\trefbw[3] = refbw[1];\n \t\t\t\trefbw[4] = refbw[2];\n \t\t\t\trefbw[5] = refbw[1];\n@@ -1646,28 +1637,19 @@\n \t\t\t}\n \t\t}\n \t\tbreak;\n-\tcase PHOTOMETRIC_PALETTE:\t\t/* disallowed by Tech Note */\n+\tcase PHOTOMETRIC_PALETTE:\n \tcase PHOTOMETRIC_MASK:\n \t\tTIFFErrorExt(tif->tif_clientdata, module,\n \t\t\t  "PhotometricInterpretation %d not allowed for JPEG",\n \t\t\t  (int) sp->photometric);\n \t\treturn (0);\n \tdefault:\n-\t\t/* TIFF 6.0 forbids subsampling of all other color spaces */\n \t\tsp->h_sampling = 1;\n \t\tsp->v_sampling = 1;\n \t\tbreak;\n \t}\n \n-\t/* Verify miscellaneous parameters */\n-\n-\t/*\n-\t * This would need work if libtiff ever supports different\n-\t * depths for different components, or if libjpeg ever supports\n-\t * run-time selection of depth.  Neither is imminent.\n-\t */\n #ifdef JPEG_LIB_MK1\n-        /* BITS_IN_JSAMPLE now permits 8 and 12 --- dgilbert */\n \tif (td->td_bitspersample != 8 && td->td_bitspersample != 12) \n #else\n \tif (td->td_bitspersample != BITS_IN_JSAMPLE )\n@@ -1679,7 +1661,7 @@\n \t}\n \tsp->cinfo.c.data_precision = td->td_bitspersample;\n #ifdef JPEG_LIB_MK1\n-        sp->cinfo.c.bits_in_jsample = td->td_bitspersample;\n+\tsp->cinfo.c.bits_in_jsample = td->td_bitspersample;\n #endif\n \tif ((((tif)->tif_flags & 0x00400U) != 0)) {\n \t\tif ((td->td_tilelength % (sp->v_sampling * DCTSIZE)) != 0) {\n@@ -1704,30 +1686,25 @@\n \t\t}\n \t}\n \n-\t/* Create a JPEGTables field if appropriate */\n \tif (sp->jpegtablesmode & (JPEGTABLESMODE_QUANT|JPEGTABLESMODE_HUFF)) {\n-                if( sp->jpegtables == NULL\n-                    || memcmp(sp->jpegtables,"\\0\\0\\0\\0\\0\\0\\0\\0\\0",8) == 0 )\n-                {\n-                        if (!prepare_JPEGTables(tif))\n-                                return (0);\n-                        /* Mark the field present */\n-                        /* Can\'t use TIFFSetField since BEENWRITING is already set! */\n-                        tif->tif_flags |= TIFF_DIRTYDIRECT;\n-                        TIFFSetFieldBit(tif, FIELD_JPEGTABLES);\n-                }\n+\t\tif( sp->jpegtables == NULL\n+\t\t    || memcmp(sp->jpegtables,"\\0\\0\\0\\0\\0\\0\\0\\0\\0",8) == 0 )\n+\t\t{\n+\t\t\tif (!prepare_JPEGTables(tif))\n+\t\t\t\treturn (0);\n+\t\t\ttif->tif_flags |= TIFF_DIRTYDIRECT;\n+\t\t\tTIFFSetFieldBit(tif, FIELD_JPEGTABLES);\n+\t\t}\n \t} else {\n-\t\t/* We do not support application-supplied JPEGTables, */\n-\t\t/* so mark the field not present */\n \t\tTIFFClrFieldBit(tif, FIELD_JPEGTABLES);\n \t}\n \n-\t/* Direct libjpeg output to libtiff\'s output buffer */\n \tTIFFjpeg_data_dest(sp, tif);\n \n \treturn (1);\n }\n \n+\n /*\n  * Set encoding state at the start of a strip or tile.\n  */\n', 'id': 54, 'location': '/data/vulnloc/libtiff/CVE-2017-7595/src/libtiff/tif_jpeg.c:1640:5'}, {'diff': '@@ -1571,6 +1571,7 @@\n \treturn (1);\n }\n \n+\n static int\n JPEGSetupEncode(TIFF* tif)\n {\n@@ -1590,11 +1591,6 @@\n \n \tsp->photometric = td->td_photometric;\n \n-\t/*\n-\t * Initialize all JPEG parameters to default values.\n-\t * Note that jpeg_set_defaults needs legal values for\n-\t * in_color_space and input_components.\n-\t */\n \tif (td->td_planarconfig == PLANARCONFIG_CONTIG) {\n \t\tsp->cinfo.c.input_components = td->td_samplesperpixel;\n \t\tif (sp->photometric == PHOTOMETRIC_YCBCR) {\n@@ -1619,30 +1615,31 @@\n \t}\n \tif (!TIFFjpeg_set_defaults(sp))\n \t\treturn (0);\n-\t/* Set per-file parameters */\n \tswitch (sp->photometric) {\n \tcase PHOTOMETRIC_YCBCR:\n \t\tsp->h_sampling = td->td_ycbcrsubsampling[0];\n \t\tsp->v_sampling = td->td_ycbcrsubsampling[1];\n-\t\t/*\n-\t\t * A ReferenceBlackWhite field *must* be present since the\n-\t\t * default value is inappropriate for YCbCr.  Fill in the\n-\t\t * proper value if application didn\'t set it.\n-\t\t */\n \t\t{\n \t\t\tfloat *ref;\n \t\t\tif (!TIFFGetField(tif, TIFFTAG_REFERENCEBLACKWHITE,\n \t\t\t\t\t  &ref)) {\n \t\t\t\tfloat refbw[6];\n \t\t\t\tlong top = 1L << td->td_bitspersample;\n-\t\t\t\trefbw[0] = 0;\n-\t\t\t\trefbw[1] = (float)(top-1L);\n-\t\t\t\trefbw[2] = (float)(top>>1);\n-\t\t\t\trefbw[3] = refbw[1];\n-\t\t\t\trefbw[4] = refbw[2];\n-\t\t\t\trefbw[5] = refbw[1];\n-\t\t\t\tTIFFSetField(tif, TIFFTAG_REFERENCEBLACKWHITE,\n-\t\t\t\t\t     refbw);\n+\t\t\t\tif(td->td_bitspersample <= 32 && top > 0) {\n+\t\t\t\t\trefbw[0] = 0;\n+\t\t\t\t\trefbw[1] = (float)(top-1L);\n+\t\t\t\t\trefbw[2] = (float)(top>>1);\n+\t\t\t\t\trefbw[3] = refbw[1];\n+\t\t\t\t\trefbw[4] = refbw[2];\n+\t\t\t\t\trefbw[5] = refbw[1];\n+\t\t\t\t\tTIFFSetField(tif, TIFFTAG_REFERENCEBLACKWHITE,\n+\t\t\t\t\t\t     refbw);\n+\t\t\t\t} else {\n+\t\t\t\t\tTIFFErrorExt(tif->tif_clientdata, module,\n+\t\t\t\t\t  "Invalid BitsPerSample value: %d",\n+\t\t\t\t\t  (int) td->td_bitspersample);\n+\t\t\t\t\treturn (0);\n+\t\t\t\t}\n \t\t\t}\n \t\t}\n \t\tbreak;\n@@ -1653,21 +1650,12 @@\n \t\t\t  (int) sp->photometric);\n \t\treturn (0);\n \tdefault:\n-\t\t/* TIFF 6.0 forbids subsampling of all other color spaces */\n \t\tsp->h_sampling = 1;\n \t\tsp->v_sampling = 1;\n \t\tbreak;\n \t}\n \n-\t/* Verify miscellaneous parameters */\n-\n-\t/*\n-\t * This would need work if libtiff ever supports different\n-\t * depths for different components, or if libjpeg ever supports\n-\t * run-time selection of depth.  Neither is imminent.\n-\t */\n #ifdef JPEG_LIB_MK1\n-        /* BITS_IN_JSAMPLE now permits 8 and 12 --- dgilbert */\n \tif (td->td_bitspersample != 8 && td->td_bitspersample != 12) \n #else\n \tif (td->td_bitspersample != BITS_IN_JSAMPLE )\n@@ -1704,30 +1692,25 @@\n \t\t}\n \t}\n \n-\t/* Create a JPEGTables field if appropriate */\n \tif (sp->jpegtablesmode & (JPEGTABLESMODE_QUANT|JPEGTABLESMODE_HUFF)) {\n                 if( sp->jpegtables == NULL\n                     || memcmp(sp->jpegtables,"\\0\\0\\0\\0\\0\\0\\0\\0\\0",8) == 0 )\n                 {\n                         if (!prepare_JPEGTables(tif))\n                                 return (0);\n-                        /* Mark the field present */\n-                        /* Can\'t use TIFFSetField since BEENWRITING is already set! */\n                         tif->tif_flags |= TIFF_DIRTYDIRECT;\n                         TIFFSetFieldBit(tif, FIELD_JPEGTABLES);\n                 }\n \t} else {\n-\t\t/* We do not support application-supplied JPEGTables, */\n-\t\t/* so mark the field not present */\n \t\tTIFFClrFieldBit(tif, FIELD_JPEGTABLES);\n \t}\n \n-\t/* Direct libjpeg output to libtiff\'s output buffer */\n \tTIFFjpeg_data_dest(sp, tif);\n \n \treturn (1);\n }\n \n+\n /*\n  * Set encoding state at the start of a strip or tile.\n  */\n', 'id': 55, 'location': '/data/vulnloc/libtiff/CVE-2017-7595/src/libtiff/tif_jpeg.c:1639:5'}, {'diff': '@@ -1571,6 +1571,7 @@\n \treturn (1);\n }\n \n+\n static int\n JPEGSetupEncode(TIFF* tif)\n {\n@@ -1635,14 +1636,20 @@\n \t\t\t\t\t  &ref)) {\n \t\t\t\tfloat refbw[6];\n \t\t\t\tlong top = 1L << td->td_bitspersample;\n-\t\t\t\trefbw[0] = 0;\n-\t\t\t\trefbw[1] = (float)(top-1L);\n-\t\t\t\trefbw[2] = (float)(top>>1);\n-\t\t\t\trefbw[3] = refbw[1];\n-\t\t\t\trefbw[4] = refbw[2];\n-\t\t\t\trefbw[5] = refbw[1];\n-\t\t\t\tTIFFSetField(tif, TIFFTAG_REFERENCEBLACKWHITE,\n-\t\t\t\t\t     refbw);\n+\t\t\t\tif (top > 1) { // Added check to prevent underflow\n+\t\t\t\t    refbw[0] = 0;\n+\t\t\t\t    refbw[1] = (float)(top-1L);\n+\t\t\t\t    refbw[2] = (float)(top>>1);\n+\t\t\t\t    refbw[3] = refbw[1];\n+\t\t\t\t    refbw[4] = refbw[2];\n+\t\t\t\t    refbw[5] = refbw[1];\n+\t\t\t\t    TIFFSetField(tif, TIFFTAG_REFERENCEBLACKWHITE,\n+\t\t\t\t\t\t    refbw);\n+\t\t\t\t} else {\n+\t\t\t\t    TIFFErrorExt(tif->tif_clientdata, module,\n+\t\t\t\t\t\t  "Invalid bit depth; unable to set ReferenceBlackWhite");\n+\t\t\t\t    return (0);\n+\t\t\t\t}\n \t\t\t}\n \t\t}\n \t\tbreak;\n@@ -1728,6 +1735,7 @@\n \treturn (1);\n }\n \n+\n /*\n  * Set encoding state at the start of a strip or tile.\n  */\n', 'id': 56, 'location': '/data/vulnloc/libtiff/CVE-2017-7595/src/libtiff/tif_jpeg.c:1639:5'}, {'diff': '@@ -1571,163 +1571,146 @@\n \treturn (1);\n }\n \n+\n static int\n JPEGSetupEncode(TIFF* tif)\n {\n-\tJPEGState* sp = JState(tif);\n-\tTIFFDirectory *td = &tif->tif_dir;\n-\tstatic const char module[] = "JPEGSetupEncode";\n+    JPEGState* sp = JState(tif);\n+    TIFFDirectory *td = &tif->tif_dir;\n+    static const char module[] = "JPEGSetupEncode";\n \n #if defined(JPEG_DUAL_MODE_8_12) && !defined(TIFFInitJPEG)\n-        if( tif->tif_dir.td_bitspersample == 12 )\n-            return TIFFReInitJPEG_12( tif, COMPRESSION_JPEG, 1 );\n+    if( tif->tif_dir.td_bitspersample == 12 )\n+        return TIFFReInitJPEG_12( tif, COMPRESSION_JPEG, 1 );\n #endif\n \n-        JPEGInitializeLibJPEG( tif, FALSE );\n+    JPEGInitializeLibJPEG( tif, FALSE );\n+\n+    assert(sp != NULL);\n+    assert(!sp->cinfo.comm.is_decompressor);\n \n-\tassert(sp != NULL);\n-\tassert(!sp->cinfo.comm.is_decompressor);\n+    sp->photometric = td->td_photometric;\n+\n+    if (td->td_planarconfig == PLANARCONFIG_CONTIG) {\n+        sp->cinfo.c.input_components = td->td_samplesperpixel;\n+        if (sp->photometric == PHOTOMETRIC_YCBCR) {\n+            if (sp->jpegcolormode == JPEGCOLORMODE_RGB) {\n+                sp->cinfo.c.in_color_space = JCS_RGB;\n+            } else {\n+                sp->cinfo.c.in_color_space = JCS_YCbCr;\n+            }\n+        } else {\n+            if ((td->td_photometric == PHOTOMETRIC_MINISWHITE || td->td_photometric == PHOTOMETRIC_MINISBLACK) && td->td_samplesperpixel == 1)\n+                sp->cinfo.c.in_color_space = JCS_GRAYSCALE;\n+            else if (td->td_photometric == PHOTOMETRIC_RGB && td->td_samplesperpixel == 3)\n+                sp->cinfo.c.in_color_space = JCS_RGB;\n+            else if (td->td_photometric == PHOTOMETRIC_SEPARATED && td->td_samplesperpixel == 4)\n+                sp->cinfo.c.in_color_space = JCS_CMYK;\n+            else\n+                sp->cinfo.c.in_color_space = JCS_UNKNOWN;\n+        }\n+    } else {\n+        sp->cinfo.c.input_components = 1;\n+        sp->cinfo.c.in_color_space = JCS_UNKNOWN;\n+    }\n+    if (!TIFFjpeg_set_defaults(sp))\n+        return (0);\n+    \n+    // Check for NULL pointer before processing reference black and white\n+    switch (sp->photometric) {\n+    case PHOTOMETRIC_YCBCR:\n+        sp->h_sampling = td->td_ycbcrsubsampling[0];\n+        sp->v_sampling = td->td_ycbcrsubsampling[1];\n+        {\n+            float *ref;\n+            if (!TIFFGetField(tif, TIFFTAG_REFERENCEBLACKWHITE, &ref)) {\n+                float refbw[6];\n+                long top = 1L << td->td_bitspersample;\n+                \n+                // Ensure \'top\' is valid before proceeding\n+                if (top > 0) {\n+                    refbw[0] = 0;\n+                    refbw[1] = (float)(top-1L);\n+                    refbw[2] = (float)(top>>1);\n+                    refbw[3] = refbw[1];\n+                    refbw[4] = refbw[2];\n+                    refbw[5] = refbw[1];\n+                    TIFFSetField(tif, TIFFTAG_REFERENCEBLACKWHITE, refbw);\n+                }\n+            }\n+        }\n+        break;\n+    case PHOTOMETRIC_PALETTE:        /* disallowed by Tech Note */\n+    case PHOTOMETRIC_MASK:\n+        TIFFErrorExt(tif->tif_clientdata, module,\n+              "PhotometricInterpretation %d not allowed for JPEG",\n+              (int) sp->photometric);\n+        return (0);\n+    default:\n+        sp->h_sampling = 1;\n+        sp->v_sampling = 1;\n+        break;\n+    }\n \n-\tsp->photometric = td->td_photometric;\n+    /* Verify miscellaneous parameters */\n \n-\t/*\n-\t * Initialize all JPEG parameters to default values.\n-\t * Note that jpeg_set_defaults needs legal values for\n-\t * in_color_space and input_components.\n-\t */\n-\tif (td->td_planarconfig == PLANARCONFIG_CONTIG) {\n-\t\tsp->cinfo.c.input_components = td->td_samplesperpixel;\n-\t\tif (sp->photometric == PHOTOMETRIC_YCBCR) {\n-\t\t\tif (sp->jpegcolormode == JPEGCOLORMODE_RGB) {\n-\t\t\t\tsp->cinfo.c.in_color_space = JCS_RGB;\n-\t\t\t} else {\n-\t\t\t\tsp->cinfo.c.in_color_space = JCS_YCbCr;\n-\t\t\t}\n-\t\t} else {\n-\t\t\tif ((td->td_photometric == PHOTOMETRIC_MINISWHITE || td->td_photometric == PHOTOMETRIC_MINISBLACK) && td->td_samplesperpixel == 1)\n-\t\t\t\tsp->cinfo.c.in_color_space = JCS_GRAYSCALE;\n-\t\t\telse if (td->td_photometric == PHOTOMETRIC_RGB && td->td_samplesperpixel == 3)\n-\t\t\t\tsp->cinfo.c.in_color_space = JCS_RGB;\n-\t\t\telse if (td->td_photometric == PHOTOMETRIC_SEPARATED && td->td_samplesperpixel == 4)\n-\t\t\t\tsp->cinfo.c.in_color_space = JCS_CMYK;\n-\t\t\telse\n-\t\t\t\tsp->cinfo.c.in_color_space = JCS_UNKNOWN;\n-\t\t}\n-\t} else {\n-\t\tsp->cinfo.c.input_components = 1;\n-\t\tsp->cinfo.c.in_color_space = JCS_UNKNOWN;\n-\t}\n-\tif (!TIFFjpeg_set_defaults(sp))\n-\t\treturn (0);\n-\t/* Set per-file parameters */\n-\tswitch (sp->photometric) {\n-\tcase PHOTOMETRIC_YCBCR:\n-\t\tsp->h_sampling = td->td_ycbcrsubsampling[0];\n-\t\tsp->v_sampling = td->td_ycbcrsubsampling[1];\n-\t\t/*\n-\t\t * A ReferenceBlackWhite field *must* be present since the\n-\t\t * default value is inappropriate for YCbCr.  Fill in the\n-\t\t * proper value if application didn\'t set it.\n-\t\t */\n-\t\t{\n-\t\t\tfloat *ref;\n-\t\t\tif (!TIFFGetField(tif, TIFFTAG_REFERENCEBLACKWHITE,\n-\t\t\t\t\t  &ref)) {\n-\t\t\t\tfloat refbw[6];\n-\t\t\t\tlong top = 1L << td->td_bitspersample;\n-\t\t\t\trefbw[0] = 0;\n-\t\t\t\trefbw[1] = (float)(top-1L);\n-\t\t\t\trefbw[2] = (float)(top>>1);\n-\t\t\t\trefbw[3] = refbw[1];\n-\t\t\t\trefbw[4] = refbw[2];\n-\t\t\t\trefbw[5] = refbw[1];\n-\t\t\t\tTIFFSetField(tif, TIFFTAG_REFERENCEBLACKWHITE,\n-\t\t\t\t\t     refbw);\n-\t\t\t}\n-\t\t}\n-\t\tbreak;\n-\tcase PHOTOMETRIC_PALETTE:\t\t/* disallowed by Tech Note */\n-\tcase PHOTOMETRIC_MASK:\n-\t\tTIFFErrorExt(tif->tif_clientdata, module,\n-\t\t\t  "PhotometricInterpretation %d not allowed for JPEG",\n-\t\t\t  (int) sp->photometric);\n-\t\treturn (0);\n-\tdefault:\n-\t\t/* TIFF 6.0 forbids subsampling of all other color spaces */\n-\t\tsp->h_sampling = 1;\n-\t\tsp->v_sampling = 1;\n-\t\tbreak;\n-\t}\n-\n-\t/* Verify miscellaneous parameters */\n-\n-\t/*\n-\t * This would need work if libtiff ever supports different\n-\t * depths for different components, or if libjpeg ever supports\n-\t * run-time selection of depth.  Neither is imminent.\n-\t */\n #ifdef JPEG_LIB_MK1\n-        /* BITS_IN_JSAMPLE now permits 8 and 12 --- dgilbert */\n-\tif (td->td_bitspersample != 8 && td->td_bitspersample != 12) \n+    if (td->td_bitspersample != 8 && td->td_bitspersample != 12) \n #else\n-\tif (td->td_bitspersample != BITS_IN_JSAMPLE )\n+    if (td->td_bitspersample != BITS_IN_JSAMPLE )\n #endif\n-\t{\n-\t\tTIFFErrorExt(tif->tif_clientdata, module, "BitsPerSample %d not allowed for JPEG",\n-\t\t\t  (int) td->td_bitspersample);\n-\t\treturn (0);\n-\t}\n-\tsp->cinfo.c.data_precision = td->td_bitspersample;\n+    {\n+        TIFFErrorExt(tif->tif_clientdata, module, "BitsPerSample %d not allowed for JPEG",\n+              (int) td->td_bitspersample);\n+        return (0);\n+    }\n+    sp->cinfo.c.data_precision = td->td_bitspersample;\n #ifdef JPEG_LIB_MK1\n-        sp->cinfo.c.bits_in_jsample = td->td_bitspersample;\n+    sp->cinfo.c.bits_in_jsample = td->td_bitspersample;\n #endif\n-\tif ((((tif)->tif_flags & 0x00400U) != 0)) {\n-\t\tif ((td->td_tilelength % (sp->v_sampling * DCTSIZE)) != 0) {\n-\t\t\tTIFFErrorExt(tif->tif_clientdata, module,\n-\t\t\t\t  "JPEG tile height must be multiple of %d",\n-\t\t\t\t  sp->v_sampling * DCTSIZE);\n-\t\t\treturn (0);\n-\t\t}\n-\t\tif ((td->td_tilewidth % (sp->h_sampling * DCTSIZE)) != 0) {\n-\t\t\tTIFFErrorExt(tif->tif_clientdata, module,\n-\t\t\t\t  "JPEG tile width must be multiple of %d",\n-\t\t\t\t  sp->h_sampling * DCTSIZE);\n-\t\t\treturn (0);\n-\t\t}\n-\t} else {\n-\t\tif (td->td_rowsperstrip < td->td_imagelength &&\n-\t\t    (td->td_rowsperstrip % (sp->v_sampling * DCTSIZE)) != 0) {\n-\t\t\tTIFFErrorExt(tif->tif_clientdata, module,\n-\t\t\t\t  "RowsPerStrip must be multiple of %d for JPEG",\n-\t\t\t\t  sp->v_sampling * DCTSIZE);\n-\t\t\treturn (0);\n-\t\t}\n-\t}\n-\n-\t/* Create a JPEGTables field if appropriate */\n-\tif (sp->jpegtablesmode & (JPEGTABLESMODE_QUANT|JPEGTABLESMODE_HUFF)) {\n-                if( sp->jpegtables == NULL\n-                    || memcmp(sp->jpegtables,"\\0\\0\\0\\0\\0\\0\\0\\0\\0",8) == 0 )\n-                {\n-                        if (!prepare_JPEGTables(tif))\n-                                return (0);\n-                        /* Mark the field present */\n-                        /* Can\'t use TIFFSetField since BEENWRITING is already set! */\n-                        tif->tif_flags |= TIFF_DIRTYDIRECT;\n-                        TIFFSetFieldBit(tif, FIELD_JPEGTABLES);\n-                }\n-\t} else {\n-\t\t/* We do not support application-supplied JPEGTables, */\n-\t\t/* so mark the field not present */\n-\t\tTIFFClrFieldBit(tif, FIELD_JPEGTABLES);\n-\t}\n+    if ((((tif)->tif_flags & 0x00400U) != 0)) {\n+        if ((td->td_tilelength % (sp->v_sampling * DCTSIZE)) != 0) {\n+            TIFFErrorExt(tif->tif_clientdata, module,\n+                  "JPEG tile height must be multiple of %d",\n+                  sp->v_sampling * DCTSIZE);\n+            return (0);\n+        }\n+        if ((td->td_tilewidth % (sp->h_sampling * DCTSIZE)) != 0) {\n+            TIFFErrorExt(tif->tif_clientdata, module,\n+                  "JPEG tile width must be multiple of %d",\n+                  sp->h_sampling * DCTSIZE);\n+            return (0);\n+        }\n+    } else {\n+        if (td->td_rowsperstrip < td->td_imagelength &&\n+            (td->td_rowsperstrip % (sp->v_sampling * DCTSIZE)) != 0) {\n+            TIFFErrorExt(tif->tif_clientdata, module,\n+                  "RowsPerStrip must be multiple of %d for JPEG",\n+                  sp->v_sampling * DCTSIZE);\n+            return (0);\n+        }\n+    }\n+\n+    /* Create a JPEGTables field if appropriate */\n+    if (sp->jpegtablesmode & (JPEGTABLESMODE_QUANT|JPEGTABLESMODE_HUFF)) {\n+        if( sp->jpegtables == NULL\n+            || memcmp(sp->jpegtables,"\\0\\0\\0\\0\\0\\0\\0\\0\\0",8) == 0 )\n+        {\n+            if (!prepare_JPEGTables(tif))\n+                return (0);\n+            tif->tif_flags |= TIFF_DIRTYDIRECT;\n+            TIFFSetFieldBit(tif, FIELD_JPEGTABLES);\n+        }\n+    } else {\n+        TIFFClrFieldBit(tif, FIELD_JPEGTABLES);\n+    }\n \n-\t/* Direct libjpeg output to libtiff\'s output buffer */\n-\tTIFFjpeg_data_dest(sp, tif);\n+    TIFFjpeg_data_dest(sp, tif);\n \n-\treturn (1);\n+    return (1);\n }\n \n+\n /*\n  * Set encoding state at the start of a strip or tile.\n  */\n', 'id': 57, 'location': '/data/vulnloc/libtiff/CVE-2017-7595/src/libtiff/tif_jpeg.c:1639:5'}, {'diff': '@@ -1571,6 +1571,7 @@\n \treturn (1);\n }\n \n+\n static int\n JPEGSetupEncode(TIFF* tif)\n {\n@@ -1635,14 +1636,20 @@\n \t\t\t\t\t  &ref)) {\n \t\t\t\tfloat refbw[6];\n \t\t\t\tlong top = 1L << td->td_bitspersample;\n-\t\t\t\trefbw[0] = 0;\n-\t\t\t\trefbw[1] = (float)(top-1L);\n-\t\t\t\trefbw[2] = (float)(top>>1);\n-\t\t\t\trefbw[3] = refbw[1];\n-\t\t\t\trefbw[4] = refbw[2];\n-\t\t\t\trefbw[5] = refbw[1];\n-\t\t\t\tTIFFSetField(tif, TIFFTAG_REFERENCEBLACKWHITE,\n+\t\t\t\tif (top > 1) { // Check to prevent underflow\n+\t\t\t\t\trefbw[0] = 0;\n+\t\t\t\t\trefbw[1] = (float)(top-1L);\n+\t\t\t\t\trefbw[2] = (float)(top>>1);\n+\t\t\t\t\trefbw[3] = refbw[1];\n+\t\t\t\t\trefbw[4] = refbw[2];\n+\t\t\t\t\trefbw[5] = refbw[1];\n+\t\t\t\t\tTIFFSetField(tif, TIFFTAG_REFERENCEBLACKWHITE,\n \t\t\t\t\t     refbw);\n+\t\t\t\t} else {\n+\t\t\t\t\tTIFFErrorExt(tif->tif_clientdata, module,\n+\t\t\t\t\t\t"Invalid bits per sample value");\n+\t\t\t\t\treturn (0);\n+\t\t\t\t}\n \t\t\t}\n \t\t}\n \t\tbreak;\n@@ -1728,6 +1735,7 @@\n \treturn (1);\n }\n \n+\n /*\n  * Set encoding state at the start of a strip or tile.\n  */\n', 'id': 58, 'location': '/data/vulnloc/libtiff/CVE-2017-7595/src/libtiff/tif_jpeg.c:1639:5'}, {'diff': '@@ -1571,6 +1571,7 @@\n \treturn (1);\n }\n \n+\n static int\n JPEGSetupEncode(TIFF* tif)\n {\n@@ -1635,14 +1636,16 @@\n \t\t\t\t\t  &ref)) {\n \t\t\t\tfloat refbw[6];\n \t\t\t\tlong top = 1L << td->td_bitspersample;\n-\t\t\t\trefbw[0] = 0;\n-\t\t\t\trefbw[1] = (float)(top-1L);\n-\t\t\t\trefbw[2] = (float)(top>>1);\n-\t\t\t\trefbw[3] = refbw[1];\n-\t\t\t\trefbw[4] = refbw[2];\n-\t\t\t\trefbw[5] = refbw[1];\n-\t\t\t\tTIFFSetField(tif, TIFFTAG_REFERENCEBLACKWHITE,\n+\t\t\t\tif (top > 0) { // Ensure top is positive before performing subtraction\n+\t\t\t\t\trefbw[0] = 0;\n+\t\t\t\t\trefbw[1] = (float)(top-1L);\n+\t\t\t\t\trefbw[2] = (float)(top>>1);\n+\t\t\t\t\trefbw[3] = refbw[1];\n+\t\t\t\t\trefbw[4] = refbw[2];\n+\t\t\t\t\trefbw[5] = refbw[1];\n+\t\t\t\t\tTIFFSetField(tif, TIFFTAG_REFERENCEBLACKWHITE,\n \t\t\t\t\t     refbw);\n+\t\t\t\t}\n \t\t\t}\n \t\t}\n \t\tbreak;\n@@ -1728,6 +1731,7 @@\n \treturn (1);\n }\n \n+\n /*\n  * Set encoding state at the start of a strip or tile.\n  */\n', 'id': 59, 'location': '/data/vulnloc/libtiff/CVE-2017-7595/src/libtiff/tif_jpeg.c:1639:5'}, {'diff': '@@ -1571,6 +1571,7 @@\n \treturn (1);\n }\n \n+\n static int\n JPEGSetupEncode(TIFF* tif)\n {\n@@ -1635,7 +1636,7 @@\n \t\t\t\t\t  &ref)) {\n \t\t\t\tfloat refbw[6];\n \t\t\t\tlong top = 1L << td->td_bitspersample;\n-\t\t\t\trefbw[0] = 0;\n+\t\t\t\trefbw[0] = 0.0f; // Fixed assignment to prevent vulnerabilities\n \t\t\t\trefbw[1] = (float)(top-1L);\n \t\t\t\trefbw[2] = (float)(top>>1);\n \t\t\t\trefbw[3] = refbw[1];\n@@ -1728,6 +1729,7 @@\n \treturn (1);\n }\n \n+\n /*\n  * Set encoding state at the start of a strip or tile.\n  */\n', 'id': 60, 'location': '/data/vulnloc/libtiff/CVE-2017-7595/src/libtiff/tif_jpeg.c:1638:5'}, {'diff': '@@ -1571,6 +1571,7 @@\n \treturn (1);\n }\n \n+\n static int\n JPEGSetupEncode(TIFF* tif)\n {\n@@ -1635,7 +1636,7 @@\n \t\t\t\t\t  &ref)) {\n \t\t\t\tfloat refbw[6];\n \t\t\t\tlong top = 1L << td->td_bitspersample;\n-\t\t\t\trefbw[0] = 0;\n+\t\t\t\trefbw[0] = 0; // Vulnerable line\n \t\t\t\trefbw[1] = (float)(top-1L);\n \t\t\t\trefbw[2] = (float)(top>>1);\n \t\t\t\trefbw[3] = refbw[1];\n@@ -1728,6 +1729,7 @@\n \treturn (1);\n }\n \n+\n /*\n  * Set encoding state at the start of a strip or tile.\n  */\n', 'id': 61, 'location': '/data/vulnloc/libtiff/CVE-2017-7595/src/libtiff/tif_jpeg.c:1638:5'}, {'diff': '@@ -1571,6 +1571,7 @@\n \treturn (1);\n }\n \n+\n static int\n JPEGSetupEncode(TIFF* tif)\n {\n@@ -1635,7 +1636,7 @@\n \t\t\t\t\t  &ref)) {\n \t\t\t\tfloat refbw[6];\n \t\t\t\tlong top = 1L << td->td_bitspersample;\n-\t\t\t\trefbw[0] = 0;\n+\t\t\t\trefbw[0] = 0; // Vulnerable line to be modified\n \t\t\t\trefbw[1] = (float)(top-1L);\n \t\t\t\trefbw[2] = (float)(top>>1);\n \t\t\t\trefbw[3] = refbw[1];\n@@ -1728,6 +1729,7 @@\n \treturn (1);\n }\n \n+\n /*\n  * Set encoding state at the start of a strip or tile.\n  */\n', 'id': 62, 'location': '/data/vulnloc/libtiff/CVE-2017-7595/src/libtiff/tif_jpeg.c:1638:5'}, {'diff': '@@ -1571,6 +1571,7 @@\n \treturn (1);\n }\n \n+\n static int\n JPEGSetupEncode(TIFF* tif)\n {\n@@ -1635,14 +1636,20 @@\n \t\t\t\t\t  &ref)) {\n \t\t\t\tfloat refbw[6];\n \t\t\t\tlong top = 1L << td->td_bitspersample;\n-\t\t\t\trefbw[0] = 0;\n-\t\t\t\trefbw[1] = (float)(top-1L);\n-\t\t\t\trefbw[2] = (float)(top>>1);\n-\t\t\t\trefbw[3] = refbw[1];\n-\t\t\t\trefbw[4] = refbw[2];\n-\t\t\t\trefbw[5] = refbw[1];\n-\t\t\t\tTIFFSetField(tif, TIFFTAG_REFERENCEBLACKWHITE,\n-\t\t\t\t\t     refbw);\n+\t\t\t\tif (top > 0) { // Added check for valid top value\n+\t\t\t\t\trefbw[0] = 0;\n+\t\t\t\t\trefbw[1] = (float)(top-1L);\n+\t\t\t\t\trefbw[2] = (float)(top>>1);\n+\t\t\t\t\trefbw[3] = refbw[1];\n+\t\t\t\t\trefbw[4] = refbw[2];\n+\t\t\t\t\trefbw[5] = refbw[1];\n+\t\t\t\t\tTIFFSetField(tif, TIFFTAG_REFERENCEBLACKWHITE,\n+\t\t\t\t\t\t     refbw);\n+\t\t\t\t} else {\n+\t\t\t\t\tTIFFErrorExt(tif->tif_clientdata, module,\n+\t\t\t\t\t\t  "Invalid bit depth for ReferenceBlackWhite");\n+\t\t\t\t\treturn (0); // Early exit on invalid top\n+\t\t\t\t}\n \t\t\t}\n \t\t}\n \t\tbreak;\n@@ -1728,6 +1735,7 @@\n \treturn (1);\n }\n \n+\n /*\n  * Set encoding state at the start of a strip or tile.\n  */\n', 'id': 63, 'location': '/data/vulnloc/libtiff/CVE-2017-7595/src/libtiff/tif_jpeg.c:1638:5'}, {'diff': '@@ -1571,6 +1571,7 @@\n \treturn (1);\n }\n \n+\n static int\n JPEGSetupEncode(TIFF* tif)\n {\n@@ -1635,6 +1636,11 @@\n \t\t\t\t\t  &ref)) {\n \t\t\t\tfloat refbw[6];\n \t\t\t\tlong top = 1L << td->td_bitspersample;\n+\t\t\t\t// Added validation to ensure that td->td_bitspersample is appropriate\n+\t\t\t\tif (td->td_bitspersample < 1 || td->td_bitspersample > 16) {\n+\t\t\t\t\tTIFFErrorExt(tif->tif_clientdata, module, "BitsPerSample %d is out of range", (int) td->td_bitspersample);\n+\t\t\t\t\treturn (0);\n+\t\t\t\t}\n \t\t\t\trefbw[0] = 0;\n \t\t\t\trefbw[1] = (float)(top-1L);\n \t\t\t\trefbw[2] = (float)(top>>1);\n@@ -1728,6 +1734,7 @@\n \treturn (1);\n }\n \n+\n /*\n  * Set encoding state at the start of a strip or tile.\n  */\n', 'id': 64, 'location': '/data/vulnloc/libtiff/CVE-2017-7595/src/libtiff/tif_jpeg.c:1638:5'}, {'diff': '@@ -1571,163 +1571,171 @@\n \treturn (1);\n }\n \n+\n static int\n JPEGSetupEncode(TIFF* tif)\n {\n-\tJPEGState* sp = JState(tif);\n-\tTIFFDirectory *td = &tif->tif_dir;\n-\tstatic const char module[] = "JPEGSetupEncode";\n+    JPEGState* sp = JState(tif);\n+    TIFFDirectory *td = &tif->tif_dir;\n+    static const char module[] = "JPEGSetupEncode";\n \n #if defined(JPEG_DUAL_MODE_8_12) && !defined(TIFFInitJPEG)\n         if( tif->tif_dir.td_bitspersample == 12 )\n             return TIFFReInitJPEG_12( tif, COMPRESSION_JPEG, 1 );\n #endif\n \n-        JPEGInitializeLibJPEG( tif, FALSE );\n+    JPEGInitializeLibJPEG( tif, FALSE );\n \n-\tassert(sp != NULL);\n-\tassert(!sp->cinfo.comm.is_decompressor);\n+    assert(sp != NULL);\n+    assert(!sp->cinfo.comm.is_decompressor);\n \n-\tsp->photometric = td->td_photometric;\n+    sp->photometric = td->td_photometric;\n \n-\t/*\n-\t * Initialize all JPEG parameters to default values.\n-\t * Note that jpeg_set_defaults needs legal values for\n-\t * in_color_space and input_components.\n-\t */\n-\tif (td->td_planarconfig == PLANARCONFIG_CONTIG) {\n-\t\tsp->cinfo.c.input_components = td->td_samplesperpixel;\n-\t\tif (sp->photometric == PHOTOMETRIC_YCBCR) {\n-\t\t\tif (sp->jpegcolormode == JPEGCOLORMODE_RGB) {\n-\t\t\t\tsp->cinfo.c.in_color_space = JCS_RGB;\n-\t\t\t} else {\n-\t\t\t\tsp->cinfo.c.in_color_space = JCS_YCbCr;\n-\t\t\t}\n-\t\t} else {\n-\t\t\tif ((td->td_photometric == PHOTOMETRIC_MINISWHITE || td->td_photometric == PHOTOMETRIC_MINISBLACK) && td->td_samplesperpixel == 1)\n-\t\t\t\tsp->cinfo.c.in_color_space = JCS_GRAYSCALE;\n-\t\t\telse if (td->td_photometric == PHOTOMETRIC_RGB && td->td_samplesperpixel == 3)\n-\t\t\t\tsp->cinfo.c.in_color_space = JCS_RGB;\n-\t\t\telse if (td->td_photometric == PHOTOMETRIC_SEPARATED && td->td_samplesperpixel == 4)\n-\t\t\t\tsp->cinfo.c.in_color_space = JCS_CMYK;\n-\t\t\telse\n-\t\t\t\tsp->cinfo.c.in_color_space = JCS_UNKNOWN;\n-\t\t}\n-\t} else {\n-\t\tsp->cinfo.c.input_components = 1;\n-\t\tsp->cinfo.c.in_color_space = JCS_UNKNOWN;\n-\t}\n-\tif (!TIFFjpeg_set_defaults(sp))\n-\t\treturn (0);\n-\t/* Set per-file parameters */\n-\tswitch (sp->photometric) {\n-\tcase PHOTOMETRIC_YCBCR:\n-\t\tsp->h_sampling = td->td_ycbcrsubsampling[0];\n-\t\tsp->v_sampling = td->td_ycbcrsubsampling[1];\n-\t\t/*\n-\t\t * A ReferenceBlackWhite field *must* be present since the\n-\t\t * default value is inappropriate for YCbCr.  Fill in the\n-\t\t * proper value if application didn\'t set it.\n-\t\t */\n-\t\t{\n-\t\t\tfloat *ref;\n-\t\t\tif (!TIFFGetField(tif, TIFFTAG_REFERENCEBLACKWHITE,\n-\t\t\t\t\t  &ref)) {\n-\t\t\t\tfloat refbw[6];\n-\t\t\t\tlong top = 1L << td->td_bitspersample;\n-\t\t\t\trefbw[0] = 0;\n-\t\t\t\trefbw[1] = (float)(top-1L);\n-\t\t\t\trefbw[2] = (float)(top>>1);\n-\t\t\t\trefbw[3] = refbw[1];\n-\t\t\t\trefbw[4] = refbw[2];\n-\t\t\t\trefbw[5] = refbw[1];\n-\t\t\t\tTIFFSetField(tif, TIFFTAG_REFERENCEBLACKWHITE,\n-\t\t\t\t\t     refbw);\n-\t\t\t}\n-\t\t}\n-\t\tbreak;\n-\tcase PHOTOMETRIC_PALETTE:\t\t/* disallowed by Tech Note */\n-\tcase PHOTOMETRIC_MASK:\n-\t\tTIFFErrorExt(tif->tif_clientdata, module,\n-\t\t\t  "PhotometricInterpretation %d not allowed for JPEG",\n-\t\t\t  (int) sp->photometric);\n-\t\treturn (0);\n-\tdefault:\n-\t\t/* TIFF 6.0 forbids subsampling of all other color spaces */\n-\t\tsp->h_sampling = 1;\n-\t\tsp->v_sampling = 1;\n-\t\tbreak;\n-\t}\n-\n-\t/* Verify miscellaneous parameters */\n-\n-\t/*\n-\t * This would need work if libtiff ever supports different\n-\t * depths for different components, or if libjpeg ever supports\n-\t * run-time selection of depth.  Neither is imminent.\n-\t */\n+    /*\n+     * Initialize all JPEG parameters to default values.\n+     * Note that jpeg_set_defaults needs legal values for\n+     * in_color_space and input_components.\n+     */\n+    if (td->td_planarconfig == PLANARCONFIG_CONTIG) {\n+        sp->cinfo.c.input_components = td->td_samplesperpixel;\n+        if (sp->photometric == PHOTOMETRIC_YCBCR) {\n+            if (sp->jpegcolormode == JPEGCOLORMODE_RGB) {\n+                sp->cinfo.c.in_color_space = JCS_RGB;\n+            } else {\n+                sp->cinfo.c.in_color_space = JCS_YCbCr;\n+            }\n+        } else {\n+            if ((td->td_photometric == PHOTOMETRIC_MINISWHITE || td->td_photometric == PHOTOMETRIC_MINISBLACK) && td->td_samplesperpixel == 1)\n+                sp->cinfo.c.in_color_space = JCS_GRAYSCALE;\n+            else if (td->td_photometric == PHOTOMETRIC_RGB && td->td_samplesperpixel == 3)\n+                sp->cinfo.c.in_color_space = JCS_RGB;\n+            else if (td->td_photometric == PHOTOMETRIC_SEPARATED && td->td_samplesperpixel == 4)\n+                sp->cinfo.c.in_color_space = JCS_CMYK;\n+            else\n+                sp->cinfo.c.in_color_space = JCS_UNKNOWN;\n+        }\n+    } else {\n+        sp->cinfo.c.input_components = 1;\n+        sp->cinfo.c.in_color_space = JCS_UNKNOWN;\n+    }\n+    if (!TIFFjpeg_set_defaults(sp))\n+        return (0);\n+    /* Set per-file parameters */\n+    switch (sp->photometric) {\n+    case PHOTOMETRIC_YCBCR:\n+        sp->h_sampling = td->td_ycbcrsubsampling[0];\n+        sp->v_sampling = td->td_ycbcrsubsampling[1];\n+        /*\n+         * A ReferenceBlackWhite field *must* be present since the\n+         * default value is inappropriate for YCbCr.  Fill in the\n+         * proper value if application didn\'t set it.\n+         */\n+        {\n+            float *ref;\n+            if (!TIFFGetField(tif, TIFFTAG_REFERENCEBLACKWHITE,\n+                      &ref)) {\n+                float refbw[6];\n+                if (td->td_bitspersample <= 0 || td->td_bitspersample > 32) {\n+                    TIFFErrorExt(tif->tif_clientdata, module,\n+                                  "Invalid BitsPerSample %d. Must be in range [1, 32].",\n+                                  (int) td->td_bitspersample);\n+                    return (0);\n+                }\n+                long top = 1L << td->td_bitspersample;\n+                refbw[0] = 0;\n+                refbw[1] = (float)(top-1L);\n+                refbw[2] = (float)(top>>1);\n+                refbw[3] = refbw[1];\n+                refbw[4] = refbw[2];\n+                refbw[5] = refbw[1];\n+                TIFFSetField(tif, TIFFTAG_REFERENCEBLACKWHITE,\n+                             refbw);\n+            }\n+        }\n+        break;\n+    case PHOTOMETRIC_PALETTE:        /* disallowed by Tech Note */\n+    case PHOTOMETRIC_MASK:\n+        TIFFErrorExt(tif->tif_clientdata, module,\n+                  "PhotometricInterpretation %d not allowed for JPEG",\n+                  (int) sp->photometric);\n+        return (0);\n+    default:\n+        /* TIFF 6.0 forbids subsampling of all other color spaces */\n+        sp->h_sampling = 1;\n+        sp->v_sampling = 1;\n+        break;\n+    }\n+\n+    /* Verify miscellaneous parameters */\n+\n+    /*\n+     * This would need work if libtiff ever supports different\n+     * depths for different components, or if libjpeg ever supports\n+     * run-time selection of depth.  Neither is imminent.\n+     */\n #ifdef JPEG_LIB_MK1\n-        /* BITS_IN_JSAMPLE now permits 8 and 12 --- dgilbert */\n-\tif (td->td_bitspersample != 8 && td->td_bitspersample != 12) \n+    /* BITS_IN_JSAMPLE now permits 8 and 12 --- dgilbert */\n+    if (td->td_bitspersample != 8 && td->td_bitspersample != 12) \n #else\n-\tif (td->td_bitspersample != BITS_IN_JSAMPLE )\n+    if (td->td_bitspersample != BITS_IN_JSAMPLE)\n #endif\n-\t{\n-\t\tTIFFErrorExt(tif->tif_clientdata, module, "BitsPerSample %d not allowed for JPEG",\n-\t\t\t  (int) td->td_bitspersample);\n-\t\treturn (0);\n-\t}\n-\tsp->cinfo.c.data_precision = td->td_bitspersample;\n+    {\n+        TIFFErrorExt(tif->tif_clientdata, module, "BitsPerSample %d not allowed for JPEG",\n+                  (int) td->td_bitspersample);\n+        return (0);\n+    }\n+    sp->cinfo.c.data_precision = td->td_bitspersample;\n #ifdef JPEG_LIB_MK1\n-        sp->cinfo.c.bits_in_jsample = td->td_bitspersample;\n+    sp->cinfo.c.bits_in_jsample = td->td_bitspersample;\n #endif\n-\tif ((((tif)->tif_flags & 0x00400U) != 0)) {\n-\t\tif ((td->td_tilelength % (sp->v_sampling * DCTSIZE)) != 0) {\n-\t\t\tTIFFErrorExt(tif->tif_clientdata, module,\n-\t\t\t\t  "JPEG tile height must be multiple of %d",\n-\t\t\t\t  sp->v_sampling * DCTSIZE);\n-\t\t\treturn (0);\n-\t\t}\n-\t\tif ((td->td_tilewidth % (sp->h_sampling * DCTSIZE)) != 0) {\n-\t\t\tTIFFErrorExt(tif->tif_clientdata, module,\n-\t\t\t\t  "JPEG tile width must be multiple of %d",\n-\t\t\t\t  sp->h_sampling * DCTSIZE);\n-\t\t\treturn (0);\n-\t\t}\n-\t} else {\n-\t\tif (td->td_rowsperstrip < td->td_imagelength &&\n-\t\t    (td->td_rowsperstrip % (sp->v_sampling * DCTSIZE)) != 0) {\n-\t\t\tTIFFErrorExt(tif->tif_clientdata, module,\n-\t\t\t\t  "RowsPerStrip must be multiple of %d for JPEG",\n-\t\t\t\t  sp->v_sampling * DCTSIZE);\n-\t\t\treturn (0);\n-\t\t}\n-\t}\n-\n-\t/* Create a JPEGTables field if appropriate */\n-\tif (sp->jpegtablesmode & (JPEGTABLESMODE_QUANT|JPEGTABLESMODE_HUFF)) {\n-                if( sp->jpegtables == NULL\n-                    || memcmp(sp->jpegtables,"\\0\\0\\0\\0\\0\\0\\0\\0\\0",8) == 0 )\n-                {\n-                        if (!prepare_JPEGTables(tif))\n-                                return (0);\n-                        /* Mark the field present */\n-                        /* Can\'t use TIFFSetField since BEENWRITING is already set! */\n-                        tif->tif_flags |= TIFF_DIRTYDIRECT;\n-                        TIFFSetFieldBit(tif, FIELD_JPEGTABLES);\n-                }\n-\t} else {\n-\t\t/* We do not support application-supplied JPEGTables, */\n-\t\t/* so mark the field not present */\n-\t\tTIFFClrFieldBit(tif, FIELD_JPEGTABLES);\n-\t}\n+    if ((((tif)->tif_flags & 0x00400U) != 0)) {\n+        if ((td->td_tilelength % (sp->v_sampling * DCTSIZE)) != 0) {\n+            TIFFErrorExt(tif->tif_clientdata, module,\n+                      "JPEG tile height must be multiple of %d",\n+                      sp->v_sampling * DCTSIZE);\n+            return (0);\n+        }\n+        if ((td->td_tilewidth % (sp->h_sampling * DCTSIZE)) != 0) {\n+            TIFFErrorExt(tif->tif_clientdata, module,\n+                      "JPEG tile width must be multiple of %d",\n+                      sp->h_sampling * DCTSIZE);\n+            return (0);\n+        }\n+    } else {\n+        if (td->td_rowsperstrip < td->td_imagelength &&\n+            (td->td_rowsperstrip % (sp->v_sampling * DCTSIZE)) != 0) {\n+            TIFFErrorExt(tif->tif_clientdata, module,\n+                      "RowsPerStrip must be multiple of %d for JPEG",\n+                      sp->v_sampling * DCTSIZE);\n+            return (0);\n+        }\n+    }\n+\n+    /* Create a JPEGTables field if appropriate */\n+    if (sp->jpegtablesmode & (JPEGTABLESMODE_QUANT|JPEGTABLESMODE_HUFF)) {\n+            if( sp->jpegtables == NULL\n+                || memcmp(sp->jpegtables,"\\0\\0\\0\\0\\0\\0\\0\\0\\0",8) == 0 )\n+            {\n+                    if (!prepare_JPEGTables(tif))\n+                        return (0);\n+                    /* Mark the field present */\n+                    /* Can\'t use TIFFSetField since BEENWRITING is already set! */\n+                    tif->tif_flags |= TIFF_DIRTYDIRECT;\n+                    TIFFSetFieldBit(tif, FIELD_JPEGTABLES);\n+            }\n+    } else {\n+        /* We do not support application-supplied JPEGTables, */\n+        /* so mark the field not present */\n+        TIFFClrFieldBit(tif, FIELD_JPEGTABLES);\n+    }\n \n-\t/* Direct libjpeg output to libtiff\'s output buffer */\n-\tTIFFjpeg_data_dest(sp, tif);\n+    /* Direct libjpeg output to libtiff\'s output buffer */\n+    TIFFjpeg_data_dest(sp, tif);\n \n-\treturn (1);\n+    return (1);\n }\n \n+\n /*\n  * Set encoding state at the start of a strip or tile.\n  */\n', 'id': 65, 'location': '/data/vulnloc/libtiff/CVE-2017-7595/src/libtiff/tif_jpeg.c:1637:5'}, {'diff': '@@ -1571,6 +1571,7 @@\n \treturn (1);\n }\n \n+\n static int\n JPEGSetupEncode(TIFF* tif)\n {\n@@ -1617,6 +1618,7 @@\n \t\tsp->cinfo.c.input_components = 1;\n \t\tsp->cinfo.c.in_color_space = JCS_UNKNOWN;\n \t}\n+\n \tif (!TIFFjpeg_set_defaults(sp))\n \t\treturn (0);\n \t/* Set per-file parameters */\n@@ -1635,6 +1637,10 @@\n \t\t\t\t\t  &ref)) {\n \t\t\t\tfloat refbw[6];\n \t\t\t\tlong top = 1L << td->td_bitspersample;\n+\t\t\t\tif (td->td_bitspersample < 1 || td->td_bitspersample > 16) {\n+\t\t\t\t\tTIFFErrorExt(tif->tif_clientdata, module, "BitsPerSample %d out of range", (int)td->td_bitspersample);\n+\t\t\t\t\treturn (0);\n+\t\t\t\t}\n \t\t\t\trefbw[0] = 0;\n \t\t\t\trefbw[1] = (float)(top-1L);\n \t\t\t\trefbw[2] = (float)(top>>1);\n@@ -1728,6 +1734,7 @@\n \treturn (1);\n }\n \n+\n /*\n  * Set encoding state at the start of a strip or tile.\n  */\n', 'id': 66, 'location': '/data/vulnloc/libtiff/CVE-2017-7595/src/libtiff/tif_jpeg.c:1637:5'}, {'diff': '@@ -1571,6 +1571,7 @@\n \treturn (1);\n }\n \n+\n static int\n JPEGSetupEncode(TIFF* tif)\n {\n@@ -1634,6 +1635,11 @@\n \t\t\tif (!TIFFGetField(tif, TIFFTAG_REFERENCEBLACKWHITE,\n \t\t\t\t\t  &ref)) {\n \t\t\t\tfloat refbw[6];\n+\t\t\t\tif(td->td_bitspersample < 1 || td->td_bitspersample > 32){\n+\t\t\t\t\tTIFFErrorExt(tif->tif_clientdata, module, "BitsPerSample %d out of valid range (1-32)",\n+\t\t\t\t\t\t\t  (int) td->td_bitspersample);\n+\t\t\t\t\treturn (0);\n+\t\t\t\t}\n \t\t\t\tlong top = 1L << td->td_bitspersample;\n \t\t\t\trefbw[0] = 0;\n \t\t\t\trefbw[1] = (float)(top-1L);\n@@ -1728,6 +1734,7 @@\n \treturn (1);\n }\n \n+\n /*\n  * Set encoding state at the start of a strip or tile.\n  */\n', 'id': 67, 'location': '/data/vulnloc/libtiff/CVE-2017-7595/src/libtiff/tif_jpeg.c:1637:5'}, {'diff': '@@ -1571,6 +1571,7 @@\n \treturn (1);\n }\n \n+\n static int\n JPEGSetupEncode(TIFF* tif)\n {\n@@ -1629,12 +1630,16 @@\n \t\t * default value is inappropriate for YCbCr.  Fill in the\n \t\t * proper value if application didn\'t set it.\n \t\t */\n-\t\t{\n+\t\t {\n \t\t\tfloat *ref;\n \t\t\tif (!TIFFGetField(tif, TIFFTAG_REFERENCEBLACKWHITE,\n \t\t\t\t\t  &ref)) {\n \t\t\t\tfloat refbw[6];\n-\t\t\t\tlong top = 1L << td->td_bitspersample;\n+\t\t\t\tif (td->td_bitspersample < 1 || td->td_bitspersample > 16) {\n+\t\t\t\t\tTIFFErrorExt(tif->tif_clientdata, module, "BitsPerSample %d not allowed for JPEG", (int) td->td_bitspersample);\n+\t\t\t\t\treturn (0);\n+\t\t\t\t}\n+\t\t\t\tlong top = 1L << td->td_bitspersample; // Vulnerable line modified to validate range\n \t\t\t\trefbw[0] = 0;\n \t\t\t\trefbw[1] = (float)(top-1L);\n \t\t\t\trefbw[2] = (float)(top>>1);\n@@ -1728,6 +1733,7 @@\n \treturn (1);\n }\n \n+\n /*\n  * Set encoding state at the start of a strip or tile.\n  */\n', 'id': 68, 'location': '/data/vulnloc/libtiff/CVE-2017-7595/src/libtiff/tif_jpeg.c:1637:5'}, {'diff': '@@ -1571,6 +1571,7 @@\n \treturn (1);\n }\n \n+\n static int\n JPEGSetupEncode(TIFF* tif)\n {\n@@ -1634,6 +1635,10 @@\n \t\t\tif (!TIFFGetField(tif, TIFFTAG_REFERENCEBLACKWHITE,\n \t\t\t\t\t  &ref)) {\n \t\t\t\tfloat refbw[6];\n+\t\t\t\tif (td->td_bitspersample <= 0 || td->td_bitspersample > 12) {\n+\t\t\t\t\tTIFFErrorExt(tif->tif_clientdata, module, "BitsPerSample %d not allowed for JPEG", (int) td->td_bitspersample);\n+\t\t\t\t\treturn (0);\n+\t\t\t\t}\n \t\t\t\tlong top = 1L << td->td_bitspersample;\n \t\t\t\trefbw[0] = 0;\n \t\t\t\trefbw[1] = (float)(top-1L);\n@@ -1728,6 +1733,7 @@\n \treturn (1);\n }\n \n+\n /*\n  * Set encoding state at the start of a strip or tile.\n  */\n', 'id': 69, 'location': '/data/vulnloc/libtiff/CVE-2017-7595/src/libtiff/tif_jpeg.c:1637:5'}, {'diff': '@@ -1571,6 +1571,7 @@\n \treturn (1);\n }\n \n+\n static int\n JPEGSetupEncode(TIFF* tif)\n {\n@@ -1631,8 +1632,7 @@\n \t\t */\n \t\t{\n \t\t\tfloat *ref;\n-\t\t\tif (!TIFFGetField(tif, TIFFTAG_REFERENCEBLACKWHITE,\n-\t\t\t\t\t  &ref)) {\n+\t\t\tif (!TIFFGetField(tif, TIFFTAG_REFERENCEBLACKWHITE, &ref)) {\n \t\t\t\tfloat refbw[6];\n \t\t\t\tlong top = 1L << td->td_bitspersample;\n \t\t\t\trefbw[0] = 0;\n@@ -1641,8 +1641,12 @@\n \t\t\t\trefbw[3] = refbw[1];\n \t\t\t\trefbw[4] = refbw[2];\n \t\t\t\trefbw[5] = refbw[1];\n-\t\t\t\tTIFFSetField(tif, TIFFTAG_REFERENCEBLACKWHITE,\n-\t\t\t\t\t     refbw);\n+\t\t\t\tTIFFSetField(tif, TIFFTAG_REFERENCEBLACKWHITE, refbw);\n+\t\t\t} else {\n+\t\t\t\t// Handle case where the field exists to avoid using default incorrect values.\n+\t\t\t\tfloat defaultRefbw[6] = {0, 0, 0, 0, 0, 0};\n+\t\t\t\tmemcpy(ref, defaultRefbw, sizeof(defaultRefbw));\n+\t\t\t\tTIFFSetField(tif, TIFFTAG_REFERENCEBLACKWHITE, ref); \n \t\t\t}\n \t\t}\n \t\tbreak;\n@@ -1728,6 +1732,7 @@\n \treturn (1);\n }\n \n+\n /*\n  * Set encoding state at the start of a strip or tile.\n  */\n', 'id': 70, 'location': '/data/vulnloc/libtiff/CVE-2017-7595/src/libtiff/tif_jpeg.c:1634:9'}, {'diff': '@@ -1571,6 +1571,7 @@\n \treturn (1);\n }\n \n+\n static int\n JPEGSetupEncode(TIFF* tif)\n {\n@@ -1632,7 +1633,7 @@\n \t\t{\n \t\t\tfloat *ref;\n \t\t\tif (!TIFFGetField(tif, TIFFTAG_REFERENCEBLACKWHITE,\n-\t\t\t\t\t  &ref)) {\n+\t\t\t\t\t  &ref) || ref == NULL) {\n \t\t\t\tfloat refbw[6];\n \t\t\t\tlong top = 1L << td->td_bitspersample;\n \t\t\t\trefbw[0] = 0;\n@@ -1728,6 +1729,7 @@\n \treturn (1);\n }\n \n+\n /*\n  * Set encoding state at the start of a strip or tile.\n  */\n', 'id': 71, 'location': '/data/vulnloc/libtiff/CVE-2017-7595/src/libtiff/tif_jpeg.c:1634:9'}, {'diff': '@@ -1571,6 +1571,7 @@\n \treturn (1);\n }\n \n+\n static int\n JPEGSetupEncode(TIFF* tif)\n {\n@@ -1631,8 +1632,7 @@\n \t\t */\n \t\t{\n \t\t\tfloat *ref;\n-\t\t\tif (!TIFFGetField(tif, TIFFTAG_REFERENCEBLACKWHITE,\n-\t\t\t\t\t  &ref)) {\n+\t\t\tif (!TIFFGetField(tif, TIFFTAG_REFERENCEBLACKWHITE, &ref)) {\n \t\t\t\tfloat refbw[6];\n \t\t\t\tlong top = 1L << td->td_bitspersample;\n \t\t\t\trefbw[0] = 0;\n@@ -1641,8 +1641,13 @@\n \t\t\t\trefbw[3] = refbw[1];\n \t\t\t\trefbw[4] = refbw[2];\n \t\t\t\trefbw[5] = refbw[1];\n-\t\t\t\tTIFFSetField(tif, TIFFTAG_REFERENCEBLACKWHITE,\n-\t\t\t\t\t     refbw);\n+\t\t\t\tTIFFSetField(tif, TIFFTAG_REFERENCEBLACKWHITE, refbw);\n+\t\t\t} else {\n+\t\t\t\t/* Validate ReferenceBlackWhite value */\n+\t\t\t\tif (ref[0] < 0 || ref[1] < ref[0] || ref[2] < ref[0] || ref[3] < ref[1] || ref[4] < ref[2] || ref[5] < ref[1]) {\n+\t\t\t\t\tTIFFErrorExt(tif->tif_clientdata, module, "Invalid ReferenceBlackWhite values");\n+\t\t\t\t\treturn (0);\n+\t\t\t\t}\n \t\t\t}\n \t\t}\n \t\tbreak;\n@@ -1728,6 +1733,7 @@\n \treturn (1);\n }\n \n+\n /*\n  * Set encoding state at the start of a strip or tile.\n  */\n', 'id': 72, 'location': '/data/vulnloc/libtiff/CVE-2017-7595/src/libtiff/tif_jpeg.c:1634:9'}, {'diff': '@@ -1571,6 +1571,7 @@\n \treturn (1);\n }\n \n+\n static int\n JPEGSetupEncode(TIFF* tif)\n {\n@@ -1590,11 +1591,6 @@\n \n \tsp->photometric = td->td_photometric;\n \n-\t/*\n-\t * Initialize all JPEG parameters to default values.\n-\t * Note that jpeg_set_defaults needs legal values for\n-\t * in_color_space and input_components.\n-\t */\n \tif (td->td_planarconfig == PLANARCONFIG_CONTIG) {\n \t\tsp->cinfo.c.input_components = td->td_samplesperpixel;\n \t\tif (sp->photometric == PHOTOMETRIC_YCBCR) {\n@@ -1619,20 +1615,13 @@\n \t}\n \tif (!TIFFjpeg_set_defaults(sp))\n \t\treturn (0);\n-\t/* Set per-file parameters */\n-\tswitch (sp->photometric) {\n+\tswitch (sp->photographic) {\n \tcase PHOTOMETRIC_YCBCR:\n \t\tsp->h_sampling = td->td_ycbcrsubsampling[0];\n \t\tsp->v_sampling = td->td_ycbcrsubsampling[1];\n-\t\t/*\n-\t\t * A ReferenceBlackWhite field *must* be present since the\n-\t\t * default value is inappropriate for YCbCr.  Fill in the\n-\t\t * proper value if application didn\'t set it.\n-\t\t */\n \t\t{\n \t\t\tfloat *ref;\n-\t\t\tif (!TIFFGetField(tif, TIFFTAG_REFERENCEBLACKWHITE,\n-\t\t\t\t\t  &ref)) {\n+\t\t\tif (TIFFGetField(tif, TIFFTAG_REFERENCEBLACKWHITE, &ref)) {\n \t\t\t\tfloat refbw[6];\n \t\t\t\tlong top = 1L << td->td_bitspersample;\n \t\t\t\trefbw[0] = 0;\n@@ -1641,36 +1630,29 @@\n \t\t\t\trefbw[3] = refbw[1];\n \t\t\t\trefbw[4] = refbw[2];\n \t\t\t\trefbw[5] = refbw[1];\n-\t\t\t\tTIFFSetField(tif, TIFFTAG_REFERENCEBLACKWHITE,\n-\t\t\t\t\t     refbw);\n+\t\t\t\tTIFFSetField(tif, TIFFTAG_REFERENCEBLACKWHITE, refbw);\n+\t\t\t} else {\n+\t\t\t\tTIFFErrorExt(tif->tif_clientdata, module, "Missing required field: TIFFTAG_REFERENCEBLACKWHITE");\n+\t\t\t\treturn (0);\n \t\t\t}\n \t\t}\n \t\tbreak;\n-\tcase PHOTOMETRIC_PALETTE:\t\t/* disallowed by Tech Note */\n+\tcase PHOTOMETRIC_PALETTE:\n \tcase PHOTOMETRIC_MASK:\n \t\tTIFFErrorExt(tif->tif_clientdata, module,\n \t\t\t  "PhotometricInterpretation %d not allowed for JPEG",\n \t\t\t  (int) sp->photometric);\n \t\treturn (0);\n \tdefault:\n-\t\t/* TIFF 6.0 forbids subsampling of all other color spaces */\n \t\tsp->h_sampling = 1;\n \t\tsp->v_sampling = 1;\n \t\tbreak;\n \t}\n \n-\t/* Verify miscellaneous parameters */\n-\n-\t/*\n-\t * This would need work if libtiff ever supports different\n-\t * depths for different components, or if libjpeg ever supports\n-\t * run-time selection of depth.  Neither is imminent.\n-\t */\n #ifdef JPEG_LIB_MK1\n-        /* BITS_IN_JSAMPLE now permits 8 and 12 --- dgilbert */\n-\tif (td->td_bitspersample != 8 && td->td_bitspersample != 12) \n+\tif (td->td_bitspersample != 8 && td->td_bitspersample != 12)\n #else\n-\tif (td->td_bitspersample != BITS_IN_JSAMPLE )\n+\tif (td->td_bitspersample != BITS_IN_JSAMPLE)\n #endif\n \t{\n \t\tTIFFErrorExt(tif->tif_clientdata, module, "BitsPerSample %d not allowed for JPEG",\n@@ -1679,7 +1661,7 @@\n \t}\n \tsp->cinfo.c.data_precision = td->td_bitspersample;\n #ifdef JPEG_LIB_MK1\n-        sp->cinfo.c.bits_in_jsample = td->td_bitspersample;\n+\tsp->cinfo.c.bits_in_jsample = td->td_bitspersample;\n #endif\n \tif ((((tif)->tif_flags & 0x00400U) != 0)) {\n \t\tif ((td->td_tilelength % (sp->v_sampling * DCTSIZE)) != 0) {\n@@ -1704,30 +1686,25 @@\n \t\t}\n \t}\n \n-\t/* Create a JPEGTables field if appropriate */\n \tif (sp->jpegtablesmode & (JPEGTABLESMODE_QUANT|JPEGTABLESMODE_HUFF)) {\n                 if( sp->jpegtables == NULL\n                     || memcmp(sp->jpegtables,"\\0\\0\\0\\0\\0\\0\\0\\0\\0",8) == 0 )\n                 {\n                         if (!prepare_JPEGTables(tif))\n                                 return (0);\n-                        /* Mark the field present */\n-                        /* Can\'t use TIFFSetField since BEENWRITING is already set! */\n                         tif->tif_flags |= TIFF_DIRTYDIRECT;\n                         TIFFSetFieldBit(tif, FIELD_JPEGTABLES);\n                 }\n \t} else {\n-\t\t/* We do not support application-supplied JPEGTables, */\n-\t\t/* so mark the field not present */\n \t\tTIFFClrFieldBit(tif, FIELD_JPEGTABLES);\n \t}\n \n-\t/* Direct libjpeg output to libtiff\'s output buffer */\n \tTIFFjpeg_data_dest(sp, tif);\n \n \treturn (1);\n }\n \n+\n /*\n  * Set encoding state at the start of a strip or tile.\n  */\n', 'id': 73, 'location': '/data/vulnloc/libtiff/CVE-2017-7595/src/libtiff/tif_jpeg.c:1634:9'}, {'diff': '@@ -1571,6 +1571,7 @@\n \treturn (1);\n }\n \n+\n static int\n JPEGSetupEncode(TIFF* tif)\n {\n@@ -1631,8 +1632,13 @@\n \t\t */\n \t\t{\n \t\t\tfloat *ref;\n-\t\t\tif (!TIFFGetField(tif, TIFFTAG_REFERENCEBLACKWHITE,\n-\t\t\t\t\t  &ref)) {\n+\t\t\tif (!TIFFGetField(tif, TIFFTAG_REFERENCEBLACKWHITE, &ref)) {\n+\t\t\t\t/* Ensure ref is not NULL before proceeding */\n+\t\t\t\tif (td->td_bitspersample < 1 || td->td_bitspersample > 16) {\n+\t\t\t\t\tTIFFErrorExt(tif->tif_clientdata, module, "Invalid BitsPerSample specified: %d", (int)td->td_bitspersample);\n+\t\t\t\t\treturn (0);\n+\t\t\t\t}\n+\n \t\t\t\tfloat refbw[6];\n \t\t\t\tlong top = 1L << td->td_bitspersample;\n \t\t\t\trefbw[0] = 0;\n@@ -1641,8 +1647,7 @@\n \t\t\t\trefbw[3] = refbw[1];\n \t\t\t\trefbw[4] = refbw[2];\n \t\t\t\trefbw[5] = refbw[1];\n-\t\t\t\tTIFFSetField(tif, TIFFTAG_REFERENCEBLACKWHITE,\n-\t\t\t\t\t     refbw);\n+\t\t\t\tTIFFSetField(tif, TIFFTAG_REFERENCEBLACKWHITE, refbw);\n \t\t\t}\n \t\t}\n \t\tbreak;\n@@ -1728,6 +1733,7 @@\n \treturn (1);\n }\n \n+\n /*\n  * Set encoding state at the start of a strip or tile.\n  */\n', 'id': 74, 'location': '/data/vulnloc/libtiff/CVE-2017-7595/src/libtiff/tif_jpeg.c:1634:9'}]2025-02-03 13:47:11.861 | INFO     | scenario:validate:475 - beginning candidate patch evaluation with time limit: 45 minutes
2025-02-03 13:47:11.862 | DEBUG    | scenario:rebuild:369 - original environment: environ({'CONDA_SHLVL': '2', 'LC_ALL': 'C.UTF-8', 'LS_COLORS': 'rs=0:di=01;34:ln=01;36:mh=00:pi=40;33:so=01;35:do=01;35:bd=40;33;01:cd=40;33;01:or=40;31;01:mi=00:su=37;41:sg=30;43:ca=30;41:tw=30;42:ow=34;42:st=37;44:ex=01;32:*.tar=01;31:*.tgz=01;31:*.arc=01;31:*.arj=01;31:*.taz=01;31:*.lha=01;31:*.lz4=01;31:*.lzh=01;31:*.lzma=01;31:*.tlz=01;31:*.txz=01;31:*.tzo=01;31:*.t7z=01;31:*.zip=01;31:*.z=01;31:*.Z=01;31:*.dz=01;31:*.gz=01;31:*.lrz=01;31:*.lz=01;31:*.lzo=01;31:*.xz=01;31:*.zst=01;31:*.tzst=01;31:*.bz2=01;31:*.bz=01;31:*.tbz=01;31:*.tbz2=01;31:*.tz=01;31:*.deb=01;31:*.rpm=01;31:*.jar=01;31:*.war=01;31:*.ear=01;31:*.sar=01;31:*.rar=01;31:*.alz=01;31:*.ace=01;31:*.zoo=01;31:*.cpio=01;31:*.7z=01;31:*.rz=01;31:*.cab=01;31:*.wim=01;31:*.swm=01;31:*.dwm=01;31:*.esd=01;31:*.jpg=01;35:*.jpeg=01;35:*.mjpg=01;35:*.mjpeg=01;35:*.gif=01;35:*.bmp=01;35:*.pbm=01;35:*.pgm=01;35:*.ppm=01;35:*.tga=01;35:*.xbm=01;35:*.xpm=01;35:*.tif=01;35:*.tiff=01;35:*.png=01;35:*.svg=01;35:*.svgz=01;35:*.mng=01;35:*.pcx=01;35:*.mov=01;35:*.mpg=01;35:*.mpeg=01;35:*.m2v=01;35:*.mkv=01;35:*.webm=01;35:*.ogm=01;35:*.mp4=01;35:*.m4v=01;35:*.mp4v=01;35:*.vob=01;35:*.qt=01;35:*.nuv=01;35:*.wmv=01;35:*.asf=01;35:*.rm=01;35:*.rmvb=01;35:*.flc=01;35:*.avi=01;35:*.fli=01;35:*.flv=01;35:*.gl=01;35:*.dl=01;35:*.xcf=01;35:*.xwd=01;35:*.yuv=01;35:*.cgm=01;35:*.emf=01;35:*.ogv=01;35:*.ogx=01;35:*.aac=00;36:*.au=00;36:*.flac=00;36:*.m4a=00;36:*.mid=00;36:*.midi=00;36:*.mka=00;36:*.mp3=00;36:*.mpc=00;36:*.ogg=00;36:*.ra=00;36:*.wav=00;36:*.oga=00;36:*.opus=00;36:*.spx=00;36:*.xspf=00;36:', 'LD_LIBRARY_PATH': '/opt/crashrepair/lib:/CrashRepair/lib:/klee/build/lib:', 'CONDA_EXE': '/root/anaconda3/bin/conda', 'LANG': 'C.UTF-8', 'TZ': 'Asia/Shanghai', 'HOSTNAME': 'fea22102047d', 'OLDPWD': '/orchestrator', 'CONDA_PREFIX': '/root/anaconda3/envs/CrashRepair', '_CE_M': '', 'CC': 'crepair-cc', 'LLVM_COMPILER': 'clang', 'CONDA_PREFIX_1': '/root/anaconda3', 'PWD': '/orchestrator/crashrepair', 'HOME': '/root', 'CONDA_PYTHON_EXE': '/root/anaconda3/bin/python', '_CE_CONDA': '', 'CONDA_PROMPT_MODIFIER': '(CrashRepair) ', 'CXX': 'crepair-cxx', 'TERM': 'xterm', 'SHLVL': '2', 'PYTHONPATH': '/usr/lib/python3.8/site-packages:', 'PATH': '/root/anaconda3/envs/CrashRepair/bin:/root/anaconda3/condabin:~/anaconda3/bin:/opt/crashrepair/bin:/CrashRepair/compiler:/klee/build/bin:/opt/llvm-6/bin:/klee/build/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', 'CONDA_DEFAULT_ENV': 'CrashRepair', '_': '/root/anaconda3/envs/CrashRepair/bin/python'})
2025-02-03 13:47:11.862 | DEBUG    | scenario:rebuild:398 - using environment: {'INJECT_CFLAGS': '-g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -fsanitize=integer-divide-by-zero', 'INJECT_CXXFLAGS': '-g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -fsanitize=integer-divide-by-zero', 'INJECT_LDFLAGS': '-g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -fsanitize=integer-divide-by-zero'}
2025-02-03 13:47:11.862 | DEBUG    | shell:__call__:41 - executing: make clean
Making clean in port
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7595/src/port'
rm -rf .libs _libs
test -z "libport.la" || rm -f libport.la
rm -f ./so_locations
rm -f *.o
rm -f *.lo
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7595/src/port'
Making clean in libtiff
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7595/src/libtiff'
test -z "libtiff.la libtiffxx.la" || rm -f libtiff.la libtiffxx.la
rm -f ./so_locations
rm -rf .libs _libs
 rm -f mkg3states
rm -f *.o
rm -f *.lo
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7595/src/libtiff'
Making clean in tools
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7595/src/tools'
 rm -f bmp2tiff fax2ps fax2tiff gif2tiff pal2rgb ppm2tiff ras2tiff raw2tiff rgb2ycbcr thumbnail tiff2bw tiff2pdf tiff2ps tiff2rgba tiffcmp tiffcp tiffcrop tiffdither tiffdump tiffinfo tiffmedian tiffset tiffsplit
rm -rf .libs _libs
rm -f *.o
rm -f *.lo
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7595/src/tools'
Making clean in build
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7595/src/build'
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7595/src/build'
rm -rf .libs _libs
rm -f *.lo
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7595/src/build'
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7595/src/build'
Making clean in contrib
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7595/src/contrib'
Making clean in addtiffo
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7595/src/contrib/addtiffo'
rm -rf .libs _libs
 rm -f addtiffo
rm -f *.o
rm -f *.lo
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7595/src/contrib/addtiffo'
Making clean in dbs
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7595/src/contrib/dbs'
Making clean in xtiff
make[3]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7595/src/contrib/dbs/xtiff'
rm -rf .libs _libs
rm -f *.lo
make[3]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7595/src/contrib/dbs/xtiff'
make[3]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7595/src/contrib/dbs'
rm -rf .libs _libs
 rm -f tiff-bi tiff-grayscale tiff-palette tiff-rgb
rm -f *.o
rm -f *.lo
make[3]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7595/src/contrib/dbs'
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7595/src/contrib/dbs'
Making clean in iptcutil
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7595/src/contrib/iptcutil'
rm -rf .libs _libs
 rm -f iptcutil
rm -f *.o
rm -f *.lo
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7595/src/contrib/iptcutil'
Making clean in mfs
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7595/src/contrib/mfs'
rm -rf .libs _libs
rm -f *.lo
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7595/src/contrib/mfs'
Making clean in pds
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7595/src/contrib/pds'
rm -rf .libs _libs
rm -f *.lo
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7595/src/contrib/pds'
Making clean in ras
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7595/src/contrib/ras'
rm -rf .libs _libs
rm -f *.lo
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7595/src/contrib/ras'
Making clean in stream
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7595/src/contrib/stream'
rm -rf .libs _libs
rm -f *.lo
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7595/src/contrib/stream'
Making clean in tags
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7595/src/contrib/tags'
rm -rf .libs _libs
rm -f *.lo
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7595/src/contrib/tags'
Making clean in win_dib
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7595/src/contrib/win_dib'
rm -rf .libs _libs
rm -f *.lo
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7595/src/contrib/win_dib'
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7595/src/contrib'
rm -rf .libs _libs
rm -f *.lo
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7595/src/contrib'
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7595/src/contrib'
Making clean in test
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7595/src/test'
 rm -f ascii_tag long_tag short_tag strip_rw rewrite custom_dir raw_decode
test -z "test_packbits.tif o-*" || rm -f test_packbits.tif o-*
rm -rf .libs _libs
rm -f *.o
test -z "ascii_tag.log long_tag.log short_tag.log strip_rw.log rewrite.log custom_dir.log raw_decode.log bmp2tiff_palette.sh.log bmp2tiff_rgb.sh.log gif2tiff.sh.log ppm2tiff_pbm.sh.log ppm2tiff_pgm.sh.log ppm2tiff_ppm.sh.log tiffcp-g3.sh.log tiffcp-g3-1d.sh.log tiffcp-g3-1d-fill.sh.log tiffcp-g3-2d.sh.log tiffcp-g3-2d-fill.sh.log tiffcp-g4.sh.log tiffcp-logluv.sh.log tiffcp-thumbnail.sh.log tiffdump.sh.log tiffinfo.sh.log tiffcp-split.sh.log tiffcp-split-join.sh.log tiff2ps-PS1.sh.log tiff2ps-PS2.sh.log tiff2ps-PS3.sh.log tiff2ps-EPS1.sh.log tiff2pdf.sh.log tiffcrop-doubleflip-logluv-3c-16b.sh.log tiffcrop-doubleflip-minisblack-1c-16b.sh.log tiffcrop-doubleflip-minisblack-1c-8b.sh.log tiffcrop-doubleflip-minisblack-2c-8b-alpha.sh.log tiffcrop-doubleflip-miniswhite-1c-1b.sh.log tiffcrop-doubleflip-palette-1c-1b.sh.log tiffcrop-doubleflip-palette-1c-4b.sh.log tiffcrop-doubleflip-palette-1c-8b.sh.log tiffcrop-doubleflip-rgb-3c-16b.sh.log tiffcrop-doubleflip-rgb-3c-8b.sh.log tiffcrop-extract-logluv-3c-16b.sh.log tiffcrop-extract-minisblack-1c-16b.sh.log tiffcrop-extract-minisblack-1c-8b.sh.log tiffcrop-extract-minisblack-2c-8b-alpha.sh.log tiffcrop-extract-miniswhite-1c-1b.sh.log tiffcrop-extract-palette-1c-1b.sh.log tiffcrop-extract-palette-1c-4b.sh.log tiffcrop-extract-palette-1c-8b.sh.log tiffcrop-extract-rgb-3c-16b.sh.log tiffcrop-extract-rgb-3c-8b.sh.log tiffcrop-extractz14-logluv-3c-16b.sh.log tiffcrop-extractz14-minisblack-1c-16b.sh.log tiffcrop-extractz14-minisblack-1c-8b.sh.log tiffcrop-extractz14-minisblack-2c-8b-alpha.sh.log tiffcrop-extractz14-miniswhite-1c-1b.sh.log tiffcrop-extractz14-palette-1c-1b.sh.log tiffcrop-extractz14-palette-1c-4b.sh.log tiffcrop-extractz14-palette-1c-8b.sh.log tiffcrop-extractz14-rgb-3c-16b.sh.log tiffcrop-extractz14-rgb-3c-8b.sh.log tiffcrop-R90-logluv-3c-16b.sh.log tiffcrop-R90-minisblack-1c-16b.sh.log tiffcrop-R90-minisblack-1c-8b.sh.log tiffcrop-R90-minisblack-2c-8b-alpha.sh.log tiffcrop-R90-miniswhite-1c-1b.sh.log tiffcrop-R90-palette-1c-1b.sh.log tiffcrop-R90-palette-1c-4b.sh.log tiffcrop-R90-palette-1c-8b.sh.log tiffcrop-R90-rgb-3c-16b.sh.log tiffcrop-R90-rgb-3c-8b.sh.log tiff2rgba-logluv-3c-16b.sh.log tiff2rgba-minisblack-1c-16b.sh.log tiff2rgba-minisblack-1c-8b.sh.log tiff2rgba-minisblack-2c-8b-alpha.sh.log tiff2rgba-miniswhite-1c-1b.sh.log tiff2rgba-palette-1c-1b.sh.log tiff2rgba-palette-1c-4b.sh.log tiff2rgba-palette-1c-8b.sh.log tiff2rgba-rgb-3c-16b.sh.log tiff2rgba-rgb-3c-8b.sh.log tiff2rgba-quad-tile.jpg.sh.log" || rm -f ascii_tag.log long_tag.log short_tag.log strip_rw.log rewrite.log custom_dir.log raw_decode.log bmp2tiff_palette.sh.log bmp2tiff_rgb.sh.log gif2tiff.sh.log ppm2tiff_pbm.sh.log ppm2tiff_pgm.sh.log ppm2tiff_ppm.sh.log tiffcp-g3.sh.log tiffcp-g3-1d.sh.log tiffcp-g3-1d-fill.sh.log tiffcp-g3-2d.sh.log tiffcp-g3-2d-fill.sh.log tiffcp-g4.sh.log tiffcp-logluv.sh.log tiffcp-thumbnail.sh.log tiffdump.sh.log tiffinfo.sh.log tiffcp-split.sh.log tiffcp-split-join.sh.log tiff2ps-PS1.sh.log tiff2ps-PS2.sh.log tiff2ps-PS3.sh.log tiff2ps-EPS1.sh.log tiff2pdf.sh.log tiffcrop-doubleflip-logluv-3c-16b.sh.log tiffcrop-doubleflip-minisblack-1c-16b.sh.log tiffcrop-doubleflip-minisblack-1c-8b.sh.log tiffcrop-doubleflip-minisblack-2c-8b-alpha.sh.log tiffcrop-doubleflip-miniswhite-1c-1b.sh.log tiffcrop-doubleflip-palette-1c-1b.sh.log tiffcrop-doubleflip-palette-1c-4b.sh.log tiffcrop-doubleflip-palette-1c-8b.sh.log tiffcrop-doubleflip-rgb-3c-16b.sh.log tiffcrop-doubleflip-rgb-3c-8b.sh.log tiffcrop-extract-logluv-3c-16b.sh.log tiffcrop-extract-minisblack-1c-16b.sh.log tiffcrop-extract-minisblack-1c-8b.sh.log tiffcrop-extract-minisblack-2c-8b-alpha.sh.log tiffcrop-extract-miniswhite-1c-1b.sh.log tiffcrop-extract-palette-1c-1b.sh.log tiffcrop-extract-palette-1c-4b.sh.log tiffcrop-extract-palette-1c-8b.sh.log tiffcrop-extract-rgb-3c-16b.sh.log tiffcrop-extract-rgb-3c-8b.sh.log tiffcrop-extractz14-logluv-3c-16b.sh.log tiffcrop-extractz14-minisblack-1c-16b.sh.log tiffcrop-extractz14-minisblack-1c-8b.sh.log tiffcrop-extractz14-minisblack-2c-8b-alpha.sh.log tiffcrop-extractz14-miniswhite-1c-1b.sh.log tiffcrop-extractz14-palette-1c-1b.sh.log tiffcrop-extractz14-palette-1c-4b.sh.log tiffcrop-extractz14-palette-1c-8b.sh.log tiffcrop-extractz14-rgb-3c-16b.sh.log tiffcrop-extractz14-rgb-3c-8b.sh.log tiffcrop-R90-logluv-3c-16b.sh.log tiffcrop-R90-minisblack-1c-16b.sh.log tiffcrop-R90-minisblack-1c-8b.sh.log tiffcrop-R90-minisblack-2c-8b-alpha.sh.log tiffcrop-R90-miniswhite-1c-1b.sh.log tiffcrop-R90-palette-1c-1b.sh.log tiffcrop-R90-palette-1c-4b.sh.log tiffcrop-R90-palette-1c-8b.sh.log tiffcrop-R90-rgb-3c-16b.sh.log tiffcrop-R90-rgb-3c-8b.sh.log tiff2rgba-logluv-3c-16b.sh.log tiff2rgba-minisblack-1c-16b.sh.log tiff2rgba-minisblack-1c-8b.sh.log tiff2rgba-minisblack-2c-8b-alpha.sh.log tiff2rgba-miniswhite-1c-1b.sh.log tiff2rgba-palette-1c-1b.sh.log tiff2rgba-palette-1c-4b.sh.log tiff2rgba-palette-1c-8b.sh.log tiff2rgba-rgb-3c-16b.sh.log tiff2rgba-rgb-3c-8b.sh.log tiff2rgba-quad-tile.jpg.sh.log
test -z "ascii_tag.trs long_tag.trs short_tag.trs strip_rw.trs rewrite.trs custom_dir.trs raw_decode.trs bmp2tiff_palette.sh.trs bmp2tiff_rgb.sh.trs gif2tiff.sh.trs ppm2tiff_pbm.sh.trs ppm2tiff_pgm.sh.trs ppm2tiff_ppm.sh.trs tiffcp-g3.sh.trs tiffcp-g3-1d.sh.trs tiffcp-g3-1d-fill.sh.trs tiffcp-g3-2d.sh.trs tiffcp-g3-2d-fill.sh.trs tiffcp-g4.sh.trs tiffcp-logluv.sh.trs tiffcp-thumbnail.sh.trs tiffdump.sh.trs tiffinfo.sh.trs tiffcp-split.sh.trs tiffcp-split-join.sh.trs tiff2ps-PS1.sh.trs tiff2ps-PS2.sh.trs tiff2ps-PS3.sh.trs tiff2ps-EPS1.sh.trs tiff2pdf.sh.trs tiffcrop-doubleflip-logluv-3c-16b.sh.trs tiffcrop-doubleflip-minisblack-1c-16b.sh.trs tiffcrop-doubleflip-minisblack-1c-8b.sh.trs tiffcrop-doubleflip-minisblack-2c-8b-alpha.sh.trs tiffcrop-doubleflip-miniswhite-1c-1b.sh.trs tiffcrop-doubleflip-palette-1c-1b.sh.trs tiffcrop-doubleflip-palette-1c-4b.sh.trs tiffcrop-doubleflip-palette-1c-8b.sh.trs tiffcrop-doubleflip-rgb-3c-16b.sh.trs tiffcrop-doubleflip-rgb-3c-8b.sh.trs tiffcrop-extract-logluv-3c-16b.sh.trs tiffcrop-extract-minisblack-1c-16b.sh.trs tiffcrop-extract-minisblack-1c-8b.sh.trs tiffcrop-extract-minisblack-2c-8b-alpha.sh.trs tiffcrop-extract-miniswhite-1c-1b.sh.trs tiffcrop-extract-palette-1c-1b.sh.trs tiffcrop-extract-palette-1c-4b.sh.trs tiffcrop-extract-palette-1c-8b.sh.trs tiffcrop-extract-rgb-3c-16b.sh.trs tiffcrop-extract-rgb-3c-8b.sh.trs tiffcrop-extractz14-logluv-3c-16b.sh.trs tiffcrop-extractz14-minisblack-1c-16b.sh.trs tiffcrop-extractz14-minisblack-1c-8b.sh.trs tiffcrop-extractz14-minisblack-2c-8b-alpha.sh.trs tiffcrop-extractz14-miniswhite-1c-1b.sh.trs tiffcrop-extractz14-palette-1c-1b.sh.trs tiffcrop-extractz14-palette-1c-4b.sh.trs tiffcrop-extractz14-palette-1c-8b.sh.trs tiffcrop-extractz14-rgb-3c-16b.sh.trs tiffcrop-extractz14-rgb-3c-8b.sh.trs tiffcrop-R90-logluv-3c-16b.sh.trs tiffcrop-R90-minisblack-1c-16b.sh.trs tiffcrop-R90-minisblack-1c-8b.sh.trs tiffcrop-R90-minisblack-2c-8b-alpha.sh.trs tiffcrop-R90-miniswhite-1c-1b.sh.trs tiffcrop-R90-palette-1c-1b.sh.trs tiffcrop-R90-palette-1c-4b.sh.trs tiffcrop-R90-palette-1c-8b.sh.trs tiffcrop-R90-rgb-3c-16b.sh.trs tiffcrop-R90-rgb-3c-8b.sh.trs tiff2rgba-logluv-3c-16b.sh.trs tiff2rgba-minisblack-1c-16b.sh.trs tiff2rgba-minisblack-1c-8b.sh.trs tiff2rgba-minisblack-2c-8b-alpha.sh.trs tiff2rgba-miniswhite-1c-1b.sh.trs tiff2rgba-palette-1c-1b.sh.trs tiff2rgba-palette-1c-4b.sh.trs tiff2rgba-palette-1c-8b.sh.trs tiff2rgba-rgb-3c-16b.sh.trs tiff2rgba-rgb-3c-8b.sh.trs tiff2rgba-quad-tile.jpg.sh.trs" || rm -f ascii_tag.trs long_tag.trs short_tag.trs strip_rw.trs rewrite.trs custom_dir.trs raw_decode.trs bmp2tiff_palette.sh.trs bmp2tiff_rgb.sh.trs gif2tiff.sh.trs ppm2tiff_pbm.sh.trs ppm2tiff_pgm.sh.trs ppm2tiff_ppm.sh.trs tiffcp-g3.sh.trs tiffcp-g3-1d.sh.trs tiffcp-g3-1d-fill.sh.trs tiffcp-g3-2d.sh.trs tiffcp-g3-2d-fill.sh.trs tiffcp-g4.sh.trs tiffcp-logluv.sh.trs tiffcp-thumbnail.sh.trs tiffdump.sh.trs tiffinfo.sh.trs tiffcp-split.sh.trs tiffcp-split-join.sh.trs tiff2ps-PS1.sh.trs tiff2ps-PS2.sh.trs tiff2ps-PS3.sh.trs tiff2ps-EPS1.sh.trs tiff2pdf.sh.trs tiffcrop-doubleflip-logluv-3c-16b.sh.trs tiffcrop-doubleflip-minisblack-1c-16b.sh.trs tiffcrop-doubleflip-minisblack-1c-8b.sh.trs tiffcrop-doubleflip-minisblack-2c-8b-alpha.sh.trs tiffcrop-doubleflip-miniswhite-1c-1b.sh.trs tiffcrop-doubleflip-palette-1c-1b.sh.trs tiffcrop-doubleflip-palette-1c-4b.sh.trs tiffcrop-doubleflip-palette-1c-8b.sh.trs tiffcrop-doubleflip-rgb-3c-16b.sh.trs tiffcrop-doubleflip-rgb-3c-8b.sh.trs tiffcrop-extract-logluv-3c-16b.sh.trs tiffcrop-extract-minisblack-1c-16b.sh.trs tiffcrop-extract-minisblack-1c-8b.sh.trs tiffcrop-extract-minisblack-2c-8b-alpha.sh.trs tiffcrop-extract-miniswhite-1c-1b.sh.trs tiffcrop-extract-palette-1c-1b.sh.trs tiffcrop-extract-palette-1c-4b.sh.trs tiffcrop-extract-palette-1c-8b.sh.trs tiffcrop-extract-rgb-3c-16b.sh.trs tiffcrop-extract-rgb-3c-8b.sh.trs tiffcrop-extractz14-logluv-3c-16b.sh.trs tiffcrop-extractz14-minisblack-1c-16b.sh.trs tiffcrop-extractz14-minisblack-1c-8b.sh.trs tiffcrop-extractz14-minisblack-2c-8b-alpha.sh.trs tiffcrop-extractz14-miniswhite-1c-1b.sh.trs tiffcrop-extractz14-palette-1c-1b.sh.trs tiffcrop-extractz14-palette-1c-4b.sh.trs tiffcrop-extractz14-palette-1c-8b.sh.trs tiffcrop-extractz14-rgb-3c-16b.sh.trs tiffcrop-extractz14-rgb-3c-8b.sh.trs tiffcrop-R90-logluv-3c-16b.sh.trs tiffcrop-R90-minisblack-1c-16b.sh.trs tiffcrop-R90-minisblack-1c-8b.sh.trs tiffcrop-R90-minisblack-2c-8b-alpha.sh.trs tiffcrop-R90-miniswhite-1c-1b.sh.trs tiffcrop-R90-palette-1c-1b.sh.trs tiffcrop-R90-palette-1c-4b.sh.trs tiffcrop-R90-palette-1c-8b.sh.trs tiffcrop-R90-rgb-3c-16b.sh.trs tiffcrop-R90-rgb-3c-8b.sh.trs tiff2rgba-logluv-3c-16b.sh.trs tiff2rgba-minisblack-1c-16b.sh.trs tiff2rgba-minisblack-1c-8b.sh.trs tiff2rgba-minisblack-2c-8b-alpha.sh.trs tiff2rgba-miniswhite-1c-1b.sh.trs tiff2rgba-palette-1c-1b.sh.trs tiff2rgba-palette-1c-4b.sh.trs tiff2rgba-palette-1c-8b.sh.trs tiff2rgba-rgb-3c-16b.sh.trs tiff2rgba-rgb-3c-8b.sh.trs tiff2rgba-quad-tile.jpg.sh.trs
test -z "test-suite.log" || rm -f test-suite.log
rm -f *.lo
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7595/src/test'
Making clean in man
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7595/src/man'
rm -rf .libs _libs
rm -f *.lo
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7595/src/man'
Making clean in html
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7595/src/html'
Making clean in images
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7595/src/html/images'
rm -rf .libs _libs
rm -f *.lo
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7595/src/html/images'
Making clean in man
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7595/src/html/man'
rm -rf .libs _libs
rm -f *.lo
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7595/src/html/man'
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7595/src/html'
rm -rf .libs _libs
rm -f *.lo
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7595/src/html'
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7595/src/html'
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7595/src'
rm -rf .libs _libs
rm -f *.lo
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7595/src'
2025-02-03 13:47:12.020 | DEBUG    | shell:__call__:41 - executing: make CFLAGS="${INJECT_CFLAGS}" CXXFLAGS="${INJECT_CXXFLAGS}" LDFLAGS="${INJECT_LDFLAGS}"
Making all in port
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7595/src/port'
/bin/bash ../libtool  --tag=CC   --mode=compile crepair-cc -DHAVE_CONFIG_H -I. -I../libtiff     -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -fsanitize=integer-divide-by-zero -MT dummy.lo -MD -MP -MF .deps/dummy.Tpo -c -o dummy.lo dummy.c
libtool: compile:  crepair-cc -DHAVE_CONFIG_H -I. -I../libtiff -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -fsanitize=integer-divide-by-zero -MT dummy.lo -MD -MP -MF .deps/dummy.Tpo -c dummy.c -o dummy.o
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
mv -f .deps/dummy.Tpo .deps/dummy.Plo
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -fsanitize=integer-divide-by-zero  -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -fsanitize=integer-divide-by-zero -o libport.la  dummy.lo  -llzma -ljbig -ljpeg -lz -lm 
libtool: link: ar cru .libs/libport.a  dummy.o
ar: `u' modifier ignored since `D' is the default (see `U')
libtool: link: ranlib .libs/libport.a
libtool: link: ( cd ".libs" && rm -f "libport.la" && ln -s "../libport.la" "libport.la" )
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7595/src/port'
Making all in libtiff
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7595/src/libtiff'
make  all-am
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7595/src/libtiff'
/bin/bash ../libtool  --tag=CC   --mode=compile crepair-cc -DHAVE_CONFIG_H -I.     -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -fsanitize=integer-divide-by-zero -MT tif_aux.lo -MD -MP -MF .deps/tif_aux.Tpo -c -o tif_aux.lo tif_aux.c
libtool: compile:  crepair-cc -DHAVE_CONFIG_H -I. -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -fsanitize=integer-divide-by-zero -MT tif_aux.lo -MD -MP -MF .deps/tif_aux.Tpo -c tif_aux.c -o tif_aux.o
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
mv -f .deps/tif_aux.Tpo .deps/tif_aux.Plo
/bin/bash ../libtool  --tag=CC   --mode=compile crepair-cc -DHAVE_CONFIG_H -I.     -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -fsanitize=integer-divide-by-zero -MT tif_close.lo -MD -MP -MF .deps/tif_close.Tpo -c -o tif_close.lo tif_close.c
libtool: compile:  crepair-cc -DHAVE_CONFIG_H -I. -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -fsanitize=integer-divide-by-zero -MT tif_close.lo -MD -MP -MF .deps/tif_close.Tpo -c tif_close.c -o tif_close.o
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
mv -f .deps/tif_close.Tpo .deps/tif_close.Plo
/bin/bash ../libtool  --tag=CC   --mode=compile crepair-cc -DHAVE_CONFIG_H -I.     -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -fsanitize=integer-divide-by-zero -MT tif_codec.lo -MD -MP -MF .deps/tif_codec.Tpo -c -o tif_codec.lo tif_codec.c
libtool: compile:  crepair-cc -DHAVE_CONFIG_H -I. -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -fsanitize=integer-divide-by-zero -MT tif_codec.lo -MD -MP -MF .deps/tif_codec.Tpo -c tif_codec.c -o tif_codec.o
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
mv -f .deps/tif_codec.Tpo .deps/tif_codec.Plo
/bin/bash ../libtool  --tag=CC   --mode=compile crepair-cc -DHAVE_CONFIG_H -I.     -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -fsanitize=integer-divide-by-zero -MT tif_color.lo -MD -MP -MF .deps/tif_color.Tpo -c -o tif_color.lo tif_color.c
libtool: compile:  crepair-cc -DHAVE_CONFIG_H -I. -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -fsanitize=integer-divide-by-zero -MT tif_color.lo -MD -MP -MF .deps/tif_color.Tpo -c tif_color.c -o tif_color.o
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
mv -f .deps/tif_color.Tpo .deps/tif_color.Plo
/bin/bash ../libtool  --tag=CC   --mode=compile crepair-cc -DHAVE_CONFIG_H -I.     -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -fsanitize=integer-divide-by-zero -MT tif_compress.lo -MD -MP -MF .deps/tif_compress.Tpo -c -o tif_compress.lo tif_compress.c
libtool: compile:  crepair-cc -DHAVE_CONFIG_H -I. -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -fsanitize=integer-divide-by-zero -MT tif_compress.lo -MD -MP -MF .deps/tif_compress.Tpo -c tif_compress.c -o tif_compress.o
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
mv -f .deps/tif_compress.Tpo .deps/tif_compress.Plo
/bin/bash ../libtool  --tag=CC   --mode=compile crepair-cc -DHAVE_CONFIG_H -I.     -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -fsanitize=integer-divide-by-zero -MT tif_dir.lo -MD -MP -MF .deps/tif_dir.Tpo -c -o tif_dir.lo tif_dir.c
libtool: compile:  crepair-cc -DHAVE_CONFIG_H -I. -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -fsanitize=integer-divide-by-zero -MT tif_dir.lo -MD -MP -MF .deps/tif_dir.Tpo -c tif_dir.c -o tif_dir.o
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
mv -f .deps/tif_dir.Tpo .deps/tif_dir.Plo
/bin/bash ../libtool  --tag=CC   --mode=compile crepair-cc -DHAVE_CONFIG_H -I.     -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -fsanitize=integer-divide-by-zero -MT tif_dirinfo.lo -MD -MP -MF .deps/tif_dirinfo.Tpo -c -o tif_dirinfo.lo tif_dirinfo.c
libtool: compile:  crepair-cc -DHAVE_CONFIG_H -I. -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -fsanitize=integer-divide-by-zero -MT tif_dirinfo.lo -MD -MP -MF .deps/tif_dirinfo.Tpo -c tif_dirinfo.c -o tif_dirinfo.o
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
mv -f .deps/tif_dirinfo.Tpo .deps/tif_dirinfo.Plo
/bin/bash ../libtool  --tag=CC   --mode=compile crepair-cc -DHAVE_CONFIG_H -I.     -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -fsanitize=integer-divide-by-zero -MT tif_dirread.lo -MD -MP -MF .deps/tif_dirread.Tpo -c -o tif_dirread.lo tif_dirread.c
libtool: compile:  crepair-cc -DHAVE_CONFIG_H -I. -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -fsanitize=integer-divide-by-zero -MT tif_dirread.lo -MD -MP -MF .deps/tif_dirread.Tpo -c tif_dirread.c -o tif_dirread.o
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
mv -f .deps/tif_dirread.Tpo .deps/tif_dirread.Plo
/bin/bash ../libtool  --tag=CC   --mode=compile crepair-cc -DHAVE_CONFIG_H -I.     -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -fsanitize=integer-divide-by-zero -MT tif_dirwrite.lo -MD -MP -MF .deps/tif_dirwrite.Tpo -c -o tif_dirwrite.lo tif_dirwrite.c
libtool: compile:  crepair-cc -DHAVE_CONFIG_H -I. -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -fsanitize=integer-divide-by-zero -MT tif_dirwrite.lo -MD -MP -MF .deps/tif_dirwrite.Tpo -c tif_dirwrite.c -o tif_dirwrite.o
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
mv -f .deps/tif_dirwrite.Tpo .deps/tif_dirwrite.Plo
/bin/bash ../libtool  --tag=CC   --mode=compile crepair-cc -DHAVE_CONFIG_H -I.     -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -fsanitize=integer-divide-by-zero -MT tif_dumpmode.lo -MD -MP -MF .deps/tif_dumpmode.Tpo -c -o tif_dumpmode.lo tif_dumpmode.c
libtool: compile:  crepair-cc -DHAVE_CONFIG_H -I. -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -fsanitize=integer-divide-by-zero -MT tif_dumpmode.lo -MD -MP -MF .deps/tif_dumpmode.Tpo -c tif_dumpmode.c -o tif_dumpmode.o
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
mv -f .deps/tif_dumpmode.Tpo .deps/tif_dumpmode.Plo
/bin/bash ../libtool  --tag=CC   --mode=compile crepair-cc -DHAVE_CONFIG_H -I.     -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -fsanitize=integer-divide-by-zero -MT tif_error.lo -MD -MP -MF .deps/tif_error.Tpo -c -o tif_error.lo tif_error.c
libtool: compile:  crepair-cc -DHAVE_CONFIG_H -I. -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -fsanitize=integer-divide-by-zero -MT tif_error.lo -MD -MP -MF .deps/tif_error.Tpo -c tif_error.c -o tif_error.o
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
mv -f .deps/tif_error.Tpo .deps/tif_error.Plo
/bin/bash ../libtool  --tag=CC   --mode=compile crepair-cc -DHAVE_CONFIG_H -I.     -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -fsanitize=integer-divide-by-zero -MT tif_extension.lo -MD -MP -MF .deps/tif_extension.Tpo -c -o tif_extension.lo tif_extension.c
libtool: compile:  crepair-cc -DHAVE_CONFIG_H -I. -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -fsanitize=integer-divide-by-zero -MT tif_extension.lo -MD -MP -MF .deps/tif_extension.Tpo -c tif_extension.c -o tif_extension.o
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
mv -f .deps/tif_extension.Tpo .deps/tif_extension.Plo
/bin/bash ../libtool  --tag=CC   --mode=compile crepair-cc -DHAVE_CONFIG_H -I.     -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -fsanitize=integer-divide-by-zero -MT tif_fax3.lo -MD -MP -MF .deps/tif_fax3.Tpo -c -o tif_fax3.lo tif_fax3.c
libtool: compile:  crepair-cc -DHAVE_CONFIG_H -I. -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -fsanitize=integer-divide-by-zero -MT tif_fax3.lo -MD -MP -MF .deps/tif_fax3.Tpo -c tif_fax3.c -o tif_fax3.o
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
mv -f .deps/tif_fax3.Tpo .deps/tif_fax3.Plo
/bin/bash ../libtool  --tag=CC   --mode=compile crepair-cc -DHAVE_CONFIG_H -I.     -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -fsanitize=integer-divide-by-zero -MT tif_fax3sm.lo -MD -MP -MF .deps/tif_fax3sm.Tpo -c -o tif_fax3sm.lo tif_fax3sm.c
libtool: compile:  crepair-cc -DHAVE_CONFIG_H -I. -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -fsanitize=integer-divide-by-zero -MT tif_fax3sm.lo -MD -MP -MF .deps/tif_fax3sm.Tpo -c tif_fax3sm.c -o tif_fax3sm.o
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
mv -f .deps/tif_fax3sm.Tpo .deps/tif_fax3sm.Plo
/bin/bash ../libtool  --tag=CC   --mode=compile crepair-cc -DHAVE_CONFIG_H -I.     -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -fsanitize=integer-divide-by-zero -MT tif_flush.lo -MD -MP -MF .deps/tif_flush.Tpo -c -o tif_flush.lo tif_flush.c
libtool: compile:  crepair-cc -DHAVE_CONFIG_H -I. -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -fsanitize=integer-divide-by-zero -MT tif_flush.lo -MD -MP -MF .deps/tif_flush.Tpo -c tif_flush.c -o tif_flush.o
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
mv -f .deps/tif_flush.Tpo .deps/tif_flush.Plo
/bin/bash ../libtool  --tag=CC   --mode=compile crepair-cc -DHAVE_CONFIG_H -I.     -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -fsanitize=integer-divide-by-zero -MT tif_getimage.lo -MD -MP -MF .deps/tif_getimage.Tpo -c -o tif_getimage.lo tif_getimage.c
libtool: compile:  crepair-cc -DHAVE_CONFIG_H -I. -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -fsanitize=integer-divide-by-zero -MT tif_getimage.lo -MD -MP -MF .deps/tif_getimage.Tpo -c tif_getimage.c -o tif_getimage.o
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
mv -f .deps/tif_getimage.Tpo .deps/tif_getimage.Plo
/bin/bash ../libtool  --tag=CC   --mode=compile crepair-cc -DHAVE_CONFIG_H -I.     -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -fsanitize=integer-divide-by-zero -MT tif_jbig.lo -MD -MP -MF .deps/tif_jbig.Tpo -c -o tif_jbig.lo tif_jbig.c
libtool: compile:  crepair-cc -DHAVE_CONFIG_H -I. -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -fsanitize=integer-divide-by-zero -MT tif_jbig.lo -MD -MP -MF .deps/tif_jbig.Tpo -c tif_jbig.c -o tif_jbig.o
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
mv -f .deps/tif_jbig.Tpo .deps/tif_jbig.Plo
/bin/bash ../libtool  --tag=CC   --mode=compile crepair-cc -DHAVE_CONFIG_H -I.     -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -fsanitize=integer-divide-by-zero -MT tif_jpeg.lo -MD -MP -MF .deps/tif_jpeg.Tpo -c -o tif_jpeg.lo tif_jpeg.c
libtool: compile:  crepair-cc -DHAVE_CONFIG_H -I. -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -fsanitize=integer-divide-by-zero -MT tif_jpeg.lo -MD -MP -MF .deps/tif_jpeg.Tpo -c tif_jpeg.c -o tif_jpeg.o
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
mv -f .deps/tif_jpeg.Tpo .deps/tif_jpeg.Plo
/bin/bash ../libtool  --tag=CC   --mode=compile crepair-cc -DHAVE_CONFIG_H -I.     -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -fsanitize=integer-divide-by-zero -MT tif_jpeg_12.lo -MD -MP -MF .deps/tif_jpeg_12.Tpo -c -o tif_jpeg_12.lo tif_jpeg_12.c
libtool: compile:  crepair-cc -DHAVE_CONFIG_H -I. -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -fsanitize=integer-divide-by-zero -MT tif_jpeg_12.lo -MD -MP -MF .deps/tif_jpeg_12.Tpo -c tif_jpeg_12.c -o tif_jpeg_12.o
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
mv -f .deps/tif_jpeg_12.Tpo .deps/tif_jpeg_12.Plo
/bin/bash ../libtool  --tag=CC   --mode=compile crepair-cc -DHAVE_CONFIG_H -I.     -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -fsanitize=integer-divide-by-zero -MT tif_luv.lo -MD -MP -MF .deps/tif_luv.Tpo -c -o tif_luv.lo tif_luv.c
libtool: compile:  crepair-cc -DHAVE_CONFIG_H -I. -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -fsanitize=integer-divide-by-zero -MT tif_luv.lo -MD -MP -MF .deps/tif_luv.Tpo -c tif_luv.c -o tif_luv.o
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
tif_luv.c:881:12: warning: implicit declaration of function 'fabs_crepair' is invalid in C99 [-Wimplicit-function-declaration]
                                epsa = fabs_crepair(ang - (i+.5));
                                       ^
1 warning generated.
tif_luv.c:881:12: warning: implicit declaration of function 'fabs_crepair' is invalid in C99 [-Wimplicit-function-declaration]
                                epsa = fabs_crepair(ang - (i+.5));
                                       ^
1 warning generated.
mv -f .deps/tif_luv.Tpo .deps/tif_luv.Plo
/bin/bash ../libtool  --tag=CC   --mode=compile crepair-cc -DHAVE_CONFIG_H -I.     -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -fsanitize=integer-divide-by-zero -MT tif_lzma.lo -MD -MP -MF .deps/tif_lzma.Tpo -c -o tif_lzma.lo tif_lzma.c
libtool: compile:  crepair-cc -DHAVE_CONFIG_H -I. -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -fsanitize=integer-divide-by-zero -MT tif_lzma.lo -MD -MP -MF .deps/tif_lzma.Tpo -c tif_lzma.c -o tif_lzma.o
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
mv -f .deps/tif_lzma.Tpo .deps/tif_lzma.Plo
/bin/bash ../libtool  --tag=CC   --mode=compile crepair-cc -DHAVE_CONFIG_H -I.     -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -fsanitize=integer-divide-by-zero -MT tif_lzw.lo -MD -MP -MF .deps/tif_lzw.Tpo -c -o tif_lzw.lo tif_lzw.c
libtool: compile:  crepair-cc -DHAVE_CONFIG_H -I. -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -fsanitize=integer-divide-by-zero -MT tif_lzw.lo -MD -MP -MF .deps/tif_lzw.Tpo -c tif_lzw.c -o tif_lzw.o
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
mv -f .deps/tif_lzw.Tpo .deps/tif_lzw.Plo
/bin/bash ../libtool  --tag=CC   --mode=compile crepair-cc -DHAVE_CONFIG_H -I.     -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -fsanitize=integer-divide-by-zero -MT tif_next.lo -MD -MP -MF .deps/tif_next.Tpo -c -o tif_next.lo tif_next.c
libtool: compile:  crepair-cc -DHAVE_CONFIG_H -I. -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -fsanitize=integer-divide-by-zero -MT tif_next.lo -MD -MP -MF .deps/tif_next.Tpo -c tif_next.c -o tif_next.o
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
mv -f .deps/tif_next.Tpo .deps/tif_next.Plo
/bin/bash ../libtool  --tag=CC   --mode=compile crepair-cc -DHAVE_CONFIG_H -I.     -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -fsanitize=integer-divide-by-zero -MT tif_ojpeg.lo -MD -MP -MF .deps/tif_ojpeg.Tpo -c -o tif_ojpeg.lo tif_ojpeg.c
libtool: compile:  crepair-cc -DHAVE_CONFIG_H -I. -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -fsanitize=integer-divide-by-zero -MT tif_ojpeg.lo -MD -MP -MF .deps/tif_ojpeg.Tpo -c tif_ojpeg.c -o tif_ojpeg.o
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
mv -f .deps/tif_ojpeg.Tpo .deps/tif_ojpeg.Plo
/bin/bash ../libtool  --tag=CC   --mode=compile crepair-cc -DHAVE_CONFIG_H -I.     -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -fsanitize=integer-divide-by-zero -MT tif_open.lo -MD -MP -MF .deps/tif_open.Tpo -c -o tif_open.lo tif_open.c
libtool: compile:  crepair-cc -DHAVE_CONFIG_H -I. -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -fsanitize=integer-divide-by-zero -MT tif_open.lo -MD -MP -MF .deps/tif_open.Tpo -c tif_open.c -o tif_open.o
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
mv -f .deps/tif_open.Tpo .deps/tif_open.Plo
/bin/bash ../libtool  --tag=CC   --mode=compile crepair-cc -DHAVE_CONFIG_H -I.     -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -fsanitize=integer-divide-by-zero -MT tif_packbits.lo -MD -MP -MF .deps/tif_packbits.Tpo -c -o tif_packbits.lo tif_packbits.c
libtool: compile:  crepair-cc -DHAVE_CONFIG_H -I. -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -fsanitize=integer-divide-by-zero -MT tif_packbits.lo -MD -MP -MF .deps/tif_packbits.Tpo -c tif_packbits.c -o tif_packbits.o
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
mv -f .deps/tif_packbits.Tpo .deps/tif_packbits.Plo
/bin/bash ../libtool  --tag=CC   --mode=compile crepair-cc -DHAVE_CONFIG_H -I.     -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -fsanitize=integer-divide-by-zero -MT tif_pixarlog.lo -MD -MP -MF .deps/tif_pixarlog.Tpo -c -o tif_pixarlog.lo tif_pixarlog.c
libtool: compile:  crepair-cc -DHAVE_CONFIG_H -I. -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -fsanitize=integer-divide-by-zero -MT tif_pixarlog.lo -MD -MP -MF .deps/tif_pixarlog.Tpo -c tif_pixarlog.c -o tif_pixarlog.o
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
mv -f .deps/tif_pixarlog.Tpo .deps/tif_pixarlog.Plo
/bin/bash ../libtool  --tag=CC   --mode=compile crepair-cc -DHAVE_CONFIG_H -I.     -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -fsanitize=integer-divide-by-zero -MT tif_predict.lo -MD -MP -MF .deps/tif_predict.Tpo -c -o tif_predict.lo tif_predict.c
libtool: compile:  crepair-cc -DHAVE_CONFIG_H -I. -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -fsanitize=integer-divide-by-zero -MT tif_predict.lo -MD -MP -MF .deps/tif_predict.Tpo -c tif_predict.c -o tif_predict.o
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
mv -f .deps/tif_predict.Tpo .deps/tif_predict.Plo
/bin/bash ../libtool  --tag=CC   --mode=compile crepair-cc -DHAVE_CONFIG_H -I.     -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -fsanitize=integer-divide-by-zero -MT tif_print.lo -MD -MP -MF .deps/tif_print.Tpo -c -o tif_print.lo tif_print.c
libtool: compile:  crepair-cc -DHAVE_CONFIG_H -I. -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -fsanitize=integer-divide-by-zero -MT tif_print.lo -MD -MP -MF .deps/tif_print.Tpo -c tif_print.c -o tif_print.o
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
mv -f .deps/tif_print.Tpo .deps/tif_print.Plo
/bin/bash ../libtool  --tag=CC   --mode=compile crepair-cc -DHAVE_CONFIG_H -I.     -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -fsanitize=integer-divide-by-zero -MT tif_read.lo -MD -MP -MF .deps/tif_read.Tpo -c -o tif_read.lo tif_read.c
libtool: compile:  crepair-cc -DHAVE_CONFIG_H -I. -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -fsanitize=integer-divide-by-zero -MT tif_read.lo -MD -MP -MF .deps/tif_read.Tpo -c tif_read.c -o tif_read.o
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
mv -f .deps/tif_read.Tpo .deps/tif_read.Plo
/bin/bash ../libtool  --tag=CC   --mode=compile crepair-cc -DHAVE_CONFIG_H -I.     -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -fsanitize=integer-divide-by-zero -MT tif_strip.lo -MD -MP -MF .deps/tif_strip.Tpo -c -o tif_strip.lo tif_strip.c
libtool: compile:  crepair-cc -DHAVE_CONFIG_H -I. -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -fsanitize=integer-divide-by-zero -MT tif_strip.lo -MD -MP -MF .deps/tif_strip.Tpo -c tif_strip.c -o tif_strip.o
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
mv -f .deps/tif_strip.Tpo .deps/tif_strip.Plo
/bin/bash ../libtool  --tag=CC   --mode=compile crepair-cc -DHAVE_CONFIG_H -I.     -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -fsanitize=integer-divide-by-zero -MT tif_swab.lo -MD -MP -MF .deps/tif_swab.Tpo -c -o tif_swab.lo tif_swab.c
libtool: compile:  crepair-cc -DHAVE_CONFIG_H -I. -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -fsanitize=integer-divide-by-zero -MT tif_swab.lo -MD -MP -MF .deps/tif_swab.Tpo -c tif_swab.c -o tif_swab.o
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
mv -f .deps/tif_swab.Tpo .deps/tif_swab.Plo
/bin/bash ../libtool  --tag=CC   --mode=compile crepair-cc -DHAVE_CONFIG_H -I.     -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -fsanitize=integer-divide-by-zero -MT tif_thunder.lo -MD -MP -MF .deps/tif_thunder.Tpo -c -o tif_thunder.lo tif_thunder.c
libtool: compile:  crepair-cc -DHAVE_CONFIG_H -I. -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -fsanitize=integer-divide-by-zero -MT tif_thunder.lo -MD -MP -MF .deps/tif_thunder.Tpo -c tif_thunder.c -o tif_thunder.o
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
mv -f .deps/tif_thunder.Tpo .deps/tif_thunder.Plo
/bin/bash ../libtool  --tag=CC   --mode=compile crepair-cc -DHAVE_CONFIG_H -I.     -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -fsanitize=integer-divide-by-zero -MT tif_tile.lo -MD -MP -MF .deps/tif_tile.Tpo -c -o tif_tile.lo tif_tile.c
libtool: compile:  crepair-cc -DHAVE_CONFIG_H -I. -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -fsanitize=integer-divide-by-zero -MT tif_tile.lo -MD -MP -MF .deps/tif_tile.Tpo -c tif_tile.c -o tif_tile.o
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
mv -f .deps/tif_tile.Tpo .deps/tif_tile.Plo
/bin/bash ../libtool  --tag=CC   --mode=compile crepair-cc -DHAVE_CONFIG_H -I.     -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -fsanitize=integer-divide-by-zero -MT tif_version.lo -MD -MP -MF .deps/tif_version.Tpo -c -o tif_version.lo tif_version.c
libtool: compile:  crepair-cc -DHAVE_CONFIG_H -I. -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -fsanitize=integer-divide-by-zero -MT tif_version.lo -MD -MP -MF .deps/tif_version.Tpo -c tif_version.c -o tif_version.o
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
mv -f .deps/tif_version.Tpo .deps/tif_version.Plo
/bin/bash ../libtool  --tag=CC   --mode=compile crepair-cc -DHAVE_CONFIG_H -I.     -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -fsanitize=integer-divide-by-zero -MT tif_warning.lo -MD -MP -MF .deps/tif_warning.Tpo -c -o tif_warning.lo tif_warning.c
libtool: compile:  crepair-cc -DHAVE_CONFIG_H -I. -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -fsanitize=integer-divide-by-zero -MT tif_warning.lo -MD -MP -MF .deps/tif_warning.Tpo -c tif_warning.c -o tif_warning.o
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
mv -f .deps/tif_warning.Tpo .deps/tif_warning.Plo
/bin/bash ../libtool  --tag=CC   --mode=compile crepair-cc -DHAVE_CONFIG_H -I.     -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -fsanitize=integer-divide-by-zero -MT tif_write.lo -MD -MP -MF .deps/tif_write.Tpo -c -o tif_write.lo tif_write.c
libtool: compile:  crepair-cc -DHAVE_CONFIG_H -I. -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -fsanitize=integer-divide-by-zero -MT tif_write.lo -MD -MP -MF .deps/tif_write.Tpo -c tif_write.c -o tif_write.o
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
mv -f .deps/tif_write.Tpo .deps/tif_write.Plo
/bin/bash ../libtool  --tag=CC   --mode=compile crepair-cc -DHAVE_CONFIG_H -I.     -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -fsanitize=integer-divide-by-zero -MT tif_zip.lo -MD -MP -MF .deps/tif_zip.Tpo -c -o tif_zip.lo tif_zip.c
libtool: compile:  crepair-cc -DHAVE_CONFIG_H -I. -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -fsanitize=integer-divide-by-zero -MT tif_zip.lo -MD -MP -MF .deps/tif_zip.Tpo -c tif_zip.c -o tif_zip.o
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
mv -f .deps/tif_zip.Tpo .deps/tif_zip.Plo
/bin/bash ../libtool  --tag=CC   --mode=compile crepair-cc -DHAVE_CONFIG_H -I.     -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -fsanitize=integer-divide-by-zero -MT tif_unix.lo -MD -MP -MF .deps/tif_unix.Tpo -c -o tif_unix.lo tif_unix.c
libtool: compile:  crepair-cc -DHAVE_CONFIG_H -I. -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -fsanitize=integer-divide-by-zero -MT tif_unix.lo -MD -MP -MF .deps/tif_unix.Tpo -c tif_unix.c -o tif_unix.o
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
mv -f .deps/tif_unix.Tpo .deps/tif_unix.Plo
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -fsanitize=integer-divide-by-zero -no-undefined -version-info 7:5:2   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -fsanitize=integer-divide-by-zero -o libtiff.la -rpath /usr/local/lib tif_aux.lo tif_close.lo tif_codec.lo tif_color.lo tif_compress.lo tif_dir.lo tif_dirinfo.lo tif_dirread.lo tif_dirwrite.lo tif_dumpmode.lo tif_error.lo tif_extension.lo tif_fax3.lo tif_fax3sm.lo tif_flush.lo tif_getimage.lo tif_jbig.lo tif_jpeg.lo tif_jpeg_12.lo tif_luv.lo tif_lzma.lo tif_lzw.lo tif_next.lo tif_ojpeg.lo tif_open.lo tif_packbits.lo tif_pixarlog.lo tif_predict.lo tif_print.lo tif_read.lo tif_strip.lo tif_swab.lo tif_thunder.lo tif_tile.lo tif_version.lo tif_warning.lo tif_write.lo tif_zip.lo  tif_unix.lo ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: (cd .libs/libtiff.lax/libport.a && ar x "/data/vulnloc/libtiff/CVE-2017-7595/src/libtiff/../port/.libs/libport.a")
libtool: link: ar cru .libs/libtiff.a  tif_aux.o tif_close.o tif_codec.o tif_color.o tif_compress.o tif_dir.o tif_dirinfo.o tif_dirread.o tif_dirwrite.o tif_dumpmode.o tif_error.o tif_extension.o tif_fax3.o tif_fax3sm.o tif_flush.o tif_getimage.o tif_jbig.o tif_jpeg.o tif_jpeg_12.o tif_luv.o tif_lzma.o tif_lzw.o tif_next.o tif_ojpeg.o tif_open.o tif_packbits.o tif_pixarlog.o tif_predict.o tif_print.o tif_read.o tif_strip.o tif_swab.o tif_thunder.o tif_tile.o tif_version.o tif_warning.o tif_write.o tif_zip.o tif_unix.o  .libs/libtiff.lax/libport.a/dummy.o 
ar: `u' modifier ignored since `D' is the default (see `U')
libtool: link: ranlib .libs/libtiff.a
libtool: link: rm -fr .libs/libtiff.lax
libtool: link: ( cd ".libs" && rm -f "libtiff.la" && ln -s "../libtiff.la" "libtiff.la" )
/bin/bash ../libtool  --tag=CXX   --mode=compile crepair-cxx -DHAVE_CONFIG_H -I.     -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -fsanitize=integer-divide-by-zero -MT tif_stream.lo -MD -MP -MF .deps/tif_stream.Tpo -c -o tif_stream.lo tif_stream.cxx
libtool: compile:  crepair-cxx -DHAVE_CONFIG_H -I. -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -fsanitize=integer-divide-by-zero -MT tif_stream.lo -MD -MP -MF .deps/tif_stream.Tpo -c tif_stream.cxx -o tif_stream.o
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
mv -f .deps/tif_stream.Tpo .deps/tif_stream.Plo
/bin/bash ../libtool  --tag=CXX   --mode=link crepair-cxx  -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -fsanitize=integer-divide-by-zero -no-undefined -version-info 7:5:2   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -fsanitize=integer-divide-by-zero -o libtiffxx.la -rpath /usr/local/lib tif_stream.lo ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: (cd .libs/libtiffxx.lax/libport.a && ar x "/data/vulnloc/libtiff/CVE-2017-7595/src/libtiff/../port/.libs/libport.a")
libtool: link: ar cru .libs/libtiffxx.a  tif_stream.o  .libs/libtiffxx.lax/libport.a/dummy.o 
ar: `u' modifier ignored since `D' is the default (see `U')
libtool: link: ranlib .libs/libtiffxx.a
libtool: link: rm -fr .libs/libtiffxx.lax
libtool: link: ( cd ".libs" && rm -f "libtiffxx.la" && ln -s "../libtiffxx.la" "libtiffxx.la" )
crepair-cc -DHAVE_CONFIG_H -I.     -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -fsanitize=integer-divide-by-zero -MT mkg3states.o -MD -MP -MF .deps/mkg3states.Tpo -c -o mkg3states.o mkg3states.c
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
mv -f .deps/mkg3states.Tpo .deps/mkg3states.Po
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -fsanitize=integer-divide-by-zero  -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -fsanitize=integer-divide-by-zero -o mkg3states mkg3states.o ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -g -O0 -Wno-error -I/CrashRepair/lib -fsanitize=integer-divide-by-zero -g -O0 -Wno-error -I/CrashRepair/lib -fsanitize=integer-divide-by-zero -o mkg3states mkg3states.o  -L/klee/build/lib -L/CrashRepair/lib ../port/.libs/libport.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy -llzma -ljbig -ljpeg -lz -lm
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7595/src/libtiff'
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7595/src/libtiff'
Making all in tools
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7595/src/tools'
crepair-cc -DHAVE_CONFIG_H -I. -I../libtiff  -I../libtiff   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -fsanitize=integer-divide-by-zero -MT bmp2tiff.o -MD -MP -MF .deps/bmp2tiff.Tpo -c -o bmp2tiff.o bmp2tiff.c
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
mv -f .deps/bmp2tiff.Tpo .deps/bmp2tiff.Po
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -fsanitize=integer-divide-by-zero  -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -fsanitize=integer-divide-by-zero -o bmp2tiff bmp2tiff.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -g -O0 -Wno-error -I/CrashRepair/lib -fsanitize=integer-divide-by-zero -g -O0 -Wno-error -I/CrashRepair/lib -fsanitize=integer-divide-by-zero -o bmp2tiff bmp2tiff.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a ../port/.libs/libport.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy -llzma -ljbig -ljpeg -lz -lm
crepair-cc -DHAVE_CONFIG_H -I. -I../libtiff  -I../libtiff   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -fsanitize=integer-divide-by-zero -MT fax2ps.o -MD -MP -MF .deps/fax2ps.Tpo -c -o fax2ps.o fax2ps.c
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
mv -f .deps/fax2ps.Tpo .deps/fax2ps.Po
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -fsanitize=integer-divide-by-zero  -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -fsanitize=integer-divide-by-zero -o fax2ps fax2ps.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -g -O0 -Wno-error -I/CrashRepair/lib -fsanitize=integer-divide-by-zero -g -O0 -Wno-error -I/CrashRepair/lib -fsanitize=integer-divide-by-zero -o fax2ps fax2ps.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a ../port/.libs/libport.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy -llzma -ljbig -ljpeg -lz -lm
crepair-cc -DHAVE_CONFIG_H -I. -I../libtiff  -I../libtiff   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -fsanitize=integer-divide-by-zero -MT fax2tiff.o -MD -MP -MF .deps/fax2tiff.Tpo -c -o fax2tiff.o fax2tiff.c
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
fax2tiff.c:289:44: warning: cast to 'thandle_t' (aka 'void *') from smaller integer type 'int' [-Wint-to-void-pointer-cast]
                TIFFSetClientdata(faxTIFF, (thandle_t) client_data.fd);
                                           ^
1 warning generated.
fax2tiff.c:289:44: warning: cast to 'thandle_t' (aka 'void *') from smaller integer type 'int' [-Wint-to-void-pointer-cast]
                TIFFSetClientdata(faxTIFF, (thandle_t) client_data.fd);
                                           ^
1 warning generated.
mv -f .deps/fax2tiff.Tpo .deps/fax2tiff.Po
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -fsanitize=integer-divide-by-zero  -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -fsanitize=integer-divide-by-zero -o fax2tiff fax2tiff.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -g -O0 -Wno-error -I/CrashRepair/lib -fsanitize=integer-divide-by-zero -g -O0 -Wno-error -I/CrashRepair/lib -fsanitize=integer-divide-by-zero -o fax2tiff fax2tiff.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a ../port/.libs/libport.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy -llzma -ljbig -ljpeg -lz -lm
crepair-cc -DHAVE_CONFIG_H -I. -I../libtiff  -I../libtiff   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -fsanitize=integer-divide-by-zero -MT gif2tiff.o -MD -MP -MF .deps/gif2tiff.Tpo -c -o gif2tiff.o gif2tiff.c
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
mv -f .deps/gif2tiff.Tpo .deps/gif2tiff.Po
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -fsanitize=integer-divide-by-zero  -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -fsanitize=integer-divide-by-zero -o gif2tiff gif2tiff.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -g -O0 -Wno-error -I/CrashRepair/lib -fsanitize=integer-divide-by-zero -g -O0 -Wno-error -I/CrashRepair/lib -fsanitize=integer-divide-by-zero -o gif2tiff gif2tiff.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a ../port/.libs/libport.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy -llzma -ljbig -ljpeg -lz -lm
crepair-cc -DHAVE_CONFIG_H -I. -I../libtiff  -I../libtiff   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -fsanitize=integer-divide-by-zero -MT pal2rgb.o -MD -MP -MF .deps/pal2rgb.Tpo -c -o pal2rgb.o pal2rgb.c
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
mv -f .deps/pal2rgb.Tpo .deps/pal2rgb.Po
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -fsanitize=integer-divide-by-zero  -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -fsanitize=integer-divide-by-zero -o pal2rgb pal2rgb.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -g -O0 -Wno-error -I/CrashRepair/lib -fsanitize=integer-divide-by-zero -g -O0 -Wno-error -I/CrashRepair/lib -fsanitize=integer-divide-by-zero -o pal2rgb pal2rgb.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a ../port/.libs/libport.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy -llzma -ljbig -ljpeg -lz -lm
crepair-cc -DHAVE_CONFIG_H -I. -I../libtiff  -I../libtiff   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -fsanitize=integer-divide-by-zero -MT ppm2tiff.o -MD -MP -MF .deps/ppm2tiff.Tpo -c -o ppm2tiff.o ppm2tiff.c
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
mv -f .deps/ppm2tiff.Tpo .deps/ppm2tiff.Po
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -fsanitize=integer-divide-by-zero  -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -fsanitize=integer-divide-by-zero -o ppm2tiff ppm2tiff.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -g -O0 -Wno-error -I/CrashRepair/lib -fsanitize=integer-divide-by-zero -g -O0 -Wno-error -I/CrashRepair/lib -fsanitize=integer-divide-by-zero -o ppm2tiff ppm2tiff.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a ../port/.libs/libport.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy -llzma -ljbig -ljpeg -lz -lm
crepair-cc -DHAVE_CONFIG_H -I. -I../libtiff  -I../libtiff   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -fsanitize=integer-divide-by-zero -MT ras2tiff.o -MD -MP -MF .deps/ras2tiff.Tpo -c -o ras2tiff.o ras2tiff.c
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
mv -f .deps/ras2tiff.Tpo .deps/ras2tiff.Po
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -fsanitize=integer-divide-by-zero  -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -fsanitize=integer-divide-by-zero -o ras2tiff ras2tiff.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -g -O0 -Wno-error -I/CrashRepair/lib -fsanitize=integer-divide-by-zero -g -O0 -Wno-error -I/CrashRepair/lib -fsanitize=integer-divide-by-zero -o ras2tiff ras2tiff.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a ../port/.libs/libport.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy -llzma -ljbig -ljpeg -lz -lm
crepair-cc -DHAVE_CONFIG_H -I. -I../libtiff  -I../libtiff   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -fsanitize=integer-divide-by-zero -MT raw2tiff.o -MD -MP -MF .deps/raw2tiff.Tpo -c -o raw2tiff.o raw2tiff.c
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
mv -f .deps/raw2tiff.Tpo .deps/raw2tiff.Po
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -fsanitize=integer-divide-by-zero  -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -fsanitize=integer-divide-by-zero -o raw2tiff raw2tiff.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -g -O0 -Wno-error -I/CrashRepair/lib -fsanitize=integer-divide-by-zero -g -O0 -Wno-error -I/CrashRepair/lib -fsanitize=integer-divide-by-zero -o raw2tiff raw2tiff.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a ../port/.libs/libport.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy -llzma -ljbig -ljpeg -lz -lm
crepair-cc -DHAVE_CONFIG_H -I. -I../libtiff  -I../libtiff   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -fsanitize=integer-divide-by-zero -MT rgb2ycbcr.o -MD -MP -MF .deps/rgb2ycbcr.Tpo -c -o rgb2ycbcr.o rgb2ycbcr.c
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
mv -f .deps/rgb2ycbcr.Tpo .deps/rgb2ycbcr.Po
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -fsanitize=integer-divide-by-zero  -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -fsanitize=integer-divide-by-zero -o rgb2ycbcr rgb2ycbcr.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -g -O0 -Wno-error -I/CrashRepair/lib -fsanitize=integer-divide-by-zero -g -O0 -Wno-error -I/CrashRepair/lib -fsanitize=integer-divide-by-zero -o rgb2ycbcr rgb2ycbcr.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a ../port/.libs/libport.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy -llzma -ljbig -ljpeg -lz -lm
crepair-cc -DHAVE_CONFIG_H -I. -I../libtiff  -I../libtiff   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -fsanitize=integer-divide-by-zero -MT thumbnail.o -MD -MP -MF .deps/thumbnail.Tpo -c -o thumbnail.o thumbnail.c
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
mv -f .deps/thumbnail.Tpo .deps/thumbnail.Po
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -fsanitize=integer-divide-by-zero  -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -fsanitize=integer-divide-by-zero -o thumbnail thumbnail.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -g -O0 -Wno-error -I/CrashRepair/lib -fsanitize=integer-divide-by-zero -g -O0 -Wno-error -I/CrashRepair/lib -fsanitize=integer-divide-by-zero -o thumbnail thumbnail.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a ../port/.libs/libport.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy -llzma -ljbig -ljpeg -lz -lm
crepair-cc -DHAVE_CONFIG_H -I. -I../libtiff  -I../libtiff   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -fsanitize=integer-divide-by-zero -MT tiff2bw.o -MD -MP -MF .deps/tiff2bw.Tpo -c -o tiff2bw.o tiff2bw.c
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
mv -f .deps/tiff2bw.Tpo .deps/tiff2bw.Po
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -fsanitize=integer-divide-by-zero  -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -fsanitize=integer-divide-by-zero -o tiff2bw tiff2bw.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -g -O0 -Wno-error -I/CrashRepair/lib -fsanitize=integer-divide-by-zero -g -O0 -Wno-error -I/CrashRepair/lib -fsanitize=integer-divide-by-zero -o tiff2bw tiff2bw.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a ../port/.libs/libport.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy -llzma -ljbig -ljpeg -lz -lm
crepair-cc -DHAVE_CONFIG_H -I. -I../libtiff  -I../libtiff   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -fsanitize=integer-divide-by-zero -MT tiff2pdf.o -MD -MP -MF .deps/tiff2pdf.Tpo -c -o tiff2pdf.o tiff2pdf.c
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
mv -f .deps/tiff2pdf.Tpo .deps/tiff2pdf.Po
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -fsanitize=integer-divide-by-zero  -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -fsanitize=integer-divide-by-zero -o tiff2pdf tiff2pdf.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -g -O0 -Wno-error -I/CrashRepair/lib -fsanitize=integer-divide-by-zero -g -O0 -Wno-error -I/CrashRepair/lib -fsanitize=integer-divide-by-zero -o tiff2pdf tiff2pdf.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a ../port/.libs/libport.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy -llzma -ljbig -ljpeg -lz -lm
crepair-cc -DHAVE_CONFIG_H -I. -I../libtiff  -I../libtiff   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -fsanitize=integer-divide-by-zero -MT tiff2ps.o -MD -MP -MF .deps/tiff2ps.Tpo -c -o tiff2ps.o tiff2ps.c
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
tiff2ps.c:633:16: warning: implicit declaration of function 'fabs_crepair' is invalid in C99 [-Wimplicit-function-declaration]
            || fabs_crepair(xres) < 0.0000001)
               ^
1 warning generated.
tiff2ps.c:633:16: warning: implicit declaration of function 'fabs_crepair' is invalid in C99 [-Wimplicit-function-declaration]
            || fabs_crepair(xres) < 0.0000001)
               ^
1 warning generated.
mv -f .deps/tiff2ps.Tpo .deps/tiff2ps.Po
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -fsanitize=integer-divide-by-zero  -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -fsanitize=integer-divide-by-zero -o tiff2ps tiff2ps.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -g -O0 -Wno-error -I/CrashRepair/lib -fsanitize=integer-divide-by-zero -g -O0 -Wno-error -I/CrashRepair/lib -fsanitize=integer-divide-by-zero -o tiff2ps tiff2ps.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a ../port/.libs/libport.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy -llzma -ljbig -ljpeg -lz -lm
crepair-cc -DHAVE_CONFIG_H -I. -I../libtiff  -I../libtiff   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -fsanitize=integer-divide-by-zero -MT tiff2rgba.o -MD -MP -MF .deps/tiff2rgba.Tpo -c -o tiff2rgba.o tiff2rgba.c
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
mv -f .deps/tiff2rgba.Tpo .deps/tiff2rgba.Po
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -fsanitize=integer-divide-by-zero  -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -fsanitize=integer-divide-by-zero -o tiff2rgba tiff2rgba.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -g -O0 -Wno-error -I/CrashRepair/lib -fsanitize=integer-divide-by-zero -g -O0 -Wno-error -I/CrashRepair/lib -fsanitize=integer-divide-by-zero -o tiff2rgba tiff2rgba.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a ../port/.libs/libport.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy -llzma -ljbig -ljpeg -lz -lm
crepair-cc -DHAVE_CONFIG_H -I. -I../libtiff  -I../libtiff   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -fsanitize=integer-divide-by-zero -MT tiffcmp.o -MD -MP -MF .deps/tiffcmp.Tpo -c -o tiffcmp.o tiffcmp.c
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
mv -f .deps/tiffcmp.Tpo .deps/tiffcmp.Po
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -fsanitize=integer-divide-by-zero  -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -fsanitize=integer-divide-by-zero -o tiffcmp tiffcmp.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -g -O0 -Wno-error -I/CrashRepair/lib -fsanitize=integer-divide-by-zero -g -O0 -Wno-error -I/CrashRepair/lib -fsanitize=integer-divide-by-zero -o tiffcmp tiffcmp.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a ../port/.libs/libport.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy -llzma -ljbig -ljpeg -lz -lm
crepair-cc -DHAVE_CONFIG_H -I. -I../libtiff  -I../libtiff   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -fsanitize=integer-divide-by-zero -MT tiffcp.o -MD -MP -MF .deps/tiffcp.Tpo -c -o tiffcp.o tiffcp.c
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
mv -f .deps/tiffcp.Tpo .deps/tiffcp.Po
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -fsanitize=integer-divide-by-zero  -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -fsanitize=integer-divide-by-zero -o tiffcp tiffcp.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -g -O0 -Wno-error -I/CrashRepair/lib -fsanitize=integer-divide-by-zero -g -O0 -Wno-error -I/CrashRepair/lib -fsanitize=integer-divide-by-zero -o tiffcp tiffcp.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a ../port/.libs/libport.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy -llzma -ljbig -ljpeg -lz -lm
crepair-cc -DHAVE_CONFIG_H -I. -I../libtiff  -I../libtiff   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -fsanitize=integer-divide-by-zero -MT tiffcrop.o -MD -MP -MF .deps/tiffcrop.Tpo -c -o tiffcrop.o tiffcrop.c
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
mv -f .deps/tiffcrop.Tpo .deps/tiffcrop.Po
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -fsanitize=integer-divide-by-zero  -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -fsanitize=integer-divide-by-zero -o tiffcrop tiffcrop.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -g -O0 -Wno-error -I/CrashRepair/lib -fsanitize=integer-divide-by-zero -g -O0 -Wno-error -I/CrashRepair/lib -fsanitize=integer-divide-by-zero -o tiffcrop tiffcrop.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a ../port/.libs/libport.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy -llzma -ljbig -ljpeg -lz -lm
crepair-cc -DHAVE_CONFIG_H -I. -I../libtiff  -I../libtiff   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -fsanitize=integer-divide-by-zero -MT tiffdither.o -MD -MP -MF .deps/tiffdither.Tpo -c -o tiffdither.o tiffdither.c
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
mv -f .deps/tiffdither.Tpo .deps/tiffdither.Po
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -fsanitize=integer-divide-by-zero  -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -fsanitize=integer-divide-by-zero -o tiffdither tiffdither.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -g -O0 -Wno-error -I/CrashRepair/lib -fsanitize=integer-divide-by-zero -g -O0 -Wno-error -I/CrashRepair/lib -fsanitize=integer-divide-by-zero -o tiffdither tiffdither.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a ../port/.libs/libport.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy -llzma -ljbig -ljpeg -lz -lm
crepair-cc -DHAVE_CONFIG_H -I. -I../libtiff  -I../libtiff   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -fsanitize=integer-divide-by-zero -MT tiffdump.o -MD -MP -MF .deps/tiffdump.Tpo -c -o tiffdump.o tiffdump.c
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
mv -f .deps/tiffdump.Tpo .deps/tiffdump.Po
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -fsanitize=integer-divide-by-zero  -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -fsanitize=integer-divide-by-zero -o tiffdump tiffdump.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -g -O0 -Wno-error -I/CrashRepair/lib -fsanitize=integer-divide-by-zero -g -O0 -Wno-error -I/CrashRepair/lib -fsanitize=integer-divide-by-zero -o tiffdump tiffdump.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a ../port/.libs/libport.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy -llzma -ljbig -ljpeg -lz -lm
crepair-cc -DHAVE_CONFIG_H -I. -I../libtiff  -I../libtiff   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -fsanitize=integer-divide-by-zero -MT tiffinfo.o -MD -MP -MF .deps/tiffinfo.Tpo -c -o tiffinfo.o tiffinfo.c
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
mv -f .deps/tiffinfo.Tpo .deps/tiffinfo.Po
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -fsanitize=integer-divide-by-zero  -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -fsanitize=integer-divide-by-zero -o tiffinfo tiffinfo.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -g -O0 -Wno-error -I/CrashRepair/lib -fsanitize=integer-divide-by-zero -g -O0 -Wno-error -I/CrashRepair/lib -fsanitize=integer-divide-by-zero -o tiffinfo tiffinfo.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a ../port/.libs/libport.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy -llzma -ljbig -ljpeg -lz -lm
crepair-cc -DHAVE_CONFIG_H -I. -I../libtiff  -I../libtiff   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -fsanitize=integer-divide-by-zero -MT tiffmedian.o -MD -MP -MF .deps/tiffmedian.Tpo -c -o tiffmedian.o tiffmedian.c
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
mv -f .deps/tiffmedian.Tpo .deps/tiffmedian.Po
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -fsanitize=integer-divide-by-zero  -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -fsanitize=integer-divide-by-zero -o tiffmedian tiffmedian.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -g -O0 -Wno-error -I/CrashRepair/lib -fsanitize=integer-divide-by-zero -g -O0 -Wno-error -I/CrashRepair/lib -fsanitize=integer-divide-by-zero -o tiffmedian tiffmedian.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a ../port/.libs/libport.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy -llzma -ljbig -ljpeg -lz -lm
crepair-cc -DHAVE_CONFIG_H -I. -I../libtiff  -I../libtiff   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -fsanitize=integer-divide-by-zero -MT tiffset.o -MD -MP -MF .deps/tiffset.Tpo -c -o tiffset.o tiffset.c
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
mv -f .deps/tiffset.Tpo .deps/tiffset.Po
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -fsanitize=integer-divide-by-zero  -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -fsanitize=integer-divide-by-zero -o tiffset tiffset.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -g -O0 -Wno-error -I/CrashRepair/lib -fsanitize=integer-divide-by-zero -g -O0 -Wno-error -I/CrashRepair/lib -fsanitize=integer-divide-by-zero -o tiffset tiffset.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a ../port/.libs/libport.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy -llzma -ljbig -ljpeg -lz -lm
crepair-cc -DHAVE_CONFIG_H -I. -I../libtiff  -I../libtiff   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -fsanitize=integer-divide-by-zero -MT tiffsplit.o -MD -MP -MF .deps/tiffsplit.Tpo -c -o tiffsplit.o tiffsplit.c
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
mv -f .deps/tiffsplit.Tpo .deps/tiffsplit.Po
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -fsanitize=integer-divide-by-zero  -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -fsanitize=integer-divide-by-zero -o tiffsplit tiffsplit.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -g -O0 -Wno-error -I/CrashRepair/lib -fsanitize=integer-divide-by-zero -g -O0 -Wno-error -I/CrashRepair/lib -fsanitize=integer-divide-by-zero -o tiffsplit tiffsplit.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a ../port/.libs/libport.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy -llzma -ljbig -ljpeg -lz -lm
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7595/src/tools'
Making all in build
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7595/src/build'
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7595/src/build'
make[2]: Nothing to be done for 'all-am'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7595/src/build'
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7595/src/build'
Making all in contrib
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7595/src/contrib'
Making all in addtiffo
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7595/src/contrib/addtiffo'
crepair-cc -DHAVE_CONFIG_H -I. -I../../libtiff  -I../../libtiff   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -fsanitize=integer-divide-by-zero -MT addtiffo.o -MD -MP -MF .deps/addtiffo.Tpo -c -o addtiffo.o addtiffo.c
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
mv -f .deps/addtiffo.Tpo .deps/addtiffo.Po
crepair-cc -DHAVE_CONFIG_H -I. -I../../libtiff  -I../../libtiff   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -fsanitize=integer-divide-by-zero -MT tif_overview.o -MD -MP -MF .deps/tif_overview.Tpo -c -o tif_overview.o tif_overview.c
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
mv -f .deps/tif_overview.Tpo .deps/tif_overview.Po
crepair-cc -DHAVE_CONFIG_H -I. -I../../libtiff  -I../../libtiff   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -fsanitize=integer-divide-by-zero -MT tif_ovrcache.o -MD -MP -MF .deps/tif_ovrcache.Tpo -c -o tif_ovrcache.o tif_ovrcache.c
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
mv -f .deps/tif_ovrcache.Tpo .deps/tif_ovrcache.Po
/bin/bash ../../libtool  --tag=CC   --mode=link crepair-cc  -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -fsanitize=integer-divide-by-zero  -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -fsanitize=integer-divide-by-zero -o addtiffo addtiffo.o tif_overview.o tif_ovrcache.o ../../libtiff/libtiff.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -g -O0 -Wno-error -I/CrashRepair/lib -fsanitize=integer-divide-by-zero -g -O0 -Wno-error -I/CrashRepair/lib -fsanitize=integer-divide-by-zero -o addtiffo addtiffo.o tif_overview.o tif_ovrcache.o  -L/klee/build/lib -L/CrashRepair/lib ../../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy -llzma -ljbig -ljpeg -lz -lm
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7595/src/contrib/addtiffo'
Making all in dbs
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7595/src/contrib/dbs'
Making all in xtiff
make[3]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7595/src/contrib/dbs/xtiff'
make[3]: Nothing to be done for 'all'.
make[3]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7595/src/contrib/dbs/xtiff'
make[3]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7595/src/contrib/dbs'
crepair-cc -DHAVE_CONFIG_H -I. -I../../libtiff  -I../../libtiff   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -fsanitize=integer-divide-by-zero -MT tiff-bi.o -MD -MP -MF .deps/tiff-bi.Tpo -c -o tiff-bi.o tiff-bi.c
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
mv -f .deps/tiff-bi.Tpo .deps/tiff-bi.Po
/bin/bash ../../libtool  --tag=CC   --mode=link crepair-cc  -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -fsanitize=integer-divide-by-zero  -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -fsanitize=integer-divide-by-zero -o tiff-bi tiff-bi.o ../../libtiff/libtiff.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -g -O0 -Wno-error -I/CrashRepair/lib -fsanitize=integer-divide-by-zero -g -O0 -Wno-error -I/CrashRepair/lib -fsanitize=integer-divide-by-zero -o tiff-bi tiff-bi.o  -L/klee/build/lib -L/CrashRepair/lib ../../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy -llzma -ljbig -ljpeg -lz -lm
crepair-cc -DHAVE_CONFIG_H -I. -I../../libtiff  -I../../libtiff   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -fsanitize=integer-divide-by-zero -MT tiff-grayscale.o -MD -MP -MF .deps/tiff-grayscale.Tpo -c -o tiff-grayscale.o tiff-grayscale.c
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
mv -f .deps/tiff-grayscale.Tpo .deps/tiff-grayscale.Po
/bin/bash ../../libtool  --tag=CC   --mode=link crepair-cc  -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -fsanitize=integer-divide-by-zero  -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -fsanitize=integer-divide-by-zero -o tiff-grayscale tiff-grayscale.o ../../libtiff/libtiff.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -g -O0 -Wno-error -I/CrashRepair/lib -fsanitize=integer-divide-by-zero -g -O0 -Wno-error -I/CrashRepair/lib -fsanitize=integer-divide-by-zero -o tiff-grayscale tiff-grayscale.o  -L/klee/build/lib -L/CrashRepair/lib ../../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy -llzma -ljbig -ljpeg -lz -lm
crepair-cc -DHAVE_CONFIG_H -I. -I../../libtiff  -I../../libtiff   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -fsanitize=integer-divide-by-zero -MT tiff-palette.o -MD -MP -MF .deps/tiff-palette.Tpo -c -o tiff-palette.o tiff-palette.c
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
mv -f .deps/tiff-palette.Tpo .deps/tiff-palette.Po
/bin/bash ../../libtool  --tag=CC   --mode=link crepair-cc  -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -fsanitize=integer-divide-by-zero  -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -fsanitize=integer-divide-by-zero -o tiff-palette tiff-palette.o ../../libtiff/libtiff.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -g -O0 -Wno-error -I/CrashRepair/lib -fsanitize=integer-divide-by-zero -g -O0 -Wno-error -I/CrashRepair/lib -fsanitize=integer-divide-by-zero -o tiff-palette tiff-palette.o  -L/klee/build/lib -L/CrashRepair/lib ../../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy -llzma -ljbig -ljpeg -lz -lm
crepair-cc -DHAVE_CONFIG_H -I. -I../../libtiff  -I../../libtiff   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -fsanitize=integer-divide-by-zero -MT tiff-rgb.o -MD -MP -MF .deps/tiff-rgb.Tpo -c -o tiff-rgb.o tiff-rgb.c
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
mv -f .deps/tiff-rgb.Tpo .deps/tiff-rgb.Po
/bin/bash ../../libtool  --tag=CC   --mode=link crepair-cc  -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -fsanitize=integer-divide-by-zero  -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -fsanitize=integer-divide-by-zero -o tiff-rgb tiff-rgb.o ../../libtiff/libtiff.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -g -O0 -Wno-error -I/CrashRepair/lib -fsanitize=integer-divide-by-zero -g -O0 -Wno-error -I/CrashRepair/lib -fsanitize=integer-divide-by-zero -o tiff-rgb tiff-rgb.o  -L/klee/build/lib -L/CrashRepair/lib ../../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy -llzma -ljbig -ljpeg -lz -lm
make[3]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7595/src/contrib/dbs'
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7595/src/contrib/dbs'
Making all in iptcutil
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7595/src/contrib/iptcutil'
crepair-cc -DHAVE_CONFIG_H -I. -I../../libtiff  -I../../libtiff   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -fsanitize=integer-divide-by-zero -MT iptcutil.o -MD -MP -MF .deps/iptcutil.Tpo -c -o iptcutil.o iptcutil.c
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
mv -f .deps/iptcutil.Tpo .deps/iptcutil.Po
/bin/bash ../../libtool  --tag=CC   --mode=link crepair-cc  -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -fsanitize=integer-divide-by-zero  -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -fsanitize=integer-divide-by-zero -o iptcutil iptcutil.o ../../libtiff/libtiff.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -g -O0 -Wno-error -I/CrashRepair/lib -fsanitize=integer-divide-by-zero -g -O0 -Wno-error -I/CrashRepair/lib -fsanitize=integer-divide-by-zero -o iptcutil iptcutil.o  -L/klee/build/lib -L/CrashRepair/lib ../../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy -llzma -ljbig -ljpeg -lz -lm
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7595/src/contrib/iptcutil'
Making all in mfs
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7595/src/contrib/mfs'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7595/src/contrib/mfs'
Making all in pds
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7595/src/contrib/pds'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7595/src/contrib/pds'
Making all in ras
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7595/src/contrib/ras'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7595/src/contrib/ras'
Making all in stream
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7595/src/contrib/stream'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7595/src/contrib/stream'
Making all in tags
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7595/src/contrib/tags'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7595/src/contrib/tags'
Making all in win_dib
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7595/src/contrib/win_dib'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7595/src/contrib/win_dib'
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7595/src/contrib'
make[2]: Nothing to be done for 'all-am'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7595/src/contrib'
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7595/src/contrib'
Making all in test
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7595/src/test'
make[1]: Nothing to be done for 'all'.
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7595/src/test'
Making all in man
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7595/src/man'
make[1]: Nothing to be done for 'all'.
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7595/src/man'
Making all in html
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7595/src/html'
Making all in images
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7595/src/html/images'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7595/src/html/images'
Making all in man
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7595/src/html/man'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7595/src/html/man'
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7595/src/html'
make[2]: Nothing to be done for 'all-am'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7595/src/html'
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7595/src/html'
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7595/src'
make[1]: Nothing to be done for 'all-am'.
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7595/src'
2025-02-03 13:47:25.916 | INFO     | scenario:evaluate:635 - evaluating candidate patch #0:
@@ -1571,6 +1571,7 @@
 	return (1);
 }
 
+
 static int
 JPEGSetupEncode(TIFF* tif)
 {
@@ -1590,11 +1591,6 @@
 
 	sp->photometric = td->td_photometric;
 
-	/*
-	 * Initialize all JPEG parameters to default values.
-	 * Note that jpeg_set_defaults needs legal values for
-	 * in_color_space and input_components.
-	 */
 	if (td->td_planarconfig == PLANARCONFIG_CONTIG) {
 		sp->cinfo.c.input_components = td->td_samplesperpixel;
 		if (sp->photometric == PHOTOMETRIC_YCBCR) {
@@ -1619,16 +1615,15 @@
 	}
 	if (!TIFFjpeg_set_defaults(sp))
 		return (0);
-	/* Set per-file parameters */
+
 	switch (sp->photometric) {
 	case PHOTOMETRIC_YCBCR:
 		sp->h_sampling = td->td_ycbcrsubsampling[0];
+                if (td->td_ycbcrsubsampling[1] <= 0) { // Check for invalid vertical sampling
+                    TIFFErrorExt(tif->tif_clientdata, module, "Invalid vertical sampling value.");
+                    return (0);
+                }
 		sp->v_sampling = td->td_ycbcrsubsampling[1];
-		/*
-		 * A ReferenceBlackWhite field *must* be present since the
-		 * default value is inappropriate for YCbCr.  Fill in the
-		 * proper value if application didn't set it.
-		 */
 		{
 			float *ref;
 			if (!TIFFGetField(tif, TIFFTAG_REFERENCEBLACKWHITE,
@@ -1646,28 +1641,19 @@
 			}
 		}
 		break;
-	case PHOTOMETRIC_PALETTE:		/* disallowed by Tech Note */
+	case PHOTOMETRIC_PALETTE:
 	case PHOTOMETRIC_MASK:
 		TIFFErrorExt(tif->tif_clientdata, module,
 			  "PhotometricInterpretation %d not allowed for JPEG",
 			  (int) sp->photometric);
 		return (0);
 	default:
-		/* TIFF 6.0 forbids subsampling of all other color spaces */
 		sp->h_sampling = 1;
 		sp->v_sampling = 1;
 		break;
 	}
 
-	/* Verify miscellaneous parameters */
-
-	/*
-	 * This would need work if libtiff ever supports different
-	 * depths for different components, or if libjpeg ever supports
-	 * run-time selection of depth.  Neither is imminent.
-	 */
 #ifdef JPEG_LIB_MK1
-        /* BITS_IN_JSAMPLE now permits 8 and 12 --- dgilbert */
 	if (td->td_bitspersample != 8 && td->td_bitspersample != 12) 
 #else
 	if (td->td_bitspersample != BITS_IN_JSAMPLE )
@@ -1679,7 +1665,7 @@
 	}
 	sp->cinfo.c.data_precision = td->td_bitspersample;
 #ifdef JPEG_LIB_MK1
-        sp->cinfo.c.bits_in_jsample = td->td_bitspersample;
+	sp->cinfo.c.bits_in_jsample = td->td_bitspersample;
 #endif
 	if ((((tif)->tif_flags & 0x00400U) != 0)) {
 		if ((td->td_tilelength % (sp->v_sampling * DCTSIZE)) != 0) {
@@ -1704,30 +1690,25 @@
 		}
 	}
 
-	/* Create a JPEGTables field if appropriate */
 	if (sp->jpegtablesmode & (JPEGTABLESMODE_QUANT|JPEGTABLESMODE_HUFF)) {
                 if( sp->jpegtables == NULL
                     || memcmp(sp->jpegtables,"\0\0\0\0\0\0\0\0\0",8) == 0 )
                 {
                         if (!prepare_JPEGTables(tif))
                                 return (0);
-                        /* Mark the field present */
-                        /* Can't use TIFFSetField since BEENWRITING is already set! */
                         tif->tif_flags |= TIFF_DIRTYDIRECT;
                         TIFFSetFieldBit(tif, FIELD_JPEGTABLES);
                 }
 	} else {
-		/* We do not support application-supplied JPEGTables, */
-		/* so mark the field not present */
 		TIFFClrFieldBit(tif, FIELD_JPEGTABLES);
 	}
 
-	/* Direct libjpeg output to libtiff's output buffer */
 	TIFFjpeg_data_dest(sp, tif);
 
 	return (1);
 }
 
+
 /*
  * Set encoding state at the start of a strip or tile.
  */

2025-02-03 13:47:25.922 | DEBUG    | scenario:rebuild:369 - original environment: environ({'CONDA_SHLVL': '2', 'LC_ALL': 'C.UTF-8', 'LS_COLORS': 'rs=0:di=01;34:ln=01;36:mh=00:pi=40;33:so=01;35:do=01;35:bd=40;33;01:cd=40;33;01:or=40;31;01:mi=00:su=37;41:sg=30;43:ca=30;41:tw=30;42:ow=34;42:st=37;44:ex=01;32:*.tar=01;31:*.tgz=01;31:*.arc=01;31:*.arj=01;31:*.taz=01;31:*.lha=01;31:*.lz4=01;31:*.lzh=01;31:*.lzma=01;31:*.tlz=01;31:*.txz=01;31:*.tzo=01;31:*.t7z=01;31:*.zip=01;31:*.z=01;31:*.Z=01;31:*.dz=01;31:*.gz=01;31:*.lrz=01;31:*.lz=01;31:*.lzo=01;31:*.xz=01;31:*.zst=01;31:*.tzst=01;31:*.bz2=01;31:*.bz=01;31:*.tbz=01;31:*.tbz2=01;31:*.tz=01;31:*.deb=01;31:*.rpm=01;31:*.jar=01;31:*.war=01;31:*.ear=01;31:*.sar=01;31:*.rar=01;31:*.alz=01;31:*.ace=01;31:*.zoo=01;31:*.cpio=01;31:*.7z=01;31:*.rz=01;31:*.cab=01;31:*.wim=01;31:*.swm=01;31:*.dwm=01;31:*.esd=01;31:*.jpg=01;35:*.jpeg=01;35:*.mjpg=01;35:*.mjpeg=01;35:*.gif=01;35:*.bmp=01;35:*.pbm=01;35:*.pgm=01;35:*.ppm=01;35:*.tga=01;35:*.xbm=01;35:*.xpm=01;35:*.tif=01;35:*.tiff=01;35:*.png=01;35:*.svg=01;35:*.svgz=01;35:*.mng=01;35:*.pcx=01;35:*.mov=01;35:*.mpg=01;35:*.mpeg=01;35:*.m2v=01;35:*.mkv=01;35:*.webm=01;35:*.ogm=01;35:*.mp4=01;35:*.m4v=01;35:*.mp4v=01;35:*.vob=01;35:*.qt=01;35:*.nuv=01;35:*.wmv=01;35:*.asf=01;35:*.rm=01;35:*.rmvb=01;35:*.flc=01;35:*.avi=01;35:*.fli=01;35:*.flv=01;35:*.gl=01;35:*.dl=01;35:*.xcf=01;35:*.xwd=01;35:*.yuv=01;35:*.cgm=01;35:*.emf=01;35:*.ogv=01;35:*.ogx=01;35:*.aac=00;36:*.au=00;36:*.flac=00;36:*.m4a=00;36:*.mid=00;36:*.midi=00;36:*.mka=00;36:*.mp3=00;36:*.mpc=00;36:*.ogg=00;36:*.ra=00;36:*.wav=00;36:*.oga=00;36:*.opus=00;36:*.spx=00;36:*.xspf=00;36:', 'LD_LIBRARY_PATH': '/opt/crashrepair/lib:/CrashRepair/lib:/klee/build/lib:', 'CONDA_EXE': '/root/anaconda3/bin/conda', 'LANG': 'C.UTF-8', 'TZ': 'Asia/Shanghai', 'HOSTNAME': 'fea22102047d', 'OLDPWD': '/orchestrator', 'CONDA_PREFIX': '/root/anaconda3/envs/CrashRepair', '_CE_M': '', 'CC': 'crepair-cc', 'LLVM_COMPILER': 'clang', 'CONDA_PREFIX_1': '/root/anaconda3', 'PWD': '/orchestrator/crashrepair', 'HOME': '/root', 'CONDA_PYTHON_EXE': '/root/anaconda3/bin/python', '_CE_CONDA': '', 'CONDA_PROMPT_MODIFIER': '(CrashRepair) ', 'CXX': 'crepair-cxx', 'TERM': 'xterm', 'SHLVL': '2', 'PYTHONPATH': '/usr/lib/python3.8/site-packages:', 'PATH': '/root/anaconda3/envs/CrashRepair/bin:/root/anaconda3/condabin:~/anaconda3/bin:/opt/crashrepair/bin:/CrashRepair/compiler:/klee/build/bin:/opt/llvm-6/bin:/klee/build/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', 'CONDA_DEFAULT_ENV': 'CrashRepair', '_': '/root/anaconda3/envs/CrashRepair/bin/python'})
2025-02-03 13:47:25.922 | DEBUG    | scenario:rebuild:398 - using environment: {'INJECT_CFLAGS': '-g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -fsanitize=integer-divide-by-zero', 'INJECT_CXXFLAGS': '-g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -fsanitize=integer-divide-by-zero', 'INJECT_LDFLAGS': '-g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -fsanitize=integer-divide-by-zero'}
2025-02-03 13:47:25.922 | DEBUG    | shell:__call__:41 - executing: make CFLAGS="${INJECT_CFLAGS}" CXXFLAGS="${INJECT_CXXFLAGS}" LDFLAGS="${INJECT_LDFLAGS}"
Making all in port
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7595/src/port'
make[1]: Nothing to be done for 'all'.
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7595/src/port'
Making all in libtiff
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7595/src/libtiff'
make  all-am
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7595/src/libtiff'
/bin/bash ../libtool  --tag=CC   --mode=compile crepair-cc -DHAVE_CONFIG_H -I.     -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -fsanitize=integer-divide-by-zero -MT tif_jpeg.lo -MD -MP -MF .deps/tif_jpeg.Tpo -c -o tif_jpeg.lo tif_jpeg.c
libtool: compile:  crepair-cc -DHAVE_CONFIG_H -I. -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -fsanitize=integer-divide-by-zero -MT tif_jpeg.lo -MD -MP -MF .deps/tif_jpeg.Tpo -c tif_jpeg.c -o tif_jpeg.o
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
mv -f .deps/tif_jpeg.Tpo .deps/tif_jpeg.Plo
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -fsanitize=integer-divide-by-zero -no-undefined -version-info 7:5:2   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -fsanitize=integer-divide-by-zero -o libtiff.la -rpath /usr/local/lib tif_aux.lo tif_close.lo tif_codec.lo tif_color.lo tif_compress.lo tif_dir.lo tif_dirinfo.lo tif_dirread.lo tif_dirwrite.lo tif_dumpmode.lo tif_error.lo tif_extension.lo tif_fax3.lo tif_fax3sm.lo tif_flush.lo tif_getimage.lo tif_jbig.lo tif_jpeg.lo tif_jpeg_12.lo tif_luv.lo tif_lzma.lo tif_lzw.lo tif_next.lo tif_ojpeg.lo tif_open.lo tif_packbits.lo tif_pixarlog.lo tif_predict.lo tif_print.lo tif_read.lo tif_strip.lo tif_swab.lo tif_thunder.lo tif_tile.lo tif_version.lo tif_warning.lo tif_write.lo tif_zip.lo  tif_unix.lo ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: rm -fr  .libs/libtiff.a .libs/libtiff.la .libs/libtiff.lai
libtool: link: (cd .libs/libtiff.lax/libport.a && ar x "/data/vulnloc/libtiff/CVE-2017-7595/src/libtiff/../port/.libs/libport.a")
libtool: link: ar cru .libs/libtiff.a  tif_aux.o tif_close.o tif_codec.o tif_color.o tif_compress.o tif_dir.o tif_dirinfo.o tif_dirread.o tif_dirwrite.o tif_dumpmode.o tif_error.o tif_extension.o tif_fax3.o tif_fax3sm.o tif_flush.o tif_getimage.o tif_jbig.o tif_jpeg.o tif_jpeg_12.o tif_luv.o tif_lzma.o tif_lzw.o tif_next.o tif_ojpeg.o tif_open.o tif_packbits.o tif_pixarlog.o tif_predict.o tif_print.o tif_read.o tif_strip.o tif_swab.o tif_thunder.o tif_tile.o tif_version.o tif_warning.o tif_write.o tif_zip.o tif_unix.o  .libs/libtiff.lax/libport.a/dummy.o 
ar: `u' modifier ignored since `D' is the default (see `U')
libtool: link: ranlib .libs/libtiff.a
libtool: link: rm -fr .libs/libtiff.lax
libtool: link: ( cd ".libs" && rm -f "libtiff.la" && ln -s "../libtiff.la" "libtiff.la" )
/bin/bash ../libtool  --tag=CXX   --mode=link crepair-cxx  -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -fsanitize=integer-divide-by-zero -no-undefined -version-info 7:5:2   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -fsanitize=integer-divide-by-zero -o libtiffxx.la -rpath /usr/local/lib tif_stream.lo ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: rm -fr  .libs/libtiffxx.a .libs/libtiffxx.la .libs/libtiffxx.lai
libtool: link: (cd .libs/libtiffxx.lax/libport.a && ar x "/data/vulnloc/libtiff/CVE-2017-7595/src/libtiff/../port/.libs/libport.a")
libtool: link: ar cru .libs/libtiffxx.a  tif_stream.o  .libs/libtiffxx.lax/libport.a/dummy.o 
ar: `u' modifier ignored since `D' is the default (see `U')
libtool: link: ranlib .libs/libtiffxx.a
libtool: link: rm -fr .libs/libtiffxx.lax
libtool: link: ( cd ".libs" && rm -f "libtiffxx.la" && ln -s "../libtiffxx.la" "libtiffxx.la" )
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7595/src/libtiff'
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7595/src/libtiff'
Making all in tools
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7595/src/tools'
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -fsanitize=integer-divide-by-zero  -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -fsanitize=integer-divide-by-zero -o bmp2tiff bmp2tiff.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -g -O0 -Wno-error -I/CrashRepair/lib -fsanitize=integer-divide-by-zero -g -O0 -Wno-error -I/CrashRepair/lib -fsanitize=integer-divide-by-zero -o bmp2tiff bmp2tiff.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a ../port/.libs/libport.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -fsanitize=integer-divide-by-zero  -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -fsanitize=integer-divide-by-zero -o fax2ps fax2ps.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -g -O0 -Wno-error -I/CrashRepair/lib -fsanitize=integer-divide-by-zero -g -O0 -Wno-error -I/CrashRepair/lib -fsanitize=integer-divide-by-zero -o fax2ps fax2ps.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a ../port/.libs/libport.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -fsanitize=integer-divide-by-zero  -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -fsanitize=integer-divide-by-zero -o fax2tiff fax2tiff.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -g -O0 -Wno-error -I/CrashRepair/lib -fsanitize=integer-divide-by-zero -g -O0 -Wno-error -I/CrashRepair/lib -fsanitize=integer-divide-by-zero -o fax2tiff fax2tiff.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a ../port/.libs/libport.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -fsanitize=integer-divide-by-zero  -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -fsanitize=integer-divide-by-zero -o gif2tiff gif2tiff.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -g -O0 -Wno-error -I/CrashRepair/lib -fsanitize=integer-divide-by-zero -g -O0 -Wno-error -I/CrashRepair/lib -fsanitize=integer-divide-by-zero -o gif2tiff gif2tiff.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a ../port/.libs/libport.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -fsanitize=integer-divide-by-zero  -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -fsanitize=integer-divide-by-zero -o pal2rgb pal2rgb.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -g -O0 -Wno-error -I/CrashRepair/lib -fsanitize=integer-divide-by-zero -g -O0 -Wno-error -I/CrashRepair/lib -fsanitize=integer-divide-by-zero -o pal2rgb pal2rgb.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a ../port/.libs/libport.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -fsanitize=integer-divide-by-zero  -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -fsanitize=integer-divide-by-zero -o ppm2tiff ppm2tiff.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -g -O0 -Wno-error -I/CrashRepair/lib -fsanitize=integer-divide-by-zero -g -O0 -Wno-error -I/CrashRepair/lib -fsanitize=integer-divide-by-zero -o ppm2tiff ppm2tiff.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a ../port/.libs/libport.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -fsanitize=integer-divide-by-zero  -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -fsanitize=integer-divide-by-zero -o ras2tiff ras2tiff.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -g -O0 -Wno-error -I/CrashRepair/lib -fsanitize=integer-divide-by-zero -g -O0 -Wno-error -I/CrashRepair/lib -fsanitize=integer-divide-by-zero -o ras2tiff ras2tiff.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a ../port/.libs/libport.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -fsanitize=integer-divide-by-zero  -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -fsanitize=integer-divide-by-zero -o raw2tiff raw2tiff.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -g -O0 -Wno-error -I/CrashRepair/lib -fsanitize=integer-divide-by-zero -g -O0 -Wno-error -I/CrashRepair/lib -fsanitize=integer-divide-by-zero -o raw2tiff raw2tiff.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a ../port/.libs/libport.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -fsanitize=integer-divide-by-zero  -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -fsanitize=integer-divide-by-zero -o rgb2ycbcr rgb2ycbcr.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -g -O0 -Wno-error -I/CrashRepair/lib -fsanitize=integer-divide-by-zero -g -O0 -Wno-error -I/CrashRepair/lib -fsanitize=integer-divide-by-zero -o rgb2ycbcr rgb2ycbcr.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a ../port/.libs/libport.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -fsanitize=integer-divide-by-zero  -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -fsanitize=integer-divide-by-zero -o thumbnail thumbnail.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -g -O0 -Wno-error -I/CrashRepair/lib -fsanitize=integer-divide-by-zero -g -O0 -Wno-error -I/CrashRepair/lib -fsanitize=integer-divide-by-zero -o thumbnail thumbnail.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a ../port/.libs/libport.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -fsanitize=integer-divide-by-zero  -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -fsanitize=integer-divide-by-zero -o tiff2bw tiff2bw.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -g -O0 -Wno-error -I/CrashRepair/lib -fsanitize=integer-divide-by-zero -g -O0 -Wno-error -I/CrashRepair/lib -fsanitize=integer-divide-by-zero -o tiff2bw tiff2bw.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a ../port/.libs/libport.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -fsanitize=integer-divide-by-zero  -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -fsanitize=integer-divide-by-zero -o tiff2pdf tiff2pdf.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -g -O0 -Wno-error -I/CrashRepair/lib -fsanitize=integer-divide-by-zero -g -O0 -Wno-error -I/CrashRepair/lib -fsanitize=integer-divide-by-zero -o tiff2pdf tiff2pdf.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a ../port/.libs/libport.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -fsanitize=integer-divide-by-zero  -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -fsanitize=integer-divide-by-zero -o tiff2ps tiff2ps.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -g -O0 -Wno-error -I/CrashRepair/lib -fsanitize=integer-divide-by-zero -g -O0 -Wno-error -I/CrashRepair/lib -fsanitize=integer-divide-by-zero -o tiff2ps tiff2ps.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a ../port/.libs/libport.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -fsanitize=integer-divide-by-zero  -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -fsanitize=integer-divide-by-zero -o tiff2rgba tiff2rgba.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -g -O0 -Wno-error -I/CrashRepair/lib -fsanitize=integer-divide-by-zero -g -O0 -Wno-error -I/CrashRepair/lib -fsanitize=integer-divide-by-zero -o tiff2rgba tiff2rgba.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a ../port/.libs/libport.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -fsanitize=integer-divide-by-zero  -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -fsanitize=integer-divide-by-zero -o tiffcmp tiffcmp.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -g -O0 -Wno-error -I/CrashRepair/lib -fsanitize=integer-divide-by-zero -g -O0 -Wno-error -I/CrashRepair/lib -fsanitize=integer-divide-by-zero -o tiffcmp tiffcmp.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a ../port/.libs/libport.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -fsanitize=integer-divide-by-zero  -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -fsanitize=integer-divide-by-zero -o tiffcp tiffcp.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -g -O0 -Wno-error -I/CrashRepair/lib -fsanitize=integer-divide-by-zero -g -O0 -Wno-error -I/CrashRepair/lib -fsanitize=integer-divide-by-zero -o tiffcp tiffcp.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a ../port/.libs/libport.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -fsanitize=integer-divide-by-zero  -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -fsanitize=integer-divide-by-zero -o tiffcrop tiffcrop.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -g -O0 -Wno-error -I/CrashRepair/lib -fsanitize=integer-divide-by-zero -g -O0 -Wno-error -I/CrashRepair/lib -fsanitize=integer-divide-by-zero -o tiffcrop tiffcrop.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a ../port/.libs/libport.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -fsanitize=integer-divide-by-zero  -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -fsanitize=integer-divide-by-zero -o tiffdither tiffdither.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -g -O0 -Wno-error -I/CrashRepair/lib -fsanitize=integer-divide-by-zero -g -O0 -Wno-error -I/CrashRepair/lib -fsanitize=integer-divide-by-zero -o tiffdither tiffdither.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a ../port/.libs/libport.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -fsanitize=integer-divide-by-zero  -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -fsanitize=integer-divide-by-zero -o tiffdump tiffdump.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -g -O0 -Wno-error -I/CrashRepair/lib -fsanitize=integer-divide-by-zero -g -O0 -Wno-error -I/CrashRepair/lib -fsanitize=integer-divide-by-zero -o tiffdump tiffdump.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a ../port/.libs/libport.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -fsanitize=integer-divide-by-zero  -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -fsanitize=integer-divide-by-zero -o tiffinfo tiffinfo.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -g -O0 -Wno-error -I/CrashRepair/lib -fsanitize=integer-divide-by-zero -g -O0 -Wno-error -I/CrashRepair/lib -fsanitize=integer-divide-by-zero -o tiffinfo tiffinfo.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a ../port/.libs/libport.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -fsanitize=integer-divide-by-zero  -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -fsanitize=integer-divide-by-zero -o tiffmedian tiffmedian.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -g -O0 -Wno-error -I/CrashRepair/lib -fsanitize=integer-divide-by-zero -g -O0 -Wno-error -I/CrashRepair/lib -fsanitize=integer-divide-by-zero -o tiffmedian tiffmedian.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a ../port/.libs/libport.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -fsanitize=integer-divide-by-zero  -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -fsanitize=integer-divide-by-zero -o tiffset tiffset.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -g -O0 -Wno-error -I/CrashRepair/lib -fsanitize=integer-divide-by-zero -g -O0 -Wno-error -I/CrashRepair/lib -fsanitize=integer-divide-by-zero -o tiffset tiffset.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a ../port/.libs/libport.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -fsanitize=integer-divide-by-zero  -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -fsanitize=integer-divide-by-zero -o tiffsplit tiffsplit.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -g -O0 -Wno-error -I/CrashRepair/lib -fsanitize=integer-divide-by-zero -g -O0 -Wno-error -I/CrashRepair/lib -fsanitize=integer-divide-by-zero -o tiffsplit tiffsplit.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a ../port/.libs/libport.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy -llzma -ljbig -ljpeg -lz -lm
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7595/src/tools'
Making all in build
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7595/src/build'
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7595/src/build'
make[2]: Nothing to be done for 'all-am'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7595/src/build'
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7595/src/build'
Making all in contrib
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7595/src/contrib'
Making all in addtiffo
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7595/src/contrib/addtiffo'
/bin/bash ../../libtool  --tag=CC   --mode=link crepair-cc  -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -fsanitize=integer-divide-by-zero  -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -fsanitize=integer-divide-by-zero -o addtiffo addtiffo.o tif_overview.o tif_ovrcache.o ../../libtiff/libtiff.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -g -O0 -Wno-error -I/CrashRepair/lib -fsanitize=integer-divide-by-zero -g -O0 -Wno-error -I/CrashRepair/lib -fsanitize=integer-divide-by-zero -o addtiffo addtiffo.o tif_overview.o tif_ovrcache.o  -L/klee/build/lib -L/CrashRepair/lib ../../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy -llzma -ljbig -ljpeg -lz -lm
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7595/src/contrib/addtiffo'
Making all in dbs
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7595/src/contrib/dbs'
Making all in xtiff
make[3]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7595/src/contrib/dbs/xtiff'
make[3]: Nothing to be done for 'all'.
make[3]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7595/src/contrib/dbs/xtiff'
make[3]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7595/src/contrib/dbs'
/bin/bash ../../libtool  --tag=CC   --mode=link crepair-cc  -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -fsanitize=integer-divide-by-zero  -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -fsanitize=integer-divide-by-zero -o tiff-bi tiff-bi.o ../../libtiff/libtiff.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -g -O0 -Wno-error -I/CrashRepair/lib -fsanitize=integer-divide-by-zero -g -O0 -Wno-error -I/CrashRepair/lib -fsanitize=integer-divide-by-zero -o tiff-bi tiff-bi.o  -L/klee/build/lib -L/CrashRepair/lib ../../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../../libtool  --tag=CC   --mode=link crepair-cc  -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -fsanitize=integer-divide-by-zero  -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -fsanitize=integer-divide-by-zero -o tiff-grayscale tiff-grayscale.o ../../libtiff/libtiff.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -g -O0 -Wno-error -I/CrashRepair/lib -fsanitize=integer-divide-by-zero -g -O0 -Wno-error -I/CrashRepair/lib -fsanitize=integer-divide-by-zero -o tiff-grayscale tiff-grayscale.o  -L/klee/build/lib -L/CrashRepair/lib ../../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../../libtool  --tag=CC   --mode=link crepair-cc  -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -fsanitize=integer-divide-by-zero  -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -fsanitize=integer-divide-by-zero -o tiff-palette tiff-palette.o ../../libtiff/libtiff.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -g -O0 -Wno-error -I/CrashRepair/lib -fsanitize=integer-divide-by-zero -g -O0 -Wno-error -I/CrashRepair/lib -fsanitize=integer-divide-by-zero -o tiff-palette tiff-palette.o  -L/klee/build/lib -L/CrashRepair/lib ../../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../../libtool  --tag=CC   --mode=link crepair-cc  -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -fsanitize=integer-divide-by-zero  -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -fsanitize=integer-divide-by-zero -o tiff-rgb tiff-rgb.o ../../libtiff/libtiff.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -g -O0 -Wno-error -I/CrashRepair/lib -fsanitize=integer-divide-by-zero -g -O0 -Wno-error -I/CrashRepair/lib -fsanitize=integer-divide-by-zero -o tiff-rgb tiff-rgb.o  -L/klee/build/lib -L/CrashRepair/lib ../../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy -llzma -ljbig -ljpeg -lz -lm
make[3]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7595/src/contrib/dbs'
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7595/src/contrib/dbs'
Making all in iptcutil
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7595/src/contrib/iptcutil'
/bin/bash ../../libtool  --tag=CC   --mode=link crepair-cc  -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -fsanitize=integer-divide-by-zero  -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -fsanitize=integer-divide-by-zero -o iptcutil iptcutil.o ../../libtiff/libtiff.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -g -O0 -Wno-error -I/CrashRepair/lib -fsanitize=integer-divide-by-zero -g -O0 -Wno-error -I/CrashRepair/lib -fsanitize=integer-divide-by-zero -o iptcutil iptcutil.o  -L/klee/build/lib -L/CrashRepair/lib ../../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy -llzma -ljbig -ljpeg -lz -lm
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7595/src/contrib/iptcutil'
Making all in mfs
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7595/src/contrib/mfs'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7595/src/contrib/mfs'
Making all in pds
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7595/src/contrib/pds'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7595/src/contrib/pds'
Making all in ras
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7595/src/contrib/ras'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7595/src/contrib/ras'
Making all in stream
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7595/src/contrib/stream'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7595/src/contrib/stream'
Making all in tags
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7595/src/contrib/tags'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7595/src/contrib/tags'
Making all in win_dib
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7595/src/contrib/win_dib'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7595/src/contrib/win_dib'
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7595/src/contrib'
make[2]: Nothing to be done for 'all-am'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7595/src/contrib'
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7595/src/contrib'
Making all in test
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7595/src/test'
make[1]: Nothing to be done for 'all'.
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7595/src/test'
Making all in man
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7595/src/man'
make[1]: Nothing to be done for 'all'.
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7595/src/man'
Making all in html
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7595/src/html'
Making all in images
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7595/src/html/images'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7595/src/html/images'
Making all in man
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7595/src/html/man'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7595/src/html/man'
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7595/src/html'
make[2]: Nothing to be done for 'all-am'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7595/src/html'
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7595/src/html'
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7595/src'
make[1]: Nothing to be done for 'all-am'.
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7595/src'
2025-02-03 13:47:30.689 | DEBUG    | scenario:evaluate:655 - testing candidate #0 against test #crash...
2025-02-03 13:47:30.689 | DEBUG    | shell:__call__:41 - executing: /data/vulnloc/libtiff/CVE-2017-7595/src/tools/tiffcp -i /CrashRepair/experiments/vulnloc/libtiff/CVE-2017-7595/tests/1.tif out.tiff
2025-02-03 13:47:30.703 | INFO     | scenario:evaluate:659 - candidate #0 passes test #crash
2025-02-03 13:47:30.703 | INFO     | scenario:evaluate:674 - repair found! candidate #0 passes all tests
2025-02-03 13:47:30.711 | INFO     | scenario:validate:513 - saving successful patch #0...
2025-02-03 13:47:30.711 | INFO     | scenario:validate:520 - stopping search: patch was found

