2025-02-05 20:35:40.052 | INFO     | scenario:build:265 - loaded bug scenario: Scenario(subject='libtiff', name='CVE-2017-7600', directory='/data/vulnloc/libtiff/CVE-2017-7600', build_directory='/data/vulnloc/libtiff/CVE-2017-7600/src', source_directory='/data/vulnloc/libtiff/CVE-2017-7600/src', tag_id='libtiff_CVE-2017-7600', binary_path='/data/vulnloc/libtiff/CVE-2017-7600/src/tools/tiffcp', clean_command='make clean', prebuild_command='exit 0', build_command='make CFLAGS="-fsanitize=float-cast-overflow ${INJECT_CFLAGS}" CXXFLAGS="-fsanitize=float-cast-overflow ${INJECT_CXXFLAGS}" LDFLAGS="${INJECT_LDFLAGS}"', crashing_command='-i $POC out.tiff', crashing_input='/CrashRepair/experiments/vulnloc/libtiff/CVE-2017-7600/tests/1.tif', shell=Shell(cwd='/data/vulnloc/libtiff/CVE-2017-7600'), crash_test=Test(name='crash', command='/data/vulnloc/libtiff/CVE-2017-7600/src/tools/tiffcp -i /CrashRepair/experiments/vulnloc/libtiff/CVE-2017-7600/tests/1.tif out.tiff', expected_exit_code=1, expected_stdout=None, bad_output='runtime error: -115 is outside the range of representable values', asan_options=None, ubsan_options=None), sanitizer_flags='', additional_klee_flags='--link-llvm-lib=/CrashRepair/lib/libjpeg-8.4.bca', expected_exit_code_for_crashing_input=0, should_terminate_early=True, fuzzer_tests=[], fuzzer=None, time_limit_minutes_validation=None, time_limit_seconds_single_test=30, time_limit_minutes_analysis=3600, halt_on_error=True, rebuild_for_validation=False, asan_options=None, ubsan_options=None, use_ghost_functions=False, acceptable_patch_limit=None)
2025-02-05 20:35:40.052 | INFO     | scenario:fuzz:426 - skipping fuzzing: fuzzer disabled
2025-02-05 20:35:40.052 | INFO     | analyzer:run:114 - running analysis with timeout: 60 minutes
2025-02-05 20:35:40.053 | DEBUG    | analyzer:write_config_to_file:88 - generated analyzer config:

dir_exp:/data/vulnloc/libtiff/CVE-2017-7600
tag_id:libtiff_CVE-2017-7600
src_directory:/data/vulnloc/libtiff/CVE-2017-7600/src
binary_path:/data/vulnloc/libtiff/CVE-2017-7600/src/tools/tiffcp
config_command:exit 0
build_command:make CFLAGS="-fsanitize=float-cast-overflow ${INJECT_CFLAGS}" CXXFLAGS="-fsanitize=float-cast-overflow ${INJECT_CXXFLAGS}" LDFLAGS="${INJECT_LDFLAGS}"
test_input_list:-i $POC out.tiff
poc_list:/CrashRepair/experiments/vulnloc/libtiff/CVE-2017-7600/tests/1.tif
klee_flags:--link-llvm-lib=/CrashRepair/lib/libcrepair_proxy.bca --link-llvm-lib=/CrashRepair/lib/libjpeg-8.4.bca

2025-02-05 20:35:40.053 | DEBUG    | analyzer:run:124 - wrote analyzer config file to: /tmp/tmp9gp9wvjc
2025-02-05 20:35:40.053 | DEBUG    | shell:__call__:41 - executing: crepair --conf=/tmp/tmp9gp9wvjc
[K[1;36m
====================================================================================================

	Starting CRepair (C Crash Repair) 
====================================================================================================
[0m
[K[1;36m
	Loading Configurations
	__________________________________________________________________________________________
[0m
[K	[1;34mreading configuration values from arguments[0m
[K	[1;34mreading configuration values form configuration file[0m
[K	[1;37m	[file] /tmp/tmp9gp9wvjc[0m
[K	[1;34mupdating configuration values[0m
[K	[1;34mreading test configuration[0m
[K	[1;34mreading seed information[0m
[K	[1;37m	[config] stack size: 15000[0m
[K	[1;37m	[config] collecting stats: False[0m
[K	[1;37m	[config] number of tests: 1[0m
[K	[1;37m	[config] number of cores: 8[0m
[K	[1;37m	[config] klee concrete execution timeout: 600[0m
[K	[1;37m	[config] klee concolic execution timeout: 1200[0m
[K	[1;37m	[config] synthesize subset expressions: True[0m
[K	[1;37m	[config] window size for taint locations: 500[0m
[K	[1;37m	[config] window size for taint values: 500000[0m
[K[1;36m

	Analyzing Program
====================================================================================================
[0m
[K[1;36m
	Test Case #1
	__________________________________________________________________________________________
[0m
[K[1;36m
		Running Concrete Execution
		------------------------------------------------------------------------------------------
[0m
[K	[1;37m	[0m[K     [1;37mUsing Arguments: ['-i', '$POC', 'out.tiff'][0m
[K	[1;37m	[0m[K     [1;37mUsing Input File: /CrashRepair/experiments/vulnloc/libtiff/CVE-2017-7600/tests/1.tif[0m
[K	[1;34m	building program[0m
[K	[1;34m		setting environment variables[0m
[K	[1;34m		cleaning files[0m
[K	[1;34m		configuring program[0m
[K	[1;34m		compiling program[0m
[K	[1;37m	[0m[K     [1;37mUsing Binary: /data/vulnloc/libtiff/CVE-2017-7600/src/tools/tiffcp[0m
[K	[1;34m	extracting bytecode[0m
[K	[1;34m	executing klee in concrete mode[0m
[K	[1;34m	extracting instruction trace[0m
[K	[1;37m		[note] program crashed[0m
[K	[1;34m	collecting tainted expressions[0m
[K	[1;34m	collecting tainted concrete values[0m
[K	[1;34m	collecting memory allocations/de-allocations[0m
[K	[1;34m	collecting pointer mapping[0m
[K	[1;34m	extracting crash information[0m
[K	[1;37m		[0m[K     [1;37m[info] crash type: overflow on cast operation[0m
[K	[1;37m		[0m[K     [1;37m[info] crash location:
                             /data/vulnloc/libtiff/CVE-2017-7600/src/libtiff/tif_dirwrite.c:994:26[0m
[K	[1;37m		[0m[K     [1;37m[info] crash function: TIFFWriteDirectoryTagSampleformatArray[0m
[K	[1;37m		[0m[K     [1;37m[info] crash address: 109056[0m
[K	[1;37m		[0m[K     [1;37m[info] crash free constraint: ((@var(pointer, value[i]) < UCHAR_MAX) && (0 <
                             @var(pointer, value[i])))[0m
[K	[1;37m		[0m[K     [1;37m[info] crash inducing variables: value[i][0m
[K	[1;37m			[info] identified crash type: overflow on cast operation[0m
[K[1;36m
		Running Concolic Execution
		------------------------------------------------------------------------------------------
[0m
[K	[1;37m	[0m[K     [1;37mUsing Arguments: ['-i', '$POC', 'out.tiff'][0m
[K	[1;37m	[0m[K     [1;37mUsing Input File: /CrashRepair/experiments/vulnloc/libtiff/CVE-2017-7600/tests/1.tif[0m
[K	[1;34m	building program[0m
[K	[1;34m		setting environment variables[0m
[K	[1;34m		cleaning files[0m
[K	[1;34m		configuring program[0m
[K	[1;34m		compiling program[0m
[K	[1;34m	extracting bytecode[0m
[K	[1;34m	generating ktest file[0m
[K	[1;34m	executing klee in concolic mode[0m
[K	[1;34m	extracting largest symbolic path[0m
[K	[1;34m	extracting instruction trace[0m
[K	[1;37m		[note] program did not crash[0m
[K	[1;33m	[warning] Unknown Crash Reason: [0m
[K	[1;33m	[warning] taint analysis failed, using concrete values[0m
[K	[1;37m		[0m[K     [1;37m[info] Symbolic Mapping: value[i] -> [bv495981120][0m
[K[1;36m

	Fix Localization
====================================================================================================
[0m
[K[1;36m
	Generating Fix Locations
	__________________________________________________________________________________________
[0m
[K	[1;34m	generating taint map[0m
[K	[1;37m		[0m[K     [1;37m[info] found 10596 tainted locations[0m
[K	[1;34m		starting parallel computing[0m
[K	[1;34m		waiting for thread completion[0m
[K	[1;37m		[0m[K     [1;37m[info] found 1 source files[0m
[K	[1;37m		[0m[K     [1;37m[info] found 6 executed functions[0m
[K	[1;34m	generating possible fix locations[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] TIFFWriteDirectoryTagSampleformatArray,
                             /data/vulnloc/libtiff/CVE-2017-7600/src/libtiff/tif_dirwrite.c:994:26[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] TIFFWriteDirectoryTagSampleformatArray,
                             /data/vulnloc/libtiff/CVE-2017-7600/src/libtiff/tif_dirwrite.c:994:33[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] TIFFWriteDirectoryTagSampleformatArray,
                             /data/vulnloc/libtiff/CVE-2017-7600/src/libtiff/tif_dirwrite.c:994:39[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] TIFFWriteDirectoryTagSampleformatArray,
                             /data/vulnloc/libtiff/CVE-2017-7600/src/libtiff/tif_dirwrite.c:993:19[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] TIFFWriteDirectoryTagSampleformatArray,
                             /data/vulnloc/libtiff/CVE-2017-7600/src/libtiff/tif_dirwrite.c:993:21[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] TIFFWriteDirectoryTagSampleformatArray,
                             /data/vulnloc/libtiff/CVE-2017-7600/src/libtiff/tif_dirwrite.c:993:17[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] TIFFWriteDirectoryTagSampleformatArray,
                             /data/vulnloc/libtiff/CVE-2017-7600/src/libtiff/tif_dirwrite.c:993:12[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] TIFFWriteDirectoryTagSampleformatArray,
                             /data/vulnloc/libtiff/CVE-2017-7600/src/libtiff/tif_dirwrite.c:991:37[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] TIFFWriteDirectoryTagSampleformatArray,
                             /data/vulnloc/libtiff/CVE-2017-7600/src/libtiff/tif_dirwrite.c:991:8[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] TIFFWriteDirectoryTagSampleformatArray,
                             /data/vulnloc/libtiff/CVE-2017-7600/src/libtiff/tif_dirwrite.c:991:21[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] TIFFWriteDirectoryTagSampleformatArray,
                             /data/vulnloc/libtiff/CVE-2017-7600/src/libtiff/tif_dirwrite.c:991:13[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] TIFFWriteDirectoryTagSampleformatArray,
                             /data/vulnloc/libtiff/CVE-2017-7600/src/libtiff/tif_dirwrite.c:956:10[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] TIFFWriteDirectoryTagSampleformatArray,
                             /data/vulnloc/libtiff/CVE-2017-7600/src/libtiff/tif_dirwrite.c:956:23[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] TIFFWriteDirectoryTagSampleformatArray,
                             /data/vulnloc/libtiff/CVE-2017-7600/src/libtiff/tif_dirwrite.c:956:15[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] TIFFWriteDirectoryTagSampleformatArray,
                             /data/vulnloc/libtiff/CVE-2017-7600/src/libtiff/tif_dirwrite.c:950:11[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] TIFFWriteDirectoryTagSampleformatArray,
                             /data/vulnloc/libtiff/CVE-2017-7600/src/libtiff/tif_dirwrite.c:950:6[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] TIFFWriteDirectoryTagSampleformatArray,
                             /data/vulnloc/libtiff/CVE-2017-7600/src/libtiff/tif_dirwrite.c:949:7[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] TIFFWriteDirectoryTagSampleformatArray,
                             /data/vulnloc/libtiff/CVE-2017-7600/src/libtiff/tif_dirwrite.c:949:9[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] TIFFWriteDirectoryTagSampleformatArray,
                             /data/vulnloc/libtiff/CVE-2017-7600/src/libtiff/tif_dirwrite.c:949:26[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] TIFFWriteDirectoryTagSampleformatArray,
                             /data/vulnloc/libtiff/CVE-2017-7600/src/libtiff/tif_dirwrite.c:949:21[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] TIFFWriteDirectoryTagSampleformatArray,
                             /data/vulnloc/libtiff/CVE-2017-7600/src/libtiff/tif_dirwrite.c:943:5[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] TIFFWriteDirectorySec,
                             /data/vulnloc/libtiff/CVE-2017-7600/src/libtiff/tif_dirwrite.c:589:132[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] TIFFWriteDirectorySec,
                             /data/vulnloc/libtiff/CVE-2017-7600/src/libtiff/tif_dirwrite.c:589:87[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] TIFFWriteDirectorySec,
                             /data/vulnloc/libtiff/CVE-2017-7600/src/libtiff/tif_dirwrite.c:589:92[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] TIFFWriteDirectorySec,
                             /data/vulnloc/libtiff/CVE-2017-7600/src/libtiff/tif_dirwrite.c:589:59[0m
[K	[1;37m		[0m[K     [1;37m[fix-loc] TIFFWriteDirectorySec,
                             /data/vulnloc/libtiff/CVE-2017-7600/src/libtiff/tif_dirwrite.c:589:49[0m
[K[1;36m
	Localizing Constraints
	__________________________________________________________________________________________
[0m
[K	[1;33m	[warning] did not find top-level for ('/data/vulnloc/libtiff/CVE-2017-7600/src/libtiff/tif_dirwrite.c', 943, 5)[0m
[K[1;36m
		[fix-loc] /data/vulnloc/libtiff/CVE-2017-7600/src/libtiff/tif_dirwrite.c:994:26
		------------------------------------------------------------------------------------------
[0m
[K	[1;37m	[0m[K     [1;37m[constraint] (((@result(integer)) < UCHAR_MAX) && (0 < (@result(integer))))[0m
[K[1;36m
		[fix-loc] /data/vulnloc/libtiff/CVE-2017-7600/src/libtiff/tif_dirwrite.c:994:6
		------------------------------------------------------------------------------------------
[0m
[K	[1;37m	[0m[K     [1;37m[constraint] ((@var(pointer, value[i]) < UCHAR_MAX) && (0 < @var(pointer, value[i])))[0m
[K	[1;33m	[warning] did not find top-level for ('/data/vulnloc/libtiff/CVE-2017-7600/src/libtiff/tif_dirwrite.c', 943, 5)[0m
[K	[1;33m	[warning] did not find top-level for ('/data/vulnloc/libtiff/CVE-2017-7600/src/libtiff/tif_dirwrite.c', 943, 5)[0m
[K	[1;33m	[warning] did not find top-level for ('/data/vulnloc/libtiff/CVE-2017-7600/src/libtiff/tif_dirwrite.c', 943, 5)[0m
[K	[1;33m	[warning] did not find top-level for ('/data/vulnloc/libtiff/CVE-2017-7600/src/libtiff/tif_dirwrite.c', 943, 5)[0m
[K[1;36m
		[fix-loc] /data/vulnloc/libtiff/CVE-2017-7600/src/libtiff/tif_dirwrite.c:993:5
		------------------------------------------------------------------------------------------
[0m
[K	[1;37m	[0m[K     [1;37m[constraint] ((@var(pointer, value) < UCHAR_MAX) && (0 < @var(pointer, value)))[0m
[K	[1;33m	[warning] did not find top-level for ('/data/vulnloc/libtiff/CVE-2017-7600/src/libtiff/tif_dirwrite.c', 943, 5)[0m
[K	[1;33m	[warning] did not find top-level for ('/data/vulnloc/libtiff/CVE-2017-7600/src/libtiff/tif_dirwrite.c', 943, 5)[0m
[K	[1;33m	[warning] did not find top-level for ('/data/vulnloc/libtiff/CVE-2017-7600/src/libtiff/tif_dirwrite.c', 943, 5)[0m
[K[1;36m
		[fix-loc] /data/vulnloc/libtiff/CVE-2017-7600/src/libtiff/tif_dirwrite.c:993:10
		------------------------------------------------------------------------------------------
[0m
[K	[1;37m	[0m[K     [1;37m[constraint] ((@var(pointer, value) < UCHAR_MAX) && (0 < @var(pointer, value)))[0m
[K	[1;33m	[warning] did not find top-level for ('/data/vulnloc/libtiff/CVE-2017-7600/src/libtiff/tif_dirwrite.c', 943, 5)[0m
[K[1;36m
		[fix-loc] /data/vulnloc/libtiff/CVE-2017-7600/src/libtiff/tif_dirwrite.c:991:4
		------------------------------------------------------------------------------------------
[0m
[K	[1;37m	[0m[K     [1;37m[constraint] ((@var(pointer, value) < UCHAR_MAX) && (0 < @var(pointer, value)))[0m
[K	[1;33m	[warning] did not find top-level for ('/data/vulnloc/libtiff/CVE-2017-7600/src/libtiff/tif_dirwrite.c', 943, 5)[0m
[K	[1;33m	[warning] did not find top-level for ('/data/vulnloc/libtiff/CVE-2017-7600/src/libtiff/tif_dirwrite.c', 943, 5)[0m
[K[1;36m
		[fix-loc] /data/vulnloc/libtiff/CVE-2017-7600/src/libtiff/tif_dirwrite.c:956:2
		------------------------------------------------------------------------------------------
[0m
[K	[1;37m	[0m[K     [1;37m[constraint] ((@var(pointer, value) < UCHAR_MAX) && (0 < @var(pointer, value)))[0m
[K	[1;33m	[warning] did not find top-level for ('/data/vulnloc/libtiff/CVE-2017-7600/src/libtiff/tif_dirwrite.c', 943, 5)[0m
[K[1;36m
		[fix-loc] /data/vulnloc/libtiff/CVE-2017-7600/src/libtiff/tif_dirwrite.c:950:2
		------------------------------------------------------------------------------------------
[0m
[K	[1;37m	[0m[K     [1;37m[constraint] ((@var(pointer, value) < UCHAR_MAX) && (0 < @var(pointer, value)))[0m
[K	[1;33m	[warning] did not find top-level for ('/data/vulnloc/libtiff/CVE-2017-7600/src/libtiff/tif_dirwrite.c', 943, 5)[0m
[K	[1;33m	[warning] did not find top-level for ('/data/vulnloc/libtiff/CVE-2017-7600/src/libtiff/tif_dirwrite.c', 943, 5)[0m
[K[1;36m
		[fix-loc] /data/vulnloc/libtiff/CVE-2017-7600/src/libtiff/tif_dirwrite.c:949:2
		------------------------------------------------------------------------------------------
[0m
[K	[1;37m	[0m[K     [1;37m[constraint] ((@var(pointer, value) < UCHAR_MAX) && (0 < @var(pointer, value)))[0m
[K	[1;33m	[warning] did not find top-level for ('/data/vulnloc/libtiff/CVE-2017-7600/src/libtiff/tif_dirwrite.c', 943, 5)[0m
[K[1;36m
		[fix-loc] /data/vulnloc/libtiff/CVE-2017-7600/src/libtiff/tif_dirwrite.c:949:9
		------------------------------------------------------------------------------------------
[0m
[K	[1;37m	[0m[K     [1;37m[constraint] ((@var(pointer, value) < UCHAR_MAX) && (0 < @var(pointer, value)))[0m
[K	[1;33m	[warning] did not find top-level for ('/data/vulnloc/libtiff/CVE-2017-7600/src/libtiff/tif_dirwrite.c', 943, 5)[0m
[K	[1;33m	[warning] did not find top-level for ('/data/vulnloc/libtiff/CVE-2017-7600/src/libtiff/tif_dirwrite.c', 943, 5)[0m
[K[1;36m
		[fix-loc] /data/vulnloc/libtiff/CVE-2017-7600/src/libtiff/tif_dirwrite.c:589:10
		------------------------------------------------------------------------------------------
[0m
[K	[1;37m	[0m[K     [1;37m[constraint] ((@var(pointer, tif->tif_dir.td_sminsamplevalue) < UCHAR_MAX) && (0 <
                        @var(pointer, tif->tif_dir.td_sminsamplevalue)))[0m
[K[1;32m
	localization information saved at /CrashRepair/output/libtiff_CVE-2017-7600/localization.json[0m
[K[1;32m
	state values saved at /CrashRepair/output/libtiff_CVE-2017-7600/values/[0m
[K	[1;37m
Run time statistics:
-----------------------
[0m
[K	[1;37mStartup: 0.000 minutes[0m
[K	[1;37mBuild: 0 minutes[0m
[K	[1;37mConcrete Analysis: 0.434 minutes[0m
[K	[1;37mConcolic Analysis: 21.393 minutes[0m
[K	[1;37mTotal Analysis: 21.850 minutes[0m
[K	[1;37mLocalization: 0.541 minutes[0m
[K[1;32m
CRepair finished successfully after 22.441 minutes 
[0m
2025-02-05 20:58:07.766 | WARNING  | analyzer:run:143 - analysis output directory does not exist [/data/vulnloc/libtiff/CVE-2017-7600/analysis]: creating...
2025-02-05 20:58:07.856 | INFO     | scenario:generate:454 - generating candidate repairs in implicated files: {'/data/vulnloc/libtiff/CVE-2017-7600/src/libtiff/tif_dirwrite.c'}
total_candidates:[{'diff': '@@ -939,6 +939,7 @@\n \treturn(0);\n }\n \n+\n static int\n TIFFWriteDirectoryTagSampleformatArray(TIFF* tif, uint32* ndir, TIFFDirEntry* dir, uint16 tag, uint32 count, double* value)\n {\n@@ -959,7 +960,11 @@\n \t\t\tif (tif->tif_dir.td_bitspersample<=32)\n \t\t\t{\n \t\t\t\tfor (i = 0; i < count; ++i)\n-\t\t\t\t\t((float*)conv)[i] = (float)value[i];\n+\t\t\t\t{\n+\t\t\t\t\tif (i < count) {\n+\t\t\t\t\t\t((float*)conv)[i] = (float)value[i];\n+\t\t\t\t\t}\n+\t\t\t\t}\n \t\t\t\tok = TIFFWriteDirectoryTagFloatArray(tif,ndir,dir,tag,count,(float*)conv);\n \t\t\t}\n \t\t\telse\n@@ -971,19 +976,31 @@\n \t\t\tif (tif->tif_dir.td_bitspersample<=8)\n \t\t\t{\n \t\t\t\tfor (i = 0; i < count; ++i)\n-\t\t\t\t\t((int8*)conv)[i] = (int8)value[i];\n+\t\t\t\t{\n+\t\t\t\t\tif (i < count) {\n+\t\t\t\t\t\t((int8*)conv)[i] = (int8)value[i];\n+\t\t\t\t\t}\n+\t\t\t\t}\n \t\t\t\tok = TIFFWriteDirectoryTagSbyteArray(tif,ndir,dir,tag,count,(int8*)conv);\n \t\t\t}\n \t\t\telse if (tif->tif_dir.td_bitspersample<=16)\n \t\t\t{\n \t\t\t\tfor (i = 0; i < count; ++i)\n-\t\t\t\t\t((int16*)conv)[i] = (int16)value[i];\n+\t\t\t\t{\n+\t\t\t\t\tif (i < count) {\n+\t\t\t\t\t\t((int16*)conv)[i] = (int16)value[i];\n+\t\t\t\t\t}\n+\t\t\t\t}\n \t\t\t\tok = TIFFWriteDirectoryTagSshortArray(tif,ndir,dir,tag,count,(int16*)conv);\n \t\t\t}\n \t\t\telse\n \t\t\t{\n \t\t\t\tfor (i = 0; i < count; ++i)\n-\t\t\t\t\t((int32*)conv)[i] = (int32)value[i];\n+\t\t\t\t{\n+\t\t\t\t\tif (i < count) {\n+\t\t\t\t\t\t((int32*)conv)[i] = (int32)value[i];\n+\t\t\t\t\t}\n+\t\t\t\t}\n \t\t\t\tok = TIFFWriteDirectoryTagSlongArray(tif,ndir,dir,tag,count,(int32*)conv);\n \t\t\t}\n \t\t\tbreak;\n@@ -991,19 +1008,31 @@\n \t\t\tif (tif->tif_dir.td_bitspersample<=8)\n \t\t\t{\n \t\t\t\tfor (i = 0; i < count; ++i)\n-\t\t\t\t\t((uint8*)conv)[i] = (uint8)value[i];\n+\t\t\t\t{\n+\t\t\t\t\tif (i < count) {\n+\t\t\t\t\t\t((uint8*)conv)[i] = (uint8)value[i];\n+\t\t\t\t\t}\n+\t\t\t\t}\n \t\t\t\tok = TIFFWriteDirectoryTagByteArray(tif,ndir,dir,tag,count,(uint8*)conv);\n \t\t\t}\n \t\t\telse if (tif->tif_dir.td_bitspersample<=16)\n \t\t\t{\n \t\t\t\tfor (i = 0; i < count; ++i)\n-\t\t\t\t\t((uint16*)conv)[i] = (uint16)value[i];\n+\t\t\t\t{\n+\t\t\t\t\tif (i < count) {\n+\t\t\t\t\t\t((uint16*)conv)[i] = (uint16)value[i];\n+\t\t\t\t\t}\n+\t\t\t\t}\n \t\t\t\tok = TIFFWriteDirectoryTagShortArray(tif,ndir,dir,tag,count,(uint16*)conv);\n \t\t\t}\n \t\t\telse\n \t\t\t{\n \t\t\t\tfor (i = 0; i < count; ++i)\n-\t\t\t\t\t((uint32*)conv)[i] = (uint32)value[i];\n+\t\t\t\t{\n+\t\t\t\t\tif (i < count) {\n+\t\t\t\t\t\t((uint32*)conv)[i] = (uint32)value[i];\n+\t\t\t\t\t}\n+\t\t\t\t}\n \t\t\t\tok = TIFFWriteDirectoryTagLongArray(tif,ndir,dir,tag,count,(uint32*)conv);\n \t\t\t}\n \t\t\tbreak;\n@@ -1015,6 +1044,7 @@\n \treturn (ok);\n }\n \n+\n #if 0\n static int\n TIFFWriteDirectoryTagSampleformatPerSample(TIFF* tif, uint32* ndir, TIFFDirEntry* dir, uint16 tag, double value)\n', 'id': 0, 'location': '/data/vulnloc/libtiff/CVE-2017-7600/src/libtiff/tif_dirwrite.c:994:26'}, {'diff': '@@ -939,6 +939,7 @@\n \treturn(0);\n }\n \n+\n static int\n TIFFWriteDirectoryTagSampleformatArray(TIFF* tif, uint32* ndir, TIFFDirEntry* dir, uint16 tag, uint32 count, double* value)\n {\n@@ -971,19 +972,40 @@\n \t\t\tif (tif->tif_dir.td_bitspersample<=8)\n \t\t\t{\n \t\t\t\tfor (i = 0; i < count; ++i)\n+\t\t\t\t{\n+\t\t\t\t\tif(value[i] < INT8_MIN || value[i] > INT8_MAX) {\n+\t\t\t\t\t\tTIFFErrorExt(tif->tif_clientdata, module, "Value out of range for int8");\n+\t\t\t\t\t\t_TIFFfree(conv);\n+\t\t\t\t\t\treturn 0;\n+\t\t\t\t\t}\n \t\t\t\t\t((int8*)conv)[i] = (int8)value[i];\n+\t\t\t\t}\n \t\t\t\tok = TIFFWriteDirectoryTagSbyteArray(tif,ndir,dir,tag,count,(int8*)conv);\n \t\t\t}\n \t\t\telse if (tif->tif_dir.td_bitspersample<=16)\n \t\t\t{\n \t\t\t\tfor (i = 0; i < count; ++i)\n+\t\t\t\t{\n+\t\t\t\t\tif(value[i] < INT16_MIN || value[i] > INT16_MAX) {\n+\t\t\t\t\t\tTIFFErrorExt(tif->tif_clientdata, module, "Value out of range for int16");\n+\t\t\t\t\t\t_TIFFfree(conv);\n+\t\t\t\t\t\treturn 0;\n+\t\t\t\t\t}\n \t\t\t\t\t((int16*)conv)[i] = (int16)value[i];\n+\t\t\t\t}\n \t\t\t\tok = TIFFWriteDirectoryTagSshortArray(tif,ndir,dir,tag,count,(int16*)conv);\n \t\t\t}\n \t\t\telse\n \t\t\t{\n \t\t\t\tfor (i = 0; i < count; ++i)\n+\t\t\t\t{\n+\t\t\t\t\tif(value[i] < INT32_MIN || value[i] > INT32_MAX) {\n+\t\t\t\t\t\tTIFFErrorExt(tif->tif_clientdata, module, "Value out of range for int32");\n+\t\t\t\t\t\t_TIFFfree(conv);\n+\t\t\t\t\t\treturn 0;\n+\t\t\t\t\t}\n \t\t\t\t\t((int32*)conv)[i] = (int32)value[i];\n+\t\t\t\t}\n \t\t\t\tok = TIFFWriteDirectoryTagSlongArray(tif,ndir,dir,tag,count,(int32*)conv);\n \t\t\t}\n \t\t\tbreak;\n@@ -991,19 +1013,40 @@\n \t\t\tif (tif->tif_dir.td_bitspersample<=8)\n \t\t\t{\n \t\t\t\tfor (i = 0; i < count; ++i)\n+\t\t\t\t{\n+\t\t\t\t\tif(value[i] < 0 || value[i] > UINT8_MAX) {\n+\t\t\t\t\t\tTIFFErrorExt(tif->tif_clientdata, module, "Value out of range for uint8");\n+\t\t\t\t\t\t_TIFFfree(conv);\n+\t\t\t\t\t\treturn 0;\n+\t\t\t\t\t}\n \t\t\t\t\t((uint8*)conv)[i] = (uint8)value[i];\n+\t\t\t\t}\n \t\t\t\tok = TIFFWriteDirectoryTagByteArray(tif,ndir,dir,tag,count,(uint8*)conv);\n \t\t\t}\n \t\t\telse if (tif->tif_dir.td_bitspersample<=16)\n \t\t\t{\n \t\t\t\tfor (i = 0; i < count; ++i)\n+\t\t\t\t{\n+\t\t\t\t\tif(value[i] < 0 || value[i] > UINT16_MAX) {\n+\t\t\t\t\t\tTIFFErrorExt(tif->tif_clientdata, module, "Value out of range for uint16");\n+\t\t\t\t\t\t_TIFFfree(conv);\n+\t\t\t\t\t\treturn 0;\n+\t\t\t\t\t}\n \t\t\t\t\t((uint16*)conv)[i] = (uint16)value[i];\n+\t\t\t\t}\n \t\t\t\tok = TIFFWriteDirectoryTagShortArray(tif,ndir,dir,tag,count,(uint16*)conv);\n \t\t\t}\n \t\t\telse\n \t\t\t{\n \t\t\t\tfor (i = 0; i < count; ++i)\n+\t\t\t\t{\n+\t\t\t\t\tif(value[i] < 0 || value[i] > UINT32_MAX) {\n+\t\t\t\t\t\tTIFFErrorExt(tif->tif_clientdata, module, "Value out of range for uint32");\n+\t\t\t\t\t\t_TIFFfree(conv);\n+\t\t\t\t\t\treturn 0;\n+\t\t\t\t\t}\n \t\t\t\t\t((uint32*)conv)[i] = (uint32)value[i];\n+\t\t\t\t}\n \t\t\t\tok = TIFFWriteDirectoryTagLongArray(tif,ndir,dir,tag,count,(uint32*)conv);\n \t\t\t}\n \t\t\tbreak;\n@@ -1015,6 +1058,7 @@\n \treturn (ok);\n }\n \n+\n #if 0\n static int\n TIFFWriteDirectoryTagSampleformatPerSample(TIFF* tif, uint32* ndir, TIFFDirEntry* dir, uint16 tag, double value)\n', 'id': 1, 'location': '/data/vulnloc/libtiff/CVE-2017-7600/src/libtiff/tif_dirwrite.c:994:26'}, {'diff': '@@ -939,6 +939,7 @@\n \treturn(0);\n }\n \n+\n static int\n TIFFWriteDirectoryTagSampleformatArray(TIFF* tif, uint32* ndir, TIFFDirEntry* dir, uint16 tag, uint32 count, double* value)\n {\n@@ -971,13 +972,13 @@\n \t\t\tif (tif->tif_dir.td_bitspersample<=8)\n \t\t\t{\n \t\t\t\tfor (i = 0; i < count; ++i)\n-\t\t\t\t\t((int8*)conv)[i] = (int8)value[i];\n+\t\t\t\t\t((int8*)conv)[i] = (int8)(value[i] < INT8_MIN ? INT8_MIN : (value[i] > INT8_MAX ? INT8_MAX : value[i]));\n \t\t\t\tok = TIFFWriteDirectoryTagSbyteArray(tif,ndir,dir,tag,count,(int8*)conv);\n \t\t\t}\n \t\t\telse if (tif->tif_dir.td_bitspersample<=16)\n \t\t\t{\n \t\t\t\tfor (i = 0; i < count; ++i)\n-\t\t\t\t\t((int16*)conv)[i] = (int16)value[i];\n+\t\t\t\t\t((int16*)conv)[i] = (int16)(value[i] < INT16_MIN ? INT16_MIN : (value[i] > INT16_MAX ? INT16_MAX : value[i]));\n \t\t\t\tok = TIFFWriteDirectoryTagSshortArray(tif,ndir,dir,tag,count,(int16*)conv);\n \t\t\t}\n \t\t\telse\n@@ -991,13 +992,13 @@\n \t\t\tif (tif->tif_dir.td_bitspersample<=8)\n \t\t\t{\n \t\t\t\tfor (i = 0; i < count; ++i)\n-\t\t\t\t\t((uint8*)conv)[i] = (uint8)value[i];\n+\t\t\t\t\t((uint8*)conv)[i] = (uint8)(value[i] < 0 ? 0 : (value[i] > UINT8_MAX ? UINT8_MAX : value[i]));\n \t\t\t\tok = TIFFWriteDirectoryTagByteArray(tif,ndir,dir,tag,count,(uint8*)conv);\n \t\t\t}\n \t\t\telse if (tif->tif_dir.td_bitspersample<=16)\n \t\t\t{\n \t\t\t\tfor (i = 0; i < count; ++i)\n-\t\t\t\t\t((uint16*)conv)[i] = (uint16)value[i];\n+\t\t\t\t\t((uint16*)conv)[i] = (uint16)(value[i] < 0 ? 0 : (value[i] > UINT16_MAX ? UINT16_MAX : value[i]));\n \t\t\t\tok = TIFFWriteDirectoryTagShortArray(tif,ndir,dir,tag,count,(uint16*)conv);\n \t\t\t}\n \t\t\telse\n@@ -1015,6 +1016,7 @@\n \treturn (ok);\n }\n \n+\n #if 0\n static int\n TIFFWriteDirectoryTagSampleformatPerSample(TIFF* tif, uint32* ndir, TIFFDirEntry* dir, uint16 tag, double value)\n', 'id': 2, 'location': '/data/vulnloc/libtiff/CVE-2017-7600/src/libtiff/tif_dirwrite.c:994:26'}, {'diff': '@@ -939,6 +939,7 @@\n \treturn(0);\n }\n \n+\n static int\n TIFFWriteDirectoryTagSampleformatArray(TIFF* tif, uint32* ndir, TIFFDirEntry* dir, uint16 tag, uint32 count, double* value)\n {\n@@ -971,18 +972,33 @@\n \t\t\tif (tif->tif_dir.td_bitspersample<=8)\n \t\t\t{\n \t\t\t\tfor (i = 0; i < count; ++i)\n+\t\t\t\t\tif (value[i] < INT8_MIN || value[i] > INT8_MAX) {\n+\t\t\t\t\t\tTIFFErrorExt(tif->tif_clientdata, module, "Value out of range for int8");\n+\t\t\t\t\t\t_TIFFfree(conv);\n+\t\t\t\t\t\treturn 0;\n+\t\t\t\t\t}\n \t\t\t\t\t((int8*)conv)[i] = (int8)value[i];\n \t\t\t\tok = TIFFWriteDirectoryTagSbyteArray(tif,ndir,dir,tag,count,(int8*)conv);\n \t\t\t}\n \t\t\telse if (tif->tif_dir.td_bitspersample<=16)\n \t\t\t{\n \t\t\t\tfor (i = 0; i < count; ++i)\n+\t\t\t\t\tif (value[i] < INT16_MIN || value[i] > INT16_MAX) {\n+\t\t\t\t\t\tTIFFErrorExt(tif->tif_clientdata, module, "Value out of range for int16");\n+\t\t\t\t\t\t_TIFFfree(conv);\n+\t\t\t\t\t\treturn 0;\n+\t\t\t\t\t}\n \t\t\t\t\t((int16*)conv)[i] = (int16)value[i];\n \t\t\t\tok = TIFFWriteDirectoryTagSshortArray(tif,ndir,dir,tag,count,(int16*)conv);\n \t\t\t}\n \t\t\telse\n \t\t\t{\n \t\t\t\tfor (i = 0; i < count; ++i)\n+\t\t\t\t\tif (value[i] < INT32_MIN || value[i] > INT32_MAX) {\n+\t\t\t\t\t\tTIFFErrorExt(tif->tif_clientdata, module, "Value out of range for int32");\n+\t\t\t\t\t\t_TIFFfree(conv);\n+\t\t\t\t\t\treturn 0;\n+\t\t\t\t\t}\n \t\t\t\t\t((int32*)conv)[i] = (int32)value[i];\n \t\t\t\tok = TIFFWriteDirectoryTagSlongArray(tif,ndir,dir,tag,count,(int32*)conv);\n \t\t\t}\n@@ -991,18 +1007,33 @@\n \t\t\tif (tif->tif_dir.td_bitspersample<=8)\n \t\t\t{\n \t\t\t\tfor (i = 0; i < count; ++i)\n+\t\t\t\t\tif (value[i] < 0 || value[i] > UINT8_MAX) {\n+\t\t\t\t\t\tTIFFErrorExt(tif->tif_clientdata, module, "Value out of range for uint8");\n+\t\t\t\t\t\t_TIFFfree(conv);\n+\t\t\t\t\t\treturn 0;\n+\t\t\t\t\t}\n \t\t\t\t\t((uint8*)conv)[i] = (uint8)value[i];\n \t\t\t\tok = TIFFWriteDirectoryTagByteArray(tif,ndir,dir,tag,count,(uint8*)conv);\n \t\t\t}\n \t\t\telse if (tif->tif_dir.td_bitspersample<=16)\n \t\t\t{\n \t\t\t\tfor (i = 0; i < count; ++i)\n+\t\t\t\t\tif (value[i] < 0 || value[i] > UINT16_MAX) {\n+\t\t\t\t\t\tTIFFErrorExt(tif->tif_clientdata, module, "Value out of range for uint16");\n+\t\t\t\t\t\t_TIFFfree(conv);\n+\t\t\t\t\t\treturn 0;\n+\t\t\t\t\t}\n \t\t\t\t\t((uint16*)conv)[i] = (uint16)value[i];\n \t\t\t\tok = TIFFWriteDirectoryTagShortArray(tif,ndir,dir,tag,count,(uint16*)conv);\n \t\t\t}\n \t\t\telse\n \t\t\t{\n \t\t\t\tfor (i = 0; i < count; ++i)\n+\t\t\t\t\tif (value[i] < 0 || value[i] > UINT32_MAX) {\n+\t\t\t\t\t\tTIFFErrorExt(tif->tif_clientdata, module, "Value out of range for uint32");\n+\t\t\t\t\t\t_TIFFfree(conv);\n+\t\t\t\t\t\treturn 0;\n+\t\t\t\t\t}\n \t\t\t\t\t((uint32*)conv)[i] = (uint32)value[i];\n \t\t\t\tok = TIFFWriteDirectoryTagLongArray(tif,ndir,dir,tag,count,(uint32*)conv);\n \t\t\t}\n@@ -1015,6 +1046,7 @@\n \treturn (ok);\n }\n \n+\n #if 0\n static int\n TIFFWriteDirectoryTagSampleformatPerSample(TIFF* tif, uint32* ndir, TIFFDirEntry* dir, uint16 tag, double value)\n', 'id': 3, 'location': '/data/vulnloc/libtiff/CVE-2017-7600/src/libtiff/tif_dirwrite.c:994:26'}, {'diff': '@@ -939,6 +939,7 @@\n \treturn(0);\n }\n \n+\n static int\n TIFFWriteDirectoryTagSampleformatArray(TIFF* tif, uint32* ndir, TIFFDirEntry* dir, uint16 tag, uint32 count, double* value)\n {\n@@ -959,7 +960,15 @@\n \t\t\tif (tif->tif_dir.td_bitspersample<=32)\n \t\t\t{\n \t\t\t\tfor (i = 0; i < count; ++i)\n+\t\t\t\t{\n+\t\t\t\t\tif (value[i] < FLT_MIN || value[i] > FLT_MAX)\n+\t\t\t\t\t{\n+\t\t\t\t\t\tTIFFErrorExt(tif->tif_clientdata, module, "Float value out of range");\n+\t\t\t\t\t\t_TIFFfree(conv);\n+\t\t\t\t\t\treturn (0);\n+\t\t\t\t\t}\n \t\t\t\t\t((float*)conv)[i] = (float)value[i];\n+\t\t\t\t}\n \t\t\t\tok = TIFFWriteDirectoryTagFloatArray(tif,ndir,dir,tag,count,(float*)conv);\n \t\t\t}\n \t\t\telse\n@@ -971,19 +980,43 @@\n \t\t\tif (tif->tif_dir.td_bitspersample<=8)\n \t\t\t{\n \t\t\t\tfor (i = 0; i < count; ++i)\n+\t\t\t\t{\n+\t\t\t\t\tif (value[i] < INT8_MIN || value[i] > INT8_MAX)\n+\t\t\t\t\t{\n+\t\t\t\t\t\tTIFFErrorExt(tif->tif_clientdata, module, "Int8 value out of range");\n+\t\t\t\t\t\t_TIFFfree(conv);\n+\t\t\t\t\t\treturn (0);\n+\t\t\t\t\t}\n \t\t\t\t\t((int8*)conv)[i] = (int8)value[i];\n+\t\t\t\t}\n \t\t\t\tok = TIFFWriteDirectoryTagSbyteArray(tif,ndir,dir,tag,count,(int8*)conv);\n \t\t\t}\n \t\t\telse if (tif->tif_dir.td_bitspersample<=16)\n \t\t\t{\n \t\t\t\tfor (i = 0; i < count; ++i)\n+\t\t\t\t{\n+\t\t\t\t\tif (value[i] < INT16_MIN || value[i] > INT16_MAX)\n+\t\t\t\t\t{\n+\t\t\t\t\t\tTIFFErrorExt(tif->tif_clientdata, module, "Int16 value out of range");\n+\t\t\t\t\t\t_TIFFfree(conv);\n+\t\t\t\t\t\treturn (0);\n+\t\t\t\t\t}\n \t\t\t\t\t((int16*)conv)[i] = (int16)value[i];\n+\t\t\t\t}\n \t\t\t\tok = TIFFWriteDirectoryTagSshortArray(tif,ndir,dir,tag,count,(int16*)conv);\n \t\t\t}\n \t\t\telse\n \t\t\t{\n \t\t\t\tfor (i = 0; i < count; ++i)\n+\t\t\t\t{\n+\t\t\t\t\tif (value[i] < INT32_MIN || value[i] > INT32_MAX)\n+\t\t\t\t\t{\n+\t\t\t\t\t\tTIFFErrorExt(tif->tif_clientdata, module, "Int32 value out of range");\n+\t\t\t\t\t\t_TIFFfree(conv);\n+\t\t\t\t\t\treturn (0);\n+\t\t\t\t\t}\n \t\t\t\t\t((int32*)conv)[i] = (int32)value[i];\n+\t\t\t\t}\n \t\t\t\tok = TIFFWriteDirectoryTagSlongArray(tif,ndir,dir,tag,count,(int32*)conv);\n \t\t\t}\n \t\t\tbreak;\n@@ -991,19 +1024,43 @@\n \t\t\tif (tif->tif_dir.td_bitspersample<=8)\n \t\t\t{\n \t\t\t\tfor (i = 0; i < count; ++i)\n+\t\t\t\t{\n+\t\t\t\t\tif (value[i] < 0 || value[i] > UINT8_MAX)\n+\t\t\t\t\t{\n+\t\t\t\t\t\tTIFFErrorExt(tif->tif_clientdata, module, "UInt8 value out of range");\n+\t\t\t\t\t\t_TIFFfree(conv);\n+\t\t\t\t\t\treturn (0);\n+\t\t\t\t\t}\n \t\t\t\t\t((uint8*)conv)[i] = (uint8)value[i];\n+\t\t\t\t}\n \t\t\t\tok = TIFFWriteDirectoryTagByteArray(tif,ndir,dir,tag,count,(uint8*)conv);\n \t\t\t}\n \t\t\telse if (tif->tif_dir.td_bitspersample<=16)\n \t\t\t{\n \t\t\t\tfor (i = 0; i < count; ++i)\n+\t\t\t\t{\n+\t\t\t\t\tif (value[i] < 0 || value[i] > UINT16_MAX)\n+\t\t\t\t\t{\n+\t\t\t\t\t\tTIFFErrorExt(tif->tif_clientdata, module, "UInt16 value out of range");\n+\t\t\t\t\t\t_TIFFfree(conv);\n+\t\t\t\t\t\treturn (0);\n+\t\t\t\t\t}\n \t\t\t\t\t((uint16*)conv)[i] = (uint16)value[i];\n+\t\t\t\t}\n \t\t\t\tok = TIFFWriteDirectoryTagShortArray(tif,ndir,dir,tag,count,(uint16*)conv);\n \t\t\t}\n \t\t\telse\n \t\t\t{\n \t\t\t\tfor (i = 0; i < count; ++i)\n+\t\t\t\t{\n+\t\t\t\t\tif (value[i] < 0 || value[i] > UINT32_MAX)\n+\t\t\t\t\t{\n+\t\t\t\t\t\tTIFFErrorExt(tif->tif_clientdata, module, "UInt32 value out of range");\n+\t\t\t\t\t\t_TIFFfree(conv);\n+\t\t\t\t\t\treturn (0);\n+\t\t\t\t\t}\n \t\t\t\t\t((uint32*)conv)[i] = (uint32)value[i];\n+\t\t\t\t}\n \t\t\t\tok = TIFFWriteDirectoryTagLongArray(tif,ndir,dir,tag,count,(uint32*)conv);\n \t\t\t}\n \t\t\tbreak;\n@@ -1015,6 +1072,7 @@\n \treturn (ok);\n }\n \n+\n #if 0\n static int\n TIFFWriteDirectoryTagSampleformatPerSample(TIFF* tif, uint32* ndir, TIFFDirEntry* dir, uint16 tag, double value)\n', 'id': 4, 'location': '/data/vulnloc/libtiff/CVE-2017-7600/src/libtiff/tif_dirwrite.c:994:26'}, {'diff': '@@ -939,6 +939,7 @@\n \treturn(0);\n }\n \n+\n static int\n TIFFWriteDirectoryTagSampleformatArray(TIFF* tif, uint32* ndir, TIFFDirEntry* dir, uint16 tag, uint32 count, double* value)\n {\n@@ -983,7 +984,14 @@\n \t\t\telse\n \t\t\t{\n \t\t\t\tfor (i = 0; i < count; ++i)\n+\t\t\t\t{\n+\t\t\t\t\tif (value[i] < INT32_MIN || value[i] > INT32_MAX) {\n+\t\t\t\t\t\tTIFFErrorExt(tif->tif_clientdata, module, "Value out of range for int32");\n+\t\t\t\t\t\t_TIFFfree(conv);\n+\t\t\t\t\t\treturn 0;\n+\t\t\t\t\t}\n \t\t\t\t\t((int32*)conv)[i] = (int32)value[i];\n+\t\t\t\t}\n \t\t\t\tok = TIFFWriteDirectoryTagSlongArray(tif,ndir,dir,tag,count,(int32*)conv);\n \t\t\t}\n \t\t\tbreak;\n@@ -991,19 +999,40 @@\n \t\t\tif (tif->tif_dir.td_bitspersample<=8)\n \t\t\t{\n \t\t\t\tfor (i = 0; i < count; ++i)\n+\t\t\t\t{\n+\t\t\t\t\tif (value[i] < 0 || value[i] > UINT8_MAX) {\n+\t\t\t\t\t\tTIFFErrorExt(tif->tif_clientdata, module, "Value out of range for uint8");\n+\t\t\t\t\t\t_TIFFfree(conv);\n+\t\t\t\t\t\treturn 0;\n+\t\t\t\t\t}\n \t\t\t\t\t((uint8*)conv)[i] = (uint8)value[i];\n+\t\t\t\t}\n \t\t\t\tok = TIFFWriteDirectoryTagByteArray(tif,ndir,dir,tag,count,(uint8*)conv);\n \t\t\t}\n \t\t\telse if (tif->tif_dir.td_bitspersample<=16)\n \t\t\t{\n \t\t\t\tfor (i = 0; i < count; ++i)\n+\t\t\t\t{\n+\t\t\t\t\tif (value[i] < 0 || value[i] > UINT16_MAX) {\n+\t\t\t\t\t\tTIFFErrorExt(tif->tif_clientdata, module, "Value out of range for uint16");\n+\t\t\t\t\t\t_TIFFfree(conv);\n+\t\t\t\t\t\treturn 0;\n+\t\t\t\t\t}\n \t\t\t\t\t((uint16*)conv)[i] = (uint16)value[i];\n+\t\t\t\t}\n \t\t\t\tok = TIFFWriteDirectoryTagShortArray(tif,ndir,dir,tag,count,(uint16*)conv);\n \t\t\t}\n \t\t\telse\n \t\t\t{\n \t\t\t\tfor (i = 0; i < count; ++i)\n+\t\t\t\t{\n+\t\t\t\t\tif (value[i] < 0 || value[i] > UINT32_MAX) {\n+\t\t\t\t\t\tTIFFErrorExt(tif->tif_clientdata, module, "Value out of range for uint32");\n+\t\t\t\t\t\t_TIFFfree(conv);\n+\t\t\t\t\t\treturn 0;\n+\t\t\t\t\t}\n \t\t\t\t\t((uint32*)conv)[i] = (uint32)value[i];\n+\t\t\t\t}\n \t\t\t\tok = TIFFWriteDirectoryTagLongArray(tif,ndir,dir,tag,count,(uint32*)conv);\n \t\t\t}\n \t\t\tbreak;\n@@ -1015,6 +1044,7 @@\n \treturn (ok);\n }\n \n+\n #if 0\n static int\n TIFFWriteDirectoryTagSampleformatPerSample(TIFF* tif, uint32* ndir, TIFFDirEntry* dir, uint16 tag, double value)\n', 'id': 5, 'location': '/data/vulnloc/libtiff/CVE-2017-7600/src/libtiff/tif_dirwrite.c:994:6'}, {'diff': '@@ -939,6 +939,7 @@\n \treturn(0);\n }\n \n+\n static int\n TIFFWriteDirectoryTagSampleformatArray(TIFF* tif, uint32* ndir, TIFFDirEntry* dir, uint16 tag, uint32 count, double* value)\n {\n@@ -958,8 +959,10 @@\n \t\tcase SAMPLEFORMAT_IEEEFP:\n \t\t\tif (tif->tif_dir.td_bitspersample<=32)\n \t\t\t{\n-\t\t\t\tfor (i = 0; i < count; ++i)\n-\t\t\t\t\t((float*)conv)[i] = (float)value[i];\n+\t\t\t\tfor (i = 0; i < count; ++i) {\n+\t\t\t\t\tif (i < count) // Ensure we do not write beyond the allocated memory\n+\t\t\t\t\t\t((float*)conv)[i] = (float)value[i];\n+\t\t\t\t}\n \t\t\t\tok = TIFFWriteDirectoryTagFloatArray(tif,ndir,dir,tag,count,(float*)conv);\n \t\t\t}\n \t\t\telse\n@@ -970,40 +973,52 @@\n \t\tcase SAMPLEFORMAT_INT:\n \t\t\tif (tif->tif_dir.td_bitspersample<=8)\n \t\t\t{\n-\t\t\t\tfor (i = 0; i < count; ++i)\n-\t\t\t\t\t((int8*)conv)[i] = (int8)value[i];\n+\t\t\t\tfor (i = 0; i < count; ++i) {\n+\t\t\t\t\tif (i < count) // Ensure we do not write beyond the allocated memory\n+\t\t\t\t\t\t((int8*)conv)[i] = (int8)value[i];\n+\t\t\t\t}\n \t\t\t\tok = TIFFWriteDirectoryTagSbyteArray(tif,ndir,dir,tag,count,(int8*)conv);\n \t\t\t}\n \t\t\telse if (tif->tif_dir.td_bitspersample<=16)\n \t\t\t{\n-\t\t\t\tfor (i = 0; i < count; ++i)\n-\t\t\t\t\t((int16*)conv)[i] = (int16)value[i];\n+\t\t\t\tfor (i = 0; i < count; ++i) {\n+\t\t\t\t\tif (i < count) // Ensure we do not write beyond the allocated memory\n+\t\t\t\t\t\t((int16*)conv)[i] = (int16)value[i];\n+\t\t\t\t}\n \t\t\t\tok = TIFFWriteDirectoryTagSshortArray(tif,ndir,dir,tag,count,(int16*)conv);\n \t\t\t}\n \t\t\telse\n \t\t\t{\n-\t\t\t\tfor (i = 0; i < count; ++i)\n-\t\t\t\t\t((int32*)conv)[i] = (int32)value[i];\n+\t\t\t\tfor (i = 0; i < count; ++i) {\n+\t\t\t\t\tif (i < count) // Ensure we do not write beyond the allocated memory\n+\t\t\t\t\t\t((int32*)conv)[i] = (int32)value[i];\n+\t\t\t\t}\n \t\t\t\tok = TIFFWriteDirectoryTagSlongArray(tif,ndir,dir,tag,count,(int32*)conv);\n \t\t\t}\n \t\t\tbreak;\n \t\tcase SAMPLEFORMAT_UINT:\n \t\t\tif (tif->tif_dir.td_bitspersample<=8)\n \t\t\t{\n-\t\t\t\tfor (i = 0; i < count; ++i)\n-\t\t\t\t\t((uint8*)conv)[i] = (uint8)value[i];\n+\t\t\t\tfor (i = 0; i < count; ++i) {\n+\t\t\t\t\tif (i < count) // Ensure we do not write beyond the allocated memory\n+\t\t\t\t\t\t((uint8*)conv)[i] = (uint8)value[i];\n+\t\t\t\t}\n \t\t\t\tok = TIFFWriteDirectoryTagByteArray(tif,ndir,dir,tag,count,(uint8*)conv);\n \t\t\t}\n \t\t\telse if (tif->tif_dir.td_bitspersample<=16)\n \t\t\t{\n-\t\t\t\tfor (i = 0; i < count; ++i)\n-\t\t\t\t\t((uint16*)conv)[i] = (uint16)value[i];\n+\t\t\t\tfor (i = 0; i < count; ++i) {\n+\t\t\t\t\tif (i < count) // Ensure we do not write beyond the allocated memory\n+\t\t\t\t\t\t((uint16*)conv)[i] = (uint16)value[i];\n+\t\t\t\t}\n \t\t\t\tok = TIFFWriteDirectoryTagShortArray(tif,ndir,dir,tag,count,(uint16*)conv);\n \t\t\t}\n \t\t\telse\n \t\t\t{\n-\t\t\t\tfor (i = 0; i < count; ++i)\n-\t\t\t\t\t((uint32*)conv)[i] = (uint32)value[i];\n+\t\t\t\tfor (i = 0; i < count; ++i) {\n+\t\t\t\t\tif (i < count) // Ensure we do not write beyond the allocated memory\n+\t\t\t\t\t\t((uint32*)conv)[i] = (uint32)value[i];\n+\t\t\t\t}\n \t\t\t\tok = TIFFWriteDirectoryTagLongArray(tif,ndir,dir,tag,count,(uint32*)conv);\n \t\t\t}\n \t\t\tbreak;\n@@ -1015,6 +1030,7 @@\n \treturn (ok);\n }\n \n+\n #if 0\n static int\n TIFFWriteDirectoryTagSampleformatPerSample(TIFF* tif, uint32* ndir, TIFFDirEntry* dir, uint16 tag, double value)\n', 'id': 6, 'location': '/data/vulnloc/libtiff/CVE-2017-7600/src/libtiff/tif_dirwrite.c:994:6'}, {'diff': '@@ -939,6 +939,7 @@\n \treturn(0);\n }\n \n+\n static int\n TIFFWriteDirectoryTagSampleformatArray(TIFF* tif, uint32* ndir, TIFFDirEntry* dir, uint16 tag, uint32 count, double* value)\n {\n@@ -946,7 +947,7 @@\n \tvoid* conv;\n \tuint32 i;\n \tint ok;\n-\tconv = _TIFFmalloc(count*sizeof(double));\n+\tconv = _TIFFmalloc(count * sizeof(double));\n \tif (conv == NULL)\n \t{\n \t\tTIFFErrorExt(tif->tif_clientdata, module, "Out of memory");\n@@ -956,55 +957,76 @@\n \tswitch (tif->tif_dir.td_sampleformat)\n \t{\n \t\tcase SAMPLEFORMAT_IEEEFP:\n-\t\t\tif (tif->tif_dir.td_bitspersample<=32)\n+\t\t\tif (tif->tif_dir.td_bitspersample <= 32)\n \t\t\t{\n \t\t\t\tfor (i = 0; i < count; ++i)\n+\t\t\t\t{\n+\t\t\t\t\tif (value[i] < -FLT_MAX || value[i] > FLT_MAX) return 0; // Added check for float range\n \t\t\t\t\t((float*)conv)[i] = (float)value[i];\n-\t\t\t\tok = TIFFWriteDirectoryTagFloatArray(tif,ndir,dir,tag,count,(float*)conv);\n+\t\t\t\t}\n+\t\t\t\tok = TIFFWriteDirectoryTagFloatArray(tif, ndir, dir, tag, count, (float*)conv);\n \t\t\t}\n \t\t\telse\n \t\t\t{\n-\t\t\t\tok = TIFFWriteDirectoryTagDoubleArray(tif,ndir,dir,tag,count,value);\n+\t\t\t\tok = TIFFWriteDirectoryTagDoubleArray(tif, ndir, dir, tag, count, value);\n \t\t\t}\n \t\t\tbreak;\n \t\tcase SAMPLEFORMAT_INT:\n-\t\t\tif (tif->tif_dir.td_bitspersample<=8)\n+\t\t\tif (tif->tif_dir.td_bitspersample <= 8)\n \t\t\t{\n \t\t\t\tfor (i = 0; i < count; ++i)\n+\t\t\t\t{\n+\t\t\t\t\tif (value[i] < INT8_MIN || value[i] > INT8_MAX) return 0; // Added check for int8 range\n \t\t\t\t\t((int8*)conv)[i] = (int8)value[i];\n-\t\t\t\tok = TIFFWriteDirectoryTagSbyteArray(tif,ndir,dir,tag,count,(int8*)conv);\n+\t\t\t\t}\n+\t\t\t\tok = TIFFWriteDirectoryTagSbyteArray(tif, ndir, dir, tag, count, (int8*)conv);\n \t\t\t}\n-\t\t\telse if (tif->tif_dir.td_bitspersample<=16)\n+\t\t\telse if (tif->tif_dir.td_bitspersample <= 16)\n \t\t\t{\n-\t\t\t\tfor (i = 0; i < count; ++i)\n+\t\t\t\tfor (i = 0; i < count; ++i++)\n+\t\t\t\t{\n+\t\t\t\t\tif (value[i] < INT16_MIN || value[i] > INT16_MAX) return 0; // Added check for int16 range\n \t\t\t\t\t((int16*)conv)[i] = (int16)value[i];\n-\t\t\t\tok = TIFFWriteDirectoryTagSshortArray(tif,ndir,dir,tag,count,(int16*)conv);\n+\t\t\t\t}\n+\t\t\t\tok = TIFFWriteDirectoryTagSshortArray(tif, ndir, dir, tag, count, (int16*)conv);\n \t\t\t}\n \t\t\telse\n \t\t\t{\n-\t\t\t\tfor (i = 0; i < count; ++i)\n+\t\t\t\tfor (i = 0; i < count; ++i++)\n+\t\t\t\t{\n+\t\t\t\t\tif (value[i] < INT32_MIN || value[i] > INT32_MAX) return 0; // Added check for int32 range\n \t\t\t\t\t((int32*)conv)[i] = (int32)value[i];\n-\t\t\t\tok = TIFFWriteDirectoryTagSlongArray(tif,ndir,dir,tag,count,(int32*)conv);\n+\t\t\t\t}\n+\t\t\t\tok = TIFFWriteDirectoryTagSlongArray(tif, ndir, dir, tag, count, (int32*)conv);\n \t\t\t}\n \t\t\tbreak;\n \t\tcase SAMPLEFORMAT_UINT:\n-\t\t\tif (tif->tif_dir.td_bitspersample<=8)\n+\t\t\tif (tif->tif_dir.td_bitspersample <= 8)\n \t\t\t{\n-\t\t\t\tfor (i = 0; i < count; ++i)\n+\t\t\t\tfor (i = 0; i < count; ++i++)\n+\t\t\t\t{\n+\t\t\t\t\tif (value[i] < 0 || value[i] > UINT8_MAX) return 0; // Added check for uint8 range\n \t\t\t\t\t((uint8*)conv)[i] = (uint8)value[i];\n-\t\t\t\tok = TIFFWriteDirectoryTagByteArray(tif,ndir,dir,tag,count,(uint8*)conv);\n+\t\t\t\t}\n+\t\t\t\tok = TIFFWriteDirectoryTagByteArray(tif, ndir, dir, tag, count, (uint8*)conv);\n \t\t\t}\n-\t\t\telse if (tif->tif_dir.td_bitspersample<=16)\n+\t\t\telse if (tif->tif_dir.td_bitspersample <= 16)\n \t\t\t{\n-\t\t\t\tfor (i = 0; i < count; ++i)\n+\t\t\t\tfor (i = 0; i < count; ++i++)\n+\t\t\t\t{\n+\t\t\t\t\tif (value[i] < 0 || value[i] > UINT16_MAX) return 0; // Added check for uint16 range\n \t\t\t\t\t((uint16*)conv)[i] = (uint16)value[i];\n-\t\t\t\tok = TIFFWriteDirectoryTagShortArray(tif,ndir,dir,tag,count,(uint16*)conv);\n+\t\t\t\t}\n+\t\t\t\tok = TIFFWriteDirectoryTagShortArray(tif, ndir, dir, tag, count, (uint16*)conv);\n \t\t\t}\n \t\t\telse\n \t\t\t{\n-\t\t\t\tfor (i = 0; i < count; ++i)\n+\t\t\t\tfor (i = 0; i < count; ++i++)\n+\t\t\t\t{\n+\t\t\t\t\tif (value[i] < 0 || value[i] > UINT32_MAX) return 0; // Added check for uint32 range\n \t\t\t\t\t((uint32*)conv)[i] = (uint32)value[i];\n-\t\t\t\tok = TIFFWriteDirectoryTagLongArray(tif,ndir,dir,tag,count,(uint32*)conv);\n+\t\t\t\t}\n+\t\t\t\tok = TIFFWriteDirectoryTagLongArray(tif, ndir, dir, tag, count, (uint32*)conv);\n \t\t\t}\n \t\t\tbreak;\n \t\tdefault:\n@@ -1015,6 +1037,7 @@\n \treturn (ok);\n }\n \n+\n #if 0\n static int\n TIFFWriteDirectoryTagSampleformatPerSample(TIFF* tif, uint32* ndir, TIFFDirEntry* dir, uint16 tag, double value)\n', 'id': 7, 'location': '/data/vulnloc/libtiff/CVE-2017-7600/src/libtiff/tif_dirwrite.c:994:6'}, {'diff': '@@ -939,6 +939,7 @@\n \treturn(0);\n }\n \n+\n static int\n TIFFWriteDirectoryTagSampleformatArray(TIFF* tif, uint32* ndir, TIFFDirEntry* dir, uint16 tag, uint32 count, double* value)\n {\n@@ -958,8 +959,13 @@\n \t\tcase SAMPLEFORMAT_IEEEFP:\n \t\t\tif (tif->tif_dir.td_bitspersample<=32)\n \t\t\t{\n-\t\t\t\tfor (i = 0; i < count; ++i)\n+\t\t\t\tfor (i = 0; i < count; ++i) {\n+\t\t\t\t\tif (value[i] < -FLT_MAX || value[i] > FLT_MAX) {\n+\t\t\t\t\t\t_TIFFfree(conv);\n+\t\t\t\t\t\treturn 0; // Prevent overflow\n+\t\t\t\t\t}\n \t\t\t\t\t((float*)conv)[i] = (float)value[i];\n+\t\t\t\t}\n \t\t\t\tok = TIFFWriteDirectoryTagFloatArray(tif,ndir,dir,tag,count,(float*)conv);\n \t\t\t}\n \t\t\telse\n@@ -970,40 +976,70 @@\n \t\tcase SAMPLEFORMAT_INT:\n \t\t\tif (tif->tif_dir.td_bitspersample<=8)\n \t\t\t{\n-\t\t\t\tfor (i = 0; i < count; ++i)\n+\t\t\t\tfor (i = 0; i < count; ++i) {\n+\t\t\t\t\tif (value[i] < INT8_MIN || value[i] > INT8_MAX) {\n+\t\t\t\t\t\t_TIFFfree(conv);\n+\t\t\t\t\t\treturn 0; // Prevent overflow\n+\t\t\t\t\t}\n \t\t\t\t\t((int8*)conv)[i] = (int8)value[i];\n+\t\t\t\t}\n \t\t\t\tok = TIFFWriteDirectoryTagSbyteArray(tif,ndir,dir,tag,count,(int8*)conv);\n \t\t\t}\n \t\t\telse if (tif->tif_dir.td_bitspersample<=16)\n \t\t\t{\n-\t\t\t\tfor (i = 0; i < count; ++i)\n+\t\t\t\tfor (i = 0; i < count; ++i) {\n+\t\t\t\t\tif (value[i] < INT16_MIN || value[i] > INT16_MAX) {\n+\t\t\t\t\t\t_TIFFfree(conv);\n+\t\t\t\t\t\treturn 0; // Prevent overflow\n+\t\t\t\t\t}\n \t\t\t\t\t((int16*)conv)[i] = (int16)value[i];\n+\t\t\t\t}\n \t\t\t\tok = TIFFWriteDirectoryTagSshortArray(tif,ndir,dir,tag,count,(int16*)conv);\n \t\t\t}\n \t\t\telse\n \t\t\t{\n-\t\t\t\tfor (i = 0; i < count; ++i)\n+\t\t\t\tfor (i = 0; i < count; ++i) {\n+\t\t\t\t\tif (value[i] < INT32_MIN || value[i] > INT32_MAX) {\n+\t\t\t\t\t\t_TIFFfree(conv);\n+\t\t\t\t\t\treturn 0; // Prevent overflow\n+\t\t\t\t\t}\n \t\t\t\t\t((int32*)conv)[i] = (int32)value[i];\n+\t\t\t\t}\n \t\t\t\tok = TIFFWriteDirectoryTagSlongArray(tif,ndir,dir,tag,count,(int32*)conv);\n \t\t\t}\n \t\t\tbreak;\n \t\tcase SAMPLEFORMAT_UINT:\n \t\t\tif (tif->tif_dir.td_bitspersample<=8)\n \t\t\t{\n-\t\t\t\tfor (i = 0; i < count; ++i)\n+\t\t\t\tfor (i = 0; i < count; ++i) {\n+\t\t\t\t\tif (value[i] < 0 || value[i] > UINT8_MAX) {\n+\t\t\t\t\t\t_TIFFfree(conv);\n+\t\t\t\t\t\treturn 0; // Prevent overflow\n+\t\t\t\t\t}\n \t\t\t\t\t((uint8*)conv)[i] = (uint8)value[i];\n+\t\t\t\t}\n \t\t\t\tok = TIFFWriteDirectoryTagByteArray(tif,ndir,dir,tag,count,(uint8*)conv);\n \t\t\t}\n \t\t\telse if (tif->tif_dir.td_bitspersample<=16)\n \t\t\t{\n-\t\t\t\tfor (i = 0; i < count; ++i)\n+\t\t\t\tfor (i = 0; i < count; ++i) {\n+\t\t\t\t\tif (value[i] < 0 || value[i] > UINT16_MAX) {\n+\t\t\t\t\t\t_TIFFfree(conv);\n+\t\t\t\t\t\treturn 0; // Prevent overflow\n+\t\t\t\t\t}\n \t\t\t\t\t((uint16*)conv)[i] = (uint16)value[i];\n+\t\t\t\t}\n \t\t\t\tok = TIFFWriteDirectoryTagShortArray(tif,ndir,dir,tag,count,(uint16*)conv);\n \t\t\t}\n \t\t\telse\n \t\t\t{\n-\t\t\t\tfor (i = 0; i < count; ++i)\n+\t\t\t\tfor (i = 0; i < count; ++i) {\n+\t\t\t\t\tif (value[i] < 0 || value[i] > UINT32_MAX) {\n+\t\t\t\t\t\t_TIFFfree(conv);\n+\t\t\t\t\t\treturn 0; // Prevent overflow\n+\t\t\t\t\t}\n \t\t\t\t\t((uint32*)conv)[i] = (uint32)value[i];\n+\t\t\t\t}\n \t\t\t\tok = TIFFWriteDirectoryTagLongArray(tif,ndir,dir,tag,count,(uint32*)conv);\n \t\t\t}\n \t\t\tbreak;\n@@ -1015,6 +1051,7 @@\n \treturn (ok);\n }\n \n+\n #if 0\n static int\n TIFFWriteDirectoryTagSampleformatPerSample(TIFF* tif, uint32* ndir, TIFFDirEntry* dir, uint16 tag, double value)\n', 'id': 8, 'location': '/data/vulnloc/libtiff/CVE-2017-7600/src/libtiff/tif_dirwrite.c:994:6'}, {'diff': '@@ -939,6 +939,7 @@\n \treturn(0);\n }\n \n+\n static int\n TIFFWriteDirectoryTagSampleformatArray(TIFF* tif, uint32* ndir, TIFFDirEntry* dir, uint16 tag, uint32 count, double* value)\n {\n@@ -946,7 +947,7 @@\n \tvoid* conv;\n \tuint32 i;\n \tint ok;\n-\tconv = _TIFFmalloc(count*sizeof(double));\n+\tconv = _TIFFmalloc(count * sizeof(double));\n \tif (conv == NULL)\n \t{\n \t\tTIFFErrorExt(tif->tif_clientdata, module, "Out of memory");\n@@ -956,55 +957,91 @@\n \tswitch (tif->tif_dir.td_sampleformat)\n \t{\n \t\tcase SAMPLEFORMAT_IEEEFP:\n-\t\t\tif (tif->tif_dir.td_bitspersample<=32)\n+\t\t\tif (tif->tif_dir.td_bitspersample <= 32)\n \t\t\t{\n \t\t\t\tfor (i = 0; i < count; ++i)\n \t\t\t\t\t((float*)conv)[i] = (float)value[i];\n-\t\t\t\tok = TIFFWriteDirectoryTagFloatArray(tif,ndir,dir,tag,count,(float*)conv);\n+\t\t\t\tok = TIFFWriteDirectoryTagFloatArray(tif, ndir, dir, tag, count, (float*)conv);\n \t\t\t}\n \t\t\telse\n \t\t\t{\n-\t\t\t\tok = TIFFWriteDirectoryTagDoubleArray(tif,ndir,dir,tag,count,value);\n+\t\t\t\tok = TIFFWriteDirectoryTagDoubleArray(tif, ndir, dir, tag, count, value);\n \t\t\t}\n \t\t\tbreak;\n \t\tcase SAMPLEFORMAT_INT:\n-\t\t\tif (tif->tif_dir.td_bitspersample<=8)\n+\t\t\tif (tif->tif_dir.td_bitspersample <= 8)\n \t\t\t{\n \t\t\t\tfor (i = 0; i < count; ++i)\n+\t\t\t\t{\n+\t\t\t\t\tif (value[i] < INT8_MIN || value[i] > INT8_MAX) {\n+\t\t\t\t\t\t_TIFFfree(conv);\n+\t\t\t\t\t\treturn 0; // Out of bounds check\n+\t\t\t\t\t}\n \t\t\t\t\t((int8*)conv)[i] = (int8)value[i];\n-\t\t\t\tok = TIFFWriteDirectoryTagSbyteArray(tif,ndir,dir,tag,count,(int8*)conv);\n+\t\t\t\t}\n+\t\t\t\tok = TIFFWriteDirectoryTagSbyteArray(tif, ndir, dir, tag, count, (int8*)conv);\n \t\t\t}\n-\t\t\telse if (tif->tif_dir.td_bitspersample<=16)\n+\t\t\telse if (tif->tif_dir.td_bitspersample <= 16)\n \t\t\t{\n \t\t\t\tfor (i = 0; i < count; ++i)\n+\t\t\t\t{\n+\t\t\t\t\tif (value[i] < INT16_MIN || value[i] > INT16_MAX) {\n+\t\t\t\t\t\t_TIFFfree(conv);\n+\t\t\t\t\t\treturn 0; // Out of bounds check\n+\t\t\t\t\t}\n \t\t\t\t\t((int16*)conv)[i] = (int16)value[i];\n-\t\t\t\tok = TIFFWriteDirectoryTagSshortArray(tif,ndir,dir,tag,count,(int16*)conv);\n+\t\t\t\t}\n+\t\t\t\tok = TIFFWriteDirectoryTagSshortArray(tif, ndir, dir, tag, count, (int16*)conv);\n \t\t\t}\n \t\t\telse\n \t\t\t{\n \t\t\t\tfor (i = 0; i < count; ++i)\n+\t\t\t\t{\n+\t\t\t\t\tif (value[i] < INT32_MIN || value[i] > INT32_MAX) {\n+\t\t\t\t\t\t_TIFFfree(conv);\n+\t\t\t\t\t\treturn 0; // Out of bounds check\n+\t\t\t\t\t}\n \t\t\t\t\t((int32*)conv)[i] = (int32)value[i];\n-\t\t\t\tok = TIFFWriteDirectoryTagSlongArray(tif,ndir,dir,tag,count,(int32*)conv);\n+\t\t\t\t}\n+\t\t\t\tok = TIFFWriteDirectoryTagSlongArray(tif, ndir, dir, tag, count, (int32*)conv);\n \t\t\t}\n \t\t\tbreak;\n \t\tcase SAMPLEFORMAT_UINT:\n-\t\t\tif (tif->tif_dir.td_bitspersample<=8)\n+\t\t\tif (tif->tif_dir.td_bitspersample <= 8)\n \t\t\t{\n \t\t\t\tfor (i = 0; i < count; ++i)\n+\t\t\t\t{\n+\t\t\t\t\tif (value[i] < 0 || value[i] > UINT8_MAX) {\n+\t\t\t\t\t\t_TIFFfree(conv);\n+\t\t\t\t\t\treturn 0; // Out of bounds check\n+\t\t\t\t\t}\n \t\t\t\t\t((uint8*)conv)[i] = (uint8)value[i];\n-\t\t\t\tok = TIFFWriteDirectoryTagByteArray(tif,ndir,dir,tag,count,(uint8*)conv);\n+\t\t\t\t}\n+\t\t\t\tok = TIFFWriteDirectoryTagByteArray(tif, ndir, dir, tag, count, (uint8*)conv);\n \t\t\t}\n-\t\t\telse if (tif->tif_dir.td_bitspersample<=16)\n+\t\t\telse if (tif->tif_dir.td_bitspersample <= 16)\n \t\t\t{\n \t\t\t\tfor (i = 0; i < count; ++i)\n+\t\t\t\t{\n+\t\t\t\t\tif (value[i] < 0 || value[i] > UINT16_MAX) {\n+\t\t\t\t\t\t_TIFFfree(conv);\n+\t\t\t\t\t\treturn 0; // Out of bounds check\n+\t\t\t\t\t}\n \t\t\t\t\t((uint16*)conv)[i] = (uint16)value[i];\n-\t\t\t\tok = TIFFWriteDirectoryTagShortArray(tif,ndir,dir,tag,count,(uint16*)conv);\n+\t\t\t\t}\n+\t\t\t\tok = TIFFWriteDirectoryTagShortArray(tif, ndir, dir, tag, count, (uint16*)conv);\n \t\t\t}\n \t\t\telse\n \t\t\t{\n \t\t\t\tfor (i = 0; i < count; ++i)\n+\t\t\t\t{\n+\t\t\t\t\tif (value[i] < 0 || value[i] > UINT32_MAX) {\n+\t\t\t\t\t\t_TIFFfree(conv);\n+\t\t\t\t\t\treturn 0; // Out of bounds check\n+\t\t\t\t\t}\n \t\t\t\t\t((uint32*)conv)[i] = (uint32)value[i];\n-\t\t\t\tok = TIFFWriteDirectoryTagLongArray(tif,ndir,dir,tag,count,(uint32*)conv);\n+\t\t\t\t}\n+\t\t\t\tok = TIFFWriteDirectoryTagLongArray(tif, ndir, dir, tag, count, (uint32*)conv);\n \t\t\t}\n \t\t\tbreak;\n \t\tdefault:\n@@ -1015,6 +1052,7 @@\n \treturn (ok);\n }\n \n+\n #if 0\n static int\n TIFFWriteDirectoryTagSampleformatPerSample(TIFF* tif, uint32* ndir, TIFFDirEntry* dir, uint16 tag, double value)\n', 'id': 9, 'location': '/data/vulnloc/libtiff/CVE-2017-7600/src/libtiff/tif_dirwrite.c:994:6'}, {'diff': '@@ -939,6 +939,7 @@\n \treturn(0);\n }\n \n+\n static int\n TIFFWriteDirectoryTagSampleformatArray(TIFF* tif, uint32* ndir, TIFFDirEntry* dir, uint16 tag, uint32 count, double* value)\n {\n@@ -953,6 +954,13 @@\n \t\treturn (0);\n \t}\n \n+\tif (count > MAX_COUNT) // Added safeguard to prevent excessive iterations\n+\t{\n+\t\tTIFFErrorExt(tif->tif_clientdata, module, "Count exceeds maximum allowed size");\n+\t\t_TIFFfree(conv);\n+\t\treturn (0);\n+\t}\n+\n \tswitch (tif->tif_dir.td_sampleformat)\n \t{\n \t\tcase SAMPLEFORMAT_IEEEFP:\n@@ -1015,6 +1023,7 @@\n \treturn (ok);\n }\n \n+\n #if 0\n static int\n TIFFWriteDirectoryTagSampleformatPerSample(TIFF* tif, uint32* ndir, TIFFDirEntry* dir, uint16 tag, double value)\n', 'id': 10, 'location': '/data/vulnloc/libtiff/CVE-2017-7600/src/libtiff/tif_dirwrite.c:993:5'}, {'diff': '@@ -939,82 +939,88 @@\n \treturn(0);\n }\n \n+\n static int\n TIFFWriteDirectoryTagSampleformatArray(TIFF* tif, uint32* ndir, TIFFDirEntry* dir, uint16 tag, uint32 count, double* value)\n {\n-\tstatic const char module[] = "TIFFWriteDirectoryTagSampleformatArray";\n-\tvoid* conv;\n-\tuint32 i;\n-\tint ok;\n-\tconv = _TIFFmalloc(count*sizeof(double));\n-\tif (conv == NULL)\n-\t{\n-\t\tTIFFErrorExt(tif->tif_clientdata, module, "Out of memory");\n-\t\treturn (0);\n-\t}\n-\n-\tswitch (tif->tif_dir.td_sampleformat)\n-\t{\n-\t\tcase SAMPLEFORMAT_IEEEFP:\n-\t\t\tif (tif->tif_dir.td_bitspersample<=32)\n-\t\t\t{\n-\t\t\t\tfor (i = 0; i < count; ++i)\n-\t\t\t\t\t((float*)conv)[i] = (float)value[i];\n-\t\t\t\tok = TIFFWriteDirectoryTagFloatArray(tif,ndir,dir,tag,count,(float*)conv);\n-\t\t\t}\n-\t\t\telse\n-\t\t\t{\n-\t\t\t\tok = TIFFWriteDirectoryTagDoubleArray(tif,ndir,dir,tag,count,value);\n-\t\t\t}\n-\t\t\tbreak;\n-\t\tcase SAMPLEFORMAT_INT:\n-\t\t\tif (tif->tif_dir.td_bitspersample<=8)\n-\t\t\t{\n-\t\t\t\tfor (i = 0; i < count; ++i)\n-\t\t\t\t\t((int8*)conv)[i] = (int8)value[i];\n-\t\t\t\tok = TIFFWriteDirectoryTagSbyteArray(tif,ndir,dir,tag,count,(int8*)conv);\n-\t\t\t}\n-\t\t\telse if (tif->tif_dir.td_bitspersample<=16)\n-\t\t\t{\n-\t\t\t\tfor (i = 0; i < count; ++i)\n-\t\t\t\t\t((int16*)conv)[i] = (int16)value[i];\n-\t\t\t\tok = TIFFWriteDirectoryTagSshortArray(tif,ndir,dir,tag,count,(int16*)conv);\n-\t\t\t}\n-\t\t\telse\n-\t\t\t{\n-\t\t\t\tfor (i = 0; i < count; ++i)\n-\t\t\t\t\t((int32*)conv)[i] = (int32)value[i];\n-\t\t\t\tok = TIFFWriteDirectoryTagSlongArray(tif,ndir,dir,tag,count,(int32*)conv);\n-\t\t\t}\n-\t\t\tbreak;\n-\t\tcase SAMPLEFORMAT_UINT:\n-\t\t\tif (tif->tif_dir.td_bitspersample<=8)\n-\t\t\t{\n-\t\t\t\tfor (i = 0; i < count; ++i)\n-\t\t\t\t\t((uint8*)conv)[i] = (uint8)value[i];\n-\t\t\t\tok = TIFFWriteDirectoryTagByteArray(tif,ndir,dir,tag,count,(uint8*)conv);\n-\t\t\t}\n-\t\t\telse if (tif->tif_dir.td_bitspersample<=16)\n-\t\t\t{\n-\t\t\t\tfor (i = 0; i < count; ++i)\n-\t\t\t\t\t((uint16*)conv)[i] = (uint16)value[i];\n-\t\t\t\tok = TIFFWriteDirectoryTagShortArray(tif,ndir,dir,tag,count,(uint16*)conv);\n-\t\t\t}\n-\t\t\telse\n-\t\t\t{\n-\t\t\t\tfor (i = 0; i < count; ++i)\n-\t\t\t\t\t((uint32*)conv)[i] = (uint32)value[i];\n-\t\t\t\tok = TIFFWriteDirectoryTagLongArray(tif,ndir,dir,tag,count,(uint32*)conv);\n-\t\t\t}\n-\t\t\tbreak;\n-\t\tdefault:\n-\t\t\tok = 0;\n-\t}\n+    static const char module[] = "TIFFWriteDirectoryTagSampleformatArray";\n+    void* conv;\n+    uint32 i;\n+    int ok;\n+    if (count == 0) {\n+        TIFFErrorExt(tif->tif_clientdata, module, "Count cannot be zero");\n+        return (0);\n+    }\n+    conv = _TIFFmalloc(count*sizeof(double));\n+    if (conv == NULL)\n+    {\n+        TIFFErrorExt(tif->tif_clientdata, module, "Out of memory");\n+        return (0);\n+    }\n+\n+    switch (tif->tif_dir.td_sampleformat)\n+    {\n+        case SAMPLEFORMAT_IEEEFP:\n+            if (tif->tif_dir.td_bitspersample<=32)\n+            {\n+                for (i = 0; i < count; ++i)\n+                    ((float*)conv)[i] = (float)value[i];\n+                ok = TIFFWriteDirectoryTagFloatArray(tif,ndir,dir,tag,count,(float*)conv);\n+            }\n+            else\n+            {\n+                ok = TIFFWriteDirectoryTagDoubleArray(tif,ndir,dir,tag,count,value);\n+            }\n+            break;\n+        case SAMPLEFORMAT_INT:\n+            if (tif->tif_dir.td_bitspersample<=8)\n+            {\n+                for (i = 0; i < count; ++i)\n+                    ((int8*)conv)[i] = (int8)value[i];\n+                ok = TIFFWriteDirectoryTagSbyteArray(tif,ndir,dir,tag,count,(int8*)conv);\n+            }\n+            else if (tif->tif_dir.td_bitspersample<=16)\n+            {\n+                for (i = 0; i < count; ++i)\n+                    ((int16*)conv)[i] = (int16)value[i];\n+                ok = TIFFWriteDirectoryTagSshortArray(tif,ndir,dir,tag,count,(int16*)conv);\n+            }\n+            else\n+            {\n+                for (i = 0; i < count; ++i)\n+                    ((int32*)conv)[i] = (int32)value[i];\n+                ok = TIFFWriteDirectoryTagSlongArray(tif,ndir,dir,tag,count,(int32*)conv);\n+            }\n+            break;\n+        case SAMPLEFORMAT_UINT:\n+            if (tif->tif_dir.td_bitspersample<=8)\n+            {\n+                for (i = 0; i < count; ++i)\n+                    ((uint8*)conv)[i] = (uint8)value[i];\n+                ok = TIFFWriteDirectoryTagByteArray(tif,ndir,dir,tag,count,(uint8*)conv);\n+            }\n+            else if (tif->tif_dir.td_bitspersample<=16)\n+            {\n+                for (i = 0; i < count; ++i)\n+                    ((uint16*)conv)[i] = (uint16)value[i];\n+                ok = TIFFWriteDirectoryTagShortArray(tif,ndir,dir,tag,count,(uint16*)conv);\n+            }\n+            else\n+            {\n+                for (i = 0; i < count; ++i)\n+                    ((uint32*)conv)[i] = (uint32)value[i];\n+                ok = TIFFWriteDirectoryTagLongArray(tif,ndir,dir,tag,count,(uint32*)conv);\n+            }\n+            break;\n+        default:\n+            ok = 0;\n+    }\n \n-\t_TIFFfree(conv);\n-\treturn (ok);\n+    _TIFFfree(conv);\n+    return (ok);\n }\n \n+\n #if 0\n static int\n TIFFWriteDirectoryTagSampleformatPerSample(TIFF* tif, uint32* ndir, TIFFDirEntry* dir, uint16 tag, double value)\n', 'id': 11, 'location': '/data/vulnloc/libtiff/CVE-2017-7600/src/libtiff/tif_dirwrite.c:993:5'}, {'diff': '@@ -939,6 +939,7 @@\n \treturn(0);\n }\n \n+\n static int\n TIFFWriteDirectoryTagSampleformatArray(TIFF* tif, uint32* ndir, TIFFDirEntry* dir, uint16 tag, uint32 count, double* value)\n {\n@@ -946,7 +947,13 @@\n \tvoid* conv;\n \tuint32 i;\n \tint ok;\n-\tconv = _TIFFmalloc(count*sizeof(double));\n+\t\n+\tif (count == 0 || value == NULL) {\n+\t\tTIFFErrorExt(tif->tif_clientdata, module, "Invalid count or value pointer");\n+\t\treturn (0);\n+\t}\n+\n+\tconv = _TIFFmalloc(count * sizeof(double));\n \tif (conv == NULL)\n \t{\n \t\tTIFFErrorExt(tif->tif_clientdata, module, "Out of memory");\n@@ -956,55 +963,55 @@\n \tswitch (tif->tif_dir.td_sampleformat)\n \t{\n \t\tcase SAMPLEFORMAT_IEEEFP:\n-\t\t\tif (tif->tif_dir.td_bitspersample<=32)\n+\t\t\tif (tif->tif_dir.td_bitspersample <= 32)\n \t\t\t{\n \t\t\t\tfor (i = 0; i < count; ++i)\n \t\t\t\t\t((float*)conv)[i] = (float)value[i];\n-\t\t\t\tok = TIFFWriteDirectoryTagFloatArray(tif,ndir,dir,tag,count,(float*)conv);\n+\t\t\t\tok = TIFFWriteDirectoryTagFloatArray(tif, ndir, dir, tag, count, (float*)conv);\n \t\t\t}\n \t\t\telse\n \t\t\t{\n-\t\t\t\tok = TIFFWriteDirectoryTagDoubleArray(tif,ndir,dir,tag,count,value);\n+\t\t\t\tok = TIFFWriteDirectoryTagDoubleArray(tif, ndir, dir, tag, count, value);\n \t\t\t}\n \t\t\tbreak;\n \t\tcase SAMPLEFORMAT_INT:\n-\t\t\tif (tif->tif_dir.td_bitspersample<=8)\n+\t\t\tif (tif->tif_dir.td_bitspersample <= 8)\n \t\t\t{\n \t\t\t\tfor (i = 0; i < count; ++i)\n \t\t\t\t\t((int8*)conv)[i] = (int8)value[i];\n-\t\t\t\tok = TIFFWriteDirectoryTagSbyteArray(tif,ndir,dir,tag,count,(int8*)conv);\n+\t\t\t\tok = TIFFWriteDirectoryTagSbyteArray(tif, ndir, dir, tag, count, (int8*)conv);\n \t\t\t}\n-\t\t\telse if (tif->tif_dir.td_bitspersample<=16)\n+\t\t\telse if (tif->tif_dir.td_bitspersample <= 16)\n \t\t\t{\n \t\t\t\tfor (i = 0; i < count; ++i)\n \t\t\t\t\t((int16*)conv)[i] = (int16)value[i];\n-\t\t\t\tok = TIFFWriteDirectoryTagSshortArray(tif,ndir,dir,tag,count,(int16*)conv);\n+\t\t\t\tok = TIFFWriteDirectoryTagSshortArray(tif, ndir, dir, tag, count, (int16*)conv);\n \t\t\t}\n \t\t\telse\n \t\t\t{\n \t\t\t\tfor (i = 0; i < count; ++i)\n \t\t\t\t\t((int32*)conv)[i] = (int32)value[i];\n-\t\t\t\tok = TIFFWriteDirectoryTagSlongArray(tif,ndir,dir,tag,count,(int32*)conv);\n+\t\t\t\tok = TIFFWriteDirectoryTagSlongArray(tif, ndir, dir, tag, count, (int32*)conv);\n \t\t\t}\n \t\t\tbreak;\n \t\tcase SAMPLEFORMAT_UINT:\n-\t\t\tif (tif->tif_dir.td_bitspersample<=8)\n+\t\t\tif (tif->tif_dir.td_bitspersample <= 8)\n \t\t\t{\n \t\t\t\tfor (i = 0; i < count; ++i)\n \t\t\t\t\t((uint8*)conv)[i] = (uint8)value[i];\n-\t\t\t\tok = TIFFWriteDirectoryTagByteArray(tif,ndir,dir,tag,count,(uint8*)conv);\n+\t\t\t\tok = TIFFWriteDirectoryTagByteArray(tif, ndir, dir, tag, count, (uint8*)conv);\n \t\t\t}\n-\t\t\telse if (tif->tif_dir.td_bitspersample<=16)\n+\t\t\telse if (tif->tif_dir.td_bitspersample <= 16)\n \t\t\t{\n \t\t\t\tfor (i = 0; i < count; ++i)\n \t\t\t\t\t((uint16*)conv)[i] = (uint16)value[i];\n-\t\t\t\tok = TIFFWriteDirectoryTagShortArray(tif,ndir,dir,tag,count,(uint16*)conv);\n+\t\t\t\tok = TIFFWriteDirectoryTagShortArray(tif, ndir, dir, tag, count, (uint16*)conv);\n \t\t\t}\n \t\t\telse\n \t\t\t{\n \t\t\t\tfor (i = 0; i < count; ++i)\n \t\t\t\t\t((uint32*)conv)[i] = (uint32)value[i];\n-\t\t\t\tok = TIFFWriteDirectoryTagLongArray(tif,ndir,dir,tag,count,(uint32*)conv);\n+\t\t\t\tok = TIFFWriteDirectoryTagLongArray(tif, ndir, dir, tag, count, (uint32*)conv);\n \t\t\t}\n \t\t\tbreak;\n \t\tdefault:\n@@ -1015,6 +1022,7 @@\n \treturn (ok);\n }\n \n+\n #if 0\n static int\n TIFFWriteDirectoryTagSampleformatPerSample(TIFF* tif, uint32* ndir, TIFFDirEntry* dir, uint16 tag, double value)\n', 'id': 12, 'location': '/data/vulnloc/libtiff/CVE-2017-7600/src/libtiff/tif_dirwrite.c:993:5'}, {'diff': '@@ -939,6 +939,7 @@\n \treturn(0);\n }\n \n+\n static int\n TIFFWriteDirectoryTagSampleformatArray(TIFF* tif, uint32* ndir, TIFFDirEntry* dir, uint16 tag, uint32 count, double* value)\n {\n@@ -953,6 +954,11 @@\n \t\treturn (0);\n \t}\n \n+\tif (count == 0) {\n+\t\t_TIFFfree(conv);\n+\t\treturn (1);  // Treat empty input as valid\n+\t}\n+\n \tswitch (tif->tif_dir.td_sampleformat)\n \t{\n \t\tcase SAMPLEFORMAT_IEEEFP:\n@@ -1015,6 +1021,7 @@\n \treturn (ok);\n }\n \n+\n #if 0\n static int\n TIFFWriteDirectoryTagSampleformatPerSample(TIFF* tif, uint32* ndir, TIFFDirEntry* dir, uint16 tag, double value)\n', 'id': 13, 'location': '/data/vulnloc/libtiff/CVE-2017-7600/src/libtiff/tif_dirwrite.c:993:5'}, {'diff': '@@ -939,6 +939,7 @@\n \treturn(0);\n }\n \n+\n static int\n TIFFWriteDirectoryTagSampleformatArray(TIFF* tif, uint32* ndir, TIFFDirEntry* dir, uint16 tag, uint32 count, double* value)\n {\n@@ -946,6 +947,10 @@\n \tvoid* conv;\n \tuint32 i;\n \tint ok;\n+\tif (count == 0) // New check to handle zero count\n+\t{\n+\t\treturn 1; // Early return if count is zero\n+\t}\n \tconv = _TIFFmalloc(count*sizeof(double));\n \tif (conv == NULL)\n \t{\n@@ -1015,6 +1020,7 @@\n \treturn (ok);\n }\n \n+\n #if 0\n static int\n TIFFWriteDirectoryTagSampleformatPerSample(TIFF* tif, uint32* ndir, TIFFDirEntry* dir, uint16 tag, double value)\n', 'id': 14, 'location': '/data/vulnloc/libtiff/CVE-2017-7600/src/libtiff/tif_dirwrite.c:993:5'}, {'diff': '@@ -939,6 +939,7 @@\n \treturn(0);\n }\n \n+\n static int\n TIFFWriteDirectoryTagSampleformatArray(TIFF* tif, uint32* ndir, TIFFDirEntry* dir, uint16 tag, uint32 count, double* value)\n {\n@@ -958,8 +959,10 @@\n \t\tcase SAMPLEFORMAT_IEEEFP:\n \t\t\tif (tif->tif_dir.td_bitspersample<=32)\n \t\t\t{\n-\t\t\t\tfor (i = 0; i < count; ++i)\n-\t\t\t\t\t((float*)conv)[i] = (float)value[i];\n+\t\t\t\tif (count > 0) {\n+\t\t\t\t\tfor (i = 0; i < count; ++i)\n+\t\t\t\t\t\t((float*)conv)[i] = (float)value[i];\n+\t\t\t\t}\n \t\t\t\tok = TIFFWriteDirectoryTagFloatArray(tif,ndir,dir,tag,count,(float*)conv);\n \t\t\t}\n \t\t\telse\n@@ -970,40 +973,52 @@\n \t\tcase SAMPLEFORMAT_INT:\n \t\t\tif (tif->tif_dir.td_bitspersample<=8)\n \t\t\t{\n-\t\t\t\tfor (i = 0; i < count; ++i)\n-\t\t\t\t\t((int8*)conv)[i] = (int8)value[i];\n+\t\t\t\tif (count > 0) {\n+\t\t\t\t\tfor (i = 0; i < count; ++i)\n+\t\t\t\t\t\t((int8*)conv)[i] = (int8)value[i];\n+\t\t\t\t}\n \t\t\t\tok = TIFFWriteDirectoryTagSbyteArray(tif,ndir,dir,tag,count,(int8*)conv);\n \t\t\t}\n \t\t\telse if (tif->tif_dir.td_bitspersample<=16)\n \t\t\t{\n-\t\t\t\tfor (i = 0; i < count; ++i)\n-\t\t\t\t\t((int16*)conv)[i] = (int16)value[i];\n+\t\t\t\tif (count > 0) {\n+\t\t\t\t\tfor (i = 0; i < count; ++i)\n+\t\t\t\t\t\t((int16*)conv)[i] = (int16)value[i];\n+\t\t\t\t}\n \t\t\t\tok = TIFFWriteDirectoryTagSshortArray(tif,ndir,dir,tag,count,(int16*)conv);\n \t\t\t}\n \t\t\telse\n \t\t\t{\n-\t\t\t\tfor (i = 0; i < count; ++i)\n-\t\t\t\t\t((int32*)conv)[i] = (int32)value[i];\n+\t\t\t\tif (count > 0) {\n+\t\t\t\t\tfor (i = 0; i < count; ++i)\n+\t\t\t\t\t\t((int32*)conv)[i] = (int32)value[i];\n+\t\t\t\t}\n \t\t\t\tok = TIFFWriteDirectoryTagSlongArray(tif,ndir,dir,tag,count,(int32*)conv);\n \t\t\t}\n \t\t\tbreak;\n \t\tcase SAMPLEFORMAT_UINT:\n \t\t\tif (tif->tif_dir.td_bitspersample<=8)\n \t\t\t{\n-\t\t\t\tfor (i = 0; i < count; ++i)\n-\t\t\t\t\t((uint8*)conv)[i] = (uint8)value[i];\n+\t\t\t\tif (count > 0) {\n+\t\t\t\t\tfor (i = 0; i < count; ++i)\n+\t\t\t\t\t\t((uint8*)conv)[i] = (uint8)value[i];\n+\t\t\t\t}\n \t\t\t\tok = TIFFWriteDirectoryTagByteArray(tif,ndir,dir,tag,count,(uint8*)conv);\n \t\t\t}\n \t\t\telse if (tif->tif_dir.td_bitspersample<=16)\n \t\t\t{\n-\t\t\t\tfor (i = 0; i < count; ++i)\n-\t\t\t\t\t((uint16*)conv)[i] = (uint16)value[i];\n+\t\t\t\tif (count > 0) {\n+\t\t\t\t\tfor (i = 0; i < count; ++i)\n+\t\t\t\t\t\t((uint16*)conv)[i] = (uint16)value[i];\n+\t\t\t\t}\n \t\t\t\tok = TIFFWriteDirectoryTagShortArray(tif,ndir,dir,tag,count,(uint16*)conv);\n \t\t\t}\n \t\t\telse\n \t\t\t{\n-\t\t\t\tfor (i = 0; i < count; ++i)\n-\t\t\t\t\t((uint32*)conv)[i] = (uint32)value[i];\n+\t\t\t\tif (count > 0) {\n+\t\t\t\t\tfor (i = 0; i < count; ++i)\n+\t\t\t\t\t\t((uint32*)conv)[i] = (uint32)value[i];\n+\t\t\t\t}\n \t\t\t\tok = TIFFWriteDirectoryTagLongArray(tif,ndir,dir,tag,count,(uint32*)conv);\n \t\t\t}\n \t\t\tbreak;\n@@ -1015,6 +1030,7 @@\n \treturn (ok);\n }\n \n+\n #if 0\n static int\n TIFFWriteDirectoryTagSampleformatPerSample(TIFF* tif, uint32* ndir, TIFFDirEntry* dir, uint16 tag, double value)\n', 'id': 15, 'location': '/data/vulnloc/libtiff/CVE-2017-7600/src/libtiff/tif_dirwrite.c:993:10'}, {'diff': '@@ -939,6 +939,7 @@\n \treturn(0);\n }\n \n+\n static int\n TIFFWriteDirectoryTagSampleformatArray(TIFF* tif, uint32* ndir, TIFFDirEntry* dir, uint16 tag, uint32 count, double* value)\n {\n@@ -946,65 +947,70 @@\n \tvoid* conv;\n \tuint32 i;\n \tint ok;\n-\tconv = _TIFFmalloc(count*sizeof(double));\n+\tconv = _TIFFmalloc(count * sizeof(double));\n \tif (conv == NULL)\n \t{\n \t\tTIFFErrorExt(tif->tif_clientdata, module, "Out of memory");\n \t\treturn (0);\n \t}\n \n+\tif (count == 0) {\n+\t\t_TIFFfree(conv);\n+\t\treturn (1); // No data to write, consider it as a success\n+\t}\n+\n \tswitch (tif->tif_dir.td_sampleformat)\n \t{\n \t\tcase SAMPLEFORMAT_IEEEFP:\n-\t\t\tif (tif->tif_dir.td_bitspersample<=32)\n+\t\t\tif (tif->tif_dir.td_bitspersample <= 32)\n \t\t\t{\n \t\t\t\tfor (i = 0; i < count; ++i)\n \t\t\t\t\t((float*)conv)[i] = (float)value[i];\n-\t\t\t\tok = TIFFWriteDirectoryTagFloatArray(tif,ndir,dir,tag,count,(float*)conv);\n+\t\t\t\tok = TIFFWriteDirectoryTagFloatArray(tif, ndir, dir, tag, count, (float*)conv);\n \t\t\t}\n \t\t\telse\n \t\t\t{\n-\t\t\t\tok = TIFFWriteDirectoryTagDoubleArray(tif,ndir,dir,tag,count,value);\n+\t\t\t\tok = TIFFWriteDirectoryTagDoubleArray(tif, ndir, dir, tag, count, value);\n \t\t\t}\n \t\t\tbreak;\n \t\tcase SAMPLEFORMAT_INT:\n-\t\t\tif (tif->tif_dir.td_bitspersample<=8)\n+\t\t\tif (tif->tif_dir.td_bitspersample <= 8)\n \t\t\t{\n \t\t\t\tfor (i = 0; i < count; ++i)\n \t\t\t\t\t((int8*)conv)[i] = (int8)value[i];\n-\t\t\t\tok = TIFFWriteDirectoryTagSbyteArray(tif,ndir,dir,tag,count,(int8*)conv);\n+\t\t\t\tok = TIFFWriteDirectoryTagSbyteArray(tif, ndir, dir, tag, count, (int8*)conv);\n \t\t\t}\n-\t\t\telse if (tif->tif_dir.td_bitspersample<=16)\n+\t\t\telse if (tif->tif_dir.td_bitspersample <= 16)\n \t\t\t{\n \t\t\t\tfor (i = 0; i < count; ++i)\n \t\t\t\t\t((int16*)conv)[i] = (int16)value[i];\n-\t\t\t\tok = TIFFWriteDirectoryTagSshortArray(tif,ndir,dir,tag,count,(int16*)conv);\n+\t\t\t\tok = TIFFWriteDirectoryTagSshortArray(tif, ndir, dir, tag, count, (int16*)conv);\n \t\t\t}\n \t\t\telse\n \t\t\t{\n \t\t\t\tfor (i = 0; i < count; ++i)\n \t\t\t\t\t((int32*)conv)[i] = (int32)value[i];\n-\t\t\t\tok = TIFFWriteDirectoryTagSlongArray(tif,ndir,dir,tag,count,(int32*)conv);\n+\t\t\t\tok = TIFFWriteDirectoryTagSlongArray(tif, ndir, dir, tag, count, (int32*)conv);\n \t\t\t}\n \t\t\tbreak;\n \t\tcase SAMPLEFORMAT_UINT:\n-\t\t\tif (tif->tif_dir.td_bitspersample<=8)\n+\t\t\tif (tif->tif_dir.td_bitspersample <= 8)\n \t\t\t{\n \t\t\t\tfor (i = 0; i < count; ++i)\n \t\t\t\t\t((uint8*)conv)[i] = (uint8)value[i];\n-\t\t\t\tok = TIFFWriteDirectoryTagByteArray(tif,ndir,dir,tag,count,(uint8*)conv);\n+\t\t\t\tok = TIFFWriteDirectoryTagByteArray(tif, ndir, dir, tag, count, (uint8*)conv);\n \t\t\t}\n-\t\t\telse if (tif->tif_dir.td_bitspersample<=16)\n+\t\t\telse if (tif->tif_dir.td_bitspersample <= 16)\n \t\t\t{\n \t\t\t\tfor (i = 0; i < count; ++i)\n \t\t\t\t\t((uint16*)conv)[i] = (uint16)value[i];\n-\t\t\t\tok = TIFFWriteDirectoryTagShortArray(tif,ndir,dir,tag,count,(uint16*)conv);\n+\t\t\t\tok = TIFFWriteDirectoryTagShortArray(tif, ndir, dir, tag, count, (uint16*)conv);\n \t\t\t}\n \t\t\telse\n \t\t\t{\n \t\t\t\tfor (i = 0; i < count; ++i)\n \t\t\t\t\t((uint32*)conv)[i] = (uint32)value[i];\n-\t\t\t\tok = TIFFWriteDirectoryTagLongArray(tif,ndir,dir,tag,count,(uint32*)conv);\n+\t\t\t\tok = TIFFWriteDirectoryTagLongArray(tif, ndir, dir, tag, count, (uint32*)conv);\n \t\t\t}\n \t\t\tbreak;\n \t\tdefault:\n@@ -1015,6 +1021,7 @@\n \treturn (ok);\n }\n \n+\n #if 0\n static int\n TIFFWriteDirectoryTagSampleformatPerSample(TIFF* tif, uint32* ndir, TIFFDirEntry* dir, uint16 tag, double value)\n', 'id': 16, 'location': '/data/vulnloc/libtiff/CVE-2017-7600/src/libtiff/tif_dirwrite.c:993:10'}, {'diff': '@@ -939,6 +939,7 @@\n \treturn(0);\n }\n \n+\n static int\n TIFFWriteDirectoryTagSampleformatArray(TIFF* tif, uint32* ndir, TIFFDirEntry* dir, uint16 tag, uint32 count, double* value)\n {\n@@ -958,7 +959,7 @@\n \t\tcase SAMPLEFORMAT_IEEEFP:\n \t\t\tif (tif->tif_dir.td_bitspersample<=32)\n \t\t\t{\n-\t\t\t\tfor (i = 0; i < count; ++i)\n+\t\t\t\tfor (i = 0; i < count && i < MAX_COUNT; ++i) // Added bound check\n \t\t\t\t\t((float*)conv)[i] = (float)value[i];\n \t\t\t\tok = TIFFWriteDirectoryTagFloatArray(tif,ndir,dir,tag,count,(float*)conv);\n \t\t\t}\n@@ -970,19 +971,19 @@\n \t\tcase SAMPLEFORMAT_INT:\n \t\t\tif (tif->tif_dir.td_bitspersample<=8)\n \t\t\t{\n-\t\t\t\tfor (i = 0; i < count; ++i)\n+\t\t\t\tfor (i = 0; i < count && i < MAX_COUNT; ++i) // Added bound check\n \t\t\t\t\t((int8*)conv)[i] = (int8)value[i];\n \t\t\t\tok = TIFFWriteDirectoryTagSbyteArray(tif,ndir,dir,tag,count,(int8*)conv);\n \t\t\t}\n \t\t\telse if (tif->tif_dir.td_bitspersample<=16)\n \t\t\t{\n-\t\t\t\tfor (i = 0; i < count; ++i)\n+\t\t\t\tfor (i = 0; i < count && i < MAX_COUNT; ++i) // Added bound check\n \t\t\t\t\t((int16*)conv)[i] = (int16)value[i];\n \t\t\t\tok = TIFFWriteDirectoryTagSshortArray(tif,ndir,dir,tag,count,(int16*)conv);\n \t\t\t}\n \t\t\telse\n \t\t\t{\n-\t\t\t\tfor (i = 0; i < count; ++i)\n+\t\t\t\tfor (i = 0; i < count && i < MAX_COUNT; ++i) // Added bound check\n \t\t\t\t\t((int32*)conv)[i] = (int32)value[i];\n \t\t\t\tok = TIFFWriteDirectoryTagSlongArray(tif,ndir,dir,tag,count,(int32*)conv);\n \t\t\t}\n@@ -990,19 +991,19 @@\n \t\tcase SAMPLEFORMAT_UINT:\n \t\t\tif (tif->tif_dir.td_bitspersample<=8)\n \t\t\t{\n-\t\t\t\tfor (i = 0; i < count; ++i)\n+\t\t\t\tfor (i = 0; i < count && i < MAX_COUNT; ++i) // Added bound check\n \t\t\t\t\t((uint8*)conv)[i] = (uint8)value[i];\n \t\t\t\tok = TIFFWriteDirectoryTagByteArray(tif,ndir,dir,tag,count,(uint8*)conv);\n \t\t\t}\n \t\t\telse if (tif->tif_dir.td_bitspersample<=16)\n \t\t\t{\n-\t\t\t\tfor (i = 0; i < count; ++i)\n+\t\t\t\tfor (i = 0; i < count && i < MAX_COUNT; ++i) // Added bound check\n \t\t\t\t\t((uint16*)conv)[i] = (uint16)value[i];\n \t\t\t\tok = TIFFWriteDirectoryTagShortArray(tif,ndir,dir,tag,count,(uint16*)conv);\n \t\t\t}\n \t\t\telse\n \t\t\t{\n-\t\t\t\tfor (i = 0; i < count; ++i)\n+\t\t\t\tfor (i = 0; i < count && i < MAX_COUNT; ++i) // Added bound check\n \t\t\t\t\t((uint32*)conv)[i] = (uint32)value[i];\n \t\t\t\tok = TIFFWriteDirectoryTagLongArray(tif,ndir,dir,tag,count,(uint32*)conv);\n \t\t\t}\n@@ -1015,6 +1016,7 @@\n \treturn (ok);\n }\n \n+\n #if 0\n static int\n TIFFWriteDirectoryTagSampleformatPerSample(TIFF* tif, uint32* ndir, TIFFDirEntry* dir, uint16 tag, double value)\n', 'id': 17, 'location': '/data/vulnloc/libtiff/CVE-2017-7600/src/libtiff/tif_dirwrite.c:993:10'}, {'diff': '@@ -939,6 +939,7 @@\n \treturn(0);\n }\n \n+\n static int\n TIFFWriteDirectoryTagSampleformatArray(TIFF* tif, uint32* ndir, TIFFDirEntry* dir, uint16 tag, uint32 count, double* value)\n {\n@@ -946,6 +947,11 @@\n \tvoid* conv;\n \tuint32 i;\n \tint ok;\n+\tif (count == 0 || value == NULL) // Added check for count and value\n+\t{\n+\t\tTIFFErrorExt(tif->tif_clientdata, module, "Invalid count or value provided");\n+\t\treturn (0);\n+\t}\n \tconv = _TIFFmalloc(count*sizeof(double));\n \tif (conv == NULL)\n \t{\n@@ -1015,6 +1021,7 @@\n \treturn (ok);\n }\n \n+\n #if 0\n static int\n TIFFWriteDirectoryTagSampleformatPerSample(TIFF* tif, uint32* ndir, TIFFDirEntry* dir, uint16 tag, double value)\n', 'id': 18, 'location': '/data/vulnloc/libtiff/CVE-2017-7600/src/libtiff/tif_dirwrite.c:993:10'}, {'diff': '@@ -939,6 +939,7 @@\n \treturn(0);\n }\n \n+\n static int\n TIFFWriteDirectoryTagSampleformatArray(TIFF* tif, uint32* ndir, TIFFDirEntry* dir, uint16 tag, uint32 count, double* value)\n {\n@@ -946,7 +947,12 @@\n \tvoid* conv;\n \tuint32 i;\n \tint ok;\n-\tconv = _TIFFmalloc(count*sizeof(double));\n+\t\n+\tif (count == 0) {\n+\t\treturn 0; // Prevent processing when count is zero\n+\t}\n+\t\n+\tconv = _TIFFmalloc(count * sizeof(double));\n \tif (conv == NULL)\n \t{\n \t\tTIFFErrorExt(tif->tif_clientdata, module, "Out of memory");\n@@ -956,55 +962,55 @@\n \tswitch (tif->tif_dir.td_sampleformat)\n \t{\n \t\tcase SAMPLEFORMAT_IEEEFP:\n-\t\t\tif (tif->tif_dir.td_bitspersample<=32)\n+\t\t\tif (tif->tif_dir.td_bitspersample <= 32)\n \t\t\t{\n \t\t\t\tfor (i = 0; i < count; ++i)\n \t\t\t\t\t((float*)conv)[i] = (float)value[i];\n-\t\t\t\tok = TIFFWriteDirectoryTagFloatArray(tif,ndir,dir,tag,count,(float*)conv);\n+\t\t\t\tok = TIFFWriteDirectoryTagFloatArray(tif, ndir, dir, tag, count, (float*)conv);\n \t\t\t}\n \t\t\telse\n \t\t\t{\n-\t\t\t\tok = TIFFWriteDirectoryTagDoubleArray(tif,ndir,dir,tag,count,value);\n+\t\t\t\tok = TIFFWriteDirectoryTagDoubleArray(tif, ndir, dir, tag, count, value);\n \t\t\t}\n \t\t\tbreak;\n \t\tcase SAMPLEFORMAT_INT:\n-\t\t\tif (tif->tif_dir.td_bitspersample<=8)\n+\t\t\tif (tif->tif_dir.td_bitspersample <= 8)\n \t\t\t{\n \t\t\t\tfor (i = 0; i < count; ++i)\n \t\t\t\t\t((int8*)conv)[i] = (int8)value[i];\n-\t\t\t\tok = TIFFWriteDirectoryTagSbyteArray(tif,ndir,dir,tag,count,(int8*)conv);\n+\t\t\t\tok = TIFFWriteDirectoryTagSbyteArray(tif, ndir, dir, tag, count, (int8*)conv);\n \t\t\t}\n-\t\t\telse if (tif->tif_dir.td_bitspersample<=16)\n+\t\t\telse if (tif->tif_dir.td_bitspersample <= 16)\n \t\t\t{\n \t\t\t\tfor (i = 0; i < count; ++i)\n \t\t\t\t\t((int16*)conv)[i] = (int16)value[i];\n-\t\t\t\tok = TIFFWriteDirectoryTagSshortArray(tif,ndir,dir,tag,count,(int16*)conv);\n+\t\t\t\tok = TIFFWriteDirectoryTagSshortArray(tif, ndir, dir, tag, count, (int16*)conv);\n \t\t\t}\n \t\t\telse\n \t\t\t{\n \t\t\t\tfor (i = 0; i < count; ++i)\n \t\t\t\t\t((int32*)conv)[i] = (int32)value[i];\n-\t\t\t\tok = TIFFWriteDirectoryTagSlongArray(tif,ndir,dir,tag,count,(int32*)conv);\n+\t\t\t\tok = TIFFWriteDirectoryTagSlongArray(tif, ndir, dir, tag, count, (int32*)conv);\n \t\t\t}\n \t\t\tbreak;\n \t\tcase SAMPLEFORMAT_UINT:\n-\t\t\tif (tif->tif_dir.td_bitspersample<=8)\n+\t\t\tif (tif->tif_dir.td_bitspersample <= 8)\n \t\t\t{\n \t\t\t\tfor (i = 0; i < count; ++i)\n \t\t\t\t\t((uint8*)conv)[i] = (uint8)value[i];\n-\t\t\t\tok = TIFFWriteDirectoryTagByteArray(tif,ndir,dir,tag,count,(uint8*)conv);\n+\t\t\t\tok = TIFFWriteDirectoryTagByteArray(tif, ndir, dir, tag, count, (uint8*)conv);\n \t\t\t}\n-\t\t\telse if (tif->tif_dir.td_bitspersample<=16)\n+\t\t\telse if (tif->tif_dir.td_bitspersample <= 16)\n \t\t\t{\n \t\t\t\tfor (i = 0; i < count; ++i)\n \t\t\t\t\t((uint16*)conv)[i] = (uint16)value[i];\n-\t\t\t\tok = TIFFWriteDirectoryTagShortArray(tif,ndir,dir,tag,count,(uint16*)conv);\n+\t\t\t\tok = TIFFWriteDirectoryTagShortArray(tif, ndir, dir, tag, count, (uint16*)conv);\n \t\t\t}\n \t\t\telse\n \t\t\t{\n \t\t\t\tfor (i = 0; i < count; ++i)\n \t\t\t\t\t((uint32*)conv)[i] = (uint32)value[i];\n-\t\t\t\tok = TIFFWriteDirectoryTagLongArray(tif,ndir,dir,tag,count,(uint32*)conv);\n+\t\t\t\tok = TIFFWriteDirectoryTagLongArray(tif, ndir, dir, tag, count, (uint32*)conv);\n \t\t\t}\n \t\t\tbreak;\n \t\tdefault:\n@@ -1015,6 +1021,7 @@\n \treturn (ok);\n }\n \n+\n #if 0\n static int\n TIFFWriteDirectoryTagSampleformatPerSample(TIFF* tif, uint32* ndir, TIFFDirEntry* dir, uint16 tag, double value)\n', 'id': 19, 'location': '/data/vulnloc/libtiff/CVE-2017-7600/src/libtiff/tif_dirwrite.c:993:10'}, {'diff': '@@ -939,6 +939,7 @@\n \treturn(0);\n }\n \n+\n static int\n TIFFWriteDirectoryTagSampleformatArray(TIFF* tif, uint32* ndir, TIFFDirEntry* dir, uint16 tag, uint32 count, double* value)\n {\n@@ -953,6 +954,12 @@\n \t\treturn (0);\n \t}\n \n+\tif (tif->tif_dir.td_bitspersample == 0) {\n+\t\t_TIFFfree(conv);\n+\t\tTIFFErrorExt(tif->tif_clientdata, module, "Invalid bits per sample");\n+\t\treturn (0);\n+\t}\n+\n \tswitch (tif->tif_dir.td_sampleformat)\n \t{\n \t\tcase SAMPLEFORMAT_IEEEFP:\n@@ -1015,6 +1022,7 @@\n \treturn (ok);\n }\n \n+\n #if 0\n static int\n TIFFWriteDirectoryTagSampleformatPerSample(TIFF* tif, uint32* ndir, TIFFDirEntry* dir, uint16 tag, double value)\n', 'id': 20, 'location': '/data/vulnloc/libtiff/CVE-2017-7600/src/libtiff/tif_dirwrite.c:991:4'}, {'diff': '@@ -939,6 +939,7 @@\n \treturn(0);\n }\n \n+\n static int\n TIFFWriteDirectoryTagSampleformatArray(TIFF* tif, uint32* ndir, TIFFDirEntry* dir, uint16 tag, uint32 count, double* value)\n {\n@@ -946,65 +947,71 @@\n \tvoid* conv;\n \tuint32 i;\n \tint ok;\n-\tconv = _TIFFmalloc(count*sizeof(double));\n+\tconv = _TIFFmalloc(count * sizeof(double));\n \tif (conv == NULL)\n \t{\n \t\tTIFFErrorExt(tif->tif_clientdata, module, "Out of memory");\n \t\treturn (0);\n \t}\n \n+\tif (count == 0) // Added check for count being zero\n+\t{\n+\t\t_TIFFfree(conv);\n+\t\treturn (0); // Return early if there are no elements to process\n+\t}\n+\n \tswitch (tif->tif_dir.td_sampleformat)\n \t{\n \t\tcase SAMPLEFORMAT_IEEEFP:\n-\t\t\tif (tif->tif_dir.td_bitspersample<=32)\n+\t\t\tif (tif->tif_dir.td_bitspersample <= 32)\n \t\t\t{\n \t\t\t\tfor (i = 0; i < count; ++i)\n \t\t\t\t\t((float*)conv)[i] = (float)value[i];\n-\t\t\t\tok = TIFFWriteDirectoryTagFloatArray(tif,ndir,dir,tag,count,(float*)conv);\n+\t\t\t\tok = TIFFWriteDirectoryTagFloatArray(tif, ndir, dir, tag, count, (float*)conv);\n \t\t\t}\n \t\t\telse\n \t\t\t{\n-\t\t\t\tok = TIFFWriteDirectoryTagDoubleArray(tif,ndir,dir,tag,count,value);\n+\t\t\t\tok = TIFFWriteDirectoryTagDoubleArray(tif, ndir, dir, tag, count, value);\n \t\t\t}\n \t\t\tbreak;\n \t\tcase SAMPLEFORMAT_INT:\n-\t\t\tif (tif->tif_dir.td_bitspersample<=8)\n+\t\t\tif (tif->tif_dir.td_bitspersample <= 8)\n \t\t\t{\n \t\t\t\tfor (i = 0; i < count; ++i)\n \t\t\t\t\t((int8*)conv)[i] = (int8)value[i];\n-\t\t\t\tok = TIFFWriteDirectoryTagSbyteArray(tif,ndir,dir,tag,count,(int8*)conv);\n+\t\t\t\tok = TIFFWriteDirectoryTagSbyteArray(tif, ndir, dir, tag, count, (int8*)conv);\n \t\t\t}\n-\t\t\telse if (tif->tif_dir.td_bitspersample<=16)\n+\t\t\telse if (tif->tif_dir.td_bitspersample <= 16)\n \t\t\t{\n \t\t\t\tfor (i = 0; i < count; ++i)\n \t\t\t\t\t((int16*)conv)[i] = (int16)value[i];\n-\t\t\t\tok = TIFFWriteDirectoryTagSshortArray(tif,ndir,dir,tag,count,(int16*)conv);\n+\t\t\t\tok = TIFFWriteDirectoryTagSshortArray(tif, ndir, dir, tag, count, (int16*)conv);\n \t\t\t}\n \t\t\telse\n \t\t\t{\n \t\t\t\tfor (i = 0; i < count; ++i)\n \t\t\t\t\t((int32*)conv)[i] = (int32)value[i];\n-\t\t\t\tok = TIFFWriteDirectoryTagSlongArray(tif,ndir,dir,tag,count,(int32*)conv);\n+\t\t\t\tok = TIFFWriteDirectoryTagSlongArray(tif, ndir, dir, tag, count, (int32*)conv);\n \t\t\t}\n \t\t\tbreak;\n \t\tcase SAMPLEFORMAT_UINT:\n-\t\t\tif (tif->tif_dir.td_bitspersample<=8)\n+\t\t\tif (tif->tif_dir.td_bitspersample <= 8)\n \t\t\t{\n \t\t\t\tfor (i = 0; i < count; ++i)\n \t\t\t\t\t((uint8*)conv)[i] = (uint8)value[i];\n-\t\t\t\tok = TIFFWriteDirectoryTagByteArray(tif,ndir,dir,tag,count,(uint8*)conv);\n+\t\t\t\tok = TIFFWriteDirectoryTagByteArray(tif, ndir, dir, tag, count, (uint8*)conv);\n \t\t\t}\n-\t\t\telse if (tif->tif_dir.td_bitspersample<=16)\n+\t\t\telse if (tif->tif_dir.td_bitspersample <= 16)\n \t\t\t{\n \t\t\t\tfor (i = 0; i < count; ++i)\n \t\t\t\t\t((uint16*)conv)[i] = (uint16)value[i];\n-\t\t\t\tok = TIFFWriteDirectoryTagShortArray(tif,ndir,dir,tag,count,(uint16*)conv);\n+\t\t\t\tok = TIFFWriteDirectoryTagShortArray(tif, ndir, dir, tag, count, (uint16*)conv);\n \t\t\t}\n \t\t\telse\n \t\t\t{\n \t\t\t\tfor (i = 0; i < count; ++i)\n \t\t\t\t\t((uint32*)conv)[i] = (uint32)value[i];\n-\t\t\t\tok = TIFFWriteDirectoryTagLongArray(tif,ndir,dir,tag,count,(uint32*)conv);\n+\t\t\t\tok = TIFFWriteDirectoryTagLongArray(tif, ndir, dir, tag, count, (uint32*)conv);\n \t\t\t}\n \t\t\tbreak;\n \t\tdefault:\n@@ -1015,6 +1022,7 @@\n \treturn (ok);\n }\n \n+\n #if 0\n static int\n TIFFWriteDirectoryTagSampleformatPerSample(TIFF* tif, uint32* ndir, TIFFDirEntry* dir, uint16 tag, double value)\n', 'id': 21, 'location': '/data/vulnloc/libtiff/CVE-2017-7600/src/libtiff/tif_dirwrite.c:991:4'}, {'diff': '@@ -939,6 +939,7 @@\n \treturn(0);\n }\n \n+\n static int\n TIFFWriteDirectoryTagSampleformatArray(TIFF* tif, uint32* ndir, TIFFDirEntry* dir, uint16 tag, uint32 count, double* value)\n {\n@@ -953,58 +954,65 @@\n \t\treturn (0);\n \t}\n \n+\tif (tif->tif_dir.td_bitspersample < 1) // Modified condition to ensure td_bitspersample is valid\n+\t{\n+\t\tTIFFErrorExt(tif->tif_clientdata, module, "Invalid bits per sample");\n+\t\t_TIFFfree(conv);\n+\t\treturn (0);\n+\t}\n+\n \tswitch (tif->tif_dir.td_sampleformat)\n \t{\n \t\tcase SAMPLEFORMAT_IEEEFP:\n-\t\t\tif (tif->tif_dir.td_bitspersample<=32)\n+\t\t\tif (tif->tif_dir.td_bitspersample <= 32)\n \t\t\t{\n \t\t\t\tfor (i = 0; i < count; ++i)\n \t\t\t\t\t((float*)conv)[i] = (float)value[i];\n-\t\t\t\tok = TIFFWriteDirectoryTagFloatArray(tif,ndir,dir,tag,count,(float*)conv);\n+\t\t\t\tok = TIFFWriteDirectoryTagFloatArray(tif, ndir, dir, tag, count, (float*)conv);\n \t\t\t}\n \t\t\telse\n \t\t\t{\n-\t\t\t\tok = TIFFWriteDirectoryTagDoubleArray(tif,ndir,dir,tag,count,value);\n+\t\t\t\tok = TIFFWriteDirectoryTagDoubleArray(tif, ndir, dir, tag, count, value);\n \t\t\t}\n \t\t\tbreak;\n \t\tcase SAMPLEFORMAT_INT:\n-\t\t\tif (tif->tif_dir.td_bitspersample<=8)\n+\t\t\tif (tif->tif_dir.td_bitspersample <= 8)\n \t\t\t{\n \t\t\t\tfor (i = 0; i < count; ++i)\n \t\t\t\t\t((int8*)conv)[i] = (int8)value[i];\n-\t\t\t\tok = TIFFWriteDirectoryTagSbyteArray(tif,ndir,dir,tag,count,(int8*)conv);\n+\t\t\t\tok = TIFFWriteDirectoryTagSbyteArray(tif, ndir, dir, tag, count, (int8*)conv);\n \t\t\t}\n-\t\t\telse if (tif->tif_dir.td_bitspersample<=16)\n+\t\t\telse if (tif->tif_dir.td_bitspersample <= 16)\n \t\t\t{\n \t\t\t\tfor (i = 0; i < count; ++i)\n \t\t\t\t\t((int16*)conv)[i] = (int16)value[i];\n-\t\t\t\tok = TIFFWriteDirectoryTagSshortArray(tif,ndir,dir,tag,count,(int16*)conv);\n+\t\t\t\tok = TIFFWriteDirectoryTagSshortArray(tif, ndir, dir, tag, count, (int16*)conv);\n \t\t\t}\n \t\t\telse\n \t\t\t{\n \t\t\t\tfor (i = 0; i < count; ++i)\n \t\t\t\t\t((int32*)conv)[i] = (int32)value[i];\n-\t\t\t\tok = TIFFWriteDirectoryTagSlongArray(tif,ndir,dir,tag,count,(int32*)conv);\n+\t\t\t\tok = TIFFWriteDirectoryTagSlongArray(tif, ndir, dir, tag, count, (int32*)conv);\n \t\t\t}\n \t\t\tbreak;\n \t\tcase SAMPLEFORMAT_UINT:\n-\t\t\tif (tif->tif_dir.td_bitspersample<=8)\n+\t\t\tif (tif->tif_dir.td_bitspersample <= 8)\n \t\t\t{\n \t\t\t\tfor (i = 0; i < count; ++i)\n \t\t\t\t\t((uint8*)conv)[i] = (uint8)value[i];\n-\t\t\t\tok = TIFFWriteDirectoryTagByteArray(tif,ndir,dir,tag,count,(uint8*)conv);\n+\t\t\t\tok = TIFFWriteDirectoryTagByteArray(tif, ndir, dir, tag, count, (uint8*)conv);\n \t\t\t}\n-\t\t\telse if (tif->tif_dir.td_bitspersample<=16)\n+\t\t\telse if (tif->tif_dir.td_bitspersample <= 16)\n \t\t\t{\n \t\t\t\tfor (i = 0; i < count; ++i)\n \t\t\t\t\t((uint16*)conv)[i] = (uint16)value[i];\n-\t\t\t\tok = TIFFWriteDirectoryTagShortArray(tif,ndir,dir,tag,count,(uint16*)conv);\n+\t\t\t\tok = TIFFWriteDirectoryTagShortArray(tif, ndir, dir, tag, count, (uint16*)conv);\n \t\t\t}\n \t\t\telse\n \t\t\t{\n \t\t\t\tfor (i = 0; i < count; ++i)\n \t\t\t\t\t((uint32*)conv)[i] = (uint32)value[i];\n-\t\t\t\tok = TIFFWriteDirectoryTagLongArray(tif,ndir,dir,tag,count,(uint32*)conv);\n+\t\t\t\tok = TIFFWriteDirectoryTagLongArray(tif, ndir, dir, tag, count, (uint32*)conv);\n \t\t\t}\n \t\t\tbreak;\n \t\tdefault:\n@@ -1015,6 +1023,7 @@\n \treturn (ok);\n }\n \n+\n #if 0\n static int\n TIFFWriteDirectoryTagSampleformatPerSample(TIFF* tif, uint32* ndir, TIFFDirEntry* dir, uint16 tag, double value)\n', 'id': 22, 'location': '/data/vulnloc/libtiff/CVE-2017-7600/src/libtiff/tif_dirwrite.c:991:4'}, {'diff': '@@ -939,6 +939,7 @@\n \treturn(0);\n }\n \n+\n static int\n TIFFWriteDirectoryTagSampleformatArray(TIFF* tif, uint32* ndir, TIFFDirEntry* dir, uint16 tag, uint32 count, double* value)\n {\n@@ -956,7 +957,12 @@\n \tswitch (tif->tif_dir.td_sampleformat)\n \t{\n \t\tcase SAMPLEFORMAT_IEEEFP:\n-\t\t\tif (tif->tif_dir.td_bitspersample<=32)\n+\t\t\tif (tif->tif_dir.td_bitspersample < 1 || tif->tif_dir.td_bitspersample > 64) // Added check for valid bitspersample range\n+\t\t\t{\n+\t\t\t\tok = 0; // Return an error if bitspersample is out of range\n+\t\t\t\tbreak;\n+\t\t\t}\n+\t\t\tif (tif->tif_dir.td_bitspersample <= 32)\n \t\t\t{\n \t\t\t\tfor (i = 0; i < count; ++i)\n \t\t\t\t\t((float*)conv)[i] = (float)value[i];\n@@ -968,13 +974,18 @@\n \t\t\t}\n \t\t\tbreak;\n \t\tcase SAMPLEFORMAT_INT:\n-\t\t\tif (tif->tif_dir.td_bitspersample<=8)\n+\t\t\tif (tif->tif_dir.td_bitspersample < 1 || tif->tif_dir.td_bitspersample > 32) // Added check for valid bitspersample range\n+\t\t\t{\n+\t\t\t\tok = 0; // Return an error if bitspersample is out of range\n+\t\t\t\tbreak;\n+\t\t\t}\n+\t\t\tif (tif->tif_dir.td_bitspersample <= 8)\n \t\t\t{\n \t\t\t\tfor (i = 0; i < count; ++i)\n \t\t\t\t\t((int8*)conv)[i] = (int8)value[i];\n \t\t\t\tok = TIFFWriteDirectoryTagSbyteArray(tif,ndir,dir,tag,count,(int8*)conv);\n \t\t\t}\n-\t\t\telse if (tif->tif_dir.td_bitspersample<=16)\n+\t\t\telse if (tif->tif_dir.td_bitspersample <= 16)\n \t\t\t{\n \t\t\t\tfor (i = 0; i < count; ++i)\n \t\t\t\t\t((int16*)conv)[i] = (int16)value[i];\n@@ -988,13 +999,18 @@\n \t\t\t}\n \t\t\tbreak;\n \t\tcase SAMPLEFORMAT_UINT:\n-\t\t\tif (tif->tif_dir.td_bitspersample<=8)\n+\t\t\tif (tif->tif_dir.td_bitspersample < 1 || tif->tif_dir.td_bitspersample > 32) // Added check for valid bitspersample range\n+\t\t\t{\n+\t\t\t\tok = 0; // Return an error if bitspersample is out of range\n+\t\t\t\tbreak;\n+\t\t\t}\n+\t\t\tif (tif->tif_dir.td_bitspersample <= 8)\n \t\t\t{\n \t\t\t\tfor (i = 0; i < count; ++i)\n \t\t\t\t\t((uint8*)conv)[i] = (uint8)value[i];\n \t\t\t\tok = TIFFWriteDirectoryTagByteArray(tif,ndir,dir,tag,count,(uint8*)conv);\n \t\t\t}\n-\t\t\telse if (tif->tif_dir.td_bitspersample<=16)\n+\t\t\telse if (tif->tif_dir.td_bitspersample <= 16)\n \t\t\t{\n \t\t\t\tfor (i = 0; i < count; ++i)\n \t\t\t\t\t((uint16*)conv)[i] = (uint16)value[i];\n@@ -1015,6 +1031,7 @@\n \treturn (ok);\n }\n \n+\n #if 0\n static int\n TIFFWriteDirectoryTagSampleformatPerSample(TIFF* tif, uint32* ndir, TIFFDirEntry* dir, uint16 tag, double value)\n', 'id': 23, 'location': '/data/vulnloc/libtiff/CVE-2017-7600/src/libtiff/tif_dirwrite.c:991:4'}, {'diff': '@@ -939,6 +939,7 @@\n \treturn(0);\n }\n \n+\n static int\n TIFFWriteDirectoryTagSampleformatArray(TIFF* tif, uint32* ndir, TIFFDirEntry* dir, uint16 tag, uint32 count, double* value)\n {\n@@ -953,58 +954,63 @@\n \t\treturn (0);\n \t}\n \n+\tif (count == 0) { // Add check for zero count\n+\t\t_TIFFfree(conv);\n+\t\treturn 0; // Early exit if count is 0\n+\t}\n+\n \tswitch (tif->tif_dir.td_sampleformat)\n \t{\n \t\tcase SAMPLEFORMAT_IEEEFP:\n-\t\t\tif (tif->tif_dir.td_bitspersample<=32)\n+\t\t\tif (tif->tif_dir.td_bitspersample <= 32)\n \t\t\t{\n \t\t\t\tfor (i = 0; i < count; ++i)\n \t\t\t\t\t((float*)conv)[i] = (float)value[i];\n-\t\t\t\tok = TIFFWriteDirectoryTagFloatArray(tif,ndir,dir,tag,count,(float*)conv);\n+\t\t\t\tok = TIFFWriteDirectoryTagFloatArray(tif, ndir, dir, tag, count, (float*)conv);\n \t\t\t}\n \t\t\telse\n \t\t\t{\n-\t\t\t\tok = TIFFWriteDirectoryTagDoubleArray(tif,ndir,dir,tag,count,value);\n+\t\t\t\tok = TIFFWriteDirectoryTagDoubleArray(tif, ndir, dir, tag, count, value);\n \t\t\t}\n \t\t\tbreak;\n \t\tcase SAMPLEFORMAT_INT:\n-\t\t\tif (tif->tif_dir.td_bitspersample<=8)\n+\t\t\tif (tif->tif_dir.td_bitspersample <= 8)\n \t\t\t{\n \t\t\t\tfor (i = 0; i < count; ++i)\n \t\t\t\t\t((int8*)conv)[i] = (int8)value[i];\n-\t\t\t\tok = TIFFWriteDirectoryTagSbyteArray(tif,ndir,dir,tag,count,(int8*)conv);\n+\t\t\t\tok = TIFFWriteDirectoryTagSbyteArray(tif, ndir, dir, tag, count, (int8*)conv);\n \t\t\t}\n-\t\t\telse if (tif->tif_dir.td_bitspersample<=16)\n+\t\t\telse if (tif->tif_dir.td_bitspersample <= 16)\n \t\t\t{\n \t\t\t\tfor (i = 0; i < count; ++i)\n \t\t\t\t\t((int16*)conv)[i] = (int16)value[i];\n-\t\t\t\tok = TIFFWriteDirectoryTagSshortArray(tif,ndir,dir,tag,count,(int16*)conv);\n+\t\t\t\tok = TIFFWriteDirectoryTagSshortArray(tif, ndir, dir, tag, count, (int16*)conv);\n \t\t\t}\n \t\t\telse\n \t\t\t{\n \t\t\t\tfor (i = 0; i < count; ++i)\n \t\t\t\t\t((int32*)conv)[i] = (int32)value[i];\n-\t\t\t\tok = TIFFWriteDirectoryTagSlongArray(tif,ndir,dir,tag,count,(int32*)conv);\n+\t\t\t\tok = TIFFWriteDirectoryTagSlongArray(tif, ndir, dir, tag, count, (int32*)conv);\n \t\t\t}\n \t\t\tbreak;\n \t\tcase SAMPLEFORMAT_UINT:\n-\t\t\tif (tif->tif_dir.td_bitspersample<=8)\n+\t\t\tif (tif->tif_dir.td_bitspersample <= 8)\n \t\t\t{\n \t\t\t\tfor (i = 0; i < count; ++i)\n \t\t\t\t\t((uint8*)conv)[i] = (uint8)value[i];\n-\t\t\t\tok = TIFFWriteDirectoryTagByteArray(tif,ndir,dir,tag,count,(uint8*)conv);\n+\t\t\t\tok = TIFFWriteDirectoryTagByteArray(tif, ndir, dir, tag, count, (uint8*)conv);\n \t\t\t}\n-\t\t\telse if (tif->tif_dir.td_bitspersample<=16)\n+\t\t\telse if (tif->tif_dir.td_bitspersample <= 16)\n \t\t\t{\n \t\t\t\tfor (i = 0; i < count; ++i)\n \t\t\t\t\t((uint16*)conv)[i] = (uint16)value[i];\n-\t\t\t\tok = TIFFWriteDirectoryTagShortArray(tif,ndir,dir,tag,count,(uint16*)conv);\n+\t\t\t\tok = TIFFWriteDirectoryTagShortArray(tif, ndir, dir, tag, count, (uint16*)conv);\n \t\t\t}\n \t\t\telse\n \t\t\t{\n \t\t\t\tfor (i = 0; i < count; ++i)\n \t\t\t\t\t((uint32*)conv)[i] = (uint32)value[i];\n-\t\t\t\tok = TIFFWriteDirectoryTagLongArray(tif,ndir,dir,tag,count,(uint32*)conv);\n+\t\t\t\tok = TIFFWriteDirectoryTagLongArray(tif, ndir, dir, tag, count, (uint32*)conv);\n \t\t\t}\n \t\t\tbreak;\n \t\tdefault:\n@@ -1015,6 +1021,7 @@\n \treturn (ok);\n }\n \n+\n #if 0\n static int\n TIFFWriteDirectoryTagSampleformatPerSample(TIFF* tif, uint32* ndir, TIFFDirEntry* dir, uint16 tag, double value)\n', 'id': 24, 'location': '/data/vulnloc/libtiff/CVE-2017-7600/src/libtiff/tif_dirwrite.c:991:4'}, {'diff': '@@ -939,6 +939,7 @@\n \treturn(0);\n }\n \n+\n static int\n TIFFWriteDirectoryTagSampleformatArray(TIFF* tif, uint32* ndir, TIFFDirEntry* dir, uint16 tag, uint32 count, double* value)\n {\n@@ -953,58 +954,67 @@\n \t\treturn (0);\n \t}\n \n+\tif (tif->tif_dir.td_sampleformat != SAMPLEFORMAT_IEEEFP && \n+\t    tif->tif_dir.td_sampleformat != SAMPLEFORMAT_INT &&\n+\t    tif->tif_dir.td_sampleformat != SAMPLEFORMAT_UINT) \n+\t{\n+\t\tTIFFErrorExt(tif->tif_clientdata, module, "Unsupported sample format");\n+\t\t_TIFFfree(conv);\n+\t\treturn (0);\n+\t}\n+\n \tswitch (tif->tif_dir.td_sampleformat)\n \t{\n \t\tcase SAMPLEFORMAT_IEEEFP:\n-\t\t\tif (tif->tif_dir.td_bitspersample<=32)\n+\t\t\tif (tif->tif_dir.td_bitspersample <= 32)\n \t\t\t{\n \t\t\t\tfor (i = 0; i < count; ++i)\n \t\t\t\t\t((float*)conv)[i] = (float)value[i];\n-\t\t\t\tok = TIFFWriteDirectoryTagFloatArray(tif,ndir,dir,tag,count,(float*)conv);\n+\t\t\t\tok = TIFFWriteDirectoryTagFloatArray(tif, ndir, dir, tag, count, (float*)conv);\n \t\t\t}\n \t\t\telse\n \t\t\t{\n-\t\t\t\tok = TIFFWriteDirectoryTagDoubleArray(tif,ndir,dir,tag,count,value);\n+\t\t\t\tok = TIFFWriteDirectoryTagDoubleArray(tif, ndir, dir, tag, count, value);\n \t\t\t}\n \t\t\tbreak;\n \t\tcase SAMPLEFORMAT_INT:\n-\t\t\tif (tif->tif_dir.td_bitspersample<=8)\n+\t\t\tif (tif->tif_dir.td_bitspersample <= 8)\n \t\t\t{\n \t\t\t\tfor (i = 0; i < count; ++i)\n \t\t\t\t\t((int8*)conv)[i] = (int8)value[i];\n-\t\t\t\tok = TIFFWriteDirectoryTagSbyteArray(tif,ndir,dir,tag,count,(int8*)conv);\n+\t\t\t\tok = TIFFWriteDirectoryTagSbyteArray(tif, ndir, dir, tag, count, (int8*)conv);\n \t\t\t}\n-\t\t\telse if (tif->tif_dir.td_bitspersample<=16)\n+\t\t\telse if (tif->tif_dir.td_bitspersample <= 16)\n \t\t\t{\n \t\t\t\tfor (i = 0; i < count; ++i)\n \t\t\t\t\t((int16*)conv)[i] = (int16)value[i];\n-\t\t\t\tok = TIFFWriteDirectoryTagSshortArray(tif,ndir,dir,tag,count,(int16*)conv);\n+\t\t\t\tok = TIFFWriteDirectoryTagSshortArray(tif, ndir, dir, tag, count, (int16*)conv);\n \t\t\t}\n \t\t\telse\n \t\t\t{\n \t\t\t\tfor (i = 0; i < count; ++i)\n \t\t\t\t\t((int32*)conv)[i] = (int32)value[i];\n-\t\t\t\tok = TIFFWriteDirectoryTagSlongArray(tif,ndir,dir,tag,count,(int32*)conv);\n+\t\t\t\tok = TIFFWriteDirectoryTagSlongArray(tif, ndir, dir, tag, count, (int32*)conv);\n \t\t\t}\n \t\t\tbreak;\n \t\tcase SAMPLEFORMAT_UINT:\n-\t\t\tif (tif->tif_dir.td_bitspersample<=8)\n+\t\t\tif (tif->tif_dir.td_bitspersample <= 8)\n \t\t\t{\n \t\t\t\tfor (i = 0; i < count; ++i)\n \t\t\t\t\t((uint8*)conv)[i] = (uint8)value[i];\n-\t\t\t\tok = TIFFWriteDirectoryTagByteArray(tif,ndir,dir,tag,count,(uint8*)conv);\n+\t\t\t\tok = TIFFWriteDirectoryTagByteArray(tif, ndir, dir, tag, count, (uint8*)conv);\n \t\t\t}\n-\t\t\telse if (tif->tif_dir.td_bitspersample<=16)\n+\t\t\telse if (tif->tif_dir.td_bitspersample <= 16)\n \t\t\t{\n \t\t\t\tfor (i = 0; i < count; ++i)\n \t\t\t\t\t((uint16*)conv)[i] = (uint16)value[i];\n-\t\t\t\tok = TIFFWriteDirectoryTagShortArray(tif,ndir,dir,tag,count,(uint16*)conv);\n+\t\t\t\tok = TIFFWriteDirectoryTagShortArray(tif, ndir, dir, tag, count, (uint16*)conv);\n \t\t\t}\n \t\t\telse\n \t\t\t{\n \t\t\t\tfor (i = 0; i < count; ++i)\n \t\t\t\t\t((uint32*)conv)[i] = (uint32)value[i];\n-\t\t\t\tok = TIFFWriteDirectoryTagLongArray(tif,ndir,dir,tag,count,(uint32*)conv);\n+\t\t\t\tok = TIFFWriteDirectoryTagLongArray(tif, ndir, dir, tag, count, (uint32*)conv);\n \t\t\t}\n \t\t\tbreak;\n \t\tdefault:\n@@ -1015,6 +1025,7 @@\n \treturn (ok);\n }\n \n+\n #if 0\n static int\n TIFFWriteDirectoryTagSampleformatPerSample(TIFF* tif, uint32* ndir, TIFFDirEntry* dir, uint16 tag, double value)\n', 'id': 25, 'location': '/data/vulnloc/libtiff/CVE-2017-7600/src/libtiff/tif_dirwrite.c:956:2'}, {'diff': '@@ -939,6 +939,7 @@\n \treturn(0);\n }\n \n+\n static int\n TIFFWriteDirectoryTagSampleformatArray(TIFF* tif, uint32* ndir, TIFFDirEntry* dir, uint16 tag, uint32 count, double* value)\n {\n@@ -946,7 +947,11 @@\n \tvoid* conv;\n \tuint32 i;\n \tint ok;\n-\tconv = _TIFFmalloc(count*sizeof(double));\n+\tif (tif == NULL || value == NULL || count == 0) {\n+\t\tTIFFErrorExt(tif ? tif->tif_clientdata : 0, module, "Invalid input parameters");\n+\t\treturn (0);\n+\t}\n+\tconv = _TIFFmalloc(count * sizeof(double));\n \tif (conv == NULL)\n \t{\n \t\tTIFFErrorExt(tif->tif_clientdata, module, "Out of memory");\n@@ -956,55 +961,55 @@\n \tswitch (tif->tif_dir.td_sampleformat)\n \t{\n \t\tcase SAMPLEFORMAT_IEEEFP:\n-\t\t\tif (tif->tif_dir.td_bitspersample<=32)\n+\t\t\tif (tif->tif_dir.td_bitspersample <= 32)\n \t\t\t{\n \t\t\t\tfor (i = 0; i < count; ++i)\n \t\t\t\t\t((float*)conv)[i] = (float)value[i];\n-\t\t\t\tok = TIFFWriteDirectoryTagFloatArray(tif,ndir,dir,tag,count,(float*)conv);\n+\t\t\t\tok = TIFFWriteDirectoryTagFloatArray(tif, ndir, dir, tag, count, (float*)conv);\n \t\t\t}\n \t\t\telse\n \t\t\t{\n-\t\t\t\tok = TIFFWriteDirectoryTagDoubleArray(tif,ndir,dir,tag,count,value);\n+\t\t\t\tok = TIFFWriteDirectoryTagDoubleArray(tif, ndir, dir, tag, count, value);\n \t\t\t}\n \t\t\tbreak;\n \t\tcase SAMPLEFORMAT_INT:\n-\t\t\tif (tif->tif_dir.td_bitspersample<=8)\n+\t\t\tif (tif->tif_dir.td_bitspersample <= 8)\n \t\t\t{\n \t\t\t\tfor (i = 0; i < count; ++i)\n \t\t\t\t\t((int8*)conv)[i] = (int8)value[i];\n-\t\t\t\tok = TIFFWriteDirectoryTagSbyteArray(tif,ndir,dir,tag,count,(int8*)conv);\n+\t\t\t\tok = TIFFWriteDirectoryTagSbyteArray(tif, ndir, dir, tag, count, (int8*)conv);\n \t\t\t}\n-\t\t\telse if (tif->tif_dir.td_bitspersample<=16)\n+\t\t\telse if (tif->tif_dir.td_bitspersample <= 16)\n \t\t\t{\n \t\t\t\tfor (i = 0; i < count; ++i)\n \t\t\t\t\t((int16*)conv)[i] = (int16)value[i];\n-\t\t\t\tok = TIFFWriteDirectoryTagSshortArray(tif,ndir,dir,tag,count,(int16*)conv);\n+\t\t\t\tok = TIFFWriteDirectoryTagSshortArray(tif, ndir, dir, tag, count, (int16*)conv);\n \t\t\t}\n \t\t\telse\n \t\t\t{\n \t\t\t\tfor (i = 0; i < count; ++i)\n \t\t\t\t\t((int32*)conv)[i] = (int32)value[i];\n-\t\t\t\tok = TIFFWriteDirectoryTagSlongArray(tif,ndir,dir,tag,count,(int32*)conv);\n+\t\t\t\tok = TIFFWriteDirectoryTagSlongArray(tif, ndir, dir, tag, count, (int32*)conv);\n \t\t\t}\n \t\t\tbreak;\n \t\tcase SAMPLEFORMAT_UINT:\n-\t\t\tif (tif->tif_dir.td_bitspersample<=8)\n+\t\t\tif (tif->tif_dir.td_bitspersample <= 8)\n \t\t\t{\n \t\t\t\tfor (i = 0; i < count; ++i)\n \t\t\t\t\t((uint8*)conv)[i] = (uint8)value[i];\n-\t\t\t\tok = TIFFWriteDirectoryTagByteArray(tif,ndir,dir,tag,count,(uint8*)conv);\n+\t\t\t\tok = TIFFWriteDirectoryTagByteArray(tif, ndir, dir, tag, count, (uint8*)conv);\n \t\t\t}\n-\t\t\telse if (tif->tif_dir.td_bitspersample<=16)\n+\t\t\telse if (tif->tif_dir.td_bitspersample <= 16)\n \t\t\t{\n \t\t\t\tfor (i = 0; i < count; ++i)\n \t\t\t\t\t((uint16*)conv)[i] = (uint16)value[i];\n-\t\t\t\tok = TIFFWriteDirectoryTagShortArray(tif,ndir,dir,tag,count,(uint16*)conv);\n+\t\t\t\tok = TIFFWriteDirectoryTagShortArray(tif, ndir, dir, tag, count, (uint16*)conv);\n \t\t\t}\n \t\t\telse\n \t\t\t{\n \t\t\t\tfor (i = 0; i < count; ++i)\n \t\t\t\t\t((uint32*)conv)[i] = (uint32)value[i];\n-\t\t\t\tok = TIFFWriteDirectoryTagLongArray(tif,ndir,dir,tag,count,(uint32*)conv);\n+\t\t\t\tok = TIFFWriteDirectoryTagLongArray(tif, ndir, dir, tag, count, (uint32*)conv);\n \t\t\t}\n \t\t\tbreak;\n \t\tdefault:\n@@ -1015,6 +1020,7 @@\n \treturn (ok);\n }\n \n+\n #if 0\n static int\n TIFFWriteDirectoryTagSampleformatPerSample(TIFF* tif, uint32* ndir, TIFFDirEntry* dir, uint16 tag, double value)\n', 'id': 26, 'location': '/data/vulnloc/libtiff/CVE-2017-7600/src/libtiff/tif_dirwrite.c:956:2'}, {'diff': '@@ -939,6 +939,7 @@\n \treturn(0);\n }\n \n+\n static int\n TIFFWriteDirectoryTagSampleformatArray(TIFF* tif, uint32* ndir, TIFFDirEntry* dir, uint16 tag, uint32 count, double* value)\n {\n@@ -946,7 +947,13 @@\n \tvoid* conv;\n \tuint32 i;\n \tint ok;\n-\tconv = _TIFFmalloc(count*sizeof(double));\n+\n+\tif (tif == NULL || value == NULL || count == 0) {\n+\t\tTIFFErrorExt(tif->tif_clientdata, module, "Invalid arguments");\n+\t\treturn (0);\n+\t}\n+\n+\tconv = _TIFFmalloc(count * sizeof(double));\n \tif (conv == NULL)\n \t{\n \t\tTIFFErrorExt(tif->tif_clientdata, module, "Out of memory");\n@@ -956,55 +963,55 @@\n \tswitch (tif->tif_dir.td_sampleformat)\n \t{\n \t\tcase SAMPLEFORMAT_IEEEFP:\n-\t\t\tif (tif->tif_dir.td_bitspersample<=32)\n+\t\t\tif (tif->tif_dir.td_bitspersample <= 32)\n \t\t\t{\n \t\t\t\tfor (i = 0; i < count; ++i)\n \t\t\t\t\t((float*)conv)[i] = (float)value[i];\n-\t\t\t\tok = TIFFWriteDirectoryTagFloatArray(tif,ndir,dir,tag,count,(float*)conv);\n+\t\t\t\tok = TIFFWriteDirectoryTagFloatArray(tif, ndir, dir, tag, count, (float*)conv);\n \t\t\t}\n \t\t\telse\n \t\t\t{\n-\t\t\t\tok = TIFFWriteDirectoryTagDoubleArray(tif,ndir,dir,tag,count,value);\n+\t\t\t\tok = TIFFWriteDirectoryTagDoubleArray(tif, ndir, dir, tag, count, value);\n \t\t\t}\n \t\t\tbreak;\n \t\tcase SAMPLEFORMAT_INT:\n-\t\t\tif (tif->tif_dir.td_bitspersample<=8)\n+\t\t\tif (tif->tif_dir.td_bitspersample <= 8)\n \t\t\t{\n \t\t\t\tfor (i = 0; i < count; ++i)\n \t\t\t\t\t((int8*)conv)[i] = (int8)value[i];\n-\t\t\t\tok = TIFFWriteDirectoryTagSbyteArray(tif,ndir,dir,tag,count,(int8*)conv);\n+\t\t\t\tok = TIFFWriteDirectoryTagSbyteArray(tif, ndir, dir, tag, count, (int8*)conv);\n \t\t\t}\n-\t\t\telse if (tif->tif_dir.td_bitspersample<=16)\n+\t\t\telse if (tif->tif_dir.td_bitspersample <= 16)\n \t\t\t{\n \t\t\t\tfor (i = 0; i < count; ++i)\n \t\t\t\t\t((int16*)conv)[i] = (int16)value[i];\n-\t\t\t\tok = TIFFWriteDirectoryTagSshortArray(tif,ndir,dir,tag,count,(int16*)conv);\n+\t\t\t\tok = TIFFWriteDirectoryTagSshortArray(tif, ndir, dir, tag, count, (int16*)conv);\n \t\t\t}\n \t\t\telse\n \t\t\t{\n \t\t\t\tfor (i = 0; i < count; ++i)\n \t\t\t\t\t((int32*)conv)[i] = (int32)value[i];\n-\t\t\t\tok = TIFFWriteDirectoryTagSlongArray(tif,ndir,dir,tag,count,(int32*)conv);\n+\t\t\t\tok = TIFFWriteDirectoryTagSlongArray(tif, ndir, dir, tag, count, (int32*)conv);\n \t\t\t}\n \t\t\tbreak;\n \t\tcase SAMPLEFORMAT_UINT:\n-\t\t\tif (tif->tif_dir.td_bitspersample<=8)\n+\t\t\tif (tif->tif_dir.td_bitspersample <= 8)\n \t\t\t{\n \t\t\t\tfor (i = 0; i < count; ++i)\n \t\t\t\t\t((uint8*)conv)[i] = (uint8)value[i];\n-\t\t\t\tok = TIFFWriteDirectoryTagByteArray(tif,ndir,dir,tag,count,(uint8*)conv);\n+\t\t\t\tok = TIFFWriteDirectoryTagByteArray(tif, ndir, dir, tag, count, (uint8*)conv);\n \t\t\t}\n-\t\t\telse if (tif->tif_dir.td_bitspersample<=16)\n+\t\t\telse if (tif->tif_dir.td_bitspersample <= 16)\n \t\t\t{\n \t\t\t\tfor (i = 0; i < count; ++i)\n \t\t\t\t\t((uint16*)conv)[i] = (uint16)value[i];\n-\t\t\t\tok = TIFFWriteDirectoryTagShortArray(tif,ndir,dir,tag,count,(uint16*)conv);\n+\t\t\t\tok = TIFFWriteDirectoryTagShortArray(tif, ndir, dir, tag, count, (uint16*)conv);\n \t\t\t}\n \t\t\telse\n \t\t\t{\n \t\t\t\tfor (i = 0; i < count; ++i)\n \t\t\t\t\t((uint32*)conv)[i] = (uint32)value[i];\n-\t\t\t\tok = TIFFWriteDirectoryTagLongArray(tif,ndir,dir,tag,count,(uint32*)conv);\n+\t\t\t\tok = TIFFWriteDirectoryTagLongArray(tif, ndir, dir, tag, count, (uint32*)conv);\n \t\t\t}\n \t\t\tbreak;\n \t\tdefault:\n@@ -1015,6 +1022,7 @@\n \treturn (ok);\n }\n \n+\n #if 0\n static int\n TIFFWriteDirectoryTagSampleformatPerSample(TIFF* tif, uint32* ndir, TIFFDirEntry* dir, uint16 tag, double value)\n', 'id': 27, 'location': '/data/vulnloc/libtiff/CVE-2017-7600/src/libtiff/tif_dirwrite.c:956:2'}, {'diff': '@@ -939,6 +939,7 @@\n \treturn(0);\n }\n \n+\n static int\n TIFFWriteDirectoryTagSampleformatArray(TIFF* tif, uint32* ndir, TIFFDirEntry* dir, uint16 tag, uint32 count, double* value)\n {\n@@ -952,6 +953,15 @@\n \t\tTIFFErrorExt(tif->tif_clientdata, module, "Out of memory");\n \t\treturn (0);\n \t}\n+    \n+    // Check if the sample format is valid before proceeding\n+    if (tif->tif_dir.td_sampleformat != SAMPLEFORMAT_IEEEFP &&\n+        tif->tif_dir.td_sampleformat != SAMPLEFORMAT_INT &&\n+        tif->tif_dir.td_sampleformat != SAMPLEFORMAT_UINT) {\n+        TIFFErrorExt(tif->tif_clientdata, module, "Invalid sample format");\n+        _TIFFfree(conv);\n+        return (0);\n+    }\n \n \tswitch (tif->tif_dir.td_sampleformat)\n \t{\n@@ -1015,6 +1025,7 @@\n \treturn (ok);\n }\n \n+\n #if 0\n static int\n TIFFWriteDirectoryTagSampleformatPerSample(TIFF* tif, uint32* ndir, TIFFDirEntry* dir, uint16 tag, double value)\n', 'id': 28, 'location': '/data/vulnloc/libtiff/CVE-2017-7600/src/libtiff/tif_dirwrite.c:956:2'}, {'diff': '@@ -939,6 +939,7 @@\n \treturn(0);\n }\n \n+\n static int\n TIFFWriteDirectoryTagSampleformatArray(TIFF* tif, uint32* ndir, TIFFDirEntry* dir, uint16 tag, uint32 count, double* value)\n {\n@@ -946,9 +947,14 @@\n \tvoid* conv;\n \tuint32 i;\n \tint ok;\n-\tconv = _TIFFmalloc(count*sizeof(double));\n-\tif (conv == NULL)\n-\t{\n+\n+\tif (tif == NULL || ndir == NULL || dir == NULL || value == NULL) {\n+\t\tTIFFErrorExt(tif->tif_clientdata, module, "Invalid input parameters");\n+\t\treturn (0);\n+\t}\n+\n+\tconv = _TIFFmalloc(count * sizeof(double));\n+\tif (conv == NULL) {\n \t\tTIFFErrorExt(tif->tif_clientdata, module, "Out of memory");\n \t\treturn (0);\n \t}\n@@ -956,55 +962,55 @@\n \tswitch (tif->tif_dir.td_sampleformat)\n \t{\n \t\tcase SAMPLEFORMAT_IEEEFP:\n-\t\t\tif (tif->tif_dir.td_bitspersample<=32)\n+\t\t\tif (tif->tif_dir.td_bitspersample <= 32)\n \t\t\t{\n \t\t\t\tfor (i = 0; i < count; ++i)\n \t\t\t\t\t((float*)conv)[i] = (float)value[i];\n-\t\t\t\tok = TIFFWriteDirectoryTagFloatArray(tif,ndir,dir,tag,count,(float*)conv);\n+\t\t\t\tok = TIFFWriteDirectoryTagFloatArray(tif, ndir, dir, tag, count, (float*)conv);\n \t\t\t}\n \t\t\telse\n \t\t\t{\n-\t\t\t\tok = TIFFWriteDirectoryTagDoubleArray(tif,ndir,dir,tag,count,value);\n+\t\t\t\tok = TIFFWriteDirectoryTagDoubleArray(tif, ndir, dir, tag, count, value);\n \t\t\t}\n \t\t\tbreak;\n \t\tcase SAMPLEFORMAT_INT:\n-\t\t\tif (tif->tif_dir.td_bitspersample<=8)\n+\t\t\tif (tif->tif_dir.td_bitspersample <= 8)\n \t\t\t{\n \t\t\t\tfor (i = 0; i < count; ++i)\n \t\t\t\t\t((int8*)conv)[i] = (int8)value[i];\n-\t\t\t\tok = TIFFWriteDirectoryTagSbyteArray(tif,ndir,dir,tag,count,(int8*)conv);\n+\t\t\t\tok = TIFFWriteDirectoryTagSbyteArray(tif, ndir, dir, tag, count, (int8*)conv);\n \t\t\t}\n-\t\t\telse if (tif->tif_dir.td_bitspersample<=16)\n+\t\t\telse if (tif->tif_dir.td_bitspersample <= 16)\n \t\t\t{\n \t\t\t\tfor (i = 0; i < count; ++i)\n \t\t\t\t\t((int16*)conv)[i] = (int16)value[i];\n-\t\t\t\tok = TIFFWriteDirectoryTagSshortArray(tif,ndir,dir,tag,count,(int16*)conv);\n+\t\t\t\tok = TIFFWriteDirectoryTagSshortArray(tif, ndir, dir, tag, count, (int16*)conv);\n \t\t\t}\n \t\t\telse\n \t\t\t{\n \t\t\t\tfor (i = 0; i < count; ++i)\n \t\t\t\t\t((int32*)conv)[i] = (int32)value[i];\n-\t\t\t\tok = TIFFWriteDirectoryTagSlongArray(tif,ndir,dir,tag,count,(int32*)conv);\n+\t\t\t\tok = TIFFWriteDirectoryTagSlongArray(tif, ndir, dir, tag, count, (int32*)conv);\n \t\t\t}\n \t\t\tbreak;\n \t\tcase SAMPLEFORMAT_UINT:\n-\t\t\tif (tif->tif_dir.td_bitspersample<=8)\n+\t\t\tif (tif->tif_dir.td_bitspersample <= 8)\n \t\t\t{\n \t\t\t\tfor (i = 0; i < count; ++i)\n \t\t\t\t\t((uint8*)conv)[i] = (uint8)value[i];\n-\t\t\t\tok = TIFFWriteDirectoryTagByteArray(tif,ndir,dir,tag,count,(uint8*)conv);\n+\t\t\t\tok = TIFFWriteDirectoryTagByteArray(tif, ndir, dir, tag, count, (uint8*)conv);\n \t\t\t}\n-\t\t\telse if (tif->tif_dir.td_bitspersample<=16)\n+\t\t\telse if (tif->tif_dir.td_bitspersample <= 16)\n \t\t\t{\n \t\t\t\tfor (i = 0; i < count; ++i)\n \t\t\t\t\t((uint16*)conv)[i] = (uint16)value[i];\n-\t\t\t\tok = TIFFWriteDirectoryTagShortArray(tif,ndir,dir,tag,count,(uint16*)conv);\n+\t\t\t\tok = TIFFWriteDirectoryTagShortArray(tif, ndir, dir, tag, count, (uint16*)conv);\n \t\t\t}\n \t\t\telse\n \t\t\t{\n \t\t\t\tfor (i = 0; i < count; ++i)\n \t\t\t\t\t((uint32*)conv)[i] = (uint32)value[i];\n-\t\t\t\tok = TIFFWriteDirectoryTagLongArray(tif,ndir,dir,tag,count,(uint32*)conv);\n+\t\t\t\tok = TIFFWriteDirectoryTagLongArray(tif, ndir, dir, tag, count, (uint32*)conv);\n \t\t\t}\n \t\t\tbreak;\n \t\tdefault:\n@@ -1015,6 +1021,7 @@\n \treturn (ok);\n }\n \n+\n #if 0\n static int\n TIFFWriteDirectoryTagSampleformatPerSample(TIFF* tif, uint32* ndir, TIFFDirEntry* dir, uint16 tag, double value)\n', 'id': 29, 'location': '/data/vulnloc/libtiff/CVE-2017-7600/src/libtiff/tif_dirwrite.c:956:2'}, {'diff': '@@ -939,6 +939,7 @@\n \treturn(0);\n }\n \n+\n static int\n TIFFWriteDirectoryTagSampleformatArray(TIFF* tif, uint32* ndir, TIFFDirEntry* dir, uint16 tag, uint32 count, double* value)\n {\n@@ -946,7 +947,14 @@\n \tvoid* conv;\n \tuint32 i;\n \tint ok;\n-\tconv = _TIFFmalloc(count*sizeof(double));\n+\n+\tif (count == 0) // Check for zero count\n+\t{\n+\t\tTIFFErrorExt(tif->tif_clientdata, module, "Count cannot be zero");\n+\t\treturn (0);\n+\t}\n+\n+\tconv = _TIFFmalloc(count * sizeof(double));\n \tif (conv == NULL)\n \t{\n \t\tTIFFErrorExt(tif->tif_clientdata, module, "Out of memory");\n@@ -956,55 +964,55 @@\n \tswitch (tif->tif_dir.td_sampleformat)\n \t{\n \t\tcase SAMPLEFORMAT_IEEEFP:\n-\t\t\tif (tif->tif_dir.td_bitspersample<=32)\n+\t\t\tif (tif->tif_dir.td_bitspersample <= 32)\n \t\t\t{\n \t\t\t\tfor (i = 0; i < count; ++i)\n \t\t\t\t\t((float*)conv)[i] = (float)value[i];\n-\t\t\t\tok = TIFFWriteDirectoryTagFloatArray(tif,ndir,dir,tag,count,(float*)conv);\n+\t\t\t\tok = TIFFWriteDirectoryTagFloatArray(tif, ndir, dir, tag, count, (float*)conv);\n \t\t\t}\n \t\t\telse\n \t\t\t{\n-\t\t\t\tok = TIFFWriteDirectoryTagDoubleArray(tif,ndir,dir,tag,count,value);\n+\t\t\t\tok = TIFFWriteDirectoryTagDoubleArray(tif, ndir, dir, tag, count, value);\n \t\t\t}\n \t\t\tbreak;\n \t\tcase SAMPLEFORMAT_INT:\n-\t\t\tif (tif->tif_dir.td_bitspersample<=8)\n+\t\t\tif (tif->tif_dir.td_bitspersample <= 8)\n \t\t\t{\n \t\t\t\tfor (i = 0; i < count; ++i)\n \t\t\t\t\t((int8*)conv)[i] = (int8)value[i];\n-\t\t\t\tok = TIFFWriteDirectoryTagSbyteArray(tif,ndir,dir,tag,count,(int8*)conv);\n+\t\t\t\tok = TIFFWriteDirectoryTagSbyteArray(tif, ndir, dir, tag, count, (int8*)conv);\n \t\t\t}\n-\t\t\telse if (tif->tif_dir.td_bitspersample<=16)\n+\t\t\telse if (tif->tif_dir.td_bitspersample <= 16)\n \t\t\t{\n \t\t\t\tfor (i = 0; i < count; ++i)\n \t\t\t\t\t((int16*)conv)[i] = (int16)value[i];\n-\t\t\t\tok = TIFFWriteDirectoryTagSshortArray(tif,ndir,dir,tag,count,(int16*)conv);\n+\t\t\t\tok = TIFFWriteDirectoryTagSshortArray(tif, ndir, dir, tag, count, (int16*)conv);\n \t\t\t}\n \t\t\telse\n \t\t\t{\n \t\t\t\tfor (i = 0; i < count; ++i)\n \t\t\t\t\t((int32*)conv)[i] = (int32)value[i];\n-\t\t\t\tok = TIFFWriteDirectoryTagSlongArray(tif,ndir,dir,tag,count,(int32*)conv);\n+\t\t\t\tok = TIFFWriteDirectoryTagSlongArray(tif, ndir, dir, tag, count, (int32*)conv);\n \t\t\t}\n \t\t\tbreak;\n \t\tcase SAMPLEFORMAT_UINT:\n-\t\t\tif (tif->tif_dir.td_bitspersample<=8)\n+\t\t\tif (tif->tif_dir.td_bitspersample <= 8)\n \t\t\t{\n \t\t\t\tfor (i = 0; i < count; ++i)\n \t\t\t\t\t((uint8*)conv)[i] = (uint8)value[i];\n-\t\t\t\tok = TIFFWriteDirectoryTagByteArray(tif,ndir,dir,tag,count,(uint8*)conv);\n+\t\t\t\tok = TIFFWriteDirectoryTagByteArray(tif, ndir, dir, tag, count, (uint8*)conv);\n \t\t\t}\n-\t\t\telse if (tif->tif_dir.td_bitspersample<=16)\n+\t\t\telse if (tif->tif_dir.td_bitspersample <= 16)\n \t\t\t{\n \t\t\t\tfor (i = 0; i < count; ++i)\n \t\t\t\t\t((uint16*)conv)[i] = (uint16)value[i];\n-\t\t\t\tok = TIFFWriteDirectoryTagShortArray(tif,ndir,dir,tag,count,(uint16*)conv);\n+\t\t\t\tok = TIFFWriteDirectoryTagShortArray(tif, ndir, dir, tag, count, (uint16*)conv);\n \t\t\t}\n \t\t\telse\n \t\t\t{\n \t\t\t\tfor (i = 0; i < count; ++i)\n \t\t\t\t\t((uint32*)conv)[i] = (uint32)value[i];\n-\t\t\t\tok = TIFFWriteDirectoryTagLongArray(tif,ndir,dir,tag,count,(uint32*)conv);\n+\t\t\t\tok = TIFFWriteDirectoryTagLongArray(tif, ndir, dir, tag, count, (uint32*)conv);\n \t\t\t}\n \t\t\tbreak;\n \t\tdefault:\n@@ -1015,6 +1023,7 @@\n \treturn (ok);\n }\n \n+\n #if 0\n static int\n TIFFWriteDirectoryTagSampleformatPerSample(TIFF* tif, uint32* ndir, TIFFDirEntry* dir, uint16 tag, double value)\n', 'id': 30, 'location': '/data/vulnloc/libtiff/CVE-2017-7600/src/libtiff/tif_dirwrite.c:950:2'}, {'diff': '@@ -939,6 +939,7 @@\n \treturn(0);\n }\n \n+\n static int\n TIFFWriteDirectoryTagSampleformatArray(TIFF* tif, uint32* ndir, TIFFDirEntry* dir, uint16 tag, uint32 count, double* value)\n {\n@@ -946,6 +947,11 @@\n \tvoid* conv;\n \tuint32 i;\n \tint ok;\n+\tif (count == 0) \n+\t{\n+\t\tTIFFErrorExt(tif->tif_clientdata, module, "Count cannot be zero");\n+\t\treturn (0);\n+\t}\n \tconv = _TIFFmalloc(count*sizeof(double));\n \tif (conv == NULL)\n \t{\n@@ -1015,6 +1021,7 @@\n \treturn (ok);\n }\n \n+\n #if 0\n static int\n TIFFWriteDirectoryTagSampleformatPerSample(TIFF* tif, uint32* ndir, TIFFDirEntry* dir, uint16 tag, double value)\n', 'id': 31, 'location': '/data/vulnloc/libtiff/CVE-2017-7600/src/libtiff/tif_dirwrite.c:950:2'}, {'diff': '@@ -939,6 +939,7 @@\n \treturn(0);\n }\n \n+\n static int\n TIFFWriteDirectoryTagSampleformatArray(TIFF* tif, uint32* ndir, TIFFDirEntry* dir, uint16 tag, uint32 count, double* value)\n {\n@@ -946,6 +947,12 @@\n \tvoid* conv;\n \tuint32 i;\n \tint ok;\n+\t\n+\tif (count == 0 || value == NULL) {\n+\t\tTIFFErrorExt(tif->tif_clientdata, module, "Invalid count or value pointer");\n+\t\treturn (0);\n+\t}\n+\n \tconv = _TIFFmalloc(count*sizeof(double));\n \tif (conv == NULL)\n \t{\n@@ -1015,6 +1022,7 @@\n \treturn (ok);\n }\n \n+\n #if 0\n static int\n TIFFWriteDirectoryTagSampleformatPerSample(TIFF* tif, uint32* ndir, TIFFDirEntry* dir, uint16 tag, double value)\n', 'id': 32, 'location': '/data/vulnloc/libtiff/CVE-2017-7600/src/libtiff/tif_dirwrite.c:950:2'}, {'diff': '@@ -939,6 +939,7 @@\n \treturn(0);\n }\n \n+\n static int\n TIFFWriteDirectoryTagSampleformatArray(TIFF* tif, uint32* ndir, TIFFDirEntry* dir, uint16 tag, uint32 count, double* value)\n {\n@@ -946,7 +947,11 @@\n \tvoid* conv;\n \tuint32 i;\n \tint ok;\n-\tconv = _TIFFmalloc(count*sizeof(double));\n+\tif (count == 0) // Check for zero count before memory allocation\n+\t{\n+\t\treturn 0; // No data to process\n+\t}\n+\tconv = _TIFFmalloc(count * sizeof(double));\n \tif (conv == NULL)\n \t{\n \t\tTIFFErrorExt(tif->tif_clientdata, module, "Out of memory");\n@@ -956,55 +961,55 @@\n \tswitch (tif->tif_dir.td_sampleformat)\n \t{\n \t\tcase SAMPLEFORMAT_IEEEFP:\n-\t\t\tif (tif->tif_dir.td_bitspersample<=32)\n+\t\t\tif (tif->tif_dir.td_bitspersample <= 32)\n \t\t\t{\n \t\t\t\tfor (i = 0; i < count; ++i)\n \t\t\t\t\t((float*)conv)[i] = (float)value[i];\n-\t\t\t\tok = TIFFWriteDirectoryTagFloatArray(tif,ndir,dir,tag,count,(float*)conv);\n+\t\t\t\tok = TIFFWriteDirectoryTagFloatArray(tif, ndir, dir, tag, count, (float*)conv);\n \t\t\t}\n \t\t\telse\n \t\t\t{\n-\t\t\t\tok = TIFFWriteDirectoryTagDoubleArray(tif,ndir,dir,tag,count,value);\n+\t\t\t\tok = TIFFWriteDirectoryTagDoubleArray(tif, ndir, dir, tag, count, value);\n \t\t\t}\n \t\t\tbreak;\n \t\tcase SAMPLEFORMAT_INT:\n-\t\t\tif (tif->tif_dir.td_bitspersample<=8)\n+\t\t\tif (tif->tif_dir.td_bitspersample <= 8)\n \t\t\t{\n \t\t\t\tfor (i = 0; i < count; ++i)\n \t\t\t\t\t((int8*)conv)[i] = (int8)value[i];\n-\t\t\t\tok = TIFFWriteDirectoryTagSbyteArray(tif,ndir,dir,tag,count,(int8*)conv);\n+\t\t\t\tok = TIFFWriteDirectoryTagSbyteArray(tif, ndir, dir, tag, count, (int8*)conv);\n \t\t\t}\n-\t\t\telse if (tif->tif_dir.td_bitspersample<=16)\n+\t\t\telse if (tif->tif_dir.td_bitspersample <= 16)\n \t\t\t{\n \t\t\t\tfor (i = 0; i < count; ++i)\n \t\t\t\t\t((int16*)conv)[i] = (int16)value[i];\n-\t\t\t\tok = TIFFWriteDirectoryTagSshortArray(tif,ndir,dir,tag,count,(int16*)conv);\n+\t\t\t\tok = TIFFWriteDirectoryTagSshortArray(tif, ndir, dir, tag, count, (int16*)conv);\n \t\t\t}\n \t\t\telse\n \t\t\t{\n \t\t\t\tfor (i = 0; i < count; ++i)\n \t\t\t\t\t((int32*)conv)[i] = (int32)value[i];\n-\t\t\t\tok = TIFFWriteDirectoryTagSlongArray(tif,ndir,dir,tag,count,(int32*)conv);\n+\t\t\t\tok = TIFFWriteDirectoryTagSlongArray(tif, ndir, dir, tag, count, (int32*)conv);\n \t\t\t}\n \t\t\tbreak;\n \t\tcase SAMPLEFORMAT_UINT:\n-\t\t\tif (tif->tif_dir.td_bitspersample<=8)\n+\t\t\tif (tif->tif_dir.td_bitspersample <= 8)\n \t\t\t{\n \t\t\t\tfor (i = 0; i < count; ++i)\n \t\t\t\t\t((uint8*)conv)[i] = (uint8)value[i];\n-\t\t\t\tok = TIFFWriteDirectoryTagByteArray(tif,ndir,dir,tag,count,(uint8*)conv);\n+\t\t\t\tok = TIFFWriteDirectoryTagByteArray(tif, ndir, dir, tag, count, (uint8*)conv);\n \t\t\t}\n-\t\t\telse if (tif->tif_dir.td_bitspersample<=16)\n+\t\t\telse if (tif->tif_dir.td_bitspersample <= 16)\n \t\t\t{\n \t\t\t\tfor (i = 0; i < count; ++i)\n \t\t\t\t\t((uint16*)conv)[i] = (uint16)value[i];\n-\t\t\t\tok = TIFFWriteDirectoryTagShortArray(tif,ndir,dir,tag,count,(uint16*)conv);\n+\t\t\t\tok = TIFFWriteDirectoryTagShortArray(tif, ndir, dir, tag, count, (uint16*)conv);\n \t\t\t}\n \t\t\telse\n \t\t\t{\n \t\t\t\tfor (i = 0; i < count; ++i)\n \t\t\t\t\t((uint32*)conv)[i] = (uint32)value[i];\n-\t\t\t\tok = TIFFWriteDirectoryTagLongArray(tif,ndir,dir,tag,count,(uint32*)conv);\n+\t\t\t\tok = TIFFWriteDirectoryTagLongArray(tif, ndir, dir, tag, count, (uint32*)conv);\n \t\t\t}\n \t\t\tbreak;\n \t\tdefault:\n@@ -1015,6 +1020,7 @@\n \treturn (ok);\n }\n \n+\n #if 0\n static int\n TIFFWriteDirectoryTagSampleformatPerSample(TIFF* tif, uint32* ndir, TIFFDirEntry* dir, uint16 tag, double value)\n', 'id': 33, 'location': '/data/vulnloc/libtiff/CVE-2017-7600/src/libtiff/tif_dirwrite.c:950:2'}, {'diff': "@@ -939,6 +939,7 @@\n \treturn(0);\n }\n \n+\n static int\n TIFFWriteDirectoryTagSampleformatArray(TIFF* tif, uint32* ndir, TIFFDirEntry* dir, uint16 tag, uint32 count, double* value)\n {\n@@ -946,6 +947,12 @@\n \tvoid* conv;\n \tuint32 i;\n \tint ok;\n+\n+\tif (count == 0) // Check for zero count to avoid unnecessary memory allocation\n+\t{\n+\t\treturn 1; // Preferably return success if there's no data to write\n+\t}\n+\n \tconv = _TIFFmalloc(count*sizeof(double));\n \tif (conv == NULL)\n \t{\n@@ -1015,6 +1022,7 @@\n \treturn (ok);\n }\n \n+\n #if 0\n static int\n TIFFWriteDirectoryTagSampleformatPerSample(TIFF* tif, uint32* ndir, TIFFDirEntry* dir, uint16 tag, double value)\n", 'id': 34, 'location': '/data/vulnloc/libtiff/CVE-2017-7600/src/libtiff/tif_dirwrite.c:950:2'}, {'diff': '@@ -939,6 +939,7 @@\n \treturn(0);\n }\n \n+\n static int\n TIFFWriteDirectoryTagSampleformatArray(TIFF* tif, uint32* ndir, TIFFDirEntry* dir, uint16 tag, uint32 count, double* value)\n {\n@@ -946,7 +947,12 @@\n \tvoid* conv;\n \tuint32 i;\n \tint ok;\n-\tconv = _TIFFmalloc(count*sizeof(double));\n+\n+\tif (count == 0) {\n+\t\treturn 0; // Avoid allocating memory for zero elements\n+\t}\n+\n+\tconv = _TIFFmalloc(count * sizeof(double));\n \tif (conv == NULL)\n \t{\n \t\tTIFFErrorExt(tif->tif_clientdata, module, "Out of memory");\n@@ -956,55 +962,55 @@\n \tswitch (tif->tif_dir.td_sampleformat)\n \t{\n \t\tcase SAMPLEFORMAT_IEEEFP:\n-\t\t\tif (tif->tif_dir.td_bitspersample<=32)\n+\t\t\tif (tif->tif_dir.td_bitspersample <= 32)\n \t\t\t{\n \t\t\t\tfor (i = 0; i < count; ++i)\n \t\t\t\t\t((float*)conv)[i] = (float)value[i];\n-\t\t\t\tok = TIFFWriteDirectoryTagFloatArray(tif,ndir,dir,tag,count,(float*)conv);\n+\t\t\t\tok = TIFFWriteDirectoryTagFloatArray(tif, ndir, dir, tag, count, (float*)conv);\n \t\t\t}\n \t\t\telse\n \t\t\t{\n-\t\t\t\tok = TIFFWriteDirectoryTagDoubleArray(tif,ndir,dir,tag,count,value);\n+\t\t\t\tok = TIFFWriteDirectoryTagDoubleArray(tif, ndir, dir, tag, count, value);\n \t\t\t}\n \t\t\tbreak;\n \t\tcase SAMPLEFORMAT_INT:\n-\t\t\tif (tif->tif_dir.td_bitspersample<=8)\n+\t\t\tif (tif->tif_dir.td_bitspersample <= 8)\n \t\t\t{\n \t\t\t\tfor (i = 0; i < count; ++i)\n \t\t\t\t\t((int8*)conv)[i] = (int8)value[i];\n-\t\t\t\tok = TIFFWriteDirectoryTagSbyteArray(tif,ndir,dir,tag,count,(int8*)conv);\n+\t\t\t\tok = TIFFWriteDirectoryTagSbyteArray(tif, ndir, dir, tag, count, (int8*)conv);\n \t\t\t}\n-\t\t\telse if (tif->tif_dir.td_bitspersample<=16)\n+\t\t\telse if (tif->tif_dir.td_bitspersample <= 16)\n \t\t\t{\n \t\t\t\tfor (i = 0; i < count; ++i)\n \t\t\t\t\t((int16*)conv)[i] = (int16)value[i];\n-\t\t\t\tok = TIFFWriteDirectoryTagSshortArray(tif,ndir,dir,tag,count,(int16*)conv);\n+\t\t\t\tok = TIFFWriteDirectoryTagSshortArray(tif, ndir, dir, tag, count, (int16*)conv);\n \t\t\t}\n \t\t\telse\n \t\t\t{\n \t\t\t\tfor (i = 0; i < count; ++i)\n \t\t\t\t\t((int32*)conv)[i] = (int32)value[i];\n-\t\t\t\tok = TIFFWriteDirectoryTagSlongArray(tif,ndir,dir,tag,count,(int32*)conv);\n+\t\t\t\tok = TIFFWriteDirectoryTagSlongArray(tif, ndir, dir, tag, count, (int32*)conv);\n \t\t\t}\n \t\t\tbreak;\n \t\tcase SAMPLEFORMAT_UINT:\n-\t\t\tif (tif->tif_dir.td_bitspersample<=8)\n+\t\t\tif (tif->tif_dir.td_bitspersample <= 8)\n \t\t\t{\n \t\t\t\tfor (i = 0; i < count; ++i)\n \t\t\t\t\t((uint8*)conv)[i] = (uint8)value[i];\n-\t\t\t\tok = TIFFWriteDirectoryTagByteArray(tif,ndir,dir,tag,count,(uint8*)conv);\n+\t\t\t\tok = TIFFWriteDirectoryTagByteArray(tif, ndir, dir, tag, count, (uint8*)conv);\n \t\t\t}\n-\t\t\telse if (tif->tif_dir.td_bitspersample<=16)\n+\t\t\telse if (tif->tif_dir.td_bitspersample <= 16)\n \t\t\t{\n \t\t\t\tfor (i = 0; i < count; ++i)\n \t\t\t\t\t((uint16*)conv)[i] = (uint16)value[i];\n-\t\t\t\tok = TIFFWriteDirectoryTagShortArray(tif,ndir,dir,tag,count,(uint16*)conv);\n+\t\t\t\tok = TIFFWriteDirectoryTagShortArray(tif, ndir, dir, tag, count, (uint16*)conv);\n \t\t\t}\n \t\t\telse\n \t\t\t{\n \t\t\t\tfor (i = 0; i < count; ++i)\n \t\t\t\t\t((uint32*)conv)[i] = (uint32)value[i];\n-\t\t\t\tok = TIFFWriteDirectoryTagLongArray(tif,ndir,dir,tag,count,(uint32*)conv);\n+\t\t\t\tok = TIFFWriteDirectoryTagLongArray(tif, ndir, dir, tag, count, (uint32*)conv);\n \t\t\t}\n \t\t\tbreak;\n \t\tdefault:\n@@ -1015,6 +1021,7 @@\n \treturn (ok);\n }\n \n+\n #if 0\n static int\n TIFFWriteDirectoryTagSampleformatPerSample(TIFF* tif, uint32* ndir, TIFFDirEntry* dir, uint16 tag, double value)\n', 'id': 35, 'location': '/data/vulnloc/libtiff/CVE-2017-7600/src/libtiff/tif_dirwrite.c:949:2'}, {'diff': '@@ -939,6 +939,7 @@\n \treturn(0);\n }\n \n+\n static int\n TIFFWriteDirectoryTagSampleformatArray(TIFF* tif, uint32* ndir, TIFFDirEntry* dir, uint16 tag, uint32 count, double* value)\n {\n@@ -946,7 +947,12 @@\n \tvoid* conv;\n \tuint32 i;\n \tint ok;\n-\tconv = _TIFFmalloc(count*sizeof(double));\n+\n+\tif (count == 0) {\n+\t\tTIFFErrorExt(tif->tif_clientdata, module, "Count cannot be zero");\n+\t\treturn (0);\n+\t}\n+\tconv = _TIFFmalloc(count * sizeof(double));\n \tif (conv == NULL)\n \t{\n \t\tTIFFErrorExt(tif->tif_clientdata, module, "Out of memory");\n@@ -956,55 +962,55 @@\n \tswitch (tif->tif_dir.td_sampleformat)\n \t{\n \t\tcase SAMPLEFORMAT_IEEEFP:\n-\t\t\tif (tif->tif_dir.td_bitspersample<=32)\n+\t\t\tif (tif->tif_dir.td_bitspersample <= 32)\n \t\t\t{\n \t\t\t\tfor (i = 0; i < count; ++i)\n \t\t\t\t\t((float*)conv)[i] = (float)value[i];\n-\t\t\t\tok = TIFFWriteDirectoryTagFloatArray(tif,ndir,dir,tag,count,(float*)conv);\n+\t\t\t\tok = TIFFWriteDirectoryTagFloatArray(tif, ndir, dir, tag, count, (float*)conv);\n \t\t\t}\n \t\t\telse\n \t\t\t{\n-\t\t\t\tok = TIFFWriteDirectoryTagDoubleArray(tif,ndir,dir,tag,count,value);\n+\t\t\t\tok = TIFFWriteDirectoryTagDoubleArray(tif, ndir, dir, tag, count, value);\n \t\t\t}\n \t\t\tbreak;\n \t\tcase SAMPLEFORMAT_INT:\n-\t\t\tif (tif->tif_dir.td_bitspersample<=8)\n+\t\t\tif (tif->tif_dir.td_bitspersample <= 8)\n \t\t\t{\n \t\t\t\tfor (i = 0; i < count; ++i)\n \t\t\t\t\t((int8*)conv)[i] = (int8)value[i];\n-\t\t\t\tok = TIFFWriteDirectoryTagSbyteArray(tif,ndir,dir,tag,count,(int8*)conv);\n+\t\t\t\tok = TIFFWriteDirectoryTagSbyteArray(tif, ndir, dir, tag, count, (int8*)conv);\n \t\t\t}\n-\t\t\telse if (tif->tif_dir.td_bitspersample<=16)\n+\t\t\telse if (tif->tif_dir.td_bitspersample <= 16)\n \t\t\t{\n \t\t\t\tfor (i = 0; i < count; ++i)\n \t\t\t\t\t((int16*)conv)[i] = (int16)value[i];\n-\t\t\t\tok = TIFFWriteDirectoryTagSshortArray(tif,ndir,dir,tag,count,(int16*)conv);\n+\t\t\t\tok = TIFFWriteDirectoryTagSshortArray(tif, ndir, dir, tag, count, (int16*)conv);\n \t\t\t}\n \t\t\telse\n \t\t\t{\n \t\t\t\tfor (i = 0; i < count; ++i)\n \t\t\t\t\t((int32*)conv)[i] = (int32)value[i];\n-\t\t\t\tok = TIFFWriteDirectoryTagSlongArray(tif,ndir,dir,tag,count,(int32*)conv);\n+\t\t\t\tok = TIFFWriteDirectoryTagSlongArray(tif, ndir, dir, tag, count, (int32*)conv);\n \t\t\t}\n \t\t\tbreak;\n \t\tcase SAMPLEFORMAT_UINT:\n-\t\t\tif (tif->tif_dir.td_bitspersample<=8)\n+\t\t\tif (tif->tif_dir.td_bitspersample <= 8)\n \t\t\t{\n \t\t\t\tfor (i = 0; i < count; ++i)\n \t\t\t\t\t((uint8*)conv)[i] = (uint8)value[i];\n-\t\t\t\tok = TIFFWriteDirectoryTagByteArray(tif,ndir,dir,tag,count,(uint8*)conv);\n+\t\t\t\tok = TIFFWriteDirectoryTagByteArray(tif, ndir, dir, tag, count, (uint8*)conv);\n \t\t\t}\n-\t\t\telse if (tif->tif_dir.td_bitspersample<=16)\n+\t\t\telse if (tif->tif_dir.td_bitspersample <= 16)\n \t\t\t{\n \t\t\t\tfor (i = 0; i < count; ++i)\n \t\t\t\t\t((uint16*)conv)[i] = (uint16)value[i];\n-\t\t\t\tok = TIFFWriteDirectoryTagShortArray(tif,ndir,dir,tag,count,(uint16*)conv);\n+\t\t\t\tok = TIFFWriteDirectoryTagShortArray(tif, ndir, dir, tag, count, (uint16*)conv);\n \t\t\t}\n \t\t\telse\n \t\t\t{\n \t\t\t\tfor (i = 0; i < count; ++i)\n \t\t\t\t\t((uint32*)conv)[i] = (uint32)value[i];\n-\t\t\t\tok = TIFFWriteDirectoryTagLongArray(tif,ndir,dir,tag,count,(uint32*)conv);\n+\t\t\t\tok = TIFFWriteDirectoryTagLongArray(tif, ndir, dir, tag, count, (uint32*)conv);\n \t\t\t}\n \t\t\tbreak;\n \t\tdefault:\n@@ -1015,6 +1021,7 @@\n \treturn (ok);\n }\n \n+\n #if 0\n static int\n TIFFWriteDirectoryTagSampleformatPerSample(TIFF* tif, uint32* ndir, TIFFDirEntry* dir, uint16 tag, double value)\n', 'id': 36, 'location': '/data/vulnloc/libtiff/CVE-2017-7600/src/libtiff/tif_dirwrite.c:949:2'}, {'diff': '@@ -939,6 +939,7 @@\n \treturn(0);\n }\n \n+\n static int\n TIFFWriteDirectoryTagSampleformatArray(TIFF* tif, uint32* ndir, TIFFDirEntry* dir, uint16 tag, uint32 count, double* value)\n {\n@@ -946,7 +947,13 @@\n \tvoid* conv;\n \tuint32 i;\n \tint ok;\n-\tconv = _TIFFmalloc(count*sizeof(double));\n+\n+\tif (count == 0) {\n+\t\tTIFFErrorExt(tif->tif_clientdata, module, "Count must be greater than zero");\n+\t\treturn (0);\n+\t}\n+\t\n+\tconv = _TIFFmalloc(count * sizeof(double));\n \tif (conv == NULL)\n \t{\n \t\tTIFFErrorExt(tif->tif_clientdata, module, "Out of memory");\n@@ -956,55 +963,55 @@\n \tswitch (tif->tif_dir.td_sampleformat)\n \t{\n \t\tcase SAMPLEFORMAT_IEEEFP:\n-\t\t\tif (tif->tif_dir.td_bitspersample<=32)\n+\t\t\tif (tif->tif_dir.td_bitspersample <= 32)\n \t\t\t{\n \t\t\t\tfor (i = 0; i < count; ++i)\n \t\t\t\t\t((float*)conv)[i] = (float)value[i];\n-\t\t\t\tok = TIFFWriteDirectoryTagFloatArray(tif,ndir,dir,tag,count,(float*)conv);\n+\t\t\t\tok = TIFFWriteDirectoryTagFloatArray(tif, ndir, dir, tag, count, (float*)conv);\n \t\t\t}\n \t\t\telse\n \t\t\t{\n-\t\t\t\tok = TIFFWriteDirectoryTagDoubleArray(tif,ndir,dir,tag,count,value);\n+\t\t\t\tok = TIFFWriteDirectoryTagDoubleArray(tif, ndir, dir, tag, count, value);\n \t\t\t}\n \t\t\tbreak;\n \t\tcase SAMPLEFORMAT_INT:\n-\t\t\tif (tif->tif_dir.td_bitspersample<=8)\n+\t\t\tif (tif->tif_dir.td_bitspersample <= 8)\n \t\t\t{\n \t\t\t\tfor (i = 0; i < count; ++i)\n \t\t\t\t\t((int8*)conv)[i] = (int8)value[i];\n-\t\t\t\tok = TIFFWriteDirectoryTagSbyteArray(tif,ndir,dir,tag,count,(int8*)conv);\n+\t\t\t\tok = TIFFWriteDirectoryTagSbyteArray(tif, ndir, dir, tag, count, (int8*)conv);\n \t\t\t}\n-\t\t\telse if (tif->tif_dir.td_bitspersample<=16)\n+\t\t\telse if (tif->tif_dir.td_bitspersample <= 16)\n \t\t\t{\n \t\t\t\tfor (i = 0; i < count; ++i)\n \t\t\t\t\t((int16*)conv)[i] = (int16)value[i];\n-\t\t\t\tok = TIFFWriteDirectoryTagSshortArray(tif,ndir,dir,tag,count,(int16*)conv);\n+\t\t\t\tok = TIFFWriteDirectoryTagSshortArray(tif, ndir, dir, tag, count, (int16*)conv);\n \t\t\t}\n \t\t\telse\n \t\t\t{\n \t\t\t\tfor (i = 0; i < count; ++i)\n \t\t\t\t\t((int32*)conv)[i] = (int32)value[i];\n-\t\t\t\tok = TIFFWriteDirectoryTagSlongArray(tif,ndir,dir,tag,count,(int32*)conv);\n+\t\t\t\tok = TIFFWriteDirectoryTagSlongArray(tif, ndir, dir, tag, count, (int32*)conv);\n \t\t\t}\n \t\t\tbreak;\n \t\tcase SAMPLEFORMAT_UINT:\n-\t\t\tif (tif->tif_dir.td_bitspersample<=8)\n+\t\t\tif (tif->tif_dir.td_bitspersample <= 8)\n \t\t\t{\n \t\t\t\tfor (i = 0; i < count; ++i)\n \t\t\t\t\t((uint8*)conv)[i] = (uint8)value[i];\n-\t\t\t\tok = TIFFWriteDirectoryTagByteArray(tif,ndir,dir,tag,count,(uint8*)conv);\n+\t\t\t\tok = TIFFWriteDirectoryTagByteArray(tif, ndir, dir, tag, count, (uint8*)conv);\n \t\t\t}\n-\t\t\telse if (tif->tif_dir.td_bitspersample<=16)\n+\t\t\telse if (tif->tif_dir.td_bitspersample <= 16)\n \t\t\t{\n \t\t\t\tfor (i = 0; i < count; ++i)\n \t\t\t\t\t((uint16*)conv)[i] = (uint16)value[i];\n-\t\t\t\tok = TIFFWriteDirectoryTagShortArray(tif,ndir,dir,tag,count,(uint16*)conv);\n+\t\t\t\tok = TIFFWriteDirectoryTagShortArray(tif, ndir, dir, tag, count, (uint16*)conv);\n \t\t\t}\n \t\t\telse\n \t\t\t{\n \t\t\t\tfor (i = 0; i < count; ++i)\n \t\t\t\t\t((uint32*)conv)[i] = (uint32)value[i];\n-\t\t\t\tok = TIFFWriteDirectoryTagLongArray(tif,ndir,dir,tag,count,(uint32*)conv);\n+\t\t\t\tok = TIFFWriteDirectoryTagLongArray(tif, ndir, dir, tag, count, (uint32*)conv);\n \t\t\t}\n \t\t\tbreak;\n \t\tdefault:\n@@ -1015,6 +1022,7 @@\n \treturn (ok);\n }\n \n+\n #if 0\n static int\n TIFFWriteDirectoryTagSampleformatPerSample(TIFF* tif, uint32* ndir, TIFFDirEntry* dir, uint16 tag, double value)\n', 'id': 37, 'location': '/data/vulnloc/libtiff/CVE-2017-7600/src/libtiff/tif_dirwrite.c:949:2'}, {'diff': '@@ -939,6 +939,7 @@\n \treturn(0);\n }\n \n+\n static int\n TIFFWriteDirectoryTagSampleformatArray(TIFF* tif, uint32* ndir, TIFFDirEntry* dir, uint16 tag, uint32 count, double* value)\n {\n@@ -946,6 +947,12 @@\n \tvoid* conv;\n \tuint32 i;\n \tint ok;\n+\n+\tif (count == 0) {\n+\t\tTIFFErrorExt(tif->tif_clientdata, module, "Count cannot be zero");\n+\t\treturn (0);\n+\t}\n+\n \tconv = _TIFFmalloc(count*sizeof(double));\n \tif (conv == NULL)\n \t{\n@@ -1015,6 +1022,7 @@\n \treturn (ok);\n }\n \n+\n #if 0\n static int\n TIFFWriteDirectoryTagSampleformatPerSample(TIFF* tif, uint32* ndir, TIFFDirEntry* dir, uint16 tag, double value)\n', 'id': 38, 'location': '/data/vulnloc/libtiff/CVE-2017-7600/src/libtiff/tif_dirwrite.c:949:2'}, {'diff': '@@ -939,6 +939,7 @@\n \treturn(0);\n }\n \n+\n static int\n TIFFWriteDirectoryTagSampleformatArray(TIFF* tif, uint32* ndir, TIFFDirEntry* dir, uint16 tag, uint32 count, double* value)\n {\n@@ -946,7 +947,10 @@\n \tvoid* conv;\n \tuint32 i;\n \tint ok;\n-\tconv = _TIFFmalloc(count*sizeof(double));\n+\tif (count == 0) {\n+\t\treturn 1; // Return success for zero count\n+\t}\n+\tconv = _TIFFmalloc(count * sizeof(double));\n \tif (conv == NULL)\n \t{\n \t\tTIFFErrorExt(tif->tif_clientdata, module, "Out of memory");\n@@ -956,55 +960,55 @@\n \tswitch (tif->tif_dir.td_sampleformat)\n \t{\n \t\tcase SAMPLEFORMAT_IEEEFP:\n-\t\t\tif (tif->tif_dir.td_bitspersample<=32)\n+\t\t\tif (tif->tif_dir.td_bitspersample <= 32)\n \t\t\t{\n \t\t\t\tfor (i = 0; i < count; ++i)\n \t\t\t\t\t((float*)conv)[i] = (float)value[i];\n-\t\t\t\tok = TIFFWriteDirectoryTagFloatArray(tif,ndir,dir,tag,count,(float*)conv);\n+\t\t\t\tok = TIFFWriteDirectoryTagFloatArray(tif, ndir, dir, tag, count, (float*)conv);\n \t\t\t}\n \t\t\telse\n \t\t\t{\n-\t\t\t\tok = TIFFWriteDirectoryTagDoubleArray(tif,ndir,dir,tag,count,value);\n+\t\t\t\tok = TIFFWriteDirectoryTagDoubleArray(tif, ndir, dir, tag, count, value);\n \t\t\t}\n \t\t\tbreak;\n \t\tcase SAMPLEFORMAT_INT:\n-\t\t\tif (tif->tif_dir.td_bitspersample<=8)\n+\t\t\tif (tif->tif_dir.td_bitspersample <= 8)\n \t\t\t{\n \t\t\t\tfor (i = 0; i < count; ++i)\n \t\t\t\t\t((int8*)conv)[i] = (int8)value[i];\n-\t\t\t\tok = TIFFWriteDirectoryTagSbyteArray(tif,ndir,dir,tag,count,(int8*)conv);\n+\t\t\t\tok = TIFFWriteDirectoryTagSbyteArray(tif, ndir, dir, tag, count, (int8*)conv);\n \t\t\t}\n-\t\t\telse if (tif->tif_dir.td_bitspersample<=16)\n+\t\t\telse if (tif->tif_dir.td_bitspersample <= 16)\n \t\t\t{\n \t\t\t\tfor (i = 0; i < count; ++i)\n \t\t\t\t\t((int16*)conv)[i] = (int16)value[i];\n-\t\t\t\tok = TIFFWriteDirectoryTagSshortArray(tif,ndir,dir,tag,count,(int16*)conv);\n+\t\t\t\tok = TIFFWriteDirectoryTagSshortArray(tif, ndir, dir, tag, count, (int16*)conv);\n \t\t\t}\n \t\t\telse\n \t\t\t{\n \t\t\t\tfor (i = 0; i < count; ++i)\n \t\t\t\t\t((int32*)conv)[i] = (int32)value[i];\n-\t\t\t\tok = TIFFWriteDirectoryTagSlongArray(tif,ndir,dir,tag,count,(int32*)conv);\n+\t\t\t\tok = TIFFWriteDirectoryTagSlongArray(tif, ndir, dir, tag, count, (int32*)conv);\n \t\t\t}\n \t\t\tbreak;\n \t\tcase SAMPLEFORMAT_UINT:\n-\t\t\tif (tif->tif_dir.td_bitspersample<=8)\n+\t\t\tif (tif->tif_dir.td_bitspersample <= 8)\n \t\t\t{\n \t\t\t\tfor (i = 0; i < count; ++i)\n \t\t\t\t\t((uint8*)conv)[i] = (uint8)value[i];\n-\t\t\t\tok = TIFFWriteDirectoryTagByteArray(tif,ndir,dir,tag,count,(uint8*)conv);\n+\t\t\t\tok = TIFFWriteDirectoryTagByteArray(tif, ndir, dir, tag, count, (uint8*)conv);\n \t\t\t}\n-\t\t\telse if (tif->tif_dir.td_bitspersample<=16)\n+\t\t\telse if (tif->tif_dir.td_bitspersample <= 16)\n \t\t\t{\n \t\t\t\tfor (i = 0; i < count; ++i)\n \t\t\t\t\t((uint16*)conv)[i] = (uint16)value[i];\n-\t\t\t\tok = TIFFWriteDirectoryTagShortArray(tif,ndir,dir,tag,count,(uint16*)conv);\n+\t\t\t\tok = TIFFWriteDirectoryTagShortArray(tif, ndir, dir, tag, count, (uint16*)conv);\n \t\t\t}\n \t\t\telse\n \t\t\t{\n \t\t\t\tfor (i = 0; i < count; ++i)\n \t\t\t\t\t((uint32*)conv)[i] = (uint32)value[i];\n-\t\t\t\tok = TIFFWriteDirectoryTagLongArray(tif,ndir,dir,tag,count,(uint32*)conv);\n+\t\t\t\tok = TIFFWriteDirectoryTagLongArray(tif, ndir, dir, tag, count, (uint32*)conv);\n \t\t\t}\n \t\t\tbreak;\n \t\tdefault:\n@@ -1015,6 +1019,7 @@\n \treturn (ok);\n }\n \n+\n #if 0\n static int\n TIFFWriteDirectoryTagSampleformatPerSample(TIFF* tif, uint32* ndir, TIFFDirEntry* dir, uint16 tag, double value)\n', 'id': 39, 'location': '/data/vulnloc/libtiff/CVE-2017-7600/src/libtiff/tif_dirwrite.c:949:2'}, {'diff': '@@ -939,6 +939,7 @@\n \treturn(0);\n }\n \n+\n static int\n TIFFWriteDirectoryTagSampleformatArray(TIFF* tif, uint32* ndir, TIFFDirEntry* dir, uint16 tag, uint32 count, double* value)\n {\n@@ -946,6 +947,12 @@\n \tvoid* conv;\n \tuint32 i;\n \tint ok;\n+\n+\tif (count > MAX_COUNT || count == 0) {\n+\t\tTIFFErrorExt(tif->tif_clientdata, module, "Invalid count");\n+\t\treturn (0);\n+\t}\n+\t\n \tconv = _TIFFmalloc(count*sizeof(double));\n \tif (conv == NULL)\n \t{\n@@ -1015,6 +1022,7 @@\n \treturn (ok);\n }\n \n+\n #if 0\n static int\n TIFFWriteDirectoryTagSampleformatPerSample(TIFF* tif, uint32* ndir, TIFFDirEntry* dir, uint16 tag, double value)\n', 'id': 40, 'location': '/data/vulnloc/libtiff/CVE-2017-7600/src/libtiff/tif_dirwrite.c:949:9'}, {'diff': '@@ -939,6 +939,7 @@\n \treturn(0);\n }\n \n+\n static int\n TIFFWriteDirectoryTagSampleformatArray(TIFF* tif, uint32* ndir, TIFFDirEntry* dir, uint16 tag, uint32 count, double* value)\n {\n@@ -946,7 +947,13 @@\n \tvoid* conv;\n \tuint32 i;\n \tint ok;\n-\tconv = _TIFFmalloc(count*sizeof(double));\n+\n+\tif (count == 0) {\n+\t\tTIFFErrorExt(tif->tif_clientdata, module, "Count must be greater than zero");\n+\t\treturn (0);\n+\t}\n+\n+\tconv = _TIFFmalloc(count * sizeof(double));\n \tif (conv == NULL)\n \t{\n \t\tTIFFErrorExt(tif->tif_clientdata, module, "Out of memory");\n@@ -956,55 +963,55 @@\n \tswitch (tif->tif_dir.td_sampleformat)\n \t{\n \t\tcase SAMPLEFORMAT_IEEEFP:\n-\t\t\tif (tif->tif_dir.td_bitspersample<=32)\n+\t\t\tif (tif->tif_dir.td_bitspersample <= 32)\n \t\t\t{\n \t\t\t\tfor (i = 0; i < count; ++i)\n \t\t\t\t\t((float*)conv)[i] = (float)value[i];\n-\t\t\t\tok = TIFFWriteDirectoryTagFloatArray(tif,ndir,dir,tag,count,(float*)conv);\n+\t\t\t\tok = TIFFWriteDirectoryTagFloatArray(tif, ndir, dir, tag, count, (float*)conv);\n \t\t\t}\n \t\t\telse\n \t\t\t{\n-\t\t\t\tok = TIFFWriteDirectoryTagDoubleArray(tif,ndir,dir,tag,count,value);\n+\t\t\t\tok = TIFFWriteDirectoryTagDoubleArray(tif, ndir, dir, tag, count, value);\n \t\t\t}\n \t\t\tbreak;\n \t\tcase SAMPLEFORMAT_INT:\n-\t\t\tif (tif->tif_dir.td_bitspersample<=8)\n+\t\t\tif (tif->tif_dir.td_bitspersample <= 8)\n \t\t\t{\n \t\t\t\tfor (i = 0; i < count; ++i)\n \t\t\t\t\t((int8*)conv)[i] = (int8)value[i];\n-\t\t\t\tok = TIFFWriteDirectoryTagSbyteArray(tif,ndir,dir,tag,count,(int8*)conv);\n+\t\t\t\tok = TIFFWriteDirectoryTagSbyteArray(tif, ndir, dir, tag, count, (int8*)conv);\n \t\t\t}\n-\t\t\telse if (tif->tif_dir.td_bitspersample<=16)\n+\t\t\telse if (tif->tif_dir.td_bitspersample <= 16)\n \t\t\t{\n \t\t\t\tfor (i = 0; i < count; ++i)\n \t\t\t\t\t((int16*)conv)[i] = (int16)value[i];\n-\t\t\t\tok = TIFFWriteDirectoryTagSshortArray(tif,ndir,dir,tag,count,(int16*)conv);\n+\t\t\t\tok = TIFFWriteDirectoryTagSshortArray(tif, ndir, dir, tag, count, (int16*)conv);\n \t\t\t}\n \t\t\telse\n \t\t\t{\n \t\t\t\tfor (i = 0; i < count; ++i)\n \t\t\t\t\t((int32*)conv)[i] = (int32)value[i];\n-\t\t\t\tok = TIFFWriteDirectoryTagSlongArray(tif,ndir,dir,tag,count,(int32*)conv);\n+\t\t\t\tok = TIFFWriteDirectoryTagSlongArray(tif, ndir, dir, tag, count, (int32*)conv);\n \t\t\t}\n \t\t\tbreak;\n \t\tcase SAMPLEFORMAT_UINT:\n-\t\t\tif (tif->tif_dir.td_bitspersample<=8)\n+\t\t\tif (tif->tif_dir.td_bitspersample <= 8)\n \t\t\t{\n \t\t\t\tfor (i = 0; i < count; ++i)\n \t\t\t\t\t((uint8*)conv)[i] = (uint8)value[i];\n-\t\t\t\tok = TIFFWriteDirectoryTagByteArray(tif,ndir,dir,tag,count,(uint8*)conv);\n+\t\t\t\tok = TIFFWriteDirectoryTagByteArray(tif, ndir, dir, tag, count, (uint8*)conv);\n \t\t\t}\n-\t\t\telse if (tif->tif_dir.td_bitspersample<=16)\n+\t\t\telse if (tif->tif_dir.td_bitspersample <= 16)\n \t\t\t{\n \t\t\t\tfor (i = 0; i < count; ++i)\n \t\t\t\t\t((uint16*)conv)[i] = (uint16)value[i];\n-\t\t\t\tok = TIFFWriteDirectoryTagShortArray(tif,ndir,dir,tag,count,(uint16*)conv);\n+\t\t\t\tok = TIFFWriteDirectoryTagShortArray(tif, ndir, dir, tag, count, (uint16*)conv);\n \t\t\t}\n \t\t\telse\n \t\t\t{\n \t\t\t\tfor (i = 0; i < count; ++i)\n \t\t\t\t\t((uint32*)conv)[i] = (uint32)value[i];\n-\t\t\t\tok = TIFFWriteDirectoryTagLongArray(tif,ndir,dir,tag,count,(uint32*)conv);\n+\t\t\t\tok = TIFFWriteDirectoryTagLongArray(tif, ndir, dir, tag, count, (uint32*)conv);\n \t\t\t}\n \t\t\tbreak;\n \t\tdefault:\n@@ -1015,6 +1022,7 @@\n \treturn (ok);\n }\n \n+\n #if 0\n static int\n TIFFWriteDirectoryTagSampleformatPerSample(TIFF* tif, uint32* ndir, TIFFDirEntry* dir, uint16 tag, double value)\n', 'id': 41, 'location': '/data/vulnloc/libtiff/CVE-2017-7600/src/libtiff/tif_dirwrite.c:949:9'}, {'diff': '@@ -939,6 +939,7 @@\n \treturn(0);\n }\n \n+\n static int\n TIFFWriteDirectoryTagSampleformatArray(TIFF* tif, uint32* ndir, TIFFDirEntry* dir, uint16 tag, uint32 count, double* value)\n {\n@@ -946,7 +947,13 @@\n \tvoid* conv;\n \tuint32 i;\n \tint ok;\n-\tconv = _TIFFmalloc(count*sizeof(double));\n+\n+\tif (count == 0) {\n+\t\tTIFFErrorExt(tif->tif_clientdata, module, "Count must be greater than zero");\n+\t\treturn (0);\n+\t}\n+\n+\tconv = _TIFFmalloc(count * sizeof(double));\n \tif (conv == NULL)\n \t{\n \t\tTIFFErrorExt(tif->tif_clientdata, module, "Out of memory");\n@@ -956,55 +963,55 @@\n \tswitch (tif->tif_dir.td_sampleformat)\n \t{\n \t\tcase SAMPLEFORMAT_IEEEFP:\n-\t\t\tif (tif->tif_dir.td_bitspersample<=32)\n+\t\t\tif (tif->tif_dir.td_bitspersample <= 32)\n \t\t\t{\n \t\t\t\tfor (i = 0; i < count; ++i)\n \t\t\t\t\t((float*)conv)[i] = (float)value[i];\n-\t\t\t\tok = TIFFWriteDirectoryTagFloatArray(tif,ndir,dir,tag,count,(float*)conv);\n+\t\t\t\tok = TIFFWriteDirectoryTagFloatArray(tif, ndir, dir, tag, count, (float*)conv);\n \t\t\t}\n \t\t\telse\n \t\t\t{\n-\t\t\t\tok = TIFFWriteDirectoryTagDoubleArray(tif,ndir,dir,tag,count,value);\n+\t\t\t\tok = TIFFWriteDirectoryTagDoubleArray(tif, ndir, dir, tag, count, value);\n \t\t\t}\n \t\t\tbreak;\n \t\tcase SAMPLEFORMAT_INT:\n-\t\t\tif (tif->tif_dir.td_bitspersample<=8)\n+\t\t\tif (tif->tif_dir.td_bitspersample <= 8)\n \t\t\t{\n \t\t\t\tfor (i = 0; i < count; ++i)\n \t\t\t\t\t((int8*)conv)[i] = (int8)value[i];\n-\t\t\t\tok = TIFFWriteDirectoryTagSbyteArray(tif,ndir,dir,tag,count,(int8*)conv);\n+\t\t\t\tok = TIFFWriteDirectoryTagSbyteArray(tif, ndir, dir, tag, count, (int8*)conv);\n \t\t\t}\n-\t\t\telse if (tif->tif_dir.td_bitspersample<=16)\n+\t\t\telse if (tif->tif_dir.td_bitspersample <= 16)\n \t\t\t{\n \t\t\t\tfor (i = 0; i < count; ++i)\n \t\t\t\t\t((int16*)conv)[i] = (int16)value[i];\n-\t\t\t\tok = TIFFWriteDirectoryTagSshortArray(tif,ndir,dir,tag,count,(int16*)conv);\n+\t\t\t\tok = TIFFWriteDirectoryTagSshortArray(tif, ndir, dir, tag, count, (int16*)conv);\n \t\t\t}\n \t\t\telse\n \t\t\t{\n \t\t\t\tfor (i = 0; i < count; ++i)\n \t\t\t\t\t((int32*)conv)[i] = (int32)value[i];\n-\t\t\t\tok = TIFFWriteDirectoryTagSlongArray(tif,ndir,dir,tag,count,(int32*)conv);\n+\t\t\t\tok = TIFFWriteDirectoryTagSlongArray(tif, ndir, dir, tag, count, (int32*)conv);\n \t\t\t}\n \t\t\tbreak;\n \t\tcase SAMPLEFORMAT_UINT:\n-\t\t\tif (tif->tif_dir.td_bitspersample<=8)\n+\t\t\tif (tif->tif_dir.td_bitspersample <= 8)\n \t\t\t{\n \t\t\t\tfor (i = 0; i < count; ++i)\n \t\t\t\t\t((uint8*)conv)[i] = (uint8)value[i];\n-\t\t\t\tok = TIFFWriteDirectoryTagByteArray(tif,ndir,dir,tag,count,(uint8*)conv);\n+\t\t\t\tok = TIFFWriteDirectoryTagByteArray(tif, ndir, dir, tag, count, (uint8*)conv);\n \t\t\t}\n-\t\t\telse if (tif->tif_dir.td_bitspersample<=16)\n+\t\t\telse if (tif->tif_dir.td_bitspersample <= 16)\n \t\t\t{\n \t\t\t\tfor (i = 0; i < count; ++i)\n \t\t\t\t\t((uint16*)conv)[i] = (uint16)value[i];\n-\t\t\t\tok = TIFFWriteDirectoryTagShortArray(tif,ndir,dir,tag,count,(uint16*)conv);\n+\t\t\t\tok = TIFFWriteDirectoryTagShortArray(tif, ndir, dir, tag, count, (uint16*)conv);\n \t\t\t}\n \t\t\telse\n \t\t\t{\n \t\t\t\tfor (i = 0; i < count; ++i)\n \t\t\t\t\t((uint32*)conv)[i] = (uint32)value[i];\n-\t\t\t\tok = TIFFWriteDirectoryTagLongArray(tif,ndir,dir,tag,count,(uint32*)conv);\n+\t\t\t\tok = TIFFWriteDirectoryTagLongArray(tif, ndir, dir, tag, count, (uint32*)conv);\n \t\t\t}\n \t\t\tbreak;\n \t\tdefault:\n@@ -1015,6 +1022,7 @@\n \treturn (ok);\n }\n \n+\n #if 0\n static int\n TIFFWriteDirectoryTagSampleformatPerSample(TIFF* tif, uint32* ndir, TIFFDirEntry* dir, uint16 tag, double value)\n', 'id': 42, 'location': '/data/vulnloc/libtiff/CVE-2017-7600/src/libtiff/tif_dirwrite.c:949:9'}, {'diff': '@@ -939,6 +939,7 @@\n \treturn(0);\n }\n \n+\n static int\n TIFFWriteDirectoryTagSampleformatArray(TIFF* tif, uint32* ndir, TIFFDirEntry* dir, uint16 tag, uint32 count, double* value)\n {\n@@ -946,6 +947,9 @@\n \tvoid* conv;\n \tuint32 i;\n \tint ok;\n+\tif (count == 0) {\n+\t\treturn 0; // Early exit if count is zero\n+\t}\n \tconv = _TIFFmalloc(count*sizeof(double));\n \tif (conv == NULL)\n \t{\n@@ -1015,6 +1019,7 @@\n \treturn (ok);\n }\n \n+\n #if 0\n static int\n TIFFWriteDirectoryTagSampleformatPerSample(TIFF* tif, uint32* ndir, TIFFDirEntry* dir, uint16 tag, double value)\n', 'id': 43, 'location': '/data/vulnloc/libtiff/CVE-2017-7600/src/libtiff/tif_dirwrite.c:949:9'}, {'diff': '@@ -939,6 +939,7 @@\n \treturn(0);\n }\n \n+\n static int\n TIFFWriteDirectoryTagSampleformatArray(TIFF* tif, uint32* ndir, TIFFDirEntry* dir, uint16 tag, uint32 count, double* value)\n {\n@@ -946,7 +947,13 @@\n \tvoid* conv;\n \tuint32 i;\n \tint ok;\n-\tconv = _TIFFmalloc(count*sizeof(double));\n+\n+\tif (count == 0) {\n+\t\tTIFFErrorExt(tif->tif_clientdata, module, "Count must be greater than zero");\n+\t\treturn (0);\n+\t}\n+\n+\tconv = _TIFFmalloc(count * sizeof(double));\n \tif (conv == NULL)\n \t{\n \t\tTIFFErrorExt(tif->tif_clientdata, module, "Out of memory");\n@@ -956,55 +963,55 @@\n \tswitch (tif->tif_dir.td_sampleformat)\n \t{\n \t\tcase SAMPLEFORMAT_IEEEFP:\n-\t\t\tif (tif->tif_dir.td_bitspersample<=32)\n+\t\t\tif (tif->tif_dir.td_bitspersample <= 32)\n \t\t\t{\n \t\t\t\tfor (i = 0; i < count; ++i)\n \t\t\t\t\t((float*)conv)[i] = (float)value[i];\n-\t\t\t\tok = TIFFWriteDirectoryTagFloatArray(tif,ndir,dir,tag,count,(float*)conv);\n+\t\t\t\tok = TIFFWriteDirectoryTagFloatArray(tif, ndir, dir, tag, count, (float*)conv);\n \t\t\t}\n \t\t\telse\n \t\t\t{\n-\t\t\t\tok = TIFFWriteDirectoryTagDoubleArray(tif,ndir,dir,tag,count,value);\n+\t\t\t\tok = TIFFWriteDirectoryTagDoubleArray(tif, ndir, dir, tag, count, value);\n \t\t\t}\n \t\t\tbreak;\n \t\tcase SAMPLEFORMAT_INT:\n-\t\t\tif (tif->tif_dir.td_bitspersample<=8)\n+\t\t\tif (tif->tif_dir.td_bitspersample <= 8)\n \t\t\t{\n \t\t\t\tfor (i = 0; i < count; ++i)\n \t\t\t\t\t((int8*)conv)[i] = (int8)value[i];\n-\t\t\t\tok = TIFFWriteDirectoryTagSbyteArray(tif,ndir,dir,tag,count,(int8*)conv);\n+\t\t\t\tok = TIFFWriteDirectoryTagSbyteArray(tif, ndir, dir, tag, count, (int8*)conv);\n \t\t\t}\n-\t\t\telse if (tif->tif_dir.td_bitspersample<=16)\n+\t\t\telse if (tif->tif_dir.td_bitspersample <= 16)\n \t\t\t{\n \t\t\t\tfor (i = 0; i < count; ++i)\n \t\t\t\t\t((int16*)conv)[i] = (int16)value[i];\n-\t\t\t\tok = TIFFWriteDirectoryTagSshortArray(tif,ndir,dir,tag,count,(int16*)conv);\n+\t\t\t\tok = TIFFWriteDirectoryTagSshortArray(tif, ndir, dir, tag, count, (int16*)conv);\n \t\t\t}\n \t\t\telse\n \t\t\t{\n \t\t\t\tfor (i = 0; i < count; ++i)\n \t\t\t\t\t((int32*)conv)[i] = (int32)value[i];\n-\t\t\t\tok = TIFFWriteDirectoryTagSlongArray(tif,ndir,dir,tag,count,(int32*)conv);\n+\t\t\t\tok = TIFFWriteDirectoryTagSlongArray(tif, ndir, dir, tag, count, (int32*)conv);\n \t\t\t}\n \t\t\tbreak;\n \t\tcase SAMPLEFORMAT_UINT:\n-\t\t\tif (tif->tif_dir.td_bitspersample<=8)\n+\t\t\tif (tif->tif_dir.td_bitspersample <= 8)\n \t\t\t{\n \t\t\t\tfor (i = 0; i < count; ++i)\n \t\t\t\t\t((uint8*)conv)[i] = (uint8)value[i];\n-\t\t\t\tok = TIFFWriteDirectoryTagByteArray(tif,ndir,dir,tag,count,(uint8*)conv);\n+\t\t\t\tok = TIFFWriteDirectoryTagByteArray(tif, ndir, dir, tag, count, (uint8*)conv);\n \t\t\t}\n-\t\t\telse if (tif->tif_dir.td_bitspersample<=16)\n+\t\t\telse if (tif->tif_dir.td_bitspersample <= 16)\n \t\t\t{\n \t\t\t\tfor (i = 0; i < count; ++i)\n \t\t\t\t\t((uint16*)conv)[i] = (uint16)value[i];\n-\t\t\t\tok = TIFFWriteDirectoryTagShortArray(tif,ndir,dir,tag,count,(uint16*)conv);\n+\t\t\t\tok = TIFFWriteDirectoryTagShortArray(tif, ndir, dir, tag, count, (uint16*)conv);\n \t\t\t}\n \t\t\telse\n \t\t\t{\n \t\t\t\tfor (i = 0; i < count; ++i)\n \t\t\t\t\t((uint32*)conv)[i] = (uint32)value[i];\n-\t\t\t\tok = TIFFWriteDirectoryTagLongArray(tif,ndir,dir,tag,count,(uint32*)conv);\n+\t\t\t\tok = TIFFWriteDirectoryTagLongArray(tif, ndir, dir, tag, count, (uint32*)conv);\n \t\t\t}\n \t\t\tbreak;\n \t\tdefault:\n@@ -1015,6 +1022,7 @@\n \treturn (ok);\n }\n \n+\n #if 0\n static int\n TIFFWriteDirectoryTagSampleformatPerSample(TIFF* tif, uint32* ndir, TIFFDirEntry* dir, uint16 tag, double value)\n', 'id': 44, 'location': '/data/vulnloc/libtiff/CVE-2017-7600/src/libtiff/tif_dirwrite.c:949:9'}, {'diff': '@@ -359,6 +359,7 @@\n \treturn TIFFWriteDirectory( tif );\n }\n \n+\n static int\n TIFFWriteDirectorySec(TIFF* tif, int isimage, int imagedone, uint64* pdiroff)\n {\n@@ -371,13 +372,8 @@\n \tif (tif->tif_mode == O_RDONLY)\n \t\treturn (1);\n \n-        _TIFFFillStriles( tif );\n-        \n-\t/*\n-\t * Clear write state so that subsequent images with\n-\t * different characteristics get the right buffers\n-\t * setup for them.\n-\t */\n+\t_TIFFFillStriles( tif );\n+\t\n \tif (imagedone)\n \t{\n \t\tif (tif->tif_flags & TIFF_POSTENCODE)\n@@ -390,23 +386,15 @@\n \t\t\t\treturn (0);\n \t\t\t}\n \t\t}\n-\t\t(*tif->tif_close)(tif);       /* shutdown encoder */\n-\t\t/*\n-\t\t * Flush any data that might have been written\n-\t\t * by the compression close+cleanup routines.  But\n-                 * be careful not to write stuff if we didn\'t add data\n-                 * in the previous steps as the "rawcc" data may well be\n-                 * a previously read tile/strip in mixed read/write mode.\n-\t\t */\n-\t\tif (tif->tif_rawcc > 0 \n-\t\t    && (tif->tif_flags & TIFF_BEENWRITING) != 0 )\n-\t\t{\n-\t\t    if( !TIFFFlushData1(tif) )\n-                    {\n-\t\t\tTIFFErrorExt(tif->tif_clientdata, module,\n-\t\t\t    "Error flushing data before directory write");\n-\t\t\treturn (0);\n-                    }\n+\t\t(*tif->tif_close)(tif);       \n+\t\tif (tif->tif_rawcc > 0 && (tif->tif_flags & TIFF_BEENWRITING) != 0 )\n+\t\t{\n+\t\t\tif (!TIFFFlushData1(tif))\n+\t\t\t{\n+\t\t\t\tTIFFErrorExt(tif->tif_clientdata, module,\n+\t\t\t\t    "Error flushing data before directory write");\n+\t\t\t\treturn (0);\n+\t\t\t}\n \t\t}\n \t\tif ((tif->tif_flags & TIFF_MYBUFFER) && tif->tif_rawdata)\n \t\t{\n@@ -414,287 +402,275 @@\n \t\t\ttif->tif_rawdata = NULL;\n \t\t\ttif->tif_rawcc = 0;\n \t\t\ttif->tif_rawdatasize = 0;\n-                        tif->tif_rawdataoff = 0;\n-                        tif->tif_rawdataloaded = 0;\n+\t\t\ttif->tif_rawdataoff = 0;\n+\t\t\ttif->tif_rawdataloaded = 0;\n \t\t}\n \t\ttif->tif_flags &= ~(TIFF_BEENWRITING|TIFF_BUFFERSETUP);\n \t}\n-\tdir=NULL;\n-\tdirmem=NULL;\n-\tdirsize=0;\n+\tdir = NULL;\n+\tdirmem = NULL;\n+\tdirsize = 0;\n \twhile (1)\n \t{\n-\t\tndir=0;\n+\t\tndir = 0;\n \t\tif (isimage)\n \t\t{\n-\t\t\tif (TIFFFieldSet(tif,FIELD_IMAGEDIMENSIONS))\n+\t\t\tif (TIFFFieldSet(tif, FIELD_IMAGEDIMENSIONS))\n \t\t\t{\n-\t\t\t\tif (!TIFFWriteDirectoryTagShortLong(tif,&ndir,dir,TIFFTAG_IMAGEWIDTH,tif->tif_dir.td_imagewidth))\n+\t\t\t\tif (!TIFFWriteDirectoryTagShortLong(tif, &ndir, dir, TIFFTAG_IMAGEWIDTH, tif->tif_dir.td_imagewidth))\n \t\t\t\t\tgoto bad;\n-\t\t\t\tif (!TIFFWriteDirectoryTagShortLong(tif,&ndir,dir,TIFFTAG_IMAGELENGTH,tif->tif_dir.td_imagelength))\n+\t\t\t\tif (!TIFFWriteDirectoryTagShortLong(tif, &ndir, dir, TIFFTAG_IMAGELENGTH, tif->tif_dir.td_imagelength))\n \t\t\t\t\tgoto bad;\n \t\t\t}\n-\t\t\tif (TIFFFieldSet(tif,FIELD_TILEDIMENSIONS))\n+\t\t\tif (TIFFFieldSet(tif, FIELD_TILEDIMENSIONS))\n \t\t\t{\n-\t\t\t\tif (!TIFFWriteDirectoryTagShortLong(tif,&ndir,dir,TIFFTAG_TILEWIDTH,tif->tif_dir.td_tilewidth))\n+\t\t\t\tif (!TIFFWriteDirectoryTagShortLong(tif, &ndir, dir, TIFFTAG_TILEWIDTH, tif->tif_dir.td_tilewidth))\n \t\t\t\t\tgoto bad;\n-\t\t\t\tif (!TIFFWriteDirectoryTagShortLong(tif,&ndir,dir,TIFFTAG_TILELENGTH,tif->tif_dir.td_tilelength))\n+\t\t\t\tif (!TIFFWriteDirectoryTagShortLong(tif, &ndir, dir, TIFFTAG_TILELENGTH, tif->tif_dir.td_tilelength))\n \t\t\t\t\tgoto bad;\n \t\t\t}\n-\t\t\tif (TIFFFieldSet(tif,FIELD_RESOLUTION))\n+\t\t\tif (TIFFFieldSet(tif, FIELD_RESOLUTION))\n \t\t\t{\n-\t\t\t\tif (!TIFFWriteDirectoryTagRational(tif,&ndir,dir,TIFFTAG_XRESOLUTION,tif->tif_dir.td_xresolution))\n+\t\t\t\tif (!TIFFWriteDirectoryTagRational(tif, &ndir, dir, TIFFTAG_XRESOLUTION, tif->tif_dir.td_xresolution))\n \t\t\t\t\tgoto bad;\n-\t\t\t\tif (!TIFFWriteDirectoryTagRational(tif,&ndir,dir,TIFFTAG_YRESOLUTION,tif->tif_dir.td_yresolution))\n+\t\t\t\tif (!TIFFWriteDirectoryTagRational(tif, &ndir, dir, TIFFTAG_YRESOLUTION, tif->tif_dir.td_yresolution))\n \t\t\t\t\tgoto bad;\n \t\t\t}\n-\t\t\tif (TIFFFieldSet(tif,FIELD_POSITION))\n+\t\t\tif (TIFFFieldSet(tif, FIELD_POSITION))\n \t\t\t{\n-\t\t\t\tif (!TIFFWriteDirectoryTagRational(tif,&ndir,dir,TIFFTAG_XPOSITION,tif->tif_dir.td_xposition))\n+\t\t\t\tif (!TIFFWriteDirectoryTagRational(tif, &ndir, dir, TIFFTAG_XPOSITION, tif->tif_dir.td_xposition))\n \t\t\t\t\tgoto bad;\n-\t\t\t\tif (!TIFFWriteDirectoryTagRational(tif,&ndir,dir,TIFFTAG_YPOSITION,tif->tif_dir.td_yposition))\n+\t\t\t\tif (!TIFFWriteDirectoryTagRational(tif, &ndir, dir, TIFFTAG_YPOSITION, tif->tif_dir.td_yposition))\n \t\t\t\t\tgoto bad;\n \t\t\t}\n-\t\t\tif (TIFFFieldSet(tif,FIELD_SUBFILETYPE))\n+\t\t\tif (TIFFFieldSet(tif, FIELD_SUBFILETYPE))\n \t\t\t{\n-\t\t\t\tif (!TIFFWriteDirectoryTagLong(tif,&ndir,dir,TIFFTAG_SUBFILETYPE,tif->tif_dir.td_subfiletype))\n+\t\t\t\tif (!TIFFWriteDirectoryTagLong(tif, &ndir, dir, TIFFTAG_SUBFILETYPE, tif->tif_dir.td_subfiletype))\n \t\t\t\t\tgoto bad;\n \t\t\t}\n-\t\t\tif (TIFFFieldSet(tif,FIELD_BITSPERSAMPLE))\n+\t\t\tif (TIFFFieldSet(tif, FIELD_BITSPERSAMPLE))\n \t\t\t{\n-\t\t\t\tif (!TIFFWriteDirectoryTagShortPerSample(tif,&ndir,dir,TIFFTAG_BITSPERSAMPLE,tif->tif_dir.td_bitspersample))\n+\t\t\t\tif (!TIFFWriteDirectoryTagShortPerSample(tif, &ndir, dir, TIFFTAG_BITSPERSAMPLE, tif->tif_dir.td_bitspersample))\n \t\t\t\t\tgoto bad;\n \t\t\t}\n-\t\t\tif (TIFFFieldSet(tif,FIELD_COMPRESSION))\n+\t\t\tif (TIFFFieldSet(tif, FIELD_COMPRESSION))\n \t\t\t{\n-\t\t\t\tif (!TIFFWriteDirectoryTagShort(tif,&ndir,dir,TIFFTAG_COMPRESSION,tif->tif_dir.td_compression))\n+\t\t\t\tif (!TIFFWriteDirectoryTagShort(tif, &ndir, dir, TIFFTAG_COMPRESSION, tif->tif_dir.td_compression))\n \t\t\t\t\tgoto bad;\n \t\t\t}\n-\t\t\tif (TIFFFieldSet(tif,FIELD_PHOTOMETRIC))\n+\t\t\tif (TIFFFieldSet(tif, FIELD_PHOTOMETRIC))\n \t\t\t{\n-\t\t\t\tif (!TIFFWriteDirectoryTagShort(tif,&ndir,dir,TIFFTAG_PHOTOMETRIC,tif->tif_dir.td_photometric))\n+\t\t\t\tif (!TIFFWriteDirectoryTagShort(tif, &ndir, dir, TIFFTAG_PHOTOMETRIC, tif->tif_dir.td_photometric))\n \t\t\t\t\tgoto bad;\n \t\t\t}\n-\t\t\tif (TIFFFieldSet(tif,FIELD_THRESHHOLDING))\n+\t\t\tif (TIFFFieldSet(tif, FIELD_THRESHHOLDING))\n \t\t\t{\n-\t\t\t\tif (!TIFFWriteDirectoryTagShort(tif,&ndir,dir,TIFFTAG_THRESHHOLDING,tif->tif_dir.td_threshholding))\n+\t\t\t\tif (!TIFFWriteDirectoryTagShort(tif, &ndir, dir, TIFFTAG_THRESHHOLDING, tif->tif_dir.td_threshholding))\n \t\t\t\t\tgoto bad;\n \t\t\t}\n-\t\t\tif (TIFFFieldSet(tif,FIELD_FILLORDER))\n+\t\t\tif (TIFFFieldSet(tif, FIELD_FILLORDER))\n \t\t\t{\n-\t\t\t\tif (!TIFFWriteDirectoryTagShort(tif,&ndir,dir,TIFFTAG_FILLORDER,tif->tif_dir.td_fillorder))\n+\t\t\t\tif (!TIFFWriteDirectoryTagShort(tif, &ndir, dir, TIFFTAG_FILLORDER, tif->tif_dir.td_fillorder))\n \t\t\t\t\tgoto bad;\n \t\t\t}\n-\t\t\tif (TIFFFieldSet(tif,FIELD_ORIENTATION))\n+\t\t\tif (TIFFFieldSet(tif, FIELD_ORIENTATION))\n \t\t\t{\n-\t\t\t\tif (!TIFFWriteDirectoryTagShort(tif,&ndir,dir,TIFFTAG_ORIENTATION,tif->tif_dir.td_orientation))\n+\t\t\t\tif (!TIFFWriteDirectoryTagShort(tif, &ndir, dir, TIFFTAG_ORIENTATION, tif->tif_dir.td_orientation))\n \t\t\t\t\tgoto bad;\n \t\t\t}\n-\t\t\tif (TIFFFieldSet(tif,FIELD_SAMPLESPERPIXEL))\n+\t\t\tif (TIFFFieldSet(tif, FIELD_SAMPLESPERPIXEL))\n \t\t\t{\n-\t\t\t\tif (!TIFFWriteDirectoryTagShort(tif,&ndir,dir,TIFFTAG_SAMPLESPERPIXEL,tif->tif_dir.td_samplesperpixel))\n+\t\t\t\tif (!TIFFWriteDirectoryTagShort(tif, &ndir, dir, TIFFTAG_SAMPLESPERPIXEL, tif->tif_dir.td_samplesperpixel))\n \t\t\t\t\tgoto bad;\n \t\t\t}\n-\t\t\tif (TIFFFieldSet(tif,FIELD_ROWSPERSTRIP))\n+\t\t\tif (TIFFFieldSet(tif, FIELD_ROWSPERSTRIP))\n \t\t\t{\n-\t\t\t\tif (!TIFFWriteDirectoryTagShortLong(tif,&ndir,dir,TIFFTAG_ROWSPERSTRIP,tif->tif_dir.td_rowsperstrip))\n+\t\t\t\tif (!TIFFWriteDirectoryTagShortLong(tif, &ndir, dir, TIFFTAG_ROWSPERSTRIP, tif->tif_dir.td_rowsperstrip))\n \t\t\t\t\tgoto bad;\n \t\t\t}\n-\t\t\tif (TIFFFieldSet(tif,FIELD_MINSAMPLEVALUE))\n+\t\t\tif (TIFFFieldSet(tif, FIELD_MINSAMPLEVALUE))\n \t\t\t{\n-\t\t\t\tif (!TIFFWriteDirectoryTagShortPerSample(tif,&ndir,dir,TIFFTAG_MINSAMPLEVALUE,tif->tif_dir.td_minsamplevalue))\n+\t\t\t\tif (!TIFFWriteDirectoryTagShortPerSample(tif, &ndir, dir, TIFFTAG_MINSAMPLEVALUE, tif->tif_dir.td_minsamplevalue))\n \t\t\t\t\tgoto bad;\n \t\t\t}\n-\t\t\tif (TIFFFieldSet(tif,FIELD_MAXSAMPLEVALUE))\n+\t\t\tif (TIFFFieldSet(tif, FIELD_MAXSAMPLEVALUE))\n \t\t\t{\n-\t\t\t\tif (!TIFFWriteDirectoryTagShortPerSample(tif,&ndir,dir,TIFFTAG_MAXSAMPLEVALUE,tif->tif_dir.td_maxsamplevalue))\n+\t\t\t\tif (!TIFFWriteDirectoryTagShortPerSample(tif, &ndir, dir, TIFFTAG_MAXSAMPLEVALUE, tif->tif_dir.td_maxsamplevalue))\n \t\t\t\t\tgoto bad;\n \t\t\t}\n-\t\t\tif (TIFFFieldSet(tif,FIELD_PLANARCONFIG))\n+\t\t\tif (TIFFFieldSet(tif, FIELD_PLANARCONFIG))\n \t\t\t{\n-\t\t\t\tif (!TIFFWriteDirectoryTagShort(tif,&ndir,dir,TIFFTAG_PLANARCONFIG,tif->tif_dir.td_planarconfig))\n+\t\t\t\tif (!TIFFWriteDirectoryTagShort(tif, &ndir, dir, TIFFTAG_PLANARCONFIG, tif->tif_dir.td_planarconfig))\n \t\t\t\t\tgoto bad;\n \t\t\t}\n-\t\t\tif (TIFFFieldSet(tif,FIELD_RESOLUTIONUNIT))\n+\t\t\tif (TIFFFieldSet(tif, FIELD_RESOLUTIONUNIT))\n \t\t\t{\n-\t\t\t\tif (!TIFFWriteDirectoryTagShort(tif,&ndir,dir,TIFFTAG_RESOLUTIONUNIT,tif->tif_dir.td_resolutionunit))\n+\t\t\t\tif (!TIFFWriteDirectoryTagShort(tif, &ndir, dir, TIFFTAG_RESOLUTIONUNIT, tif->tif_dir.td_resolutionunit))\n \t\t\t\t\tgoto bad;\n \t\t\t}\n-\t\t\tif (TIFFFieldSet(tif,FIELD_PAGENUMBER))\n+\t\t\tif (TIFFFieldSet(tif, FIELD_PAGENUMBER))\n \t\t\t{\n-\t\t\t\tif (!TIFFWriteDirectoryTagShortArray(tif,&ndir,dir,TIFFTAG_PAGENUMBER,2,&tif->tif_dir.td_pagenumber[0]))\n+\t\t\t\tif (!TIFFWriteDirectoryTagShortArray(tif, &ndir, dir, TIFFTAG_PAGENUMBER, 2, &tif->tif_dir.td_pagenumber[0]))\n \t\t\t\t\tgoto bad;\n \t\t\t}\n-\t\t\tif (TIFFFieldSet(tif,FIELD_STRIPBYTECOUNTS))\n+\t\t\tif (TIFFFieldSet(tif, FIELD_STRIPBYTECOUNTS))\n \t\t\t{\n \t\t\t\tif (!isTiled(tif))\n \t\t\t\t{\n-\t\t\t\t\tif (!TIFFWriteDirectoryTagLongLong8Array(tif,&ndir,dir,TIFFTAG_STRIPBYTECOUNTS,tif->tif_dir.td_nstrips,tif->tif_dir.td_stripbytecount))\n+\t\t\t\t\tif (!TIFFWriteDirectoryTagLongLong8Array(tif, &ndir, dir, TIFFTAG_STRIPBYTECOUNTS, tif->tif_dir.td_nstrips, tif->tif_dir.td_stripbytecount))\n \t\t\t\t\t\tgoto bad;\n \t\t\t\t}\n \t\t\t\telse\n \t\t\t\t{\n-\t\t\t\t\tif (!TIFFWriteDirectoryTagLongLong8Array(tif,&ndir,dir,TIFFTAG_TILEBYTECOUNTS,tif->tif_dir.td_nstrips,tif->tif_dir.td_stripbytecount))\n+\t\t\t\t\tif (!TIFFWriteDirectoryTagLongLong8Array(tif, &ndir, dir, TIFFTAG_TILEBYTECOUNTS, tif->tif_dir.td_nstrips, tif->tif_dir.td_stripbytecount))\n \t\t\t\t\t\tgoto bad;\n \t\t\t\t}\n \t\t\t}\n-\t\t\tif (TIFFFieldSet(tif,FIELD_STRIPOFFSETS))\n+\t\t\tif (TIFFFieldSet(tif, FIELD_STRIPOFFSETS))\n \t\t\t{\n \t\t\t\tif (!isTiled(tif))\n \t\t\t\t{\n-                    /* td_stripoffset might be NULL in an odd OJPEG case. See\n-                     *  tif_dirread.c around line 3634.\n-                     * XXX: OJPEG hack.\n-                     * If a) compression is OJPEG, b) it\'s not a tiled TIFF,\n-                     * and c) the number of strips is 1,\n-                     * then we tolerate the absence of stripoffsets tag,\n-                     * because, presumably, all required data is in the\n-                     * JpegInterchangeFormat stream.\n-                     * We can get here when using tiffset on such a file.\n-                     * See http://bugzilla.maptools.org/show_bug.cgi?id=2500\n-                    */\n-                    if (tif->tif_dir.td_stripoffset != NULL &&\n-                        !TIFFWriteDirectoryTagLongLong8Array(tif,&ndir,dir,TIFFTAG_STRIPOFFSETS,tif->tif_dir.td_nstrips,tif->tif_dir.td_stripoffset))\n-                        goto bad;\n+\t\t\t\t\tif (tif->tif_dir.td_stripoffset != NULL && !TIFFWriteDirectoryTagLongLong8Array(tif, &ndir, dir, TIFFTAG_STRIPOFFSETS, tif->tif_dir.td_nstrips, tif->tif_dir.td_stripoffset))\n+\t\t\t\t\t\tgoto bad;\n \t\t\t\t}\n \t\t\t\telse\n \t\t\t\t{\n-\t\t\t\t\tif (!TIFFWriteDirectoryTagLongLong8Array(tif,&ndir,dir,TIFFTAG_TILEOFFSETS,tif->tif_dir.td_nstrips,tif->tif_dir.td_stripoffset))\n+\t\t\t\t\tif (!TIFFWriteDirectoryTagLongLong8Array(tif, &ndir, dir, TIFFTAG_TILEOFFSETS, tif->tif_dir.td_nstrips, tif->tif_dir.td_stripoffset))\n \t\t\t\t\t\tgoto bad;\n \t\t\t\t}\n \t\t\t}\n-\t\t\tif (TIFFFieldSet(tif,FIELD_COLORMAP))\n+\t\t\tif (TIFFFieldSet(tif, FIELD_COLORMAP))\n \t\t\t{\n-\t\t\t\tif (!TIFFWriteDirectoryTagColormap(tif,&ndir,dir))\n+\t\t\t\tif (!TIFFWriteDirectoryTagColormap(tif, &ndir, dir))\n \t\t\t\t\tgoto bad;\n \t\t\t}\n-\t\t\tif (TIFFFieldSet(tif,FIELD_EXTRASAMPLES))\n+\t\t\tif (TIFFFieldSet(tif, FIELD_EXTRASAMPLES))\n \t\t\t{\n \t\t\t\tif (tif->tif_dir.td_extrasamples)\n \t\t\t\t{\n \t\t\t\t\tuint16 na;\n \t\t\t\t\tuint16* nb;\n-\t\t\t\t\tTIFFGetFieldDefaulted(tif,TIFFTAG_EXTRASAMPLES,&na,&nb);\n-\t\t\t\t\tif (!TIFFWriteDirectoryTagShortArray(tif,&ndir,dir,TIFFTAG_EXTRASAMPLES,na,nb))\n+\t\t\t\t\tTIFFGetFieldDefaulted(tif, TIFFTAG_EXTRASAMPLES, &na, &nb);\n+\t\t\t\t\tif (!TIFFWriteDirectoryTagShortArray(tif, &ndir, dir, TIFFTAG_EXTRASAMPLES, na, nb))\n \t\t\t\t\t\tgoto bad;\n \t\t\t\t}\n \t\t\t}\n-\t\t\tif (TIFFFieldSet(tif,FIELD_SAMPLEFORMAT))\n+\t\t\tif (TIFFFieldSet(tif, FIELD_SAMPLEFORMAT))\n \t\t\t{\n-\t\t\t\tif (!TIFFWriteDirectoryTagShortPerSample(tif,&ndir,dir,TIFFTAG_SAMPLEFORMAT,tif->tif_dir.td_sampleformat))\n+\t\t\t\tif (!TIFFWriteDirectoryTagShortPerSample(tif, &ndir, dir, TIFFTAG_SAMPLEFORMAT, tif->tif_dir.td_sampleformat))\n \t\t\t\t\tgoto bad;\n \t\t\t}\n-\t\t\tif (TIFFFieldSet(tif,FIELD_SMINSAMPLEVALUE))\n+\t\t\tif (TIFFFieldSet(tif, FIELD_SMINSAMPLEVALUE))\n \t\t\t{\n-\t\t\t\tif (!TIFFWriteDirectoryTagSampleformatArray(tif,&ndir,dir,TIFFTAG_SMINSAMPLEVALUE,tif->tif_dir.td_samplesperpixel,tif->tif_dir.td_sminsamplevalue))\n+\t\t\t\tif (!TIFFWriteDirectoryTagSampleformatArray(tif, &ndir, dir, TIFFTAG_SMINSAMPLEVALUE, tif->tif_dir.td_samplesperpixel, tif->tif_dir.td_sminsamplevalue))\n \t\t\t\t\tgoto bad;\n \t\t\t}\n-\t\t\tif (TIFFFieldSet(tif,FIELD_SMAXSAMPLEVALUE))\n+\t\t\tif (TIFFFieldSet(tif, FIELD_SMAXSAMPLEVALUE))\n \t\t\t{\n-\t\t\t\tif (!TIFFWriteDirectoryTagSampleformatArray(tif,&ndir,dir,TIFFTAG_SMAXSAMPLEVALUE,tif->tif_dir.td_samplesperpixel,tif->tif_dir.td_smaxsamplevalue))\n+\t\t\t\tif (!TIFFWriteDirectoryTagSampleformatArray(tif, &ndir, dir, TIFFTAG_SMAXSAMPLEVALUE, tif->tif_dir.td_samplesperpixel, tif->tif_dir.td_smaxsamplevalue))\n \t\t\t\t\tgoto bad;\n \t\t\t}\n-\t\t\tif (TIFFFieldSet(tif,FIELD_IMAGEDEPTH))\n+\t\t\tif (TIFFFieldSet(tif, FIELD_IMAGEDEPTH))\n \t\t\t{\n-\t\t\t\tif (!TIFFWriteDirectoryTagLong(tif,&ndir,dir,TIFFTAG_IMAGEDEPTH,tif->tif_dir.td_imagedepth))\n+\t\t\t\tif (!TIFFWriteDirectoryTagLong(tif, &ndir, dir, TIFFTAG_IMAGEDEPTH, tif->tif_dir.td_imagedepth))\n \t\t\t\t\tgoto bad;\n \t\t\t}\n-\t\t\tif (TIFFFieldSet(tif,FIELD_TILEDEPTH))\n+\t\t\tif (TIFFFieldSet(tif, FIELD_TILEDEPTH))\n \t\t\t{\n-\t\t\t\tif (!TIFFWriteDirectoryTagLong(tif,&ndir,dir,TIFFTAG_TILEDEPTH,tif->tif_dir.td_tiledepth))\n+\t\t\t\tif (!TIFFWriteDirectoryTagLong(tif, &ndir, dir, TIFFTAG_TILEDEPTH, tif->tif_dir.td_tiledepth))\n \t\t\t\t\tgoto bad;\n \t\t\t}\n-\t\t\tif (TIFFFieldSet(tif,FIELD_HALFTONEHINTS))\n+\t\t\tif (TIFFFieldSet(tif, FIELD_HALFTONEHINTS))\n \t\t\t{\n-\t\t\t\tif (!TIFFWriteDirectoryTagShortArray(tif,&ndir,dir,TIFFTAG_HALFTONEHINTS,2,&tif->tif_dir.td_halftonehints[0]))\n+\t\t\t\tif (!TIFFWriteDirectoryTagShortArray(tif, &ndir, dir, TIFFTAG_HALFTONEHINTS, 2, &tif->tif_dir.td_halftonehints[0]))\n \t\t\t\t\tgoto bad;\n \t\t\t}\n-\t\t\tif (TIFFFieldSet(tif,FIELD_YCBCRSUBSAMPLING))\n+\t\t\tif (TIFFFieldSet(tif, FIELD_YCBCRSUBSAMPLING))\n \t\t\t{\n-\t\t\t\tif (!TIFFWriteDirectoryTagShortArray(tif,&ndir,dir,TIFFTAG_YCBCRSUBSAMPLING,2,&tif->tif_dir.td_ycbcrsubsampling[0]))\n+\t\t\t\tif (!TIFFWriteDirectoryTagShortArray(tif, &ndir, dir, TIFFTAG_YCBCRSUBSAMPLING, 2, &tif->tif_dir.td_ycbcrsubsampling[0]))\n \t\t\t\t\tgoto bad;\n \t\t\t}\n-\t\t\tif (TIFFFieldSet(tif,FIELD_YCBCRPOSITIONING))\n+\t\t\tif (TIFFFieldSet(tif, FIELD_YCBCRPOSITIONING))\n \t\t\t{\n-\t\t\t\tif (!TIFFWriteDirectoryTagShort(tif,&ndir,dir,TIFFTAG_YCBCRPOSITIONING,tif->tif_dir.td_ycbcrpositioning))\n+\t\t\t\tif (!TIFFWriteDirectoryTagShort(tif, &ndir, dir, TIFFTAG_YCBCRPOSITIONING, tif->tif_dir.td_ycbcrpositioning))\n \t\t\t\t\tgoto bad;\n \t\t\t}\n-\t\t\tif (TIFFFieldSet(tif,FIELD_REFBLACKWHITE))\n+\t\t\tif (TIFFFieldSet(tif, FIELD_REFBLACKWHITE))\n \t\t\t{\n-\t\t\t\tif (!TIFFWriteDirectoryTagRationalArray(tif,&ndir,dir,TIFFTAG_REFERENCEBLACKWHITE,6,tif->tif_dir.td_refblackwhite))\n+\t\t\t\tif (!TIFFWriteDirectoryTagRationalArray(tif, &ndir, dir, TIFFTAG_REFERENCEBLACKWHITE, 6, tif->tif_dir.td_refblackwhite))\n \t\t\t\t\tgoto bad;\n \t\t\t}\n-\t\t\tif (TIFFFieldSet(tif,FIELD_TRANSFERFUNCTION))\n+\t\t\tif (TIFFFieldSet(tif, FIELD_TRANSFERFUNCTION))\n \t\t\t{\n-\t\t\t\tif (!TIFFWriteDirectoryTagTransferfunction(tif,&ndir,dir))\n+\t\t\t\tif (!TIFFWriteDirectoryTagTransferfunction(tif, &ndir, dir))\n \t\t\t\t\tgoto bad;\n \t\t\t}\n-\t\t\tif (TIFFFieldSet(tif,FIELD_INKNAMES))\n+\t\t\tif (TIFFFieldSet(tif, FIELD_INKNAMES))\n \t\t\t{\n-\t\t\t\tif (!TIFFWriteDirectoryTagAscii(tif,&ndir,dir,TIFFTAG_INKNAMES,tif->tif_dir.td_inknameslen,tif->tif_dir.td_inknames))\n+\t\t\t\tif (!TIFFWriteDirectoryTagAscii(tif, &ndir, dir, TIFFTAG_INKNAMES, tif->tif_dir.td_inknameslen, tif->tif_dir.td_inknames))\n \t\t\t\t\tgoto bad;\n \t\t\t}\n-\t\t\tif (TIFFFieldSet(tif,FIELD_SUBIFD))\n+\t\t\tif (TIFFFieldSet(tif, FIELD_SUBIFD))\n \t\t\t{\n-\t\t\t\tif (!TIFFWriteDirectoryTagSubifd(tif,&ndir,dir))\n+\t\t\t\tif (!TIFFWriteDirectoryTagSubifd(tif, &ndir, dir))\n \t\t\t\t\tgoto bad;\n \t\t\t}\n \t\t\t{\n \t\t\t\tuint32 n;\n-\t\t\t\tfor (n=0; n<tif->tif_nfields; n++) {\n+\t\t\t\tfor (n = 0; n < tif->tif_nfields; n++) {\n \t\t\t\t\tconst TIFFField* o;\n \t\t\t\t\to = tif->tif_fields[n];\n-\t\t\t\t\tif ((o->field_bit>=FIELD_CODEC)&&(TIFFFieldSet(tif,o->field_bit)))\n+\t\t\t\t\tif ((o->field_bit >= FIELD_CODEC) && (TIFFFieldSet(tif, o->field_bit)))\n \t\t\t\t\t{\n \t\t\t\t\t\tswitch (o->get_field_type)\n \t\t\t\t\t\t{\n \t\t\t\t\t\t\tcase TIFF_SETGET_ASCII:\n-\t\t\t\t\t\t\t\t{\n-\t\t\t\t\t\t\t\t\tuint32 pa;\n-\t\t\t\t\t\t\t\t\tchar* pb;\n-\t\t\t\t\t\t\t\t\tassert(o->field_type==TIFF_ASCII);\n-\t\t\t\t\t\t\t\t\tassert(o->field_readcount==TIFF_VARIABLE);\n-\t\t\t\t\t\t\t\t\tassert(o->field_passcount==0);\n-\t\t\t\t\t\t\t\t\tTIFFGetField(tif,o->field_tag,&pb);\n-\t\t\t\t\t\t\t\t\tpa=(uint32)(strlen(pb));\n-\t\t\t\t\t\t\t\t\tif (!TIFFWriteDirectoryTagAscii(tif,&ndir,dir,(uint16)o->field_tag,pa,pb))\n-\t\t\t\t\t\t\t\t\t\tgoto bad;\n-\t\t\t\t\t\t\t\t}\n-\t\t\t\t\t\t\t\tbreak;\n+\t\t\t\t\t\t\t{\n+\t\t\t\t\t\t\t\tuint32 pa;\n+\t\t\t\t\t\t\t\tchar* pb;\n+\t\t\t\t\t\t\t\tassert(o->field_type == TIFF_ASCII);\n+\t\t\t\t\t\t\t\tassert(o->field_readcount == TIFF_VARIABLE);\n+\t\t\t\t\t\t\t\tassert(o->field_passcount == 0);\n+\t\t\t\t\t\t\t\tTIFFGetField(tif, o->field_tag, &pb);\n+\t\t\t\t\t\t\t\tpa = (uint32)(strlen(pb));\n+\t\t\t\t\t\t\t\tif (!TIFFWriteDirectoryTagAscii(tif, &ndir, dir, (uint16)o->field_tag, pa, pb))\n+\t\t\t\t\t\t\t\t\tgoto bad;\n+\t\t\t\t\t\t\t}\n+\t\t\t\t\t\t\tbreak;\n \t\t\t\t\t\t\tcase TIFF_SETGET_UINT16:\n-\t\t\t\t\t\t\t\t{\n-\t\t\t\t\t\t\t\t\tuint16 p;\n-\t\t\t\t\t\t\t\t\tassert(o->field_type==TIFF_SHORT);\n-\t\t\t\t\t\t\t\t\tassert(o->field_readcount==1);\n-\t\t\t\t\t\t\t\t\tassert(o->field_passcount==0);\n-\t\t\t\t\t\t\t\t\tTIFFGetField(tif,o->field_tag,&p);\n-\t\t\t\t\t\t\t\t\tif (!TIFFWriteDirectoryTagShort(tif,&ndir,dir,(uint16)o->field_tag,p))\n-\t\t\t\t\t\t\t\t\t\tgoto bad;\n-\t\t\t\t\t\t\t\t}\n-\t\t\t\t\t\t\t\tbreak;\n+\t\t\t\t\t\t\t{\n+\t\t\t\t\t\t\t\tuint16 p;\n+\t\t\t\t\t\t\t\tassert(o->field_type == TIFF_SHORT);\n+\t\t\t\t\t\t\t\tassert(o->field_readcount == 1);\n+\t\t\t\t\t\t\t\tassert(o->field_passcount == 0);\n+\t\t\t\t\t\t\t\tTIFFGetField(tif, o->field_tag, &p);\n+\t\t\t\t\t\t\t\tif (!TIFFWriteDirectoryTagShort(tif, &ndir, dir, (uint16)o->field_tag, p))\n+\t\t\t\t\t\t\t\t\tgoto bad;\n+\t\t\t\t\t\t\t}\n+\t\t\t\t\t\t\tbreak;\n \t\t\t\t\t\t\tcase TIFF_SETGET_UINT32:\n-\t\t\t\t\t\t\t\t{\n-\t\t\t\t\t\t\t\t\tuint32 p;\n-\t\t\t\t\t\t\t\t\tassert(o->field_type==TIFF_LONG);\n-\t\t\t\t\t\t\t\t\tassert(o->field_readcount==1);\n-\t\t\t\t\t\t\t\t\tassert(o->field_passcount==0);\n-\t\t\t\t\t\t\t\t\tTIFFGetField(tif,o->field_tag,&p);\n-\t\t\t\t\t\t\t\t\tif (!TIFFWriteDirectoryTagLong(tif,&ndir,dir,(uint16)o->field_tag,p))\n-\t\t\t\t\t\t\t\t\t\tgoto bad;\n-\t\t\t\t\t\t\t\t}\n-\t\t\t\t\t\t\t\tbreak;\n+\t\t\t\t\t\t\t{\n+\t\t\t\t\t\t\t\tuint32 p;\n+\t\t\t\t\t\t\t\tassert(o->field_type == TIFF_LONG);\n+\t\t\t\t\t\t\t\tassert(o->field_readcount == 1);\n+\t\t\t\t\t\t\t\tassert(o->field_passcount == 0);\n+\t\t\t\t\t\t\t\tTIFFGetField(tif, o->field_tag, &p);\n+\t\t\t\t\t\t\t\tif (!TIFFWriteDirectoryTagLong(tif, &ndir, dir, (uint16)o->field_tag, p))\n+\t\t\t\t\t\t\t\t\tgoto bad;\n+\t\t\t\t\t\t\t}\n+\t\t\t\t\t\t\tbreak;\n \t\t\t\t\t\t\tcase TIFF_SETGET_C32_UINT8:\n-\t\t\t\t\t\t\t\t{\n-\t\t\t\t\t\t\t\t\tuint32 pa;\n-\t\t\t\t\t\t\t\t\tvoid* pb;\n-\t\t\t\t\t\t\t\t\tassert(o->field_type==TIFF_UNDEFINED);\n-\t\t\t\t\t\t\t\t\tassert(o->field_readcount==TIFF_VARIABLE2);\n-\t\t\t\t\t\t\t\t\tassert(o->field_passcount==1);\n-\t\t\t\t\t\t\t\t\tTIFFGetField(tif,o->field_tag,&pa,&pb);\n-\t\t\t\t\t\t\t\t\tif (!TIFFWriteDirectoryTagUndefinedArray(tif,&ndir,dir,(uint16)o->field_tag,pa,pb))\n-\t\t\t\t\t\t\t\t\t\tgoto bad;\n-\t\t\t\t\t\t\t\t}\n-\t\t\t\t\t\t\t\tbreak;\n+\t\t\t\t\t\t\t{\n+\t\t\t\t\t\t\t\tuint32 pa;\n+\t\t\t\t\t\t\t\tvoid* pb;\n+\t\t\t\t\t\t\t\tassert(o->field_type == TIFF_UNDEFINED);\n+\t\t\t\t\t\t\t\tassert(o->field_readcount == TIFF_VARIABLE2);\n+\t\t\t\t\t\t\t\tassert(o->field_passcount == 1);\n+\t\t\t\t\t\t\t\tTIFFGetField(tif, o->field_tag, &pa, &pb);\n+\t\t\t\t\t\t\t\tif (!TIFFWriteDirectoryTagUndefinedArray(tif, &ndir, dir, (uint16)o->field_tag, pa, pb))\n+\t\t\t\t\t\t\t\t\tgoto bad;\n+\t\t\t\t\t\t\t}\n+\t\t\t\t\t\t\tbreak;\n \t\t\t\t\t\t\tdefault:\n \t\t\t\t\t\t\t\tassert(0);   /* we should never get here */\n \t\t\t\t\t\t\t\tbreak;\n@@ -703,74 +679,74 @@\n \t\t\t\t}\n \t\t\t}\n \t\t}\n-\t\tfor (m=0; m<(uint32)(tif->tif_dir.td_customValueCount); m++)\n+\t\tfor (m = 0; m < (uint32)(tif->tif_dir.td_customValueCount); m++)\n \t\t{\n-                        uint16 tag = (uint16)tif->tif_dir.td_customValues[m].info->field_tag;\n-                        uint32 count = tif->tif_dir.td_customValues[m].count;\n+\t\t\tuint16 tag = (uint16)tif->tif_dir.td_customValues[m].info->field_tag;\n+\t\t\tuint32 count = tif->tif_dir.td_customValues[m].count;\n \t\t\tswitch (tif->tif_dir.td_customValues[m].info->field_type)\n \t\t\t{\n \t\t\t\tcase TIFF_ASCII:\n-\t\t\t\t\tif (!TIFFWriteDirectoryTagAscii(tif,&ndir,dir,tag,count,tif->tif_dir.td_customValues[m].value))\n+\t\t\t\t\tif (!TIFFWriteDirectoryTagAscii(tif, &ndir, dir, tag, count, tif->tif_dir.td_customValues[m].value))\n \t\t\t\t\t\tgoto bad;\n \t\t\t\t\tbreak;\n \t\t\t\tcase TIFF_UNDEFINED:\n-\t\t\t\t\tif (!TIFFWriteDirectoryTagUndefinedArray(tif,&ndir,dir,tag,count,tif->tif_dir.td_customValues[m].value))\n+\t\t\t\t\tif (!TIFFWriteDirectoryTagUndefinedArray(tif, &ndir, dir, tag, count, tif->tif_dir.td_customValues[m].value))\n \t\t\t\t\t\tgoto bad;\n \t\t\t\t\tbreak;\n \t\t\t\tcase TIFF_BYTE:\n-\t\t\t\t\tif (!TIFFWriteDirectoryTagByteArray(tif,&ndir,dir,tag,count,tif->tif_dir.td_customValues[m].value))\n+\t\t\t\t\tif (!TIFFWriteDirectoryTagByteArray(tif, &ndir, dir, tag, count, tif->tif_dir.td_customValues[m].value))\n \t\t\t\t\t\tgoto bad;\n \t\t\t\t\tbreak;\n \t\t\t\tcase TIFF_SBYTE:\n-\t\t\t\t\tif (!TIFFWriteDirectoryTagSbyteArray(tif,&ndir,dir,tag,count,tif->tif_dir.td_customValues[m].value))\n+\t\t\t\t\tif (!TIFFWriteDirectoryTagSbyteArray(tif, &ndir, dir, tag, count, tif->tif_dir.td_customValues[m].value))\n \t\t\t\t\t\tgoto bad;\n \t\t\t\t\tbreak;\n \t\t\t\tcase TIFF_SHORT:\n-\t\t\t\t\tif (!TIFFWriteDirectoryTagShortArray(tif,&ndir,dir,tag,count,tif->tif_dir.td_customValues[m].value))\n+\t\t\t\t\tif (!TIFFWriteDirectoryTagShortArray(tif, &ndir, dir, tag, count, tif->tif_dir.td_customValues[m].value))\n \t\t\t\t\t\tgoto bad;\n \t\t\t\t\tbreak;\n \t\t\t\tcase TIFF_SSHORT:\n-\t\t\t\t\tif (!TIFFWriteDirectoryTagSshortArray(tif,&ndir,dir,tag,count,tif->tif_dir.td_customValues[m].value))\n+\t\t\t\t\tif (!TIFFWriteDirectoryTagSshortArray(tif, &ndir, dir, tag, count, tif->tif_dir.td_customValues[m].value))\n \t\t\t\t\t\tgoto bad;\n \t\t\t\t\tbreak;\n \t\t\t\tcase TIFF_LONG:\n-\t\t\t\t\tif (!TIFFWriteDirectoryTagLongArray(tif,&ndir,dir,tag,count,tif->tif_dir.td_customValues[m].value))\n+\t\t\t\t\tif (!TIFFWriteDirectoryTagLongArray(tif, &ndir, dir, tag, count, tif->tif_dir.td_customValues[m].value))\n \t\t\t\t\t\tgoto bad;\n \t\t\t\t\tbreak;\n \t\t\t\tcase TIFF_SLONG:\n-\t\t\t\t\tif (!TIFFWriteDirectoryTagSlongArray(tif,&ndir,dir,tag,count,tif->tif_dir.td_customValues[m].value))\n+\t\t\t\t\tif (!TIFFWriteDirectoryTagSlongArray(tif, &ndir, dir, tag, count, tif->tif_dir.td_customValues[m].value))\n \t\t\t\t\t\tgoto bad;\n \t\t\t\t\tbreak;\n \t\t\t\tcase TIFF_LONG8:\n-\t\t\t\t\tif (!TIFFWriteDirectoryTagLong8Array(tif,&ndir,dir,tag,count,tif->tif_dir.td_customValues[m].value))\n+\t\t\t\t\tif (!TIFFWriteDirectoryTagLong8Array(tif, &ndir, dir, tag, count, tif->tif_dir.td_customValues[m].value))\n \t\t\t\t\t\tgoto bad;\n \t\t\t\t\tbreak;\n \t\t\t\tcase TIFF_SLONG8:\n-\t\t\t\t\tif (!TIFFWriteDirectoryTagSlong8Array(tif,&ndir,dir,tag,count,tif->tif_dir.td_customValues[m].value))\n+\t\t\t\t\tif (!TIFFWriteDirectoryTagSlong8Array(tif, &ndir, dir, tag, count, tif->tif_dir.td_customValues[m].value))\n \t\t\t\t\t\tgoto bad;\n \t\t\t\t\tbreak;\n \t\t\t\tcase TIFF_RATIONAL:\n-\t\t\t\t\tif (!TIFFWriteDirectoryTagRationalArray(tif,&ndir,dir,tag,count,tif->tif_dir.td_customValues[m].value))\n+\t\t\t\t\tif (!TIFFWriteDirectoryTagRationalArray(tif, &ndir, dir, tag, count, tif->tif_dir.td_customValues[m].value))\n \t\t\t\t\t\tgoto bad;\n \t\t\t\t\tbreak;\n \t\t\t\tcase TIFF_SRATIONAL:\n-\t\t\t\t\tif (!TIFFWriteDirectoryTagSrationalArray(tif,&ndir,dir,tag,count,tif->tif_dir.td_customValues[m].value))\n+\t\t\t\t\tif (!TIFFWriteDirectoryTagSrationalArray(tif, &ndir, dir, tag, count, tif->tif_dir.td_customValues[m].value))\n \t\t\t\t\t\tgoto bad;\n \t\t\t\t\tbreak;\n \t\t\t\tcase TIFF_FLOAT:\n-\t\t\t\t\tif (!TIFFWriteDirectoryTagFloatArray(tif,&ndir,dir,tag,count,tif->tif_dir.td_customValues[m].value))\n+\t\t\t\t\tif (!TIFFWriteDirectoryTagFloatArray(tif, &ndir, dir, tag, count, tif->tif_dir.td_customValues[m].value))\n \t\t\t\t\t\tgoto bad;\n \t\t\t\t\tbreak;\n \t\t\t\tcase TIFF_DOUBLE:\n-\t\t\t\t\tif (!TIFFWriteDirectoryTagDoubleArray(tif,&ndir,dir,tag,count,tif->tif_dir.td_customValues[m].value))\n+\t\t\t\t\tif (!TIFFWriteDirectoryTagDoubleArray(tif, &ndir, dir, tag, count, tif->tif_dir.td_customValues[m].value))\n \t\t\t\t\t\tgoto bad;\n \t\t\t\t\tbreak;\n \t\t\t\tcase TIFF_IFD:\n-\t\t\t\t\tif (!TIFFWriteDirectoryTagIfdArray(tif,&ndir,dir,tag,count,tif->tif_dir.td_customValues[m].value))\n+\t\t\t\t\tif (!TIFFWriteDirectoryTagIfdArray(tif, &ndir, dir, tag, count, tif->tif_dir.td_customValues[m].value))\n \t\t\t\t\t\tgoto bad;\n \t\t\t\t\tbreak;\n \t\t\t\tcase TIFF_IFD8:\n-\t\t\t\t\tif (!TIFFWriteDirectoryTagIfdIfd8Array(tif,&ndir,dir,tag,count,tif->tif_dir.td_customValues[m].value))\n+\t\t\t\t\tif (!TIFFWriteDirectoryTagIfdIfd8Array(tif, &ndir, dir, tag, count, tif->tif_dir.td_customValues[m].value))\n \t\t\t\t\t\tgoto bad;\n \t\t\t\t\tbreak;\n \t\t\t\tdefault:\n@@ -778,143 +754,141 @@\n \t\t\t\t\tbreak;\n \t\t\t}\n \t\t}\n-\t\tif (dir!=NULL)\n+\t\tif (dir != NULL)\n \t\t\tbreak;\n-\t\tdir=_TIFFmalloc(ndir*sizeof(TIFFDirEntry));\n-\t\tif (dir==NULL)\n+\t\tdir = _TIFFmalloc(ndir * sizeof(TIFFDirEntry));\n+\t\tif (dir == NULL)\n \t\t{\n-\t\t\tTIFFErrorExt(tif->tif_clientdata,module,"Out of memory");\n+\t\t\tTIFFErrorExt(tif->tif_clientdata, module, "Out of memory");\n \t\t\tgoto bad;\n \t\t}\n \t\tif (isimage)\n \t\t{\n-\t\t\tif ((tif->tif_diroff==0)&&(!TIFFLinkDirectory(tif)))\n+\t\t\tif ((tif->tif_diroff == 0) && (!TIFFLinkDirectory(tif)))\n \t\t\t\tgoto bad;\n \t\t}\n \t\telse\n-\t\t\ttif->tif_diroff=(TIFFSeekFile(tif,0,SEEK_END)+1)&(~((toff_t)1));\n-\t\tif (pdiroff!=NULL)\n-\t\t\t*pdiroff=tif->tif_diroff;\n-\t\tif (!(tif->tif_flags&TIFF_BIGTIFF))\n-\t\t\tdirsize=2+ndir*12+4;\n+\t\t\ttif->tif_diroff = (TIFFSeekFile(tif, 0, SEEK_END) + 1) & (~((toff_t)1));\n+\t\tif (pdiroff != NULL)\n+\t\t\t*pdiroff = tif->tif_diroff;\n+\t\tif (!(tif->tif_flags & TIFF_BIGTIFF))\n+\t\t\tdirsize = 2 + ndir * 12 + 4;\n \t\telse\n-\t\t\tdirsize=8+ndir*20+8;\n-\t\ttif->tif_dataoff=tif->tif_diroff+dirsize;\n-\t\tif (!(tif->tif_flags&TIFF_BIGTIFF))\n-\t\t\ttif->tif_dataoff=(uint32)tif->tif_dataoff;\n-\t\tif ((tif->tif_dataoff<tif->tif_diroff)||(tif->tif_dataoff<(uint64)dirsize))\n+\t\t\tdirsize = 8 + ndir * 20 + 8;\n+\t\ttif->tif_dataoff = tif->tif_diroff + dirsize;\n+\t\tif (!(tif->tif_flags & TIFF_BIGTIFF))\n+\t\t\ttif->tif_dataoff = (uint32)tif->tif_dataoff;\n+\t\tif ((tif->tif_dataoff < tif->tif_diroff) || (tif->tif_dataoff < (uint64)dirsize))\n \t\t{\n-\t\t\tTIFFErrorExt(tif->tif_clientdata,module,"Maximum TIFF file size exceeded");\n+\t\t\tTIFFErrorExt(tif->tif_clientdata, module, "Maximum TIFF file size exceeded");\n \t\t\tgoto bad;\n \t\t}\n-\t\tif (tif->tif_dataoff&1)\n+\t\tif (tif->tif_dataoff & 1)\n \t\t\ttif->tif_dataoff++;\n \t\tif (isimage)\n \t\t\ttif->tif_curdir++;\n \t}\n \tif (isimage)\n \t{\n-\t\tif (TIFFFieldSet(tif,FIELD_SUBIFD)&&(tif->tif_subifdoff==0))\n+\t\tif (TIFFFieldSet(tif, FIELD_SUBIFD) && (tif->tif_subifdoff == 0))\n \t\t{\n \t\t\tuint32 na;\n \t\t\tTIFFDirEntry* nb;\n-\t\t\tfor (na=0, nb=dir; ; na++, nb++)\n+\t\t\tfor (na = 0, nb = dir; ; na++, nb++)\n \t\t\t{\n-\t\t\t\tassert(na<ndir);\n-\t\t\t\tif (nb->tdir_tag==TIFFTAG_SUBIFD)\n+\t\t\t\tassert(na < ndir);\n+\t\t\t\tif (nb->tdir_tag == TIFFTAG_SUBIFD)\n \t\t\t\t\tbreak;\n \t\t\t}\n-\t\t\tif (!(tif->tif_flags&TIFF_BIGTIFF))\n-\t\t\t\ttif->tif_subifdoff=tif->tif_diroff+2+na*12+8;\n+\t\t\tif (!(tif->tif_flags & TIFF_BIGTIFF))\n+\t\t\t\ttif->tif_subifdoff = tif->tif_diroff + 2 + na * 12 + 8;\n \t\t\telse\n-\t\t\t\ttif->tif_subifdoff=tif->tif_diroff+8+na*20+12;\n+\t\t\t\ttif->tif_subifdoff = tif->tif_diroff + 8 + na * 20 + 12;\n \t\t}\n \t}\n-\tdirmem=_TIFFmalloc(dirsize);\n-\tif (dirmem==NULL)\n+\tdirmem = _TIFFmalloc(dirsize);\n+\tif (dirmem == NULL)\n \t{\n-\t\tTIFFErrorExt(tif->tif_clientdata,module,"Out of memory");\n+\t\tTIFFErrorExt(tif->tif_clientdata, module, "Out of memory");\n \t\tgoto bad;\n \t}\n-\tif (!(tif->tif_flags&TIFF_BIGTIFF))\n+\tif (!(tif->tif_flags & TIFF_BIGTIFF))\n \t{\n \t\tuint8* n;\n \t\tuint32 nTmp;\n \t\tTIFFDirEntry* o;\n-\t\tn=dirmem;\n-\t\t*(uint16*)n=(uint16)ndir;\n-\t\tif (tif->tif_flags&TIFF_SWAB)\n+\t\tn = dirmem;\n+\t\t*(uint16*)n = (uint16)ndir;\n+\t\tif (tif->tif_flags & TIFF_SWAB)\n \t\t\tTIFFSwabShort((uint16*)n);\n-\t\tn+=2;\n-\t\to=dir;\n-\t\tfor (m=0; m<ndir; m++)\n+\t\tn += 2;\n+\t\to = dir;\n+\t\tfor (m = 0; m < ndir; m++)\n \t\t{\n-\t\t\t*(uint16*)n=o->tdir_tag;\n-\t\t\tif (tif->tif_flags&TIFF_SWAB)\n+\t\t\t*(uint16*)n = o->tdir_tag;\n+\t\t\tif (tif->tif_flags & TIFF_SWAB)\n \t\t\t\tTIFFSwabShort((uint16*)n);\n-\t\t\tn+=2;\n-\t\t\t*(uint16*)n=o->tdir_type;\n-\t\t\tif (tif->tif_flags&TIFF_SWAB)\n+\t\t\tn += 2;\n+\t\t\t*(uint16*)n = o->tdir_type;\n+\t\t\tif (tif->tif_flags & TIFF_SWAB)\n \t\t\t\tTIFFSwabShort((uint16*)n);\n-\t\t\tn+=2;\n+\t\t\tn += 2;\n \t\t\tnTmp = (uint32)o->tdir_count;\n-\t\t\t_TIFFmemcpy(n,&nTmp,4);\n-\t\t\tif (tif->tif_flags&TIFF_SWAB)\n+\t\t\t_TIFFmemcpy(n, &nTmp, 4);\n+\t\t\tif (tif->tif_flags & TIFF_SWAB)\n \t\t\t\tTIFFSwabLong((uint32*)n);\n-\t\t\tn+=4;\n-\t\t\t/* This is correct. The data has been */\n-\t\t\t/* swabbed previously in TIFFWriteDirectoryTagData */\n-\t\t\t_TIFFmemcpy(n,&o->tdir_offset,4);\n-\t\t\tn+=4;\n+\t\t\tn += 4;\n+\t\t\t_TIFFmemcpy(n, &o->tdir_offset, 4);\n+\t\t\tn += 4;\n \t\t\to++;\n \t\t}\n \t\tnTmp = (uint32)tif->tif_nextdiroff;\n-\t\tif (tif->tif_flags&TIFF_SWAB)\n+\t\tif (tif->tif_flags & TIFF_SWAB)\n \t\t\tTIFFSwabLong(&nTmp);\n-\t\t_TIFFmemcpy(n,&nTmp,4);\n+\t\t_TIFFmemcpy(n, &nTmp, 4);\n \t}\n \telse\n \t{\n \t\tuint8* n;\n \t\tTIFFDirEntry* o;\n-\t\tn=dirmem;\n-\t\t*(uint64*)n=ndir;\n-\t\tif (tif->tif_flags&TIFF_SWAB)\n+\t\tn = dirmem;\n+\t\t*(uint64*)n = ndir;\n+\t\tif (tif->tif_flags & TIFF_SWAB)\n \t\t\tTIFFSwabLong8((uint64*)n);\n-\t\tn+=8;\n-\t\to=dir;\n-\t\tfor (m=0; m<ndir; m++)\n+\t\tn += 8;\n+\t\to = dir;\n+\t\tfor (m = 0; m < ndir; m++)\n \t\t{\n-\t\t\t*(uint16*)n=o->tdir_tag;\n-\t\t\tif (tif->tif_flags&TIFF_SWAB)\n+\t\t\t*(uint16*)n = o->tdir_tag;\n+\t\t\tif (tif->tif_flags & TIFF_SWAB)\n \t\t\t\tTIFFSwabShort((uint16*)n);\n-\t\t\tn+=2;\n-\t\t\t*(uint16*)n=o->tdir_type;\n-\t\t\tif (tif->tif_flags&TIFF_SWAB)\n+\t\t\tn += 2;\n+\t\t\t*(uint16*)n = o->tdir_type;\n+\t\t\tif (tif->tif_flags & TIFF_SWAB)\n \t\t\t\tTIFFSwabShort((uint16*)n);\n-\t\t\tn+=2;\n-\t\t\t_TIFFmemcpy(n,&o->tdir_count,8);\n-\t\t\tif (tif->tif_flags&TIFF_SWAB)\n+\t\t\tn += 2;\n+\t\t\t_TIFFmemcpy(n, &o->tdir_count, 8);\n+\t\t\tif (tif->tif_flags & TIFF_SWAB)\n \t\t\t\tTIFFSwabLong8((uint64*)n);\n-\t\t\tn+=8;\n-\t\t\t_TIFFmemcpy(n,&o->tdir_offset,8);\n-\t\t\tn+=8;\n+\t\t\tn += 8;\n+\t\t\t_TIFFmemcpy(n, &o->tdir_offset, 8);\n+\t\t\tn += 8;\n \t\t\to++;\n \t\t}\n-\t\t_TIFFmemcpy(n,&tif->tif_nextdiroff,8);\n-\t\tif (tif->tif_flags&TIFF_SWAB)\n+\t\t_TIFFmemcpy(n, &tif->tif_nextdiroff, 8);\n+\t\tif (tif->tif_flags & TIFF_SWAB)\n \t\t\tTIFFSwabLong8((uint64*)n);\n \t}\n \t_TIFFfree(dir);\n-\tdir=NULL;\n-\tif (!SeekOK(tif,tif->tif_diroff))\n+\tdir = NULL;\n+\tif (!SeekOK(tif, tif->tif_diroff))\n \t{\n-\t\tTIFFErrorExt(tif->tif_clientdata,module,"IO error writing directory");\n+\t\tTIFFErrorExt(tif->tif_clientdata, module, "IO error writing directory");\n \t\tgoto bad;\n \t}\n-\tif (!WriteOK(tif,dirmem,(tmsize_t)dirsize))\n+\tif (!WriteOK(tif, dirmem, (tmsize_t)dirsize))\n \t{\n-\t\tTIFFErrorExt(tif->tif_clientdata,module,"IO error writing directory");\n+\t\tTIFFErrorExt(tif->tif_clientdata, module, "IO error writing directory");\n \t\tgoto bad;\n \t}\n \t_TIFFfree(dirmem);\n@@ -924,21 +898,18 @@\n \t\ttif->tif_flags &= ~TIFF_DIRTYDIRECT;\n \t\ttif->tif_flags &= ~TIFF_DIRTYSTRIP;\n \t\t(*tif->tif_cleanup)(tif);\n-\t\t/*\n-\t\t* Reset directory-related state for subsequent\n-\t\t* directories.\n-\t\t*/\n \t\tTIFFCreateDirectory(tif);\n \t}\n \treturn(1);\n bad:\n-\tif (dir!=NULL)\n+\tif (dir != NULL)\n \t\t_TIFFfree(dir);\n-\tif (dirmem!=NULL)\n+\tif (dirmem != NULL)\n \t\t_TIFFfree(dirmem);\n \treturn(0);\n }\n \n+\n static int\n TIFFWriteDirectoryTagSampleformatArray(TIFF* tif, uint32* ndir, TIFFDirEntry* dir, uint16 tag, uint32 count, double* value)\n {\n', 'id': 45, 'location': '/data/vulnloc/libtiff/CVE-2017-7600/src/libtiff/tif_dirwrite.c:589:10'}, {'diff': '@@ -359,6 +359,7 @@\n \treturn TIFFWriteDirectory( tif );\n }\n \n+\n static int\n TIFFWriteDirectorySec(TIFF* tif, int isimage, int imagedone, uint64* pdiroff)\n {\n@@ -372,12 +373,7 @@\n \t\treturn (1);\n \n         _TIFFFillStriles( tif );\n-        \n-\t/*\n-\t * Clear write state so that subsequent images with\n-\t * different characteristics get the right buffers\n-\t * setup for them.\n-\t */\n+\n \tif (imagedone)\n \t{\n \t\tif (tif->tif_flags & TIFF_POSTENCODE)\n@@ -390,14 +386,7 @@\n \t\t\t\treturn (0);\n \t\t\t}\n \t\t}\n-\t\t(*tif->tif_close)(tif);       /* shutdown encoder */\n-\t\t/*\n-\t\t * Flush any data that might have been written\n-\t\t * by the compression close+cleanup routines.  But\n-                 * be careful not to write stuff if we didn\'t add data\n-                 * in the previous steps as the "rawcc" data may well be\n-                 * a previously read tile/strip in mixed read/write mode.\n-\t\t */\n+\t\t(*tif->tif_close)(tif);       \n \t\tif (tif->tif_rawcc > 0 \n \t\t    && (tif->tif_flags & TIFF_BEENWRITING) != 0 )\n \t\t{\n@@ -542,17 +531,6 @@\n \t\t\t{\n \t\t\t\tif (!isTiled(tif))\n \t\t\t\t{\n-                    /* td_stripoffset might be NULL in an odd OJPEG case. See\n-                     *  tif_dirread.c around line 3634.\n-                     * XXX: OJPEG hack.\n-                     * If a) compression is OJPEG, b) it\'s not a tiled TIFF,\n-                     * and c) the number of strips is 1,\n-                     * then we tolerate the absence of stripoffsets tag,\n-                     * because, presumably, all required data is in the\n-                     * JpegInterchangeFormat stream.\n-                     * We can get here when using tiffset on such a file.\n-                     * See http://bugzilla.maptools.org/show_bug.cgi?id=2500\n-                    */\n                     if (tif->tif_dir.td_stripoffset != NULL &&\n                         !TIFFWriteDirectoryTagLongLong8Array(tif,&ndir,dir,TIFFTAG_STRIPOFFSETS,tif->tif_dir.td_nstrips,tif->tif_dir.td_stripoffset))\n                         goto bad;\n@@ -696,7 +674,7 @@\n \t\t\t\t\t\t\t\t}\n \t\t\t\t\t\t\t\tbreak;\n \t\t\t\t\t\t\tdefault:\n-\t\t\t\t\t\t\t\tassert(0);   /* we should never get here */\n+\t\t\t\t\t\t\t\tassert(0);   \n \t\t\t\t\t\t\t\tbreak;\n \t\t\t\t\t\t}\n \t\t\t\t\t}\n@@ -774,7 +752,7 @@\n \t\t\t\t\t\tgoto bad;\n \t\t\t\t\tbreak;\n \t\t\t\tdefault:\n-\t\t\t\t\tassert(0);   /* we should never get here */\n+\t\t\t\t\tassert(0);   \n \t\t\t\t\tbreak;\n \t\t\t}\n \t\t}\n@@ -862,8 +840,6 @@\n \t\t\tif (tif->tif_flags&TIFF_SWAB)\n \t\t\t\tTIFFSwabLong((uint32*)n);\n \t\t\tn+=4;\n-\t\t\t/* This is correct. The data has been */\n-\t\t\t/* swabbed previously in TIFFWriteDirectoryTagData */\n \t\t\t_TIFFmemcpy(n,&o->tdir_offset,4);\n \t\t\tn+=4;\n \t\t\to++;\n@@ -924,10 +900,6 @@\n \t\ttif->tif_flags &= ~TIFF_DIRTYDIRECT;\n \t\ttif->tif_flags &= ~TIFF_DIRTYSTRIP;\n \t\t(*tif->tif_cleanup)(tif);\n-\t\t/*\n-\t\t* Reset directory-related state for subsequent\n-\t\t* directories.\n-\t\t*/\n \t\tTIFFCreateDirectory(tif);\n \t}\n \treturn(1);\n@@ -939,6 +911,7 @@\n \treturn(0);\n }\n \n+\n static int\n TIFFWriteDirectoryTagSampleformatArray(TIFF* tif, uint32* ndir, TIFFDirEntry* dir, uint16 tag, uint32 count, double* value)\n {\n', 'id': 46, 'location': '/data/vulnloc/libtiff/CVE-2017-7600/src/libtiff/tif_dirwrite.c:589:10'}, {'diff': '@@ -359,6 +359,7 @@\n \treturn TIFFWriteDirectory( tif );\n }\n \n+\n static int\n TIFFWriteDirectorySec(TIFF* tif, int isimage, int imagedone, uint64* pdiroff)\n {\n@@ -373,11 +374,6 @@\n \n         _TIFFFillStriles( tif );\n         \n-\t/*\n-\t * Clear write state so that subsequent images with\n-\t * different characteristics get the right buffers\n-\t * setup for them.\n-\t */\n \tif (imagedone)\n \t{\n \t\tif (tif->tif_flags & TIFF_POSTENCODE)\n@@ -390,14 +386,7 @@\n \t\t\t\treturn (0);\n \t\t\t}\n \t\t}\n-\t\t(*tif->tif_close)(tif);       /* shutdown encoder */\n-\t\t/*\n-\t\t * Flush any data that might have been written\n-\t\t * by the compression close+cleanup routines.  But\n-                 * be careful not to write stuff if we didn\'t add data\n-                 * in the previous steps as the "rawcc" data may well be\n-                 * a previously read tile/strip in mixed read/write mode.\n-\t\t */\n+\t\t(*tif->tif_close)(tif);\n \t\tif (tif->tif_rawcc > 0 \n \t\t    && (tif->tif_flags & TIFF_BEENWRITING) != 0 )\n \t\t{\n@@ -542,17 +531,6 @@\n \t\t\t{\n \t\t\t\tif (!isTiled(tif))\n \t\t\t\t{\n-                    /* td_stripoffset might be NULL in an odd OJPEG case. See\n-                     *  tif_dirread.c around line 3634.\n-                     * XXX: OJPEG hack.\n-                     * If a) compression is OJPEG, b) it\'s not a tiled TIFF,\n-                     * and c) the number of strips is 1,\n-                     * then we tolerate the absence of stripoffsets tag,\n-                     * because, presumably, all required data is in the\n-                     * JpegInterchangeFormat stream.\n-                     * We can get here when using tiffset on such a file.\n-                     * See http://bugzilla.maptools.org/show_bug.cgi?id=2500\n-                    */\n                     if (tif->tif_dir.td_stripoffset != NULL &&\n                         !TIFFWriteDirectoryTagLongLong8Array(tif,&ndir,dir,TIFFTAG_STRIPOFFSETS,tif->tif_dir.td_nstrips,tif->tif_dir.td_stripoffset))\n                         goto bad;\n@@ -696,7 +674,7 @@\n \t\t\t\t\t\t\t\t}\n \t\t\t\t\t\t\t\tbreak;\n \t\t\t\t\t\t\tdefault:\n-\t\t\t\t\t\t\t\tassert(0);   /* we should never get here */\n+\t\t\t\t\t\t\t\tassert(0);\n \t\t\t\t\t\t\t\tbreak;\n \t\t\t\t\t\t}\n \t\t\t\t\t}\n@@ -774,7 +752,7 @@\n \t\t\t\t\t\tgoto bad;\n \t\t\t\t\tbreak;\n \t\t\t\tdefault:\n-\t\t\t\t\tassert(0);   /* we should never get here */\n+\t\t\t\t\tassert(0);\n \t\t\t\t\tbreak;\n \t\t\t}\n \t\t}\n@@ -862,8 +840,6 @@\n \t\t\tif (tif->tif_flags&TIFF_SWAB)\n \t\t\t\tTIFFSwabLong((uint32*)n);\n \t\t\tn+=4;\n-\t\t\t/* This is correct. The data has been */\n-\t\t\t/* swabbed previously in TIFFWriteDirectoryTagData */\n \t\t\t_TIFFmemcpy(n,&o->tdir_offset,4);\n \t\t\tn+=4;\n \t\t\to++;\n@@ -924,10 +900,6 @@\n \t\ttif->tif_flags &= ~TIFF_DIRTYDIRECT;\n \t\ttif->tif_flags &= ~TIFF_DIRTYSTRIP;\n \t\t(*tif->tif_cleanup)(tif);\n-\t\t/*\n-\t\t* Reset directory-related state for subsequent\n-\t\t* directories.\n-\t\t*/\n \t\tTIFFCreateDirectory(tif);\n \t}\n \treturn(1);\n@@ -939,6 +911,7 @@\n \treturn(0);\n }\n \n+\n static int\n TIFFWriteDirectoryTagSampleformatArray(TIFF* tif, uint32* ndir, TIFFDirEntry* dir, uint16 tag, uint32 count, double* value)\n {\n', 'id': 47, 'location': '/data/vulnloc/libtiff/CVE-2017-7600/src/libtiff/tif_dirwrite.c:589:10'}, {'diff': '@@ -359,6 +359,7 @@\n \treturn TIFFWriteDirectory( tif );\n }\n \n+\n static int\n TIFFWriteDirectorySec(TIFF* tif, int isimage, int imagedone, uint64* pdiroff)\n {\n@@ -373,11 +374,6 @@\n \n         _TIFFFillStriles( tif );\n         \n-\t/*\n-\t * Clear write state so that subsequent images with\n-\t * different characteristics get the right buffers\n-\t * setup for them.\n-\t */\n \tif (imagedone)\n \t{\n \t\tif (tif->tif_flags & TIFF_POSTENCODE)\n@@ -390,16 +386,8 @@\n \t\t\t\treturn (0);\n \t\t\t}\n \t\t}\n-\t\t(*tif->tif_close)(tif);       /* shutdown encoder */\n-\t\t/*\n-\t\t * Flush any data that might have been written\n-\t\t * by the compression close+cleanup routines.  But\n-                 * be careful not to write stuff if we didn\'t add data\n-                 * in the previous steps as the "rawcc" data may well be\n-                 * a previously read tile/strip in mixed read/write mode.\n-\t\t */\n-\t\tif (tif->tif_rawcc > 0 \n-\t\t    && (tif->tif_flags & TIFF_BEENWRITING) != 0 )\n+\t\t(*tif->tif_close)(tif);\n+\t\tif (tif->tif_rawcc > 0 && (tif->tif_flags & TIFF_BEENWRITING) != 0 )\n \t\t{\n \t\t    if( !TIFFFlushData1(tif) )\n                     {\n@@ -414,8 +402,8 @@\n \t\t\ttif->tif_rawdata = NULL;\n \t\t\ttif->tif_rawcc = 0;\n \t\t\ttif->tif_rawdatasize = 0;\n-                        tif->tif_rawdataoff = 0;\n-                        tif->tif_rawdataloaded = 0;\n+            tif->tif_rawdataoff = 0;\n+            tif->tif_rawdataloaded = 0;\n \t\t}\n \t\ttif->tif_flags &= ~(TIFF_BEENWRITING|TIFF_BUFFERSETUP);\n \t}\n@@ -542,18 +530,7 @@\n \t\t\t{\n \t\t\t\tif (!isTiled(tif))\n \t\t\t\t{\n-                    /* td_stripoffset might be NULL in an odd OJPEG case. See\n-                     *  tif_dirread.c around line 3634.\n-                     * XXX: OJPEG hack.\n-                     * If a) compression is OJPEG, b) it\'s not a tiled TIFF,\n-                     * and c) the number of strips is 1,\n-                     * then we tolerate the absence of stripoffsets tag,\n-                     * because, presumably, all required data is in the\n-                     * JpegInterchangeFormat stream.\n-                     * We can get here when using tiffset on such a file.\n-                     * See http://bugzilla.maptools.org/show_bug.cgi?id=2500\n-                    */\n-                    if (tif->tif_dir.td_stripoffset != NULL &&\n+\t\t\t\t\tif (tif->tif_dir.td_stripoffset != NULL &&\n                         !TIFFWriteDirectoryTagLongLong8Array(tif,&ndir,dir,TIFFTAG_STRIPOFFSETS,tif->tif_dir.td_nstrips,tif->tif_dir.td_stripoffset))\n                         goto bad;\n \t\t\t\t}\n@@ -696,7 +673,7 @@\n \t\t\t\t\t\t\t\t}\n \t\t\t\t\t\t\t\tbreak;\n \t\t\t\t\t\t\tdefault:\n-\t\t\t\t\t\t\t\tassert(0);   /* we should never get here */\n+\t\t\t\t\t\t\t\tassert(0);\n \t\t\t\t\t\t\t\tbreak;\n \t\t\t\t\t\t}\n \t\t\t\t\t}\n@@ -705,8 +682,8 @@\n \t\t}\n \t\tfor (m=0; m<(uint32)(tif->tif_dir.td_customValueCount); m++)\n \t\t{\n-                        uint16 tag = (uint16)tif->tif_dir.td_customValues[m].info->field_tag;\n-                        uint32 count = tif->tif_dir.td_customValues[m].count;\n+\t\t\tuint16 tag = (uint16)tif->tif_dir.td_customValues[m].info->field_tag;\n+\t\t\tuint32 count = tif->tif_dir.td_customValues[m].count;\n \t\t\tswitch (tif->tif_dir.td_customValues[m].info->field_type)\n \t\t\t{\n \t\t\t\tcase TIFF_ASCII:\n@@ -774,7 +751,7 @@\n \t\t\t\t\t\tgoto bad;\n \t\t\t\t\tbreak;\n \t\t\t\tdefault:\n-\t\t\t\t\tassert(0);   /* we should never get here */\n+\t\t\t\t\tassert(0);\n \t\t\t\t\tbreak;\n \t\t\t}\n \t\t}\n@@ -862,8 +839,6 @@\n \t\t\tif (tif->tif_flags&TIFF_SWAB)\n \t\t\t\tTIFFSwabLong((uint32*)n);\n \t\t\tn+=4;\n-\t\t\t/* This is correct. The data has been */\n-\t\t\t/* swabbed previously in TIFFWriteDirectoryTagData */\n \t\t\t_TIFFmemcpy(n,&o->tdir_offset,4);\n \t\t\tn+=4;\n \t\t\to++;\n@@ -924,10 +899,6 @@\n \t\ttif->tif_flags &= ~TIFF_DIRTYDIRECT;\n \t\ttif->tif_flags &= ~TIFF_DIRTYSTRIP;\n \t\t(*tif->tif_cleanup)(tif);\n-\t\t/*\n-\t\t* Reset directory-related state for subsequent\n-\t\t* directories.\n-\t\t*/\n \t\tTIFFCreateDirectory(tif);\n \t}\n \treturn(1);\n@@ -939,6 +910,7 @@\n \treturn(0);\n }\n \n+\n static int\n TIFFWriteDirectoryTagSampleformatArray(TIFF* tif, uint32* ndir, TIFFDirEntry* dir, uint16 tag, uint32 count, double* value)\n {\n', 'id': 48, 'location': '/data/vulnloc/libtiff/CVE-2017-7600/src/libtiff/tif_dirwrite.c:589:10'}, {'diff': '@@ -359,6 +359,7 @@\n \treturn TIFFWriteDirectory( tif );\n }\n \n+\n static int\n TIFFWriteDirectorySec(TIFF* tif, int isimage, int imagedone, uint64* pdiroff)\n {\n@@ -371,13 +372,8 @@\n \tif (tif->tif_mode == O_RDONLY)\n \t\treturn (1);\n \n-        _TIFFFillStriles( tif );\n-        \n-\t/*\n-\t * Clear write state so that subsequent images with\n-\t * different characteristics get the right buffers\n-\t * setup for them.\n-\t */\n+    _TIFFFillStriles( tif );\n+\n \tif (imagedone)\n \t{\n \t\tif (tif->tif_flags & TIFF_POSTENCODE)\n@@ -390,23 +386,16 @@\n \t\t\t\treturn (0);\n \t\t\t}\n \t\t}\n-\t\t(*tif->tif_close)(tif);       /* shutdown encoder */\n-\t\t/*\n-\t\t * Flush any data that might have been written\n-\t\t * by the compression close+cleanup routines.  But\n-                 * be careful not to write stuff if we didn\'t add data\n-                 * in the previous steps as the "rawcc" data may well be\n-                 * a previously read tile/strip in mixed read/write mode.\n-\t\t */\n+\t\t(*tif->tif_close)(tif);       \n \t\tif (tif->tif_rawcc > 0 \n \t\t    && (tif->tif_flags & TIFF_BEENWRITING) != 0 )\n \t\t{\n \t\t    if( !TIFFFlushData1(tif) )\n-                    {\n-\t\t\tTIFFErrorExt(tif->tif_clientdata, module,\n-\t\t\t    "Error flushing data before directory write");\n-\t\t\treturn (0);\n-                    }\n+            {\n+\t\t\t\tTIFFErrorExt(tif->tif_clientdata, module,\n+\t\t\t\t    "Error flushing data before directory write");\n+\t\t\t\treturn (0);\n+            }\n \t\t}\n \t\tif ((tif->tif_flags & TIFF_MYBUFFER) && tif->tif_rawdata)\n \t\t{\n@@ -414,8 +403,8 @@\n \t\t\ttif->tif_rawdata = NULL;\n \t\t\ttif->tif_rawcc = 0;\n \t\t\ttif->tif_rawdatasize = 0;\n-                        tif->tif_rawdataoff = 0;\n-                        tif->tif_rawdataloaded = 0;\n+            tif->tif_rawdataoff = 0;\n+            tif->tif_rawdataloaded = 0;\n \t\t}\n \t\ttif->tif_flags &= ~(TIFF_BEENWRITING|TIFF_BUFFERSETUP);\n \t}\n@@ -542,17 +531,6 @@\n \t\t\t{\n \t\t\t\tif (!isTiled(tif))\n \t\t\t\t{\n-                    /* td_stripoffset might be NULL in an odd OJPEG case. See\n-                     *  tif_dirread.c around line 3634.\n-                     * XXX: OJPEG hack.\n-                     * If a) compression is OJPEG, b) it\'s not a tiled TIFF,\n-                     * and c) the number of strips is 1,\n-                     * then we tolerate the absence of stripoffsets tag,\n-                     * because, presumably, all required data is in the\n-                     * JpegInterchangeFormat stream.\n-                     * We can get here when using tiffset on such a file.\n-                     * See http://bugzilla.maptools.org/show_bug.cgi?id=2500\n-                    */\n                     if (tif->tif_dir.td_stripoffset != NULL &&\n                         !TIFFWriteDirectoryTagLongLong8Array(tif,&ndir,dir,TIFFTAG_STRIPOFFSETS,tif->tif_dir.td_nstrips,tif->tif_dir.td_stripoffset))\n                         goto bad;\n@@ -696,7 +674,7 @@\n \t\t\t\t\t\t\t\t}\n \t\t\t\t\t\t\t\tbreak;\n \t\t\t\t\t\t\tdefault:\n-\t\t\t\t\t\t\t\tassert(0);   /* we should never get here */\n+\t\t\t\t\t\t\t\tassert(0);   \n \t\t\t\t\t\t\t\tbreak;\n \t\t\t\t\t\t}\n \t\t\t\t\t}\n@@ -705,8 +683,8 @@\n \t\t}\n \t\tfor (m=0; m<(uint32)(tif->tif_dir.td_customValueCount); m++)\n \t\t{\n-                        uint16 tag = (uint16)tif->tif_dir.td_customValues[m].info->field_tag;\n-                        uint32 count = tif->tif_dir.td_customValues[m].count;\n+            uint16 tag = (uint16)tif->tif_dir.td_customValues[m].info->field_tag;\n+            uint32 count = tif->tif_dir.td_customValues[m].count;\n \t\t\tswitch (tif->tif_dir.td_customValues[m].info->field_type)\n \t\t\t{\n \t\t\t\tcase TIFF_ASCII:\n@@ -774,7 +752,7 @@\n \t\t\t\t\t\tgoto bad;\n \t\t\t\t\tbreak;\n \t\t\t\tdefault:\n-\t\t\t\t\tassert(0);   /* we should never get here */\n+\t\t\t\t\tassert(0);   \n \t\t\t\t\tbreak;\n \t\t\t}\n \t\t}\n@@ -862,8 +840,6 @@\n \t\t\tif (tif->tif_flags&TIFF_SWAB)\n \t\t\t\tTIFFSwabLong((uint32*)n);\n \t\t\tn+=4;\n-\t\t\t/* This is correct. The data has been */\n-\t\t\t/* swabbed previously in TIFFWriteDirectoryTagData */\n \t\t\t_TIFFmemcpy(n,&o->tdir_offset,4);\n \t\t\tn+=4;\n \t\t\to++;\n@@ -924,10 +900,6 @@\n \t\ttif->tif_flags &= ~TIFF_DIRTYDIRECT;\n \t\ttif->tif_flags &= ~TIFF_DIRTYSTRIP;\n \t\t(*tif->tif_cleanup)(tif);\n-\t\t/*\n-\t\t* Reset directory-related state for subsequent\n-\t\t* directories.\n-\t\t*/\n \t\tTIFFCreateDirectory(tif);\n \t}\n \treturn(1);\n@@ -939,6 +911,7 @@\n \treturn(0);\n }\n \n+\n static int\n TIFFWriteDirectoryTagSampleformatArray(TIFF* tif, uint32* ndir, TIFFDirEntry* dir, uint16 tag, uint32 count, double* value)\n {\n', 'id': 49, 'location': '/data/vulnloc/libtiff/CVE-2017-7600/src/libtiff/tif_dirwrite.c:589:10'}]2025-02-05 21:10:07.275 | INFO     | scenario:validate:475 - beginning candidate patch evaluation with time limit: 45 minutes
2025-02-05 21:10:07.277 | INFO     | scenario:evaluate:635 - evaluating candidate patch #0:
@@ -939,6 +939,7 @@
 	return(0);
 }
 
+
 static int
 TIFFWriteDirectoryTagSampleformatArray(TIFF* tif, uint32* ndir, TIFFDirEntry* dir, uint16 tag, uint32 count, double* value)
 {
@@ -959,7 +960,11 @@
 			if (tif->tif_dir.td_bitspersample<=32)
 			{
 				for (i = 0; i < count; ++i)
-					((float*)conv)[i] = (float)value[i];
+				{
+					if (i < count) {
+						((float*)conv)[i] = (float)value[i];
+					}
+				}
 				ok = TIFFWriteDirectoryTagFloatArray(tif,ndir,dir,tag,count,(float*)conv);
 			}
 			else
@@ -971,19 +976,31 @@
 			if (tif->tif_dir.td_bitspersample<=8)
 			{
 				for (i = 0; i < count; ++i)
-					((int8*)conv)[i] = (int8)value[i];
+				{
+					if (i < count) {
+						((int8*)conv)[i] = (int8)value[i];
+					}
+				}
 				ok = TIFFWriteDirectoryTagSbyteArray(tif,ndir,dir,tag,count,(int8*)conv);
 			}
 			else if (tif->tif_dir.td_bitspersample<=16)
 			{
 				for (i = 0; i < count; ++i)
-					((int16*)conv)[i] = (int16)value[i];
+				{
+					if (i < count) {
+						((int16*)conv)[i] = (int16)value[i];
+					}
+				}
 				ok = TIFFWriteDirectoryTagSshortArray(tif,ndir,dir,tag,count,(int16*)conv);
 			}
 			else
 			{
 				for (i = 0; i < count; ++i)
-					((int32*)conv)[i] = (int32)value[i];
+				{
+					if (i < count) {
+						((int32*)conv)[i] = (int32)value[i];
+					}
+				}
 				ok = TIFFWriteDirectoryTagSlongArray(tif,ndir,dir,tag,count,(int32*)conv);
 			}
 			break;
@@ -991,19 +1008,31 @@
 			if (tif->tif_dir.td_bitspersample<=8)
 			{
 				for (i = 0; i < count; ++i)
-					((uint8*)conv)[i] = (uint8)value[i];
+				{
+					if (i < count) {
+						((uint8*)conv)[i] = (uint8)value[i];
+					}
+				}
 				ok = TIFFWriteDirectoryTagByteArray(tif,ndir,dir,tag,count,(uint8*)conv);
 			}
 			else if (tif->tif_dir.td_bitspersample<=16)
 			{
 				for (i = 0; i < count; ++i)
-					((uint16*)conv)[i] = (uint16)value[i];
+				{
+					if (i < count) {
+						((uint16*)conv)[i] = (uint16)value[i];
+					}
+				}
 				ok = TIFFWriteDirectoryTagShortArray(tif,ndir,dir,tag,count,(uint16*)conv);
 			}
 			else
 			{
 				for (i = 0; i < count; ++i)
-					((uint32*)conv)[i] = (uint32)value[i];
+				{
+					if (i < count) {
+						((uint32*)conv)[i] = (uint32)value[i];
+					}
+				}
 				ok = TIFFWriteDirectoryTagLongArray(tif,ndir,dir,tag,count,(uint32*)conv);
 			}
 			break;
@@ -1015,6 +1044,7 @@
 	return (ok);
 }
 
+
 #if 0
 static int
 TIFFWriteDirectoryTagSampleformatPerSample(TIFF* tif, uint32* ndir, TIFFDirEntry* dir, uint16 tag, double value)

2025-02-05 21:10:07.285 | DEBUG    | scenario:rebuild:369 - original environment: environ({'CONDA_SHLVL': '2', 'LC_ALL': 'C.UTF-8', 'LS_COLORS': 'rs=0:di=01;34:ln=01;36:mh=00:pi=40;33:so=01;35:do=01;35:bd=40;33;01:cd=40;33;01:or=40;31;01:mi=00:su=37;41:sg=30;43:ca=30;41:tw=30;42:ow=34;42:st=37;44:ex=01;32:*.tar=01;31:*.tgz=01;31:*.arc=01;31:*.arj=01;31:*.taz=01;31:*.lha=01;31:*.lz4=01;31:*.lzh=01;31:*.lzma=01;31:*.tlz=01;31:*.txz=01;31:*.tzo=01;31:*.t7z=01;31:*.zip=01;31:*.z=01;31:*.Z=01;31:*.dz=01;31:*.gz=01;31:*.lrz=01;31:*.lz=01;31:*.lzo=01;31:*.xz=01;31:*.zst=01;31:*.tzst=01;31:*.bz2=01;31:*.bz=01;31:*.tbz=01;31:*.tbz2=01;31:*.tz=01;31:*.deb=01;31:*.rpm=01;31:*.jar=01;31:*.war=01;31:*.ear=01;31:*.sar=01;31:*.rar=01;31:*.alz=01;31:*.ace=01;31:*.zoo=01;31:*.cpio=01;31:*.7z=01;31:*.rz=01;31:*.cab=01;31:*.wim=01;31:*.swm=01;31:*.dwm=01;31:*.esd=01;31:*.jpg=01;35:*.jpeg=01;35:*.mjpg=01;35:*.mjpeg=01;35:*.gif=01;35:*.bmp=01;35:*.pbm=01;35:*.pgm=01;35:*.ppm=01;35:*.tga=01;35:*.xbm=01;35:*.xpm=01;35:*.tif=01;35:*.tiff=01;35:*.png=01;35:*.svg=01;35:*.svgz=01;35:*.mng=01;35:*.pcx=01;35:*.mov=01;35:*.mpg=01;35:*.mpeg=01;35:*.m2v=01;35:*.mkv=01;35:*.webm=01;35:*.ogm=01;35:*.mp4=01;35:*.m4v=01;35:*.mp4v=01;35:*.vob=01;35:*.qt=01;35:*.nuv=01;35:*.wmv=01;35:*.asf=01;35:*.rm=01;35:*.rmvb=01;35:*.flc=01;35:*.avi=01;35:*.fli=01;35:*.flv=01;35:*.gl=01;35:*.dl=01;35:*.xcf=01;35:*.xwd=01;35:*.yuv=01;35:*.cgm=01;35:*.emf=01;35:*.ogv=01;35:*.ogx=01;35:*.aac=00;36:*.au=00;36:*.flac=00;36:*.m4a=00;36:*.mid=00;36:*.midi=00;36:*.mka=00;36:*.mp3=00;36:*.mpc=00;36:*.ogg=00;36:*.ra=00;36:*.wav=00;36:*.oga=00;36:*.opus=00;36:*.spx=00;36:*.xspf=00;36:', 'LD_LIBRARY_PATH': '/opt/crashrepair/lib:/CrashRepair/lib:/klee/build/lib:', 'CONDA_EXE': '/root/anaconda3/bin/conda', 'LANG': 'C.UTF-8', 'TZ': 'Asia/Shanghai', 'HOSTNAME': 'fea22102047d', 'OLDPWD': '/orchestrator', 'CONDA_PREFIX': '/root/anaconda3/envs/CrashRepair', '_CE_M': '', 'CC': 'crepair-cc', 'LLVM_COMPILER': 'clang', 'CONDA_PREFIX_1': '/root/anaconda3', 'PWD': '/orchestrator/crashrepair', 'HOME': '/root', 'CONDA_PYTHON_EXE': '/root/anaconda3/bin/python', '_CE_CONDA': '', 'CONDA_PROMPT_MODIFIER': '(CrashRepair) ', 'CXX': 'crepair-cxx', 'TERM': 'xterm', 'SHLVL': '2', 'PYTHONPATH': '/usr/lib/python3.8/site-packages:', 'PATH': '/root/anaconda3/envs/CrashRepair/bin:/root/anaconda3/condabin:~/anaconda3/bin:/opt/crashrepair/bin:/CrashRepair/compiler:/klee/build/bin:/opt/llvm-6/bin:/klee/build/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', 'CONDA_DEFAULT_ENV': 'CrashRepair', '_': '/root/anaconda3/envs/CrashRepair/bin/python'})
2025-02-05 21:10:07.285 | DEBUG    | scenario:rebuild:398 - using environment: {'INJECT_CFLAGS': '-g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy ', 'INJECT_CXXFLAGS': '-g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy ', 'INJECT_LDFLAGS': '-g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy '}
2025-02-05 21:10:07.285 | DEBUG    | shell:__call__:41 - executing: make CFLAGS="-fsanitize=float-cast-overflow ${INJECT_CFLAGS}" CXXFLAGS="-fsanitize=float-cast-overflow ${INJECT_CXXFLAGS}" LDFLAGS="${INJECT_LDFLAGS}"
Making all in port
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/port'
make[1]: Nothing to be done for 'all'.
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/port'
Making all in libtiff
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/libtiff'
make  all-am
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/libtiff'
/bin/bash ../libtool  --tag=CC   --mode=compile crepair-cc -DHAVE_CONFIG_H -I.     -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -MT tif_dirwrite.lo -MD -MP -MF .deps/tif_dirwrite.Tpo -c -o tif_dirwrite.lo tif_dirwrite.c
libtool: compile:  crepair-cc -DHAVE_CONFIG_H -I. -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -MT tif_dirwrite.lo -MD -MP -MF .deps/tif_dirwrite.Tpo -c tif_dirwrite.c -o tif_dirwrite.o
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
mv -f .deps/tif_dirwrite.Tpo .deps/tif_dirwrite.Plo
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -no-undefined -version-info 7:5:2   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o libtiff.la -rpath /usr/local/lib tif_aux.lo tif_close.lo tif_codec.lo tif_color.lo tif_compress.lo tif_dir.lo tif_dirinfo.lo tif_dirread.lo tif_dirwrite.lo tif_dumpmode.lo tif_error.lo tif_extension.lo tif_fax3.lo tif_fax3sm.lo tif_flush.lo tif_getimage.lo tif_jbig.lo tif_jpeg.lo tif_jpeg_12.lo tif_luv.lo tif_lzma.lo tif_lzw.lo tif_next.lo tif_ojpeg.lo tif_open.lo tif_packbits.lo tif_pixarlog.lo tif_predict.lo tif_print.lo tif_read.lo tif_strip.lo tif_swab.lo tif_thunder.lo tif_tile.lo tif_version.lo tif_warning.lo tif_write.lo tif_zip.lo  tif_unix.lo ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: rm -fr  .libs/libtiff.a .libs/libtiff.la .libs/libtiff.lai
libtool: link: (cd .libs/libtiff.lax/libport.a && ar x "/data/vulnloc/libtiff/CVE-2017-7600/src/libtiff/../port/.libs/libport.a")
libtool: link: ar cru .libs/libtiff.a  tif_aux.o tif_close.o tif_codec.o tif_color.o tif_compress.o tif_dir.o tif_dirinfo.o tif_dirread.o tif_dirwrite.o tif_dumpmode.o tif_error.o tif_extension.o tif_fax3.o tif_fax3sm.o tif_flush.o tif_getimage.o tif_jbig.o tif_jpeg.o tif_jpeg_12.o tif_luv.o tif_lzma.o tif_lzw.o tif_next.o tif_ojpeg.o tif_open.o tif_packbits.o tif_pixarlog.o tif_predict.o tif_print.o tif_read.o tif_strip.o tif_swab.o tif_thunder.o tif_tile.o tif_version.o tif_warning.o tif_write.o tif_zip.o tif_unix.o  .libs/libtiff.lax/libport.a/dummy.o 
ar: `u' modifier ignored since `D' is the default (see `U')
libtool: link: ranlib .libs/libtiff.a
libtool: link: rm -fr .libs/libtiff.lax
libtool: link: ( cd ".libs" && rm -f "libtiff.la" && ln -s "../libtiff.la" "libtiff.la" )
/bin/bash ../libtool  --tag=CXX   --mode=link crepair-cxx  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -no-undefined -version-info 7:5:2   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o libtiffxx.la -rpath /usr/local/lib tif_stream.lo ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: rm -fr  .libs/libtiffxx.a .libs/libtiffxx.la .libs/libtiffxx.lai
libtool: link: (cd .libs/libtiffxx.lax/libport.a && ar x "/data/vulnloc/libtiff/CVE-2017-7600/src/libtiff/../port/.libs/libport.a")
libtool: link: ar cru .libs/libtiffxx.a  tif_stream.o  .libs/libtiffxx.lax/libport.a/dummy.o 
ar: `u' modifier ignored since `D' is the default (see `U')
libtool: link: ranlib .libs/libtiffxx.a
libtool: link: rm -fr .libs/libtiffxx.lax
libtool: link: ( cd ".libs" && rm -f "libtiffxx.la" && ln -s "../libtiffxx.la" "libtiffxx.la" )
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/libtiff'
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/libtiff'
Making all in tools
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/tools'
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o bmp2tiff bmp2tiff.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o bmp2tiff bmp2tiff.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o fax2ps fax2ps.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o fax2ps fax2ps.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o fax2tiff fax2tiff.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o fax2tiff fax2tiff.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o gif2tiff gif2tiff.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o gif2tiff gif2tiff.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o pal2rgb pal2rgb.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o pal2rgb pal2rgb.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o ppm2tiff ppm2tiff.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o ppm2tiff ppm2tiff.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o ras2tiff ras2tiff.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o ras2tiff ras2tiff.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o raw2tiff raw2tiff.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o raw2tiff raw2tiff.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o rgb2ycbcr rgb2ycbcr.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o rgb2ycbcr rgb2ycbcr.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o thumbnail thumbnail.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o thumbnail thumbnail.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o tiff2bw tiff2bw.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o tiff2bw tiff2bw.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o tiff2pdf tiff2pdf.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o tiff2pdf tiff2pdf.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o tiff2ps tiff2ps.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o tiff2ps tiff2ps.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o tiff2rgba tiff2rgba.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o tiff2rgba tiff2rgba.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o tiffcmp tiffcmp.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o tiffcmp tiffcmp.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o tiffcp tiffcp.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o tiffcp tiffcp.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o tiffcrop tiffcrop.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o tiffcrop tiffcrop.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o tiffdither tiffdither.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o tiffdither tiffdither.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o tiffdump tiffdump.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o tiffdump tiffdump.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o tiffinfo tiffinfo.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o tiffinfo tiffinfo.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o tiffmedian tiffmedian.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o tiffmedian tiffmedian.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o tiffset tiffset.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o tiffset tiffset.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o tiffsplit tiffsplit.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o tiffsplit tiffsplit.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/tools'
Making all in build
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/build'
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/build'
make[2]: Nothing to be done for 'all-am'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/build'
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/build'
Making all in contrib
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib'
Making all in addtiffo
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/addtiffo'
/bin/bash ../../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o addtiffo addtiffo.o tif_overview.o tif_ovrcache.o ../../libtiff/libtiff.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o addtiffo addtiffo.o tif_overview.o tif_ovrcache.o  -L/klee/build/lib -L/CrashRepair/lib ../../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy -llzma -ljbig -ljpeg -lz -lm
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/addtiffo'
Making all in dbs
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/dbs'
Making all in xtiff
make[3]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/dbs/xtiff'
make[3]: Nothing to be done for 'all'.
make[3]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/dbs/xtiff'
make[3]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/dbs'
/bin/bash ../../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o tiff-bi tiff-bi.o ../../libtiff/libtiff.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o tiff-bi tiff-bi.o  -L/klee/build/lib -L/CrashRepair/lib ../../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o tiff-grayscale tiff-grayscale.o ../../libtiff/libtiff.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o tiff-grayscale tiff-grayscale.o  -L/klee/build/lib -L/CrashRepair/lib ../../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o tiff-palette tiff-palette.o ../../libtiff/libtiff.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o tiff-palette tiff-palette.o  -L/klee/build/lib -L/CrashRepair/lib ../../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o tiff-rgb tiff-rgb.o ../../libtiff/libtiff.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o tiff-rgb tiff-rgb.o  -L/klee/build/lib -L/CrashRepair/lib ../../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy -llzma -ljbig -ljpeg -lz -lm
make[3]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/dbs'
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/dbs'
Making all in iptcutil
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/iptcutil'
/bin/bash ../../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o iptcutil iptcutil.o ../../libtiff/libtiff.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o iptcutil iptcutil.o  -L/klee/build/lib -L/CrashRepair/lib ../../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy -llzma -ljbig -ljpeg -lz -lm
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/iptcutil'
Making all in mfs
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/mfs'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/mfs'
Making all in pds
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/pds'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/pds'
Making all in ras
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/ras'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/ras'
Making all in stream
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/stream'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/stream'
Making all in tags
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/tags'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/tags'
Making all in win_dib
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/win_dib'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/win_dib'
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib'
make[2]: Nothing to be done for 'all-am'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib'
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib'
Making all in test
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/test'
make[1]: Nothing to be done for 'all'.
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/test'
Making all in man
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/man'
make[1]: Nothing to be done for 'all'.
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/man'
Making all in html
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/html'
Making all in images
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/html/images'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/html/images'
Making all in man
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/html/man'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/html/man'
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/html'
make[2]: Nothing to be done for 'all-am'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/html'
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/html'
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src'
make[1]: Nothing to be done for 'all-am'.
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src'
2025-02-05 21:10:11.966 | DEBUG    | scenario:evaluate:655 - testing candidate #0 against test #crash...
2025-02-05 21:10:11.966 | DEBUG    | shell:__call__:41 - executing: /data/vulnloc/libtiff/CVE-2017-7600/src/tools/tiffcp -i /CrashRepair/experiments/vulnloc/libtiff/CVE-2017-7600/tests/1.tif out.tiff
2025-02-05 21:10:11.972 | DEBUG    | test:run:172 - test failed: stderr contains bad output substring (runtime error: -115 is outside the range of representable values)
2025-02-05 21:10:11.972 | INFO     | scenario:evaluate:662 - candidate #0 fails test #crash
2025-02-05 21:10:11.978 | INFO     | scenario:evaluate:635 - evaluating candidate patch #1:
@@ -939,6 +939,7 @@
 	return(0);
 }
 
+
 static int
 TIFFWriteDirectoryTagSampleformatArray(TIFF* tif, uint32* ndir, TIFFDirEntry* dir, uint16 tag, uint32 count, double* value)
 {
@@ -971,19 +972,40 @@
 			if (tif->tif_dir.td_bitspersample<=8)
 			{
 				for (i = 0; i < count; ++i)
+				{
+					if(value[i] < INT8_MIN || value[i] > INT8_MAX) {
+						TIFFErrorExt(tif->tif_clientdata, module, "Value out of range for int8");
+						_TIFFfree(conv);
+						return 0;
+					}
 					((int8*)conv)[i] = (int8)value[i];
+				}
 				ok = TIFFWriteDirectoryTagSbyteArray(tif,ndir,dir,tag,count,(int8*)conv);
 			}
 			else if (tif->tif_dir.td_bitspersample<=16)
 			{
 				for (i = 0; i < count; ++i)
+				{
+					if(value[i] < INT16_MIN || value[i] > INT16_MAX) {
+						TIFFErrorExt(tif->tif_clientdata, module, "Value out of range for int16");
+						_TIFFfree(conv);
+						return 0;
+					}
 					((int16*)conv)[i] = (int16)value[i];
+				}
 				ok = TIFFWriteDirectoryTagSshortArray(tif,ndir,dir,tag,count,(int16*)conv);
 			}
 			else
 			{
 				for (i = 0; i < count; ++i)
+				{
+					if(value[i] < INT32_MIN || value[i] > INT32_MAX) {
+						TIFFErrorExt(tif->tif_clientdata, module, "Value out of range for int32");
+						_TIFFfree(conv);
+						return 0;
+					}
 					((int32*)conv)[i] = (int32)value[i];
+				}
 				ok = TIFFWriteDirectoryTagSlongArray(tif,ndir,dir,tag,count,(int32*)conv);
 			}
 			break;
@@ -991,19 +1013,40 @@
 			if (tif->tif_dir.td_bitspersample<=8)
 			{
 				for (i = 0; i < count; ++i)
+				{
+					if(value[i] < 0 || value[i] > UINT8_MAX) {
+						TIFFErrorExt(tif->tif_clientdata, module, "Value out of range for uint8");
+						_TIFFfree(conv);
+						return 0;
+					}
 					((uint8*)conv)[i] = (uint8)value[i];
+				}
 				ok = TIFFWriteDirectoryTagByteArray(tif,ndir,dir,tag,count,(uint8*)conv);
 			}
 			else if (tif->tif_dir.td_bitspersample<=16)
 			{
 				for (i = 0; i < count; ++i)
+				{
+					if(value[i] < 0 || value[i] > UINT16_MAX) {
+						TIFFErrorExt(tif->tif_clientdata, module, "Value out of range for uint16");
+						_TIFFfree(conv);
+						return 0;
+					}
 					((uint16*)conv)[i] = (uint16)value[i];
+				}
 				ok = TIFFWriteDirectoryTagShortArray(tif,ndir,dir,tag,count,(uint16*)conv);
 			}
 			else
 			{
 				for (i = 0; i < count; ++i)
+				{
+					if(value[i] < 0 || value[i] > UINT32_MAX) {
+						TIFFErrorExt(tif->tif_clientdata, module, "Value out of range for uint32");
+						_TIFFfree(conv);
+						return 0;
+					}
 					((uint32*)conv)[i] = (uint32)value[i];
+				}
 				ok = TIFFWriteDirectoryTagLongArray(tif,ndir,dir,tag,count,(uint32*)conv);
 			}
 			break;
@@ -1015,6 +1058,7 @@
 	return (ok);
 }
 
+
 #if 0
 static int
 TIFFWriteDirectoryTagSampleformatPerSample(TIFF* tif, uint32* ndir, TIFFDirEntry* dir, uint16 tag, double value)

2025-02-05 21:10:11.983 | DEBUG    | scenario:rebuild:369 - original environment: environ({'CONDA_SHLVL': '2', 'LC_ALL': 'C.UTF-8', 'LS_COLORS': 'rs=0:di=01;34:ln=01;36:mh=00:pi=40;33:so=01;35:do=01;35:bd=40;33;01:cd=40;33;01:or=40;31;01:mi=00:su=37;41:sg=30;43:ca=30;41:tw=30;42:ow=34;42:st=37;44:ex=01;32:*.tar=01;31:*.tgz=01;31:*.arc=01;31:*.arj=01;31:*.taz=01;31:*.lha=01;31:*.lz4=01;31:*.lzh=01;31:*.lzma=01;31:*.tlz=01;31:*.txz=01;31:*.tzo=01;31:*.t7z=01;31:*.zip=01;31:*.z=01;31:*.Z=01;31:*.dz=01;31:*.gz=01;31:*.lrz=01;31:*.lz=01;31:*.lzo=01;31:*.xz=01;31:*.zst=01;31:*.tzst=01;31:*.bz2=01;31:*.bz=01;31:*.tbz=01;31:*.tbz2=01;31:*.tz=01;31:*.deb=01;31:*.rpm=01;31:*.jar=01;31:*.war=01;31:*.ear=01;31:*.sar=01;31:*.rar=01;31:*.alz=01;31:*.ace=01;31:*.zoo=01;31:*.cpio=01;31:*.7z=01;31:*.rz=01;31:*.cab=01;31:*.wim=01;31:*.swm=01;31:*.dwm=01;31:*.esd=01;31:*.jpg=01;35:*.jpeg=01;35:*.mjpg=01;35:*.mjpeg=01;35:*.gif=01;35:*.bmp=01;35:*.pbm=01;35:*.pgm=01;35:*.ppm=01;35:*.tga=01;35:*.xbm=01;35:*.xpm=01;35:*.tif=01;35:*.tiff=01;35:*.png=01;35:*.svg=01;35:*.svgz=01;35:*.mng=01;35:*.pcx=01;35:*.mov=01;35:*.mpg=01;35:*.mpeg=01;35:*.m2v=01;35:*.mkv=01;35:*.webm=01;35:*.ogm=01;35:*.mp4=01;35:*.m4v=01;35:*.mp4v=01;35:*.vob=01;35:*.qt=01;35:*.nuv=01;35:*.wmv=01;35:*.asf=01;35:*.rm=01;35:*.rmvb=01;35:*.flc=01;35:*.avi=01;35:*.fli=01;35:*.flv=01;35:*.gl=01;35:*.dl=01;35:*.xcf=01;35:*.xwd=01;35:*.yuv=01;35:*.cgm=01;35:*.emf=01;35:*.ogv=01;35:*.ogx=01;35:*.aac=00;36:*.au=00;36:*.flac=00;36:*.m4a=00;36:*.mid=00;36:*.midi=00;36:*.mka=00;36:*.mp3=00;36:*.mpc=00;36:*.ogg=00;36:*.ra=00;36:*.wav=00;36:*.oga=00;36:*.opus=00;36:*.spx=00;36:*.xspf=00;36:', 'LD_LIBRARY_PATH': '/opt/crashrepair/lib:/CrashRepair/lib:/klee/build/lib:', 'CONDA_EXE': '/root/anaconda3/bin/conda', 'LANG': 'C.UTF-8', 'TZ': 'Asia/Shanghai', 'HOSTNAME': 'fea22102047d', 'OLDPWD': '/orchestrator', 'CONDA_PREFIX': '/root/anaconda3/envs/CrashRepair', '_CE_M': '', 'CC': 'crepair-cc', 'LLVM_COMPILER': 'clang', 'CONDA_PREFIX_1': '/root/anaconda3', 'PWD': '/orchestrator/crashrepair', 'HOME': '/root', 'CONDA_PYTHON_EXE': '/root/anaconda3/bin/python', '_CE_CONDA': '', 'CONDA_PROMPT_MODIFIER': '(CrashRepair) ', 'CXX': 'crepair-cxx', 'TERM': 'xterm', 'SHLVL': '2', 'PYTHONPATH': '/usr/lib/python3.8/site-packages:', 'PATH': '/root/anaconda3/envs/CrashRepair/bin:/root/anaconda3/condabin:~/anaconda3/bin:/opt/crashrepair/bin:/CrashRepair/compiler:/klee/build/bin:/opt/llvm-6/bin:/klee/build/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', 'CONDA_DEFAULT_ENV': 'CrashRepair', '_': '/root/anaconda3/envs/CrashRepair/bin/python'})
2025-02-05 21:10:11.983 | DEBUG    | scenario:rebuild:398 - using environment: {'INJECT_CFLAGS': '-g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy ', 'INJECT_CXXFLAGS': '-g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy ', 'INJECT_LDFLAGS': '-g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy '}
2025-02-05 21:10:11.983 | DEBUG    | shell:__call__:41 - executing: make CFLAGS="-fsanitize=float-cast-overflow ${INJECT_CFLAGS}" CXXFLAGS="-fsanitize=float-cast-overflow ${INJECT_CXXFLAGS}" LDFLAGS="${INJECT_LDFLAGS}"
Making all in port
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/port'
make[1]: Nothing to be done for 'all'.
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/port'
Making all in libtiff
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/libtiff'
make  all-am
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/libtiff'
/bin/bash ../libtool  --tag=CC   --mode=compile crepair-cc -DHAVE_CONFIG_H -I.     -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -MT tif_dirwrite.lo -MD -MP -MF .deps/tif_dirwrite.Tpo -c -o tif_dirwrite.lo tif_dirwrite.c
libtool: compile:  crepair-cc -DHAVE_CONFIG_H -I. -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -MT tif_dirwrite.lo -MD -MP -MF .deps/tif_dirwrite.Tpo -c tif_dirwrite.c -o tif_dirwrite.o
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
tif_dirwrite.c:976:20: error: use of undeclared identifier 'INT8_MIN'
                                        if(value[i] < INT8_MIN || value[i] > INT8_MAX) {
                                                      ^
tif_dirwrite.c:976:43: error: use of undeclared identifier 'INT8_MAX'
                                        if(value[i] < INT8_MIN || value[i] > INT8_MAX) {
                                                                             ^
tif_dirwrite.c:989:20: error: use of undeclared identifier 'INT16_MIN'
                                        if(value[i] < INT16_MIN || value[i] > INT16_MAX) {
                                                      ^
tif_dirwrite.c:989:44: error: use of undeclared identifier 'INT16_MAX'
                                        if(value[i] < INT16_MIN || value[i] > INT16_MAX) {
                                                                              ^
tif_dirwrite.c:1002:20: error: use of undeclared identifier 'INT32_MIN'
                                        if(value[i] < INT32_MIN || value[i] > INT32_MAX) {
                                                      ^
tif_dirwrite.c:1002:44: error: use of undeclared identifier 'INT32_MAX'
                                        if(value[i] < INT32_MIN || value[i] > INT32_MAX) {
                                                                              ^
tif_dirwrite.c:1017:36: error: use of undeclared identifier 'UINT8_MAX'
                                        if(value[i] < 0 || value[i] > UINT8_MAX) {
                                                                      ^
tif_dirwrite.c:1030:36: error: use of undeclared identifier 'UINT16_MAX'
                                        if(value[i] < 0 || value[i] > UINT16_MAX) {
                                                                      ^
tif_dirwrite.c:1043:36: error: use of undeclared identifier 'UINT32_MAX'
                                        if(value[i] < 0 || value[i] > UINT32_MAX) {
                                                                      ^
9 errors generated.
ERROR:Failed to compile using given arguments: [-g -O0 -include /CrashRepair/compiler/../lib/crepair_runtime.h -DHAVE_CONFIG_H -I. -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -MT tif_dirwrite.lo -MD -MP -MF .deps/tif_dirwrite.Tpo -c tif_dirwrite.c -o tif_dirwrite.o -L/CrashRepair/compiler/../lib/ -L/klee/build/lib/ -lcrepair_runtime -lcrepair_proxy -lkleeRuntest -fno-sanitize=address]
Makefile:671: recipe for target 'tif_dirwrite.lo' failed
make[2]: *** [tif_dirwrite.lo] Error 1
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/libtiff'
Makefile:496: recipe for target 'all' failed
make[1]: *** [all] Error 2
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/libtiff'
Makefile:547: recipe for target 'all-recursive' failed
make: *** [all-recursive] Error 1
2025-02-05 21:10:12.080 | INFO     | scenario:evaluate:643 - candidate patch #1 failed to compile
2025-02-05 21:10:12.090 | INFO     | scenario:evaluate:635 - evaluating candidate patch #2:
@@ -939,6 +939,7 @@
 	return(0);
 }
 
+
 static int
 TIFFWriteDirectoryTagSampleformatArray(TIFF* tif, uint32* ndir, TIFFDirEntry* dir, uint16 tag, uint32 count, double* value)
 {
@@ -971,13 +972,13 @@
 			if (tif->tif_dir.td_bitspersample<=8)
 			{
 				for (i = 0; i < count; ++i)
-					((int8*)conv)[i] = (int8)value[i];
+					((int8*)conv)[i] = (int8)(value[i] < INT8_MIN ? INT8_MIN : (value[i] > INT8_MAX ? INT8_MAX : value[i]));
 				ok = TIFFWriteDirectoryTagSbyteArray(tif,ndir,dir,tag,count,(int8*)conv);
 			}
 			else if (tif->tif_dir.td_bitspersample<=16)
 			{
 				for (i = 0; i < count; ++i)
-					((int16*)conv)[i] = (int16)value[i];
+					((int16*)conv)[i] = (int16)(value[i] < INT16_MIN ? INT16_MIN : (value[i] > INT16_MAX ? INT16_MAX : value[i]));
 				ok = TIFFWriteDirectoryTagSshortArray(tif,ndir,dir,tag,count,(int16*)conv);
 			}
 			else
@@ -991,13 +992,13 @@
 			if (tif->tif_dir.td_bitspersample<=8)
 			{
 				for (i = 0; i < count; ++i)
-					((uint8*)conv)[i] = (uint8)value[i];
+					((uint8*)conv)[i] = (uint8)(value[i] < 0 ? 0 : (value[i] > UINT8_MAX ? UINT8_MAX : value[i]));
 				ok = TIFFWriteDirectoryTagByteArray(tif,ndir,dir,tag,count,(uint8*)conv);
 			}
 			else if (tif->tif_dir.td_bitspersample<=16)
 			{
 				for (i = 0; i < count; ++i)
-					((uint16*)conv)[i] = (uint16)value[i];
+					((uint16*)conv)[i] = (uint16)(value[i] < 0 ? 0 : (value[i] > UINT16_MAX ? UINT16_MAX : value[i]));
 				ok = TIFFWriteDirectoryTagShortArray(tif,ndir,dir,tag,count,(uint16*)conv);
 			}
 			else
@@ -1015,6 +1016,7 @@
 	return (ok);
 }
 
+
 #if 0
 static int
 TIFFWriteDirectoryTagSampleformatPerSample(TIFF* tif, uint32* ndir, TIFFDirEntry* dir, uint16 tag, double value)

2025-02-05 21:10:12.095 | DEBUG    | scenario:rebuild:369 - original environment: environ({'CONDA_SHLVL': '2', 'LC_ALL': 'C.UTF-8', 'LS_COLORS': 'rs=0:di=01;34:ln=01;36:mh=00:pi=40;33:so=01;35:do=01;35:bd=40;33;01:cd=40;33;01:or=40;31;01:mi=00:su=37;41:sg=30;43:ca=30;41:tw=30;42:ow=34;42:st=37;44:ex=01;32:*.tar=01;31:*.tgz=01;31:*.arc=01;31:*.arj=01;31:*.taz=01;31:*.lha=01;31:*.lz4=01;31:*.lzh=01;31:*.lzma=01;31:*.tlz=01;31:*.txz=01;31:*.tzo=01;31:*.t7z=01;31:*.zip=01;31:*.z=01;31:*.Z=01;31:*.dz=01;31:*.gz=01;31:*.lrz=01;31:*.lz=01;31:*.lzo=01;31:*.xz=01;31:*.zst=01;31:*.tzst=01;31:*.bz2=01;31:*.bz=01;31:*.tbz=01;31:*.tbz2=01;31:*.tz=01;31:*.deb=01;31:*.rpm=01;31:*.jar=01;31:*.war=01;31:*.ear=01;31:*.sar=01;31:*.rar=01;31:*.alz=01;31:*.ace=01;31:*.zoo=01;31:*.cpio=01;31:*.7z=01;31:*.rz=01;31:*.cab=01;31:*.wim=01;31:*.swm=01;31:*.dwm=01;31:*.esd=01;31:*.jpg=01;35:*.jpeg=01;35:*.mjpg=01;35:*.mjpeg=01;35:*.gif=01;35:*.bmp=01;35:*.pbm=01;35:*.pgm=01;35:*.ppm=01;35:*.tga=01;35:*.xbm=01;35:*.xpm=01;35:*.tif=01;35:*.tiff=01;35:*.png=01;35:*.svg=01;35:*.svgz=01;35:*.mng=01;35:*.pcx=01;35:*.mov=01;35:*.mpg=01;35:*.mpeg=01;35:*.m2v=01;35:*.mkv=01;35:*.webm=01;35:*.ogm=01;35:*.mp4=01;35:*.m4v=01;35:*.mp4v=01;35:*.vob=01;35:*.qt=01;35:*.nuv=01;35:*.wmv=01;35:*.asf=01;35:*.rm=01;35:*.rmvb=01;35:*.flc=01;35:*.avi=01;35:*.fli=01;35:*.flv=01;35:*.gl=01;35:*.dl=01;35:*.xcf=01;35:*.xwd=01;35:*.yuv=01;35:*.cgm=01;35:*.emf=01;35:*.ogv=01;35:*.ogx=01;35:*.aac=00;36:*.au=00;36:*.flac=00;36:*.m4a=00;36:*.mid=00;36:*.midi=00;36:*.mka=00;36:*.mp3=00;36:*.mpc=00;36:*.ogg=00;36:*.ra=00;36:*.wav=00;36:*.oga=00;36:*.opus=00;36:*.spx=00;36:*.xspf=00;36:', 'LD_LIBRARY_PATH': '/opt/crashrepair/lib:/CrashRepair/lib:/klee/build/lib:', 'CONDA_EXE': '/root/anaconda3/bin/conda', 'LANG': 'C.UTF-8', 'TZ': 'Asia/Shanghai', 'HOSTNAME': 'fea22102047d', 'OLDPWD': '/orchestrator', 'CONDA_PREFIX': '/root/anaconda3/envs/CrashRepair', '_CE_M': '', 'CC': 'crepair-cc', 'LLVM_COMPILER': 'clang', 'CONDA_PREFIX_1': '/root/anaconda3', 'PWD': '/orchestrator/crashrepair', 'HOME': '/root', 'CONDA_PYTHON_EXE': '/root/anaconda3/bin/python', '_CE_CONDA': '', 'CONDA_PROMPT_MODIFIER': '(CrashRepair) ', 'CXX': 'crepair-cxx', 'TERM': 'xterm', 'SHLVL': '2', 'PYTHONPATH': '/usr/lib/python3.8/site-packages:', 'PATH': '/root/anaconda3/envs/CrashRepair/bin:/root/anaconda3/condabin:~/anaconda3/bin:/opt/crashrepair/bin:/CrashRepair/compiler:/klee/build/bin:/opt/llvm-6/bin:/klee/build/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', 'CONDA_DEFAULT_ENV': 'CrashRepair', '_': '/root/anaconda3/envs/CrashRepair/bin/python'})
2025-02-05 21:10:12.096 | DEBUG    | scenario:rebuild:398 - using environment: {'INJECT_CFLAGS': '-g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy ', 'INJECT_CXXFLAGS': '-g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy ', 'INJECT_LDFLAGS': '-g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy '}
2025-02-05 21:10:12.096 | DEBUG    | shell:__call__:41 - executing: make CFLAGS="-fsanitize=float-cast-overflow ${INJECT_CFLAGS}" CXXFLAGS="-fsanitize=float-cast-overflow ${INJECT_CXXFLAGS}" LDFLAGS="${INJECT_LDFLAGS}"
Making all in port
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/port'
make[1]: Nothing to be done for 'all'.
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/port'
Making all in libtiff
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/libtiff'
make  all-am
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/libtiff'
/bin/bash ../libtool  --tag=CC   --mode=compile crepair-cc -DHAVE_CONFIG_H -I.     -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -MT tif_dirwrite.lo -MD -MP -MF .deps/tif_dirwrite.Tpo -c -o tif_dirwrite.lo tif_dirwrite.c
libtool: compile:  crepair-cc -DHAVE_CONFIG_H -I. -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -MT tif_dirwrite.lo -MD -MP -MF .deps/tif_dirwrite.Tpo -c tif_dirwrite.c -o tif_dirwrite.o
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
tif_dirwrite.c:975:43: error: use of undeclared identifier 'INT8_MIN'
                                        ((int8*)conv)[i] = (int8)(value[i] < INT8_MIN ? INT8_MIN : (value[i] > INT8_MAX ? INT8_MAX : value[i]));
                                                                             ^
tif_dirwrite.c:975:77: error: use of undeclared identifier 'INT8_MAX'
                                        ((int8*)conv)[i] = (int8)(value[i] < INT8_MIN ? INT8_MIN : (value[i] > INT8_MAX ? INT8_MAX : value[i]));
                                                                                                               ^
tif_dirwrite.c:975:88: error: use of undeclared identifier 'INT8_MAX'
                                        ((int8*)conv)[i] = (int8)(value[i] < INT8_MIN ? INT8_MIN : (value[i] > INT8_MAX ? INT8_MAX : value[i]));
                                                                                                                          ^
tif_dirwrite.c:975:54: error: use of undeclared identifier 'INT8_MIN'
                                        ((int8*)conv)[i] = (int8)(value[i] < INT8_MIN ? INT8_MIN : (value[i] > INT8_MAX ? INT8_MAX : value[i]));
                                                                                        ^
tif_dirwrite.c:981:45: error: use of undeclared identifier 'INT16_MIN'
                                        ((int16*)conv)[i] = (int16)(value[i] < INT16_MIN ? INT16_MIN : (value[i] > INT16_MAX ? INT16_MAX : value[i]));
                                                                               ^
tif_dirwrite.c:981:81: error: use of undeclared identifier 'INT16_MAX'
                                        ((int16*)conv)[i] = (int16)(value[i] < INT16_MIN ? INT16_MIN : (value[i] > INT16_MAX ? INT16_MAX : value[i]));
                                                                                                                   ^
tif_dirwrite.c:981:93: error: use of undeclared identifier 'INT16_MAX'
                                        ((int16*)conv)[i] = (int16)(value[i] < INT16_MIN ? INT16_MIN : (value[i] > INT16_MAX ? INT16_MAX : value[i]));
                                                                                                                               ^
tif_dirwrite.c:981:57: error: use of undeclared identifier 'INT16_MIN'
                                        ((int16*)conv)[i] = (int16)(value[i] < INT16_MIN ? INT16_MIN : (value[i] > INT16_MAX ? INT16_MAX : value[i]));
                                                                                           ^
tif_dirwrite.c:995:65: error: use of undeclared identifier 'UINT8_MAX'
                                        ((uint8*)conv)[i] = (uint8)(value[i] < 0 ? 0 : (value[i] > UINT8_MAX ? UINT8_MAX : value[i]));
                                                                                                   ^
tif_dirwrite.c:995:77: error: use of undeclared identifier 'UINT8_MAX'
                                        ((uint8*)conv)[i] = (uint8)(value[i] < 0 ? 0 : (value[i] > UINT8_MAX ? UINT8_MAX : value[i]));
                                                                                                               ^
tif_dirwrite.c:1001:67: error: use of undeclared identifier 'UINT16_MAX'
                                        ((uint16*)conv)[i] = (uint16)(value[i] < 0 ? 0 : (value[i] > UINT16_MAX ? UINT16_MAX : value[i]));
                                                                                                     ^
tif_dirwrite.c:1001:80: error: use of undeclared identifier 'UINT16_MAX'
                                        ((uint16*)conv)[i] = (uint16)(value[i] < 0 ? 0 : (value[i] > UINT16_MAX ? UINT16_MAX : value[i]));
                                                                                                                  ^
12 errors generated.
ERROR:Failed to compile using given arguments: [-g -O0 -include /CrashRepair/compiler/../lib/crepair_runtime.h -DHAVE_CONFIG_H -I. -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -MT tif_dirwrite.lo -MD -MP -MF .deps/tif_dirwrite.Tpo -c tif_dirwrite.c -o tif_dirwrite.o -L/CrashRepair/compiler/../lib/ -L/klee/build/lib/ -lcrepair_runtime -lcrepair_proxy -lkleeRuntest -fno-sanitize=address]
Makefile:671: recipe for target 'tif_dirwrite.lo' failed
make[2]: *** [tif_dirwrite.lo] Error 1
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/libtiff'
Makefile:496: recipe for target 'all' failed
make[1]: *** [all] Error 2
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/libtiff'
Makefile:547: recipe for target 'all-recursive' failed
make: *** [all-recursive] Error 1
2025-02-05 21:10:12.191 | INFO     | scenario:evaluate:643 - candidate patch #2 failed to compile
2025-02-05 21:10:12.197 | INFO     | scenario:evaluate:635 - evaluating candidate patch #3:
@@ -939,6 +939,7 @@
 	return(0);
 }
 
+
 static int
 TIFFWriteDirectoryTagSampleformatArray(TIFF* tif, uint32* ndir, TIFFDirEntry* dir, uint16 tag, uint32 count, double* value)
 {
@@ -971,18 +972,33 @@
 			if (tif->tif_dir.td_bitspersample<=8)
 			{
 				for (i = 0; i < count; ++i)
+					if (value[i] < INT8_MIN || value[i] > INT8_MAX) {
+						TIFFErrorExt(tif->tif_clientdata, module, "Value out of range for int8");
+						_TIFFfree(conv);
+						return 0;
+					}
 					((int8*)conv)[i] = (int8)value[i];
 				ok = TIFFWriteDirectoryTagSbyteArray(tif,ndir,dir,tag,count,(int8*)conv);
 			}
 			else if (tif->tif_dir.td_bitspersample<=16)
 			{
 				for (i = 0; i < count; ++i)
+					if (value[i] < INT16_MIN || value[i] > INT16_MAX) {
+						TIFFErrorExt(tif->tif_clientdata, module, "Value out of range for int16");
+						_TIFFfree(conv);
+						return 0;
+					}
 					((int16*)conv)[i] = (int16)value[i];
 				ok = TIFFWriteDirectoryTagSshortArray(tif,ndir,dir,tag,count,(int16*)conv);
 			}
 			else
 			{
 				for (i = 0; i < count; ++i)
+					if (value[i] < INT32_MIN || value[i] > INT32_MAX) {
+						TIFFErrorExt(tif->tif_clientdata, module, "Value out of range for int32");
+						_TIFFfree(conv);
+						return 0;
+					}
 					((int32*)conv)[i] = (int32)value[i];
 				ok = TIFFWriteDirectoryTagSlongArray(tif,ndir,dir,tag,count,(int32*)conv);
 			}
@@ -991,18 +1007,33 @@
 			if (tif->tif_dir.td_bitspersample<=8)
 			{
 				for (i = 0; i < count; ++i)
+					if (value[i] < 0 || value[i] > UINT8_MAX) {
+						TIFFErrorExt(tif->tif_clientdata, module, "Value out of range for uint8");
+						_TIFFfree(conv);
+						return 0;
+					}
 					((uint8*)conv)[i] = (uint8)value[i];
 				ok = TIFFWriteDirectoryTagByteArray(tif,ndir,dir,tag,count,(uint8*)conv);
 			}
 			else if (tif->tif_dir.td_bitspersample<=16)
 			{
 				for (i = 0; i < count; ++i)
+					if (value[i] < 0 || value[i] > UINT16_MAX) {
+						TIFFErrorExt(tif->tif_clientdata, module, "Value out of range for uint16");
+						_TIFFfree(conv);
+						return 0;
+					}
 					((uint16*)conv)[i] = (uint16)value[i];
 				ok = TIFFWriteDirectoryTagShortArray(tif,ndir,dir,tag,count,(uint16*)conv);
 			}
 			else
 			{
 				for (i = 0; i < count; ++i)
+					if (value[i] < 0 || value[i] > UINT32_MAX) {
+						TIFFErrorExt(tif->tif_clientdata, module, "Value out of range for uint32");
+						_TIFFfree(conv);
+						return 0;
+					}
 					((uint32*)conv)[i] = (uint32)value[i];
 				ok = TIFFWriteDirectoryTagLongArray(tif,ndir,dir,tag,count,(uint32*)conv);
 			}
@@ -1015,6 +1046,7 @@
 	return (ok);
 }
 
+
 #if 0
 static int
 TIFFWriteDirectoryTagSampleformatPerSample(TIFF* tif, uint32* ndir, TIFFDirEntry* dir, uint16 tag, double value)

2025-02-05 21:10:12.203 | DEBUG    | scenario:rebuild:369 - original environment: environ({'CONDA_SHLVL': '2', 'LC_ALL': 'C.UTF-8', 'LS_COLORS': 'rs=0:di=01;34:ln=01;36:mh=00:pi=40;33:so=01;35:do=01;35:bd=40;33;01:cd=40;33;01:or=40;31;01:mi=00:su=37;41:sg=30;43:ca=30;41:tw=30;42:ow=34;42:st=37;44:ex=01;32:*.tar=01;31:*.tgz=01;31:*.arc=01;31:*.arj=01;31:*.taz=01;31:*.lha=01;31:*.lz4=01;31:*.lzh=01;31:*.lzma=01;31:*.tlz=01;31:*.txz=01;31:*.tzo=01;31:*.t7z=01;31:*.zip=01;31:*.z=01;31:*.Z=01;31:*.dz=01;31:*.gz=01;31:*.lrz=01;31:*.lz=01;31:*.lzo=01;31:*.xz=01;31:*.zst=01;31:*.tzst=01;31:*.bz2=01;31:*.bz=01;31:*.tbz=01;31:*.tbz2=01;31:*.tz=01;31:*.deb=01;31:*.rpm=01;31:*.jar=01;31:*.war=01;31:*.ear=01;31:*.sar=01;31:*.rar=01;31:*.alz=01;31:*.ace=01;31:*.zoo=01;31:*.cpio=01;31:*.7z=01;31:*.rz=01;31:*.cab=01;31:*.wim=01;31:*.swm=01;31:*.dwm=01;31:*.esd=01;31:*.jpg=01;35:*.jpeg=01;35:*.mjpg=01;35:*.mjpeg=01;35:*.gif=01;35:*.bmp=01;35:*.pbm=01;35:*.pgm=01;35:*.ppm=01;35:*.tga=01;35:*.xbm=01;35:*.xpm=01;35:*.tif=01;35:*.tiff=01;35:*.png=01;35:*.svg=01;35:*.svgz=01;35:*.mng=01;35:*.pcx=01;35:*.mov=01;35:*.mpg=01;35:*.mpeg=01;35:*.m2v=01;35:*.mkv=01;35:*.webm=01;35:*.ogm=01;35:*.mp4=01;35:*.m4v=01;35:*.mp4v=01;35:*.vob=01;35:*.qt=01;35:*.nuv=01;35:*.wmv=01;35:*.asf=01;35:*.rm=01;35:*.rmvb=01;35:*.flc=01;35:*.avi=01;35:*.fli=01;35:*.flv=01;35:*.gl=01;35:*.dl=01;35:*.xcf=01;35:*.xwd=01;35:*.yuv=01;35:*.cgm=01;35:*.emf=01;35:*.ogv=01;35:*.ogx=01;35:*.aac=00;36:*.au=00;36:*.flac=00;36:*.m4a=00;36:*.mid=00;36:*.midi=00;36:*.mka=00;36:*.mp3=00;36:*.mpc=00;36:*.ogg=00;36:*.ra=00;36:*.wav=00;36:*.oga=00;36:*.opus=00;36:*.spx=00;36:*.xspf=00;36:', 'LD_LIBRARY_PATH': '/opt/crashrepair/lib:/CrashRepair/lib:/klee/build/lib:', 'CONDA_EXE': '/root/anaconda3/bin/conda', 'LANG': 'C.UTF-8', 'TZ': 'Asia/Shanghai', 'HOSTNAME': 'fea22102047d', 'OLDPWD': '/orchestrator', 'CONDA_PREFIX': '/root/anaconda3/envs/CrashRepair', '_CE_M': '', 'CC': 'crepair-cc', 'LLVM_COMPILER': 'clang', 'CONDA_PREFIX_1': '/root/anaconda3', 'PWD': '/orchestrator/crashrepair', 'HOME': '/root', 'CONDA_PYTHON_EXE': '/root/anaconda3/bin/python', '_CE_CONDA': '', 'CONDA_PROMPT_MODIFIER': '(CrashRepair) ', 'CXX': 'crepair-cxx', 'TERM': 'xterm', 'SHLVL': '2', 'PYTHONPATH': '/usr/lib/python3.8/site-packages:', 'PATH': '/root/anaconda3/envs/CrashRepair/bin:/root/anaconda3/condabin:~/anaconda3/bin:/opt/crashrepair/bin:/CrashRepair/compiler:/klee/build/bin:/opt/llvm-6/bin:/klee/build/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', 'CONDA_DEFAULT_ENV': 'CrashRepair', '_': '/root/anaconda3/envs/CrashRepair/bin/python'})
2025-02-05 21:10:12.203 | DEBUG    | scenario:rebuild:398 - using environment: {'INJECT_CFLAGS': '-g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy ', 'INJECT_CXXFLAGS': '-g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy ', 'INJECT_LDFLAGS': '-g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy '}
2025-02-05 21:10:12.203 | DEBUG    | shell:__call__:41 - executing: make CFLAGS="-fsanitize=float-cast-overflow ${INJECT_CFLAGS}" CXXFLAGS="-fsanitize=float-cast-overflow ${INJECT_CXXFLAGS}" LDFLAGS="${INJECT_LDFLAGS}"
Making all in port
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/port'
make[1]: Nothing to be done for 'all'.
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/port'
Making all in libtiff
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/libtiff'
make  all-am
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/libtiff'
/bin/bash ../libtool  --tag=CC   --mode=compile crepair-cc -DHAVE_CONFIG_H -I.     -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -MT tif_dirwrite.lo -MD -MP -MF .deps/tif_dirwrite.Tpo -c -o tif_dirwrite.lo tif_dirwrite.c
libtool: compile:  crepair-cc -DHAVE_CONFIG_H -I. -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -MT tif_dirwrite.lo -MD -MP -MF .deps/tif_dirwrite.Tpo -c tif_dirwrite.c -o tif_dirwrite.o
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
tif_dirwrite.c:975:21: error: use of undeclared identifier 'INT8_MIN'
                                        if (value[i] < INT8_MIN || value[i] > INT8_MAX) {
                                                       ^
tif_dirwrite.c:975:44: error: use of undeclared identifier 'INT8_MAX'
                                        if (value[i] < INT8_MIN || value[i] > INT8_MAX) {
                                                                              ^
tif_dirwrite.c:986:21: error: use of undeclared identifier 'INT16_MIN'
                                        if (value[i] < INT16_MIN || value[i] > INT16_MAX) {
                                                       ^
tif_dirwrite.c:986:45: error: use of undeclared identifier 'INT16_MAX'
                                        if (value[i] < INT16_MIN || value[i] > INT16_MAX) {
                                                                               ^
tif_dirwrite.c:997:21: error: use of undeclared identifier 'INT32_MIN'
                                        if (value[i] < INT32_MIN || value[i] > INT32_MAX) {
                                                       ^
tif_dirwrite.c:997:45: error: use of undeclared identifier 'INT32_MAX'
                                        if (value[i] < INT32_MIN || value[i] > INT32_MAX) {
                                                                               ^
tif_dirwrite.c:1010:37: error: use of undeclared identifier 'UINT8_MAX'
                                        if (value[i] < 0 || value[i] > UINT8_MAX) {
                                                                       ^
tif_dirwrite.c:1021:37: error: use of undeclared identifier 'UINT16_MAX'
                                        if (value[i] < 0 || value[i] > UINT16_MAX) {
                                                                       ^
tif_dirwrite.c:1032:37: error: use of undeclared identifier 'UINT32_MAX'
                                        if (value[i] < 0 || value[i] > UINT32_MAX) {
                                                                       ^
9 errors generated.
ERROR:Failed to compile using given arguments: [-g -O0 -include /CrashRepair/compiler/../lib/crepair_runtime.h -DHAVE_CONFIG_H -I. -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -MT tif_dirwrite.lo -MD -MP -MF .deps/tif_dirwrite.Tpo -c tif_dirwrite.c -o tif_dirwrite.o -L/CrashRepair/compiler/../lib/ -L/klee/build/lib/ -lcrepair_runtime -lcrepair_proxy -lkleeRuntest -fno-sanitize=address]
Makefile:671: recipe for target 'tif_dirwrite.lo' failed
make[2]: *** [tif_dirwrite.lo] Error 1
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/libtiff'
Makefile:496: recipe for target 'all' failed
make[1]: *** [all] Error 2
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/libtiff'
Makefile:547: recipe for target 'all-recursive' failed
make: *** [all-recursive] Error 1
2025-02-05 21:10:12.296 | INFO     | scenario:evaluate:643 - candidate patch #3 failed to compile
2025-02-05 21:10:12.302 | INFO     | scenario:evaluate:635 - evaluating candidate patch #4:
@@ -939,6 +939,7 @@
 	return(0);
 }
 
+
 static int
 TIFFWriteDirectoryTagSampleformatArray(TIFF* tif, uint32* ndir, TIFFDirEntry* dir, uint16 tag, uint32 count, double* value)
 {
@@ -959,7 +960,15 @@
 			if (tif->tif_dir.td_bitspersample<=32)
 			{
 				for (i = 0; i < count; ++i)
+				{
+					if (value[i] < FLT_MIN || value[i] > FLT_MAX)
+					{
+						TIFFErrorExt(tif->tif_clientdata, module, "Float value out of range");
+						_TIFFfree(conv);
+						return (0);
+					}
 					((float*)conv)[i] = (float)value[i];
+				}
 				ok = TIFFWriteDirectoryTagFloatArray(tif,ndir,dir,tag,count,(float*)conv);
 			}
 			else
@@ -971,19 +980,43 @@
 			if (tif->tif_dir.td_bitspersample<=8)
 			{
 				for (i = 0; i < count; ++i)
+				{
+					if (value[i] < INT8_MIN || value[i] > INT8_MAX)
+					{
+						TIFFErrorExt(tif->tif_clientdata, module, "Int8 value out of range");
+						_TIFFfree(conv);
+						return (0);
+					}
 					((int8*)conv)[i] = (int8)value[i];
+				}
 				ok = TIFFWriteDirectoryTagSbyteArray(tif,ndir,dir,tag,count,(int8*)conv);
 			}
 			else if (tif->tif_dir.td_bitspersample<=16)
 			{
 				for (i = 0; i < count; ++i)
+				{
+					if (value[i] < INT16_MIN || value[i] > INT16_MAX)
+					{
+						TIFFErrorExt(tif->tif_clientdata, module, "Int16 value out of range");
+						_TIFFfree(conv);
+						return (0);
+					}
 					((int16*)conv)[i] = (int16)value[i];
+				}
 				ok = TIFFWriteDirectoryTagSshortArray(tif,ndir,dir,tag,count,(int16*)conv);
 			}
 			else
 			{
 				for (i = 0; i < count; ++i)
+				{
+					if (value[i] < INT32_MIN || value[i] > INT32_MAX)
+					{
+						TIFFErrorExt(tif->tif_clientdata, module, "Int32 value out of range");
+						_TIFFfree(conv);
+						return (0);
+					}
 					((int32*)conv)[i] = (int32)value[i];
+				}
 				ok = TIFFWriteDirectoryTagSlongArray(tif,ndir,dir,tag,count,(int32*)conv);
 			}
 			break;
@@ -991,19 +1024,43 @@
 			if (tif->tif_dir.td_bitspersample<=8)
 			{
 				for (i = 0; i < count; ++i)
+				{
+					if (value[i] < 0 || value[i] > UINT8_MAX)
+					{
+						TIFFErrorExt(tif->tif_clientdata, module, "UInt8 value out of range");
+						_TIFFfree(conv);
+						return (0);
+					}
 					((uint8*)conv)[i] = (uint8)value[i];
+				}
 				ok = TIFFWriteDirectoryTagByteArray(tif,ndir,dir,tag,count,(uint8*)conv);
 			}
 			else if (tif->tif_dir.td_bitspersample<=16)
 			{
 				for (i = 0; i < count; ++i)
+				{
+					if (value[i] < 0 || value[i] > UINT16_MAX)
+					{
+						TIFFErrorExt(tif->tif_clientdata, module, "UInt16 value out of range");
+						_TIFFfree(conv);
+						return (0);
+					}
 					((uint16*)conv)[i] = (uint16)value[i];
+				}
 				ok = TIFFWriteDirectoryTagShortArray(tif,ndir,dir,tag,count,(uint16*)conv);
 			}
 			else
 			{
 				for (i = 0; i < count; ++i)
+				{
+					if (value[i] < 0 || value[i] > UINT32_MAX)
+					{
+						TIFFErrorExt(tif->tif_clientdata, module, "UInt32 value out of range");
+						_TIFFfree(conv);
+						return (0);
+					}
 					((uint32*)conv)[i] = (uint32)value[i];
+				}
 				ok = TIFFWriteDirectoryTagLongArray(tif,ndir,dir,tag,count,(uint32*)conv);
 			}
 			break;
@@ -1015,6 +1072,7 @@
 	return (ok);
 }
 
+
 #if 0
 static int
 TIFFWriteDirectoryTagSampleformatPerSample(TIFF* tif, uint32* ndir, TIFFDirEntry* dir, uint16 tag, double value)

2025-02-05 21:10:12.308 | DEBUG    | scenario:rebuild:369 - original environment: environ({'CONDA_SHLVL': '2', 'LC_ALL': 'C.UTF-8', 'LS_COLORS': 'rs=0:di=01;34:ln=01;36:mh=00:pi=40;33:so=01;35:do=01;35:bd=40;33;01:cd=40;33;01:or=40;31;01:mi=00:su=37;41:sg=30;43:ca=30;41:tw=30;42:ow=34;42:st=37;44:ex=01;32:*.tar=01;31:*.tgz=01;31:*.arc=01;31:*.arj=01;31:*.taz=01;31:*.lha=01;31:*.lz4=01;31:*.lzh=01;31:*.lzma=01;31:*.tlz=01;31:*.txz=01;31:*.tzo=01;31:*.t7z=01;31:*.zip=01;31:*.z=01;31:*.Z=01;31:*.dz=01;31:*.gz=01;31:*.lrz=01;31:*.lz=01;31:*.lzo=01;31:*.xz=01;31:*.zst=01;31:*.tzst=01;31:*.bz2=01;31:*.bz=01;31:*.tbz=01;31:*.tbz2=01;31:*.tz=01;31:*.deb=01;31:*.rpm=01;31:*.jar=01;31:*.war=01;31:*.ear=01;31:*.sar=01;31:*.rar=01;31:*.alz=01;31:*.ace=01;31:*.zoo=01;31:*.cpio=01;31:*.7z=01;31:*.rz=01;31:*.cab=01;31:*.wim=01;31:*.swm=01;31:*.dwm=01;31:*.esd=01;31:*.jpg=01;35:*.jpeg=01;35:*.mjpg=01;35:*.mjpeg=01;35:*.gif=01;35:*.bmp=01;35:*.pbm=01;35:*.pgm=01;35:*.ppm=01;35:*.tga=01;35:*.xbm=01;35:*.xpm=01;35:*.tif=01;35:*.tiff=01;35:*.png=01;35:*.svg=01;35:*.svgz=01;35:*.mng=01;35:*.pcx=01;35:*.mov=01;35:*.mpg=01;35:*.mpeg=01;35:*.m2v=01;35:*.mkv=01;35:*.webm=01;35:*.ogm=01;35:*.mp4=01;35:*.m4v=01;35:*.mp4v=01;35:*.vob=01;35:*.qt=01;35:*.nuv=01;35:*.wmv=01;35:*.asf=01;35:*.rm=01;35:*.rmvb=01;35:*.flc=01;35:*.avi=01;35:*.fli=01;35:*.flv=01;35:*.gl=01;35:*.dl=01;35:*.xcf=01;35:*.xwd=01;35:*.yuv=01;35:*.cgm=01;35:*.emf=01;35:*.ogv=01;35:*.ogx=01;35:*.aac=00;36:*.au=00;36:*.flac=00;36:*.m4a=00;36:*.mid=00;36:*.midi=00;36:*.mka=00;36:*.mp3=00;36:*.mpc=00;36:*.ogg=00;36:*.ra=00;36:*.wav=00;36:*.oga=00;36:*.opus=00;36:*.spx=00;36:*.xspf=00;36:', 'LD_LIBRARY_PATH': '/opt/crashrepair/lib:/CrashRepair/lib:/klee/build/lib:', 'CONDA_EXE': '/root/anaconda3/bin/conda', 'LANG': 'C.UTF-8', 'TZ': 'Asia/Shanghai', 'HOSTNAME': 'fea22102047d', 'OLDPWD': '/orchestrator', 'CONDA_PREFIX': '/root/anaconda3/envs/CrashRepair', '_CE_M': '', 'CC': 'crepair-cc', 'LLVM_COMPILER': 'clang', 'CONDA_PREFIX_1': '/root/anaconda3', 'PWD': '/orchestrator/crashrepair', 'HOME': '/root', 'CONDA_PYTHON_EXE': '/root/anaconda3/bin/python', '_CE_CONDA': '', 'CONDA_PROMPT_MODIFIER': '(CrashRepair) ', 'CXX': 'crepair-cxx', 'TERM': 'xterm', 'SHLVL': '2', 'PYTHONPATH': '/usr/lib/python3.8/site-packages:', 'PATH': '/root/anaconda3/envs/CrashRepair/bin:/root/anaconda3/condabin:~/anaconda3/bin:/opt/crashrepair/bin:/CrashRepair/compiler:/klee/build/bin:/opt/llvm-6/bin:/klee/build/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', 'CONDA_DEFAULT_ENV': 'CrashRepair', '_': '/root/anaconda3/envs/CrashRepair/bin/python'})
2025-02-05 21:10:12.308 | DEBUG    | scenario:rebuild:398 - using environment: {'INJECT_CFLAGS': '-g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy ', 'INJECT_CXXFLAGS': '-g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy ', 'INJECT_LDFLAGS': '-g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy '}
2025-02-05 21:10:12.308 | DEBUG    | shell:__call__:41 - executing: make CFLAGS="-fsanitize=float-cast-overflow ${INJECT_CFLAGS}" CXXFLAGS="-fsanitize=float-cast-overflow ${INJECT_CXXFLAGS}" LDFLAGS="${INJECT_LDFLAGS}"
Making all in port
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/port'
make[1]: Nothing to be done for 'all'.
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/port'
Making all in libtiff
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/libtiff'
make  all-am
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/libtiff'
/bin/bash ../libtool  --tag=CC   --mode=compile crepair-cc -DHAVE_CONFIG_H -I.     -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -MT tif_dirwrite.lo -MD -MP -MF .deps/tif_dirwrite.Tpo -c -o tif_dirwrite.lo tif_dirwrite.c
libtool: compile:  crepair-cc -DHAVE_CONFIG_H -I. -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -MT tif_dirwrite.lo -MD -MP -MF .deps/tif_dirwrite.Tpo -c tif_dirwrite.c -o tif_dirwrite.o
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
tif_dirwrite.c:964:21: error: use of undeclared identifier 'FLT_MIN'
                                        if (value[i] < FLT_MIN || value[i] > FLT_MAX)
                                                       ^
tif_dirwrite.c:964:43: error: use of undeclared identifier 'FLT_MAX'
                                        if (value[i] < FLT_MIN || value[i] > FLT_MAX)
                                                                             ^
tif_dirwrite.c:984:21: error: use of undeclared identifier 'INT8_MIN'
                                        if (value[i] < INT8_MIN || value[i] > INT8_MAX)
                                                       ^
tif_dirwrite.c:984:44: error: use of undeclared identifier 'INT8_MAX'
                                        if (value[i] < INT8_MIN || value[i] > INT8_MAX)
                                                                              ^
tif_dirwrite.c:998:21: error: use of undeclared identifier 'INT16_MIN'
                                        if (value[i] < INT16_MIN || value[i] > INT16_MAX)
                                                       ^
tif_dirwrite.c:998:45: error: use of undeclared identifier 'INT16_MAX'
                                        if (value[i] < INT16_MIN || value[i] > INT16_MAX)
                                                                               ^
tif_dirwrite.c:1012:21: error: use of undeclared identifier 'INT32_MIN'
                                        if (value[i] < INT32_MIN || value[i] > INT32_MAX)
                                                       ^
tif_dirwrite.c:1012:45: error: use of undeclared identifier 'INT32_MAX'
                                        if (value[i] < INT32_MIN || value[i] > INT32_MAX)
                                                                               ^
tif_dirwrite.c:1028:37: error: use of undeclared identifier 'UINT8_MAX'
                                        if (value[i] < 0 || value[i] > UINT8_MAX)
                                                                       ^
tif_dirwrite.c:1042:37: error: use of undeclared identifier 'UINT16_MAX'
                                        if (value[i] < 0 || value[i] > UINT16_MAX)
                                                                       ^
tif_dirwrite.c:1056:37: error: use of undeclared identifier 'UINT32_MAX'
                                        if (value[i] < 0 || value[i] > UINT32_MAX)
                                                                       ^
11 errors generated.
ERROR:Failed to compile using given arguments: [-g -O0 -include /CrashRepair/compiler/../lib/crepair_runtime.h -DHAVE_CONFIG_H -I. -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -MT tif_dirwrite.lo -MD -MP -MF .deps/tif_dirwrite.Tpo -c tif_dirwrite.c -o tif_dirwrite.o -L/CrashRepair/compiler/../lib/ -L/klee/build/lib/ -lcrepair_runtime -lcrepair_proxy -lkleeRuntest -fno-sanitize=address]
Makefile:671: recipe for target 'tif_dirwrite.lo' failed
make[2]: *** [tif_dirwrite.lo] Error 1
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/libtiff'
Makefile:496: recipe for target 'all' failed
make[1]: *** [all] Error 2
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/libtiff'
Makefile:547: recipe for target 'all-recursive' failed
make: *** [all-recursive] Error 1
2025-02-05 21:10:12.404 | INFO     | scenario:evaluate:643 - candidate patch #4 failed to compile
2025-02-05 21:10:12.410 | INFO     | scenario:evaluate:635 - evaluating candidate patch #5:
@@ -939,6 +939,7 @@
 	return(0);
 }
 
+
 static int
 TIFFWriteDirectoryTagSampleformatArray(TIFF* tif, uint32* ndir, TIFFDirEntry* dir, uint16 tag, uint32 count, double* value)
 {
@@ -983,7 +984,14 @@
 			else
 			{
 				for (i = 0; i < count; ++i)
+				{
+					if (value[i] < INT32_MIN || value[i] > INT32_MAX) {
+						TIFFErrorExt(tif->tif_clientdata, module, "Value out of range for int32");
+						_TIFFfree(conv);
+						return 0;
+					}
 					((int32*)conv)[i] = (int32)value[i];
+				}
 				ok = TIFFWriteDirectoryTagSlongArray(tif,ndir,dir,tag,count,(int32*)conv);
 			}
 			break;
@@ -991,19 +999,40 @@
 			if (tif->tif_dir.td_bitspersample<=8)
 			{
 				for (i = 0; i < count; ++i)
+				{
+					if (value[i] < 0 || value[i] > UINT8_MAX) {
+						TIFFErrorExt(tif->tif_clientdata, module, "Value out of range for uint8");
+						_TIFFfree(conv);
+						return 0;
+					}
 					((uint8*)conv)[i] = (uint8)value[i];
+				}
 				ok = TIFFWriteDirectoryTagByteArray(tif,ndir,dir,tag,count,(uint8*)conv);
 			}
 			else if (tif->tif_dir.td_bitspersample<=16)
 			{
 				for (i = 0; i < count; ++i)
+				{
+					if (value[i] < 0 || value[i] > UINT16_MAX) {
+						TIFFErrorExt(tif->tif_clientdata, module, "Value out of range for uint16");
+						_TIFFfree(conv);
+						return 0;
+					}
 					((uint16*)conv)[i] = (uint16)value[i];
+				}
 				ok = TIFFWriteDirectoryTagShortArray(tif,ndir,dir,tag,count,(uint16*)conv);
 			}
 			else
 			{
 				for (i = 0; i < count; ++i)
+				{
+					if (value[i] < 0 || value[i] > UINT32_MAX) {
+						TIFFErrorExt(tif->tif_clientdata, module, "Value out of range for uint32");
+						_TIFFfree(conv);
+						return 0;
+					}
 					((uint32*)conv)[i] = (uint32)value[i];
+				}
 				ok = TIFFWriteDirectoryTagLongArray(tif,ndir,dir,tag,count,(uint32*)conv);
 			}
 			break;
@@ -1015,6 +1044,7 @@
 	return (ok);
 }
 
+
 #if 0
 static int
 TIFFWriteDirectoryTagSampleformatPerSample(TIFF* tif, uint32* ndir, TIFFDirEntry* dir, uint16 tag, double value)

2025-02-05 21:10:12.414 | DEBUG    | scenario:rebuild:369 - original environment: environ({'CONDA_SHLVL': '2', 'LC_ALL': 'C.UTF-8', 'LS_COLORS': 'rs=0:di=01;34:ln=01;36:mh=00:pi=40;33:so=01;35:do=01;35:bd=40;33;01:cd=40;33;01:or=40;31;01:mi=00:su=37;41:sg=30;43:ca=30;41:tw=30;42:ow=34;42:st=37;44:ex=01;32:*.tar=01;31:*.tgz=01;31:*.arc=01;31:*.arj=01;31:*.taz=01;31:*.lha=01;31:*.lz4=01;31:*.lzh=01;31:*.lzma=01;31:*.tlz=01;31:*.txz=01;31:*.tzo=01;31:*.t7z=01;31:*.zip=01;31:*.z=01;31:*.Z=01;31:*.dz=01;31:*.gz=01;31:*.lrz=01;31:*.lz=01;31:*.lzo=01;31:*.xz=01;31:*.zst=01;31:*.tzst=01;31:*.bz2=01;31:*.bz=01;31:*.tbz=01;31:*.tbz2=01;31:*.tz=01;31:*.deb=01;31:*.rpm=01;31:*.jar=01;31:*.war=01;31:*.ear=01;31:*.sar=01;31:*.rar=01;31:*.alz=01;31:*.ace=01;31:*.zoo=01;31:*.cpio=01;31:*.7z=01;31:*.rz=01;31:*.cab=01;31:*.wim=01;31:*.swm=01;31:*.dwm=01;31:*.esd=01;31:*.jpg=01;35:*.jpeg=01;35:*.mjpg=01;35:*.mjpeg=01;35:*.gif=01;35:*.bmp=01;35:*.pbm=01;35:*.pgm=01;35:*.ppm=01;35:*.tga=01;35:*.xbm=01;35:*.xpm=01;35:*.tif=01;35:*.tiff=01;35:*.png=01;35:*.svg=01;35:*.svgz=01;35:*.mng=01;35:*.pcx=01;35:*.mov=01;35:*.mpg=01;35:*.mpeg=01;35:*.m2v=01;35:*.mkv=01;35:*.webm=01;35:*.ogm=01;35:*.mp4=01;35:*.m4v=01;35:*.mp4v=01;35:*.vob=01;35:*.qt=01;35:*.nuv=01;35:*.wmv=01;35:*.asf=01;35:*.rm=01;35:*.rmvb=01;35:*.flc=01;35:*.avi=01;35:*.fli=01;35:*.flv=01;35:*.gl=01;35:*.dl=01;35:*.xcf=01;35:*.xwd=01;35:*.yuv=01;35:*.cgm=01;35:*.emf=01;35:*.ogv=01;35:*.ogx=01;35:*.aac=00;36:*.au=00;36:*.flac=00;36:*.m4a=00;36:*.mid=00;36:*.midi=00;36:*.mka=00;36:*.mp3=00;36:*.mpc=00;36:*.ogg=00;36:*.ra=00;36:*.wav=00;36:*.oga=00;36:*.opus=00;36:*.spx=00;36:*.xspf=00;36:', 'LD_LIBRARY_PATH': '/opt/crashrepair/lib:/CrashRepair/lib:/klee/build/lib:', 'CONDA_EXE': '/root/anaconda3/bin/conda', 'LANG': 'C.UTF-8', 'TZ': 'Asia/Shanghai', 'HOSTNAME': 'fea22102047d', 'OLDPWD': '/orchestrator', 'CONDA_PREFIX': '/root/anaconda3/envs/CrashRepair', '_CE_M': '', 'CC': 'crepair-cc', 'LLVM_COMPILER': 'clang', 'CONDA_PREFIX_1': '/root/anaconda3', 'PWD': '/orchestrator/crashrepair', 'HOME': '/root', 'CONDA_PYTHON_EXE': '/root/anaconda3/bin/python', '_CE_CONDA': '', 'CONDA_PROMPT_MODIFIER': '(CrashRepair) ', 'CXX': 'crepair-cxx', 'TERM': 'xterm', 'SHLVL': '2', 'PYTHONPATH': '/usr/lib/python3.8/site-packages:', 'PATH': '/root/anaconda3/envs/CrashRepair/bin:/root/anaconda3/condabin:~/anaconda3/bin:/opt/crashrepair/bin:/CrashRepair/compiler:/klee/build/bin:/opt/llvm-6/bin:/klee/build/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', 'CONDA_DEFAULT_ENV': 'CrashRepair', '_': '/root/anaconda3/envs/CrashRepair/bin/python'})
2025-02-05 21:10:12.414 | DEBUG    | scenario:rebuild:398 - using environment: {'INJECT_CFLAGS': '-g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy ', 'INJECT_CXXFLAGS': '-g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy ', 'INJECT_LDFLAGS': '-g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy '}
2025-02-05 21:10:12.414 | DEBUG    | shell:__call__:41 - executing: make CFLAGS="-fsanitize=float-cast-overflow ${INJECT_CFLAGS}" CXXFLAGS="-fsanitize=float-cast-overflow ${INJECT_CXXFLAGS}" LDFLAGS="${INJECT_LDFLAGS}"
Making all in port
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/port'
make[1]: Nothing to be done for 'all'.
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/port'
Making all in libtiff
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/libtiff'
make  all-am
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/libtiff'
/bin/bash ../libtool  --tag=CC   --mode=compile crepair-cc -DHAVE_CONFIG_H -I.     -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -MT tif_dirwrite.lo -MD -MP -MF .deps/tif_dirwrite.Tpo -c -o tif_dirwrite.lo tif_dirwrite.c
libtool: compile:  crepair-cc -DHAVE_CONFIG_H -I. -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -MT tif_dirwrite.lo -MD -MP -MF .deps/tif_dirwrite.Tpo -c tif_dirwrite.c -o tif_dirwrite.o
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
tif_dirwrite.c:988:21: error: use of undeclared identifier 'INT32_MIN'
                                        if (value[i] < INT32_MIN || value[i] > INT32_MAX) {
                                                       ^
tif_dirwrite.c:988:45: error: use of undeclared identifier 'INT32_MAX'
                                        if (value[i] < INT32_MIN || value[i] > INT32_MAX) {
                                                                               ^
tif_dirwrite.c:1003:37: error: use of undeclared identifier 'UINT8_MAX'
                                        if (value[i] < 0 || value[i] > UINT8_MAX) {
                                                                       ^
tif_dirwrite.c:1016:37: error: use of undeclared identifier 'UINT16_MAX'
                                        if (value[i] < 0 || value[i] > UINT16_MAX) {
                                                                       ^
tif_dirwrite.c:1029:37: error: use of undeclared identifier 'UINT32_MAX'
                                        if (value[i] < 0 || value[i] > UINT32_MAX) {
                                                                       ^
5 errors generated.
ERROR:Failed to compile using given arguments: [-g -O0 -include /CrashRepair/compiler/../lib/crepair_runtime.h -DHAVE_CONFIG_H -I. -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -MT tif_dirwrite.lo -MD -MP -MF .deps/tif_dirwrite.Tpo -c tif_dirwrite.c -o tif_dirwrite.o -L/CrashRepair/compiler/../lib/ -L/klee/build/lib/ -lcrepair_runtime -lcrepair_proxy -lkleeRuntest -fno-sanitize=address]
Makefile:671: recipe for target 'tif_dirwrite.lo' failed
make[2]: *** [tif_dirwrite.lo] Error 1
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/libtiff'
Makefile:496: recipe for target 'all' failed
make[1]: *** [all] Error 2
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/libtiff'
Makefile:547: recipe for target 'all-recursive' failed
make: *** [all-recursive] Error 1
2025-02-05 21:10:12.509 | INFO     | scenario:evaluate:643 - candidate patch #5 failed to compile
2025-02-05 21:10:12.515 | INFO     | scenario:evaluate:635 - evaluating candidate patch #6:
@@ -939,6 +939,7 @@
 	return(0);
 }
 
+
 static int
 TIFFWriteDirectoryTagSampleformatArray(TIFF* tif, uint32* ndir, TIFFDirEntry* dir, uint16 tag, uint32 count, double* value)
 {
@@ -958,8 +959,10 @@
 		case SAMPLEFORMAT_IEEEFP:
 			if (tif->tif_dir.td_bitspersample<=32)
 			{
-				for (i = 0; i < count; ++i)
-					((float*)conv)[i] = (float)value[i];
+				for (i = 0; i < count; ++i) {
+					if (i < count) // Ensure we do not write beyond the allocated memory
+						((float*)conv)[i] = (float)value[i];
+				}
 				ok = TIFFWriteDirectoryTagFloatArray(tif,ndir,dir,tag,count,(float*)conv);
 			}
 			else
@@ -970,40 +973,52 @@
 		case SAMPLEFORMAT_INT:
 			if (tif->tif_dir.td_bitspersample<=8)
 			{
-				for (i = 0; i < count; ++i)
-					((int8*)conv)[i] = (int8)value[i];
+				for (i = 0; i < count; ++i) {
+					if (i < count) // Ensure we do not write beyond the allocated memory
+						((int8*)conv)[i] = (int8)value[i];
+				}
 				ok = TIFFWriteDirectoryTagSbyteArray(tif,ndir,dir,tag,count,(int8*)conv);
 			}
 			else if (tif->tif_dir.td_bitspersample<=16)
 			{
-				for (i = 0; i < count; ++i)
-					((int16*)conv)[i] = (int16)value[i];
+				for (i = 0; i < count; ++i) {
+					if (i < count) // Ensure we do not write beyond the allocated memory
+						((int16*)conv)[i] = (int16)value[i];
+				}
 				ok = TIFFWriteDirectoryTagSshortArray(tif,ndir,dir,tag,count,(int16*)conv);
 			}
 			else
 			{
-				for (i = 0; i < count; ++i)
-					((int32*)conv)[i] = (int32)value[i];
+				for (i = 0; i < count; ++i) {
+					if (i < count) // Ensure we do not write beyond the allocated memory
+						((int32*)conv)[i] = (int32)value[i];
+				}
 				ok = TIFFWriteDirectoryTagSlongArray(tif,ndir,dir,tag,count,(int32*)conv);
 			}
 			break;
 		case SAMPLEFORMAT_UINT:
 			if (tif->tif_dir.td_bitspersample<=8)
 			{
-				for (i = 0; i < count; ++i)
-					((uint8*)conv)[i] = (uint8)value[i];
+				for (i = 0; i < count; ++i) {
+					if (i < count) // Ensure we do not write beyond the allocated memory
+						((uint8*)conv)[i] = (uint8)value[i];
+				}
 				ok = TIFFWriteDirectoryTagByteArray(tif,ndir,dir,tag,count,(uint8*)conv);
 			}
 			else if (tif->tif_dir.td_bitspersample<=16)
 			{
-				for (i = 0; i < count; ++i)
-					((uint16*)conv)[i] = (uint16)value[i];
+				for (i = 0; i < count; ++i) {
+					if (i < count) // Ensure we do not write beyond the allocated memory
+						((uint16*)conv)[i] = (uint16)value[i];
+				}
 				ok = TIFFWriteDirectoryTagShortArray(tif,ndir,dir,tag,count,(uint16*)conv);
 			}
 			else
 			{
-				for (i = 0; i < count; ++i)
-					((uint32*)conv)[i] = (uint32)value[i];
+				for (i = 0; i < count; ++i) {
+					if (i < count) // Ensure we do not write beyond the allocated memory
+						((uint32*)conv)[i] = (uint32)value[i];
+				}
 				ok = TIFFWriteDirectoryTagLongArray(tif,ndir,dir,tag,count,(uint32*)conv);
 			}
 			break;
@@ -1015,6 +1030,7 @@
 	return (ok);
 }
 
+
 #if 0
 static int
 TIFFWriteDirectoryTagSampleformatPerSample(TIFF* tif, uint32* ndir, TIFFDirEntry* dir, uint16 tag, double value)

2025-02-05 21:10:12.521 | DEBUG    | scenario:rebuild:369 - original environment: environ({'CONDA_SHLVL': '2', 'LC_ALL': 'C.UTF-8', 'LS_COLORS': 'rs=0:di=01;34:ln=01;36:mh=00:pi=40;33:so=01;35:do=01;35:bd=40;33;01:cd=40;33;01:or=40;31;01:mi=00:su=37;41:sg=30;43:ca=30;41:tw=30;42:ow=34;42:st=37;44:ex=01;32:*.tar=01;31:*.tgz=01;31:*.arc=01;31:*.arj=01;31:*.taz=01;31:*.lha=01;31:*.lz4=01;31:*.lzh=01;31:*.lzma=01;31:*.tlz=01;31:*.txz=01;31:*.tzo=01;31:*.t7z=01;31:*.zip=01;31:*.z=01;31:*.Z=01;31:*.dz=01;31:*.gz=01;31:*.lrz=01;31:*.lz=01;31:*.lzo=01;31:*.xz=01;31:*.zst=01;31:*.tzst=01;31:*.bz2=01;31:*.bz=01;31:*.tbz=01;31:*.tbz2=01;31:*.tz=01;31:*.deb=01;31:*.rpm=01;31:*.jar=01;31:*.war=01;31:*.ear=01;31:*.sar=01;31:*.rar=01;31:*.alz=01;31:*.ace=01;31:*.zoo=01;31:*.cpio=01;31:*.7z=01;31:*.rz=01;31:*.cab=01;31:*.wim=01;31:*.swm=01;31:*.dwm=01;31:*.esd=01;31:*.jpg=01;35:*.jpeg=01;35:*.mjpg=01;35:*.mjpeg=01;35:*.gif=01;35:*.bmp=01;35:*.pbm=01;35:*.pgm=01;35:*.ppm=01;35:*.tga=01;35:*.xbm=01;35:*.xpm=01;35:*.tif=01;35:*.tiff=01;35:*.png=01;35:*.svg=01;35:*.svgz=01;35:*.mng=01;35:*.pcx=01;35:*.mov=01;35:*.mpg=01;35:*.mpeg=01;35:*.m2v=01;35:*.mkv=01;35:*.webm=01;35:*.ogm=01;35:*.mp4=01;35:*.m4v=01;35:*.mp4v=01;35:*.vob=01;35:*.qt=01;35:*.nuv=01;35:*.wmv=01;35:*.asf=01;35:*.rm=01;35:*.rmvb=01;35:*.flc=01;35:*.avi=01;35:*.fli=01;35:*.flv=01;35:*.gl=01;35:*.dl=01;35:*.xcf=01;35:*.xwd=01;35:*.yuv=01;35:*.cgm=01;35:*.emf=01;35:*.ogv=01;35:*.ogx=01;35:*.aac=00;36:*.au=00;36:*.flac=00;36:*.m4a=00;36:*.mid=00;36:*.midi=00;36:*.mka=00;36:*.mp3=00;36:*.mpc=00;36:*.ogg=00;36:*.ra=00;36:*.wav=00;36:*.oga=00;36:*.opus=00;36:*.spx=00;36:*.xspf=00;36:', 'LD_LIBRARY_PATH': '/opt/crashrepair/lib:/CrashRepair/lib:/klee/build/lib:', 'CONDA_EXE': '/root/anaconda3/bin/conda', 'LANG': 'C.UTF-8', 'TZ': 'Asia/Shanghai', 'HOSTNAME': 'fea22102047d', 'OLDPWD': '/orchestrator', 'CONDA_PREFIX': '/root/anaconda3/envs/CrashRepair', '_CE_M': '', 'CC': 'crepair-cc', 'LLVM_COMPILER': 'clang', 'CONDA_PREFIX_1': '/root/anaconda3', 'PWD': '/orchestrator/crashrepair', 'HOME': '/root', 'CONDA_PYTHON_EXE': '/root/anaconda3/bin/python', '_CE_CONDA': '', 'CONDA_PROMPT_MODIFIER': '(CrashRepair) ', 'CXX': 'crepair-cxx', 'TERM': 'xterm', 'SHLVL': '2', 'PYTHONPATH': '/usr/lib/python3.8/site-packages:', 'PATH': '/root/anaconda3/envs/CrashRepair/bin:/root/anaconda3/condabin:~/anaconda3/bin:/opt/crashrepair/bin:/CrashRepair/compiler:/klee/build/bin:/opt/llvm-6/bin:/klee/build/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', 'CONDA_DEFAULT_ENV': 'CrashRepair', '_': '/root/anaconda3/envs/CrashRepair/bin/python'})
2025-02-05 21:10:12.521 | DEBUG    | scenario:rebuild:398 - using environment: {'INJECT_CFLAGS': '-g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy ', 'INJECT_CXXFLAGS': '-g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy ', 'INJECT_LDFLAGS': '-g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy '}
2025-02-05 21:10:12.521 | DEBUG    | shell:__call__:41 - executing: make CFLAGS="-fsanitize=float-cast-overflow ${INJECT_CFLAGS}" CXXFLAGS="-fsanitize=float-cast-overflow ${INJECT_CXXFLAGS}" LDFLAGS="${INJECT_LDFLAGS}"
Making all in port
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/port'
make[1]: Nothing to be done for 'all'.
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/port'
Making all in libtiff
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/libtiff'
make  all-am
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/libtiff'
/bin/bash ../libtool  --tag=CC   --mode=compile crepair-cc -DHAVE_CONFIG_H -I.     -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -MT tif_dirwrite.lo -MD -MP -MF .deps/tif_dirwrite.Tpo -c -o tif_dirwrite.lo tif_dirwrite.c
libtool: compile:  crepair-cc -DHAVE_CONFIG_H -I. -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -MT tif_dirwrite.lo -MD -MP -MF .deps/tif_dirwrite.Tpo -c tif_dirwrite.c -o tif_dirwrite.o
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
mv -f .deps/tif_dirwrite.Tpo .deps/tif_dirwrite.Plo
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -no-undefined -version-info 7:5:2   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o libtiff.la -rpath /usr/local/lib tif_aux.lo tif_close.lo tif_codec.lo tif_color.lo tif_compress.lo tif_dir.lo tif_dirinfo.lo tif_dirread.lo tif_dirwrite.lo tif_dumpmode.lo tif_error.lo tif_extension.lo tif_fax3.lo tif_fax3sm.lo tif_flush.lo tif_getimage.lo tif_jbig.lo tif_jpeg.lo tif_jpeg_12.lo tif_luv.lo tif_lzma.lo tif_lzw.lo tif_next.lo tif_ojpeg.lo tif_open.lo tif_packbits.lo tif_pixarlog.lo tif_predict.lo tif_print.lo tif_read.lo tif_strip.lo tif_swab.lo tif_thunder.lo tif_tile.lo tif_version.lo tif_warning.lo tif_write.lo tif_zip.lo  tif_unix.lo ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: rm -fr  .libs/libtiff.a .libs/libtiff.la .libs/libtiff.lai
libtool: link: (cd .libs/libtiff.lax/libport.a && ar x "/data/vulnloc/libtiff/CVE-2017-7600/src/libtiff/../port/.libs/libport.a")
libtool: link: ar cru .libs/libtiff.a  tif_aux.o tif_close.o tif_codec.o tif_color.o tif_compress.o tif_dir.o tif_dirinfo.o tif_dirread.o tif_dirwrite.o tif_dumpmode.o tif_error.o tif_extension.o tif_fax3.o tif_fax3sm.o tif_flush.o tif_getimage.o tif_jbig.o tif_jpeg.o tif_jpeg_12.o tif_luv.o tif_lzma.o tif_lzw.o tif_next.o tif_ojpeg.o tif_open.o tif_packbits.o tif_pixarlog.o tif_predict.o tif_print.o tif_read.o tif_strip.o tif_swab.o tif_thunder.o tif_tile.o tif_version.o tif_warning.o tif_write.o tif_zip.o tif_unix.o  .libs/libtiff.lax/libport.a/dummy.o 
ar: `u' modifier ignored since `D' is the default (see `U')
libtool: link: ranlib .libs/libtiff.a
libtool: link: rm -fr .libs/libtiff.lax
libtool: link: ( cd ".libs" && rm -f "libtiff.la" && ln -s "../libtiff.la" "libtiff.la" )
/bin/bash ../libtool  --tag=CXX   --mode=link crepair-cxx  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -no-undefined -version-info 7:5:2   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o libtiffxx.la -rpath /usr/local/lib tif_stream.lo ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: rm -fr  .libs/libtiffxx.a .libs/libtiffxx.la .libs/libtiffxx.lai
libtool: link: (cd .libs/libtiffxx.lax/libport.a && ar x "/data/vulnloc/libtiff/CVE-2017-7600/src/libtiff/../port/.libs/libport.a")
libtool: link: ar cru .libs/libtiffxx.a  tif_stream.o  .libs/libtiffxx.lax/libport.a/dummy.o 
ar: `u' modifier ignored since `D' is the default (see `U')
libtool: link: ranlib .libs/libtiffxx.a
libtool: link: rm -fr .libs/libtiffxx.lax
libtool: link: ( cd ".libs" && rm -f "libtiffxx.la" && ln -s "../libtiffxx.la" "libtiffxx.la" )
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/libtiff'
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/libtiff'
Making all in tools
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/tools'
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o bmp2tiff bmp2tiff.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o bmp2tiff bmp2tiff.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o fax2ps fax2ps.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o fax2ps fax2ps.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o fax2tiff fax2tiff.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o fax2tiff fax2tiff.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o gif2tiff gif2tiff.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o gif2tiff gif2tiff.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o pal2rgb pal2rgb.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o pal2rgb pal2rgb.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o ppm2tiff ppm2tiff.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o ppm2tiff ppm2tiff.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o ras2tiff ras2tiff.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o ras2tiff ras2tiff.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o raw2tiff raw2tiff.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o raw2tiff raw2tiff.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o rgb2ycbcr rgb2ycbcr.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o rgb2ycbcr rgb2ycbcr.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o thumbnail thumbnail.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o thumbnail thumbnail.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o tiff2bw tiff2bw.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o tiff2bw tiff2bw.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o tiff2pdf tiff2pdf.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o tiff2pdf tiff2pdf.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o tiff2ps tiff2ps.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o tiff2ps tiff2ps.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o tiff2rgba tiff2rgba.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o tiff2rgba tiff2rgba.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o tiffcmp tiffcmp.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o tiffcmp tiffcmp.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o tiffcp tiffcp.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o tiffcp tiffcp.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o tiffcrop tiffcrop.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o tiffcrop tiffcrop.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o tiffdither tiffdither.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o tiffdither tiffdither.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o tiffdump tiffdump.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o tiffdump tiffdump.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o tiffinfo tiffinfo.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o tiffinfo tiffinfo.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o tiffmedian tiffmedian.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o tiffmedian tiffmedian.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o tiffset tiffset.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o tiffset tiffset.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o tiffsplit tiffsplit.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o tiffsplit tiffsplit.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/tools'
Making all in build
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/build'
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/build'
make[2]: Nothing to be done for 'all-am'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/build'
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/build'
Making all in contrib
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib'
Making all in addtiffo
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/addtiffo'
/bin/bash ../../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o addtiffo addtiffo.o tif_overview.o tif_ovrcache.o ../../libtiff/libtiff.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o addtiffo addtiffo.o tif_overview.o tif_ovrcache.o  -L/klee/build/lib -L/CrashRepair/lib ../../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy -llzma -ljbig -ljpeg -lz -lm
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/addtiffo'
Making all in dbs
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/dbs'
Making all in xtiff
make[3]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/dbs/xtiff'
make[3]: Nothing to be done for 'all'.
make[3]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/dbs/xtiff'
make[3]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/dbs'
/bin/bash ../../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o tiff-bi tiff-bi.o ../../libtiff/libtiff.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o tiff-bi tiff-bi.o  -L/klee/build/lib -L/CrashRepair/lib ../../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o tiff-grayscale tiff-grayscale.o ../../libtiff/libtiff.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o tiff-grayscale tiff-grayscale.o  -L/klee/build/lib -L/CrashRepair/lib ../../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o tiff-palette tiff-palette.o ../../libtiff/libtiff.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o tiff-palette tiff-palette.o  -L/klee/build/lib -L/CrashRepair/lib ../../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o tiff-rgb tiff-rgb.o ../../libtiff/libtiff.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o tiff-rgb tiff-rgb.o  -L/klee/build/lib -L/CrashRepair/lib ../../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy -llzma -ljbig -ljpeg -lz -lm
make[3]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/dbs'
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/dbs'
Making all in iptcutil
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/iptcutil'
/bin/bash ../../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o iptcutil iptcutil.o ../../libtiff/libtiff.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o iptcutil iptcutil.o  -L/klee/build/lib -L/CrashRepair/lib ../../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy -llzma -ljbig -ljpeg -lz -lm
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/iptcutil'
Making all in mfs
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/mfs'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/mfs'
Making all in pds
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/pds'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/pds'
Making all in ras
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/ras'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/ras'
Making all in stream
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/stream'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/stream'
Making all in tags
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/tags'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/tags'
Making all in win_dib
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/win_dib'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/win_dib'
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib'
make[2]: Nothing to be done for 'all-am'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib'
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib'
Making all in test
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/test'
make[1]: Nothing to be done for 'all'.
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/test'
Making all in man
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/man'
make[1]: Nothing to be done for 'all'.
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/man'
Making all in html
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/html'
Making all in images
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/html/images'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/html/images'
Making all in man
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/html/man'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/html/man'
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/html'
make[2]: Nothing to be done for 'all-am'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/html'
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/html'
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src'
make[1]: Nothing to be done for 'all-am'.
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src'
2025-02-05 21:10:16.933 | DEBUG    | scenario:evaluate:655 - testing candidate #6 against test #crash...
2025-02-05 21:10:16.933 | DEBUG    | shell:__call__:41 - executing: /data/vulnloc/libtiff/CVE-2017-7600/src/tools/tiffcp -i /CrashRepair/experiments/vulnloc/libtiff/CVE-2017-7600/tests/1.tif out.tiff
2025-02-05 21:10:16.938 | DEBUG    | test:run:172 - test failed: stderr contains bad output substring (runtime error: -115 is outside the range of representable values)
2025-02-05 21:10:16.938 | INFO     | scenario:evaluate:662 - candidate #6 fails test #crash
2025-02-05 21:10:16.947 | INFO     | scenario:evaluate:635 - evaluating candidate patch #7:
@@ -939,6 +939,7 @@
 	return(0);
 }
 
+
 static int
 TIFFWriteDirectoryTagSampleformatArray(TIFF* tif, uint32* ndir, TIFFDirEntry* dir, uint16 tag, uint32 count, double* value)
 {
@@ -946,7 +947,7 @@
 	void* conv;
 	uint32 i;
 	int ok;
-	conv = _TIFFmalloc(count*sizeof(double));
+	conv = _TIFFmalloc(count * sizeof(double));
 	if (conv == NULL)
 	{
 		TIFFErrorExt(tif->tif_clientdata, module, "Out of memory");
@@ -956,55 +957,76 @@
 	switch (tif->tif_dir.td_sampleformat)
 	{
 		case SAMPLEFORMAT_IEEEFP:
-			if (tif->tif_dir.td_bitspersample<=32)
+			if (tif->tif_dir.td_bitspersample <= 32)
 			{
 				for (i = 0; i < count; ++i)
+				{
+					if (value[i] < -FLT_MAX || value[i] > FLT_MAX) return 0; // Added check for float range
 					((float*)conv)[i] = (float)value[i];
-				ok = TIFFWriteDirectoryTagFloatArray(tif,ndir,dir,tag,count,(float*)conv);
+				}
+				ok = TIFFWriteDirectoryTagFloatArray(tif, ndir, dir, tag, count, (float*)conv);
 			}
 			else
 			{
-				ok = TIFFWriteDirectoryTagDoubleArray(tif,ndir,dir,tag,count,value);
+				ok = TIFFWriteDirectoryTagDoubleArray(tif, ndir, dir, tag, count, value);
 			}
 			break;
 		case SAMPLEFORMAT_INT:
-			if (tif->tif_dir.td_bitspersample<=8)
+			if (tif->tif_dir.td_bitspersample <= 8)
 			{
 				for (i = 0; i < count; ++i)
+				{
+					if (value[i] < INT8_MIN || value[i] > INT8_MAX) return 0; // Added check for int8 range
 					((int8*)conv)[i] = (int8)value[i];
-				ok = TIFFWriteDirectoryTagSbyteArray(tif,ndir,dir,tag,count,(int8*)conv);
+				}
+				ok = TIFFWriteDirectoryTagSbyteArray(tif, ndir, dir, tag, count, (int8*)conv);
 			}
-			else if (tif->tif_dir.td_bitspersample<=16)
+			else if (tif->tif_dir.td_bitspersample <= 16)
 			{
-				for (i = 0; i < count; ++i)
+				for (i = 0; i < count; ++i++)
+				{
+					if (value[i] < INT16_MIN || value[i] > INT16_MAX) return 0; // Added check for int16 range
 					((int16*)conv)[i] = (int16)value[i];
-				ok = TIFFWriteDirectoryTagSshortArray(tif,ndir,dir,tag,count,(int16*)conv);
+				}
+				ok = TIFFWriteDirectoryTagSshortArray(tif, ndir, dir, tag, count, (int16*)conv);
 			}
 			else
 			{
-				for (i = 0; i < count; ++i)
+				for (i = 0; i < count; ++i++)
+				{
+					if (value[i] < INT32_MIN || value[i] > INT32_MAX) return 0; // Added check for int32 range
 					((int32*)conv)[i] = (int32)value[i];
-				ok = TIFFWriteDirectoryTagSlongArray(tif,ndir,dir,tag,count,(int32*)conv);
+				}
+				ok = TIFFWriteDirectoryTagSlongArray(tif, ndir, dir, tag, count, (int32*)conv);
 			}
 			break;
 		case SAMPLEFORMAT_UINT:
-			if (tif->tif_dir.td_bitspersample<=8)
+			if (tif->tif_dir.td_bitspersample <= 8)
 			{
-				for (i = 0; i < count; ++i)
+				for (i = 0; i < count; ++i++)
+				{
+					if (value[i] < 0 || value[i] > UINT8_MAX) return 0; // Added check for uint8 range
 					((uint8*)conv)[i] = (uint8)value[i];
-				ok = TIFFWriteDirectoryTagByteArray(tif,ndir,dir,tag,count,(uint8*)conv);
+				}
+				ok = TIFFWriteDirectoryTagByteArray(tif, ndir, dir, tag, count, (uint8*)conv);
 			}
-			else if (tif->tif_dir.td_bitspersample<=16)
+			else if (tif->tif_dir.td_bitspersample <= 16)
 			{
-				for (i = 0; i < count; ++i)
+				for (i = 0; i < count; ++i++)
+				{
+					if (value[i] < 0 || value[i] > UINT16_MAX) return 0; // Added check for uint16 range
 					((uint16*)conv)[i] = (uint16)value[i];
-				ok = TIFFWriteDirectoryTagShortArray(tif,ndir,dir,tag,count,(uint16*)conv);
+				}
+				ok = TIFFWriteDirectoryTagShortArray(tif, ndir, dir, tag, count, (uint16*)conv);
 			}
 			else
 			{
-				for (i = 0; i < count; ++i)
+				for (i = 0; i < count; ++i++)
+				{
+					if (value[i] < 0 || value[i] > UINT32_MAX) return 0; // Added check for uint32 range
 					((uint32*)conv)[i] = (uint32)value[i];
-				ok = TIFFWriteDirectoryTagLongArray(tif,ndir,dir,tag,count,(uint32*)conv);
+				}
+				ok = TIFFWriteDirectoryTagLongArray(tif, ndir, dir, tag, count, (uint32*)conv);
 			}
 			break;
 		default:
@@ -1015,6 +1037,7 @@
 	return (ok);
 }
 
+
 #if 0
 static int
 TIFFWriteDirectoryTagSampleformatPerSample(TIFF* tif, uint32* ndir, TIFFDirEntry* dir, uint16 tag, double value)

2025-02-05 21:10:16.952 | DEBUG    | scenario:rebuild:369 - original environment: environ({'CONDA_SHLVL': '2', 'LC_ALL': 'C.UTF-8', 'LS_COLORS': 'rs=0:di=01;34:ln=01;36:mh=00:pi=40;33:so=01;35:do=01;35:bd=40;33;01:cd=40;33;01:or=40;31;01:mi=00:su=37;41:sg=30;43:ca=30;41:tw=30;42:ow=34;42:st=37;44:ex=01;32:*.tar=01;31:*.tgz=01;31:*.arc=01;31:*.arj=01;31:*.taz=01;31:*.lha=01;31:*.lz4=01;31:*.lzh=01;31:*.lzma=01;31:*.tlz=01;31:*.txz=01;31:*.tzo=01;31:*.t7z=01;31:*.zip=01;31:*.z=01;31:*.Z=01;31:*.dz=01;31:*.gz=01;31:*.lrz=01;31:*.lz=01;31:*.lzo=01;31:*.xz=01;31:*.zst=01;31:*.tzst=01;31:*.bz2=01;31:*.bz=01;31:*.tbz=01;31:*.tbz2=01;31:*.tz=01;31:*.deb=01;31:*.rpm=01;31:*.jar=01;31:*.war=01;31:*.ear=01;31:*.sar=01;31:*.rar=01;31:*.alz=01;31:*.ace=01;31:*.zoo=01;31:*.cpio=01;31:*.7z=01;31:*.rz=01;31:*.cab=01;31:*.wim=01;31:*.swm=01;31:*.dwm=01;31:*.esd=01;31:*.jpg=01;35:*.jpeg=01;35:*.mjpg=01;35:*.mjpeg=01;35:*.gif=01;35:*.bmp=01;35:*.pbm=01;35:*.pgm=01;35:*.ppm=01;35:*.tga=01;35:*.xbm=01;35:*.xpm=01;35:*.tif=01;35:*.tiff=01;35:*.png=01;35:*.svg=01;35:*.svgz=01;35:*.mng=01;35:*.pcx=01;35:*.mov=01;35:*.mpg=01;35:*.mpeg=01;35:*.m2v=01;35:*.mkv=01;35:*.webm=01;35:*.ogm=01;35:*.mp4=01;35:*.m4v=01;35:*.mp4v=01;35:*.vob=01;35:*.qt=01;35:*.nuv=01;35:*.wmv=01;35:*.asf=01;35:*.rm=01;35:*.rmvb=01;35:*.flc=01;35:*.avi=01;35:*.fli=01;35:*.flv=01;35:*.gl=01;35:*.dl=01;35:*.xcf=01;35:*.xwd=01;35:*.yuv=01;35:*.cgm=01;35:*.emf=01;35:*.ogv=01;35:*.ogx=01;35:*.aac=00;36:*.au=00;36:*.flac=00;36:*.m4a=00;36:*.mid=00;36:*.midi=00;36:*.mka=00;36:*.mp3=00;36:*.mpc=00;36:*.ogg=00;36:*.ra=00;36:*.wav=00;36:*.oga=00;36:*.opus=00;36:*.spx=00;36:*.xspf=00;36:', 'LD_LIBRARY_PATH': '/opt/crashrepair/lib:/CrashRepair/lib:/klee/build/lib:', 'CONDA_EXE': '/root/anaconda3/bin/conda', 'LANG': 'C.UTF-8', 'TZ': 'Asia/Shanghai', 'HOSTNAME': 'fea22102047d', 'OLDPWD': '/orchestrator', 'CONDA_PREFIX': '/root/anaconda3/envs/CrashRepair', '_CE_M': '', 'CC': 'crepair-cc', 'LLVM_COMPILER': 'clang', 'CONDA_PREFIX_1': '/root/anaconda3', 'PWD': '/orchestrator/crashrepair', 'HOME': '/root', 'CONDA_PYTHON_EXE': '/root/anaconda3/bin/python', '_CE_CONDA': '', 'CONDA_PROMPT_MODIFIER': '(CrashRepair) ', 'CXX': 'crepair-cxx', 'TERM': 'xterm', 'SHLVL': '2', 'PYTHONPATH': '/usr/lib/python3.8/site-packages:', 'PATH': '/root/anaconda3/envs/CrashRepair/bin:/root/anaconda3/condabin:~/anaconda3/bin:/opt/crashrepair/bin:/CrashRepair/compiler:/klee/build/bin:/opt/llvm-6/bin:/klee/build/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', 'CONDA_DEFAULT_ENV': 'CrashRepair', '_': '/root/anaconda3/envs/CrashRepair/bin/python'})
2025-02-05 21:10:16.952 | DEBUG    | scenario:rebuild:398 - using environment: {'INJECT_CFLAGS': '-g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy ', 'INJECT_CXXFLAGS': '-g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy ', 'INJECT_LDFLAGS': '-g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy '}
2025-02-05 21:10:16.952 | DEBUG    | shell:__call__:41 - executing: make CFLAGS="-fsanitize=float-cast-overflow ${INJECT_CFLAGS}" CXXFLAGS="-fsanitize=float-cast-overflow ${INJECT_CXXFLAGS}" LDFLAGS="${INJECT_LDFLAGS}"
Making all in port
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/port'
make[1]: Nothing to be done for 'all'.
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/port'
Making all in libtiff
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/libtiff'
make  all-am
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/libtiff'
/bin/bash ../libtool  --tag=CC   --mode=compile crepair-cc -DHAVE_CONFIG_H -I.     -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -MT tif_dirwrite.lo -MD -MP -MF .deps/tif_dirwrite.Tpo -c -o tif_dirwrite.lo tif_dirwrite.c
libtool: compile:  crepair-cc -DHAVE_CONFIG_H -I. -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -MT tif_dirwrite.lo -MD -MP -MF .deps/tif_dirwrite.Tpo -c tif_dirwrite.c -o tif_dirwrite.o
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
tif_dirwrite.c:964:22: error: use of undeclared identifier 'FLT_MAX'
                                        if (value[i] < -FLT_MAX || value[i] > FLT_MAX) return 0; // Added check for float range
                                                        ^
tif_dirwrite.c:964:44: error: use of undeclared identifier 'FLT_MAX'
                                        if (value[i] < -FLT_MAX || value[i] > FLT_MAX) return 0; // Added check for float range
                                                                              ^
tif_dirwrite.c:979:21: error: use of undeclared identifier 'INT8_MIN'
                                        if (value[i] < INT8_MIN || value[i] > INT8_MAX) return 0; // Added check for int8 range
                                                       ^
tif_dirwrite.c:979:44: error: use of undeclared identifier 'INT8_MAX'
                                        if (value[i] < INT8_MIN || value[i] > INT8_MAX) return 0; // Added check for int8 range
                                                                              ^
tif_dirwrite.c:986:28: error: expression is not assignable
                                for (i = 0; i < count; ++i++)
                                                       ^ ~~~
tif_dirwrite.c:988:21: error: use of undeclared identifier 'INT16_MIN'
                                        if (value[i] < INT16_MIN || value[i] > INT16_MAX) return 0; // Added check for int16 range
                                                       ^
tif_dirwrite.c:988:45: error: use of undeclared identifier 'INT16_MAX'
                                        if (value[i] < INT16_MIN || value[i] > INT16_MAX) return 0; // Added check for int16 range
                                                                               ^
tif_dirwrite.c:995:28: error: expression is not assignable
                                for (i = 0; i < count; ++i++)
                                                       ^ ~~~
tif_dirwrite.c:997:21: error: use of undeclared identifier 'INT32_MIN'
                                        if (value[i] < INT32_MIN || value[i] > INT32_MAX) return 0; // Added check for int32 range
                                                       ^
tif_dirwrite.c:997:45: error: use of undeclared identifier 'INT32_MAX'
                                        if (value[i] < INT32_MIN || value[i] > INT32_MAX) return 0; // Added check for int32 range
                                                                               ^
tif_dirwrite.c:1006:28: error: expression is not assignable
                                for (i = 0; i < count; ++i++)
                                                       ^ ~~~
tif_dirwrite.c:1008:37: error: use of undeclared identifier 'UINT8_MAX'
                                        if (value[i] < 0 || value[i] > UINT8_MAX) return 0; // Added check for uint8 range
                                                                       ^
tif_dirwrite.c:1015:28: error: expression is not assignable
                                for (i = 0; i < count; ++i++)
                                                       ^ ~~~
tif_dirwrite.c:1017:37: error: use of undeclared identifier 'UINT16_MAX'
                                        if (value[i] < 0 || value[i] > UINT16_MAX) return 0; // Added check for uint16 range
                                                                       ^
tif_dirwrite.c:1024:28: error: expression is not assignable
                                for (i = 0; i < count; ++i++)
                                                       ^ ~~~
tif_dirwrite.c:1026:37: error: use of undeclared identifier 'UINT32_MAX'
                                        if (value[i] < 0 || value[i] > UINT32_MAX) return 0; // Added check for uint32 range
                                                                       ^
16 errors generated.
ERROR:Failed to compile using given arguments: [-g -O0 -include /CrashRepair/compiler/../lib/crepair_runtime.h -DHAVE_CONFIG_H -I. -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -MT tif_dirwrite.lo -MD -MP -MF .deps/tif_dirwrite.Tpo -c tif_dirwrite.c -o tif_dirwrite.o -L/CrashRepair/compiler/../lib/ -L/klee/build/lib/ -lcrepair_runtime -lcrepair_proxy -lkleeRuntest -fno-sanitize=address]
Makefile:671: recipe for target 'tif_dirwrite.lo' failed
make[2]: *** [tif_dirwrite.lo] Error 1
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/libtiff'
Makefile:496: recipe for target 'all' failed
make[1]: *** [all] Error 2
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/libtiff'
Makefile:547: recipe for target 'all-recursive' failed
make: *** [all-recursive] Error 1
2025-02-05 21:10:17.045 | INFO     | scenario:evaluate:643 - candidate patch #7 failed to compile
2025-02-05 21:10:17.054 | INFO     | scenario:evaluate:635 - evaluating candidate patch #8:
@@ -939,6 +939,7 @@
 	return(0);
 }
 
+
 static int
 TIFFWriteDirectoryTagSampleformatArray(TIFF* tif, uint32* ndir, TIFFDirEntry* dir, uint16 tag, uint32 count, double* value)
 {
@@ -958,8 +959,13 @@
 		case SAMPLEFORMAT_IEEEFP:
 			if (tif->tif_dir.td_bitspersample<=32)
 			{
-				for (i = 0; i < count; ++i)
+				for (i = 0; i < count; ++i) {
+					if (value[i] < -FLT_MAX || value[i] > FLT_MAX) {
+						_TIFFfree(conv);
+						return 0; // Prevent overflow
+					}
 					((float*)conv)[i] = (float)value[i];
+				}
 				ok = TIFFWriteDirectoryTagFloatArray(tif,ndir,dir,tag,count,(float*)conv);
 			}
 			else
@@ -970,40 +976,70 @@
 		case SAMPLEFORMAT_INT:
 			if (tif->tif_dir.td_bitspersample<=8)
 			{
-				for (i = 0; i < count; ++i)
+				for (i = 0; i < count; ++i) {
+					if (value[i] < INT8_MIN || value[i] > INT8_MAX) {
+						_TIFFfree(conv);
+						return 0; // Prevent overflow
+					}
 					((int8*)conv)[i] = (int8)value[i];
+				}
 				ok = TIFFWriteDirectoryTagSbyteArray(tif,ndir,dir,tag,count,(int8*)conv);
 			}
 			else if (tif->tif_dir.td_bitspersample<=16)
 			{
-				for (i = 0; i < count; ++i)
+				for (i = 0; i < count; ++i) {
+					if (value[i] < INT16_MIN || value[i] > INT16_MAX) {
+						_TIFFfree(conv);
+						return 0; // Prevent overflow
+					}
 					((int16*)conv)[i] = (int16)value[i];
+				}
 				ok = TIFFWriteDirectoryTagSshortArray(tif,ndir,dir,tag,count,(int16*)conv);
 			}
 			else
 			{
-				for (i = 0; i < count; ++i)
+				for (i = 0; i < count; ++i) {
+					if (value[i] < INT32_MIN || value[i] > INT32_MAX) {
+						_TIFFfree(conv);
+						return 0; // Prevent overflow
+					}
 					((int32*)conv)[i] = (int32)value[i];
+				}
 				ok = TIFFWriteDirectoryTagSlongArray(tif,ndir,dir,tag,count,(int32*)conv);
 			}
 			break;
 		case SAMPLEFORMAT_UINT:
 			if (tif->tif_dir.td_bitspersample<=8)
 			{
-				for (i = 0; i < count; ++i)
+				for (i = 0; i < count; ++i) {
+					if (value[i] < 0 || value[i] > UINT8_MAX) {
+						_TIFFfree(conv);
+						return 0; // Prevent overflow
+					}
 					((uint8*)conv)[i] = (uint8)value[i];
+				}
 				ok = TIFFWriteDirectoryTagByteArray(tif,ndir,dir,tag,count,(uint8*)conv);
 			}
 			else if (tif->tif_dir.td_bitspersample<=16)
 			{
-				for (i = 0; i < count; ++i)
+				for (i = 0; i < count; ++i) {
+					if (value[i] < 0 || value[i] > UINT16_MAX) {
+						_TIFFfree(conv);
+						return 0; // Prevent overflow
+					}
 					((uint16*)conv)[i] = (uint16)value[i];
+				}
 				ok = TIFFWriteDirectoryTagShortArray(tif,ndir,dir,tag,count,(uint16*)conv);
 			}
 			else
 			{
-				for (i = 0; i < count; ++i)
+				for (i = 0; i < count; ++i) {
+					if (value[i] < 0 || value[i] > UINT32_MAX) {
+						_TIFFfree(conv);
+						return 0; // Prevent overflow
+					}
 					((uint32*)conv)[i] = (uint32)value[i];
+				}
 				ok = TIFFWriteDirectoryTagLongArray(tif,ndir,dir,tag,count,(uint32*)conv);
 			}
 			break;
@@ -1015,6 +1051,7 @@
 	return (ok);
 }
 
+
 #if 0
 static int
 TIFFWriteDirectoryTagSampleformatPerSample(TIFF* tif, uint32* ndir, TIFFDirEntry* dir, uint16 tag, double value)

2025-02-05 21:10:17.060 | DEBUG    | scenario:rebuild:369 - original environment: environ({'CONDA_SHLVL': '2', 'LC_ALL': 'C.UTF-8', 'LS_COLORS': 'rs=0:di=01;34:ln=01;36:mh=00:pi=40;33:so=01;35:do=01;35:bd=40;33;01:cd=40;33;01:or=40;31;01:mi=00:su=37;41:sg=30;43:ca=30;41:tw=30;42:ow=34;42:st=37;44:ex=01;32:*.tar=01;31:*.tgz=01;31:*.arc=01;31:*.arj=01;31:*.taz=01;31:*.lha=01;31:*.lz4=01;31:*.lzh=01;31:*.lzma=01;31:*.tlz=01;31:*.txz=01;31:*.tzo=01;31:*.t7z=01;31:*.zip=01;31:*.z=01;31:*.Z=01;31:*.dz=01;31:*.gz=01;31:*.lrz=01;31:*.lz=01;31:*.lzo=01;31:*.xz=01;31:*.zst=01;31:*.tzst=01;31:*.bz2=01;31:*.bz=01;31:*.tbz=01;31:*.tbz2=01;31:*.tz=01;31:*.deb=01;31:*.rpm=01;31:*.jar=01;31:*.war=01;31:*.ear=01;31:*.sar=01;31:*.rar=01;31:*.alz=01;31:*.ace=01;31:*.zoo=01;31:*.cpio=01;31:*.7z=01;31:*.rz=01;31:*.cab=01;31:*.wim=01;31:*.swm=01;31:*.dwm=01;31:*.esd=01;31:*.jpg=01;35:*.jpeg=01;35:*.mjpg=01;35:*.mjpeg=01;35:*.gif=01;35:*.bmp=01;35:*.pbm=01;35:*.pgm=01;35:*.ppm=01;35:*.tga=01;35:*.xbm=01;35:*.xpm=01;35:*.tif=01;35:*.tiff=01;35:*.png=01;35:*.svg=01;35:*.svgz=01;35:*.mng=01;35:*.pcx=01;35:*.mov=01;35:*.mpg=01;35:*.mpeg=01;35:*.m2v=01;35:*.mkv=01;35:*.webm=01;35:*.ogm=01;35:*.mp4=01;35:*.m4v=01;35:*.mp4v=01;35:*.vob=01;35:*.qt=01;35:*.nuv=01;35:*.wmv=01;35:*.asf=01;35:*.rm=01;35:*.rmvb=01;35:*.flc=01;35:*.avi=01;35:*.fli=01;35:*.flv=01;35:*.gl=01;35:*.dl=01;35:*.xcf=01;35:*.xwd=01;35:*.yuv=01;35:*.cgm=01;35:*.emf=01;35:*.ogv=01;35:*.ogx=01;35:*.aac=00;36:*.au=00;36:*.flac=00;36:*.m4a=00;36:*.mid=00;36:*.midi=00;36:*.mka=00;36:*.mp3=00;36:*.mpc=00;36:*.ogg=00;36:*.ra=00;36:*.wav=00;36:*.oga=00;36:*.opus=00;36:*.spx=00;36:*.xspf=00;36:', 'LD_LIBRARY_PATH': '/opt/crashrepair/lib:/CrashRepair/lib:/klee/build/lib:', 'CONDA_EXE': '/root/anaconda3/bin/conda', 'LANG': 'C.UTF-8', 'TZ': 'Asia/Shanghai', 'HOSTNAME': 'fea22102047d', 'OLDPWD': '/orchestrator', 'CONDA_PREFIX': '/root/anaconda3/envs/CrashRepair', '_CE_M': '', 'CC': 'crepair-cc', 'LLVM_COMPILER': 'clang', 'CONDA_PREFIX_1': '/root/anaconda3', 'PWD': '/orchestrator/crashrepair', 'HOME': '/root', 'CONDA_PYTHON_EXE': '/root/anaconda3/bin/python', '_CE_CONDA': '', 'CONDA_PROMPT_MODIFIER': '(CrashRepair) ', 'CXX': 'crepair-cxx', 'TERM': 'xterm', 'SHLVL': '2', 'PYTHONPATH': '/usr/lib/python3.8/site-packages:', 'PATH': '/root/anaconda3/envs/CrashRepair/bin:/root/anaconda3/condabin:~/anaconda3/bin:/opt/crashrepair/bin:/CrashRepair/compiler:/klee/build/bin:/opt/llvm-6/bin:/klee/build/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', 'CONDA_DEFAULT_ENV': 'CrashRepair', '_': '/root/anaconda3/envs/CrashRepair/bin/python'})
2025-02-05 21:10:17.060 | DEBUG    | scenario:rebuild:398 - using environment: {'INJECT_CFLAGS': '-g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy ', 'INJECT_CXXFLAGS': '-g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy ', 'INJECT_LDFLAGS': '-g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy '}
2025-02-05 21:10:17.060 | DEBUG    | shell:__call__:41 - executing: make CFLAGS="-fsanitize=float-cast-overflow ${INJECT_CFLAGS}" CXXFLAGS="-fsanitize=float-cast-overflow ${INJECT_CXXFLAGS}" LDFLAGS="${INJECT_LDFLAGS}"
Making all in port
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/port'
make[1]: Nothing to be done for 'all'.
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/port'
Making all in libtiff
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/libtiff'
make  all-am
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/libtiff'
/bin/bash ../libtool  --tag=CC   --mode=compile crepair-cc -DHAVE_CONFIG_H -I.     -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -MT tif_dirwrite.lo -MD -MP -MF .deps/tif_dirwrite.Tpo -c -o tif_dirwrite.lo tif_dirwrite.c
libtool: compile:  crepair-cc -DHAVE_CONFIG_H -I. -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -MT tif_dirwrite.lo -MD -MP -MF .deps/tif_dirwrite.Tpo -c tif_dirwrite.c -o tif_dirwrite.o
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
tif_dirwrite.c:963:22: error: use of undeclared identifier 'FLT_MAX'
                                        if (value[i] < -FLT_MAX || value[i] > FLT_MAX) {
                                                        ^
tif_dirwrite.c:963:44: error: use of undeclared identifier 'FLT_MAX'
                                        if (value[i] < -FLT_MAX || value[i] > FLT_MAX) {
                                                                              ^
tif_dirwrite.c:980:21: error: use of undeclared identifier 'INT8_MIN'
                                        if (value[i] < INT8_MIN || value[i] > INT8_MAX) {
                                                       ^
tif_dirwrite.c:980:44: error: use of undeclared identifier 'INT8_MAX'
                                        if (value[i] < INT8_MIN || value[i] > INT8_MAX) {
                                                                              ^
tif_dirwrite.c:991:21: error: use of undeclared identifier 'INT16_MIN'
                                        if (value[i] < INT16_MIN || value[i] > INT16_MAX) {
                                                       ^
tif_dirwrite.c:991:45: error: use of undeclared identifier 'INT16_MAX'
                                        if (value[i] < INT16_MIN || value[i] > INT16_MAX) {
                                                                               ^
tif_dirwrite.c:1002:21: error: use of undeclared identifier 'INT32_MIN'
                                        if (value[i] < INT32_MIN || value[i] > INT32_MAX) {
                                                       ^
tif_dirwrite.c:1002:45: error: use of undeclared identifier 'INT32_MAX'
                                        if (value[i] < INT32_MIN || value[i] > INT32_MAX) {
                                                                               ^
tif_dirwrite.c:1015:37: error: use of undeclared identifier 'UINT8_MAX'
                                        if (value[i] < 0 || value[i] > UINT8_MAX) {
                                                                       ^
tif_dirwrite.c:1026:37: error: use of undeclared identifier 'UINT16_MAX'
                                        if (value[i] < 0 || value[i] > UINT16_MAX) {
                                                                       ^
tif_dirwrite.c:1037:37: error: use of undeclared identifier 'UINT32_MAX'
                                        if (value[i] < 0 || value[i] > UINT32_MAX) {
                                                                       ^
11 errors generated.
ERROR:Failed to compile using given arguments: [-g -O0 -include /CrashRepair/compiler/../lib/crepair_runtime.h -DHAVE_CONFIG_H -I. -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -MT tif_dirwrite.lo -MD -MP -MF .deps/tif_dirwrite.Tpo -c tif_dirwrite.c -o tif_dirwrite.o -L/CrashRepair/compiler/../lib/ -L/klee/build/lib/ -lcrepair_runtime -lcrepair_proxy -lkleeRuntest -fno-sanitize=address]
Makefile:671: recipe for target 'tif_dirwrite.lo' failed
make[2]: *** [tif_dirwrite.lo] Error 1
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/libtiff'
Makefile:496: recipe for target 'all' failed
make[1]: *** [all] Error 2
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/libtiff'
Makefile:547: recipe for target 'all-recursive' failed
make: *** [all-recursive] Error 1
2025-02-05 21:10:17.153 | INFO     | scenario:evaluate:643 - candidate patch #8 failed to compile
2025-02-05 21:10:17.159 | INFO     | scenario:evaluate:635 - evaluating candidate patch #9:
@@ -939,6 +939,7 @@
 	return(0);
 }
 
+
 static int
 TIFFWriteDirectoryTagSampleformatArray(TIFF* tif, uint32* ndir, TIFFDirEntry* dir, uint16 tag, uint32 count, double* value)
 {
@@ -946,7 +947,7 @@
 	void* conv;
 	uint32 i;
 	int ok;
-	conv = _TIFFmalloc(count*sizeof(double));
+	conv = _TIFFmalloc(count * sizeof(double));
 	if (conv == NULL)
 	{
 		TIFFErrorExt(tif->tif_clientdata, module, "Out of memory");
@@ -956,55 +957,91 @@
 	switch (tif->tif_dir.td_sampleformat)
 	{
 		case SAMPLEFORMAT_IEEEFP:
-			if (tif->tif_dir.td_bitspersample<=32)
+			if (tif->tif_dir.td_bitspersample <= 32)
 			{
 				for (i = 0; i < count; ++i)
 					((float*)conv)[i] = (float)value[i];
-				ok = TIFFWriteDirectoryTagFloatArray(tif,ndir,dir,tag,count,(float*)conv);
+				ok = TIFFWriteDirectoryTagFloatArray(tif, ndir, dir, tag, count, (float*)conv);
 			}
 			else
 			{
-				ok = TIFFWriteDirectoryTagDoubleArray(tif,ndir,dir,tag,count,value);
+				ok = TIFFWriteDirectoryTagDoubleArray(tif, ndir, dir, tag, count, value);
 			}
 			break;
 		case SAMPLEFORMAT_INT:
-			if (tif->tif_dir.td_bitspersample<=8)
+			if (tif->tif_dir.td_bitspersample <= 8)
 			{
 				for (i = 0; i < count; ++i)
+				{
+					if (value[i] < INT8_MIN || value[i] > INT8_MAX) {
+						_TIFFfree(conv);
+						return 0; // Out of bounds check
+					}
 					((int8*)conv)[i] = (int8)value[i];
-				ok = TIFFWriteDirectoryTagSbyteArray(tif,ndir,dir,tag,count,(int8*)conv);
+				}
+				ok = TIFFWriteDirectoryTagSbyteArray(tif, ndir, dir, tag, count, (int8*)conv);
 			}
-			else if (tif->tif_dir.td_bitspersample<=16)
+			else if (tif->tif_dir.td_bitspersample <= 16)
 			{
 				for (i = 0; i < count; ++i)
+				{
+					if (value[i] < INT16_MIN || value[i] > INT16_MAX) {
+						_TIFFfree(conv);
+						return 0; // Out of bounds check
+					}
 					((int16*)conv)[i] = (int16)value[i];
-				ok = TIFFWriteDirectoryTagSshortArray(tif,ndir,dir,tag,count,(int16*)conv);
+				}
+				ok = TIFFWriteDirectoryTagSshortArray(tif, ndir, dir, tag, count, (int16*)conv);
 			}
 			else
 			{
 				for (i = 0; i < count; ++i)
+				{
+					if (value[i] < INT32_MIN || value[i] > INT32_MAX) {
+						_TIFFfree(conv);
+						return 0; // Out of bounds check
+					}
 					((int32*)conv)[i] = (int32)value[i];
-				ok = TIFFWriteDirectoryTagSlongArray(tif,ndir,dir,tag,count,(int32*)conv);
+				}
+				ok = TIFFWriteDirectoryTagSlongArray(tif, ndir, dir, tag, count, (int32*)conv);
 			}
 			break;
 		case SAMPLEFORMAT_UINT:
-			if (tif->tif_dir.td_bitspersample<=8)
+			if (tif->tif_dir.td_bitspersample <= 8)
 			{
 				for (i = 0; i < count; ++i)
+				{
+					if (value[i] < 0 || value[i] > UINT8_MAX) {
+						_TIFFfree(conv);
+						return 0; // Out of bounds check
+					}
 					((uint8*)conv)[i] = (uint8)value[i];
-				ok = TIFFWriteDirectoryTagByteArray(tif,ndir,dir,tag,count,(uint8*)conv);
+				}
+				ok = TIFFWriteDirectoryTagByteArray(tif, ndir, dir, tag, count, (uint8*)conv);
 			}
-			else if (tif->tif_dir.td_bitspersample<=16)
+			else if (tif->tif_dir.td_bitspersample <= 16)
 			{
 				for (i = 0; i < count; ++i)
+				{
+					if (value[i] < 0 || value[i] > UINT16_MAX) {
+						_TIFFfree(conv);
+						return 0; // Out of bounds check
+					}
 					((uint16*)conv)[i] = (uint16)value[i];
-				ok = TIFFWriteDirectoryTagShortArray(tif,ndir,dir,tag,count,(uint16*)conv);
+				}
+				ok = TIFFWriteDirectoryTagShortArray(tif, ndir, dir, tag, count, (uint16*)conv);
 			}
 			else
 			{
 				for (i = 0; i < count; ++i)
+				{
+					if (value[i] < 0 || value[i] > UINT32_MAX) {
+						_TIFFfree(conv);
+						return 0; // Out of bounds check
+					}
 					((uint32*)conv)[i] = (uint32)value[i];
-				ok = TIFFWriteDirectoryTagLongArray(tif,ndir,dir,tag,count,(uint32*)conv);
+				}
+				ok = TIFFWriteDirectoryTagLongArray(tif, ndir, dir, tag, count, (uint32*)conv);
 			}
 			break;
 		default:
@@ -1015,6 +1052,7 @@
 	return (ok);
 }
 
+
 #if 0
 static int
 TIFFWriteDirectoryTagSampleformatPerSample(TIFF* tif, uint32* ndir, TIFFDirEntry* dir, uint16 tag, double value)

2025-02-05 21:10:17.163 | DEBUG    | scenario:rebuild:369 - original environment: environ({'CONDA_SHLVL': '2', 'LC_ALL': 'C.UTF-8', 'LS_COLORS': 'rs=0:di=01;34:ln=01;36:mh=00:pi=40;33:so=01;35:do=01;35:bd=40;33;01:cd=40;33;01:or=40;31;01:mi=00:su=37;41:sg=30;43:ca=30;41:tw=30;42:ow=34;42:st=37;44:ex=01;32:*.tar=01;31:*.tgz=01;31:*.arc=01;31:*.arj=01;31:*.taz=01;31:*.lha=01;31:*.lz4=01;31:*.lzh=01;31:*.lzma=01;31:*.tlz=01;31:*.txz=01;31:*.tzo=01;31:*.t7z=01;31:*.zip=01;31:*.z=01;31:*.Z=01;31:*.dz=01;31:*.gz=01;31:*.lrz=01;31:*.lz=01;31:*.lzo=01;31:*.xz=01;31:*.zst=01;31:*.tzst=01;31:*.bz2=01;31:*.bz=01;31:*.tbz=01;31:*.tbz2=01;31:*.tz=01;31:*.deb=01;31:*.rpm=01;31:*.jar=01;31:*.war=01;31:*.ear=01;31:*.sar=01;31:*.rar=01;31:*.alz=01;31:*.ace=01;31:*.zoo=01;31:*.cpio=01;31:*.7z=01;31:*.rz=01;31:*.cab=01;31:*.wim=01;31:*.swm=01;31:*.dwm=01;31:*.esd=01;31:*.jpg=01;35:*.jpeg=01;35:*.mjpg=01;35:*.mjpeg=01;35:*.gif=01;35:*.bmp=01;35:*.pbm=01;35:*.pgm=01;35:*.ppm=01;35:*.tga=01;35:*.xbm=01;35:*.xpm=01;35:*.tif=01;35:*.tiff=01;35:*.png=01;35:*.svg=01;35:*.svgz=01;35:*.mng=01;35:*.pcx=01;35:*.mov=01;35:*.mpg=01;35:*.mpeg=01;35:*.m2v=01;35:*.mkv=01;35:*.webm=01;35:*.ogm=01;35:*.mp4=01;35:*.m4v=01;35:*.mp4v=01;35:*.vob=01;35:*.qt=01;35:*.nuv=01;35:*.wmv=01;35:*.asf=01;35:*.rm=01;35:*.rmvb=01;35:*.flc=01;35:*.avi=01;35:*.fli=01;35:*.flv=01;35:*.gl=01;35:*.dl=01;35:*.xcf=01;35:*.xwd=01;35:*.yuv=01;35:*.cgm=01;35:*.emf=01;35:*.ogv=01;35:*.ogx=01;35:*.aac=00;36:*.au=00;36:*.flac=00;36:*.m4a=00;36:*.mid=00;36:*.midi=00;36:*.mka=00;36:*.mp3=00;36:*.mpc=00;36:*.ogg=00;36:*.ra=00;36:*.wav=00;36:*.oga=00;36:*.opus=00;36:*.spx=00;36:*.xspf=00;36:', 'LD_LIBRARY_PATH': '/opt/crashrepair/lib:/CrashRepair/lib:/klee/build/lib:', 'CONDA_EXE': '/root/anaconda3/bin/conda', 'LANG': 'C.UTF-8', 'TZ': 'Asia/Shanghai', 'HOSTNAME': 'fea22102047d', 'OLDPWD': '/orchestrator', 'CONDA_PREFIX': '/root/anaconda3/envs/CrashRepair', '_CE_M': '', 'CC': 'crepair-cc', 'LLVM_COMPILER': 'clang', 'CONDA_PREFIX_1': '/root/anaconda3', 'PWD': '/orchestrator/crashrepair', 'HOME': '/root', 'CONDA_PYTHON_EXE': '/root/anaconda3/bin/python', '_CE_CONDA': '', 'CONDA_PROMPT_MODIFIER': '(CrashRepair) ', 'CXX': 'crepair-cxx', 'TERM': 'xterm', 'SHLVL': '2', 'PYTHONPATH': '/usr/lib/python3.8/site-packages:', 'PATH': '/root/anaconda3/envs/CrashRepair/bin:/root/anaconda3/condabin:~/anaconda3/bin:/opt/crashrepair/bin:/CrashRepair/compiler:/klee/build/bin:/opt/llvm-6/bin:/klee/build/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', 'CONDA_DEFAULT_ENV': 'CrashRepair', '_': '/root/anaconda3/envs/CrashRepair/bin/python'})
2025-02-05 21:10:17.163 | DEBUG    | scenario:rebuild:398 - using environment: {'INJECT_CFLAGS': '-g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy ', 'INJECT_CXXFLAGS': '-g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy ', 'INJECT_LDFLAGS': '-g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy '}
2025-02-05 21:10:17.164 | DEBUG    | shell:__call__:41 - executing: make CFLAGS="-fsanitize=float-cast-overflow ${INJECT_CFLAGS}" CXXFLAGS="-fsanitize=float-cast-overflow ${INJECT_CXXFLAGS}" LDFLAGS="${INJECT_LDFLAGS}"
Making all in port
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/port'
make[1]: Nothing to be done for 'all'.
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/port'
Making all in libtiff
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/libtiff'
make  all-am
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/libtiff'
/bin/bash ../libtool  --tag=CC   --mode=compile crepair-cc -DHAVE_CONFIG_H -I.     -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -MT tif_dirwrite.lo -MD -MP -MF .deps/tif_dirwrite.Tpo -c -o tif_dirwrite.lo tif_dirwrite.c
libtool: compile:  crepair-cc -DHAVE_CONFIG_H -I. -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -MT tif_dirwrite.lo -MD -MP -MF .deps/tif_dirwrite.Tpo -c tif_dirwrite.c -o tif_dirwrite.o
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
tif_dirwrite.c:976:21: error: use of undeclared identifier 'INT8_MIN'
                                        if (value[i] < INT8_MIN || value[i] > INT8_MAX) {
                                                       ^
tif_dirwrite.c:976:44: error: use of undeclared identifier 'INT8_MAX'
                                        if (value[i] < INT8_MIN || value[i] > INT8_MAX) {
                                                                              ^
tif_dirwrite.c:988:21: error: use of undeclared identifier 'INT16_MIN'
                                        if (value[i] < INT16_MIN || value[i] > INT16_MAX) {
                                                       ^
tif_dirwrite.c:988:45: error: use of undeclared identifier 'INT16_MAX'
                                        if (value[i] < INT16_MIN || value[i] > INT16_MAX) {
                                                                               ^
tif_dirwrite.c:1000:21: error: use of undeclared identifier 'INT32_MIN'
                                        if (value[i] < INT32_MIN || value[i] > INT32_MAX) {
                                                       ^
tif_dirwrite.c:1000:45: error: use of undeclared identifier 'INT32_MAX'
                                        if (value[i] < INT32_MIN || value[i] > INT32_MAX) {
                                                                               ^
tif_dirwrite.c:1014:37: error: use of undeclared identifier 'UINT8_MAX'
                                        if (value[i] < 0 || value[i] > UINT8_MAX) {
                                                                       ^
tif_dirwrite.c:1026:37: error: use of undeclared identifier 'UINT16_MAX'
                                        if (value[i] < 0 || value[i] > UINT16_MAX) {
                                                                       ^
tif_dirwrite.c:1038:37: error: use of undeclared identifier 'UINT32_MAX'
                                        if (value[i] < 0 || value[i] > UINT32_MAX) {
                                                                       ^
9 errors generated.
ERROR:Failed to compile using given arguments: [-g -O0 -include /CrashRepair/compiler/../lib/crepair_runtime.h -DHAVE_CONFIG_H -I. -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -MT tif_dirwrite.lo -MD -MP -MF .deps/tif_dirwrite.Tpo -c tif_dirwrite.c -o tif_dirwrite.o -L/CrashRepair/compiler/../lib/ -L/klee/build/lib/ -lcrepair_runtime -lcrepair_proxy -lkleeRuntest -fno-sanitize=address]
Makefile:671: recipe for target 'tif_dirwrite.lo' failed
make[2]: *** [tif_dirwrite.lo] Error 1
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/libtiff'
Makefile:496: recipe for target 'all' failed
make[1]: *** [all] Error 2
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/libtiff'
Makefile:547: recipe for target 'all-recursive' failed
make: *** [all-recursive] Error 1
2025-02-05 21:10:17.257 | INFO     | scenario:evaluate:643 - candidate patch #9 failed to compile
2025-02-05 21:10:17.263 | INFO     | scenario:evaluate:635 - evaluating candidate patch #10:
@@ -939,6 +939,7 @@
 	return(0);
 }
 
+
 static int
 TIFFWriteDirectoryTagSampleformatArray(TIFF* tif, uint32* ndir, TIFFDirEntry* dir, uint16 tag, uint32 count, double* value)
 {
@@ -953,6 +954,13 @@
 		return (0);
 	}
 
+	if (count > MAX_COUNT) // Added safeguard to prevent excessive iterations
+	{
+		TIFFErrorExt(tif->tif_clientdata, module, "Count exceeds maximum allowed size");
+		_TIFFfree(conv);
+		return (0);
+	}
+
 	switch (tif->tif_dir.td_sampleformat)
 	{
 		case SAMPLEFORMAT_IEEEFP:
@@ -1015,6 +1023,7 @@
 	return (ok);
 }
 
+
 #if 0
 static int
 TIFFWriteDirectoryTagSampleformatPerSample(TIFF* tif, uint32* ndir, TIFFDirEntry* dir, uint16 tag, double value)

2025-02-05 21:10:17.267 | DEBUG    | scenario:rebuild:369 - original environment: environ({'CONDA_SHLVL': '2', 'LC_ALL': 'C.UTF-8', 'LS_COLORS': 'rs=0:di=01;34:ln=01;36:mh=00:pi=40;33:so=01;35:do=01;35:bd=40;33;01:cd=40;33;01:or=40;31;01:mi=00:su=37;41:sg=30;43:ca=30;41:tw=30;42:ow=34;42:st=37;44:ex=01;32:*.tar=01;31:*.tgz=01;31:*.arc=01;31:*.arj=01;31:*.taz=01;31:*.lha=01;31:*.lz4=01;31:*.lzh=01;31:*.lzma=01;31:*.tlz=01;31:*.txz=01;31:*.tzo=01;31:*.t7z=01;31:*.zip=01;31:*.z=01;31:*.Z=01;31:*.dz=01;31:*.gz=01;31:*.lrz=01;31:*.lz=01;31:*.lzo=01;31:*.xz=01;31:*.zst=01;31:*.tzst=01;31:*.bz2=01;31:*.bz=01;31:*.tbz=01;31:*.tbz2=01;31:*.tz=01;31:*.deb=01;31:*.rpm=01;31:*.jar=01;31:*.war=01;31:*.ear=01;31:*.sar=01;31:*.rar=01;31:*.alz=01;31:*.ace=01;31:*.zoo=01;31:*.cpio=01;31:*.7z=01;31:*.rz=01;31:*.cab=01;31:*.wim=01;31:*.swm=01;31:*.dwm=01;31:*.esd=01;31:*.jpg=01;35:*.jpeg=01;35:*.mjpg=01;35:*.mjpeg=01;35:*.gif=01;35:*.bmp=01;35:*.pbm=01;35:*.pgm=01;35:*.ppm=01;35:*.tga=01;35:*.xbm=01;35:*.xpm=01;35:*.tif=01;35:*.tiff=01;35:*.png=01;35:*.svg=01;35:*.svgz=01;35:*.mng=01;35:*.pcx=01;35:*.mov=01;35:*.mpg=01;35:*.mpeg=01;35:*.m2v=01;35:*.mkv=01;35:*.webm=01;35:*.ogm=01;35:*.mp4=01;35:*.m4v=01;35:*.mp4v=01;35:*.vob=01;35:*.qt=01;35:*.nuv=01;35:*.wmv=01;35:*.asf=01;35:*.rm=01;35:*.rmvb=01;35:*.flc=01;35:*.avi=01;35:*.fli=01;35:*.flv=01;35:*.gl=01;35:*.dl=01;35:*.xcf=01;35:*.xwd=01;35:*.yuv=01;35:*.cgm=01;35:*.emf=01;35:*.ogv=01;35:*.ogx=01;35:*.aac=00;36:*.au=00;36:*.flac=00;36:*.m4a=00;36:*.mid=00;36:*.midi=00;36:*.mka=00;36:*.mp3=00;36:*.mpc=00;36:*.ogg=00;36:*.ra=00;36:*.wav=00;36:*.oga=00;36:*.opus=00;36:*.spx=00;36:*.xspf=00;36:', 'LD_LIBRARY_PATH': '/opt/crashrepair/lib:/CrashRepair/lib:/klee/build/lib:', 'CONDA_EXE': '/root/anaconda3/bin/conda', 'LANG': 'C.UTF-8', 'TZ': 'Asia/Shanghai', 'HOSTNAME': 'fea22102047d', 'OLDPWD': '/orchestrator', 'CONDA_PREFIX': '/root/anaconda3/envs/CrashRepair', '_CE_M': '', 'CC': 'crepair-cc', 'LLVM_COMPILER': 'clang', 'CONDA_PREFIX_1': '/root/anaconda3', 'PWD': '/orchestrator/crashrepair', 'HOME': '/root', 'CONDA_PYTHON_EXE': '/root/anaconda3/bin/python', '_CE_CONDA': '', 'CONDA_PROMPT_MODIFIER': '(CrashRepair) ', 'CXX': 'crepair-cxx', 'TERM': 'xterm', 'SHLVL': '2', 'PYTHONPATH': '/usr/lib/python3.8/site-packages:', 'PATH': '/root/anaconda3/envs/CrashRepair/bin:/root/anaconda3/condabin:~/anaconda3/bin:/opt/crashrepair/bin:/CrashRepair/compiler:/klee/build/bin:/opt/llvm-6/bin:/klee/build/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', 'CONDA_DEFAULT_ENV': 'CrashRepair', '_': '/root/anaconda3/envs/CrashRepair/bin/python'})
2025-02-05 21:10:17.267 | DEBUG    | scenario:rebuild:398 - using environment: {'INJECT_CFLAGS': '-g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy ', 'INJECT_CXXFLAGS': '-g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy ', 'INJECT_LDFLAGS': '-g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy '}
2025-02-05 21:10:17.267 | DEBUG    | shell:__call__:41 - executing: make CFLAGS="-fsanitize=float-cast-overflow ${INJECT_CFLAGS}" CXXFLAGS="-fsanitize=float-cast-overflow ${INJECT_CXXFLAGS}" LDFLAGS="${INJECT_LDFLAGS}"
Making all in port
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/port'
make[1]: Nothing to be done for 'all'.
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/port'
Making all in libtiff
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/libtiff'
make  all-am
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/libtiff'
/bin/bash ../libtool  --tag=CC   --mode=compile crepair-cc -DHAVE_CONFIG_H -I.     -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -MT tif_dirwrite.lo -MD -MP -MF .deps/tif_dirwrite.Tpo -c -o tif_dirwrite.lo tif_dirwrite.c
libtool: compile:  crepair-cc -DHAVE_CONFIG_H -I. -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -MT tif_dirwrite.lo -MD -MP -MF .deps/tif_dirwrite.Tpo -c tif_dirwrite.c -o tif_dirwrite.o
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
tif_dirwrite.c:957:14: error: use of undeclared identifier 'MAX_COUNT'
        if (count > MAX_COUNT) // Added safeguard to prevent excessive iterations
                    ^
1 error generated.
ERROR:Failed to compile using given arguments: [-g -O0 -include /CrashRepair/compiler/../lib/crepair_runtime.h -DHAVE_CONFIG_H -I. -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -MT tif_dirwrite.lo -MD -MP -MF .deps/tif_dirwrite.Tpo -c tif_dirwrite.c -o tif_dirwrite.o -L/CrashRepair/compiler/../lib/ -L/klee/build/lib/ -lcrepair_runtime -lcrepair_proxy -lkleeRuntest -fno-sanitize=address]
Makefile:671: recipe for target 'tif_dirwrite.lo' failed
make[2]: *** [tif_dirwrite.lo] Error 1
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/libtiff'
Makefile:496: recipe for target 'all' failed
make[1]: *** [all] Error 2
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/libtiff'
Makefile:547: recipe for target 'all-recursive' failed
make: *** [all-recursive] Error 1
2025-02-05 21:10:17.357 | INFO     | scenario:evaluate:643 - candidate patch #10 failed to compile
2025-02-05 21:10:17.363 | INFO     | scenario:evaluate:635 - evaluating candidate patch #11:
@@ -939,82 +939,88 @@
 	return(0);
 }
 
+
 static int
 TIFFWriteDirectoryTagSampleformatArray(TIFF* tif, uint32* ndir, TIFFDirEntry* dir, uint16 tag, uint32 count, double* value)
 {
-	static const char module[] = "TIFFWriteDirectoryTagSampleformatArray";
-	void* conv;
-	uint32 i;
-	int ok;
-	conv = _TIFFmalloc(count*sizeof(double));
-	if (conv == NULL)
-	{
-		TIFFErrorExt(tif->tif_clientdata, module, "Out of memory");
-		return (0);
-	}
-
-	switch (tif->tif_dir.td_sampleformat)
-	{
-		case SAMPLEFORMAT_IEEEFP:
-			if (tif->tif_dir.td_bitspersample<=32)
-			{
-				for (i = 0; i < count; ++i)
-					((float*)conv)[i] = (float)value[i];
-				ok = TIFFWriteDirectoryTagFloatArray(tif,ndir,dir,tag,count,(float*)conv);
-			}
-			else
-			{
-				ok = TIFFWriteDirectoryTagDoubleArray(tif,ndir,dir,tag,count,value);
-			}
-			break;
-		case SAMPLEFORMAT_INT:
-			if (tif->tif_dir.td_bitspersample<=8)
-			{
-				for (i = 0; i < count; ++i)
-					((int8*)conv)[i] = (int8)value[i];
-				ok = TIFFWriteDirectoryTagSbyteArray(tif,ndir,dir,tag,count,(int8*)conv);
-			}
-			else if (tif->tif_dir.td_bitspersample<=16)
-			{
-				for (i = 0; i < count; ++i)
-					((int16*)conv)[i] = (int16)value[i];
-				ok = TIFFWriteDirectoryTagSshortArray(tif,ndir,dir,tag,count,(int16*)conv);
-			}
-			else
-			{
-				for (i = 0; i < count; ++i)
-					((int32*)conv)[i] = (int32)value[i];
-				ok = TIFFWriteDirectoryTagSlongArray(tif,ndir,dir,tag,count,(int32*)conv);
-			}
-			break;
-		case SAMPLEFORMAT_UINT:
-			if (tif->tif_dir.td_bitspersample<=8)
-			{
-				for (i = 0; i < count; ++i)
-					((uint8*)conv)[i] = (uint8)value[i];
-				ok = TIFFWriteDirectoryTagByteArray(tif,ndir,dir,tag,count,(uint8*)conv);
-			}
-			else if (tif->tif_dir.td_bitspersample<=16)
-			{
-				for (i = 0; i < count; ++i)
-					((uint16*)conv)[i] = (uint16)value[i];
-				ok = TIFFWriteDirectoryTagShortArray(tif,ndir,dir,tag,count,(uint16*)conv);
-			}
-			else
-			{
-				for (i = 0; i < count; ++i)
-					((uint32*)conv)[i] = (uint32)value[i];
-				ok = TIFFWriteDirectoryTagLongArray(tif,ndir,dir,tag,count,(uint32*)conv);
-			}
-			break;
-		default:
-			ok = 0;
-	}
+    static const char module[] = "TIFFWriteDirectoryTagSampleformatArray";
+    void* conv;
+    uint32 i;
+    int ok;
+    if (count == 0) {
+        TIFFErrorExt(tif->tif_clientdata, module, "Count cannot be zero");
+        return (0);
+    }
+    conv = _TIFFmalloc(count*sizeof(double));
+    if (conv == NULL)
+    {
+        TIFFErrorExt(tif->tif_clientdata, module, "Out of memory");
+        return (0);
+    }
+
+    switch (tif->tif_dir.td_sampleformat)
+    {
+        case SAMPLEFORMAT_IEEEFP:
+            if (tif->tif_dir.td_bitspersample<=32)
+            {
+                for (i = 0; i < count; ++i)
+                    ((float*)conv)[i] = (float)value[i];
+                ok = TIFFWriteDirectoryTagFloatArray(tif,ndir,dir,tag,count,(float*)conv);
+            }
+            else
+            {
+                ok = TIFFWriteDirectoryTagDoubleArray(tif,ndir,dir,tag,count,value);
+            }
+            break;
+        case SAMPLEFORMAT_INT:
+            if (tif->tif_dir.td_bitspersample<=8)
+            {
+                for (i = 0; i < count; ++i)
+                    ((int8*)conv)[i] = (int8)value[i];
+                ok = TIFFWriteDirectoryTagSbyteArray(tif,ndir,dir,tag,count,(int8*)conv);
+            }
+            else if (tif->tif_dir.td_bitspersample<=16)
+            {
+                for (i = 0; i < count; ++i)
+                    ((int16*)conv)[i] = (int16)value[i];
+                ok = TIFFWriteDirectoryTagSshortArray(tif,ndir,dir,tag,count,(int16*)conv);
+            }
+            else
+            {
+                for (i = 0; i < count; ++i)
+                    ((int32*)conv)[i] = (int32)value[i];
+                ok = TIFFWriteDirectoryTagSlongArray(tif,ndir,dir,tag,count,(int32*)conv);
+            }
+            break;
+        case SAMPLEFORMAT_UINT:
+            if (tif->tif_dir.td_bitspersample<=8)
+            {
+                for (i = 0; i < count; ++i)
+                    ((uint8*)conv)[i] = (uint8)value[i];
+                ok = TIFFWriteDirectoryTagByteArray(tif,ndir,dir,tag,count,(uint8*)conv);
+            }
+            else if (tif->tif_dir.td_bitspersample<=16)
+            {
+                for (i = 0; i < count; ++i)
+                    ((uint16*)conv)[i] = (uint16)value[i];
+                ok = TIFFWriteDirectoryTagShortArray(tif,ndir,dir,tag,count,(uint16*)conv);
+            }
+            else
+            {
+                for (i = 0; i < count; ++i)
+                    ((uint32*)conv)[i] = (uint32)value[i];
+                ok = TIFFWriteDirectoryTagLongArray(tif,ndir,dir,tag,count,(uint32*)conv);
+            }
+            break;
+        default:
+            ok = 0;
+    }
 
-	_TIFFfree(conv);
-	return (ok);
+    _TIFFfree(conv);
+    return (ok);
 }
 
+
 #if 0
 static int
 TIFFWriteDirectoryTagSampleformatPerSample(TIFF* tif, uint32* ndir, TIFFDirEntry* dir, uint16 tag, double value)

2025-02-05 21:10:17.369 | DEBUG    | scenario:rebuild:369 - original environment: environ({'CONDA_SHLVL': '2', 'LC_ALL': 'C.UTF-8', 'LS_COLORS': 'rs=0:di=01;34:ln=01;36:mh=00:pi=40;33:so=01;35:do=01;35:bd=40;33;01:cd=40;33;01:or=40;31;01:mi=00:su=37;41:sg=30;43:ca=30;41:tw=30;42:ow=34;42:st=37;44:ex=01;32:*.tar=01;31:*.tgz=01;31:*.arc=01;31:*.arj=01;31:*.taz=01;31:*.lha=01;31:*.lz4=01;31:*.lzh=01;31:*.lzma=01;31:*.tlz=01;31:*.txz=01;31:*.tzo=01;31:*.t7z=01;31:*.zip=01;31:*.z=01;31:*.Z=01;31:*.dz=01;31:*.gz=01;31:*.lrz=01;31:*.lz=01;31:*.lzo=01;31:*.xz=01;31:*.zst=01;31:*.tzst=01;31:*.bz2=01;31:*.bz=01;31:*.tbz=01;31:*.tbz2=01;31:*.tz=01;31:*.deb=01;31:*.rpm=01;31:*.jar=01;31:*.war=01;31:*.ear=01;31:*.sar=01;31:*.rar=01;31:*.alz=01;31:*.ace=01;31:*.zoo=01;31:*.cpio=01;31:*.7z=01;31:*.rz=01;31:*.cab=01;31:*.wim=01;31:*.swm=01;31:*.dwm=01;31:*.esd=01;31:*.jpg=01;35:*.jpeg=01;35:*.mjpg=01;35:*.mjpeg=01;35:*.gif=01;35:*.bmp=01;35:*.pbm=01;35:*.pgm=01;35:*.ppm=01;35:*.tga=01;35:*.xbm=01;35:*.xpm=01;35:*.tif=01;35:*.tiff=01;35:*.png=01;35:*.svg=01;35:*.svgz=01;35:*.mng=01;35:*.pcx=01;35:*.mov=01;35:*.mpg=01;35:*.mpeg=01;35:*.m2v=01;35:*.mkv=01;35:*.webm=01;35:*.ogm=01;35:*.mp4=01;35:*.m4v=01;35:*.mp4v=01;35:*.vob=01;35:*.qt=01;35:*.nuv=01;35:*.wmv=01;35:*.asf=01;35:*.rm=01;35:*.rmvb=01;35:*.flc=01;35:*.avi=01;35:*.fli=01;35:*.flv=01;35:*.gl=01;35:*.dl=01;35:*.xcf=01;35:*.xwd=01;35:*.yuv=01;35:*.cgm=01;35:*.emf=01;35:*.ogv=01;35:*.ogx=01;35:*.aac=00;36:*.au=00;36:*.flac=00;36:*.m4a=00;36:*.mid=00;36:*.midi=00;36:*.mka=00;36:*.mp3=00;36:*.mpc=00;36:*.ogg=00;36:*.ra=00;36:*.wav=00;36:*.oga=00;36:*.opus=00;36:*.spx=00;36:*.xspf=00;36:', 'LD_LIBRARY_PATH': '/opt/crashrepair/lib:/CrashRepair/lib:/klee/build/lib:', 'CONDA_EXE': '/root/anaconda3/bin/conda', 'LANG': 'C.UTF-8', 'TZ': 'Asia/Shanghai', 'HOSTNAME': 'fea22102047d', 'OLDPWD': '/orchestrator', 'CONDA_PREFIX': '/root/anaconda3/envs/CrashRepair', '_CE_M': '', 'CC': 'crepair-cc', 'LLVM_COMPILER': 'clang', 'CONDA_PREFIX_1': '/root/anaconda3', 'PWD': '/orchestrator/crashrepair', 'HOME': '/root', 'CONDA_PYTHON_EXE': '/root/anaconda3/bin/python', '_CE_CONDA': '', 'CONDA_PROMPT_MODIFIER': '(CrashRepair) ', 'CXX': 'crepair-cxx', 'TERM': 'xterm', 'SHLVL': '2', 'PYTHONPATH': '/usr/lib/python3.8/site-packages:', 'PATH': '/root/anaconda3/envs/CrashRepair/bin:/root/anaconda3/condabin:~/anaconda3/bin:/opt/crashrepair/bin:/CrashRepair/compiler:/klee/build/bin:/opt/llvm-6/bin:/klee/build/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', 'CONDA_DEFAULT_ENV': 'CrashRepair', '_': '/root/anaconda3/envs/CrashRepair/bin/python'})
2025-02-05 21:10:17.369 | DEBUG    | scenario:rebuild:398 - using environment: {'INJECT_CFLAGS': '-g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy ', 'INJECT_CXXFLAGS': '-g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy ', 'INJECT_LDFLAGS': '-g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy '}
2025-02-05 21:10:17.369 | DEBUG    | shell:__call__:41 - executing: make CFLAGS="-fsanitize=float-cast-overflow ${INJECT_CFLAGS}" CXXFLAGS="-fsanitize=float-cast-overflow ${INJECT_CXXFLAGS}" LDFLAGS="${INJECT_LDFLAGS}"
Making all in port
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/port'
make[1]: Nothing to be done for 'all'.
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/port'
Making all in libtiff
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/libtiff'
make  all-am
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/libtiff'
/bin/bash ../libtool  --tag=CC   --mode=compile crepair-cc -DHAVE_CONFIG_H -I.     -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -MT tif_dirwrite.lo -MD -MP -MF .deps/tif_dirwrite.Tpo -c -o tif_dirwrite.lo tif_dirwrite.c
libtool: compile:  crepair-cc -DHAVE_CONFIG_H -I. -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -MT tif_dirwrite.lo -MD -MP -MF .deps/tif_dirwrite.Tpo -c tif_dirwrite.c -o tif_dirwrite.o
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
mv -f .deps/tif_dirwrite.Tpo .deps/tif_dirwrite.Plo
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -no-undefined -version-info 7:5:2   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o libtiff.la -rpath /usr/local/lib tif_aux.lo tif_close.lo tif_codec.lo tif_color.lo tif_compress.lo tif_dir.lo tif_dirinfo.lo tif_dirread.lo tif_dirwrite.lo tif_dumpmode.lo tif_error.lo tif_extension.lo tif_fax3.lo tif_fax3sm.lo tif_flush.lo tif_getimage.lo tif_jbig.lo tif_jpeg.lo tif_jpeg_12.lo tif_luv.lo tif_lzma.lo tif_lzw.lo tif_next.lo tif_ojpeg.lo tif_open.lo tif_packbits.lo tif_pixarlog.lo tif_predict.lo tif_print.lo tif_read.lo tif_strip.lo tif_swab.lo tif_thunder.lo tif_tile.lo tif_version.lo tif_warning.lo tif_write.lo tif_zip.lo  tif_unix.lo ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: rm -fr  .libs/libtiff.a .libs/libtiff.la .libs/libtiff.lai
libtool: link: (cd .libs/libtiff.lax/libport.a && ar x "/data/vulnloc/libtiff/CVE-2017-7600/src/libtiff/../port/.libs/libport.a")
libtool: link: ar cru .libs/libtiff.a  tif_aux.o tif_close.o tif_codec.o tif_color.o tif_compress.o tif_dir.o tif_dirinfo.o tif_dirread.o tif_dirwrite.o tif_dumpmode.o tif_error.o tif_extension.o tif_fax3.o tif_fax3sm.o tif_flush.o tif_getimage.o tif_jbig.o tif_jpeg.o tif_jpeg_12.o tif_luv.o tif_lzma.o tif_lzw.o tif_next.o tif_ojpeg.o tif_open.o tif_packbits.o tif_pixarlog.o tif_predict.o tif_print.o tif_read.o tif_strip.o tif_swab.o tif_thunder.o tif_tile.o tif_version.o tif_warning.o tif_write.o tif_zip.o tif_unix.o  .libs/libtiff.lax/libport.a/dummy.o 
ar: `u' modifier ignored since `D' is the default (see `U')
libtool: link: ranlib .libs/libtiff.a
libtool: link: rm -fr .libs/libtiff.lax
libtool: link: ( cd ".libs" && rm -f "libtiff.la" && ln -s "../libtiff.la" "libtiff.la" )
/bin/bash ../libtool  --tag=CXX   --mode=link crepair-cxx  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -no-undefined -version-info 7:5:2   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o libtiffxx.la -rpath /usr/local/lib tif_stream.lo ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: rm -fr  .libs/libtiffxx.a .libs/libtiffxx.la .libs/libtiffxx.lai
libtool: link: (cd .libs/libtiffxx.lax/libport.a && ar x "/data/vulnloc/libtiff/CVE-2017-7600/src/libtiff/../port/.libs/libport.a")
libtool: link: ar cru .libs/libtiffxx.a  tif_stream.o  .libs/libtiffxx.lax/libport.a/dummy.o 
ar: `u' modifier ignored since `D' is the default (see `U')
libtool: link: ranlib .libs/libtiffxx.a
libtool: link: rm -fr .libs/libtiffxx.lax
libtool: link: ( cd ".libs" && rm -f "libtiffxx.la" && ln -s "../libtiffxx.la" "libtiffxx.la" )
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/libtiff'
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/libtiff'
Making all in tools
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/tools'
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o bmp2tiff bmp2tiff.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o bmp2tiff bmp2tiff.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o fax2ps fax2ps.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o fax2ps fax2ps.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o fax2tiff fax2tiff.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o fax2tiff fax2tiff.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o gif2tiff gif2tiff.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o gif2tiff gif2tiff.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o pal2rgb pal2rgb.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o pal2rgb pal2rgb.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o ppm2tiff ppm2tiff.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o ppm2tiff ppm2tiff.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o ras2tiff ras2tiff.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o ras2tiff ras2tiff.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o raw2tiff raw2tiff.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o raw2tiff raw2tiff.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o rgb2ycbcr rgb2ycbcr.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o rgb2ycbcr rgb2ycbcr.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o thumbnail thumbnail.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o thumbnail thumbnail.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o tiff2bw tiff2bw.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o tiff2bw tiff2bw.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o tiff2pdf tiff2pdf.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o tiff2pdf tiff2pdf.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o tiff2ps tiff2ps.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o tiff2ps tiff2ps.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o tiff2rgba tiff2rgba.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o tiff2rgba tiff2rgba.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o tiffcmp tiffcmp.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o tiffcmp tiffcmp.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o tiffcp tiffcp.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o tiffcp tiffcp.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o tiffcrop tiffcrop.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o tiffcrop tiffcrop.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o tiffdither tiffdither.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o tiffdither tiffdither.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o tiffdump tiffdump.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o tiffdump tiffdump.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o tiffinfo tiffinfo.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o tiffinfo tiffinfo.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o tiffmedian tiffmedian.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o tiffmedian tiffmedian.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o tiffset tiffset.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o tiffset tiffset.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o tiffsplit tiffsplit.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o tiffsplit tiffsplit.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/tools'
Making all in build
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/build'
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/build'
make[2]: Nothing to be done for 'all-am'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/build'
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/build'
Making all in contrib
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib'
Making all in addtiffo
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/addtiffo'
/bin/bash ../../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o addtiffo addtiffo.o tif_overview.o tif_ovrcache.o ../../libtiff/libtiff.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o addtiffo addtiffo.o tif_overview.o tif_ovrcache.o  -L/klee/build/lib -L/CrashRepair/lib ../../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy -llzma -ljbig -ljpeg -lz -lm
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/addtiffo'
Making all in dbs
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/dbs'
Making all in xtiff
make[3]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/dbs/xtiff'
make[3]: Nothing to be done for 'all'.
make[3]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/dbs/xtiff'
make[3]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/dbs'
/bin/bash ../../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o tiff-bi tiff-bi.o ../../libtiff/libtiff.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o tiff-bi tiff-bi.o  -L/klee/build/lib -L/CrashRepair/lib ../../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o tiff-grayscale tiff-grayscale.o ../../libtiff/libtiff.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o tiff-grayscale tiff-grayscale.o  -L/klee/build/lib -L/CrashRepair/lib ../../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o tiff-palette tiff-palette.o ../../libtiff/libtiff.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o tiff-palette tiff-palette.o  -L/klee/build/lib -L/CrashRepair/lib ../../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o tiff-rgb tiff-rgb.o ../../libtiff/libtiff.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o tiff-rgb tiff-rgb.o  -L/klee/build/lib -L/CrashRepair/lib ../../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy -llzma -ljbig -ljpeg -lz -lm
make[3]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/dbs'
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/dbs'
Making all in iptcutil
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/iptcutil'
/bin/bash ../../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o iptcutil iptcutil.o ../../libtiff/libtiff.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o iptcutil iptcutil.o  -L/klee/build/lib -L/CrashRepair/lib ../../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy -llzma -ljbig -ljpeg -lz -lm
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/iptcutil'
Making all in mfs
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/mfs'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/mfs'
Making all in pds
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/pds'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/pds'
Making all in ras
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/ras'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/ras'
Making all in stream
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/stream'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/stream'
Making all in tags
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/tags'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/tags'
Making all in win_dib
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/win_dib'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/win_dib'
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib'
make[2]: Nothing to be done for 'all-am'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib'
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib'
Making all in test
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/test'
make[1]: Nothing to be done for 'all'.
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/test'
Making all in man
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/man'
make[1]: Nothing to be done for 'all'.
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/man'
Making all in html
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/html'
Making all in images
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/html/images'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/html/images'
Making all in man
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/html/man'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/html/man'
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/html'
make[2]: Nothing to be done for 'all-am'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/html'
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/html'
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src'
make[1]: Nothing to be done for 'all-am'.
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src'
2025-02-05 21:10:21.766 | DEBUG    | scenario:evaluate:655 - testing candidate #11 against test #crash...
2025-02-05 21:10:21.766 | DEBUG    | shell:__call__:41 - executing: /data/vulnloc/libtiff/CVE-2017-7600/src/tools/tiffcp -i /CrashRepair/experiments/vulnloc/libtiff/CVE-2017-7600/tests/1.tif out.tiff
2025-02-05 21:10:21.771 | DEBUG    | test:run:172 - test failed: stderr contains bad output substring (runtime error: -115 is outside the range of representable values)
2025-02-05 21:10:21.771 | INFO     | scenario:evaluate:662 - candidate #11 fails test #crash
2025-02-05 21:10:21.781 | INFO     | scenario:evaluate:635 - evaluating candidate patch #12:
@@ -939,6 +939,7 @@
 	return(0);
 }
 
+
 static int
 TIFFWriteDirectoryTagSampleformatArray(TIFF* tif, uint32* ndir, TIFFDirEntry* dir, uint16 tag, uint32 count, double* value)
 {
@@ -946,7 +947,13 @@
 	void* conv;
 	uint32 i;
 	int ok;
-	conv = _TIFFmalloc(count*sizeof(double));
+	
+	if (count == 0 || value == NULL) {
+		TIFFErrorExt(tif->tif_clientdata, module, "Invalid count or value pointer");
+		return (0);
+	}
+
+	conv = _TIFFmalloc(count * sizeof(double));
 	if (conv == NULL)
 	{
 		TIFFErrorExt(tif->tif_clientdata, module, "Out of memory");
@@ -956,55 +963,55 @@
 	switch (tif->tif_dir.td_sampleformat)
 	{
 		case SAMPLEFORMAT_IEEEFP:
-			if (tif->tif_dir.td_bitspersample<=32)
+			if (tif->tif_dir.td_bitspersample <= 32)
 			{
 				for (i = 0; i < count; ++i)
 					((float*)conv)[i] = (float)value[i];
-				ok = TIFFWriteDirectoryTagFloatArray(tif,ndir,dir,tag,count,(float*)conv);
+				ok = TIFFWriteDirectoryTagFloatArray(tif, ndir, dir, tag, count, (float*)conv);
 			}
 			else
 			{
-				ok = TIFFWriteDirectoryTagDoubleArray(tif,ndir,dir,tag,count,value);
+				ok = TIFFWriteDirectoryTagDoubleArray(tif, ndir, dir, tag, count, value);
 			}
 			break;
 		case SAMPLEFORMAT_INT:
-			if (tif->tif_dir.td_bitspersample<=8)
+			if (tif->tif_dir.td_bitspersample <= 8)
 			{
 				for (i = 0; i < count; ++i)
 					((int8*)conv)[i] = (int8)value[i];
-				ok = TIFFWriteDirectoryTagSbyteArray(tif,ndir,dir,tag,count,(int8*)conv);
+				ok = TIFFWriteDirectoryTagSbyteArray(tif, ndir, dir, tag, count, (int8*)conv);
 			}
-			else if (tif->tif_dir.td_bitspersample<=16)
+			else if (tif->tif_dir.td_bitspersample <= 16)
 			{
 				for (i = 0; i < count; ++i)
 					((int16*)conv)[i] = (int16)value[i];
-				ok = TIFFWriteDirectoryTagSshortArray(tif,ndir,dir,tag,count,(int16*)conv);
+				ok = TIFFWriteDirectoryTagSshortArray(tif, ndir, dir, tag, count, (int16*)conv);
 			}
 			else
 			{
 				for (i = 0; i < count; ++i)
 					((int32*)conv)[i] = (int32)value[i];
-				ok = TIFFWriteDirectoryTagSlongArray(tif,ndir,dir,tag,count,(int32*)conv);
+				ok = TIFFWriteDirectoryTagSlongArray(tif, ndir, dir, tag, count, (int32*)conv);
 			}
 			break;
 		case SAMPLEFORMAT_UINT:
-			if (tif->tif_dir.td_bitspersample<=8)
+			if (tif->tif_dir.td_bitspersample <= 8)
 			{
 				for (i = 0; i < count; ++i)
 					((uint8*)conv)[i] = (uint8)value[i];
-				ok = TIFFWriteDirectoryTagByteArray(tif,ndir,dir,tag,count,(uint8*)conv);
+				ok = TIFFWriteDirectoryTagByteArray(tif, ndir, dir, tag, count, (uint8*)conv);
 			}
-			else if (tif->tif_dir.td_bitspersample<=16)
+			else if (tif->tif_dir.td_bitspersample <= 16)
 			{
 				for (i = 0; i < count; ++i)
 					((uint16*)conv)[i] = (uint16)value[i];
-				ok = TIFFWriteDirectoryTagShortArray(tif,ndir,dir,tag,count,(uint16*)conv);
+				ok = TIFFWriteDirectoryTagShortArray(tif, ndir, dir, tag, count, (uint16*)conv);
 			}
 			else
 			{
 				for (i = 0; i < count; ++i)
 					((uint32*)conv)[i] = (uint32)value[i];
-				ok = TIFFWriteDirectoryTagLongArray(tif,ndir,dir,tag,count,(uint32*)conv);
+				ok = TIFFWriteDirectoryTagLongArray(tif, ndir, dir, tag, count, (uint32*)conv);
 			}
 			break;
 		default:
@@ -1015,6 +1022,7 @@
 	return (ok);
 }
 
+
 #if 0
 static int
 TIFFWriteDirectoryTagSampleformatPerSample(TIFF* tif, uint32* ndir, TIFFDirEntry* dir, uint16 tag, double value)

2025-02-05 21:10:21.787 | DEBUG    | scenario:rebuild:369 - original environment: environ({'CONDA_SHLVL': '2', 'LC_ALL': 'C.UTF-8', 'LS_COLORS': 'rs=0:di=01;34:ln=01;36:mh=00:pi=40;33:so=01;35:do=01;35:bd=40;33;01:cd=40;33;01:or=40;31;01:mi=00:su=37;41:sg=30;43:ca=30;41:tw=30;42:ow=34;42:st=37;44:ex=01;32:*.tar=01;31:*.tgz=01;31:*.arc=01;31:*.arj=01;31:*.taz=01;31:*.lha=01;31:*.lz4=01;31:*.lzh=01;31:*.lzma=01;31:*.tlz=01;31:*.txz=01;31:*.tzo=01;31:*.t7z=01;31:*.zip=01;31:*.z=01;31:*.Z=01;31:*.dz=01;31:*.gz=01;31:*.lrz=01;31:*.lz=01;31:*.lzo=01;31:*.xz=01;31:*.zst=01;31:*.tzst=01;31:*.bz2=01;31:*.bz=01;31:*.tbz=01;31:*.tbz2=01;31:*.tz=01;31:*.deb=01;31:*.rpm=01;31:*.jar=01;31:*.war=01;31:*.ear=01;31:*.sar=01;31:*.rar=01;31:*.alz=01;31:*.ace=01;31:*.zoo=01;31:*.cpio=01;31:*.7z=01;31:*.rz=01;31:*.cab=01;31:*.wim=01;31:*.swm=01;31:*.dwm=01;31:*.esd=01;31:*.jpg=01;35:*.jpeg=01;35:*.mjpg=01;35:*.mjpeg=01;35:*.gif=01;35:*.bmp=01;35:*.pbm=01;35:*.pgm=01;35:*.ppm=01;35:*.tga=01;35:*.xbm=01;35:*.xpm=01;35:*.tif=01;35:*.tiff=01;35:*.png=01;35:*.svg=01;35:*.svgz=01;35:*.mng=01;35:*.pcx=01;35:*.mov=01;35:*.mpg=01;35:*.mpeg=01;35:*.m2v=01;35:*.mkv=01;35:*.webm=01;35:*.ogm=01;35:*.mp4=01;35:*.m4v=01;35:*.mp4v=01;35:*.vob=01;35:*.qt=01;35:*.nuv=01;35:*.wmv=01;35:*.asf=01;35:*.rm=01;35:*.rmvb=01;35:*.flc=01;35:*.avi=01;35:*.fli=01;35:*.flv=01;35:*.gl=01;35:*.dl=01;35:*.xcf=01;35:*.xwd=01;35:*.yuv=01;35:*.cgm=01;35:*.emf=01;35:*.ogv=01;35:*.ogx=01;35:*.aac=00;36:*.au=00;36:*.flac=00;36:*.m4a=00;36:*.mid=00;36:*.midi=00;36:*.mka=00;36:*.mp3=00;36:*.mpc=00;36:*.ogg=00;36:*.ra=00;36:*.wav=00;36:*.oga=00;36:*.opus=00;36:*.spx=00;36:*.xspf=00;36:', 'LD_LIBRARY_PATH': '/opt/crashrepair/lib:/CrashRepair/lib:/klee/build/lib:', 'CONDA_EXE': '/root/anaconda3/bin/conda', 'LANG': 'C.UTF-8', 'TZ': 'Asia/Shanghai', 'HOSTNAME': 'fea22102047d', 'OLDPWD': '/orchestrator', 'CONDA_PREFIX': '/root/anaconda3/envs/CrashRepair', '_CE_M': '', 'CC': 'crepair-cc', 'LLVM_COMPILER': 'clang', 'CONDA_PREFIX_1': '/root/anaconda3', 'PWD': '/orchestrator/crashrepair', 'HOME': '/root', 'CONDA_PYTHON_EXE': '/root/anaconda3/bin/python', '_CE_CONDA': '', 'CONDA_PROMPT_MODIFIER': '(CrashRepair) ', 'CXX': 'crepair-cxx', 'TERM': 'xterm', 'SHLVL': '2', 'PYTHONPATH': '/usr/lib/python3.8/site-packages:', 'PATH': '/root/anaconda3/envs/CrashRepair/bin:/root/anaconda3/condabin:~/anaconda3/bin:/opt/crashrepair/bin:/CrashRepair/compiler:/klee/build/bin:/opt/llvm-6/bin:/klee/build/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', 'CONDA_DEFAULT_ENV': 'CrashRepair', '_': '/root/anaconda3/envs/CrashRepair/bin/python'})
2025-02-05 21:10:21.787 | DEBUG    | scenario:rebuild:398 - using environment: {'INJECT_CFLAGS': '-g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy ', 'INJECT_CXXFLAGS': '-g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy ', 'INJECT_LDFLAGS': '-g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy '}
2025-02-05 21:10:21.787 | DEBUG    | shell:__call__:41 - executing: make CFLAGS="-fsanitize=float-cast-overflow ${INJECT_CFLAGS}" CXXFLAGS="-fsanitize=float-cast-overflow ${INJECT_CXXFLAGS}" LDFLAGS="${INJECT_LDFLAGS}"
Making all in port
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/port'
make[1]: Nothing to be done for 'all'.
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/port'
Making all in libtiff
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/libtiff'
make  all-am
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/libtiff'
/bin/bash ../libtool  --tag=CC   --mode=compile crepair-cc -DHAVE_CONFIG_H -I.     -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -MT tif_dirwrite.lo -MD -MP -MF .deps/tif_dirwrite.Tpo -c -o tif_dirwrite.lo tif_dirwrite.c
libtool: compile:  crepair-cc -DHAVE_CONFIG_H -I. -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -MT tif_dirwrite.lo -MD -MP -MF .deps/tif_dirwrite.Tpo -c tif_dirwrite.c -o tif_dirwrite.o
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
mv -f .deps/tif_dirwrite.Tpo .deps/tif_dirwrite.Plo
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -no-undefined -version-info 7:5:2   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o libtiff.la -rpath /usr/local/lib tif_aux.lo tif_close.lo tif_codec.lo tif_color.lo tif_compress.lo tif_dir.lo tif_dirinfo.lo tif_dirread.lo tif_dirwrite.lo tif_dumpmode.lo tif_error.lo tif_extension.lo tif_fax3.lo tif_fax3sm.lo tif_flush.lo tif_getimage.lo tif_jbig.lo tif_jpeg.lo tif_jpeg_12.lo tif_luv.lo tif_lzma.lo tif_lzw.lo tif_next.lo tif_ojpeg.lo tif_open.lo tif_packbits.lo tif_pixarlog.lo tif_predict.lo tif_print.lo tif_read.lo tif_strip.lo tif_swab.lo tif_thunder.lo tif_tile.lo tif_version.lo tif_warning.lo tif_write.lo tif_zip.lo  tif_unix.lo ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: rm -fr  .libs/libtiff.a .libs/libtiff.la .libs/libtiff.lai
libtool: link: (cd .libs/libtiff.lax/libport.a && ar x "/data/vulnloc/libtiff/CVE-2017-7600/src/libtiff/../port/.libs/libport.a")
libtool: link: ar cru .libs/libtiff.a  tif_aux.o tif_close.o tif_codec.o tif_color.o tif_compress.o tif_dir.o tif_dirinfo.o tif_dirread.o tif_dirwrite.o tif_dumpmode.o tif_error.o tif_extension.o tif_fax3.o tif_fax3sm.o tif_flush.o tif_getimage.o tif_jbig.o tif_jpeg.o tif_jpeg_12.o tif_luv.o tif_lzma.o tif_lzw.o tif_next.o tif_ojpeg.o tif_open.o tif_packbits.o tif_pixarlog.o tif_predict.o tif_print.o tif_read.o tif_strip.o tif_swab.o tif_thunder.o tif_tile.o tif_version.o tif_warning.o tif_write.o tif_zip.o tif_unix.o  .libs/libtiff.lax/libport.a/dummy.o 
ar: `u' modifier ignored since `D' is the default (see `U')
libtool: link: ranlib .libs/libtiff.a
libtool: link: rm -fr .libs/libtiff.lax
libtool: link: ( cd ".libs" && rm -f "libtiff.la" && ln -s "../libtiff.la" "libtiff.la" )
/bin/bash ../libtool  --tag=CXX   --mode=link crepair-cxx  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -no-undefined -version-info 7:5:2   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o libtiffxx.la -rpath /usr/local/lib tif_stream.lo ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: rm -fr  .libs/libtiffxx.a .libs/libtiffxx.la .libs/libtiffxx.lai
libtool: link: (cd .libs/libtiffxx.lax/libport.a && ar x "/data/vulnloc/libtiff/CVE-2017-7600/src/libtiff/../port/.libs/libport.a")
libtool: link: ar cru .libs/libtiffxx.a  tif_stream.o  .libs/libtiffxx.lax/libport.a/dummy.o 
ar: `u' modifier ignored since `D' is the default (see `U')
libtool: link: ranlib .libs/libtiffxx.a
libtool: link: rm -fr .libs/libtiffxx.lax
libtool: link: ( cd ".libs" && rm -f "libtiffxx.la" && ln -s "../libtiffxx.la" "libtiffxx.la" )
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/libtiff'
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/libtiff'
Making all in tools
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/tools'
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o bmp2tiff bmp2tiff.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o bmp2tiff bmp2tiff.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o fax2ps fax2ps.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o fax2ps fax2ps.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o fax2tiff fax2tiff.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o fax2tiff fax2tiff.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o gif2tiff gif2tiff.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o gif2tiff gif2tiff.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o pal2rgb pal2rgb.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o pal2rgb pal2rgb.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o ppm2tiff ppm2tiff.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o ppm2tiff ppm2tiff.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o ras2tiff ras2tiff.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o ras2tiff ras2tiff.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o raw2tiff raw2tiff.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o raw2tiff raw2tiff.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o rgb2ycbcr rgb2ycbcr.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o rgb2ycbcr rgb2ycbcr.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o thumbnail thumbnail.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o thumbnail thumbnail.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o tiff2bw tiff2bw.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o tiff2bw tiff2bw.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o tiff2pdf tiff2pdf.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o tiff2pdf tiff2pdf.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o tiff2ps tiff2ps.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o tiff2ps tiff2ps.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o tiff2rgba tiff2rgba.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o tiff2rgba tiff2rgba.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o tiffcmp tiffcmp.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o tiffcmp tiffcmp.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o tiffcp tiffcp.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o tiffcp tiffcp.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o tiffcrop tiffcrop.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o tiffcrop tiffcrop.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o tiffdither tiffdither.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o tiffdither tiffdither.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o tiffdump tiffdump.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o tiffdump tiffdump.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o tiffinfo tiffinfo.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o tiffinfo tiffinfo.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o tiffmedian tiffmedian.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o tiffmedian tiffmedian.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o tiffset tiffset.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o tiffset tiffset.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o tiffsplit tiffsplit.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o tiffsplit tiffsplit.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/tools'
Making all in build
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/build'
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/build'
make[2]: Nothing to be done for 'all-am'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/build'
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/build'
Making all in contrib
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib'
Making all in addtiffo
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/addtiffo'
/bin/bash ../../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o addtiffo addtiffo.o tif_overview.o tif_ovrcache.o ../../libtiff/libtiff.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o addtiffo addtiffo.o tif_overview.o tif_ovrcache.o  -L/klee/build/lib -L/CrashRepair/lib ../../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy -llzma -ljbig -ljpeg -lz -lm
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/addtiffo'
Making all in dbs
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/dbs'
Making all in xtiff
make[3]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/dbs/xtiff'
make[3]: Nothing to be done for 'all'.
make[3]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/dbs/xtiff'
make[3]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/dbs'
/bin/bash ../../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o tiff-bi tiff-bi.o ../../libtiff/libtiff.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o tiff-bi tiff-bi.o  -L/klee/build/lib -L/CrashRepair/lib ../../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o tiff-grayscale tiff-grayscale.o ../../libtiff/libtiff.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o tiff-grayscale tiff-grayscale.o  -L/klee/build/lib -L/CrashRepair/lib ../../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o tiff-palette tiff-palette.o ../../libtiff/libtiff.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o tiff-palette tiff-palette.o  -L/klee/build/lib -L/CrashRepair/lib ../../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o tiff-rgb tiff-rgb.o ../../libtiff/libtiff.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o tiff-rgb tiff-rgb.o  -L/klee/build/lib -L/CrashRepair/lib ../../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy -llzma -ljbig -ljpeg -lz -lm
make[3]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/dbs'
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/dbs'
Making all in iptcutil
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/iptcutil'
/bin/bash ../../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o iptcutil iptcutil.o ../../libtiff/libtiff.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o iptcutil iptcutil.o  -L/klee/build/lib -L/CrashRepair/lib ../../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy -llzma -ljbig -ljpeg -lz -lm
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/iptcutil'
Making all in mfs
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/mfs'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/mfs'
Making all in pds
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/pds'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/pds'
Making all in ras
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/ras'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/ras'
Making all in stream
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/stream'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/stream'
Making all in tags
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/tags'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/tags'
Making all in win_dib
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/win_dib'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/win_dib'
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib'
make[2]: Nothing to be done for 'all-am'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib'
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib'
Making all in test
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/test'
make[1]: Nothing to be done for 'all'.
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/test'
Making all in man
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/man'
make[1]: Nothing to be done for 'all'.
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/man'
Making all in html
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/html'
Making all in images
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/html/images'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/html/images'
Making all in man
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/html/man'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/html/man'
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/html'
make[2]: Nothing to be done for 'all-am'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/html'
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/html'
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src'
make[1]: Nothing to be done for 'all-am'.
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src'
2025-02-05 21:10:26.416 | DEBUG    | scenario:evaluate:655 - testing candidate #12 against test #crash...
2025-02-05 21:10:26.417 | DEBUG    | shell:__call__:41 - executing: /data/vulnloc/libtiff/CVE-2017-7600/src/tools/tiffcp -i /CrashRepair/experiments/vulnloc/libtiff/CVE-2017-7600/tests/1.tif out.tiff
2025-02-05 21:10:26.422 | DEBUG    | test:run:172 - test failed: stderr contains bad output substring (runtime error: -115 is outside the range of representable values)
2025-02-05 21:10:26.423 | INFO     | scenario:evaluate:662 - candidate #12 fails test #crash
2025-02-05 21:10:26.432 | INFO     | scenario:evaluate:635 - evaluating candidate patch #13:
@@ -939,6 +939,7 @@
 	return(0);
 }
 
+
 static int
 TIFFWriteDirectoryTagSampleformatArray(TIFF* tif, uint32* ndir, TIFFDirEntry* dir, uint16 tag, uint32 count, double* value)
 {
@@ -953,6 +954,11 @@
 		return (0);
 	}
 
+	if (count == 0) {
+		_TIFFfree(conv);
+		return (1);  // Treat empty input as valid
+	}
+
 	switch (tif->tif_dir.td_sampleformat)
 	{
 		case SAMPLEFORMAT_IEEEFP:
@@ -1015,6 +1021,7 @@
 	return (ok);
 }
 
+
 #if 0
 static int
 TIFFWriteDirectoryTagSampleformatPerSample(TIFF* tif, uint32* ndir, TIFFDirEntry* dir, uint16 tag, double value)

2025-02-05 21:10:26.438 | DEBUG    | scenario:rebuild:369 - original environment: environ({'CONDA_SHLVL': '2', 'LC_ALL': 'C.UTF-8', 'LS_COLORS': 'rs=0:di=01;34:ln=01;36:mh=00:pi=40;33:so=01;35:do=01;35:bd=40;33;01:cd=40;33;01:or=40;31;01:mi=00:su=37;41:sg=30;43:ca=30;41:tw=30;42:ow=34;42:st=37;44:ex=01;32:*.tar=01;31:*.tgz=01;31:*.arc=01;31:*.arj=01;31:*.taz=01;31:*.lha=01;31:*.lz4=01;31:*.lzh=01;31:*.lzma=01;31:*.tlz=01;31:*.txz=01;31:*.tzo=01;31:*.t7z=01;31:*.zip=01;31:*.z=01;31:*.Z=01;31:*.dz=01;31:*.gz=01;31:*.lrz=01;31:*.lz=01;31:*.lzo=01;31:*.xz=01;31:*.zst=01;31:*.tzst=01;31:*.bz2=01;31:*.bz=01;31:*.tbz=01;31:*.tbz2=01;31:*.tz=01;31:*.deb=01;31:*.rpm=01;31:*.jar=01;31:*.war=01;31:*.ear=01;31:*.sar=01;31:*.rar=01;31:*.alz=01;31:*.ace=01;31:*.zoo=01;31:*.cpio=01;31:*.7z=01;31:*.rz=01;31:*.cab=01;31:*.wim=01;31:*.swm=01;31:*.dwm=01;31:*.esd=01;31:*.jpg=01;35:*.jpeg=01;35:*.mjpg=01;35:*.mjpeg=01;35:*.gif=01;35:*.bmp=01;35:*.pbm=01;35:*.pgm=01;35:*.ppm=01;35:*.tga=01;35:*.xbm=01;35:*.xpm=01;35:*.tif=01;35:*.tiff=01;35:*.png=01;35:*.svg=01;35:*.svgz=01;35:*.mng=01;35:*.pcx=01;35:*.mov=01;35:*.mpg=01;35:*.mpeg=01;35:*.m2v=01;35:*.mkv=01;35:*.webm=01;35:*.ogm=01;35:*.mp4=01;35:*.m4v=01;35:*.mp4v=01;35:*.vob=01;35:*.qt=01;35:*.nuv=01;35:*.wmv=01;35:*.asf=01;35:*.rm=01;35:*.rmvb=01;35:*.flc=01;35:*.avi=01;35:*.fli=01;35:*.flv=01;35:*.gl=01;35:*.dl=01;35:*.xcf=01;35:*.xwd=01;35:*.yuv=01;35:*.cgm=01;35:*.emf=01;35:*.ogv=01;35:*.ogx=01;35:*.aac=00;36:*.au=00;36:*.flac=00;36:*.m4a=00;36:*.mid=00;36:*.midi=00;36:*.mka=00;36:*.mp3=00;36:*.mpc=00;36:*.ogg=00;36:*.ra=00;36:*.wav=00;36:*.oga=00;36:*.opus=00;36:*.spx=00;36:*.xspf=00;36:', 'LD_LIBRARY_PATH': '/opt/crashrepair/lib:/CrashRepair/lib:/klee/build/lib:', 'CONDA_EXE': '/root/anaconda3/bin/conda', 'LANG': 'C.UTF-8', 'TZ': 'Asia/Shanghai', 'HOSTNAME': 'fea22102047d', 'OLDPWD': '/orchestrator', 'CONDA_PREFIX': '/root/anaconda3/envs/CrashRepair', '_CE_M': '', 'CC': 'crepair-cc', 'LLVM_COMPILER': 'clang', 'CONDA_PREFIX_1': '/root/anaconda3', 'PWD': '/orchestrator/crashrepair', 'HOME': '/root', 'CONDA_PYTHON_EXE': '/root/anaconda3/bin/python', '_CE_CONDA': '', 'CONDA_PROMPT_MODIFIER': '(CrashRepair) ', 'CXX': 'crepair-cxx', 'TERM': 'xterm', 'SHLVL': '2', 'PYTHONPATH': '/usr/lib/python3.8/site-packages:', 'PATH': '/root/anaconda3/envs/CrashRepair/bin:/root/anaconda3/condabin:~/anaconda3/bin:/opt/crashrepair/bin:/CrashRepair/compiler:/klee/build/bin:/opt/llvm-6/bin:/klee/build/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', 'CONDA_DEFAULT_ENV': 'CrashRepair', '_': '/root/anaconda3/envs/CrashRepair/bin/python'})
2025-02-05 21:10:26.438 | DEBUG    | scenario:rebuild:398 - using environment: {'INJECT_CFLAGS': '-g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy ', 'INJECT_CXXFLAGS': '-g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy ', 'INJECT_LDFLAGS': '-g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy '}
2025-02-05 21:10:26.438 | DEBUG    | shell:__call__:41 - executing: make CFLAGS="-fsanitize=float-cast-overflow ${INJECT_CFLAGS}" CXXFLAGS="-fsanitize=float-cast-overflow ${INJECT_CXXFLAGS}" LDFLAGS="${INJECT_LDFLAGS}"
Making all in port
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/port'
make[1]: Nothing to be done for 'all'.
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/port'
Making all in libtiff
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/libtiff'
make  all-am
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/libtiff'
/bin/bash ../libtool  --tag=CC   --mode=compile crepair-cc -DHAVE_CONFIG_H -I.     -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -MT tif_dirwrite.lo -MD -MP -MF .deps/tif_dirwrite.Tpo -c -o tif_dirwrite.lo tif_dirwrite.c
libtool: compile:  crepair-cc -DHAVE_CONFIG_H -I. -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -MT tif_dirwrite.lo -MD -MP -MF .deps/tif_dirwrite.Tpo -c tif_dirwrite.c -o tif_dirwrite.o
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
mv -f .deps/tif_dirwrite.Tpo .deps/tif_dirwrite.Plo
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -no-undefined -version-info 7:5:2   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o libtiff.la -rpath /usr/local/lib tif_aux.lo tif_close.lo tif_codec.lo tif_color.lo tif_compress.lo tif_dir.lo tif_dirinfo.lo tif_dirread.lo tif_dirwrite.lo tif_dumpmode.lo tif_error.lo tif_extension.lo tif_fax3.lo tif_fax3sm.lo tif_flush.lo tif_getimage.lo tif_jbig.lo tif_jpeg.lo tif_jpeg_12.lo tif_luv.lo tif_lzma.lo tif_lzw.lo tif_next.lo tif_ojpeg.lo tif_open.lo tif_packbits.lo tif_pixarlog.lo tif_predict.lo tif_print.lo tif_read.lo tif_strip.lo tif_swab.lo tif_thunder.lo tif_tile.lo tif_version.lo tif_warning.lo tif_write.lo tif_zip.lo  tif_unix.lo ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: rm -fr  .libs/libtiff.a .libs/libtiff.la .libs/libtiff.lai
libtool: link: (cd .libs/libtiff.lax/libport.a && ar x "/data/vulnloc/libtiff/CVE-2017-7600/src/libtiff/../port/.libs/libport.a")
libtool: link: ar cru .libs/libtiff.a  tif_aux.o tif_close.o tif_codec.o tif_color.o tif_compress.o tif_dir.o tif_dirinfo.o tif_dirread.o tif_dirwrite.o tif_dumpmode.o tif_error.o tif_extension.o tif_fax3.o tif_fax3sm.o tif_flush.o tif_getimage.o tif_jbig.o tif_jpeg.o tif_jpeg_12.o tif_luv.o tif_lzma.o tif_lzw.o tif_next.o tif_ojpeg.o tif_open.o tif_packbits.o tif_pixarlog.o tif_predict.o tif_print.o tif_read.o tif_strip.o tif_swab.o tif_thunder.o tif_tile.o tif_version.o tif_warning.o tif_write.o tif_zip.o tif_unix.o  .libs/libtiff.lax/libport.a/dummy.o 
ar: `u' modifier ignored since `D' is the default (see `U')
libtool: link: ranlib .libs/libtiff.a
libtool: link: rm -fr .libs/libtiff.lax
libtool: link: ( cd ".libs" && rm -f "libtiff.la" && ln -s "../libtiff.la" "libtiff.la" )
/bin/bash ../libtool  --tag=CXX   --mode=link crepair-cxx  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -no-undefined -version-info 7:5:2   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o libtiffxx.la -rpath /usr/local/lib tif_stream.lo ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: rm -fr  .libs/libtiffxx.a .libs/libtiffxx.la .libs/libtiffxx.lai
libtool: link: (cd .libs/libtiffxx.lax/libport.a && ar x "/data/vulnloc/libtiff/CVE-2017-7600/src/libtiff/../port/.libs/libport.a")
libtool: link: ar cru .libs/libtiffxx.a  tif_stream.o  .libs/libtiffxx.lax/libport.a/dummy.o 
ar: `u' modifier ignored since `D' is the default (see `U')
libtool: link: ranlib .libs/libtiffxx.a
libtool: link: rm -fr .libs/libtiffxx.lax
libtool: link: ( cd ".libs" && rm -f "libtiffxx.la" && ln -s "../libtiffxx.la" "libtiffxx.la" )
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/libtiff'
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/libtiff'
Making all in tools
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/tools'
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o bmp2tiff bmp2tiff.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o bmp2tiff bmp2tiff.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o fax2ps fax2ps.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o fax2ps fax2ps.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o fax2tiff fax2tiff.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o fax2tiff fax2tiff.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o gif2tiff gif2tiff.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o gif2tiff gif2tiff.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o pal2rgb pal2rgb.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o pal2rgb pal2rgb.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o ppm2tiff ppm2tiff.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o ppm2tiff ppm2tiff.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o ras2tiff ras2tiff.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o ras2tiff ras2tiff.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o raw2tiff raw2tiff.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o raw2tiff raw2tiff.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o rgb2ycbcr rgb2ycbcr.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o rgb2ycbcr rgb2ycbcr.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o thumbnail thumbnail.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o thumbnail thumbnail.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o tiff2bw tiff2bw.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o tiff2bw tiff2bw.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o tiff2pdf tiff2pdf.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o tiff2pdf tiff2pdf.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o tiff2ps tiff2ps.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o tiff2ps tiff2ps.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o tiff2rgba tiff2rgba.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o tiff2rgba tiff2rgba.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o tiffcmp tiffcmp.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o tiffcmp tiffcmp.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o tiffcp tiffcp.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o tiffcp tiffcp.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o tiffcrop tiffcrop.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o tiffcrop tiffcrop.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o tiffdither tiffdither.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o tiffdither tiffdither.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o tiffdump tiffdump.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o tiffdump tiffdump.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o tiffinfo tiffinfo.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o tiffinfo tiffinfo.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o tiffmedian tiffmedian.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o tiffmedian tiffmedian.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o tiffset tiffset.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o tiffset tiffset.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o tiffsplit tiffsplit.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o tiffsplit tiffsplit.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/tools'
Making all in build
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/build'
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/build'
make[2]: Nothing to be done for 'all-am'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/build'
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/build'
Making all in contrib
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib'
Making all in addtiffo
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/addtiffo'
/bin/bash ../../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o addtiffo addtiffo.o tif_overview.o tif_ovrcache.o ../../libtiff/libtiff.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o addtiffo addtiffo.o tif_overview.o tif_ovrcache.o  -L/klee/build/lib -L/CrashRepair/lib ../../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy -llzma -ljbig -ljpeg -lz -lm
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/addtiffo'
Making all in dbs
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/dbs'
Making all in xtiff
make[3]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/dbs/xtiff'
make[3]: Nothing to be done for 'all'.
make[3]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/dbs/xtiff'
make[3]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/dbs'
/bin/bash ../../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o tiff-bi tiff-bi.o ../../libtiff/libtiff.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o tiff-bi tiff-bi.o  -L/klee/build/lib -L/CrashRepair/lib ../../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o tiff-grayscale tiff-grayscale.o ../../libtiff/libtiff.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o tiff-grayscale tiff-grayscale.o  -L/klee/build/lib -L/CrashRepair/lib ../../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o tiff-palette tiff-palette.o ../../libtiff/libtiff.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o tiff-palette tiff-palette.o  -L/klee/build/lib -L/CrashRepair/lib ../../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o tiff-rgb tiff-rgb.o ../../libtiff/libtiff.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o tiff-rgb tiff-rgb.o  -L/klee/build/lib -L/CrashRepair/lib ../../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy -llzma -ljbig -ljpeg -lz -lm
make[3]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/dbs'
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/dbs'
Making all in iptcutil
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/iptcutil'
/bin/bash ../../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o iptcutil iptcutil.o ../../libtiff/libtiff.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o iptcutil iptcutil.o  -L/klee/build/lib -L/CrashRepair/lib ../../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy -llzma -ljbig -ljpeg -lz -lm
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/iptcutil'
Making all in mfs
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/mfs'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/mfs'
Making all in pds
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/pds'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/pds'
Making all in ras
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/ras'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/ras'
Making all in stream
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/stream'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/stream'
Making all in tags
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/tags'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/tags'
Making all in win_dib
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/win_dib'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/win_dib'
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib'
make[2]: Nothing to be done for 'all-am'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib'
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib'
Making all in test
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/test'
make[1]: Nothing to be done for 'all'.
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/test'
Making all in man
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/man'
make[1]: Nothing to be done for 'all'.
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/man'
Making all in html
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/html'
Making all in images
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/html/images'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/html/images'
Making all in man
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/html/man'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/html/man'
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/html'
make[2]: Nothing to be done for 'all-am'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/html'
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/html'
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src'
make[1]: Nothing to be done for 'all-am'.
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src'
2025-02-05 21:10:31.038 | DEBUG    | scenario:evaluate:655 - testing candidate #13 against test #crash...
2025-02-05 21:10:31.038 | DEBUG    | shell:__call__:41 - executing: /data/vulnloc/libtiff/CVE-2017-7600/src/tools/tiffcp -i /CrashRepair/experiments/vulnloc/libtiff/CVE-2017-7600/tests/1.tif out.tiff
2025-02-05 21:10:31.043 | DEBUG    | test:run:172 - test failed: stderr contains bad output substring (runtime error: -115 is outside the range of representable values)
2025-02-05 21:10:31.043 | INFO     | scenario:evaluate:662 - candidate #13 fails test #crash
2025-02-05 21:10:31.048 | INFO     | scenario:evaluate:635 - evaluating candidate patch #14:
@@ -939,6 +939,7 @@
 	return(0);
 }
 
+
 static int
 TIFFWriteDirectoryTagSampleformatArray(TIFF* tif, uint32* ndir, TIFFDirEntry* dir, uint16 tag, uint32 count, double* value)
 {
@@ -946,6 +947,10 @@
 	void* conv;
 	uint32 i;
 	int ok;
+	if (count == 0) // New check to handle zero count
+	{
+		return 1; // Early return if count is zero
+	}
 	conv = _TIFFmalloc(count*sizeof(double));
 	if (conv == NULL)
 	{
@@ -1015,6 +1020,7 @@
 	return (ok);
 }
 
+
 #if 0
 static int
 TIFFWriteDirectoryTagSampleformatPerSample(TIFF* tif, uint32* ndir, TIFFDirEntry* dir, uint16 tag, double value)

2025-02-05 21:10:31.054 | DEBUG    | scenario:rebuild:369 - original environment: environ({'CONDA_SHLVL': '2', 'LC_ALL': 'C.UTF-8', 'LS_COLORS': 'rs=0:di=01;34:ln=01;36:mh=00:pi=40;33:so=01;35:do=01;35:bd=40;33;01:cd=40;33;01:or=40;31;01:mi=00:su=37;41:sg=30;43:ca=30;41:tw=30;42:ow=34;42:st=37;44:ex=01;32:*.tar=01;31:*.tgz=01;31:*.arc=01;31:*.arj=01;31:*.taz=01;31:*.lha=01;31:*.lz4=01;31:*.lzh=01;31:*.lzma=01;31:*.tlz=01;31:*.txz=01;31:*.tzo=01;31:*.t7z=01;31:*.zip=01;31:*.z=01;31:*.Z=01;31:*.dz=01;31:*.gz=01;31:*.lrz=01;31:*.lz=01;31:*.lzo=01;31:*.xz=01;31:*.zst=01;31:*.tzst=01;31:*.bz2=01;31:*.bz=01;31:*.tbz=01;31:*.tbz2=01;31:*.tz=01;31:*.deb=01;31:*.rpm=01;31:*.jar=01;31:*.war=01;31:*.ear=01;31:*.sar=01;31:*.rar=01;31:*.alz=01;31:*.ace=01;31:*.zoo=01;31:*.cpio=01;31:*.7z=01;31:*.rz=01;31:*.cab=01;31:*.wim=01;31:*.swm=01;31:*.dwm=01;31:*.esd=01;31:*.jpg=01;35:*.jpeg=01;35:*.mjpg=01;35:*.mjpeg=01;35:*.gif=01;35:*.bmp=01;35:*.pbm=01;35:*.pgm=01;35:*.ppm=01;35:*.tga=01;35:*.xbm=01;35:*.xpm=01;35:*.tif=01;35:*.tiff=01;35:*.png=01;35:*.svg=01;35:*.svgz=01;35:*.mng=01;35:*.pcx=01;35:*.mov=01;35:*.mpg=01;35:*.mpeg=01;35:*.m2v=01;35:*.mkv=01;35:*.webm=01;35:*.ogm=01;35:*.mp4=01;35:*.m4v=01;35:*.mp4v=01;35:*.vob=01;35:*.qt=01;35:*.nuv=01;35:*.wmv=01;35:*.asf=01;35:*.rm=01;35:*.rmvb=01;35:*.flc=01;35:*.avi=01;35:*.fli=01;35:*.flv=01;35:*.gl=01;35:*.dl=01;35:*.xcf=01;35:*.xwd=01;35:*.yuv=01;35:*.cgm=01;35:*.emf=01;35:*.ogv=01;35:*.ogx=01;35:*.aac=00;36:*.au=00;36:*.flac=00;36:*.m4a=00;36:*.mid=00;36:*.midi=00;36:*.mka=00;36:*.mp3=00;36:*.mpc=00;36:*.ogg=00;36:*.ra=00;36:*.wav=00;36:*.oga=00;36:*.opus=00;36:*.spx=00;36:*.xspf=00;36:', 'LD_LIBRARY_PATH': '/opt/crashrepair/lib:/CrashRepair/lib:/klee/build/lib:', 'CONDA_EXE': '/root/anaconda3/bin/conda', 'LANG': 'C.UTF-8', 'TZ': 'Asia/Shanghai', 'HOSTNAME': 'fea22102047d', 'OLDPWD': '/orchestrator', 'CONDA_PREFIX': '/root/anaconda3/envs/CrashRepair', '_CE_M': '', 'CC': 'crepair-cc', 'LLVM_COMPILER': 'clang', 'CONDA_PREFIX_1': '/root/anaconda3', 'PWD': '/orchestrator/crashrepair', 'HOME': '/root', 'CONDA_PYTHON_EXE': '/root/anaconda3/bin/python', '_CE_CONDA': '', 'CONDA_PROMPT_MODIFIER': '(CrashRepair) ', 'CXX': 'crepair-cxx', 'TERM': 'xterm', 'SHLVL': '2', 'PYTHONPATH': '/usr/lib/python3.8/site-packages:', 'PATH': '/root/anaconda3/envs/CrashRepair/bin:/root/anaconda3/condabin:~/anaconda3/bin:/opt/crashrepair/bin:/CrashRepair/compiler:/klee/build/bin:/opt/llvm-6/bin:/klee/build/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', 'CONDA_DEFAULT_ENV': 'CrashRepair', '_': '/root/anaconda3/envs/CrashRepair/bin/python'})
2025-02-05 21:10:31.054 | DEBUG    | scenario:rebuild:398 - using environment: {'INJECT_CFLAGS': '-g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy ', 'INJECT_CXXFLAGS': '-g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy ', 'INJECT_LDFLAGS': '-g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy '}
2025-02-05 21:10:31.054 | DEBUG    | shell:__call__:41 - executing: make CFLAGS="-fsanitize=float-cast-overflow ${INJECT_CFLAGS}" CXXFLAGS="-fsanitize=float-cast-overflow ${INJECT_CXXFLAGS}" LDFLAGS="${INJECT_LDFLAGS}"
Making all in port
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/port'
make[1]: Nothing to be done for 'all'.
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/port'
Making all in libtiff
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/libtiff'
make  all-am
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/libtiff'
/bin/bash ../libtool  --tag=CC   --mode=compile crepair-cc -DHAVE_CONFIG_H -I.     -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -MT tif_dirwrite.lo -MD -MP -MF .deps/tif_dirwrite.Tpo -c -o tif_dirwrite.lo tif_dirwrite.c
libtool: compile:  crepair-cc -DHAVE_CONFIG_H -I. -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -MT tif_dirwrite.lo -MD -MP -MF .deps/tif_dirwrite.Tpo -c tif_dirwrite.c -o tif_dirwrite.o
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
mv -f .deps/tif_dirwrite.Tpo .deps/tif_dirwrite.Plo
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -no-undefined -version-info 7:5:2   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o libtiff.la -rpath /usr/local/lib tif_aux.lo tif_close.lo tif_codec.lo tif_color.lo tif_compress.lo tif_dir.lo tif_dirinfo.lo tif_dirread.lo tif_dirwrite.lo tif_dumpmode.lo tif_error.lo tif_extension.lo tif_fax3.lo tif_fax3sm.lo tif_flush.lo tif_getimage.lo tif_jbig.lo tif_jpeg.lo tif_jpeg_12.lo tif_luv.lo tif_lzma.lo tif_lzw.lo tif_next.lo tif_ojpeg.lo tif_open.lo tif_packbits.lo tif_pixarlog.lo tif_predict.lo tif_print.lo tif_read.lo tif_strip.lo tif_swab.lo tif_thunder.lo tif_tile.lo tif_version.lo tif_warning.lo tif_write.lo tif_zip.lo  tif_unix.lo ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: rm -fr  .libs/libtiff.a .libs/libtiff.la .libs/libtiff.lai
libtool: link: (cd .libs/libtiff.lax/libport.a && ar x "/data/vulnloc/libtiff/CVE-2017-7600/src/libtiff/../port/.libs/libport.a")
libtool: link: ar cru .libs/libtiff.a  tif_aux.o tif_close.o tif_codec.o tif_color.o tif_compress.o tif_dir.o tif_dirinfo.o tif_dirread.o tif_dirwrite.o tif_dumpmode.o tif_error.o tif_extension.o tif_fax3.o tif_fax3sm.o tif_flush.o tif_getimage.o tif_jbig.o tif_jpeg.o tif_jpeg_12.o tif_luv.o tif_lzma.o tif_lzw.o tif_next.o tif_ojpeg.o tif_open.o tif_packbits.o tif_pixarlog.o tif_predict.o tif_print.o tif_read.o tif_strip.o tif_swab.o tif_thunder.o tif_tile.o tif_version.o tif_warning.o tif_write.o tif_zip.o tif_unix.o  .libs/libtiff.lax/libport.a/dummy.o 
ar: `u' modifier ignored since `D' is the default (see `U')
libtool: link: ranlib .libs/libtiff.a
libtool: link: rm -fr .libs/libtiff.lax
libtool: link: ( cd ".libs" && rm -f "libtiff.la" && ln -s "../libtiff.la" "libtiff.la" )
/bin/bash ../libtool  --tag=CXX   --mode=link crepair-cxx  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -no-undefined -version-info 7:5:2   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o libtiffxx.la -rpath /usr/local/lib tif_stream.lo ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: rm -fr  .libs/libtiffxx.a .libs/libtiffxx.la .libs/libtiffxx.lai
libtool: link: (cd .libs/libtiffxx.lax/libport.a && ar x "/data/vulnloc/libtiff/CVE-2017-7600/src/libtiff/../port/.libs/libport.a")
libtool: link: ar cru .libs/libtiffxx.a  tif_stream.o  .libs/libtiffxx.lax/libport.a/dummy.o 
ar: `u' modifier ignored since `D' is the default (see `U')
libtool: link: ranlib .libs/libtiffxx.a
libtool: link: rm -fr .libs/libtiffxx.lax
libtool: link: ( cd ".libs" && rm -f "libtiffxx.la" && ln -s "../libtiffxx.la" "libtiffxx.la" )
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/libtiff'
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/libtiff'
Making all in tools
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/tools'
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o bmp2tiff bmp2tiff.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o bmp2tiff bmp2tiff.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o fax2ps fax2ps.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o fax2ps fax2ps.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o fax2tiff fax2tiff.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o fax2tiff fax2tiff.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o gif2tiff gif2tiff.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o gif2tiff gif2tiff.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o pal2rgb pal2rgb.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o pal2rgb pal2rgb.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o ppm2tiff ppm2tiff.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o ppm2tiff ppm2tiff.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o ras2tiff ras2tiff.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o ras2tiff ras2tiff.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o raw2tiff raw2tiff.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o raw2tiff raw2tiff.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o rgb2ycbcr rgb2ycbcr.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o rgb2ycbcr rgb2ycbcr.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o thumbnail thumbnail.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o thumbnail thumbnail.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o tiff2bw tiff2bw.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o tiff2bw tiff2bw.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o tiff2pdf tiff2pdf.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o tiff2pdf tiff2pdf.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o tiff2ps tiff2ps.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o tiff2ps tiff2ps.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o tiff2rgba tiff2rgba.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o tiff2rgba tiff2rgba.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o tiffcmp tiffcmp.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o tiffcmp tiffcmp.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o tiffcp tiffcp.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o tiffcp tiffcp.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o tiffcrop tiffcrop.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o tiffcrop tiffcrop.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o tiffdither tiffdither.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o tiffdither tiffdither.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o tiffdump tiffdump.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o tiffdump tiffdump.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o tiffinfo tiffinfo.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o tiffinfo tiffinfo.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o tiffmedian tiffmedian.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o tiffmedian tiffmedian.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o tiffset tiffset.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o tiffset tiffset.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o tiffsplit tiffsplit.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o tiffsplit tiffsplit.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/tools'
Making all in build
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/build'
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/build'
make[2]: Nothing to be done for 'all-am'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/build'
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/build'
Making all in contrib
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib'
Making all in addtiffo
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/addtiffo'
/bin/bash ../../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o addtiffo addtiffo.o tif_overview.o tif_ovrcache.o ../../libtiff/libtiff.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o addtiffo addtiffo.o tif_overview.o tif_ovrcache.o  -L/klee/build/lib -L/CrashRepair/lib ../../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy -llzma -ljbig -ljpeg -lz -lm
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/addtiffo'
Making all in dbs
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/dbs'
Making all in xtiff
make[3]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/dbs/xtiff'
make[3]: Nothing to be done for 'all'.
make[3]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/dbs/xtiff'
make[3]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/dbs'
/bin/bash ../../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o tiff-bi tiff-bi.o ../../libtiff/libtiff.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o tiff-bi tiff-bi.o  -L/klee/build/lib -L/CrashRepair/lib ../../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o tiff-grayscale tiff-grayscale.o ../../libtiff/libtiff.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o tiff-grayscale tiff-grayscale.o  -L/klee/build/lib -L/CrashRepair/lib ../../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o tiff-palette tiff-palette.o ../../libtiff/libtiff.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o tiff-palette tiff-palette.o  -L/klee/build/lib -L/CrashRepair/lib ../../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o tiff-rgb tiff-rgb.o ../../libtiff/libtiff.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o tiff-rgb tiff-rgb.o  -L/klee/build/lib -L/CrashRepair/lib ../../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy -llzma -ljbig -ljpeg -lz -lm
make[3]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/dbs'
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/dbs'
Making all in iptcutil
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/iptcutil'
/bin/bash ../../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o iptcutil iptcutil.o ../../libtiff/libtiff.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o iptcutil iptcutil.o  -L/klee/build/lib -L/CrashRepair/lib ../../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy -llzma -ljbig -ljpeg -lz -lm
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/iptcutil'
Making all in mfs
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/mfs'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/mfs'
Making all in pds
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/pds'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/pds'
Making all in ras
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/ras'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/ras'
Making all in stream
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/stream'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/stream'
Making all in tags
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/tags'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/tags'
Making all in win_dib
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/win_dib'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/win_dib'
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib'
make[2]: Nothing to be done for 'all-am'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib'
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib'
Making all in test
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/test'
make[1]: Nothing to be done for 'all'.
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/test'
Making all in man
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/man'
make[1]: Nothing to be done for 'all'.
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/man'
Making all in html
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/html'
Making all in images
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/html/images'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/html/images'
Making all in man
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/html/man'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/html/man'
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/html'
make[2]: Nothing to be done for 'all-am'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/html'
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/html'
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src'
make[1]: Nothing to be done for 'all-am'.
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src'
2025-02-05 21:10:38.014 | DEBUG    | scenario:evaluate:655 - testing candidate #14 against test #crash...
2025-02-05 21:10:38.014 | DEBUG    | shell:__call__:41 - executing: /data/vulnloc/libtiff/CVE-2017-7600/src/tools/tiffcp -i /CrashRepair/experiments/vulnloc/libtiff/CVE-2017-7600/tests/1.tif out.tiff
2025-02-05 21:10:38.019 | DEBUG    | test:run:172 - test failed: stderr contains bad output substring (runtime error: -115 is outside the range of representable values)
2025-02-05 21:10:38.019 | INFO     | scenario:evaluate:662 - candidate #14 fails test #crash
2025-02-05 21:10:38.023 | INFO     | scenario:evaluate:635 - evaluating candidate patch #15:
@@ -939,6 +939,7 @@
 	return(0);
 }
 
+
 static int
 TIFFWriteDirectoryTagSampleformatArray(TIFF* tif, uint32* ndir, TIFFDirEntry* dir, uint16 tag, uint32 count, double* value)
 {
@@ -958,8 +959,10 @@
 		case SAMPLEFORMAT_IEEEFP:
 			if (tif->tif_dir.td_bitspersample<=32)
 			{
-				for (i = 0; i < count; ++i)
-					((float*)conv)[i] = (float)value[i];
+				if (count > 0) {
+					for (i = 0; i < count; ++i)
+						((float*)conv)[i] = (float)value[i];
+				}
 				ok = TIFFWriteDirectoryTagFloatArray(tif,ndir,dir,tag,count,(float*)conv);
 			}
 			else
@@ -970,40 +973,52 @@
 		case SAMPLEFORMAT_INT:
 			if (tif->tif_dir.td_bitspersample<=8)
 			{
-				for (i = 0; i < count; ++i)
-					((int8*)conv)[i] = (int8)value[i];
+				if (count > 0) {
+					for (i = 0; i < count; ++i)
+						((int8*)conv)[i] = (int8)value[i];
+				}
 				ok = TIFFWriteDirectoryTagSbyteArray(tif,ndir,dir,tag,count,(int8*)conv);
 			}
 			else if (tif->tif_dir.td_bitspersample<=16)
 			{
-				for (i = 0; i < count; ++i)
-					((int16*)conv)[i] = (int16)value[i];
+				if (count > 0) {
+					for (i = 0; i < count; ++i)
+						((int16*)conv)[i] = (int16)value[i];
+				}
 				ok = TIFFWriteDirectoryTagSshortArray(tif,ndir,dir,tag,count,(int16*)conv);
 			}
 			else
 			{
-				for (i = 0; i < count; ++i)
-					((int32*)conv)[i] = (int32)value[i];
+				if (count > 0) {
+					for (i = 0; i < count; ++i)
+						((int32*)conv)[i] = (int32)value[i];
+				}
 				ok = TIFFWriteDirectoryTagSlongArray(tif,ndir,dir,tag,count,(int32*)conv);
 			}
 			break;
 		case SAMPLEFORMAT_UINT:
 			if (tif->tif_dir.td_bitspersample<=8)
 			{
-				for (i = 0; i < count; ++i)
-					((uint8*)conv)[i] = (uint8)value[i];
+				if (count > 0) {
+					for (i = 0; i < count; ++i)
+						((uint8*)conv)[i] = (uint8)value[i];
+				}
 				ok = TIFFWriteDirectoryTagByteArray(tif,ndir,dir,tag,count,(uint8*)conv);
 			}
 			else if (tif->tif_dir.td_bitspersample<=16)
 			{
-				for (i = 0; i < count; ++i)
-					((uint16*)conv)[i] = (uint16)value[i];
+				if (count > 0) {
+					for (i = 0; i < count; ++i)
+						((uint16*)conv)[i] = (uint16)value[i];
+				}
 				ok = TIFFWriteDirectoryTagShortArray(tif,ndir,dir,tag,count,(uint16*)conv);
 			}
 			else
 			{
-				for (i = 0; i < count; ++i)
-					((uint32*)conv)[i] = (uint32)value[i];
+				if (count > 0) {
+					for (i = 0; i < count; ++i)
+						((uint32*)conv)[i] = (uint32)value[i];
+				}
 				ok = TIFFWriteDirectoryTagLongArray(tif,ndir,dir,tag,count,(uint32*)conv);
 			}
 			break;
@@ -1015,6 +1030,7 @@
 	return (ok);
 }
 
+
 #if 0
 static int
 TIFFWriteDirectoryTagSampleformatPerSample(TIFF* tif, uint32* ndir, TIFFDirEntry* dir, uint16 tag, double value)

2025-02-05 21:10:38.028 | DEBUG    | scenario:rebuild:369 - original environment: environ({'CONDA_SHLVL': '2', 'LC_ALL': 'C.UTF-8', 'LS_COLORS': 'rs=0:di=01;34:ln=01;36:mh=00:pi=40;33:so=01;35:do=01;35:bd=40;33;01:cd=40;33;01:or=40;31;01:mi=00:su=37;41:sg=30;43:ca=30;41:tw=30;42:ow=34;42:st=37;44:ex=01;32:*.tar=01;31:*.tgz=01;31:*.arc=01;31:*.arj=01;31:*.taz=01;31:*.lha=01;31:*.lz4=01;31:*.lzh=01;31:*.lzma=01;31:*.tlz=01;31:*.txz=01;31:*.tzo=01;31:*.t7z=01;31:*.zip=01;31:*.z=01;31:*.Z=01;31:*.dz=01;31:*.gz=01;31:*.lrz=01;31:*.lz=01;31:*.lzo=01;31:*.xz=01;31:*.zst=01;31:*.tzst=01;31:*.bz2=01;31:*.bz=01;31:*.tbz=01;31:*.tbz2=01;31:*.tz=01;31:*.deb=01;31:*.rpm=01;31:*.jar=01;31:*.war=01;31:*.ear=01;31:*.sar=01;31:*.rar=01;31:*.alz=01;31:*.ace=01;31:*.zoo=01;31:*.cpio=01;31:*.7z=01;31:*.rz=01;31:*.cab=01;31:*.wim=01;31:*.swm=01;31:*.dwm=01;31:*.esd=01;31:*.jpg=01;35:*.jpeg=01;35:*.mjpg=01;35:*.mjpeg=01;35:*.gif=01;35:*.bmp=01;35:*.pbm=01;35:*.pgm=01;35:*.ppm=01;35:*.tga=01;35:*.xbm=01;35:*.xpm=01;35:*.tif=01;35:*.tiff=01;35:*.png=01;35:*.svg=01;35:*.svgz=01;35:*.mng=01;35:*.pcx=01;35:*.mov=01;35:*.mpg=01;35:*.mpeg=01;35:*.m2v=01;35:*.mkv=01;35:*.webm=01;35:*.ogm=01;35:*.mp4=01;35:*.m4v=01;35:*.mp4v=01;35:*.vob=01;35:*.qt=01;35:*.nuv=01;35:*.wmv=01;35:*.asf=01;35:*.rm=01;35:*.rmvb=01;35:*.flc=01;35:*.avi=01;35:*.fli=01;35:*.flv=01;35:*.gl=01;35:*.dl=01;35:*.xcf=01;35:*.xwd=01;35:*.yuv=01;35:*.cgm=01;35:*.emf=01;35:*.ogv=01;35:*.ogx=01;35:*.aac=00;36:*.au=00;36:*.flac=00;36:*.m4a=00;36:*.mid=00;36:*.midi=00;36:*.mka=00;36:*.mp3=00;36:*.mpc=00;36:*.ogg=00;36:*.ra=00;36:*.wav=00;36:*.oga=00;36:*.opus=00;36:*.spx=00;36:*.xspf=00;36:', 'LD_LIBRARY_PATH': '/opt/crashrepair/lib:/CrashRepair/lib:/klee/build/lib:', 'CONDA_EXE': '/root/anaconda3/bin/conda', 'LANG': 'C.UTF-8', 'TZ': 'Asia/Shanghai', 'HOSTNAME': 'fea22102047d', 'OLDPWD': '/orchestrator', 'CONDA_PREFIX': '/root/anaconda3/envs/CrashRepair', '_CE_M': '', 'CC': 'crepair-cc', 'LLVM_COMPILER': 'clang', 'CONDA_PREFIX_1': '/root/anaconda3', 'PWD': '/orchestrator/crashrepair', 'HOME': '/root', 'CONDA_PYTHON_EXE': '/root/anaconda3/bin/python', '_CE_CONDA': '', 'CONDA_PROMPT_MODIFIER': '(CrashRepair) ', 'CXX': 'crepair-cxx', 'TERM': 'xterm', 'SHLVL': '2', 'PYTHONPATH': '/usr/lib/python3.8/site-packages:', 'PATH': '/root/anaconda3/envs/CrashRepair/bin:/root/anaconda3/condabin:~/anaconda3/bin:/opt/crashrepair/bin:/CrashRepair/compiler:/klee/build/bin:/opt/llvm-6/bin:/klee/build/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', 'CONDA_DEFAULT_ENV': 'CrashRepair', '_': '/root/anaconda3/envs/CrashRepair/bin/python'})
2025-02-05 21:10:38.028 | DEBUG    | scenario:rebuild:398 - using environment: {'INJECT_CFLAGS': '-g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy ', 'INJECT_CXXFLAGS': '-g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy ', 'INJECT_LDFLAGS': '-g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy '}
2025-02-05 21:10:38.028 | DEBUG    | shell:__call__:41 - executing: make CFLAGS="-fsanitize=float-cast-overflow ${INJECT_CFLAGS}" CXXFLAGS="-fsanitize=float-cast-overflow ${INJECT_CXXFLAGS}" LDFLAGS="${INJECT_LDFLAGS}"
Making all in port
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/port'
make[1]: Nothing to be done for 'all'.
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/port'
Making all in libtiff
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/libtiff'
make  all-am
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/libtiff'
/bin/bash ../libtool  --tag=CC   --mode=compile crepair-cc -DHAVE_CONFIG_H -I.     -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -MT tif_dirwrite.lo -MD -MP -MF .deps/tif_dirwrite.Tpo -c -o tif_dirwrite.lo tif_dirwrite.c
libtool: compile:  crepair-cc -DHAVE_CONFIG_H -I. -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -MT tif_dirwrite.lo -MD -MP -MF .deps/tif_dirwrite.Tpo -c tif_dirwrite.c -o tif_dirwrite.o
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
mv -f .deps/tif_dirwrite.Tpo .deps/tif_dirwrite.Plo
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -no-undefined -version-info 7:5:2   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o libtiff.la -rpath /usr/local/lib tif_aux.lo tif_close.lo tif_codec.lo tif_color.lo tif_compress.lo tif_dir.lo tif_dirinfo.lo tif_dirread.lo tif_dirwrite.lo tif_dumpmode.lo tif_error.lo tif_extension.lo tif_fax3.lo tif_fax3sm.lo tif_flush.lo tif_getimage.lo tif_jbig.lo tif_jpeg.lo tif_jpeg_12.lo tif_luv.lo tif_lzma.lo tif_lzw.lo tif_next.lo tif_ojpeg.lo tif_open.lo tif_packbits.lo tif_pixarlog.lo tif_predict.lo tif_print.lo tif_read.lo tif_strip.lo tif_swab.lo tif_thunder.lo tif_tile.lo tif_version.lo tif_warning.lo tif_write.lo tif_zip.lo  tif_unix.lo ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: rm -fr  .libs/libtiff.a .libs/libtiff.la .libs/libtiff.lai
libtool: link: (cd .libs/libtiff.lax/libport.a && ar x "/data/vulnloc/libtiff/CVE-2017-7600/src/libtiff/../port/.libs/libport.a")
libtool: link: ar cru .libs/libtiff.a  tif_aux.o tif_close.o tif_codec.o tif_color.o tif_compress.o tif_dir.o tif_dirinfo.o tif_dirread.o tif_dirwrite.o tif_dumpmode.o tif_error.o tif_extension.o tif_fax3.o tif_fax3sm.o tif_flush.o tif_getimage.o tif_jbig.o tif_jpeg.o tif_jpeg_12.o tif_luv.o tif_lzma.o tif_lzw.o tif_next.o tif_ojpeg.o tif_open.o tif_packbits.o tif_pixarlog.o tif_predict.o tif_print.o tif_read.o tif_strip.o tif_swab.o tif_thunder.o tif_tile.o tif_version.o tif_warning.o tif_write.o tif_zip.o tif_unix.o  .libs/libtiff.lax/libport.a/dummy.o 
ar: `u' modifier ignored since `D' is the default (see `U')
libtool: link: ranlib .libs/libtiff.a
libtool: link: rm -fr .libs/libtiff.lax
libtool: link: ( cd ".libs" && rm -f "libtiff.la" && ln -s "../libtiff.la" "libtiff.la" )
/bin/bash ../libtool  --tag=CXX   --mode=link crepair-cxx  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -no-undefined -version-info 7:5:2   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o libtiffxx.la -rpath /usr/local/lib tif_stream.lo ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: rm -fr  .libs/libtiffxx.a .libs/libtiffxx.la .libs/libtiffxx.lai
libtool: link: (cd .libs/libtiffxx.lax/libport.a && ar x "/data/vulnloc/libtiff/CVE-2017-7600/src/libtiff/../port/.libs/libport.a")
libtool: link: ar cru .libs/libtiffxx.a  tif_stream.o  .libs/libtiffxx.lax/libport.a/dummy.o 
ar: `u' modifier ignored since `D' is the default (see `U')
libtool: link: ranlib .libs/libtiffxx.a
libtool: link: rm -fr .libs/libtiffxx.lax
libtool: link: ( cd ".libs" && rm -f "libtiffxx.la" && ln -s "../libtiffxx.la" "libtiffxx.la" )
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/libtiff'
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/libtiff'
Making all in tools
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/tools'
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o bmp2tiff bmp2tiff.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o bmp2tiff bmp2tiff.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o fax2ps fax2ps.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o fax2ps fax2ps.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o fax2tiff fax2tiff.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o fax2tiff fax2tiff.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o gif2tiff gif2tiff.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o gif2tiff gif2tiff.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o pal2rgb pal2rgb.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o pal2rgb pal2rgb.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o ppm2tiff ppm2tiff.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o ppm2tiff ppm2tiff.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o ras2tiff ras2tiff.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o ras2tiff ras2tiff.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o raw2tiff raw2tiff.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o raw2tiff raw2tiff.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o rgb2ycbcr rgb2ycbcr.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o rgb2ycbcr rgb2ycbcr.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o thumbnail thumbnail.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o thumbnail thumbnail.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o tiff2bw tiff2bw.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o tiff2bw tiff2bw.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o tiff2pdf tiff2pdf.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o tiff2pdf tiff2pdf.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o tiff2ps tiff2ps.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o tiff2ps tiff2ps.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o tiff2rgba tiff2rgba.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o tiff2rgba tiff2rgba.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o tiffcmp tiffcmp.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o tiffcmp tiffcmp.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o tiffcp tiffcp.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o tiffcp tiffcp.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o tiffcrop tiffcrop.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o tiffcrop tiffcrop.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o tiffdither tiffdither.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o tiffdither tiffdither.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o tiffdump tiffdump.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o tiffdump tiffdump.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o tiffinfo tiffinfo.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o tiffinfo tiffinfo.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o tiffmedian tiffmedian.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o tiffmedian tiffmedian.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o tiffset tiffset.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o tiffset tiffset.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o tiffsplit tiffsplit.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o tiffsplit tiffsplit.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/tools'
Making all in build
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/build'
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/build'
make[2]: Nothing to be done for 'all-am'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/build'
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/build'
Making all in contrib
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib'
Making all in addtiffo
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/addtiffo'
/bin/bash ../../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o addtiffo addtiffo.o tif_overview.o tif_ovrcache.o ../../libtiff/libtiff.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o addtiffo addtiffo.o tif_overview.o tif_ovrcache.o  -L/klee/build/lib -L/CrashRepair/lib ../../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy -llzma -ljbig -ljpeg -lz -lm
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/addtiffo'
Making all in dbs
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/dbs'
Making all in xtiff
make[3]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/dbs/xtiff'
make[3]: Nothing to be done for 'all'.
make[3]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/dbs/xtiff'
make[3]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/dbs'
/bin/bash ../../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o tiff-bi tiff-bi.o ../../libtiff/libtiff.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o tiff-bi tiff-bi.o  -L/klee/build/lib -L/CrashRepair/lib ../../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o tiff-grayscale tiff-grayscale.o ../../libtiff/libtiff.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o tiff-grayscale tiff-grayscale.o  -L/klee/build/lib -L/CrashRepair/lib ../../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o tiff-palette tiff-palette.o ../../libtiff/libtiff.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o tiff-palette tiff-palette.o  -L/klee/build/lib -L/CrashRepair/lib ../../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o tiff-rgb tiff-rgb.o ../../libtiff/libtiff.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o tiff-rgb tiff-rgb.o  -L/klee/build/lib -L/CrashRepair/lib ../../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy -llzma -ljbig -ljpeg -lz -lm
make[3]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/dbs'
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/dbs'
Making all in iptcutil
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/iptcutil'
/bin/bash ../../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o iptcutil iptcutil.o ../../libtiff/libtiff.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o iptcutil iptcutil.o  -L/klee/build/lib -L/CrashRepair/lib ../../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy -llzma -ljbig -ljpeg -lz -lm
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/iptcutil'
Making all in mfs
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/mfs'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/mfs'
Making all in pds
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/pds'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/pds'
Making all in ras
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/ras'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/ras'
Making all in stream
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/stream'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/stream'
Making all in tags
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/tags'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/tags'
Making all in win_dib
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/win_dib'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/win_dib'
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib'
make[2]: Nothing to be done for 'all-am'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib'
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib'
Making all in test
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/test'
make[1]: Nothing to be done for 'all'.
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/test'
Making all in man
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/man'
make[1]: Nothing to be done for 'all'.
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/man'
Making all in html
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/html'
Making all in images
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/html/images'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/html/images'
Making all in man
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/html/man'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/html/man'
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/html'
make[2]: Nothing to be done for 'all-am'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/html'
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/html'
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src'
make[1]: Nothing to be done for 'all-am'.
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src'
2025-02-05 21:10:42.566 | DEBUG    | scenario:evaluate:655 - testing candidate #15 against test #crash...
2025-02-05 21:10:42.566 | DEBUG    | shell:__call__:41 - executing: /data/vulnloc/libtiff/CVE-2017-7600/src/tools/tiffcp -i /CrashRepair/experiments/vulnloc/libtiff/CVE-2017-7600/tests/1.tif out.tiff
2025-02-05 21:10:42.571 | DEBUG    | test:run:172 - test failed: stderr contains bad output substring (runtime error: -115 is outside the range of representable values)
2025-02-05 21:10:42.571 | INFO     | scenario:evaluate:662 - candidate #15 fails test #crash
2025-02-05 21:10:42.577 | INFO     | scenario:evaluate:635 - evaluating candidate patch #16:
@@ -939,6 +939,7 @@
 	return(0);
 }
 
+
 static int
 TIFFWriteDirectoryTagSampleformatArray(TIFF* tif, uint32* ndir, TIFFDirEntry* dir, uint16 tag, uint32 count, double* value)
 {
@@ -946,65 +947,70 @@
 	void* conv;
 	uint32 i;
 	int ok;
-	conv = _TIFFmalloc(count*sizeof(double));
+	conv = _TIFFmalloc(count * sizeof(double));
 	if (conv == NULL)
 	{
 		TIFFErrorExt(tif->tif_clientdata, module, "Out of memory");
 		return (0);
 	}
 
+	if (count == 0) {
+		_TIFFfree(conv);
+		return (1); // No data to write, consider it as a success
+	}
+
 	switch (tif->tif_dir.td_sampleformat)
 	{
 		case SAMPLEFORMAT_IEEEFP:
-			if (tif->tif_dir.td_bitspersample<=32)
+			if (tif->tif_dir.td_bitspersample <= 32)
 			{
 				for (i = 0; i < count; ++i)
 					((float*)conv)[i] = (float)value[i];
-				ok = TIFFWriteDirectoryTagFloatArray(tif,ndir,dir,tag,count,(float*)conv);
+				ok = TIFFWriteDirectoryTagFloatArray(tif, ndir, dir, tag, count, (float*)conv);
 			}
 			else
 			{
-				ok = TIFFWriteDirectoryTagDoubleArray(tif,ndir,dir,tag,count,value);
+				ok = TIFFWriteDirectoryTagDoubleArray(tif, ndir, dir, tag, count, value);
 			}
 			break;
 		case SAMPLEFORMAT_INT:
-			if (tif->tif_dir.td_bitspersample<=8)
+			if (tif->tif_dir.td_bitspersample <= 8)
 			{
 				for (i = 0; i < count; ++i)
 					((int8*)conv)[i] = (int8)value[i];
-				ok = TIFFWriteDirectoryTagSbyteArray(tif,ndir,dir,tag,count,(int8*)conv);
+				ok = TIFFWriteDirectoryTagSbyteArray(tif, ndir, dir, tag, count, (int8*)conv);
 			}
-			else if (tif->tif_dir.td_bitspersample<=16)
+			else if (tif->tif_dir.td_bitspersample <= 16)
 			{
 				for (i = 0; i < count; ++i)
 					((int16*)conv)[i] = (int16)value[i];
-				ok = TIFFWriteDirectoryTagSshortArray(tif,ndir,dir,tag,count,(int16*)conv);
+				ok = TIFFWriteDirectoryTagSshortArray(tif, ndir, dir, tag, count, (int16*)conv);
 			}
 			else
 			{
 				for (i = 0; i < count; ++i)
 					((int32*)conv)[i] = (int32)value[i];
-				ok = TIFFWriteDirectoryTagSlongArray(tif,ndir,dir,tag,count,(int32*)conv);
+				ok = TIFFWriteDirectoryTagSlongArray(tif, ndir, dir, tag, count, (int32*)conv);
 			}
 			break;
 		case SAMPLEFORMAT_UINT:
-			if (tif->tif_dir.td_bitspersample<=8)
+			if (tif->tif_dir.td_bitspersample <= 8)
 			{
 				for (i = 0; i < count; ++i)
 					((uint8*)conv)[i] = (uint8)value[i];
-				ok = TIFFWriteDirectoryTagByteArray(tif,ndir,dir,tag,count,(uint8*)conv);
+				ok = TIFFWriteDirectoryTagByteArray(tif, ndir, dir, tag, count, (uint8*)conv);
 			}
-			else if (tif->tif_dir.td_bitspersample<=16)
+			else if (tif->tif_dir.td_bitspersample <= 16)
 			{
 				for (i = 0; i < count; ++i)
 					((uint16*)conv)[i] = (uint16)value[i];
-				ok = TIFFWriteDirectoryTagShortArray(tif,ndir,dir,tag,count,(uint16*)conv);
+				ok = TIFFWriteDirectoryTagShortArray(tif, ndir, dir, tag, count, (uint16*)conv);
 			}
 			else
 			{
 				for (i = 0; i < count; ++i)
 					((uint32*)conv)[i] = (uint32)value[i];
-				ok = TIFFWriteDirectoryTagLongArray(tif,ndir,dir,tag,count,(uint32*)conv);
+				ok = TIFFWriteDirectoryTagLongArray(tif, ndir, dir, tag, count, (uint32*)conv);
 			}
 			break;
 		default:
@@ -1015,6 +1021,7 @@
 	return (ok);
 }
 
+
 #if 0
 static int
 TIFFWriteDirectoryTagSampleformatPerSample(TIFF* tif, uint32* ndir, TIFFDirEntry* dir, uint16 tag, double value)

2025-02-05 21:10:42.584 | DEBUG    | scenario:rebuild:369 - original environment: environ({'CONDA_SHLVL': '2', 'LC_ALL': 'C.UTF-8', 'LS_COLORS': 'rs=0:di=01;34:ln=01;36:mh=00:pi=40;33:so=01;35:do=01;35:bd=40;33;01:cd=40;33;01:or=40;31;01:mi=00:su=37;41:sg=30;43:ca=30;41:tw=30;42:ow=34;42:st=37;44:ex=01;32:*.tar=01;31:*.tgz=01;31:*.arc=01;31:*.arj=01;31:*.taz=01;31:*.lha=01;31:*.lz4=01;31:*.lzh=01;31:*.lzma=01;31:*.tlz=01;31:*.txz=01;31:*.tzo=01;31:*.t7z=01;31:*.zip=01;31:*.z=01;31:*.Z=01;31:*.dz=01;31:*.gz=01;31:*.lrz=01;31:*.lz=01;31:*.lzo=01;31:*.xz=01;31:*.zst=01;31:*.tzst=01;31:*.bz2=01;31:*.bz=01;31:*.tbz=01;31:*.tbz2=01;31:*.tz=01;31:*.deb=01;31:*.rpm=01;31:*.jar=01;31:*.war=01;31:*.ear=01;31:*.sar=01;31:*.rar=01;31:*.alz=01;31:*.ace=01;31:*.zoo=01;31:*.cpio=01;31:*.7z=01;31:*.rz=01;31:*.cab=01;31:*.wim=01;31:*.swm=01;31:*.dwm=01;31:*.esd=01;31:*.jpg=01;35:*.jpeg=01;35:*.mjpg=01;35:*.mjpeg=01;35:*.gif=01;35:*.bmp=01;35:*.pbm=01;35:*.pgm=01;35:*.ppm=01;35:*.tga=01;35:*.xbm=01;35:*.xpm=01;35:*.tif=01;35:*.tiff=01;35:*.png=01;35:*.svg=01;35:*.svgz=01;35:*.mng=01;35:*.pcx=01;35:*.mov=01;35:*.mpg=01;35:*.mpeg=01;35:*.m2v=01;35:*.mkv=01;35:*.webm=01;35:*.ogm=01;35:*.mp4=01;35:*.m4v=01;35:*.mp4v=01;35:*.vob=01;35:*.qt=01;35:*.nuv=01;35:*.wmv=01;35:*.asf=01;35:*.rm=01;35:*.rmvb=01;35:*.flc=01;35:*.avi=01;35:*.fli=01;35:*.flv=01;35:*.gl=01;35:*.dl=01;35:*.xcf=01;35:*.xwd=01;35:*.yuv=01;35:*.cgm=01;35:*.emf=01;35:*.ogv=01;35:*.ogx=01;35:*.aac=00;36:*.au=00;36:*.flac=00;36:*.m4a=00;36:*.mid=00;36:*.midi=00;36:*.mka=00;36:*.mp3=00;36:*.mpc=00;36:*.ogg=00;36:*.ra=00;36:*.wav=00;36:*.oga=00;36:*.opus=00;36:*.spx=00;36:*.xspf=00;36:', 'LD_LIBRARY_PATH': '/opt/crashrepair/lib:/CrashRepair/lib:/klee/build/lib:', 'CONDA_EXE': '/root/anaconda3/bin/conda', 'LANG': 'C.UTF-8', 'TZ': 'Asia/Shanghai', 'HOSTNAME': 'fea22102047d', 'OLDPWD': '/orchestrator', 'CONDA_PREFIX': '/root/anaconda3/envs/CrashRepair', '_CE_M': '', 'CC': 'crepair-cc', 'LLVM_COMPILER': 'clang', 'CONDA_PREFIX_1': '/root/anaconda3', 'PWD': '/orchestrator/crashrepair', 'HOME': '/root', 'CONDA_PYTHON_EXE': '/root/anaconda3/bin/python', '_CE_CONDA': '', 'CONDA_PROMPT_MODIFIER': '(CrashRepair) ', 'CXX': 'crepair-cxx', 'TERM': 'xterm', 'SHLVL': '2', 'PYTHONPATH': '/usr/lib/python3.8/site-packages:', 'PATH': '/root/anaconda3/envs/CrashRepair/bin:/root/anaconda3/condabin:~/anaconda3/bin:/opt/crashrepair/bin:/CrashRepair/compiler:/klee/build/bin:/opt/llvm-6/bin:/klee/build/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', 'CONDA_DEFAULT_ENV': 'CrashRepair', '_': '/root/anaconda3/envs/CrashRepair/bin/python'})
2025-02-05 21:10:42.584 | DEBUG    | scenario:rebuild:398 - using environment: {'INJECT_CFLAGS': '-g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy ', 'INJECT_CXXFLAGS': '-g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy ', 'INJECT_LDFLAGS': '-g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy '}
2025-02-05 21:10:42.584 | DEBUG    | shell:__call__:41 - executing: make CFLAGS="-fsanitize=float-cast-overflow ${INJECT_CFLAGS}" CXXFLAGS="-fsanitize=float-cast-overflow ${INJECT_CXXFLAGS}" LDFLAGS="${INJECT_LDFLAGS}"
Making all in port
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/port'
make[1]: Nothing to be done for 'all'.
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/port'
Making all in libtiff
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/libtiff'
make  all-am
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/libtiff'
/bin/bash ../libtool  --tag=CC   --mode=compile crepair-cc -DHAVE_CONFIG_H -I.     -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -MT tif_dirwrite.lo -MD -MP -MF .deps/tif_dirwrite.Tpo -c -o tif_dirwrite.lo tif_dirwrite.c
libtool: compile:  crepair-cc -DHAVE_CONFIG_H -I. -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -MT tif_dirwrite.lo -MD -MP -MF .deps/tif_dirwrite.Tpo -c tif_dirwrite.c -o tif_dirwrite.o
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
mv -f .deps/tif_dirwrite.Tpo .deps/tif_dirwrite.Plo
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -no-undefined -version-info 7:5:2   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o libtiff.la -rpath /usr/local/lib tif_aux.lo tif_close.lo tif_codec.lo tif_color.lo tif_compress.lo tif_dir.lo tif_dirinfo.lo tif_dirread.lo tif_dirwrite.lo tif_dumpmode.lo tif_error.lo tif_extension.lo tif_fax3.lo tif_fax3sm.lo tif_flush.lo tif_getimage.lo tif_jbig.lo tif_jpeg.lo tif_jpeg_12.lo tif_luv.lo tif_lzma.lo tif_lzw.lo tif_next.lo tif_ojpeg.lo tif_open.lo tif_packbits.lo tif_pixarlog.lo tif_predict.lo tif_print.lo tif_read.lo tif_strip.lo tif_swab.lo tif_thunder.lo tif_tile.lo tif_version.lo tif_warning.lo tif_write.lo tif_zip.lo  tif_unix.lo ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: rm -fr  .libs/libtiff.a .libs/libtiff.la .libs/libtiff.lai
libtool: link: (cd .libs/libtiff.lax/libport.a && ar x "/data/vulnloc/libtiff/CVE-2017-7600/src/libtiff/../port/.libs/libport.a")
libtool: link: ar cru .libs/libtiff.a  tif_aux.o tif_close.o tif_codec.o tif_color.o tif_compress.o tif_dir.o tif_dirinfo.o tif_dirread.o tif_dirwrite.o tif_dumpmode.o tif_error.o tif_extension.o tif_fax3.o tif_fax3sm.o tif_flush.o tif_getimage.o tif_jbig.o tif_jpeg.o tif_jpeg_12.o tif_luv.o tif_lzma.o tif_lzw.o tif_next.o tif_ojpeg.o tif_open.o tif_packbits.o tif_pixarlog.o tif_predict.o tif_print.o tif_read.o tif_strip.o tif_swab.o tif_thunder.o tif_tile.o tif_version.o tif_warning.o tif_write.o tif_zip.o tif_unix.o  .libs/libtiff.lax/libport.a/dummy.o 
ar: `u' modifier ignored since `D' is the default (see `U')
libtool: link: ranlib .libs/libtiff.a
libtool: link: rm -fr .libs/libtiff.lax
libtool: link: ( cd ".libs" && rm -f "libtiff.la" && ln -s "../libtiff.la" "libtiff.la" )
/bin/bash ../libtool  --tag=CXX   --mode=link crepair-cxx  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -no-undefined -version-info 7:5:2   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o libtiffxx.la -rpath /usr/local/lib tif_stream.lo ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: rm -fr  .libs/libtiffxx.a .libs/libtiffxx.la .libs/libtiffxx.lai
libtool: link: (cd .libs/libtiffxx.lax/libport.a && ar x "/data/vulnloc/libtiff/CVE-2017-7600/src/libtiff/../port/.libs/libport.a")
libtool: link: ar cru .libs/libtiffxx.a  tif_stream.o  .libs/libtiffxx.lax/libport.a/dummy.o 
ar: `u' modifier ignored since `D' is the default (see `U')
libtool: link: ranlib .libs/libtiffxx.a
libtool: link: rm -fr .libs/libtiffxx.lax
libtool: link: ( cd ".libs" && rm -f "libtiffxx.la" && ln -s "../libtiffxx.la" "libtiffxx.la" )
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/libtiff'
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/libtiff'
Making all in tools
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/tools'
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o bmp2tiff bmp2tiff.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o bmp2tiff bmp2tiff.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o fax2ps fax2ps.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o fax2ps fax2ps.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o fax2tiff fax2tiff.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o fax2tiff fax2tiff.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o gif2tiff gif2tiff.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o gif2tiff gif2tiff.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o pal2rgb pal2rgb.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o pal2rgb pal2rgb.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o ppm2tiff ppm2tiff.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o ppm2tiff ppm2tiff.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o ras2tiff ras2tiff.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o ras2tiff ras2tiff.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o raw2tiff raw2tiff.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o raw2tiff raw2tiff.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o rgb2ycbcr rgb2ycbcr.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o rgb2ycbcr rgb2ycbcr.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o thumbnail thumbnail.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o thumbnail thumbnail.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o tiff2bw tiff2bw.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o tiff2bw tiff2bw.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o tiff2pdf tiff2pdf.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o tiff2pdf tiff2pdf.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o tiff2ps tiff2ps.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o tiff2ps tiff2ps.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o tiff2rgba tiff2rgba.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o tiff2rgba tiff2rgba.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o tiffcmp tiffcmp.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o tiffcmp tiffcmp.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o tiffcp tiffcp.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o tiffcp tiffcp.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o tiffcrop tiffcrop.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o tiffcrop tiffcrop.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o tiffdither tiffdither.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o tiffdither tiffdither.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o tiffdump tiffdump.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o tiffdump tiffdump.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o tiffinfo tiffinfo.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o tiffinfo tiffinfo.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o tiffmedian tiffmedian.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o tiffmedian tiffmedian.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o tiffset tiffset.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o tiffset tiffset.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o tiffsplit tiffsplit.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o tiffsplit tiffsplit.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/tools'
Making all in build
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/build'
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/build'
make[2]: Nothing to be done for 'all-am'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/build'
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/build'
Making all in contrib
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib'
Making all in addtiffo
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/addtiffo'
/bin/bash ../../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o addtiffo addtiffo.o tif_overview.o tif_ovrcache.o ../../libtiff/libtiff.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o addtiffo addtiffo.o tif_overview.o tif_ovrcache.o  -L/klee/build/lib -L/CrashRepair/lib ../../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy -llzma -ljbig -ljpeg -lz -lm
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/addtiffo'
Making all in dbs
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/dbs'
Making all in xtiff
make[3]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/dbs/xtiff'
make[3]: Nothing to be done for 'all'.
make[3]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/dbs/xtiff'
make[3]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/dbs'
/bin/bash ../../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o tiff-bi tiff-bi.o ../../libtiff/libtiff.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o tiff-bi tiff-bi.o  -L/klee/build/lib -L/CrashRepair/lib ../../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o tiff-grayscale tiff-grayscale.o ../../libtiff/libtiff.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o tiff-grayscale tiff-grayscale.o  -L/klee/build/lib -L/CrashRepair/lib ../../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o tiff-palette tiff-palette.o ../../libtiff/libtiff.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o tiff-palette tiff-palette.o  -L/klee/build/lib -L/CrashRepair/lib ../../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o tiff-rgb tiff-rgb.o ../../libtiff/libtiff.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o tiff-rgb tiff-rgb.o  -L/klee/build/lib -L/CrashRepair/lib ../../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy -llzma -ljbig -ljpeg -lz -lm
make[3]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/dbs'
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/dbs'
Making all in iptcutil
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/iptcutil'
/bin/bash ../../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o iptcutil iptcutil.o ../../libtiff/libtiff.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o iptcutil iptcutil.o  -L/klee/build/lib -L/CrashRepair/lib ../../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy -llzma -ljbig -ljpeg -lz -lm
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/iptcutil'
Making all in mfs
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/mfs'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/mfs'
Making all in pds
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/pds'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/pds'
Making all in ras
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/ras'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/ras'
Making all in stream
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/stream'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/stream'
Making all in tags
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/tags'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/tags'
Making all in win_dib
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/win_dib'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/win_dib'
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib'
make[2]: Nothing to be done for 'all-am'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib'
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib'
Making all in test
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/test'
make[1]: Nothing to be done for 'all'.
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/test'
Making all in man
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/man'
make[1]: Nothing to be done for 'all'.
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/man'
Making all in html
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/html'
Making all in images
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/html/images'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/html/images'
Making all in man
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/html/man'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/html/man'
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/html'
make[2]: Nothing to be done for 'all-am'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/html'
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/html'
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src'
make[1]: Nothing to be done for 'all-am'.
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src'
2025-02-05 21:10:47.076 | DEBUG    | scenario:evaluate:655 - testing candidate #16 against test #crash...
2025-02-05 21:10:47.076 | DEBUG    | shell:__call__:41 - executing: /data/vulnloc/libtiff/CVE-2017-7600/src/tools/tiffcp -i /CrashRepair/experiments/vulnloc/libtiff/CVE-2017-7600/tests/1.tif out.tiff
2025-02-05 21:10:47.080 | DEBUG    | test:run:172 - test failed: stderr contains bad output substring (runtime error: -115 is outside the range of representable values)
2025-02-05 21:10:47.080 | INFO     | scenario:evaluate:662 - candidate #16 fails test #crash
2025-02-05 21:10:47.089 | INFO     | scenario:evaluate:635 - evaluating candidate patch #17:
@@ -939,6 +939,7 @@
 	return(0);
 }
 
+
 static int
 TIFFWriteDirectoryTagSampleformatArray(TIFF* tif, uint32* ndir, TIFFDirEntry* dir, uint16 tag, uint32 count, double* value)
 {
@@ -958,7 +959,7 @@
 		case SAMPLEFORMAT_IEEEFP:
 			if (tif->tif_dir.td_bitspersample<=32)
 			{
-				for (i = 0; i < count; ++i)
+				for (i = 0; i < count && i < MAX_COUNT; ++i) // Added bound check
 					((float*)conv)[i] = (float)value[i];
 				ok = TIFFWriteDirectoryTagFloatArray(tif,ndir,dir,tag,count,(float*)conv);
 			}
@@ -970,19 +971,19 @@
 		case SAMPLEFORMAT_INT:
 			if (tif->tif_dir.td_bitspersample<=8)
 			{
-				for (i = 0; i < count; ++i)
+				for (i = 0; i < count && i < MAX_COUNT; ++i) // Added bound check
 					((int8*)conv)[i] = (int8)value[i];
 				ok = TIFFWriteDirectoryTagSbyteArray(tif,ndir,dir,tag,count,(int8*)conv);
 			}
 			else if (tif->tif_dir.td_bitspersample<=16)
 			{
-				for (i = 0; i < count; ++i)
+				for (i = 0; i < count && i < MAX_COUNT; ++i) // Added bound check
 					((int16*)conv)[i] = (int16)value[i];
 				ok = TIFFWriteDirectoryTagSshortArray(tif,ndir,dir,tag,count,(int16*)conv);
 			}
 			else
 			{
-				for (i = 0; i < count; ++i)
+				for (i = 0; i < count && i < MAX_COUNT; ++i) // Added bound check
 					((int32*)conv)[i] = (int32)value[i];
 				ok = TIFFWriteDirectoryTagSlongArray(tif,ndir,dir,tag,count,(int32*)conv);
 			}
@@ -990,19 +991,19 @@
 		case SAMPLEFORMAT_UINT:
 			if (tif->tif_dir.td_bitspersample<=8)
 			{
-				for (i = 0; i < count; ++i)
+				for (i = 0; i < count && i < MAX_COUNT; ++i) // Added bound check
 					((uint8*)conv)[i] = (uint8)value[i];
 				ok = TIFFWriteDirectoryTagByteArray(tif,ndir,dir,tag,count,(uint8*)conv);
 			}
 			else if (tif->tif_dir.td_bitspersample<=16)
 			{
-				for (i = 0; i < count; ++i)
+				for (i = 0; i < count && i < MAX_COUNT; ++i) // Added bound check
 					((uint16*)conv)[i] = (uint16)value[i];
 				ok = TIFFWriteDirectoryTagShortArray(tif,ndir,dir,tag,count,(uint16*)conv);
 			}
 			else
 			{
-				for (i = 0; i < count; ++i)
+				for (i = 0; i < count && i < MAX_COUNT; ++i) // Added bound check
 					((uint32*)conv)[i] = (uint32)value[i];
 				ok = TIFFWriteDirectoryTagLongArray(tif,ndir,dir,tag,count,(uint32*)conv);
 			}
@@ -1015,6 +1016,7 @@
 	return (ok);
 }
 
+
 #if 0
 static int
 TIFFWriteDirectoryTagSampleformatPerSample(TIFF* tif, uint32* ndir, TIFFDirEntry* dir, uint16 tag, double value)

2025-02-05 21:10:47.093 | DEBUG    | scenario:rebuild:369 - original environment: environ({'CONDA_SHLVL': '2', 'LC_ALL': 'C.UTF-8', 'LS_COLORS': 'rs=0:di=01;34:ln=01;36:mh=00:pi=40;33:so=01;35:do=01;35:bd=40;33;01:cd=40;33;01:or=40;31;01:mi=00:su=37;41:sg=30;43:ca=30;41:tw=30;42:ow=34;42:st=37;44:ex=01;32:*.tar=01;31:*.tgz=01;31:*.arc=01;31:*.arj=01;31:*.taz=01;31:*.lha=01;31:*.lz4=01;31:*.lzh=01;31:*.lzma=01;31:*.tlz=01;31:*.txz=01;31:*.tzo=01;31:*.t7z=01;31:*.zip=01;31:*.z=01;31:*.Z=01;31:*.dz=01;31:*.gz=01;31:*.lrz=01;31:*.lz=01;31:*.lzo=01;31:*.xz=01;31:*.zst=01;31:*.tzst=01;31:*.bz2=01;31:*.bz=01;31:*.tbz=01;31:*.tbz2=01;31:*.tz=01;31:*.deb=01;31:*.rpm=01;31:*.jar=01;31:*.war=01;31:*.ear=01;31:*.sar=01;31:*.rar=01;31:*.alz=01;31:*.ace=01;31:*.zoo=01;31:*.cpio=01;31:*.7z=01;31:*.rz=01;31:*.cab=01;31:*.wim=01;31:*.swm=01;31:*.dwm=01;31:*.esd=01;31:*.jpg=01;35:*.jpeg=01;35:*.mjpg=01;35:*.mjpeg=01;35:*.gif=01;35:*.bmp=01;35:*.pbm=01;35:*.pgm=01;35:*.ppm=01;35:*.tga=01;35:*.xbm=01;35:*.xpm=01;35:*.tif=01;35:*.tiff=01;35:*.png=01;35:*.svg=01;35:*.svgz=01;35:*.mng=01;35:*.pcx=01;35:*.mov=01;35:*.mpg=01;35:*.mpeg=01;35:*.m2v=01;35:*.mkv=01;35:*.webm=01;35:*.ogm=01;35:*.mp4=01;35:*.m4v=01;35:*.mp4v=01;35:*.vob=01;35:*.qt=01;35:*.nuv=01;35:*.wmv=01;35:*.asf=01;35:*.rm=01;35:*.rmvb=01;35:*.flc=01;35:*.avi=01;35:*.fli=01;35:*.flv=01;35:*.gl=01;35:*.dl=01;35:*.xcf=01;35:*.xwd=01;35:*.yuv=01;35:*.cgm=01;35:*.emf=01;35:*.ogv=01;35:*.ogx=01;35:*.aac=00;36:*.au=00;36:*.flac=00;36:*.m4a=00;36:*.mid=00;36:*.midi=00;36:*.mka=00;36:*.mp3=00;36:*.mpc=00;36:*.ogg=00;36:*.ra=00;36:*.wav=00;36:*.oga=00;36:*.opus=00;36:*.spx=00;36:*.xspf=00;36:', 'LD_LIBRARY_PATH': '/opt/crashrepair/lib:/CrashRepair/lib:/klee/build/lib:', 'CONDA_EXE': '/root/anaconda3/bin/conda', 'LANG': 'C.UTF-8', 'TZ': 'Asia/Shanghai', 'HOSTNAME': 'fea22102047d', 'OLDPWD': '/orchestrator', 'CONDA_PREFIX': '/root/anaconda3/envs/CrashRepair', '_CE_M': '', 'CC': 'crepair-cc', 'LLVM_COMPILER': 'clang', 'CONDA_PREFIX_1': '/root/anaconda3', 'PWD': '/orchestrator/crashrepair', 'HOME': '/root', 'CONDA_PYTHON_EXE': '/root/anaconda3/bin/python', '_CE_CONDA': '', 'CONDA_PROMPT_MODIFIER': '(CrashRepair) ', 'CXX': 'crepair-cxx', 'TERM': 'xterm', 'SHLVL': '2', 'PYTHONPATH': '/usr/lib/python3.8/site-packages:', 'PATH': '/root/anaconda3/envs/CrashRepair/bin:/root/anaconda3/condabin:~/anaconda3/bin:/opt/crashrepair/bin:/CrashRepair/compiler:/klee/build/bin:/opt/llvm-6/bin:/klee/build/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', 'CONDA_DEFAULT_ENV': 'CrashRepair', '_': '/root/anaconda3/envs/CrashRepair/bin/python'})
2025-02-05 21:10:47.094 | DEBUG    | scenario:rebuild:398 - using environment: {'INJECT_CFLAGS': '-g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy ', 'INJECT_CXXFLAGS': '-g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy ', 'INJECT_LDFLAGS': '-g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy '}
2025-02-05 21:10:47.094 | DEBUG    | shell:__call__:41 - executing: make CFLAGS="-fsanitize=float-cast-overflow ${INJECT_CFLAGS}" CXXFLAGS="-fsanitize=float-cast-overflow ${INJECT_CXXFLAGS}" LDFLAGS="${INJECT_LDFLAGS}"
Making all in port
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/port'
make[1]: Nothing to be done for 'all'.
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/port'
Making all in libtiff
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/libtiff'
make  all-am
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/libtiff'
/bin/bash ../libtool  --tag=CC   --mode=compile crepair-cc -DHAVE_CONFIG_H -I.     -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -MT tif_dirwrite.lo -MD -MP -MF .deps/tif_dirwrite.Tpo -c -o tif_dirwrite.lo tif_dirwrite.c
libtool: compile:  crepair-cc -DHAVE_CONFIG_H -I. -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -MT tif_dirwrite.lo -MD -MP -MF .deps/tif_dirwrite.Tpo -c tif_dirwrite.c -o tif_dirwrite.o
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
tif_dirwrite.c:962:34: error: use of undeclared identifier 'MAX_COUNT'
                                for (i = 0; i < count && i < MAX_COUNT; ++i) // Added bound check
                                                             ^
tif_dirwrite.c:974:34: error: use of undeclared identifier 'MAX_COUNT'
                                for (i = 0; i < count && i < MAX_COUNT; ++i) // Added bound check
                                                             ^
tif_dirwrite.c:980:34: error: use of undeclared identifier 'MAX_COUNT'
                                for (i = 0; i < count && i < MAX_COUNT; ++i) // Added bound check
                                                             ^
tif_dirwrite.c:986:34: error: use of undeclared identifier 'MAX_COUNT'
                                for (i = 0; i < count && i < MAX_COUNT; ++i) // Added bound check
                                                             ^
tif_dirwrite.c:994:34: error: use of undeclared identifier 'MAX_COUNT'
                                for (i = 0; i < count && i < MAX_COUNT; ++i) // Added bound check
                                                             ^
tif_dirwrite.c:1000:34: error: use of undeclared identifier 'MAX_COUNT'
                                for (i = 0; i < count && i < MAX_COUNT; ++i) // Added bound check
                                                             ^
tif_dirwrite.c:1006:34: error: use of undeclared identifier 'MAX_COUNT'
                                for (i = 0; i < count && i < MAX_COUNT; ++i) // Added bound check
                                                             ^
7 errors generated.
ERROR:Failed to compile using given arguments: [-g -O0 -include /CrashRepair/compiler/../lib/crepair_runtime.h -DHAVE_CONFIG_H -I. -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -MT tif_dirwrite.lo -MD -MP -MF .deps/tif_dirwrite.Tpo -c tif_dirwrite.c -o tif_dirwrite.o -L/CrashRepair/compiler/../lib/ -L/klee/build/lib/ -lcrepair_runtime -lcrepair_proxy -lkleeRuntest -fno-sanitize=address]
Makefile:671: recipe for target 'tif_dirwrite.lo' failed
make[2]: *** [tif_dirwrite.lo] Error 1
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/libtiff'
Makefile:496: recipe for target 'all' failed
make[1]: *** [all] Error 2
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/libtiff'
Makefile:547: recipe for target 'all-recursive' failed
make: *** [all-recursive] Error 1
2025-02-05 21:10:47.186 | INFO     | scenario:evaluate:643 - candidate patch #17 failed to compile
2025-02-05 21:10:47.192 | INFO     | scenario:evaluate:635 - evaluating candidate patch #18:
@@ -939,6 +939,7 @@
 	return(0);
 }
 
+
 static int
 TIFFWriteDirectoryTagSampleformatArray(TIFF* tif, uint32* ndir, TIFFDirEntry* dir, uint16 tag, uint32 count, double* value)
 {
@@ -946,6 +947,11 @@
 	void* conv;
 	uint32 i;
 	int ok;
+	if (count == 0 || value == NULL) // Added check for count and value
+	{
+		TIFFErrorExt(tif->tif_clientdata, module, "Invalid count or value provided");
+		return (0);
+	}
 	conv = _TIFFmalloc(count*sizeof(double));
 	if (conv == NULL)
 	{
@@ -1015,6 +1021,7 @@
 	return (ok);
 }
 
+
 #if 0
 static int
 TIFFWriteDirectoryTagSampleformatPerSample(TIFF* tif, uint32* ndir, TIFFDirEntry* dir, uint16 tag, double value)

2025-02-05 21:10:47.198 | DEBUG    | scenario:rebuild:369 - original environment: environ({'CONDA_SHLVL': '2', 'LC_ALL': 'C.UTF-8', 'LS_COLORS': 'rs=0:di=01;34:ln=01;36:mh=00:pi=40;33:so=01;35:do=01;35:bd=40;33;01:cd=40;33;01:or=40;31;01:mi=00:su=37;41:sg=30;43:ca=30;41:tw=30;42:ow=34;42:st=37;44:ex=01;32:*.tar=01;31:*.tgz=01;31:*.arc=01;31:*.arj=01;31:*.taz=01;31:*.lha=01;31:*.lz4=01;31:*.lzh=01;31:*.lzma=01;31:*.tlz=01;31:*.txz=01;31:*.tzo=01;31:*.t7z=01;31:*.zip=01;31:*.z=01;31:*.Z=01;31:*.dz=01;31:*.gz=01;31:*.lrz=01;31:*.lz=01;31:*.lzo=01;31:*.xz=01;31:*.zst=01;31:*.tzst=01;31:*.bz2=01;31:*.bz=01;31:*.tbz=01;31:*.tbz2=01;31:*.tz=01;31:*.deb=01;31:*.rpm=01;31:*.jar=01;31:*.war=01;31:*.ear=01;31:*.sar=01;31:*.rar=01;31:*.alz=01;31:*.ace=01;31:*.zoo=01;31:*.cpio=01;31:*.7z=01;31:*.rz=01;31:*.cab=01;31:*.wim=01;31:*.swm=01;31:*.dwm=01;31:*.esd=01;31:*.jpg=01;35:*.jpeg=01;35:*.mjpg=01;35:*.mjpeg=01;35:*.gif=01;35:*.bmp=01;35:*.pbm=01;35:*.pgm=01;35:*.ppm=01;35:*.tga=01;35:*.xbm=01;35:*.xpm=01;35:*.tif=01;35:*.tiff=01;35:*.png=01;35:*.svg=01;35:*.svgz=01;35:*.mng=01;35:*.pcx=01;35:*.mov=01;35:*.mpg=01;35:*.mpeg=01;35:*.m2v=01;35:*.mkv=01;35:*.webm=01;35:*.ogm=01;35:*.mp4=01;35:*.m4v=01;35:*.mp4v=01;35:*.vob=01;35:*.qt=01;35:*.nuv=01;35:*.wmv=01;35:*.asf=01;35:*.rm=01;35:*.rmvb=01;35:*.flc=01;35:*.avi=01;35:*.fli=01;35:*.flv=01;35:*.gl=01;35:*.dl=01;35:*.xcf=01;35:*.xwd=01;35:*.yuv=01;35:*.cgm=01;35:*.emf=01;35:*.ogv=01;35:*.ogx=01;35:*.aac=00;36:*.au=00;36:*.flac=00;36:*.m4a=00;36:*.mid=00;36:*.midi=00;36:*.mka=00;36:*.mp3=00;36:*.mpc=00;36:*.ogg=00;36:*.ra=00;36:*.wav=00;36:*.oga=00;36:*.opus=00;36:*.spx=00;36:*.xspf=00;36:', 'LD_LIBRARY_PATH': '/opt/crashrepair/lib:/CrashRepair/lib:/klee/build/lib:', 'CONDA_EXE': '/root/anaconda3/bin/conda', 'LANG': 'C.UTF-8', 'TZ': 'Asia/Shanghai', 'HOSTNAME': 'fea22102047d', 'OLDPWD': '/orchestrator', 'CONDA_PREFIX': '/root/anaconda3/envs/CrashRepair', '_CE_M': '', 'CC': 'crepair-cc', 'LLVM_COMPILER': 'clang', 'CONDA_PREFIX_1': '/root/anaconda3', 'PWD': '/orchestrator/crashrepair', 'HOME': '/root', 'CONDA_PYTHON_EXE': '/root/anaconda3/bin/python', '_CE_CONDA': '', 'CONDA_PROMPT_MODIFIER': '(CrashRepair) ', 'CXX': 'crepair-cxx', 'TERM': 'xterm', 'SHLVL': '2', 'PYTHONPATH': '/usr/lib/python3.8/site-packages:', 'PATH': '/root/anaconda3/envs/CrashRepair/bin:/root/anaconda3/condabin:~/anaconda3/bin:/opt/crashrepair/bin:/CrashRepair/compiler:/klee/build/bin:/opt/llvm-6/bin:/klee/build/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', 'CONDA_DEFAULT_ENV': 'CrashRepair', '_': '/root/anaconda3/envs/CrashRepair/bin/python'})
2025-02-05 21:10:47.198 | DEBUG    | scenario:rebuild:398 - using environment: {'INJECT_CFLAGS': '-g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy ', 'INJECT_CXXFLAGS': '-g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy ', 'INJECT_LDFLAGS': '-g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy '}
2025-02-05 21:10:47.198 | DEBUG    | shell:__call__:41 - executing: make CFLAGS="-fsanitize=float-cast-overflow ${INJECT_CFLAGS}" CXXFLAGS="-fsanitize=float-cast-overflow ${INJECT_CXXFLAGS}" LDFLAGS="${INJECT_LDFLAGS}"
Making all in port
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/port'
make[1]: Nothing to be done for 'all'.
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/port'
Making all in libtiff
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/libtiff'
make  all-am
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/libtiff'
/bin/bash ../libtool  --tag=CC   --mode=compile crepair-cc -DHAVE_CONFIG_H -I.     -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -MT tif_dirwrite.lo -MD -MP -MF .deps/tif_dirwrite.Tpo -c -o tif_dirwrite.lo tif_dirwrite.c
libtool: compile:  crepair-cc -DHAVE_CONFIG_H -I. -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -MT tif_dirwrite.lo -MD -MP -MF .deps/tif_dirwrite.Tpo -c tif_dirwrite.c -o tif_dirwrite.o
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
mv -f .deps/tif_dirwrite.Tpo .deps/tif_dirwrite.Plo
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -no-undefined -version-info 7:5:2   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o libtiff.la -rpath /usr/local/lib tif_aux.lo tif_close.lo tif_codec.lo tif_color.lo tif_compress.lo tif_dir.lo tif_dirinfo.lo tif_dirread.lo tif_dirwrite.lo tif_dumpmode.lo tif_error.lo tif_extension.lo tif_fax3.lo tif_fax3sm.lo tif_flush.lo tif_getimage.lo tif_jbig.lo tif_jpeg.lo tif_jpeg_12.lo tif_luv.lo tif_lzma.lo tif_lzw.lo tif_next.lo tif_ojpeg.lo tif_open.lo tif_packbits.lo tif_pixarlog.lo tif_predict.lo tif_print.lo tif_read.lo tif_strip.lo tif_swab.lo tif_thunder.lo tif_tile.lo tif_version.lo tif_warning.lo tif_write.lo tif_zip.lo  tif_unix.lo ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: rm -fr  .libs/libtiff.a .libs/libtiff.la .libs/libtiff.lai
libtool: link: (cd .libs/libtiff.lax/libport.a && ar x "/data/vulnloc/libtiff/CVE-2017-7600/src/libtiff/../port/.libs/libport.a")
libtool: link: ar cru .libs/libtiff.a  tif_aux.o tif_close.o tif_codec.o tif_color.o tif_compress.o tif_dir.o tif_dirinfo.o tif_dirread.o tif_dirwrite.o tif_dumpmode.o tif_error.o tif_extension.o tif_fax3.o tif_fax3sm.o tif_flush.o tif_getimage.o tif_jbig.o tif_jpeg.o tif_jpeg_12.o tif_luv.o tif_lzma.o tif_lzw.o tif_next.o tif_ojpeg.o tif_open.o tif_packbits.o tif_pixarlog.o tif_predict.o tif_print.o tif_read.o tif_strip.o tif_swab.o tif_thunder.o tif_tile.o tif_version.o tif_warning.o tif_write.o tif_zip.o tif_unix.o  .libs/libtiff.lax/libport.a/dummy.o 
ar: `u' modifier ignored since `D' is the default (see `U')
libtool: link: ranlib .libs/libtiff.a
libtool: link: rm -fr .libs/libtiff.lax
libtool: link: ( cd ".libs" && rm -f "libtiff.la" && ln -s "../libtiff.la" "libtiff.la" )
/bin/bash ../libtool  --tag=CXX   --mode=link crepair-cxx  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -no-undefined -version-info 7:5:2   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o libtiffxx.la -rpath /usr/local/lib tif_stream.lo ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: rm -fr  .libs/libtiffxx.a .libs/libtiffxx.la .libs/libtiffxx.lai
libtool: link: (cd .libs/libtiffxx.lax/libport.a && ar x "/data/vulnloc/libtiff/CVE-2017-7600/src/libtiff/../port/.libs/libport.a")
libtool: link: ar cru .libs/libtiffxx.a  tif_stream.o  .libs/libtiffxx.lax/libport.a/dummy.o 
ar: `u' modifier ignored since `D' is the default (see `U')
libtool: link: ranlib .libs/libtiffxx.a
libtool: link: rm -fr .libs/libtiffxx.lax
libtool: link: ( cd ".libs" && rm -f "libtiffxx.la" && ln -s "../libtiffxx.la" "libtiffxx.la" )
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/libtiff'
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/libtiff'
Making all in tools
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/tools'
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o bmp2tiff bmp2tiff.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o bmp2tiff bmp2tiff.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o fax2ps fax2ps.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o fax2ps fax2ps.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o fax2tiff fax2tiff.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o fax2tiff fax2tiff.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o gif2tiff gif2tiff.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o gif2tiff gif2tiff.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o pal2rgb pal2rgb.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o pal2rgb pal2rgb.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o ppm2tiff ppm2tiff.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o ppm2tiff ppm2tiff.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o ras2tiff ras2tiff.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o ras2tiff ras2tiff.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o raw2tiff raw2tiff.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o raw2tiff raw2tiff.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o rgb2ycbcr rgb2ycbcr.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o rgb2ycbcr rgb2ycbcr.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o thumbnail thumbnail.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o thumbnail thumbnail.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o tiff2bw tiff2bw.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o tiff2bw tiff2bw.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o tiff2pdf tiff2pdf.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o tiff2pdf tiff2pdf.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o tiff2ps tiff2ps.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o tiff2ps tiff2ps.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o tiff2rgba tiff2rgba.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o tiff2rgba tiff2rgba.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o tiffcmp tiffcmp.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o tiffcmp tiffcmp.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o tiffcp tiffcp.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o tiffcp tiffcp.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o tiffcrop tiffcrop.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o tiffcrop tiffcrop.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o tiffdither tiffdither.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o tiffdither tiffdither.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o tiffdump tiffdump.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o tiffdump tiffdump.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o tiffinfo tiffinfo.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o tiffinfo tiffinfo.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o tiffmedian tiffmedian.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o tiffmedian tiffmedian.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o tiffset tiffset.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o tiffset tiffset.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o tiffsplit tiffsplit.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o tiffsplit tiffsplit.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/tools'
Making all in build
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/build'
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/build'
make[2]: Nothing to be done for 'all-am'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/build'
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/build'
Making all in contrib
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib'
Making all in addtiffo
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/addtiffo'
/bin/bash ../../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o addtiffo addtiffo.o tif_overview.o tif_ovrcache.o ../../libtiff/libtiff.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o addtiffo addtiffo.o tif_overview.o tif_ovrcache.o  -L/klee/build/lib -L/CrashRepair/lib ../../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy -llzma -ljbig -ljpeg -lz -lm
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/addtiffo'
Making all in dbs
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/dbs'
Making all in xtiff
make[3]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/dbs/xtiff'
make[3]: Nothing to be done for 'all'.
make[3]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/dbs/xtiff'
make[3]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/dbs'
/bin/bash ../../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o tiff-bi tiff-bi.o ../../libtiff/libtiff.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o tiff-bi tiff-bi.o  -L/klee/build/lib -L/CrashRepair/lib ../../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o tiff-grayscale tiff-grayscale.o ../../libtiff/libtiff.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o tiff-grayscale tiff-grayscale.o  -L/klee/build/lib -L/CrashRepair/lib ../../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o tiff-palette tiff-palette.o ../../libtiff/libtiff.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o tiff-palette tiff-palette.o  -L/klee/build/lib -L/CrashRepair/lib ../../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o tiff-rgb tiff-rgb.o ../../libtiff/libtiff.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o tiff-rgb tiff-rgb.o  -L/klee/build/lib -L/CrashRepair/lib ../../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy -llzma -ljbig -ljpeg -lz -lm
make[3]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/dbs'
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/dbs'
Making all in iptcutil
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/iptcutil'
/bin/bash ../../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o iptcutil iptcutil.o ../../libtiff/libtiff.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o iptcutil iptcutil.o  -L/klee/build/lib -L/CrashRepair/lib ../../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy -llzma -ljbig -ljpeg -lz -lm
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/iptcutil'
Making all in mfs
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/mfs'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/mfs'
Making all in pds
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/pds'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/pds'
Making all in ras
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/ras'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/ras'
Making all in stream
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/stream'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/stream'
Making all in tags
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/tags'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/tags'
Making all in win_dib
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/win_dib'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/win_dib'
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib'
make[2]: Nothing to be done for 'all-am'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib'
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib'
Making all in test
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/test'
make[1]: Nothing to be done for 'all'.
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/test'
Making all in man
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/man'
make[1]: Nothing to be done for 'all'.
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/man'
Making all in html
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/html'
Making all in images
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/html/images'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/html/images'
Making all in man
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/html/man'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/html/man'
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/html'
make[2]: Nothing to be done for 'all-am'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/html'
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/html'
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src'
make[1]: Nothing to be done for 'all-am'.
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src'
2025-02-05 21:10:51.570 | DEBUG    | scenario:evaluate:655 - testing candidate #18 against test #crash...
2025-02-05 21:10:51.570 | DEBUG    | shell:__call__:41 - executing: /data/vulnloc/libtiff/CVE-2017-7600/src/tools/tiffcp -i /CrashRepair/experiments/vulnloc/libtiff/CVE-2017-7600/tests/1.tif out.tiff
2025-02-05 21:10:51.574 | DEBUG    | test:run:172 - test failed: stderr contains bad output substring (runtime error: -115 is outside the range of representable values)
2025-02-05 21:10:51.574 | INFO     | scenario:evaluate:662 - candidate #18 fails test #crash
2025-02-05 21:10:51.584 | INFO     | scenario:evaluate:635 - evaluating candidate patch #19:
@@ -939,6 +939,7 @@
 	return(0);
 }
 
+
 static int
 TIFFWriteDirectoryTagSampleformatArray(TIFF* tif, uint32* ndir, TIFFDirEntry* dir, uint16 tag, uint32 count, double* value)
 {
@@ -946,7 +947,12 @@
 	void* conv;
 	uint32 i;
 	int ok;
-	conv = _TIFFmalloc(count*sizeof(double));
+	
+	if (count == 0) {
+		return 0; // Prevent processing when count is zero
+	}
+	
+	conv = _TIFFmalloc(count * sizeof(double));
 	if (conv == NULL)
 	{
 		TIFFErrorExt(tif->tif_clientdata, module, "Out of memory");
@@ -956,55 +962,55 @@
 	switch (tif->tif_dir.td_sampleformat)
 	{
 		case SAMPLEFORMAT_IEEEFP:
-			if (tif->tif_dir.td_bitspersample<=32)
+			if (tif->tif_dir.td_bitspersample <= 32)
 			{
 				for (i = 0; i < count; ++i)
 					((float*)conv)[i] = (float)value[i];
-				ok = TIFFWriteDirectoryTagFloatArray(tif,ndir,dir,tag,count,(float*)conv);
+				ok = TIFFWriteDirectoryTagFloatArray(tif, ndir, dir, tag, count, (float*)conv);
 			}
 			else
 			{
-				ok = TIFFWriteDirectoryTagDoubleArray(tif,ndir,dir,tag,count,value);
+				ok = TIFFWriteDirectoryTagDoubleArray(tif, ndir, dir, tag, count, value);
 			}
 			break;
 		case SAMPLEFORMAT_INT:
-			if (tif->tif_dir.td_bitspersample<=8)
+			if (tif->tif_dir.td_bitspersample <= 8)
 			{
 				for (i = 0; i < count; ++i)
 					((int8*)conv)[i] = (int8)value[i];
-				ok = TIFFWriteDirectoryTagSbyteArray(tif,ndir,dir,tag,count,(int8*)conv);
+				ok = TIFFWriteDirectoryTagSbyteArray(tif, ndir, dir, tag, count, (int8*)conv);
 			}
-			else if (tif->tif_dir.td_bitspersample<=16)
+			else if (tif->tif_dir.td_bitspersample <= 16)
 			{
 				for (i = 0; i < count; ++i)
 					((int16*)conv)[i] = (int16)value[i];
-				ok = TIFFWriteDirectoryTagSshortArray(tif,ndir,dir,tag,count,(int16*)conv);
+				ok = TIFFWriteDirectoryTagSshortArray(tif, ndir, dir, tag, count, (int16*)conv);
 			}
 			else
 			{
 				for (i = 0; i < count; ++i)
 					((int32*)conv)[i] = (int32)value[i];
-				ok = TIFFWriteDirectoryTagSlongArray(tif,ndir,dir,tag,count,(int32*)conv);
+				ok = TIFFWriteDirectoryTagSlongArray(tif, ndir, dir, tag, count, (int32*)conv);
 			}
 			break;
 		case SAMPLEFORMAT_UINT:
-			if (tif->tif_dir.td_bitspersample<=8)
+			if (tif->tif_dir.td_bitspersample <= 8)
 			{
 				for (i = 0; i < count; ++i)
 					((uint8*)conv)[i] = (uint8)value[i];
-				ok = TIFFWriteDirectoryTagByteArray(tif,ndir,dir,tag,count,(uint8*)conv);
+				ok = TIFFWriteDirectoryTagByteArray(tif, ndir, dir, tag, count, (uint8*)conv);
 			}
-			else if (tif->tif_dir.td_bitspersample<=16)
+			else if (tif->tif_dir.td_bitspersample <= 16)
 			{
 				for (i = 0; i < count; ++i)
 					((uint16*)conv)[i] = (uint16)value[i];
-				ok = TIFFWriteDirectoryTagShortArray(tif,ndir,dir,tag,count,(uint16*)conv);
+				ok = TIFFWriteDirectoryTagShortArray(tif, ndir, dir, tag, count, (uint16*)conv);
 			}
 			else
 			{
 				for (i = 0; i < count; ++i)
 					((uint32*)conv)[i] = (uint32)value[i];
-				ok = TIFFWriteDirectoryTagLongArray(tif,ndir,dir,tag,count,(uint32*)conv);
+				ok = TIFFWriteDirectoryTagLongArray(tif, ndir, dir, tag, count, (uint32*)conv);
 			}
 			break;
 		default:
@@ -1015,6 +1021,7 @@
 	return (ok);
 }
 
+
 #if 0
 static int
 TIFFWriteDirectoryTagSampleformatPerSample(TIFF* tif, uint32* ndir, TIFFDirEntry* dir, uint16 tag, double value)

2025-02-05 21:10:51.589 | DEBUG    | scenario:rebuild:369 - original environment: environ({'CONDA_SHLVL': '2', 'LC_ALL': 'C.UTF-8', 'LS_COLORS': 'rs=0:di=01;34:ln=01;36:mh=00:pi=40;33:so=01;35:do=01;35:bd=40;33;01:cd=40;33;01:or=40;31;01:mi=00:su=37;41:sg=30;43:ca=30;41:tw=30;42:ow=34;42:st=37;44:ex=01;32:*.tar=01;31:*.tgz=01;31:*.arc=01;31:*.arj=01;31:*.taz=01;31:*.lha=01;31:*.lz4=01;31:*.lzh=01;31:*.lzma=01;31:*.tlz=01;31:*.txz=01;31:*.tzo=01;31:*.t7z=01;31:*.zip=01;31:*.z=01;31:*.Z=01;31:*.dz=01;31:*.gz=01;31:*.lrz=01;31:*.lz=01;31:*.lzo=01;31:*.xz=01;31:*.zst=01;31:*.tzst=01;31:*.bz2=01;31:*.bz=01;31:*.tbz=01;31:*.tbz2=01;31:*.tz=01;31:*.deb=01;31:*.rpm=01;31:*.jar=01;31:*.war=01;31:*.ear=01;31:*.sar=01;31:*.rar=01;31:*.alz=01;31:*.ace=01;31:*.zoo=01;31:*.cpio=01;31:*.7z=01;31:*.rz=01;31:*.cab=01;31:*.wim=01;31:*.swm=01;31:*.dwm=01;31:*.esd=01;31:*.jpg=01;35:*.jpeg=01;35:*.mjpg=01;35:*.mjpeg=01;35:*.gif=01;35:*.bmp=01;35:*.pbm=01;35:*.pgm=01;35:*.ppm=01;35:*.tga=01;35:*.xbm=01;35:*.xpm=01;35:*.tif=01;35:*.tiff=01;35:*.png=01;35:*.svg=01;35:*.svgz=01;35:*.mng=01;35:*.pcx=01;35:*.mov=01;35:*.mpg=01;35:*.mpeg=01;35:*.m2v=01;35:*.mkv=01;35:*.webm=01;35:*.ogm=01;35:*.mp4=01;35:*.m4v=01;35:*.mp4v=01;35:*.vob=01;35:*.qt=01;35:*.nuv=01;35:*.wmv=01;35:*.asf=01;35:*.rm=01;35:*.rmvb=01;35:*.flc=01;35:*.avi=01;35:*.fli=01;35:*.flv=01;35:*.gl=01;35:*.dl=01;35:*.xcf=01;35:*.xwd=01;35:*.yuv=01;35:*.cgm=01;35:*.emf=01;35:*.ogv=01;35:*.ogx=01;35:*.aac=00;36:*.au=00;36:*.flac=00;36:*.m4a=00;36:*.mid=00;36:*.midi=00;36:*.mka=00;36:*.mp3=00;36:*.mpc=00;36:*.ogg=00;36:*.ra=00;36:*.wav=00;36:*.oga=00;36:*.opus=00;36:*.spx=00;36:*.xspf=00;36:', 'LD_LIBRARY_PATH': '/opt/crashrepair/lib:/CrashRepair/lib:/klee/build/lib:', 'CONDA_EXE': '/root/anaconda3/bin/conda', 'LANG': 'C.UTF-8', 'TZ': 'Asia/Shanghai', 'HOSTNAME': 'fea22102047d', 'OLDPWD': '/orchestrator', 'CONDA_PREFIX': '/root/anaconda3/envs/CrashRepair', '_CE_M': '', 'CC': 'crepair-cc', 'LLVM_COMPILER': 'clang', 'CONDA_PREFIX_1': '/root/anaconda3', 'PWD': '/orchestrator/crashrepair', 'HOME': '/root', 'CONDA_PYTHON_EXE': '/root/anaconda3/bin/python', '_CE_CONDA': '', 'CONDA_PROMPT_MODIFIER': '(CrashRepair) ', 'CXX': 'crepair-cxx', 'TERM': 'xterm', 'SHLVL': '2', 'PYTHONPATH': '/usr/lib/python3.8/site-packages:', 'PATH': '/root/anaconda3/envs/CrashRepair/bin:/root/anaconda3/condabin:~/anaconda3/bin:/opt/crashrepair/bin:/CrashRepair/compiler:/klee/build/bin:/opt/llvm-6/bin:/klee/build/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', 'CONDA_DEFAULT_ENV': 'CrashRepair', '_': '/root/anaconda3/envs/CrashRepair/bin/python'})
2025-02-05 21:10:51.589 | DEBUG    | scenario:rebuild:398 - using environment: {'INJECT_CFLAGS': '-g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy ', 'INJECT_CXXFLAGS': '-g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy ', 'INJECT_LDFLAGS': '-g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy '}
2025-02-05 21:10:51.589 | DEBUG    | shell:__call__:41 - executing: make CFLAGS="-fsanitize=float-cast-overflow ${INJECT_CFLAGS}" CXXFLAGS="-fsanitize=float-cast-overflow ${INJECT_CXXFLAGS}" LDFLAGS="${INJECT_LDFLAGS}"
Making all in port
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/port'
make[1]: Nothing to be done for 'all'.
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/port'
Making all in libtiff
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/libtiff'
make  all-am
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/libtiff'
/bin/bash ../libtool  --tag=CC   --mode=compile crepair-cc -DHAVE_CONFIG_H -I.     -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -MT tif_dirwrite.lo -MD -MP -MF .deps/tif_dirwrite.Tpo -c -o tif_dirwrite.lo tif_dirwrite.c
libtool: compile:  crepair-cc -DHAVE_CONFIG_H -I. -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -MT tif_dirwrite.lo -MD -MP -MF .deps/tif_dirwrite.Tpo -c tif_dirwrite.c -o tif_dirwrite.o
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
mv -f .deps/tif_dirwrite.Tpo .deps/tif_dirwrite.Plo
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -no-undefined -version-info 7:5:2   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o libtiff.la -rpath /usr/local/lib tif_aux.lo tif_close.lo tif_codec.lo tif_color.lo tif_compress.lo tif_dir.lo tif_dirinfo.lo tif_dirread.lo tif_dirwrite.lo tif_dumpmode.lo tif_error.lo tif_extension.lo tif_fax3.lo tif_fax3sm.lo tif_flush.lo tif_getimage.lo tif_jbig.lo tif_jpeg.lo tif_jpeg_12.lo tif_luv.lo tif_lzma.lo tif_lzw.lo tif_next.lo tif_ojpeg.lo tif_open.lo tif_packbits.lo tif_pixarlog.lo tif_predict.lo tif_print.lo tif_read.lo tif_strip.lo tif_swab.lo tif_thunder.lo tif_tile.lo tif_version.lo tif_warning.lo tif_write.lo tif_zip.lo  tif_unix.lo ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: rm -fr  .libs/libtiff.a .libs/libtiff.la .libs/libtiff.lai
libtool: link: (cd .libs/libtiff.lax/libport.a && ar x "/data/vulnloc/libtiff/CVE-2017-7600/src/libtiff/../port/.libs/libport.a")
libtool: link: ar cru .libs/libtiff.a  tif_aux.o tif_close.o tif_codec.o tif_color.o tif_compress.o tif_dir.o tif_dirinfo.o tif_dirread.o tif_dirwrite.o tif_dumpmode.o tif_error.o tif_extension.o tif_fax3.o tif_fax3sm.o tif_flush.o tif_getimage.o tif_jbig.o tif_jpeg.o tif_jpeg_12.o tif_luv.o tif_lzma.o tif_lzw.o tif_next.o tif_ojpeg.o tif_open.o tif_packbits.o tif_pixarlog.o tif_predict.o tif_print.o tif_read.o tif_strip.o tif_swab.o tif_thunder.o tif_tile.o tif_version.o tif_warning.o tif_write.o tif_zip.o tif_unix.o  .libs/libtiff.lax/libport.a/dummy.o 
ar: `u' modifier ignored since `D' is the default (see `U')
libtool: link: ranlib .libs/libtiff.a
libtool: link: rm -fr .libs/libtiff.lax
libtool: link: ( cd ".libs" && rm -f "libtiff.la" && ln -s "../libtiff.la" "libtiff.la" )
/bin/bash ../libtool  --tag=CXX   --mode=link crepair-cxx  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -no-undefined -version-info 7:5:2   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o libtiffxx.la -rpath /usr/local/lib tif_stream.lo ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: rm -fr  .libs/libtiffxx.a .libs/libtiffxx.la .libs/libtiffxx.lai
libtool: link: (cd .libs/libtiffxx.lax/libport.a && ar x "/data/vulnloc/libtiff/CVE-2017-7600/src/libtiff/../port/.libs/libport.a")
libtool: link: ar cru .libs/libtiffxx.a  tif_stream.o  .libs/libtiffxx.lax/libport.a/dummy.o 
ar: `u' modifier ignored since `D' is the default (see `U')
libtool: link: ranlib .libs/libtiffxx.a
libtool: link: rm -fr .libs/libtiffxx.lax
libtool: link: ( cd ".libs" && rm -f "libtiffxx.la" && ln -s "../libtiffxx.la" "libtiffxx.la" )
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/libtiff'
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/libtiff'
Making all in tools
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/tools'
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o bmp2tiff bmp2tiff.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o bmp2tiff bmp2tiff.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o fax2ps fax2ps.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o fax2ps fax2ps.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o fax2tiff fax2tiff.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o fax2tiff fax2tiff.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o gif2tiff gif2tiff.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o gif2tiff gif2tiff.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o pal2rgb pal2rgb.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o pal2rgb pal2rgb.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o ppm2tiff ppm2tiff.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o ppm2tiff ppm2tiff.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o ras2tiff ras2tiff.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o ras2tiff ras2tiff.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o raw2tiff raw2tiff.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o raw2tiff raw2tiff.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o rgb2ycbcr rgb2ycbcr.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o rgb2ycbcr rgb2ycbcr.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o thumbnail thumbnail.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o thumbnail thumbnail.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o tiff2bw tiff2bw.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o tiff2bw tiff2bw.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o tiff2pdf tiff2pdf.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o tiff2pdf tiff2pdf.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o tiff2ps tiff2ps.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o tiff2ps tiff2ps.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o tiff2rgba tiff2rgba.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o tiff2rgba tiff2rgba.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o tiffcmp tiffcmp.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o tiffcmp tiffcmp.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o tiffcp tiffcp.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o tiffcp tiffcp.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o tiffcrop tiffcrop.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o tiffcrop tiffcrop.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o tiffdither tiffdither.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o tiffdither tiffdither.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o tiffdump tiffdump.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o tiffdump tiffdump.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o tiffinfo tiffinfo.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o tiffinfo tiffinfo.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o tiffmedian tiffmedian.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o tiffmedian tiffmedian.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o tiffset tiffset.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o tiffset tiffset.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o tiffsplit tiffsplit.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o tiffsplit tiffsplit.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/tools'
Making all in build
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/build'
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/build'
make[2]: Nothing to be done for 'all-am'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/build'
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/build'
Making all in contrib
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib'
Making all in addtiffo
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/addtiffo'
/bin/bash ../../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o addtiffo addtiffo.o tif_overview.o tif_ovrcache.o ../../libtiff/libtiff.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o addtiffo addtiffo.o tif_overview.o tif_ovrcache.o  -L/klee/build/lib -L/CrashRepair/lib ../../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy -llzma -ljbig -ljpeg -lz -lm
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/addtiffo'
Making all in dbs
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/dbs'
Making all in xtiff
make[3]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/dbs/xtiff'
make[3]: Nothing to be done for 'all'.
make[3]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/dbs/xtiff'
make[3]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/dbs'
/bin/bash ../../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o tiff-bi tiff-bi.o ../../libtiff/libtiff.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o tiff-bi tiff-bi.o  -L/klee/build/lib -L/CrashRepair/lib ../../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o tiff-grayscale tiff-grayscale.o ../../libtiff/libtiff.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o tiff-grayscale tiff-grayscale.o  -L/klee/build/lib -L/CrashRepair/lib ../../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o tiff-palette tiff-palette.o ../../libtiff/libtiff.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o tiff-palette tiff-palette.o  -L/klee/build/lib -L/CrashRepair/lib ../../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o tiff-rgb tiff-rgb.o ../../libtiff/libtiff.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o tiff-rgb tiff-rgb.o  -L/klee/build/lib -L/CrashRepair/lib ../../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy -llzma -ljbig -ljpeg -lz -lm
make[3]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/dbs'
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/dbs'
Making all in iptcutil
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/iptcutil'
/bin/bash ../../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o iptcutil iptcutil.o ../../libtiff/libtiff.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o iptcutil iptcutil.o  -L/klee/build/lib -L/CrashRepair/lib ../../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy -llzma -ljbig -ljpeg -lz -lm
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/iptcutil'
Making all in mfs
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/mfs'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/mfs'
Making all in pds
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/pds'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/pds'
Making all in ras
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/ras'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/ras'
Making all in stream
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/stream'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/stream'
Making all in tags
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/tags'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/tags'
Making all in win_dib
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/win_dib'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/win_dib'
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib'
make[2]: Nothing to be done for 'all-am'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib'
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib'
Making all in test
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/test'
make[1]: Nothing to be done for 'all'.
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/test'
Making all in man
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/man'
make[1]: Nothing to be done for 'all'.
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/man'
Making all in html
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/html'
Making all in images
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/html/images'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/html/images'
Making all in man
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/html/man'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/html/man'
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/html'
make[2]: Nothing to be done for 'all-am'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/html'
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/html'
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src'
make[1]: Nothing to be done for 'all-am'.
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src'
2025-02-05 21:10:56.034 | DEBUG    | scenario:evaluate:655 - testing candidate #19 against test #crash...
2025-02-05 21:10:56.034 | DEBUG    | shell:__call__:41 - executing: /data/vulnloc/libtiff/CVE-2017-7600/src/tools/tiffcp -i /CrashRepair/experiments/vulnloc/libtiff/CVE-2017-7600/tests/1.tif out.tiff
2025-02-05 21:10:56.038 | DEBUG    | test:run:172 - test failed: stderr contains bad output substring (runtime error: -115 is outside the range of representable values)
2025-02-05 21:10:56.038 | INFO     | scenario:evaluate:662 - candidate #19 fails test #crash
2025-02-05 21:10:56.048 | INFO     | scenario:evaluate:635 - evaluating candidate patch #20:
@@ -939,6 +939,7 @@
 	return(0);
 }
 
+
 static int
 TIFFWriteDirectoryTagSampleformatArray(TIFF* tif, uint32* ndir, TIFFDirEntry* dir, uint16 tag, uint32 count, double* value)
 {
@@ -953,6 +954,12 @@
 		return (0);
 	}
 
+	if (tif->tif_dir.td_bitspersample == 0) {
+		_TIFFfree(conv);
+		TIFFErrorExt(tif->tif_clientdata, module, "Invalid bits per sample");
+		return (0);
+	}
+
 	switch (tif->tif_dir.td_sampleformat)
 	{
 		case SAMPLEFORMAT_IEEEFP:
@@ -1015,6 +1022,7 @@
 	return (ok);
 }
 
+
 #if 0
 static int
 TIFFWriteDirectoryTagSampleformatPerSample(TIFF* tif, uint32* ndir, TIFFDirEntry* dir, uint16 tag, double value)

2025-02-05 21:10:56.053 | DEBUG    | scenario:rebuild:369 - original environment: environ({'CONDA_SHLVL': '2', 'LC_ALL': 'C.UTF-8', 'LS_COLORS': 'rs=0:di=01;34:ln=01;36:mh=00:pi=40;33:so=01;35:do=01;35:bd=40;33;01:cd=40;33;01:or=40;31;01:mi=00:su=37;41:sg=30;43:ca=30;41:tw=30;42:ow=34;42:st=37;44:ex=01;32:*.tar=01;31:*.tgz=01;31:*.arc=01;31:*.arj=01;31:*.taz=01;31:*.lha=01;31:*.lz4=01;31:*.lzh=01;31:*.lzma=01;31:*.tlz=01;31:*.txz=01;31:*.tzo=01;31:*.t7z=01;31:*.zip=01;31:*.z=01;31:*.Z=01;31:*.dz=01;31:*.gz=01;31:*.lrz=01;31:*.lz=01;31:*.lzo=01;31:*.xz=01;31:*.zst=01;31:*.tzst=01;31:*.bz2=01;31:*.bz=01;31:*.tbz=01;31:*.tbz2=01;31:*.tz=01;31:*.deb=01;31:*.rpm=01;31:*.jar=01;31:*.war=01;31:*.ear=01;31:*.sar=01;31:*.rar=01;31:*.alz=01;31:*.ace=01;31:*.zoo=01;31:*.cpio=01;31:*.7z=01;31:*.rz=01;31:*.cab=01;31:*.wim=01;31:*.swm=01;31:*.dwm=01;31:*.esd=01;31:*.jpg=01;35:*.jpeg=01;35:*.mjpg=01;35:*.mjpeg=01;35:*.gif=01;35:*.bmp=01;35:*.pbm=01;35:*.pgm=01;35:*.ppm=01;35:*.tga=01;35:*.xbm=01;35:*.xpm=01;35:*.tif=01;35:*.tiff=01;35:*.png=01;35:*.svg=01;35:*.svgz=01;35:*.mng=01;35:*.pcx=01;35:*.mov=01;35:*.mpg=01;35:*.mpeg=01;35:*.m2v=01;35:*.mkv=01;35:*.webm=01;35:*.ogm=01;35:*.mp4=01;35:*.m4v=01;35:*.mp4v=01;35:*.vob=01;35:*.qt=01;35:*.nuv=01;35:*.wmv=01;35:*.asf=01;35:*.rm=01;35:*.rmvb=01;35:*.flc=01;35:*.avi=01;35:*.fli=01;35:*.flv=01;35:*.gl=01;35:*.dl=01;35:*.xcf=01;35:*.xwd=01;35:*.yuv=01;35:*.cgm=01;35:*.emf=01;35:*.ogv=01;35:*.ogx=01;35:*.aac=00;36:*.au=00;36:*.flac=00;36:*.m4a=00;36:*.mid=00;36:*.midi=00;36:*.mka=00;36:*.mp3=00;36:*.mpc=00;36:*.ogg=00;36:*.ra=00;36:*.wav=00;36:*.oga=00;36:*.opus=00;36:*.spx=00;36:*.xspf=00;36:', 'LD_LIBRARY_PATH': '/opt/crashrepair/lib:/CrashRepair/lib:/klee/build/lib:', 'CONDA_EXE': '/root/anaconda3/bin/conda', 'LANG': 'C.UTF-8', 'TZ': 'Asia/Shanghai', 'HOSTNAME': 'fea22102047d', 'OLDPWD': '/orchestrator', 'CONDA_PREFIX': '/root/anaconda3/envs/CrashRepair', '_CE_M': '', 'CC': 'crepair-cc', 'LLVM_COMPILER': 'clang', 'CONDA_PREFIX_1': '/root/anaconda3', 'PWD': '/orchestrator/crashrepair', 'HOME': '/root', 'CONDA_PYTHON_EXE': '/root/anaconda3/bin/python', '_CE_CONDA': '', 'CONDA_PROMPT_MODIFIER': '(CrashRepair) ', 'CXX': 'crepair-cxx', 'TERM': 'xterm', 'SHLVL': '2', 'PYTHONPATH': '/usr/lib/python3.8/site-packages:', 'PATH': '/root/anaconda3/envs/CrashRepair/bin:/root/anaconda3/condabin:~/anaconda3/bin:/opt/crashrepair/bin:/CrashRepair/compiler:/klee/build/bin:/opt/llvm-6/bin:/klee/build/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', 'CONDA_DEFAULT_ENV': 'CrashRepair', '_': '/root/anaconda3/envs/CrashRepair/bin/python'})
2025-02-05 21:10:56.053 | DEBUG    | scenario:rebuild:398 - using environment: {'INJECT_CFLAGS': '-g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy ', 'INJECT_CXXFLAGS': '-g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy ', 'INJECT_LDFLAGS': '-g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy '}
2025-02-05 21:10:56.053 | DEBUG    | shell:__call__:41 - executing: make CFLAGS="-fsanitize=float-cast-overflow ${INJECT_CFLAGS}" CXXFLAGS="-fsanitize=float-cast-overflow ${INJECT_CXXFLAGS}" LDFLAGS="${INJECT_LDFLAGS}"
Making all in port
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/port'
make[1]: Nothing to be done for 'all'.
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/port'
Making all in libtiff
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/libtiff'
make  all-am
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/libtiff'
/bin/bash ../libtool  --tag=CC   --mode=compile crepair-cc -DHAVE_CONFIG_H -I.     -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -MT tif_dirwrite.lo -MD -MP -MF .deps/tif_dirwrite.Tpo -c -o tif_dirwrite.lo tif_dirwrite.c
libtool: compile:  crepair-cc -DHAVE_CONFIG_H -I. -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -MT tif_dirwrite.lo -MD -MP -MF .deps/tif_dirwrite.Tpo -c tif_dirwrite.c -o tif_dirwrite.o
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
mv -f .deps/tif_dirwrite.Tpo .deps/tif_dirwrite.Plo
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -no-undefined -version-info 7:5:2   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o libtiff.la -rpath /usr/local/lib tif_aux.lo tif_close.lo tif_codec.lo tif_color.lo tif_compress.lo tif_dir.lo tif_dirinfo.lo tif_dirread.lo tif_dirwrite.lo tif_dumpmode.lo tif_error.lo tif_extension.lo tif_fax3.lo tif_fax3sm.lo tif_flush.lo tif_getimage.lo tif_jbig.lo tif_jpeg.lo tif_jpeg_12.lo tif_luv.lo tif_lzma.lo tif_lzw.lo tif_next.lo tif_ojpeg.lo tif_open.lo tif_packbits.lo tif_pixarlog.lo tif_predict.lo tif_print.lo tif_read.lo tif_strip.lo tif_swab.lo tif_thunder.lo tif_tile.lo tif_version.lo tif_warning.lo tif_write.lo tif_zip.lo  tif_unix.lo ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: rm -fr  .libs/libtiff.a .libs/libtiff.la .libs/libtiff.lai
libtool: link: (cd .libs/libtiff.lax/libport.a && ar x "/data/vulnloc/libtiff/CVE-2017-7600/src/libtiff/../port/.libs/libport.a")
libtool: link: ar cru .libs/libtiff.a  tif_aux.o tif_close.o tif_codec.o tif_color.o tif_compress.o tif_dir.o tif_dirinfo.o tif_dirread.o tif_dirwrite.o tif_dumpmode.o tif_error.o tif_extension.o tif_fax3.o tif_fax3sm.o tif_flush.o tif_getimage.o tif_jbig.o tif_jpeg.o tif_jpeg_12.o tif_luv.o tif_lzma.o tif_lzw.o tif_next.o tif_ojpeg.o tif_open.o tif_packbits.o tif_pixarlog.o tif_predict.o tif_print.o tif_read.o tif_strip.o tif_swab.o tif_thunder.o tif_tile.o tif_version.o tif_warning.o tif_write.o tif_zip.o tif_unix.o  .libs/libtiff.lax/libport.a/dummy.o 
ar: `u' modifier ignored since `D' is the default (see `U')
libtool: link: ranlib .libs/libtiff.a
libtool: link: rm -fr .libs/libtiff.lax
libtool: link: ( cd ".libs" && rm -f "libtiff.la" && ln -s "../libtiff.la" "libtiff.la" )
/bin/bash ../libtool  --tag=CXX   --mode=link crepair-cxx  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -no-undefined -version-info 7:5:2   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o libtiffxx.la -rpath /usr/local/lib tif_stream.lo ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: rm -fr  .libs/libtiffxx.a .libs/libtiffxx.la .libs/libtiffxx.lai
libtool: link: (cd .libs/libtiffxx.lax/libport.a && ar x "/data/vulnloc/libtiff/CVE-2017-7600/src/libtiff/../port/.libs/libport.a")
libtool: link: ar cru .libs/libtiffxx.a  tif_stream.o  .libs/libtiffxx.lax/libport.a/dummy.o 
ar: `u' modifier ignored since `D' is the default (see `U')
libtool: link: ranlib .libs/libtiffxx.a
libtool: link: rm -fr .libs/libtiffxx.lax
libtool: link: ( cd ".libs" && rm -f "libtiffxx.la" && ln -s "../libtiffxx.la" "libtiffxx.la" )
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/libtiff'
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/libtiff'
Making all in tools
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/tools'
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o bmp2tiff bmp2tiff.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o bmp2tiff bmp2tiff.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o fax2ps fax2ps.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o fax2ps fax2ps.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o fax2tiff fax2tiff.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o fax2tiff fax2tiff.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o gif2tiff gif2tiff.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o gif2tiff gif2tiff.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o pal2rgb pal2rgb.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o pal2rgb pal2rgb.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o ppm2tiff ppm2tiff.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o ppm2tiff ppm2tiff.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o ras2tiff ras2tiff.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o ras2tiff ras2tiff.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o raw2tiff raw2tiff.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o raw2tiff raw2tiff.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o rgb2ycbcr rgb2ycbcr.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o rgb2ycbcr rgb2ycbcr.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o thumbnail thumbnail.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o thumbnail thumbnail.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o tiff2bw tiff2bw.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o tiff2bw tiff2bw.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o tiff2pdf tiff2pdf.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o tiff2pdf tiff2pdf.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o tiff2ps tiff2ps.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o tiff2ps tiff2ps.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o tiff2rgba tiff2rgba.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o tiff2rgba tiff2rgba.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o tiffcmp tiffcmp.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o tiffcmp tiffcmp.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o tiffcp tiffcp.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o tiffcp tiffcp.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o tiffcrop tiffcrop.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o tiffcrop tiffcrop.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o tiffdither tiffdither.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o tiffdither tiffdither.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o tiffdump tiffdump.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o tiffdump tiffdump.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o tiffinfo tiffinfo.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o tiffinfo tiffinfo.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o tiffmedian tiffmedian.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o tiffmedian tiffmedian.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o tiffset tiffset.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o tiffset tiffset.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o tiffsplit tiffsplit.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o tiffsplit tiffsplit.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/tools'
Making all in build
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/build'
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/build'
make[2]: Nothing to be done for 'all-am'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/build'
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/build'
Making all in contrib
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib'
Making all in addtiffo
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/addtiffo'
/bin/bash ../../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o addtiffo addtiffo.o tif_overview.o tif_ovrcache.o ../../libtiff/libtiff.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o addtiffo addtiffo.o tif_overview.o tif_ovrcache.o  -L/klee/build/lib -L/CrashRepair/lib ../../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy -llzma -ljbig -ljpeg -lz -lm
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/addtiffo'
Making all in dbs
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/dbs'
Making all in xtiff
make[3]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/dbs/xtiff'
make[3]: Nothing to be done for 'all'.
make[3]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/dbs/xtiff'
make[3]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/dbs'
/bin/bash ../../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o tiff-bi tiff-bi.o ../../libtiff/libtiff.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o tiff-bi tiff-bi.o  -L/klee/build/lib -L/CrashRepair/lib ../../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o tiff-grayscale tiff-grayscale.o ../../libtiff/libtiff.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o tiff-grayscale tiff-grayscale.o  -L/klee/build/lib -L/CrashRepair/lib ../../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o tiff-palette tiff-palette.o ../../libtiff/libtiff.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o tiff-palette tiff-palette.o  -L/klee/build/lib -L/CrashRepair/lib ../../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o tiff-rgb tiff-rgb.o ../../libtiff/libtiff.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o tiff-rgb tiff-rgb.o  -L/klee/build/lib -L/CrashRepair/lib ../../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy -llzma -ljbig -ljpeg -lz -lm
make[3]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/dbs'
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/dbs'
Making all in iptcutil
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/iptcutil'
/bin/bash ../../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o iptcutil iptcutil.o ../../libtiff/libtiff.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o iptcutil iptcutil.o  -L/klee/build/lib -L/CrashRepair/lib ../../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy -llzma -ljbig -ljpeg -lz -lm
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/iptcutil'
Making all in mfs
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/mfs'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/mfs'
Making all in pds
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/pds'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/pds'
Making all in ras
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/ras'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/ras'
Making all in stream
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/stream'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/stream'
Making all in tags
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/tags'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/tags'
Making all in win_dib
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/win_dib'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/win_dib'
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib'
make[2]: Nothing to be done for 'all-am'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib'
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib'
Making all in test
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/test'
make[1]: Nothing to be done for 'all'.
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/test'
Making all in man
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/man'
make[1]: Nothing to be done for 'all'.
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/man'
Making all in html
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/html'
Making all in images
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/html/images'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/html/images'
Making all in man
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/html/man'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/html/man'
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/html'
make[2]: Nothing to be done for 'all-am'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/html'
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/html'
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src'
make[1]: Nothing to be done for 'all-am'.
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src'
2025-02-05 21:11:00.628 | DEBUG    | scenario:evaluate:655 - testing candidate #20 against test #crash...
2025-02-05 21:11:00.629 | DEBUG    | shell:__call__:41 - executing: /data/vulnloc/libtiff/CVE-2017-7600/src/tools/tiffcp -i /CrashRepair/experiments/vulnloc/libtiff/CVE-2017-7600/tests/1.tif out.tiff
2025-02-05 21:11:00.633 | DEBUG    | test:run:172 - test failed: stderr contains bad output substring (runtime error: -115 is outside the range of representable values)
2025-02-05 21:11:00.633 | INFO     | scenario:evaluate:662 - candidate #20 fails test #crash
2025-02-05 21:11:00.642 | INFO     | scenario:evaluate:635 - evaluating candidate patch #21:
@@ -939,6 +939,7 @@
 	return(0);
 }
 
+
 static int
 TIFFWriteDirectoryTagSampleformatArray(TIFF* tif, uint32* ndir, TIFFDirEntry* dir, uint16 tag, uint32 count, double* value)
 {
@@ -946,65 +947,71 @@
 	void* conv;
 	uint32 i;
 	int ok;
-	conv = _TIFFmalloc(count*sizeof(double));
+	conv = _TIFFmalloc(count * sizeof(double));
 	if (conv == NULL)
 	{
 		TIFFErrorExt(tif->tif_clientdata, module, "Out of memory");
 		return (0);
 	}
 
+	if (count == 0) // Added check for count being zero
+	{
+		_TIFFfree(conv);
+		return (0); // Return early if there are no elements to process
+	}
+
 	switch (tif->tif_dir.td_sampleformat)
 	{
 		case SAMPLEFORMAT_IEEEFP:
-			if (tif->tif_dir.td_bitspersample<=32)
+			if (tif->tif_dir.td_bitspersample <= 32)
 			{
 				for (i = 0; i < count; ++i)
 					((float*)conv)[i] = (float)value[i];
-				ok = TIFFWriteDirectoryTagFloatArray(tif,ndir,dir,tag,count,(float*)conv);
+				ok = TIFFWriteDirectoryTagFloatArray(tif, ndir, dir, tag, count, (float*)conv);
 			}
 			else
 			{
-				ok = TIFFWriteDirectoryTagDoubleArray(tif,ndir,dir,tag,count,value);
+				ok = TIFFWriteDirectoryTagDoubleArray(tif, ndir, dir, tag, count, value);
 			}
 			break;
 		case SAMPLEFORMAT_INT:
-			if (tif->tif_dir.td_bitspersample<=8)
+			if (tif->tif_dir.td_bitspersample <= 8)
 			{
 				for (i = 0; i < count; ++i)
 					((int8*)conv)[i] = (int8)value[i];
-				ok = TIFFWriteDirectoryTagSbyteArray(tif,ndir,dir,tag,count,(int8*)conv);
+				ok = TIFFWriteDirectoryTagSbyteArray(tif, ndir, dir, tag, count, (int8*)conv);
 			}
-			else if (tif->tif_dir.td_bitspersample<=16)
+			else if (tif->tif_dir.td_bitspersample <= 16)
 			{
 				for (i = 0; i < count; ++i)
 					((int16*)conv)[i] = (int16)value[i];
-				ok = TIFFWriteDirectoryTagSshortArray(tif,ndir,dir,tag,count,(int16*)conv);
+				ok = TIFFWriteDirectoryTagSshortArray(tif, ndir, dir, tag, count, (int16*)conv);
 			}
 			else
 			{
 				for (i = 0; i < count; ++i)
 					((int32*)conv)[i] = (int32)value[i];
-				ok = TIFFWriteDirectoryTagSlongArray(tif,ndir,dir,tag,count,(int32*)conv);
+				ok = TIFFWriteDirectoryTagSlongArray(tif, ndir, dir, tag, count, (int32*)conv);
 			}
 			break;
 		case SAMPLEFORMAT_UINT:
-			if (tif->tif_dir.td_bitspersample<=8)
+			if (tif->tif_dir.td_bitspersample <= 8)
 			{
 				for (i = 0; i < count; ++i)
 					((uint8*)conv)[i] = (uint8)value[i];
-				ok = TIFFWriteDirectoryTagByteArray(tif,ndir,dir,tag,count,(uint8*)conv);
+				ok = TIFFWriteDirectoryTagByteArray(tif, ndir, dir, tag, count, (uint8*)conv);
 			}
-			else if (tif->tif_dir.td_bitspersample<=16)
+			else if (tif->tif_dir.td_bitspersample <= 16)
 			{
 				for (i = 0; i < count; ++i)
 					((uint16*)conv)[i] = (uint16)value[i];
-				ok = TIFFWriteDirectoryTagShortArray(tif,ndir,dir,tag,count,(uint16*)conv);
+				ok = TIFFWriteDirectoryTagShortArray(tif, ndir, dir, tag, count, (uint16*)conv);
 			}
 			else
 			{
 				for (i = 0; i < count; ++i)
 					((uint32*)conv)[i] = (uint32)value[i];
-				ok = TIFFWriteDirectoryTagLongArray(tif,ndir,dir,tag,count,(uint32*)conv);
+				ok = TIFFWriteDirectoryTagLongArray(tif, ndir, dir, tag, count, (uint32*)conv);
 			}
 			break;
 		default:
@@ -1015,6 +1022,7 @@
 	return (ok);
 }
 
+
 #if 0
 static int
 TIFFWriteDirectoryTagSampleformatPerSample(TIFF* tif, uint32* ndir, TIFFDirEntry* dir, uint16 tag, double value)

2025-02-05 21:11:00.648 | DEBUG    | scenario:rebuild:369 - original environment: environ({'CONDA_SHLVL': '2', 'LC_ALL': 'C.UTF-8', 'LS_COLORS': 'rs=0:di=01;34:ln=01;36:mh=00:pi=40;33:so=01;35:do=01;35:bd=40;33;01:cd=40;33;01:or=40;31;01:mi=00:su=37;41:sg=30;43:ca=30;41:tw=30;42:ow=34;42:st=37;44:ex=01;32:*.tar=01;31:*.tgz=01;31:*.arc=01;31:*.arj=01;31:*.taz=01;31:*.lha=01;31:*.lz4=01;31:*.lzh=01;31:*.lzma=01;31:*.tlz=01;31:*.txz=01;31:*.tzo=01;31:*.t7z=01;31:*.zip=01;31:*.z=01;31:*.Z=01;31:*.dz=01;31:*.gz=01;31:*.lrz=01;31:*.lz=01;31:*.lzo=01;31:*.xz=01;31:*.zst=01;31:*.tzst=01;31:*.bz2=01;31:*.bz=01;31:*.tbz=01;31:*.tbz2=01;31:*.tz=01;31:*.deb=01;31:*.rpm=01;31:*.jar=01;31:*.war=01;31:*.ear=01;31:*.sar=01;31:*.rar=01;31:*.alz=01;31:*.ace=01;31:*.zoo=01;31:*.cpio=01;31:*.7z=01;31:*.rz=01;31:*.cab=01;31:*.wim=01;31:*.swm=01;31:*.dwm=01;31:*.esd=01;31:*.jpg=01;35:*.jpeg=01;35:*.mjpg=01;35:*.mjpeg=01;35:*.gif=01;35:*.bmp=01;35:*.pbm=01;35:*.pgm=01;35:*.ppm=01;35:*.tga=01;35:*.xbm=01;35:*.xpm=01;35:*.tif=01;35:*.tiff=01;35:*.png=01;35:*.svg=01;35:*.svgz=01;35:*.mng=01;35:*.pcx=01;35:*.mov=01;35:*.mpg=01;35:*.mpeg=01;35:*.m2v=01;35:*.mkv=01;35:*.webm=01;35:*.ogm=01;35:*.mp4=01;35:*.m4v=01;35:*.mp4v=01;35:*.vob=01;35:*.qt=01;35:*.nuv=01;35:*.wmv=01;35:*.asf=01;35:*.rm=01;35:*.rmvb=01;35:*.flc=01;35:*.avi=01;35:*.fli=01;35:*.flv=01;35:*.gl=01;35:*.dl=01;35:*.xcf=01;35:*.xwd=01;35:*.yuv=01;35:*.cgm=01;35:*.emf=01;35:*.ogv=01;35:*.ogx=01;35:*.aac=00;36:*.au=00;36:*.flac=00;36:*.m4a=00;36:*.mid=00;36:*.midi=00;36:*.mka=00;36:*.mp3=00;36:*.mpc=00;36:*.ogg=00;36:*.ra=00;36:*.wav=00;36:*.oga=00;36:*.opus=00;36:*.spx=00;36:*.xspf=00;36:', 'LD_LIBRARY_PATH': '/opt/crashrepair/lib:/CrashRepair/lib:/klee/build/lib:', 'CONDA_EXE': '/root/anaconda3/bin/conda', 'LANG': 'C.UTF-8', 'TZ': 'Asia/Shanghai', 'HOSTNAME': 'fea22102047d', 'OLDPWD': '/orchestrator', 'CONDA_PREFIX': '/root/anaconda3/envs/CrashRepair', '_CE_M': '', 'CC': 'crepair-cc', 'LLVM_COMPILER': 'clang', 'CONDA_PREFIX_1': '/root/anaconda3', 'PWD': '/orchestrator/crashrepair', 'HOME': '/root', 'CONDA_PYTHON_EXE': '/root/anaconda3/bin/python', '_CE_CONDA': '', 'CONDA_PROMPT_MODIFIER': '(CrashRepair) ', 'CXX': 'crepair-cxx', 'TERM': 'xterm', 'SHLVL': '2', 'PYTHONPATH': '/usr/lib/python3.8/site-packages:', 'PATH': '/root/anaconda3/envs/CrashRepair/bin:/root/anaconda3/condabin:~/anaconda3/bin:/opt/crashrepair/bin:/CrashRepair/compiler:/klee/build/bin:/opt/llvm-6/bin:/klee/build/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', 'CONDA_DEFAULT_ENV': 'CrashRepair', '_': '/root/anaconda3/envs/CrashRepair/bin/python'})
2025-02-05 21:11:00.648 | DEBUG    | scenario:rebuild:398 - using environment: {'INJECT_CFLAGS': '-g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy ', 'INJECT_CXXFLAGS': '-g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy ', 'INJECT_LDFLAGS': '-g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy '}
2025-02-05 21:11:00.648 | DEBUG    | shell:__call__:41 - executing: make CFLAGS="-fsanitize=float-cast-overflow ${INJECT_CFLAGS}" CXXFLAGS="-fsanitize=float-cast-overflow ${INJECT_CXXFLAGS}" LDFLAGS="${INJECT_LDFLAGS}"
Making all in port
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/port'
make[1]: Nothing to be done for 'all'.
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/port'
Making all in libtiff
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/libtiff'
make  all-am
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/libtiff'
/bin/bash ../libtool  --tag=CC   --mode=compile crepair-cc -DHAVE_CONFIG_H -I.     -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -MT tif_dirwrite.lo -MD -MP -MF .deps/tif_dirwrite.Tpo -c -o tif_dirwrite.lo tif_dirwrite.c
libtool: compile:  crepair-cc -DHAVE_CONFIG_H -I. -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -MT tif_dirwrite.lo -MD -MP -MF .deps/tif_dirwrite.Tpo -c tif_dirwrite.c -o tif_dirwrite.o
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
mv -f .deps/tif_dirwrite.Tpo .deps/tif_dirwrite.Plo
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -no-undefined -version-info 7:5:2   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o libtiff.la -rpath /usr/local/lib tif_aux.lo tif_close.lo tif_codec.lo tif_color.lo tif_compress.lo tif_dir.lo tif_dirinfo.lo tif_dirread.lo tif_dirwrite.lo tif_dumpmode.lo tif_error.lo tif_extension.lo tif_fax3.lo tif_fax3sm.lo tif_flush.lo tif_getimage.lo tif_jbig.lo tif_jpeg.lo tif_jpeg_12.lo tif_luv.lo tif_lzma.lo tif_lzw.lo tif_next.lo tif_ojpeg.lo tif_open.lo tif_packbits.lo tif_pixarlog.lo tif_predict.lo tif_print.lo tif_read.lo tif_strip.lo tif_swab.lo tif_thunder.lo tif_tile.lo tif_version.lo tif_warning.lo tif_write.lo tif_zip.lo  tif_unix.lo ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: rm -fr  .libs/libtiff.a .libs/libtiff.la .libs/libtiff.lai
libtool: link: (cd .libs/libtiff.lax/libport.a && ar x "/data/vulnloc/libtiff/CVE-2017-7600/src/libtiff/../port/.libs/libport.a")
libtool: link: ar cru .libs/libtiff.a  tif_aux.o tif_close.o tif_codec.o tif_color.o tif_compress.o tif_dir.o tif_dirinfo.o tif_dirread.o tif_dirwrite.o tif_dumpmode.o tif_error.o tif_extension.o tif_fax3.o tif_fax3sm.o tif_flush.o tif_getimage.o tif_jbig.o tif_jpeg.o tif_jpeg_12.o tif_luv.o tif_lzma.o tif_lzw.o tif_next.o tif_ojpeg.o tif_open.o tif_packbits.o tif_pixarlog.o tif_predict.o tif_print.o tif_read.o tif_strip.o tif_swab.o tif_thunder.o tif_tile.o tif_version.o tif_warning.o tif_write.o tif_zip.o tif_unix.o  .libs/libtiff.lax/libport.a/dummy.o 
ar: `u' modifier ignored since `D' is the default (see `U')
libtool: link: ranlib .libs/libtiff.a
libtool: link: rm -fr .libs/libtiff.lax
libtool: link: ( cd ".libs" && rm -f "libtiff.la" && ln -s "../libtiff.la" "libtiff.la" )
/bin/bash ../libtool  --tag=CXX   --mode=link crepair-cxx  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -no-undefined -version-info 7:5:2   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o libtiffxx.la -rpath /usr/local/lib tif_stream.lo ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: rm -fr  .libs/libtiffxx.a .libs/libtiffxx.la .libs/libtiffxx.lai
libtool: link: (cd .libs/libtiffxx.lax/libport.a && ar x "/data/vulnloc/libtiff/CVE-2017-7600/src/libtiff/../port/.libs/libport.a")
libtool: link: ar cru .libs/libtiffxx.a  tif_stream.o  .libs/libtiffxx.lax/libport.a/dummy.o 
ar: `u' modifier ignored since `D' is the default (see `U')
libtool: link: ranlib .libs/libtiffxx.a
libtool: link: rm -fr .libs/libtiffxx.lax
libtool: link: ( cd ".libs" && rm -f "libtiffxx.la" && ln -s "../libtiffxx.la" "libtiffxx.la" )
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/libtiff'
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/libtiff'
Making all in tools
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/tools'
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o bmp2tiff bmp2tiff.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o bmp2tiff bmp2tiff.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o fax2ps fax2ps.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o fax2ps fax2ps.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o fax2tiff fax2tiff.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o fax2tiff fax2tiff.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o gif2tiff gif2tiff.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o gif2tiff gif2tiff.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o pal2rgb pal2rgb.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o pal2rgb pal2rgb.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o ppm2tiff ppm2tiff.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o ppm2tiff ppm2tiff.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o ras2tiff ras2tiff.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o ras2tiff ras2tiff.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o raw2tiff raw2tiff.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o raw2tiff raw2tiff.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o rgb2ycbcr rgb2ycbcr.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o rgb2ycbcr rgb2ycbcr.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o thumbnail thumbnail.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o thumbnail thumbnail.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o tiff2bw tiff2bw.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o tiff2bw tiff2bw.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o tiff2pdf tiff2pdf.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o tiff2pdf tiff2pdf.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o tiff2ps tiff2ps.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o tiff2ps tiff2ps.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o tiff2rgba tiff2rgba.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o tiff2rgba tiff2rgba.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o tiffcmp tiffcmp.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o tiffcmp tiffcmp.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o tiffcp tiffcp.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o tiffcp tiffcp.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o tiffcrop tiffcrop.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o tiffcrop tiffcrop.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o tiffdither tiffdither.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o tiffdither tiffdither.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o tiffdump tiffdump.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o tiffdump tiffdump.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o tiffinfo tiffinfo.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o tiffinfo tiffinfo.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o tiffmedian tiffmedian.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o tiffmedian tiffmedian.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o tiffset tiffset.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o tiffset tiffset.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o tiffsplit tiffsplit.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o tiffsplit tiffsplit.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/tools'
Making all in build
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/build'
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/build'
make[2]: Nothing to be done for 'all-am'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/build'
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/build'
Making all in contrib
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib'
Making all in addtiffo
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/addtiffo'
/bin/bash ../../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o addtiffo addtiffo.o tif_overview.o tif_ovrcache.o ../../libtiff/libtiff.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o addtiffo addtiffo.o tif_overview.o tif_ovrcache.o  -L/klee/build/lib -L/CrashRepair/lib ../../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy -llzma -ljbig -ljpeg -lz -lm
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/addtiffo'
Making all in dbs
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/dbs'
Making all in xtiff
make[3]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/dbs/xtiff'
make[3]: Nothing to be done for 'all'.
make[3]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/dbs/xtiff'
make[3]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/dbs'
/bin/bash ../../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o tiff-bi tiff-bi.o ../../libtiff/libtiff.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o tiff-bi tiff-bi.o  -L/klee/build/lib -L/CrashRepair/lib ../../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o tiff-grayscale tiff-grayscale.o ../../libtiff/libtiff.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o tiff-grayscale tiff-grayscale.o  -L/klee/build/lib -L/CrashRepair/lib ../../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o tiff-palette tiff-palette.o ../../libtiff/libtiff.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o tiff-palette tiff-palette.o  -L/klee/build/lib -L/CrashRepair/lib ../../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o tiff-rgb tiff-rgb.o ../../libtiff/libtiff.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o tiff-rgb tiff-rgb.o  -L/klee/build/lib -L/CrashRepair/lib ../../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy -llzma -ljbig -ljpeg -lz -lm
make[3]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/dbs'
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/dbs'
Making all in iptcutil
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/iptcutil'
/bin/bash ../../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o iptcutil iptcutil.o ../../libtiff/libtiff.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o iptcutil iptcutil.o  -L/klee/build/lib -L/CrashRepair/lib ../../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy -llzma -ljbig -ljpeg -lz -lm
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/iptcutil'
Making all in mfs
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/mfs'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/mfs'
Making all in pds
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/pds'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/pds'
Making all in ras
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/ras'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/ras'
Making all in stream
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/stream'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/stream'
Making all in tags
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/tags'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/tags'
Making all in win_dib
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/win_dib'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/win_dib'
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib'
make[2]: Nothing to be done for 'all-am'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib'
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib'
Making all in test
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/test'
make[1]: Nothing to be done for 'all'.
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/test'
Making all in man
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/man'
make[1]: Nothing to be done for 'all'.
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/man'
Making all in html
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/html'
Making all in images
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/html/images'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/html/images'
Making all in man
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/html/man'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/html/man'
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/html'
make[2]: Nothing to be done for 'all-am'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/html'
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/html'
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src'
make[1]: Nothing to be done for 'all-am'.
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src'
2025-02-05 21:11:05.206 | DEBUG    | scenario:evaluate:655 - testing candidate #21 against test #crash...
2025-02-05 21:11:05.206 | DEBUG    | shell:__call__:41 - executing: /data/vulnloc/libtiff/CVE-2017-7600/src/tools/tiffcp -i /CrashRepair/experiments/vulnloc/libtiff/CVE-2017-7600/tests/1.tif out.tiff
2025-02-05 21:11:05.211 | DEBUG    | test:run:172 - test failed: stderr contains bad output substring (runtime error: -115 is outside the range of representable values)
2025-02-05 21:11:05.211 | INFO     | scenario:evaluate:662 - candidate #21 fails test #crash
2025-02-05 21:11:05.216 | INFO     | scenario:evaluate:635 - evaluating candidate patch #22:
@@ -939,6 +939,7 @@
 	return(0);
 }
 
+
 static int
 TIFFWriteDirectoryTagSampleformatArray(TIFF* tif, uint32* ndir, TIFFDirEntry* dir, uint16 tag, uint32 count, double* value)
 {
@@ -953,58 +954,65 @@
 		return (0);
 	}
 
+	if (tif->tif_dir.td_bitspersample < 1) // Modified condition to ensure td_bitspersample is valid
+	{
+		TIFFErrorExt(tif->tif_clientdata, module, "Invalid bits per sample");
+		_TIFFfree(conv);
+		return (0);
+	}
+
 	switch (tif->tif_dir.td_sampleformat)
 	{
 		case SAMPLEFORMAT_IEEEFP:
-			if (tif->tif_dir.td_bitspersample<=32)
+			if (tif->tif_dir.td_bitspersample <= 32)
 			{
 				for (i = 0; i < count; ++i)
 					((float*)conv)[i] = (float)value[i];
-				ok = TIFFWriteDirectoryTagFloatArray(tif,ndir,dir,tag,count,(float*)conv);
+				ok = TIFFWriteDirectoryTagFloatArray(tif, ndir, dir, tag, count, (float*)conv);
 			}
 			else
 			{
-				ok = TIFFWriteDirectoryTagDoubleArray(tif,ndir,dir,tag,count,value);
+				ok = TIFFWriteDirectoryTagDoubleArray(tif, ndir, dir, tag, count, value);
 			}
 			break;
 		case SAMPLEFORMAT_INT:
-			if (tif->tif_dir.td_bitspersample<=8)
+			if (tif->tif_dir.td_bitspersample <= 8)
 			{
 				for (i = 0; i < count; ++i)
 					((int8*)conv)[i] = (int8)value[i];
-				ok = TIFFWriteDirectoryTagSbyteArray(tif,ndir,dir,tag,count,(int8*)conv);
+				ok = TIFFWriteDirectoryTagSbyteArray(tif, ndir, dir, tag, count, (int8*)conv);
 			}
-			else if (tif->tif_dir.td_bitspersample<=16)
+			else if (tif->tif_dir.td_bitspersample <= 16)
 			{
 				for (i = 0; i < count; ++i)
 					((int16*)conv)[i] = (int16)value[i];
-				ok = TIFFWriteDirectoryTagSshortArray(tif,ndir,dir,tag,count,(int16*)conv);
+				ok = TIFFWriteDirectoryTagSshortArray(tif, ndir, dir, tag, count, (int16*)conv);
 			}
 			else
 			{
 				for (i = 0; i < count; ++i)
 					((int32*)conv)[i] = (int32)value[i];
-				ok = TIFFWriteDirectoryTagSlongArray(tif,ndir,dir,tag,count,(int32*)conv);
+				ok = TIFFWriteDirectoryTagSlongArray(tif, ndir, dir, tag, count, (int32*)conv);
 			}
 			break;
 		case SAMPLEFORMAT_UINT:
-			if (tif->tif_dir.td_bitspersample<=8)
+			if (tif->tif_dir.td_bitspersample <= 8)
 			{
 				for (i = 0; i < count; ++i)
 					((uint8*)conv)[i] = (uint8)value[i];
-				ok = TIFFWriteDirectoryTagByteArray(tif,ndir,dir,tag,count,(uint8*)conv);
+				ok = TIFFWriteDirectoryTagByteArray(tif, ndir, dir, tag, count, (uint8*)conv);
 			}
-			else if (tif->tif_dir.td_bitspersample<=16)
+			else if (tif->tif_dir.td_bitspersample <= 16)
 			{
 				for (i = 0; i < count; ++i)
 					((uint16*)conv)[i] = (uint16)value[i];
-				ok = TIFFWriteDirectoryTagShortArray(tif,ndir,dir,tag,count,(uint16*)conv);
+				ok = TIFFWriteDirectoryTagShortArray(tif, ndir, dir, tag, count, (uint16*)conv);
 			}
 			else
 			{
 				for (i = 0; i < count; ++i)
 					((uint32*)conv)[i] = (uint32)value[i];
-				ok = TIFFWriteDirectoryTagLongArray(tif,ndir,dir,tag,count,(uint32*)conv);
+				ok = TIFFWriteDirectoryTagLongArray(tif, ndir, dir, tag, count, (uint32*)conv);
 			}
 			break;
 		default:
@@ -1015,6 +1023,7 @@
 	return (ok);
 }
 
+
 #if 0
 static int
 TIFFWriteDirectoryTagSampleformatPerSample(TIFF* tif, uint32* ndir, TIFFDirEntry* dir, uint16 tag, double value)

2025-02-05 21:11:05.220 | DEBUG    | scenario:rebuild:369 - original environment: environ({'CONDA_SHLVL': '2', 'LC_ALL': 'C.UTF-8', 'LS_COLORS': 'rs=0:di=01;34:ln=01;36:mh=00:pi=40;33:so=01;35:do=01;35:bd=40;33;01:cd=40;33;01:or=40;31;01:mi=00:su=37;41:sg=30;43:ca=30;41:tw=30;42:ow=34;42:st=37;44:ex=01;32:*.tar=01;31:*.tgz=01;31:*.arc=01;31:*.arj=01;31:*.taz=01;31:*.lha=01;31:*.lz4=01;31:*.lzh=01;31:*.lzma=01;31:*.tlz=01;31:*.txz=01;31:*.tzo=01;31:*.t7z=01;31:*.zip=01;31:*.z=01;31:*.Z=01;31:*.dz=01;31:*.gz=01;31:*.lrz=01;31:*.lz=01;31:*.lzo=01;31:*.xz=01;31:*.zst=01;31:*.tzst=01;31:*.bz2=01;31:*.bz=01;31:*.tbz=01;31:*.tbz2=01;31:*.tz=01;31:*.deb=01;31:*.rpm=01;31:*.jar=01;31:*.war=01;31:*.ear=01;31:*.sar=01;31:*.rar=01;31:*.alz=01;31:*.ace=01;31:*.zoo=01;31:*.cpio=01;31:*.7z=01;31:*.rz=01;31:*.cab=01;31:*.wim=01;31:*.swm=01;31:*.dwm=01;31:*.esd=01;31:*.jpg=01;35:*.jpeg=01;35:*.mjpg=01;35:*.mjpeg=01;35:*.gif=01;35:*.bmp=01;35:*.pbm=01;35:*.pgm=01;35:*.ppm=01;35:*.tga=01;35:*.xbm=01;35:*.xpm=01;35:*.tif=01;35:*.tiff=01;35:*.png=01;35:*.svg=01;35:*.svgz=01;35:*.mng=01;35:*.pcx=01;35:*.mov=01;35:*.mpg=01;35:*.mpeg=01;35:*.m2v=01;35:*.mkv=01;35:*.webm=01;35:*.ogm=01;35:*.mp4=01;35:*.m4v=01;35:*.mp4v=01;35:*.vob=01;35:*.qt=01;35:*.nuv=01;35:*.wmv=01;35:*.asf=01;35:*.rm=01;35:*.rmvb=01;35:*.flc=01;35:*.avi=01;35:*.fli=01;35:*.flv=01;35:*.gl=01;35:*.dl=01;35:*.xcf=01;35:*.xwd=01;35:*.yuv=01;35:*.cgm=01;35:*.emf=01;35:*.ogv=01;35:*.ogx=01;35:*.aac=00;36:*.au=00;36:*.flac=00;36:*.m4a=00;36:*.mid=00;36:*.midi=00;36:*.mka=00;36:*.mp3=00;36:*.mpc=00;36:*.ogg=00;36:*.ra=00;36:*.wav=00;36:*.oga=00;36:*.opus=00;36:*.spx=00;36:*.xspf=00;36:', 'LD_LIBRARY_PATH': '/opt/crashrepair/lib:/CrashRepair/lib:/klee/build/lib:', 'CONDA_EXE': '/root/anaconda3/bin/conda', 'LANG': 'C.UTF-8', 'TZ': 'Asia/Shanghai', 'HOSTNAME': 'fea22102047d', 'OLDPWD': '/orchestrator', 'CONDA_PREFIX': '/root/anaconda3/envs/CrashRepair', '_CE_M': '', 'CC': 'crepair-cc', 'LLVM_COMPILER': 'clang', 'CONDA_PREFIX_1': '/root/anaconda3', 'PWD': '/orchestrator/crashrepair', 'HOME': '/root', 'CONDA_PYTHON_EXE': '/root/anaconda3/bin/python', '_CE_CONDA': '', 'CONDA_PROMPT_MODIFIER': '(CrashRepair) ', 'CXX': 'crepair-cxx', 'TERM': 'xterm', 'SHLVL': '2', 'PYTHONPATH': '/usr/lib/python3.8/site-packages:', 'PATH': '/root/anaconda3/envs/CrashRepair/bin:/root/anaconda3/condabin:~/anaconda3/bin:/opt/crashrepair/bin:/CrashRepair/compiler:/klee/build/bin:/opt/llvm-6/bin:/klee/build/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', 'CONDA_DEFAULT_ENV': 'CrashRepair', '_': '/root/anaconda3/envs/CrashRepair/bin/python'})
2025-02-05 21:11:05.220 | DEBUG    | scenario:rebuild:398 - using environment: {'INJECT_CFLAGS': '-g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy ', 'INJECT_CXXFLAGS': '-g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy ', 'INJECT_LDFLAGS': '-g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy '}
2025-02-05 21:11:05.220 | DEBUG    | shell:__call__:41 - executing: make CFLAGS="-fsanitize=float-cast-overflow ${INJECT_CFLAGS}" CXXFLAGS="-fsanitize=float-cast-overflow ${INJECT_CXXFLAGS}" LDFLAGS="${INJECT_LDFLAGS}"
Making all in port
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/port'
make[1]: Nothing to be done for 'all'.
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/port'
Making all in libtiff
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/libtiff'
make  all-am
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/libtiff'
/bin/bash ../libtool  --tag=CC   --mode=compile crepair-cc -DHAVE_CONFIG_H -I.     -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -MT tif_dirwrite.lo -MD -MP -MF .deps/tif_dirwrite.Tpo -c -o tif_dirwrite.lo tif_dirwrite.c
libtool: compile:  crepair-cc -DHAVE_CONFIG_H -I. -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -MT tif_dirwrite.lo -MD -MP -MF .deps/tif_dirwrite.Tpo -c tif_dirwrite.c -o tif_dirwrite.o
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
mv -f .deps/tif_dirwrite.Tpo .deps/tif_dirwrite.Plo
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -no-undefined -version-info 7:5:2   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o libtiff.la -rpath /usr/local/lib tif_aux.lo tif_close.lo tif_codec.lo tif_color.lo tif_compress.lo tif_dir.lo tif_dirinfo.lo tif_dirread.lo tif_dirwrite.lo tif_dumpmode.lo tif_error.lo tif_extension.lo tif_fax3.lo tif_fax3sm.lo tif_flush.lo tif_getimage.lo tif_jbig.lo tif_jpeg.lo tif_jpeg_12.lo tif_luv.lo tif_lzma.lo tif_lzw.lo tif_next.lo tif_ojpeg.lo tif_open.lo tif_packbits.lo tif_pixarlog.lo tif_predict.lo tif_print.lo tif_read.lo tif_strip.lo tif_swab.lo tif_thunder.lo tif_tile.lo tif_version.lo tif_warning.lo tif_write.lo tif_zip.lo  tif_unix.lo ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: rm -fr  .libs/libtiff.a .libs/libtiff.la .libs/libtiff.lai
libtool: link: (cd .libs/libtiff.lax/libport.a && ar x "/data/vulnloc/libtiff/CVE-2017-7600/src/libtiff/../port/.libs/libport.a")
libtool: link: ar cru .libs/libtiff.a  tif_aux.o tif_close.o tif_codec.o tif_color.o tif_compress.o tif_dir.o tif_dirinfo.o tif_dirread.o tif_dirwrite.o tif_dumpmode.o tif_error.o tif_extension.o tif_fax3.o tif_fax3sm.o tif_flush.o tif_getimage.o tif_jbig.o tif_jpeg.o tif_jpeg_12.o tif_luv.o tif_lzma.o tif_lzw.o tif_next.o tif_ojpeg.o tif_open.o tif_packbits.o tif_pixarlog.o tif_predict.o tif_print.o tif_read.o tif_strip.o tif_swab.o tif_thunder.o tif_tile.o tif_version.o tif_warning.o tif_write.o tif_zip.o tif_unix.o  .libs/libtiff.lax/libport.a/dummy.o 
ar: `u' modifier ignored since `D' is the default (see `U')
libtool: link: ranlib .libs/libtiff.a
libtool: link: rm -fr .libs/libtiff.lax
libtool: link: ( cd ".libs" && rm -f "libtiff.la" && ln -s "../libtiff.la" "libtiff.la" )
/bin/bash ../libtool  --tag=CXX   --mode=link crepair-cxx  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -no-undefined -version-info 7:5:2   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o libtiffxx.la -rpath /usr/local/lib tif_stream.lo ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: rm -fr  .libs/libtiffxx.a .libs/libtiffxx.la .libs/libtiffxx.lai
libtool: link: (cd .libs/libtiffxx.lax/libport.a && ar x "/data/vulnloc/libtiff/CVE-2017-7600/src/libtiff/../port/.libs/libport.a")
libtool: link: ar cru .libs/libtiffxx.a  tif_stream.o  .libs/libtiffxx.lax/libport.a/dummy.o 
ar: `u' modifier ignored since `D' is the default (see `U')
libtool: link: ranlib .libs/libtiffxx.a
libtool: link: rm -fr .libs/libtiffxx.lax
libtool: link: ( cd ".libs" && rm -f "libtiffxx.la" && ln -s "../libtiffxx.la" "libtiffxx.la" )
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/libtiff'
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/libtiff'
Making all in tools
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/tools'
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o bmp2tiff bmp2tiff.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o bmp2tiff bmp2tiff.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o fax2ps fax2ps.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o fax2ps fax2ps.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o fax2tiff fax2tiff.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o fax2tiff fax2tiff.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o gif2tiff gif2tiff.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o gif2tiff gif2tiff.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o pal2rgb pal2rgb.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o pal2rgb pal2rgb.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o ppm2tiff ppm2tiff.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o ppm2tiff ppm2tiff.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o ras2tiff ras2tiff.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o ras2tiff ras2tiff.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o raw2tiff raw2tiff.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o raw2tiff raw2tiff.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o rgb2ycbcr rgb2ycbcr.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o rgb2ycbcr rgb2ycbcr.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o thumbnail thumbnail.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o thumbnail thumbnail.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o tiff2bw tiff2bw.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o tiff2bw tiff2bw.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o tiff2pdf tiff2pdf.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o tiff2pdf tiff2pdf.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o tiff2ps tiff2ps.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o tiff2ps tiff2ps.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o tiff2rgba tiff2rgba.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o tiff2rgba tiff2rgba.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o tiffcmp tiffcmp.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o tiffcmp tiffcmp.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o tiffcp tiffcp.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o tiffcp tiffcp.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o tiffcrop tiffcrop.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o tiffcrop tiffcrop.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o tiffdither tiffdither.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o tiffdither tiffdither.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o tiffdump tiffdump.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o tiffdump tiffdump.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o tiffinfo tiffinfo.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o tiffinfo tiffinfo.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o tiffmedian tiffmedian.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o tiffmedian tiffmedian.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o tiffset tiffset.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o tiffset tiffset.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o tiffsplit tiffsplit.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o tiffsplit tiffsplit.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/tools'
Making all in build
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/build'
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/build'
make[2]: Nothing to be done for 'all-am'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/build'
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/build'
Making all in contrib
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib'
Making all in addtiffo
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/addtiffo'
/bin/bash ../../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o addtiffo addtiffo.o tif_overview.o tif_ovrcache.o ../../libtiff/libtiff.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o addtiffo addtiffo.o tif_overview.o tif_ovrcache.o  -L/klee/build/lib -L/CrashRepair/lib ../../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy -llzma -ljbig -ljpeg -lz -lm
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/addtiffo'
Making all in dbs
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/dbs'
Making all in xtiff
make[3]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/dbs/xtiff'
make[3]: Nothing to be done for 'all'.
make[3]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/dbs/xtiff'
make[3]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/dbs'
/bin/bash ../../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o tiff-bi tiff-bi.o ../../libtiff/libtiff.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o tiff-bi tiff-bi.o  -L/klee/build/lib -L/CrashRepair/lib ../../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o tiff-grayscale tiff-grayscale.o ../../libtiff/libtiff.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o tiff-grayscale tiff-grayscale.o  -L/klee/build/lib -L/CrashRepair/lib ../../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o tiff-palette tiff-palette.o ../../libtiff/libtiff.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o tiff-palette tiff-palette.o  -L/klee/build/lib -L/CrashRepair/lib ../../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o tiff-rgb tiff-rgb.o ../../libtiff/libtiff.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o tiff-rgb tiff-rgb.o  -L/klee/build/lib -L/CrashRepair/lib ../../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy -llzma -ljbig -ljpeg -lz -lm
make[3]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/dbs'
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/dbs'
Making all in iptcutil
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/iptcutil'
/bin/bash ../../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o iptcutil iptcutil.o ../../libtiff/libtiff.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o iptcutil iptcutil.o  -L/klee/build/lib -L/CrashRepair/lib ../../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy -llzma -ljbig -ljpeg -lz -lm
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/iptcutil'
Making all in mfs
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/mfs'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/mfs'
Making all in pds
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/pds'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/pds'
Making all in ras
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/ras'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/ras'
Making all in stream
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/stream'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/stream'
Making all in tags
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/tags'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/tags'
Making all in win_dib
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/win_dib'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/win_dib'
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib'
make[2]: Nothing to be done for 'all-am'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib'
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib'
Making all in test
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/test'
make[1]: Nothing to be done for 'all'.
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/test'
Making all in man
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/man'
make[1]: Nothing to be done for 'all'.
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/man'
Making all in html
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/html'
Making all in images
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/html/images'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/html/images'
Making all in man
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/html/man'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/html/man'
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/html'
make[2]: Nothing to be done for 'all-am'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/html'
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/html'
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src'
make[1]: Nothing to be done for 'all-am'.
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src'
2025-02-05 21:11:12.230 | DEBUG    | scenario:evaluate:655 - testing candidate #22 against test #crash...
2025-02-05 21:11:12.230 | DEBUG    | shell:__call__:41 - executing: /data/vulnloc/libtiff/CVE-2017-7600/src/tools/tiffcp -i /CrashRepair/experiments/vulnloc/libtiff/CVE-2017-7600/tests/1.tif out.tiff
2025-02-05 21:11:12.234 | DEBUG    | test:run:172 - test failed: stderr contains bad output substring (runtime error: -115 is outside the range of representable values)
2025-02-05 21:11:12.235 | INFO     | scenario:evaluate:662 - candidate #22 fails test #crash
2025-02-05 21:11:12.244 | INFO     | scenario:evaluate:635 - evaluating candidate patch #23:
@@ -939,6 +939,7 @@
 	return(0);
 }
 
+
 static int
 TIFFWriteDirectoryTagSampleformatArray(TIFF* tif, uint32* ndir, TIFFDirEntry* dir, uint16 tag, uint32 count, double* value)
 {
@@ -956,7 +957,12 @@
 	switch (tif->tif_dir.td_sampleformat)
 	{
 		case SAMPLEFORMAT_IEEEFP:
-			if (tif->tif_dir.td_bitspersample<=32)
+			if (tif->tif_dir.td_bitspersample < 1 || tif->tif_dir.td_bitspersample > 64) // Added check for valid bitspersample range
+			{
+				ok = 0; // Return an error if bitspersample is out of range
+				break;
+			}
+			if (tif->tif_dir.td_bitspersample <= 32)
 			{
 				for (i = 0; i < count; ++i)
 					((float*)conv)[i] = (float)value[i];
@@ -968,13 +974,18 @@
 			}
 			break;
 		case SAMPLEFORMAT_INT:
-			if (tif->tif_dir.td_bitspersample<=8)
+			if (tif->tif_dir.td_bitspersample < 1 || tif->tif_dir.td_bitspersample > 32) // Added check for valid bitspersample range
+			{
+				ok = 0; // Return an error if bitspersample is out of range
+				break;
+			}
+			if (tif->tif_dir.td_bitspersample <= 8)
 			{
 				for (i = 0; i < count; ++i)
 					((int8*)conv)[i] = (int8)value[i];
 				ok = TIFFWriteDirectoryTagSbyteArray(tif,ndir,dir,tag,count,(int8*)conv);
 			}
-			else if (tif->tif_dir.td_bitspersample<=16)
+			else if (tif->tif_dir.td_bitspersample <= 16)
 			{
 				for (i = 0; i < count; ++i)
 					((int16*)conv)[i] = (int16)value[i];
@@ -988,13 +999,18 @@
 			}
 			break;
 		case SAMPLEFORMAT_UINT:
-			if (tif->tif_dir.td_bitspersample<=8)
+			if (tif->tif_dir.td_bitspersample < 1 || tif->tif_dir.td_bitspersample > 32) // Added check for valid bitspersample range
+			{
+				ok = 0; // Return an error if bitspersample is out of range
+				break;
+			}
+			if (tif->tif_dir.td_bitspersample <= 8)
 			{
 				for (i = 0; i < count; ++i)
 					((uint8*)conv)[i] = (uint8)value[i];
 				ok = TIFFWriteDirectoryTagByteArray(tif,ndir,dir,tag,count,(uint8*)conv);
 			}
-			else if (tif->tif_dir.td_bitspersample<=16)
+			else if (tif->tif_dir.td_bitspersample <= 16)
 			{
 				for (i = 0; i < count; ++i)
 					((uint16*)conv)[i] = (uint16)value[i];
@@ -1015,6 +1031,7 @@
 	return (ok);
 }
 
+
 #if 0
 static int
 TIFFWriteDirectoryTagSampleformatPerSample(TIFF* tif, uint32* ndir, TIFFDirEntry* dir, uint16 tag, double value)

2025-02-05 21:11:12.248 | DEBUG    | scenario:rebuild:369 - original environment: environ({'CONDA_SHLVL': '2', 'LC_ALL': 'C.UTF-8', 'LS_COLORS': 'rs=0:di=01;34:ln=01;36:mh=00:pi=40;33:so=01;35:do=01;35:bd=40;33;01:cd=40;33;01:or=40;31;01:mi=00:su=37;41:sg=30;43:ca=30;41:tw=30;42:ow=34;42:st=37;44:ex=01;32:*.tar=01;31:*.tgz=01;31:*.arc=01;31:*.arj=01;31:*.taz=01;31:*.lha=01;31:*.lz4=01;31:*.lzh=01;31:*.lzma=01;31:*.tlz=01;31:*.txz=01;31:*.tzo=01;31:*.t7z=01;31:*.zip=01;31:*.z=01;31:*.Z=01;31:*.dz=01;31:*.gz=01;31:*.lrz=01;31:*.lz=01;31:*.lzo=01;31:*.xz=01;31:*.zst=01;31:*.tzst=01;31:*.bz2=01;31:*.bz=01;31:*.tbz=01;31:*.tbz2=01;31:*.tz=01;31:*.deb=01;31:*.rpm=01;31:*.jar=01;31:*.war=01;31:*.ear=01;31:*.sar=01;31:*.rar=01;31:*.alz=01;31:*.ace=01;31:*.zoo=01;31:*.cpio=01;31:*.7z=01;31:*.rz=01;31:*.cab=01;31:*.wim=01;31:*.swm=01;31:*.dwm=01;31:*.esd=01;31:*.jpg=01;35:*.jpeg=01;35:*.mjpg=01;35:*.mjpeg=01;35:*.gif=01;35:*.bmp=01;35:*.pbm=01;35:*.pgm=01;35:*.ppm=01;35:*.tga=01;35:*.xbm=01;35:*.xpm=01;35:*.tif=01;35:*.tiff=01;35:*.png=01;35:*.svg=01;35:*.svgz=01;35:*.mng=01;35:*.pcx=01;35:*.mov=01;35:*.mpg=01;35:*.mpeg=01;35:*.m2v=01;35:*.mkv=01;35:*.webm=01;35:*.ogm=01;35:*.mp4=01;35:*.m4v=01;35:*.mp4v=01;35:*.vob=01;35:*.qt=01;35:*.nuv=01;35:*.wmv=01;35:*.asf=01;35:*.rm=01;35:*.rmvb=01;35:*.flc=01;35:*.avi=01;35:*.fli=01;35:*.flv=01;35:*.gl=01;35:*.dl=01;35:*.xcf=01;35:*.xwd=01;35:*.yuv=01;35:*.cgm=01;35:*.emf=01;35:*.ogv=01;35:*.ogx=01;35:*.aac=00;36:*.au=00;36:*.flac=00;36:*.m4a=00;36:*.mid=00;36:*.midi=00;36:*.mka=00;36:*.mp3=00;36:*.mpc=00;36:*.ogg=00;36:*.ra=00;36:*.wav=00;36:*.oga=00;36:*.opus=00;36:*.spx=00;36:*.xspf=00;36:', 'LD_LIBRARY_PATH': '/opt/crashrepair/lib:/CrashRepair/lib:/klee/build/lib:', 'CONDA_EXE': '/root/anaconda3/bin/conda', 'LANG': 'C.UTF-8', 'TZ': 'Asia/Shanghai', 'HOSTNAME': 'fea22102047d', 'OLDPWD': '/orchestrator', 'CONDA_PREFIX': '/root/anaconda3/envs/CrashRepair', '_CE_M': '', 'CC': 'crepair-cc', 'LLVM_COMPILER': 'clang', 'CONDA_PREFIX_1': '/root/anaconda3', 'PWD': '/orchestrator/crashrepair', 'HOME': '/root', 'CONDA_PYTHON_EXE': '/root/anaconda3/bin/python', '_CE_CONDA': '', 'CONDA_PROMPT_MODIFIER': '(CrashRepair) ', 'CXX': 'crepair-cxx', 'TERM': 'xterm', 'SHLVL': '2', 'PYTHONPATH': '/usr/lib/python3.8/site-packages:', 'PATH': '/root/anaconda3/envs/CrashRepair/bin:/root/anaconda3/condabin:~/anaconda3/bin:/opt/crashrepair/bin:/CrashRepair/compiler:/klee/build/bin:/opt/llvm-6/bin:/klee/build/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', 'CONDA_DEFAULT_ENV': 'CrashRepair', '_': '/root/anaconda3/envs/CrashRepair/bin/python'})
2025-02-05 21:11:12.249 | DEBUG    | scenario:rebuild:398 - using environment: {'INJECT_CFLAGS': '-g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy ', 'INJECT_CXXFLAGS': '-g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy ', 'INJECT_LDFLAGS': '-g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy '}
2025-02-05 21:11:12.249 | DEBUG    | shell:__call__:41 - executing: make CFLAGS="-fsanitize=float-cast-overflow ${INJECT_CFLAGS}" CXXFLAGS="-fsanitize=float-cast-overflow ${INJECT_CXXFLAGS}" LDFLAGS="${INJECT_LDFLAGS}"
Making all in port
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/port'
make[1]: Nothing to be done for 'all'.
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/port'
Making all in libtiff
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/libtiff'
make  all-am
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/libtiff'
/bin/bash ../libtool  --tag=CC   --mode=compile crepair-cc -DHAVE_CONFIG_H -I.     -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -MT tif_dirwrite.lo -MD -MP -MF .deps/tif_dirwrite.Tpo -c -o tif_dirwrite.lo tif_dirwrite.c
libtool: compile:  crepair-cc -DHAVE_CONFIG_H -I. -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -MT tif_dirwrite.lo -MD -MP -MF .deps/tif_dirwrite.Tpo -c tif_dirwrite.c -o tif_dirwrite.o
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
mv -f .deps/tif_dirwrite.Tpo .deps/tif_dirwrite.Plo
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -no-undefined -version-info 7:5:2   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o libtiff.la -rpath /usr/local/lib tif_aux.lo tif_close.lo tif_codec.lo tif_color.lo tif_compress.lo tif_dir.lo tif_dirinfo.lo tif_dirread.lo tif_dirwrite.lo tif_dumpmode.lo tif_error.lo tif_extension.lo tif_fax3.lo tif_fax3sm.lo tif_flush.lo tif_getimage.lo tif_jbig.lo tif_jpeg.lo tif_jpeg_12.lo tif_luv.lo tif_lzma.lo tif_lzw.lo tif_next.lo tif_ojpeg.lo tif_open.lo tif_packbits.lo tif_pixarlog.lo tif_predict.lo tif_print.lo tif_read.lo tif_strip.lo tif_swab.lo tif_thunder.lo tif_tile.lo tif_version.lo tif_warning.lo tif_write.lo tif_zip.lo  tif_unix.lo ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: rm -fr  .libs/libtiff.a .libs/libtiff.la .libs/libtiff.lai
libtool: link: (cd .libs/libtiff.lax/libport.a && ar x "/data/vulnloc/libtiff/CVE-2017-7600/src/libtiff/../port/.libs/libport.a")
libtool: link: ar cru .libs/libtiff.a  tif_aux.o tif_close.o tif_codec.o tif_color.o tif_compress.o tif_dir.o tif_dirinfo.o tif_dirread.o tif_dirwrite.o tif_dumpmode.o tif_error.o tif_extension.o tif_fax3.o tif_fax3sm.o tif_flush.o tif_getimage.o tif_jbig.o tif_jpeg.o tif_jpeg_12.o tif_luv.o tif_lzma.o tif_lzw.o tif_next.o tif_ojpeg.o tif_open.o tif_packbits.o tif_pixarlog.o tif_predict.o tif_print.o tif_read.o tif_strip.o tif_swab.o tif_thunder.o tif_tile.o tif_version.o tif_warning.o tif_write.o tif_zip.o tif_unix.o  .libs/libtiff.lax/libport.a/dummy.o 
ar: `u' modifier ignored since `D' is the default (see `U')
libtool: link: ranlib .libs/libtiff.a
libtool: link: rm -fr .libs/libtiff.lax
libtool: link: ( cd ".libs" && rm -f "libtiff.la" && ln -s "../libtiff.la" "libtiff.la" )
/bin/bash ../libtool  --tag=CXX   --mode=link crepair-cxx  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -no-undefined -version-info 7:5:2   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o libtiffxx.la -rpath /usr/local/lib tif_stream.lo ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: rm -fr  .libs/libtiffxx.a .libs/libtiffxx.la .libs/libtiffxx.lai
libtool: link: (cd .libs/libtiffxx.lax/libport.a && ar x "/data/vulnloc/libtiff/CVE-2017-7600/src/libtiff/../port/.libs/libport.a")
libtool: link: ar cru .libs/libtiffxx.a  tif_stream.o  .libs/libtiffxx.lax/libport.a/dummy.o 
ar: `u' modifier ignored since `D' is the default (see `U')
libtool: link: ranlib .libs/libtiffxx.a
libtool: link: rm -fr .libs/libtiffxx.lax
libtool: link: ( cd ".libs" && rm -f "libtiffxx.la" && ln -s "../libtiffxx.la" "libtiffxx.la" )
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/libtiff'
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/libtiff'
Making all in tools
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/tools'
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o bmp2tiff bmp2tiff.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o bmp2tiff bmp2tiff.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o fax2ps fax2ps.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o fax2ps fax2ps.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o fax2tiff fax2tiff.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o fax2tiff fax2tiff.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o gif2tiff gif2tiff.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o gif2tiff gif2tiff.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o pal2rgb pal2rgb.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o pal2rgb pal2rgb.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o ppm2tiff ppm2tiff.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o ppm2tiff ppm2tiff.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o ras2tiff ras2tiff.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o ras2tiff ras2tiff.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o raw2tiff raw2tiff.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o raw2tiff raw2tiff.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o rgb2ycbcr rgb2ycbcr.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o rgb2ycbcr rgb2ycbcr.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o thumbnail thumbnail.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o thumbnail thumbnail.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o tiff2bw tiff2bw.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o tiff2bw tiff2bw.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o tiff2pdf tiff2pdf.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o tiff2pdf tiff2pdf.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o tiff2ps tiff2ps.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o tiff2ps tiff2ps.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o tiff2rgba tiff2rgba.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o tiff2rgba tiff2rgba.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o tiffcmp tiffcmp.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o tiffcmp tiffcmp.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o tiffcp tiffcp.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o tiffcp tiffcp.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o tiffcrop tiffcrop.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o tiffcrop tiffcrop.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o tiffdither tiffdither.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o tiffdither tiffdither.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o tiffdump tiffdump.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o tiffdump tiffdump.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o tiffinfo tiffinfo.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o tiffinfo tiffinfo.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o tiffmedian tiffmedian.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o tiffmedian tiffmedian.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o tiffset tiffset.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o tiffset tiffset.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o tiffsplit tiffsplit.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o tiffsplit tiffsplit.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/tools'
Making all in build
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/build'
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/build'
make[2]: Nothing to be done for 'all-am'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/build'
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/build'
Making all in contrib
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib'
Making all in addtiffo
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/addtiffo'
/bin/bash ../../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o addtiffo addtiffo.o tif_overview.o tif_ovrcache.o ../../libtiff/libtiff.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o addtiffo addtiffo.o tif_overview.o tif_ovrcache.o  -L/klee/build/lib -L/CrashRepair/lib ../../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy -llzma -ljbig -ljpeg -lz -lm
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/addtiffo'
Making all in dbs
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/dbs'
Making all in xtiff
make[3]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/dbs/xtiff'
make[3]: Nothing to be done for 'all'.
make[3]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/dbs/xtiff'
make[3]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/dbs'
/bin/bash ../../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o tiff-bi tiff-bi.o ../../libtiff/libtiff.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o tiff-bi tiff-bi.o  -L/klee/build/lib -L/CrashRepair/lib ../../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o tiff-grayscale tiff-grayscale.o ../../libtiff/libtiff.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o tiff-grayscale tiff-grayscale.o  -L/klee/build/lib -L/CrashRepair/lib ../../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o tiff-palette tiff-palette.o ../../libtiff/libtiff.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o tiff-palette tiff-palette.o  -L/klee/build/lib -L/CrashRepair/lib ../../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o tiff-rgb tiff-rgb.o ../../libtiff/libtiff.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o tiff-rgb tiff-rgb.o  -L/klee/build/lib -L/CrashRepair/lib ../../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy -llzma -ljbig -ljpeg -lz -lm
make[3]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/dbs'
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/dbs'
Making all in iptcutil
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/iptcutil'
/bin/bash ../../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o iptcutil iptcutil.o ../../libtiff/libtiff.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o iptcutil iptcutil.o  -L/klee/build/lib -L/CrashRepair/lib ../../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy -llzma -ljbig -ljpeg -lz -lm
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/iptcutil'
Making all in mfs
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/mfs'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/mfs'
Making all in pds
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/pds'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/pds'
Making all in ras
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/ras'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/ras'
Making all in stream
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/stream'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/stream'
Making all in tags
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/tags'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/tags'
Making all in win_dib
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/win_dib'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/win_dib'
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib'
make[2]: Nothing to be done for 'all-am'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib'
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib'
Making all in test
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/test'
make[1]: Nothing to be done for 'all'.
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/test'
Making all in man
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/man'
make[1]: Nothing to be done for 'all'.
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/man'
Making all in html
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/html'
Making all in images
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/html/images'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/html/images'
Making all in man
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/html/man'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/html/man'
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/html'
make[2]: Nothing to be done for 'all-am'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/html'
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/html'
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src'
make[1]: Nothing to be done for 'all-am'.
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src'
2025-02-05 21:11:16.829 | DEBUG    | scenario:evaluate:655 - testing candidate #23 against test #crash...
2025-02-05 21:11:16.829 | DEBUG    | shell:__call__:41 - executing: /data/vulnloc/libtiff/CVE-2017-7600/src/tools/tiffcp -i /CrashRepair/experiments/vulnloc/libtiff/CVE-2017-7600/tests/1.tif out.tiff
2025-02-05 21:11:16.833 | DEBUG    | test:run:172 - test failed: stderr contains bad output substring (runtime error: -115 is outside the range of representable values)
2025-02-05 21:11:16.833 | INFO     | scenario:evaluate:662 - candidate #23 fails test #crash
2025-02-05 21:11:16.837 | INFO     | scenario:evaluate:635 - evaluating candidate patch #24:
@@ -939,6 +939,7 @@
 	return(0);
 }
 
+
 static int
 TIFFWriteDirectoryTagSampleformatArray(TIFF* tif, uint32* ndir, TIFFDirEntry* dir, uint16 tag, uint32 count, double* value)
 {
@@ -953,58 +954,63 @@
 		return (0);
 	}
 
+	if (count == 0) { // Add check for zero count
+		_TIFFfree(conv);
+		return 0; // Early exit if count is 0
+	}
+
 	switch (tif->tif_dir.td_sampleformat)
 	{
 		case SAMPLEFORMAT_IEEEFP:
-			if (tif->tif_dir.td_bitspersample<=32)
+			if (tif->tif_dir.td_bitspersample <= 32)
 			{
 				for (i = 0; i < count; ++i)
 					((float*)conv)[i] = (float)value[i];
-				ok = TIFFWriteDirectoryTagFloatArray(tif,ndir,dir,tag,count,(float*)conv);
+				ok = TIFFWriteDirectoryTagFloatArray(tif, ndir, dir, tag, count, (float*)conv);
 			}
 			else
 			{
-				ok = TIFFWriteDirectoryTagDoubleArray(tif,ndir,dir,tag,count,value);
+				ok = TIFFWriteDirectoryTagDoubleArray(tif, ndir, dir, tag, count, value);
 			}
 			break;
 		case SAMPLEFORMAT_INT:
-			if (tif->tif_dir.td_bitspersample<=8)
+			if (tif->tif_dir.td_bitspersample <= 8)
 			{
 				for (i = 0; i < count; ++i)
 					((int8*)conv)[i] = (int8)value[i];
-				ok = TIFFWriteDirectoryTagSbyteArray(tif,ndir,dir,tag,count,(int8*)conv);
+				ok = TIFFWriteDirectoryTagSbyteArray(tif, ndir, dir, tag, count, (int8*)conv);
 			}
-			else if (tif->tif_dir.td_bitspersample<=16)
+			else if (tif->tif_dir.td_bitspersample <= 16)
 			{
 				for (i = 0; i < count; ++i)
 					((int16*)conv)[i] = (int16)value[i];
-				ok = TIFFWriteDirectoryTagSshortArray(tif,ndir,dir,tag,count,(int16*)conv);
+				ok = TIFFWriteDirectoryTagSshortArray(tif, ndir, dir, tag, count, (int16*)conv);
 			}
 			else
 			{
 				for (i = 0; i < count; ++i)
 					((int32*)conv)[i] = (int32)value[i];
-				ok = TIFFWriteDirectoryTagSlongArray(tif,ndir,dir,tag,count,(int32*)conv);
+				ok = TIFFWriteDirectoryTagSlongArray(tif, ndir, dir, tag, count, (int32*)conv);
 			}
 			break;
 		case SAMPLEFORMAT_UINT:
-			if (tif->tif_dir.td_bitspersample<=8)
+			if (tif->tif_dir.td_bitspersample <= 8)
 			{
 				for (i = 0; i < count; ++i)
 					((uint8*)conv)[i] = (uint8)value[i];
-				ok = TIFFWriteDirectoryTagByteArray(tif,ndir,dir,tag,count,(uint8*)conv);
+				ok = TIFFWriteDirectoryTagByteArray(tif, ndir, dir, tag, count, (uint8*)conv);
 			}
-			else if (tif->tif_dir.td_bitspersample<=16)
+			else if (tif->tif_dir.td_bitspersample <= 16)
 			{
 				for (i = 0; i < count; ++i)
 					((uint16*)conv)[i] = (uint16)value[i];
-				ok = TIFFWriteDirectoryTagShortArray(tif,ndir,dir,tag,count,(uint16*)conv);
+				ok = TIFFWriteDirectoryTagShortArray(tif, ndir, dir, tag, count, (uint16*)conv);
 			}
 			else
 			{
 				for (i = 0; i < count; ++i)
 					((uint32*)conv)[i] = (uint32)value[i];
-				ok = TIFFWriteDirectoryTagLongArray(tif,ndir,dir,tag,count,(uint32*)conv);
+				ok = TIFFWriteDirectoryTagLongArray(tif, ndir, dir, tag, count, (uint32*)conv);
 			}
 			break;
 		default:
@@ -1015,6 +1021,7 @@
 	return (ok);
 }
 
+
 #if 0
 static int
 TIFFWriteDirectoryTagSampleformatPerSample(TIFF* tif, uint32* ndir, TIFFDirEntry* dir, uint16 tag, double value)

2025-02-05 21:11:16.841 | DEBUG    | scenario:rebuild:369 - original environment: environ({'CONDA_SHLVL': '2', 'LC_ALL': 'C.UTF-8', 'LS_COLORS': 'rs=0:di=01;34:ln=01;36:mh=00:pi=40;33:so=01;35:do=01;35:bd=40;33;01:cd=40;33;01:or=40;31;01:mi=00:su=37;41:sg=30;43:ca=30;41:tw=30;42:ow=34;42:st=37;44:ex=01;32:*.tar=01;31:*.tgz=01;31:*.arc=01;31:*.arj=01;31:*.taz=01;31:*.lha=01;31:*.lz4=01;31:*.lzh=01;31:*.lzma=01;31:*.tlz=01;31:*.txz=01;31:*.tzo=01;31:*.t7z=01;31:*.zip=01;31:*.z=01;31:*.Z=01;31:*.dz=01;31:*.gz=01;31:*.lrz=01;31:*.lz=01;31:*.lzo=01;31:*.xz=01;31:*.zst=01;31:*.tzst=01;31:*.bz2=01;31:*.bz=01;31:*.tbz=01;31:*.tbz2=01;31:*.tz=01;31:*.deb=01;31:*.rpm=01;31:*.jar=01;31:*.war=01;31:*.ear=01;31:*.sar=01;31:*.rar=01;31:*.alz=01;31:*.ace=01;31:*.zoo=01;31:*.cpio=01;31:*.7z=01;31:*.rz=01;31:*.cab=01;31:*.wim=01;31:*.swm=01;31:*.dwm=01;31:*.esd=01;31:*.jpg=01;35:*.jpeg=01;35:*.mjpg=01;35:*.mjpeg=01;35:*.gif=01;35:*.bmp=01;35:*.pbm=01;35:*.pgm=01;35:*.ppm=01;35:*.tga=01;35:*.xbm=01;35:*.xpm=01;35:*.tif=01;35:*.tiff=01;35:*.png=01;35:*.svg=01;35:*.svgz=01;35:*.mng=01;35:*.pcx=01;35:*.mov=01;35:*.mpg=01;35:*.mpeg=01;35:*.m2v=01;35:*.mkv=01;35:*.webm=01;35:*.ogm=01;35:*.mp4=01;35:*.m4v=01;35:*.mp4v=01;35:*.vob=01;35:*.qt=01;35:*.nuv=01;35:*.wmv=01;35:*.asf=01;35:*.rm=01;35:*.rmvb=01;35:*.flc=01;35:*.avi=01;35:*.fli=01;35:*.flv=01;35:*.gl=01;35:*.dl=01;35:*.xcf=01;35:*.xwd=01;35:*.yuv=01;35:*.cgm=01;35:*.emf=01;35:*.ogv=01;35:*.ogx=01;35:*.aac=00;36:*.au=00;36:*.flac=00;36:*.m4a=00;36:*.mid=00;36:*.midi=00;36:*.mka=00;36:*.mp3=00;36:*.mpc=00;36:*.ogg=00;36:*.ra=00;36:*.wav=00;36:*.oga=00;36:*.opus=00;36:*.spx=00;36:*.xspf=00;36:', 'LD_LIBRARY_PATH': '/opt/crashrepair/lib:/CrashRepair/lib:/klee/build/lib:', 'CONDA_EXE': '/root/anaconda3/bin/conda', 'LANG': 'C.UTF-8', 'TZ': 'Asia/Shanghai', 'HOSTNAME': 'fea22102047d', 'OLDPWD': '/orchestrator', 'CONDA_PREFIX': '/root/anaconda3/envs/CrashRepair', '_CE_M': '', 'CC': 'crepair-cc', 'LLVM_COMPILER': 'clang', 'CONDA_PREFIX_1': '/root/anaconda3', 'PWD': '/orchestrator/crashrepair', 'HOME': '/root', 'CONDA_PYTHON_EXE': '/root/anaconda3/bin/python', '_CE_CONDA': '', 'CONDA_PROMPT_MODIFIER': '(CrashRepair) ', 'CXX': 'crepair-cxx', 'TERM': 'xterm', 'SHLVL': '2', 'PYTHONPATH': '/usr/lib/python3.8/site-packages:', 'PATH': '/root/anaconda3/envs/CrashRepair/bin:/root/anaconda3/condabin:~/anaconda3/bin:/opt/crashrepair/bin:/CrashRepair/compiler:/klee/build/bin:/opt/llvm-6/bin:/klee/build/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', 'CONDA_DEFAULT_ENV': 'CrashRepair', '_': '/root/anaconda3/envs/CrashRepair/bin/python'})
2025-02-05 21:11:16.842 | DEBUG    | scenario:rebuild:398 - using environment: {'INJECT_CFLAGS': '-g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy ', 'INJECT_CXXFLAGS': '-g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy ', 'INJECT_LDFLAGS': '-g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy '}
2025-02-05 21:11:16.842 | DEBUG    | shell:__call__:41 - executing: make CFLAGS="-fsanitize=float-cast-overflow ${INJECT_CFLAGS}" CXXFLAGS="-fsanitize=float-cast-overflow ${INJECT_CXXFLAGS}" LDFLAGS="${INJECT_LDFLAGS}"
Making all in port
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/port'
make[1]: Nothing to be done for 'all'.
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/port'
Making all in libtiff
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/libtiff'
make  all-am
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/libtiff'
/bin/bash ../libtool  --tag=CC   --mode=compile crepair-cc -DHAVE_CONFIG_H -I.     -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -MT tif_dirwrite.lo -MD -MP -MF .deps/tif_dirwrite.Tpo -c -o tif_dirwrite.lo tif_dirwrite.c
libtool: compile:  crepair-cc -DHAVE_CONFIG_H -I. -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -MT tif_dirwrite.lo -MD -MP -MF .deps/tif_dirwrite.Tpo -c tif_dirwrite.c -o tif_dirwrite.o
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
mv -f .deps/tif_dirwrite.Tpo .deps/tif_dirwrite.Plo
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -no-undefined -version-info 7:5:2   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o libtiff.la -rpath /usr/local/lib tif_aux.lo tif_close.lo tif_codec.lo tif_color.lo tif_compress.lo tif_dir.lo tif_dirinfo.lo tif_dirread.lo tif_dirwrite.lo tif_dumpmode.lo tif_error.lo tif_extension.lo tif_fax3.lo tif_fax3sm.lo tif_flush.lo tif_getimage.lo tif_jbig.lo tif_jpeg.lo tif_jpeg_12.lo tif_luv.lo tif_lzma.lo tif_lzw.lo tif_next.lo tif_ojpeg.lo tif_open.lo tif_packbits.lo tif_pixarlog.lo tif_predict.lo tif_print.lo tif_read.lo tif_strip.lo tif_swab.lo tif_thunder.lo tif_tile.lo tif_version.lo tif_warning.lo tif_write.lo tif_zip.lo  tif_unix.lo ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: rm -fr  .libs/libtiff.a .libs/libtiff.la .libs/libtiff.lai
libtool: link: (cd .libs/libtiff.lax/libport.a && ar x "/data/vulnloc/libtiff/CVE-2017-7600/src/libtiff/../port/.libs/libport.a")
libtool: link: ar cru .libs/libtiff.a  tif_aux.o tif_close.o tif_codec.o tif_color.o tif_compress.o tif_dir.o tif_dirinfo.o tif_dirread.o tif_dirwrite.o tif_dumpmode.o tif_error.o tif_extension.o tif_fax3.o tif_fax3sm.o tif_flush.o tif_getimage.o tif_jbig.o tif_jpeg.o tif_jpeg_12.o tif_luv.o tif_lzma.o tif_lzw.o tif_next.o tif_ojpeg.o tif_open.o tif_packbits.o tif_pixarlog.o tif_predict.o tif_print.o tif_read.o tif_strip.o tif_swab.o tif_thunder.o tif_tile.o tif_version.o tif_warning.o tif_write.o tif_zip.o tif_unix.o  .libs/libtiff.lax/libport.a/dummy.o 
ar: `u' modifier ignored since `D' is the default (see `U')
libtool: link: ranlib .libs/libtiff.a
libtool: link: rm -fr .libs/libtiff.lax
libtool: link: ( cd ".libs" && rm -f "libtiff.la" && ln -s "../libtiff.la" "libtiff.la" )
/bin/bash ../libtool  --tag=CXX   --mode=link crepair-cxx  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -no-undefined -version-info 7:5:2   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o libtiffxx.la -rpath /usr/local/lib tif_stream.lo ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: rm -fr  .libs/libtiffxx.a .libs/libtiffxx.la .libs/libtiffxx.lai
libtool: link: (cd .libs/libtiffxx.lax/libport.a && ar x "/data/vulnloc/libtiff/CVE-2017-7600/src/libtiff/../port/.libs/libport.a")
libtool: link: ar cru .libs/libtiffxx.a  tif_stream.o  .libs/libtiffxx.lax/libport.a/dummy.o 
ar: `u' modifier ignored since `D' is the default (see `U')
libtool: link: ranlib .libs/libtiffxx.a
libtool: link: rm -fr .libs/libtiffxx.lax
libtool: link: ( cd ".libs" && rm -f "libtiffxx.la" && ln -s "../libtiffxx.la" "libtiffxx.la" )
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/libtiff'
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/libtiff'
Making all in tools
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/tools'
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o bmp2tiff bmp2tiff.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o bmp2tiff bmp2tiff.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o fax2ps fax2ps.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o fax2ps fax2ps.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o fax2tiff fax2tiff.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o fax2tiff fax2tiff.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o gif2tiff gif2tiff.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o gif2tiff gif2tiff.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o pal2rgb pal2rgb.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o pal2rgb pal2rgb.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o ppm2tiff ppm2tiff.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o ppm2tiff ppm2tiff.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o ras2tiff ras2tiff.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o ras2tiff ras2tiff.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o raw2tiff raw2tiff.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o raw2tiff raw2tiff.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o rgb2ycbcr rgb2ycbcr.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o rgb2ycbcr rgb2ycbcr.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o thumbnail thumbnail.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o thumbnail thumbnail.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o tiff2bw tiff2bw.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o tiff2bw tiff2bw.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o tiff2pdf tiff2pdf.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o tiff2pdf tiff2pdf.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o tiff2ps tiff2ps.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o tiff2ps tiff2ps.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o tiff2rgba tiff2rgba.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o tiff2rgba tiff2rgba.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o tiffcmp tiffcmp.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o tiffcmp tiffcmp.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o tiffcp tiffcp.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o tiffcp tiffcp.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o tiffcrop tiffcrop.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o tiffcrop tiffcrop.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o tiffdither tiffdither.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o tiffdither tiffdither.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o tiffdump tiffdump.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o tiffdump tiffdump.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o tiffinfo tiffinfo.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o tiffinfo tiffinfo.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o tiffmedian tiffmedian.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o tiffmedian tiffmedian.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o tiffset tiffset.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o tiffset tiffset.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o tiffsplit tiffsplit.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o tiffsplit tiffsplit.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/tools'
Making all in build
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/build'
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/build'
make[2]: Nothing to be done for 'all-am'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/build'
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/build'
Making all in contrib
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib'
Making all in addtiffo
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/addtiffo'
/bin/bash ../../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o addtiffo addtiffo.o tif_overview.o tif_ovrcache.o ../../libtiff/libtiff.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o addtiffo addtiffo.o tif_overview.o tif_ovrcache.o  -L/klee/build/lib -L/CrashRepair/lib ../../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy -llzma -ljbig -ljpeg -lz -lm
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/addtiffo'
Making all in dbs
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/dbs'
Making all in xtiff
make[3]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/dbs/xtiff'
make[3]: Nothing to be done for 'all'.
make[3]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/dbs/xtiff'
make[3]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/dbs'
/bin/bash ../../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o tiff-bi tiff-bi.o ../../libtiff/libtiff.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o tiff-bi tiff-bi.o  -L/klee/build/lib -L/CrashRepair/lib ../../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o tiff-grayscale tiff-grayscale.o ../../libtiff/libtiff.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o tiff-grayscale tiff-grayscale.o  -L/klee/build/lib -L/CrashRepair/lib ../../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o tiff-palette tiff-palette.o ../../libtiff/libtiff.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o tiff-palette tiff-palette.o  -L/klee/build/lib -L/CrashRepair/lib ../../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o tiff-rgb tiff-rgb.o ../../libtiff/libtiff.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o tiff-rgb tiff-rgb.o  -L/klee/build/lib -L/CrashRepair/lib ../../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy -llzma -ljbig -ljpeg -lz -lm
make[3]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/dbs'
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/dbs'
Making all in iptcutil
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/iptcutil'
/bin/bash ../../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o iptcutil iptcutil.o ../../libtiff/libtiff.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o iptcutil iptcutil.o  -L/klee/build/lib -L/CrashRepair/lib ../../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy -llzma -ljbig -ljpeg -lz -lm
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/iptcutil'
Making all in mfs
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/mfs'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/mfs'
Making all in pds
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/pds'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/pds'
Making all in ras
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/ras'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/ras'
Making all in stream
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/stream'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/stream'
Making all in tags
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/tags'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/tags'
Making all in win_dib
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/win_dib'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/win_dib'
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib'
make[2]: Nothing to be done for 'all-am'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib'
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib'
Making all in test
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/test'
make[1]: Nothing to be done for 'all'.
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/test'
Making all in man
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/man'
make[1]: Nothing to be done for 'all'.
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/man'
Making all in html
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/html'
Making all in images
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/html/images'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/html/images'
Making all in man
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/html/man'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/html/man'
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/html'
make[2]: Nothing to be done for 'all-am'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/html'
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/html'
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src'
make[1]: Nothing to be done for 'all-am'.
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src'
2025-02-05 21:11:21.355 | DEBUG    | scenario:evaluate:655 - testing candidate #24 against test #crash...
2025-02-05 21:11:21.355 | DEBUG    | shell:__call__:41 - executing: /data/vulnloc/libtiff/CVE-2017-7600/src/tools/tiffcp -i /CrashRepair/experiments/vulnloc/libtiff/CVE-2017-7600/tests/1.tif out.tiff
2025-02-05 21:11:21.360 | DEBUG    | test:run:172 - test failed: stderr contains bad output substring (runtime error: -115 is outside the range of representable values)
2025-02-05 21:11:21.360 | INFO     | scenario:evaluate:662 - candidate #24 fails test #crash
2025-02-05 21:11:21.369 | INFO     | scenario:evaluate:635 - evaluating candidate patch #25:
@@ -939,6 +939,7 @@
 	return(0);
 }
 
+
 static int
 TIFFWriteDirectoryTagSampleformatArray(TIFF* tif, uint32* ndir, TIFFDirEntry* dir, uint16 tag, uint32 count, double* value)
 {
@@ -953,58 +954,67 @@
 		return (0);
 	}
 
+	if (tif->tif_dir.td_sampleformat != SAMPLEFORMAT_IEEEFP && 
+	    tif->tif_dir.td_sampleformat != SAMPLEFORMAT_INT &&
+	    tif->tif_dir.td_sampleformat != SAMPLEFORMAT_UINT) 
+	{
+		TIFFErrorExt(tif->tif_clientdata, module, "Unsupported sample format");
+		_TIFFfree(conv);
+		return (0);
+	}
+
 	switch (tif->tif_dir.td_sampleformat)
 	{
 		case SAMPLEFORMAT_IEEEFP:
-			if (tif->tif_dir.td_bitspersample<=32)
+			if (tif->tif_dir.td_bitspersample <= 32)
 			{
 				for (i = 0; i < count; ++i)
 					((float*)conv)[i] = (float)value[i];
-				ok = TIFFWriteDirectoryTagFloatArray(tif,ndir,dir,tag,count,(float*)conv);
+				ok = TIFFWriteDirectoryTagFloatArray(tif, ndir, dir, tag, count, (float*)conv);
 			}
 			else
 			{
-				ok = TIFFWriteDirectoryTagDoubleArray(tif,ndir,dir,tag,count,value);
+				ok = TIFFWriteDirectoryTagDoubleArray(tif, ndir, dir, tag, count, value);
 			}
 			break;
 		case SAMPLEFORMAT_INT:
-			if (tif->tif_dir.td_bitspersample<=8)
+			if (tif->tif_dir.td_bitspersample <= 8)
 			{
 				for (i = 0; i < count; ++i)
 					((int8*)conv)[i] = (int8)value[i];
-				ok = TIFFWriteDirectoryTagSbyteArray(tif,ndir,dir,tag,count,(int8*)conv);
+				ok = TIFFWriteDirectoryTagSbyteArray(tif, ndir, dir, tag, count, (int8*)conv);
 			}
-			else if (tif->tif_dir.td_bitspersample<=16)
+			else if (tif->tif_dir.td_bitspersample <= 16)
 			{
 				for (i = 0; i < count; ++i)
 					((int16*)conv)[i] = (int16)value[i];
-				ok = TIFFWriteDirectoryTagSshortArray(tif,ndir,dir,tag,count,(int16*)conv);
+				ok = TIFFWriteDirectoryTagSshortArray(tif, ndir, dir, tag, count, (int16*)conv);
 			}
 			else
 			{
 				for (i = 0; i < count; ++i)
 					((int32*)conv)[i] = (int32)value[i];
-				ok = TIFFWriteDirectoryTagSlongArray(tif,ndir,dir,tag,count,(int32*)conv);
+				ok = TIFFWriteDirectoryTagSlongArray(tif, ndir, dir, tag, count, (int32*)conv);
 			}
 			break;
 		case SAMPLEFORMAT_UINT:
-			if (tif->tif_dir.td_bitspersample<=8)
+			if (tif->tif_dir.td_bitspersample <= 8)
 			{
 				for (i = 0; i < count; ++i)
 					((uint8*)conv)[i] = (uint8)value[i];
-				ok = TIFFWriteDirectoryTagByteArray(tif,ndir,dir,tag,count,(uint8*)conv);
+				ok = TIFFWriteDirectoryTagByteArray(tif, ndir, dir, tag, count, (uint8*)conv);
 			}
-			else if (tif->tif_dir.td_bitspersample<=16)
+			else if (tif->tif_dir.td_bitspersample <= 16)
 			{
 				for (i = 0; i < count; ++i)
 					((uint16*)conv)[i] = (uint16)value[i];
-				ok = TIFFWriteDirectoryTagShortArray(tif,ndir,dir,tag,count,(uint16*)conv);
+				ok = TIFFWriteDirectoryTagShortArray(tif, ndir, dir, tag, count, (uint16*)conv);
 			}
 			else
 			{
 				for (i = 0; i < count; ++i)
 					((uint32*)conv)[i] = (uint32)value[i];
-				ok = TIFFWriteDirectoryTagLongArray(tif,ndir,dir,tag,count,(uint32*)conv);
+				ok = TIFFWriteDirectoryTagLongArray(tif, ndir, dir, tag, count, (uint32*)conv);
 			}
 			break;
 		default:
@@ -1015,6 +1025,7 @@
 	return (ok);
 }
 
+
 #if 0
 static int
 TIFFWriteDirectoryTagSampleformatPerSample(TIFF* tif, uint32* ndir, TIFFDirEntry* dir, uint16 tag, double value)

2025-02-05 21:11:21.377 | DEBUG    | scenario:rebuild:369 - original environment: environ({'CONDA_SHLVL': '2', 'LC_ALL': 'C.UTF-8', 'LS_COLORS': 'rs=0:di=01;34:ln=01;36:mh=00:pi=40;33:so=01;35:do=01;35:bd=40;33;01:cd=40;33;01:or=40;31;01:mi=00:su=37;41:sg=30;43:ca=30;41:tw=30;42:ow=34;42:st=37;44:ex=01;32:*.tar=01;31:*.tgz=01;31:*.arc=01;31:*.arj=01;31:*.taz=01;31:*.lha=01;31:*.lz4=01;31:*.lzh=01;31:*.lzma=01;31:*.tlz=01;31:*.txz=01;31:*.tzo=01;31:*.t7z=01;31:*.zip=01;31:*.z=01;31:*.Z=01;31:*.dz=01;31:*.gz=01;31:*.lrz=01;31:*.lz=01;31:*.lzo=01;31:*.xz=01;31:*.zst=01;31:*.tzst=01;31:*.bz2=01;31:*.bz=01;31:*.tbz=01;31:*.tbz2=01;31:*.tz=01;31:*.deb=01;31:*.rpm=01;31:*.jar=01;31:*.war=01;31:*.ear=01;31:*.sar=01;31:*.rar=01;31:*.alz=01;31:*.ace=01;31:*.zoo=01;31:*.cpio=01;31:*.7z=01;31:*.rz=01;31:*.cab=01;31:*.wim=01;31:*.swm=01;31:*.dwm=01;31:*.esd=01;31:*.jpg=01;35:*.jpeg=01;35:*.mjpg=01;35:*.mjpeg=01;35:*.gif=01;35:*.bmp=01;35:*.pbm=01;35:*.pgm=01;35:*.ppm=01;35:*.tga=01;35:*.xbm=01;35:*.xpm=01;35:*.tif=01;35:*.tiff=01;35:*.png=01;35:*.svg=01;35:*.svgz=01;35:*.mng=01;35:*.pcx=01;35:*.mov=01;35:*.mpg=01;35:*.mpeg=01;35:*.m2v=01;35:*.mkv=01;35:*.webm=01;35:*.ogm=01;35:*.mp4=01;35:*.m4v=01;35:*.mp4v=01;35:*.vob=01;35:*.qt=01;35:*.nuv=01;35:*.wmv=01;35:*.asf=01;35:*.rm=01;35:*.rmvb=01;35:*.flc=01;35:*.avi=01;35:*.fli=01;35:*.flv=01;35:*.gl=01;35:*.dl=01;35:*.xcf=01;35:*.xwd=01;35:*.yuv=01;35:*.cgm=01;35:*.emf=01;35:*.ogv=01;35:*.ogx=01;35:*.aac=00;36:*.au=00;36:*.flac=00;36:*.m4a=00;36:*.mid=00;36:*.midi=00;36:*.mka=00;36:*.mp3=00;36:*.mpc=00;36:*.ogg=00;36:*.ra=00;36:*.wav=00;36:*.oga=00;36:*.opus=00;36:*.spx=00;36:*.xspf=00;36:', 'LD_LIBRARY_PATH': '/opt/crashrepair/lib:/CrashRepair/lib:/klee/build/lib:', 'CONDA_EXE': '/root/anaconda3/bin/conda', 'LANG': 'C.UTF-8', 'TZ': 'Asia/Shanghai', 'HOSTNAME': 'fea22102047d', 'OLDPWD': '/orchestrator', 'CONDA_PREFIX': '/root/anaconda3/envs/CrashRepair', '_CE_M': '', 'CC': 'crepair-cc', 'LLVM_COMPILER': 'clang', 'CONDA_PREFIX_1': '/root/anaconda3', 'PWD': '/orchestrator/crashrepair', 'HOME': '/root', 'CONDA_PYTHON_EXE': '/root/anaconda3/bin/python', '_CE_CONDA': '', 'CONDA_PROMPT_MODIFIER': '(CrashRepair) ', 'CXX': 'crepair-cxx', 'TERM': 'xterm', 'SHLVL': '2', 'PYTHONPATH': '/usr/lib/python3.8/site-packages:', 'PATH': '/root/anaconda3/envs/CrashRepair/bin:/root/anaconda3/condabin:~/anaconda3/bin:/opt/crashrepair/bin:/CrashRepair/compiler:/klee/build/bin:/opt/llvm-6/bin:/klee/build/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', 'CONDA_DEFAULT_ENV': 'CrashRepair', '_': '/root/anaconda3/envs/CrashRepair/bin/python'})
2025-02-05 21:11:21.377 | DEBUG    | scenario:rebuild:398 - using environment: {'INJECT_CFLAGS': '-g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy ', 'INJECT_CXXFLAGS': '-g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy ', 'INJECT_LDFLAGS': '-g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy '}
2025-02-05 21:11:21.377 | DEBUG    | shell:__call__:41 - executing: make CFLAGS="-fsanitize=float-cast-overflow ${INJECT_CFLAGS}" CXXFLAGS="-fsanitize=float-cast-overflow ${INJECT_CXXFLAGS}" LDFLAGS="${INJECT_LDFLAGS}"
Making all in port
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/port'
make[1]: Nothing to be done for 'all'.
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/port'
Making all in libtiff
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/libtiff'
make  all-am
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/libtiff'
/bin/bash ../libtool  --tag=CC   --mode=compile crepair-cc -DHAVE_CONFIG_H -I.     -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -MT tif_dirwrite.lo -MD -MP -MF .deps/tif_dirwrite.Tpo -c -o tif_dirwrite.lo tif_dirwrite.c
libtool: compile:  crepair-cc -DHAVE_CONFIG_H -I. -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -MT tif_dirwrite.lo -MD -MP -MF .deps/tif_dirwrite.Tpo -c tif_dirwrite.c -o tif_dirwrite.o
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
mv -f .deps/tif_dirwrite.Tpo .deps/tif_dirwrite.Plo
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -no-undefined -version-info 7:5:2   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o libtiff.la -rpath /usr/local/lib tif_aux.lo tif_close.lo tif_codec.lo tif_color.lo tif_compress.lo tif_dir.lo tif_dirinfo.lo tif_dirread.lo tif_dirwrite.lo tif_dumpmode.lo tif_error.lo tif_extension.lo tif_fax3.lo tif_fax3sm.lo tif_flush.lo tif_getimage.lo tif_jbig.lo tif_jpeg.lo tif_jpeg_12.lo tif_luv.lo tif_lzma.lo tif_lzw.lo tif_next.lo tif_ojpeg.lo tif_open.lo tif_packbits.lo tif_pixarlog.lo tif_predict.lo tif_print.lo tif_read.lo tif_strip.lo tif_swab.lo tif_thunder.lo tif_tile.lo tif_version.lo tif_warning.lo tif_write.lo tif_zip.lo  tif_unix.lo ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: rm -fr  .libs/libtiff.a .libs/libtiff.la .libs/libtiff.lai
libtool: link: (cd .libs/libtiff.lax/libport.a && ar x "/data/vulnloc/libtiff/CVE-2017-7600/src/libtiff/../port/.libs/libport.a")
libtool: link: ar cru .libs/libtiff.a  tif_aux.o tif_close.o tif_codec.o tif_color.o tif_compress.o tif_dir.o tif_dirinfo.o tif_dirread.o tif_dirwrite.o tif_dumpmode.o tif_error.o tif_extension.o tif_fax3.o tif_fax3sm.o tif_flush.o tif_getimage.o tif_jbig.o tif_jpeg.o tif_jpeg_12.o tif_luv.o tif_lzma.o tif_lzw.o tif_next.o tif_ojpeg.o tif_open.o tif_packbits.o tif_pixarlog.o tif_predict.o tif_print.o tif_read.o tif_strip.o tif_swab.o tif_thunder.o tif_tile.o tif_version.o tif_warning.o tif_write.o tif_zip.o tif_unix.o  .libs/libtiff.lax/libport.a/dummy.o 
ar: `u' modifier ignored since `D' is the default (see `U')
libtool: link: ranlib .libs/libtiff.a
libtool: link: rm -fr .libs/libtiff.lax
libtool: link: ( cd ".libs" && rm -f "libtiff.la" && ln -s "../libtiff.la" "libtiff.la" )
/bin/bash ../libtool  --tag=CXX   --mode=link crepair-cxx  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -no-undefined -version-info 7:5:2   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o libtiffxx.la -rpath /usr/local/lib tif_stream.lo ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: rm -fr  .libs/libtiffxx.a .libs/libtiffxx.la .libs/libtiffxx.lai
libtool: link: (cd .libs/libtiffxx.lax/libport.a && ar x "/data/vulnloc/libtiff/CVE-2017-7600/src/libtiff/../port/.libs/libport.a")
libtool: link: ar cru .libs/libtiffxx.a  tif_stream.o  .libs/libtiffxx.lax/libport.a/dummy.o 
ar: `u' modifier ignored since `D' is the default (see `U')
libtool: link: ranlib .libs/libtiffxx.a
libtool: link: rm -fr .libs/libtiffxx.lax
libtool: link: ( cd ".libs" && rm -f "libtiffxx.la" && ln -s "../libtiffxx.la" "libtiffxx.la" )
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/libtiff'
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/libtiff'
Making all in tools
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/tools'
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o bmp2tiff bmp2tiff.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o bmp2tiff bmp2tiff.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o fax2ps fax2ps.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o fax2ps fax2ps.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o fax2tiff fax2tiff.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o fax2tiff fax2tiff.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o gif2tiff gif2tiff.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o gif2tiff gif2tiff.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o pal2rgb pal2rgb.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o pal2rgb pal2rgb.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o ppm2tiff ppm2tiff.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o ppm2tiff ppm2tiff.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o ras2tiff ras2tiff.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o ras2tiff ras2tiff.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o raw2tiff raw2tiff.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o raw2tiff raw2tiff.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o rgb2ycbcr rgb2ycbcr.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o rgb2ycbcr rgb2ycbcr.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o thumbnail thumbnail.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o thumbnail thumbnail.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o tiff2bw tiff2bw.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o tiff2bw tiff2bw.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o tiff2pdf tiff2pdf.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o tiff2pdf tiff2pdf.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o tiff2ps tiff2ps.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o tiff2ps tiff2ps.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o tiff2rgba tiff2rgba.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o tiff2rgba tiff2rgba.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o tiffcmp tiffcmp.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o tiffcmp tiffcmp.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o tiffcp tiffcp.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o tiffcp tiffcp.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o tiffcrop tiffcrop.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o tiffcrop tiffcrop.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o tiffdither tiffdither.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o tiffdither tiffdither.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o tiffdump tiffdump.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o tiffdump tiffdump.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o tiffinfo tiffinfo.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o tiffinfo tiffinfo.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o tiffmedian tiffmedian.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o tiffmedian tiffmedian.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o tiffset tiffset.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o tiffset tiffset.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o tiffsplit tiffsplit.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o tiffsplit tiffsplit.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/tools'
Making all in build
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/build'
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/build'
make[2]: Nothing to be done for 'all-am'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/build'
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/build'
Making all in contrib
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib'
Making all in addtiffo
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/addtiffo'
/bin/bash ../../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o addtiffo addtiffo.o tif_overview.o tif_ovrcache.o ../../libtiff/libtiff.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o addtiffo addtiffo.o tif_overview.o tif_ovrcache.o  -L/klee/build/lib -L/CrashRepair/lib ../../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy -llzma -ljbig -ljpeg -lz -lm
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/addtiffo'
Making all in dbs
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/dbs'
Making all in xtiff
make[3]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/dbs/xtiff'
make[3]: Nothing to be done for 'all'.
make[3]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/dbs/xtiff'
make[3]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/dbs'
/bin/bash ../../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o tiff-bi tiff-bi.o ../../libtiff/libtiff.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o tiff-bi tiff-bi.o  -L/klee/build/lib -L/CrashRepair/lib ../../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o tiff-grayscale tiff-grayscale.o ../../libtiff/libtiff.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o tiff-grayscale tiff-grayscale.o  -L/klee/build/lib -L/CrashRepair/lib ../../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o tiff-palette tiff-palette.o ../../libtiff/libtiff.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o tiff-palette tiff-palette.o  -L/klee/build/lib -L/CrashRepair/lib ../../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o tiff-rgb tiff-rgb.o ../../libtiff/libtiff.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o tiff-rgb tiff-rgb.o  -L/klee/build/lib -L/CrashRepair/lib ../../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy -llzma -ljbig -ljpeg -lz -lm
make[3]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/dbs'
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/dbs'
Making all in iptcutil
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/iptcutil'
/bin/bash ../../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o iptcutil iptcutil.o ../../libtiff/libtiff.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o iptcutil iptcutil.o  -L/klee/build/lib -L/CrashRepair/lib ../../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy -llzma -ljbig -ljpeg -lz -lm
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/iptcutil'
Making all in mfs
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/mfs'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/mfs'
Making all in pds
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/pds'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/pds'
Making all in ras
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/ras'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/ras'
Making all in stream
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/stream'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/stream'
Making all in tags
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/tags'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/tags'
Making all in win_dib
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/win_dib'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/win_dib'
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib'
make[2]: Nothing to be done for 'all-am'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib'
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib'
Making all in test
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/test'
make[1]: Nothing to be done for 'all'.
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/test'
Making all in man
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/man'
make[1]: Nothing to be done for 'all'.
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/man'
Making all in html
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/html'
Making all in images
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/html/images'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/html/images'
Making all in man
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/html/man'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/html/man'
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/html'
make[2]: Nothing to be done for 'all-am'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/html'
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/html'
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src'
make[1]: Nothing to be done for 'all-am'.
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src'
2025-02-05 21:11:25.802 | DEBUG    | scenario:evaluate:655 - testing candidate #25 against test #crash...
2025-02-05 21:11:25.802 | DEBUG    | shell:__call__:41 - executing: /data/vulnloc/libtiff/CVE-2017-7600/src/tools/tiffcp -i /CrashRepair/experiments/vulnloc/libtiff/CVE-2017-7600/tests/1.tif out.tiff
2025-02-05 21:11:25.810 | DEBUG    | test:run:172 - test failed: stderr contains bad output substring (runtime error: -115 is outside the range of representable values)
2025-02-05 21:11:25.810 | INFO     | scenario:evaluate:662 - candidate #25 fails test #crash
2025-02-05 21:11:25.819 | INFO     | scenario:evaluate:635 - evaluating candidate patch #26:
@@ -939,6 +939,7 @@
 	return(0);
 }
 
+
 static int
 TIFFWriteDirectoryTagSampleformatArray(TIFF* tif, uint32* ndir, TIFFDirEntry* dir, uint16 tag, uint32 count, double* value)
 {
@@ -946,7 +947,11 @@
 	void* conv;
 	uint32 i;
 	int ok;
-	conv = _TIFFmalloc(count*sizeof(double));
+	if (tif == NULL || value == NULL || count == 0) {
+		TIFFErrorExt(tif ? tif->tif_clientdata : 0, module, "Invalid input parameters");
+		return (0);
+	}
+	conv = _TIFFmalloc(count * sizeof(double));
 	if (conv == NULL)
 	{
 		TIFFErrorExt(tif->tif_clientdata, module, "Out of memory");
@@ -956,55 +961,55 @@
 	switch (tif->tif_dir.td_sampleformat)
 	{
 		case SAMPLEFORMAT_IEEEFP:
-			if (tif->tif_dir.td_bitspersample<=32)
+			if (tif->tif_dir.td_bitspersample <= 32)
 			{
 				for (i = 0; i < count; ++i)
 					((float*)conv)[i] = (float)value[i];
-				ok = TIFFWriteDirectoryTagFloatArray(tif,ndir,dir,tag,count,(float*)conv);
+				ok = TIFFWriteDirectoryTagFloatArray(tif, ndir, dir, tag, count, (float*)conv);
 			}
 			else
 			{
-				ok = TIFFWriteDirectoryTagDoubleArray(tif,ndir,dir,tag,count,value);
+				ok = TIFFWriteDirectoryTagDoubleArray(tif, ndir, dir, tag, count, value);
 			}
 			break;
 		case SAMPLEFORMAT_INT:
-			if (tif->tif_dir.td_bitspersample<=8)
+			if (tif->tif_dir.td_bitspersample <= 8)
 			{
 				for (i = 0; i < count; ++i)
 					((int8*)conv)[i] = (int8)value[i];
-				ok = TIFFWriteDirectoryTagSbyteArray(tif,ndir,dir,tag,count,(int8*)conv);
+				ok = TIFFWriteDirectoryTagSbyteArray(tif, ndir, dir, tag, count, (int8*)conv);
 			}
-			else if (tif->tif_dir.td_bitspersample<=16)
+			else if (tif->tif_dir.td_bitspersample <= 16)
 			{
 				for (i = 0; i < count; ++i)
 					((int16*)conv)[i] = (int16)value[i];
-				ok = TIFFWriteDirectoryTagSshortArray(tif,ndir,dir,tag,count,(int16*)conv);
+				ok = TIFFWriteDirectoryTagSshortArray(tif, ndir, dir, tag, count, (int16*)conv);
 			}
 			else
 			{
 				for (i = 0; i < count; ++i)
 					((int32*)conv)[i] = (int32)value[i];
-				ok = TIFFWriteDirectoryTagSlongArray(tif,ndir,dir,tag,count,(int32*)conv);
+				ok = TIFFWriteDirectoryTagSlongArray(tif, ndir, dir, tag, count, (int32*)conv);
 			}
 			break;
 		case SAMPLEFORMAT_UINT:
-			if (tif->tif_dir.td_bitspersample<=8)
+			if (tif->tif_dir.td_bitspersample <= 8)
 			{
 				for (i = 0; i < count; ++i)
 					((uint8*)conv)[i] = (uint8)value[i];
-				ok = TIFFWriteDirectoryTagByteArray(tif,ndir,dir,tag,count,(uint8*)conv);
+				ok = TIFFWriteDirectoryTagByteArray(tif, ndir, dir, tag, count, (uint8*)conv);
 			}
-			else if (tif->tif_dir.td_bitspersample<=16)
+			else if (tif->tif_dir.td_bitspersample <= 16)
 			{
 				for (i = 0; i < count; ++i)
 					((uint16*)conv)[i] = (uint16)value[i];
-				ok = TIFFWriteDirectoryTagShortArray(tif,ndir,dir,tag,count,(uint16*)conv);
+				ok = TIFFWriteDirectoryTagShortArray(tif, ndir, dir, tag, count, (uint16*)conv);
 			}
 			else
 			{
 				for (i = 0; i < count; ++i)
 					((uint32*)conv)[i] = (uint32)value[i];
-				ok = TIFFWriteDirectoryTagLongArray(tif,ndir,dir,tag,count,(uint32*)conv);
+				ok = TIFFWriteDirectoryTagLongArray(tif, ndir, dir, tag, count, (uint32*)conv);
 			}
 			break;
 		default:
@@ -1015,6 +1020,7 @@
 	return (ok);
 }
 
+
 #if 0
 static int
 TIFFWriteDirectoryTagSampleformatPerSample(TIFF* tif, uint32* ndir, TIFFDirEntry* dir, uint16 tag, double value)

2025-02-05 21:11:25.825 | DEBUG    | scenario:rebuild:369 - original environment: environ({'CONDA_SHLVL': '2', 'LC_ALL': 'C.UTF-8', 'LS_COLORS': 'rs=0:di=01;34:ln=01;36:mh=00:pi=40;33:so=01;35:do=01;35:bd=40;33;01:cd=40;33;01:or=40;31;01:mi=00:su=37;41:sg=30;43:ca=30;41:tw=30;42:ow=34;42:st=37;44:ex=01;32:*.tar=01;31:*.tgz=01;31:*.arc=01;31:*.arj=01;31:*.taz=01;31:*.lha=01;31:*.lz4=01;31:*.lzh=01;31:*.lzma=01;31:*.tlz=01;31:*.txz=01;31:*.tzo=01;31:*.t7z=01;31:*.zip=01;31:*.z=01;31:*.Z=01;31:*.dz=01;31:*.gz=01;31:*.lrz=01;31:*.lz=01;31:*.lzo=01;31:*.xz=01;31:*.zst=01;31:*.tzst=01;31:*.bz2=01;31:*.bz=01;31:*.tbz=01;31:*.tbz2=01;31:*.tz=01;31:*.deb=01;31:*.rpm=01;31:*.jar=01;31:*.war=01;31:*.ear=01;31:*.sar=01;31:*.rar=01;31:*.alz=01;31:*.ace=01;31:*.zoo=01;31:*.cpio=01;31:*.7z=01;31:*.rz=01;31:*.cab=01;31:*.wim=01;31:*.swm=01;31:*.dwm=01;31:*.esd=01;31:*.jpg=01;35:*.jpeg=01;35:*.mjpg=01;35:*.mjpeg=01;35:*.gif=01;35:*.bmp=01;35:*.pbm=01;35:*.pgm=01;35:*.ppm=01;35:*.tga=01;35:*.xbm=01;35:*.xpm=01;35:*.tif=01;35:*.tiff=01;35:*.png=01;35:*.svg=01;35:*.svgz=01;35:*.mng=01;35:*.pcx=01;35:*.mov=01;35:*.mpg=01;35:*.mpeg=01;35:*.m2v=01;35:*.mkv=01;35:*.webm=01;35:*.ogm=01;35:*.mp4=01;35:*.m4v=01;35:*.mp4v=01;35:*.vob=01;35:*.qt=01;35:*.nuv=01;35:*.wmv=01;35:*.asf=01;35:*.rm=01;35:*.rmvb=01;35:*.flc=01;35:*.avi=01;35:*.fli=01;35:*.flv=01;35:*.gl=01;35:*.dl=01;35:*.xcf=01;35:*.xwd=01;35:*.yuv=01;35:*.cgm=01;35:*.emf=01;35:*.ogv=01;35:*.ogx=01;35:*.aac=00;36:*.au=00;36:*.flac=00;36:*.m4a=00;36:*.mid=00;36:*.midi=00;36:*.mka=00;36:*.mp3=00;36:*.mpc=00;36:*.ogg=00;36:*.ra=00;36:*.wav=00;36:*.oga=00;36:*.opus=00;36:*.spx=00;36:*.xspf=00;36:', 'LD_LIBRARY_PATH': '/opt/crashrepair/lib:/CrashRepair/lib:/klee/build/lib:', 'CONDA_EXE': '/root/anaconda3/bin/conda', 'LANG': 'C.UTF-8', 'TZ': 'Asia/Shanghai', 'HOSTNAME': 'fea22102047d', 'OLDPWD': '/orchestrator', 'CONDA_PREFIX': '/root/anaconda3/envs/CrashRepair', '_CE_M': '', 'CC': 'crepair-cc', 'LLVM_COMPILER': 'clang', 'CONDA_PREFIX_1': '/root/anaconda3', 'PWD': '/orchestrator/crashrepair', 'HOME': '/root', 'CONDA_PYTHON_EXE': '/root/anaconda3/bin/python', '_CE_CONDA': '', 'CONDA_PROMPT_MODIFIER': '(CrashRepair) ', 'CXX': 'crepair-cxx', 'TERM': 'xterm', 'SHLVL': '2', 'PYTHONPATH': '/usr/lib/python3.8/site-packages:', 'PATH': '/root/anaconda3/envs/CrashRepair/bin:/root/anaconda3/condabin:~/anaconda3/bin:/opt/crashrepair/bin:/CrashRepair/compiler:/klee/build/bin:/opt/llvm-6/bin:/klee/build/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', 'CONDA_DEFAULT_ENV': 'CrashRepair', '_': '/root/anaconda3/envs/CrashRepair/bin/python'})
2025-02-05 21:11:25.825 | DEBUG    | scenario:rebuild:398 - using environment: {'INJECT_CFLAGS': '-g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy ', 'INJECT_CXXFLAGS': '-g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy ', 'INJECT_LDFLAGS': '-g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy '}
2025-02-05 21:11:25.825 | DEBUG    | shell:__call__:41 - executing: make CFLAGS="-fsanitize=float-cast-overflow ${INJECT_CFLAGS}" CXXFLAGS="-fsanitize=float-cast-overflow ${INJECT_CXXFLAGS}" LDFLAGS="${INJECT_LDFLAGS}"
Making all in port
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/port'
make[1]: Nothing to be done for 'all'.
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/port'
Making all in libtiff
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/libtiff'
make  all-am
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/libtiff'
/bin/bash ../libtool  --tag=CC   --mode=compile crepair-cc -DHAVE_CONFIG_H -I.     -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -MT tif_dirwrite.lo -MD -MP -MF .deps/tif_dirwrite.Tpo -c -o tif_dirwrite.lo tif_dirwrite.c
libtool: compile:  crepair-cc -DHAVE_CONFIG_H -I. -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -MT tif_dirwrite.lo -MD -MP -MF .deps/tif_dirwrite.Tpo -c tif_dirwrite.c -o tif_dirwrite.o
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
mv -f .deps/tif_dirwrite.Tpo .deps/tif_dirwrite.Plo
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -no-undefined -version-info 7:5:2   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o libtiff.la -rpath /usr/local/lib tif_aux.lo tif_close.lo tif_codec.lo tif_color.lo tif_compress.lo tif_dir.lo tif_dirinfo.lo tif_dirread.lo tif_dirwrite.lo tif_dumpmode.lo tif_error.lo tif_extension.lo tif_fax3.lo tif_fax3sm.lo tif_flush.lo tif_getimage.lo tif_jbig.lo tif_jpeg.lo tif_jpeg_12.lo tif_luv.lo tif_lzma.lo tif_lzw.lo tif_next.lo tif_ojpeg.lo tif_open.lo tif_packbits.lo tif_pixarlog.lo tif_predict.lo tif_print.lo tif_read.lo tif_strip.lo tif_swab.lo tif_thunder.lo tif_tile.lo tif_version.lo tif_warning.lo tif_write.lo tif_zip.lo  tif_unix.lo ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: rm -fr  .libs/libtiff.a .libs/libtiff.la .libs/libtiff.lai
libtool: link: (cd .libs/libtiff.lax/libport.a && ar x "/data/vulnloc/libtiff/CVE-2017-7600/src/libtiff/../port/.libs/libport.a")
libtool: link: ar cru .libs/libtiff.a  tif_aux.o tif_close.o tif_codec.o tif_color.o tif_compress.o tif_dir.o tif_dirinfo.o tif_dirread.o tif_dirwrite.o tif_dumpmode.o tif_error.o tif_extension.o tif_fax3.o tif_fax3sm.o tif_flush.o tif_getimage.o tif_jbig.o tif_jpeg.o tif_jpeg_12.o tif_luv.o tif_lzma.o tif_lzw.o tif_next.o tif_ojpeg.o tif_open.o tif_packbits.o tif_pixarlog.o tif_predict.o tif_print.o tif_read.o tif_strip.o tif_swab.o tif_thunder.o tif_tile.o tif_version.o tif_warning.o tif_write.o tif_zip.o tif_unix.o  .libs/libtiff.lax/libport.a/dummy.o 
ar: `u' modifier ignored since `D' is the default (see `U')
libtool: link: ranlib .libs/libtiff.a
libtool: link: rm -fr .libs/libtiff.lax
libtool: link: ( cd ".libs" && rm -f "libtiff.la" && ln -s "../libtiff.la" "libtiff.la" )
/bin/bash ../libtool  --tag=CXX   --mode=link crepair-cxx  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -no-undefined -version-info 7:5:2   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o libtiffxx.la -rpath /usr/local/lib tif_stream.lo ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: rm -fr  .libs/libtiffxx.a .libs/libtiffxx.la .libs/libtiffxx.lai
libtool: link: (cd .libs/libtiffxx.lax/libport.a && ar x "/data/vulnloc/libtiff/CVE-2017-7600/src/libtiff/../port/.libs/libport.a")
libtool: link: ar cru .libs/libtiffxx.a  tif_stream.o  .libs/libtiffxx.lax/libport.a/dummy.o 
ar: `u' modifier ignored since `D' is the default (see `U')
libtool: link: ranlib .libs/libtiffxx.a
libtool: link: rm -fr .libs/libtiffxx.lax
libtool: link: ( cd ".libs" && rm -f "libtiffxx.la" && ln -s "../libtiffxx.la" "libtiffxx.la" )
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/libtiff'
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/libtiff'
Making all in tools
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/tools'
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o bmp2tiff bmp2tiff.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o bmp2tiff bmp2tiff.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o fax2ps fax2ps.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o fax2ps fax2ps.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o fax2tiff fax2tiff.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o fax2tiff fax2tiff.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o gif2tiff gif2tiff.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o gif2tiff gif2tiff.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o pal2rgb pal2rgb.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o pal2rgb pal2rgb.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o ppm2tiff ppm2tiff.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o ppm2tiff ppm2tiff.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o ras2tiff ras2tiff.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o ras2tiff ras2tiff.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o raw2tiff raw2tiff.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o raw2tiff raw2tiff.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o rgb2ycbcr rgb2ycbcr.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o rgb2ycbcr rgb2ycbcr.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o thumbnail thumbnail.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o thumbnail thumbnail.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o tiff2bw tiff2bw.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o tiff2bw tiff2bw.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o tiff2pdf tiff2pdf.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o tiff2pdf tiff2pdf.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o tiff2ps tiff2ps.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o tiff2ps tiff2ps.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o tiff2rgba tiff2rgba.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o tiff2rgba tiff2rgba.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o tiffcmp tiffcmp.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o tiffcmp tiffcmp.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o tiffcp tiffcp.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o tiffcp tiffcp.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o tiffcrop tiffcrop.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o tiffcrop tiffcrop.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o tiffdither tiffdither.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o tiffdither tiffdither.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o tiffdump tiffdump.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o tiffdump tiffdump.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o tiffinfo tiffinfo.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o tiffinfo tiffinfo.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o tiffmedian tiffmedian.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o tiffmedian tiffmedian.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o tiffset tiffset.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o tiffset tiffset.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o tiffsplit tiffsplit.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o tiffsplit tiffsplit.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/tools'
Making all in build
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/build'
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/build'
make[2]: Nothing to be done for 'all-am'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/build'
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/build'
Making all in contrib
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib'
Making all in addtiffo
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/addtiffo'
/bin/bash ../../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o addtiffo addtiffo.o tif_overview.o tif_ovrcache.o ../../libtiff/libtiff.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o addtiffo addtiffo.o tif_overview.o tif_ovrcache.o  -L/klee/build/lib -L/CrashRepair/lib ../../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy -llzma -ljbig -ljpeg -lz -lm
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/addtiffo'
Making all in dbs
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/dbs'
Making all in xtiff
make[3]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/dbs/xtiff'
make[3]: Nothing to be done for 'all'.
make[3]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/dbs/xtiff'
make[3]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/dbs'
/bin/bash ../../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o tiff-bi tiff-bi.o ../../libtiff/libtiff.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o tiff-bi tiff-bi.o  -L/klee/build/lib -L/CrashRepair/lib ../../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o tiff-grayscale tiff-grayscale.o ../../libtiff/libtiff.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o tiff-grayscale tiff-grayscale.o  -L/klee/build/lib -L/CrashRepair/lib ../../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o tiff-palette tiff-palette.o ../../libtiff/libtiff.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o tiff-palette tiff-palette.o  -L/klee/build/lib -L/CrashRepair/lib ../../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o tiff-rgb tiff-rgb.o ../../libtiff/libtiff.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o tiff-rgb tiff-rgb.o  -L/klee/build/lib -L/CrashRepair/lib ../../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy -llzma -ljbig -ljpeg -lz -lm
make[3]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/dbs'
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/dbs'
Making all in iptcutil
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/iptcutil'
/bin/bash ../../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o iptcutil iptcutil.o ../../libtiff/libtiff.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o iptcutil iptcutil.o  -L/klee/build/lib -L/CrashRepair/lib ../../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy -llzma -ljbig -ljpeg -lz -lm
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/iptcutil'
Making all in mfs
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/mfs'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/mfs'
Making all in pds
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/pds'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/pds'
Making all in ras
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/ras'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/ras'
Making all in stream
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/stream'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/stream'
Making all in tags
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/tags'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/tags'
Making all in win_dib
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/win_dib'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/win_dib'
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib'
make[2]: Nothing to be done for 'all-am'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib'
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib'
Making all in test
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/test'
make[1]: Nothing to be done for 'all'.
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/test'
Making all in man
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/man'
make[1]: Nothing to be done for 'all'.
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/man'
Making all in html
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/html'
Making all in images
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/html/images'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/html/images'
Making all in man
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/html/man'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/html/man'
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/html'
make[2]: Nothing to be done for 'all-am'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/html'
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/html'
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src'
make[1]: Nothing to be done for 'all-am'.
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src'
2025-02-05 21:11:30.324 | DEBUG    | scenario:evaluate:655 - testing candidate #26 against test #crash...
2025-02-05 21:11:30.324 | DEBUG    | shell:__call__:41 - executing: /data/vulnloc/libtiff/CVE-2017-7600/src/tools/tiffcp -i /CrashRepair/experiments/vulnloc/libtiff/CVE-2017-7600/tests/1.tif out.tiff
2025-02-05 21:11:30.329 | DEBUG    | test:run:172 - test failed: stderr contains bad output substring (runtime error: -115 is outside the range of representable values)
2025-02-05 21:11:30.329 | INFO     | scenario:evaluate:662 - candidate #26 fails test #crash
2025-02-05 21:11:30.334 | INFO     | scenario:evaluate:635 - evaluating candidate patch #27:
@@ -939,6 +939,7 @@
 	return(0);
 }
 
+
 static int
 TIFFWriteDirectoryTagSampleformatArray(TIFF* tif, uint32* ndir, TIFFDirEntry* dir, uint16 tag, uint32 count, double* value)
 {
@@ -946,7 +947,13 @@
 	void* conv;
 	uint32 i;
 	int ok;
-	conv = _TIFFmalloc(count*sizeof(double));
+
+	if (tif == NULL || value == NULL || count == 0) {
+		TIFFErrorExt(tif->tif_clientdata, module, "Invalid arguments");
+		return (0);
+	}
+
+	conv = _TIFFmalloc(count * sizeof(double));
 	if (conv == NULL)
 	{
 		TIFFErrorExt(tif->tif_clientdata, module, "Out of memory");
@@ -956,55 +963,55 @@
 	switch (tif->tif_dir.td_sampleformat)
 	{
 		case SAMPLEFORMAT_IEEEFP:
-			if (tif->tif_dir.td_bitspersample<=32)
+			if (tif->tif_dir.td_bitspersample <= 32)
 			{
 				for (i = 0; i < count; ++i)
 					((float*)conv)[i] = (float)value[i];
-				ok = TIFFWriteDirectoryTagFloatArray(tif,ndir,dir,tag,count,(float*)conv);
+				ok = TIFFWriteDirectoryTagFloatArray(tif, ndir, dir, tag, count, (float*)conv);
 			}
 			else
 			{
-				ok = TIFFWriteDirectoryTagDoubleArray(tif,ndir,dir,tag,count,value);
+				ok = TIFFWriteDirectoryTagDoubleArray(tif, ndir, dir, tag, count, value);
 			}
 			break;
 		case SAMPLEFORMAT_INT:
-			if (tif->tif_dir.td_bitspersample<=8)
+			if (tif->tif_dir.td_bitspersample <= 8)
 			{
 				for (i = 0; i < count; ++i)
 					((int8*)conv)[i] = (int8)value[i];
-				ok = TIFFWriteDirectoryTagSbyteArray(tif,ndir,dir,tag,count,(int8*)conv);
+				ok = TIFFWriteDirectoryTagSbyteArray(tif, ndir, dir, tag, count, (int8*)conv);
 			}
-			else if (tif->tif_dir.td_bitspersample<=16)
+			else if (tif->tif_dir.td_bitspersample <= 16)
 			{
 				for (i = 0; i < count; ++i)
 					((int16*)conv)[i] = (int16)value[i];
-				ok = TIFFWriteDirectoryTagSshortArray(tif,ndir,dir,tag,count,(int16*)conv);
+				ok = TIFFWriteDirectoryTagSshortArray(tif, ndir, dir, tag, count, (int16*)conv);
 			}
 			else
 			{
 				for (i = 0; i < count; ++i)
 					((int32*)conv)[i] = (int32)value[i];
-				ok = TIFFWriteDirectoryTagSlongArray(tif,ndir,dir,tag,count,(int32*)conv);
+				ok = TIFFWriteDirectoryTagSlongArray(tif, ndir, dir, tag, count, (int32*)conv);
 			}
 			break;
 		case SAMPLEFORMAT_UINT:
-			if (tif->tif_dir.td_bitspersample<=8)
+			if (tif->tif_dir.td_bitspersample <= 8)
 			{
 				for (i = 0; i < count; ++i)
 					((uint8*)conv)[i] = (uint8)value[i];
-				ok = TIFFWriteDirectoryTagByteArray(tif,ndir,dir,tag,count,(uint8*)conv);
+				ok = TIFFWriteDirectoryTagByteArray(tif, ndir, dir, tag, count, (uint8*)conv);
 			}
-			else if (tif->tif_dir.td_bitspersample<=16)
+			else if (tif->tif_dir.td_bitspersample <= 16)
 			{
 				for (i = 0; i < count; ++i)
 					((uint16*)conv)[i] = (uint16)value[i];
-				ok = TIFFWriteDirectoryTagShortArray(tif,ndir,dir,tag,count,(uint16*)conv);
+				ok = TIFFWriteDirectoryTagShortArray(tif, ndir, dir, tag, count, (uint16*)conv);
 			}
 			else
 			{
 				for (i = 0; i < count; ++i)
 					((uint32*)conv)[i] = (uint32)value[i];
-				ok = TIFFWriteDirectoryTagLongArray(tif,ndir,dir,tag,count,(uint32*)conv);
+				ok = TIFFWriteDirectoryTagLongArray(tif, ndir, dir, tag, count, (uint32*)conv);
 			}
 			break;
 		default:
@@ -1015,6 +1022,7 @@
 	return (ok);
 }
 
+
 #if 0
 static int
 TIFFWriteDirectoryTagSampleformatPerSample(TIFF* tif, uint32* ndir, TIFFDirEntry* dir, uint16 tag, double value)

2025-02-05 21:11:30.355 | DEBUG    | scenario:rebuild:369 - original environment: environ({'CONDA_SHLVL': '2', 'LC_ALL': 'C.UTF-8', 'LS_COLORS': 'rs=0:di=01;34:ln=01;36:mh=00:pi=40;33:so=01;35:do=01;35:bd=40;33;01:cd=40;33;01:or=40;31;01:mi=00:su=37;41:sg=30;43:ca=30;41:tw=30;42:ow=34;42:st=37;44:ex=01;32:*.tar=01;31:*.tgz=01;31:*.arc=01;31:*.arj=01;31:*.taz=01;31:*.lha=01;31:*.lz4=01;31:*.lzh=01;31:*.lzma=01;31:*.tlz=01;31:*.txz=01;31:*.tzo=01;31:*.t7z=01;31:*.zip=01;31:*.z=01;31:*.Z=01;31:*.dz=01;31:*.gz=01;31:*.lrz=01;31:*.lz=01;31:*.lzo=01;31:*.xz=01;31:*.zst=01;31:*.tzst=01;31:*.bz2=01;31:*.bz=01;31:*.tbz=01;31:*.tbz2=01;31:*.tz=01;31:*.deb=01;31:*.rpm=01;31:*.jar=01;31:*.war=01;31:*.ear=01;31:*.sar=01;31:*.rar=01;31:*.alz=01;31:*.ace=01;31:*.zoo=01;31:*.cpio=01;31:*.7z=01;31:*.rz=01;31:*.cab=01;31:*.wim=01;31:*.swm=01;31:*.dwm=01;31:*.esd=01;31:*.jpg=01;35:*.jpeg=01;35:*.mjpg=01;35:*.mjpeg=01;35:*.gif=01;35:*.bmp=01;35:*.pbm=01;35:*.pgm=01;35:*.ppm=01;35:*.tga=01;35:*.xbm=01;35:*.xpm=01;35:*.tif=01;35:*.tiff=01;35:*.png=01;35:*.svg=01;35:*.svgz=01;35:*.mng=01;35:*.pcx=01;35:*.mov=01;35:*.mpg=01;35:*.mpeg=01;35:*.m2v=01;35:*.mkv=01;35:*.webm=01;35:*.ogm=01;35:*.mp4=01;35:*.m4v=01;35:*.mp4v=01;35:*.vob=01;35:*.qt=01;35:*.nuv=01;35:*.wmv=01;35:*.asf=01;35:*.rm=01;35:*.rmvb=01;35:*.flc=01;35:*.avi=01;35:*.fli=01;35:*.flv=01;35:*.gl=01;35:*.dl=01;35:*.xcf=01;35:*.xwd=01;35:*.yuv=01;35:*.cgm=01;35:*.emf=01;35:*.ogv=01;35:*.ogx=01;35:*.aac=00;36:*.au=00;36:*.flac=00;36:*.m4a=00;36:*.mid=00;36:*.midi=00;36:*.mka=00;36:*.mp3=00;36:*.mpc=00;36:*.ogg=00;36:*.ra=00;36:*.wav=00;36:*.oga=00;36:*.opus=00;36:*.spx=00;36:*.xspf=00;36:', 'LD_LIBRARY_PATH': '/opt/crashrepair/lib:/CrashRepair/lib:/klee/build/lib:', 'CONDA_EXE': '/root/anaconda3/bin/conda', 'LANG': 'C.UTF-8', 'TZ': 'Asia/Shanghai', 'HOSTNAME': 'fea22102047d', 'OLDPWD': '/orchestrator', 'CONDA_PREFIX': '/root/anaconda3/envs/CrashRepair', '_CE_M': '', 'CC': 'crepair-cc', 'LLVM_COMPILER': 'clang', 'CONDA_PREFIX_1': '/root/anaconda3', 'PWD': '/orchestrator/crashrepair', 'HOME': '/root', 'CONDA_PYTHON_EXE': '/root/anaconda3/bin/python', '_CE_CONDA': '', 'CONDA_PROMPT_MODIFIER': '(CrashRepair) ', 'CXX': 'crepair-cxx', 'TERM': 'xterm', 'SHLVL': '2', 'PYTHONPATH': '/usr/lib/python3.8/site-packages:', 'PATH': '/root/anaconda3/envs/CrashRepair/bin:/root/anaconda3/condabin:~/anaconda3/bin:/opt/crashrepair/bin:/CrashRepair/compiler:/klee/build/bin:/opt/llvm-6/bin:/klee/build/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', 'CONDA_DEFAULT_ENV': 'CrashRepair', '_': '/root/anaconda3/envs/CrashRepair/bin/python'})
2025-02-05 21:11:30.355 | DEBUG    | scenario:rebuild:398 - using environment: {'INJECT_CFLAGS': '-g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy ', 'INJECT_CXXFLAGS': '-g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy ', 'INJECT_LDFLAGS': '-g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy '}
2025-02-05 21:11:30.356 | DEBUG    | shell:__call__:41 - executing: make CFLAGS="-fsanitize=float-cast-overflow ${INJECT_CFLAGS}" CXXFLAGS="-fsanitize=float-cast-overflow ${INJECT_CXXFLAGS}" LDFLAGS="${INJECT_LDFLAGS}"
Making all in port
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/port'
make[1]: Nothing to be done for 'all'.
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/port'
Making all in libtiff
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/libtiff'
make  all-am
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/libtiff'
/bin/bash ../libtool  --tag=CC   --mode=compile crepair-cc -DHAVE_CONFIG_H -I.     -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -MT tif_dirwrite.lo -MD -MP -MF .deps/tif_dirwrite.Tpo -c -o tif_dirwrite.lo tif_dirwrite.c
libtool: compile:  crepair-cc -DHAVE_CONFIG_H -I. -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -MT tif_dirwrite.lo -MD -MP -MF .deps/tif_dirwrite.Tpo -c tif_dirwrite.c -o tif_dirwrite.o
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
mv -f .deps/tif_dirwrite.Tpo .deps/tif_dirwrite.Plo
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -no-undefined -version-info 7:5:2   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o libtiff.la -rpath /usr/local/lib tif_aux.lo tif_close.lo tif_codec.lo tif_color.lo tif_compress.lo tif_dir.lo tif_dirinfo.lo tif_dirread.lo tif_dirwrite.lo tif_dumpmode.lo tif_error.lo tif_extension.lo tif_fax3.lo tif_fax3sm.lo tif_flush.lo tif_getimage.lo tif_jbig.lo tif_jpeg.lo tif_jpeg_12.lo tif_luv.lo tif_lzma.lo tif_lzw.lo tif_next.lo tif_ojpeg.lo tif_open.lo tif_packbits.lo tif_pixarlog.lo tif_predict.lo tif_print.lo tif_read.lo tif_strip.lo tif_swab.lo tif_thunder.lo tif_tile.lo tif_version.lo tif_warning.lo tif_write.lo tif_zip.lo  tif_unix.lo ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: rm -fr  .libs/libtiff.a .libs/libtiff.la .libs/libtiff.lai
libtool: link: (cd .libs/libtiff.lax/libport.a && ar x "/data/vulnloc/libtiff/CVE-2017-7600/src/libtiff/../port/.libs/libport.a")
libtool: link: ar cru .libs/libtiff.a  tif_aux.o tif_close.o tif_codec.o tif_color.o tif_compress.o tif_dir.o tif_dirinfo.o tif_dirread.o tif_dirwrite.o tif_dumpmode.o tif_error.o tif_extension.o tif_fax3.o tif_fax3sm.o tif_flush.o tif_getimage.o tif_jbig.o tif_jpeg.o tif_jpeg_12.o tif_luv.o tif_lzma.o tif_lzw.o tif_next.o tif_ojpeg.o tif_open.o tif_packbits.o tif_pixarlog.o tif_predict.o tif_print.o tif_read.o tif_strip.o tif_swab.o tif_thunder.o tif_tile.o tif_version.o tif_warning.o tif_write.o tif_zip.o tif_unix.o  .libs/libtiff.lax/libport.a/dummy.o 
ar: `u' modifier ignored since `D' is the default (see `U')
libtool: link: ranlib .libs/libtiff.a
libtool: link: rm -fr .libs/libtiff.lax
libtool: link: ( cd ".libs" && rm -f "libtiff.la" && ln -s "../libtiff.la" "libtiff.la" )
/bin/bash ../libtool  --tag=CXX   --mode=link crepair-cxx  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -no-undefined -version-info 7:5:2   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o libtiffxx.la -rpath /usr/local/lib tif_stream.lo ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: rm -fr  .libs/libtiffxx.a .libs/libtiffxx.la .libs/libtiffxx.lai
libtool: link: (cd .libs/libtiffxx.lax/libport.a && ar x "/data/vulnloc/libtiff/CVE-2017-7600/src/libtiff/../port/.libs/libport.a")
libtool: link: ar cru .libs/libtiffxx.a  tif_stream.o  .libs/libtiffxx.lax/libport.a/dummy.o 
ar: `u' modifier ignored since `D' is the default (see `U')
libtool: link: ranlib .libs/libtiffxx.a
libtool: link: rm -fr .libs/libtiffxx.lax
libtool: link: ( cd ".libs" && rm -f "libtiffxx.la" && ln -s "../libtiffxx.la" "libtiffxx.la" )
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/libtiff'
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/libtiff'
Making all in tools
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/tools'
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o bmp2tiff bmp2tiff.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o bmp2tiff bmp2tiff.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o fax2ps fax2ps.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o fax2ps fax2ps.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o fax2tiff fax2tiff.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o fax2tiff fax2tiff.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o gif2tiff gif2tiff.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o gif2tiff gif2tiff.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o pal2rgb pal2rgb.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o pal2rgb pal2rgb.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o ppm2tiff ppm2tiff.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o ppm2tiff ppm2tiff.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o ras2tiff ras2tiff.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o ras2tiff ras2tiff.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o raw2tiff raw2tiff.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o raw2tiff raw2tiff.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o rgb2ycbcr rgb2ycbcr.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o rgb2ycbcr rgb2ycbcr.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o thumbnail thumbnail.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o thumbnail thumbnail.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o tiff2bw tiff2bw.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o tiff2bw tiff2bw.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o tiff2pdf tiff2pdf.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o tiff2pdf tiff2pdf.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o tiff2ps tiff2ps.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o tiff2ps tiff2ps.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o tiff2rgba tiff2rgba.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o tiff2rgba tiff2rgba.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o tiffcmp tiffcmp.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o tiffcmp tiffcmp.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o tiffcp tiffcp.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o tiffcp tiffcp.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o tiffcrop tiffcrop.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o tiffcrop tiffcrop.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o tiffdither tiffdither.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o tiffdither tiffdither.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o tiffdump tiffdump.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o tiffdump tiffdump.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o tiffinfo tiffinfo.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o tiffinfo tiffinfo.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o tiffmedian tiffmedian.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o tiffmedian tiffmedian.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o tiffset tiffset.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o tiffset tiffset.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o tiffsplit tiffsplit.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o tiffsplit tiffsplit.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/tools'
Making all in build
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/build'
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/build'
make[2]: Nothing to be done for 'all-am'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/build'
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/build'
Making all in contrib
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib'
Making all in addtiffo
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/addtiffo'
/bin/bash ../../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o addtiffo addtiffo.o tif_overview.o tif_ovrcache.o ../../libtiff/libtiff.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o addtiffo addtiffo.o tif_overview.o tif_ovrcache.o  -L/klee/build/lib -L/CrashRepair/lib ../../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy -llzma -ljbig -ljpeg -lz -lm
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/addtiffo'
Making all in dbs
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/dbs'
Making all in xtiff
make[3]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/dbs/xtiff'
make[3]: Nothing to be done for 'all'.
make[3]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/dbs/xtiff'
make[3]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/dbs'
/bin/bash ../../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o tiff-bi tiff-bi.o ../../libtiff/libtiff.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o tiff-bi tiff-bi.o  -L/klee/build/lib -L/CrashRepair/lib ../../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o tiff-grayscale tiff-grayscale.o ../../libtiff/libtiff.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o tiff-grayscale tiff-grayscale.o  -L/klee/build/lib -L/CrashRepair/lib ../../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o tiff-palette tiff-palette.o ../../libtiff/libtiff.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o tiff-palette tiff-palette.o  -L/klee/build/lib -L/CrashRepair/lib ../../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o tiff-rgb tiff-rgb.o ../../libtiff/libtiff.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o tiff-rgb tiff-rgb.o  -L/klee/build/lib -L/CrashRepair/lib ../../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy -llzma -ljbig -ljpeg -lz -lm
make[3]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/dbs'
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/dbs'
Making all in iptcutil
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/iptcutil'
/bin/bash ../../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o iptcutil iptcutil.o ../../libtiff/libtiff.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o iptcutil iptcutil.o  -L/klee/build/lib -L/CrashRepair/lib ../../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy -llzma -ljbig -ljpeg -lz -lm
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/iptcutil'
Making all in mfs
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/mfs'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/mfs'
Making all in pds
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/pds'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/pds'
Making all in ras
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/ras'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/ras'
Making all in stream
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/stream'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/stream'
Making all in tags
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/tags'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/tags'
Making all in win_dib
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/win_dib'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/win_dib'
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib'
make[2]: Nothing to be done for 'all-am'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib'
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib'
Making all in test
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/test'
make[1]: Nothing to be done for 'all'.
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/test'
Making all in man
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/man'
make[1]: Nothing to be done for 'all'.
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/man'
Making all in html
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/html'
Making all in images
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/html/images'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/html/images'
Making all in man
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/html/man'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/html/man'
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/html'
make[2]: Nothing to be done for 'all-am'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/html'
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/html'
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src'
make[1]: Nothing to be done for 'all-am'.
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src'
2025-02-05 21:11:34.913 | DEBUG    | scenario:evaluate:655 - testing candidate #27 against test #crash...
2025-02-05 21:11:34.913 | DEBUG    | shell:__call__:41 - executing: /data/vulnloc/libtiff/CVE-2017-7600/src/tools/tiffcp -i /CrashRepair/experiments/vulnloc/libtiff/CVE-2017-7600/tests/1.tif out.tiff
2025-02-05 21:11:34.917 | DEBUG    | test:run:172 - test failed: stderr contains bad output substring (runtime error: -115 is outside the range of representable values)
2025-02-05 21:11:34.918 | INFO     | scenario:evaluate:662 - candidate #27 fails test #crash
2025-02-05 21:11:34.927 | INFO     | scenario:evaluate:635 - evaluating candidate patch #28:
@@ -939,6 +939,7 @@
 	return(0);
 }
 
+
 static int
 TIFFWriteDirectoryTagSampleformatArray(TIFF* tif, uint32* ndir, TIFFDirEntry* dir, uint16 tag, uint32 count, double* value)
 {
@@ -952,6 +953,15 @@
 		TIFFErrorExt(tif->tif_clientdata, module, "Out of memory");
 		return (0);
 	}
+    
+    // Check if the sample format is valid before proceeding
+    if (tif->tif_dir.td_sampleformat != SAMPLEFORMAT_IEEEFP &&
+        tif->tif_dir.td_sampleformat != SAMPLEFORMAT_INT &&
+        tif->tif_dir.td_sampleformat != SAMPLEFORMAT_UINT) {
+        TIFFErrorExt(tif->tif_clientdata, module, "Invalid sample format");
+        _TIFFfree(conv);
+        return (0);
+    }
 
 	switch (tif->tif_dir.td_sampleformat)
 	{
@@ -1015,6 +1025,7 @@
 	return (ok);
 }
 
+
 #if 0
 static int
 TIFFWriteDirectoryTagSampleformatPerSample(TIFF* tif, uint32* ndir, TIFFDirEntry* dir, uint16 tag, double value)

2025-02-05 21:11:34.931 | DEBUG    | scenario:rebuild:369 - original environment: environ({'CONDA_SHLVL': '2', 'LC_ALL': 'C.UTF-8', 'LS_COLORS': 'rs=0:di=01;34:ln=01;36:mh=00:pi=40;33:so=01;35:do=01;35:bd=40;33;01:cd=40;33;01:or=40;31;01:mi=00:su=37;41:sg=30;43:ca=30;41:tw=30;42:ow=34;42:st=37;44:ex=01;32:*.tar=01;31:*.tgz=01;31:*.arc=01;31:*.arj=01;31:*.taz=01;31:*.lha=01;31:*.lz4=01;31:*.lzh=01;31:*.lzma=01;31:*.tlz=01;31:*.txz=01;31:*.tzo=01;31:*.t7z=01;31:*.zip=01;31:*.z=01;31:*.Z=01;31:*.dz=01;31:*.gz=01;31:*.lrz=01;31:*.lz=01;31:*.lzo=01;31:*.xz=01;31:*.zst=01;31:*.tzst=01;31:*.bz2=01;31:*.bz=01;31:*.tbz=01;31:*.tbz2=01;31:*.tz=01;31:*.deb=01;31:*.rpm=01;31:*.jar=01;31:*.war=01;31:*.ear=01;31:*.sar=01;31:*.rar=01;31:*.alz=01;31:*.ace=01;31:*.zoo=01;31:*.cpio=01;31:*.7z=01;31:*.rz=01;31:*.cab=01;31:*.wim=01;31:*.swm=01;31:*.dwm=01;31:*.esd=01;31:*.jpg=01;35:*.jpeg=01;35:*.mjpg=01;35:*.mjpeg=01;35:*.gif=01;35:*.bmp=01;35:*.pbm=01;35:*.pgm=01;35:*.ppm=01;35:*.tga=01;35:*.xbm=01;35:*.xpm=01;35:*.tif=01;35:*.tiff=01;35:*.png=01;35:*.svg=01;35:*.svgz=01;35:*.mng=01;35:*.pcx=01;35:*.mov=01;35:*.mpg=01;35:*.mpeg=01;35:*.m2v=01;35:*.mkv=01;35:*.webm=01;35:*.ogm=01;35:*.mp4=01;35:*.m4v=01;35:*.mp4v=01;35:*.vob=01;35:*.qt=01;35:*.nuv=01;35:*.wmv=01;35:*.asf=01;35:*.rm=01;35:*.rmvb=01;35:*.flc=01;35:*.avi=01;35:*.fli=01;35:*.flv=01;35:*.gl=01;35:*.dl=01;35:*.xcf=01;35:*.xwd=01;35:*.yuv=01;35:*.cgm=01;35:*.emf=01;35:*.ogv=01;35:*.ogx=01;35:*.aac=00;36:*.au=00;36:*.flac=00;36:*.m4a=00;36:*.mid=00;36:*.midi=00;36:*.mka=00;36:*.mp3=00;36:*.mpc=00;36:*.ogg=00;36:*.ra=00;36:*.wav=00;36:*.oga=00;36:*.opus=00;36:*.spx=00;36:*.xspf=00;36:', 'LD_LIBRARY_PATH': '/opt/crashrepair/lib:/CrashRepair/lib:/klee/build/lib:', 'CONDA_EXE': '/root/anaconda3/bin/conda', 'LANG': 'C.UTF-8', 'TZ': 'Asia/Shanghai', 'HOSTNAME': 'fea22102047d', 'OLDPWD': '/orchestrator', 'CONDA_PREFIX': '/root/anaconda3/envs/CrashRepair', '_CE_M': '', 'CC': 'crepair-cc', 'LLVM_COMPILER': 'clang', 'CONDA_PREFIX_1': '/root/anaconda3', 'PWD': '/orchestrator/crashrepair', 'HOME': '/root', 'CONDA_PYTHON_EXE': '/root/anaconda3/bin/python', '_CE_CONDA': '', 'CONDA_PROMPT_MODIFIER': '(CrashRepair) ', 'CXX': 'crepair-cxx', 'TERM': 'xterm', 'SHLVL': '2', 'PYTHONPATH': '/usr/lib/python3.8/site-packages:', 'PATH': '/root/anaconda3/envs/CrashRepair/bin:/root/anaconda3/condabin:~/anaconda3/bin:/opt/crashrepair/bin:/CrashRepair/compiler:/klee/build/bin:/opt/llvm-6/bin:/klee/build/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', 'CONDA_DEFAULT_ENV': 'CrashRepair', '_': '/root/anaconda3/envs/CrashRepair/bin/python'})
2025-02-05 21:11:34.931 | DEBUG    | scenario:rebuild:398 - using environment: {'INJECT_CFLAGS': '-g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy ', 'INJECT_CXXFLAGS': '-g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy ', 'INJECT_LDFLAGS': '-g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy '}
2025-02-05 21:11:34.931 | DEBUG    | shell:__call__:41 - executing: make CFLAGS="-fsanitize=float-cast-overflow ${INJECT_CFLAGS}" CXXFLAGS="-fsanitize=float-cast-overflow ${INJECT_CXXFLAGS}" LDFLAGS="${INJECT_LDFLAGS}"
Making all in port
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/port'
make[1]: Nothing to be done for 'all'.
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/port'
Making all in libtiff
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/libtiff'
make  all-am
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/libtiff'
/bin/bash ../libtool  --tag=CC   --mode=compile crepair-cc -DHAVE_CONFIG_H -I.     -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -MT tif_dirwrite.lo -MD -MP -MF .deps/tif_dirwrite.Tpo -c -o tif_dirwrite.lo tif_dirwrite.c
libtool: compile:  crepair-cc -DHAVE_CONFIG_H -I. -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -MT tif_dirwrite.lo -MD -MP -MF .deps/tif_dirwrite.Tpo -c tif_dirwrite.c -o tif_dirwrite.o
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
mv -f .deps/tif_dirwrite.Tpo .deps/tif_dirwrite.Plo
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -no-undefined -version-info 7:5:2   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o libtiff.la -rpath /usr/local/lib tif_aux.lo tif_close.lo tif_codec.lo tif_color.lo tif_compress.lo tif_dir.lo tif_dirinfo.lo tif_dirread.lo tif_dirwrite.lo tif_dumpmode.lo tif_error.lo tif_extension.lo tif_fax3.lo tif_fax3sm.lo tif_flush.lo tif_getimage.lo tif_jbig.lo tif_jpeg.lo tif_jpeg_12.lo tif_luv.lo tif_lzma.lo tif_lzw.lo tif_next.lo tif_ojpeg.lo tif_open.lo tif_packbits.lo tif_pixarlog.lo tif_predict.lo tif_print.lo tif_read.lo tif_strip.lo tif_swab.lo tif_thunder.lo tif_tile.lo tif_version.lo tif_warning.lo tif_write.lo tif_zip.lo  tif_unix.lo ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: rm -fr  .libs/libtiff.a .libs/libtiff.la .libs/libtiff.lai
libtool: link: (cd .libs/libtiff.lax/libport.a && ar x "/data/vulnloc/libtiff/CVE-2017-7600/src/libtiff/../port/.libs/libport.a")
libtool: link: ar cru .libs/libtiff.a  tif_aux.o tif_close.o tif_codec.o tif_color.o tif_compress.o tif_dir.o tif_dirinfo.o tif_dirread.o tif_dirwrite.o tif_dumpmode.o tif_error.o tif_extension.o tif_fax3.o tif_fax3sm.o tif_flush.o tif_getimage.o tif_jbig.o tif_jpeg.o tif_jpeg_12.o tif_luv.o tif_lzma.o tif_lzw.o tif_next.o tif_ojpeg.o tif_open.o tif_packbits.o tif_pixarlog.o tif_predict.o tif_print.o tif_read.o tif_strip.o tif_swab.o tif_thunder.o tif_tile.o tif_version.o tif_warning.o tif_write.o tif_zip.o tif_unix.o  .libs/libtiff.lax/libport.a/dummy.o 
ar: `u' modifier ignored since `D' is the default (see `U')
libtool: link: ranlib .libs/libtiff.a
libtool: link: rm -fr .libs/libtiff.lax
libtool: link: ( cd ".libs" && rm -f "libtiff.la" && ln -s "../libtiff.la" "libtiff.la" )
/bin/bash ../libtool  --tag=CXX   --mode=link crepair-cxx  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -no-undefined -version-info 7:5:2   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o libtiffxx.la -rpath /usr/local/lib tif_stream.lo ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: rm -fr  .libs/libtiffxx.a .libs/libtiffxx.la .libs/libtiffxx.lai
libtool: link: (cd .libs/libtiffxx.lax/libport.a && ar x "/data/vulnloc/libtiff/CVE-2017-7600/src/libtiff/../port/.libs/libport.a")
libtool: link: ar cru .libs/libtiffxx.a  tif_stream.o  .libs/libtiffxx.lax/libport.a/dummy.o 
ar: `u' modifier ignored since `D' is the default (see `U')
libtool: link: ranlib .libs/libtiffxx.a
libtool: link: rm -fr .libs/libtiffxx.lax
libtool: link: ( cd ".libs" && rm -f "libtiffxx.la" && ln -s "../libtiffxx.la" "libtiffxx.la" )
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/libtiff'
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/libtiff'
Making all in tools
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/tools'
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o bmp2tiff bmp2tiff.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o bmp2tiff bmp2tiff.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o fax2ps fax2ps.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o fax2ps fax2ps.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o fax2tiff fax2tiff.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o fax2tiff fax2tiff.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o gif2tiff gif2tiff.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o gif2tiff gif2tiff.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o pal2rgb pal2rgb.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o pal2rgb pal2rgb.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o ppm2tiff ppm2tiff.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o ppm2tiff ppm2tiff.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o ras2tiff ras2tiff.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o ras2tiff ras2tiff.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o raw2tiff raw2tiff.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o raw2tiff raw2tiff.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o rgb2ycbcr rgb2ycbcr.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o rgb2ycbcr rgb2ycbcr.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o thumbnail thumbnail.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o thumbnail thumbnail.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o tiff2bw tiff2bw.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o tiff2bw tiff2bw.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o tiff2pdf tiff2pdf.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o tiff2pdf tiff2pdf.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o tiff2ps tiff2ps.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o tiff2ps tiff2ps.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o tiff2rgba tiff2rgba.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o tiff2rgba tiff2rgba.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o tiffcmp tiffcmp.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o tiffcmp tiffcmp.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o tiffcp tiffcp.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o tiffcp tiffcp.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o tiffcrop tiffcrop.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o tiffcrop tiffcrop.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o tiffdither tiffdither.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o tiffdither tiffdither.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o tiffdump tiffdump.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o tiffdump tiffdump.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o tiffinfo tiffinfo.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o tiffinfo tiffinfo.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o tiffmedian tiffmedian.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o tiffmedian tiffmedian.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o tiffset tiffset.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o tiffset tiffset.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o tiffsplit tiffsplit.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o tiffsplit tiffsplit.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/tools'
Making all in build
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/build'
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/build'
make[2]: Nothing to be done for 'all-am'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/build'
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/build'
Making all in contrib
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib'
Making all in addtiffo
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/addtiffo'
/bin/bash ../../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o addtiffo addtiffo.o tif_overview.o tif_ovrcache.o ../../libtiff/libtiff.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o addtiffo addtiffo.o tif_overview.o tif_ovrcache.o  -L/klee/build/lib -L/CrashRepair/lib ../../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy -llzma -ljbig -ljpeg -lz -lm
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/addtiffo'
Making all in dbs
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/dbs'
Making all in xtiff
make[3]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/dbs/xtiff'
make[3]: Nothing to be done for 'all'.
make[3]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/dbs/xtiff'
make[3]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/dbs'
/bin/bash ../../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o tiff-bi tiff-bi.o ../../libtiff/libtiff.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o tiff-bi tiff-bi.o  -L/klee/build/lib -L/CrashRepair/lib ../../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o tiff-grayscale tiff-grayscale.o ../../libtiff/libtiff.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o tiff-grayscale tiff-grayscale.o  -L/klee/build/lib -L/CrashRepair/lib ../../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o tiff-palette tiff-palette.o ../../libtiff/libtiff.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o tiff-palette tiff-palette.o  -L/klee/build/lib -L/CrashRepair/lib ../../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o tiff-rgb tiff-rgb.o ../../libtiff/libtiff.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o tiff-rgb tiff-rgb.o  -L/klee/build/lib -L/CrashRepair/lib ../../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy -llzma -ljbig -ljpeg -lz -lm
make[3]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/dbs'
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/dbs'
Making all in iptcutil
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/iptcutil'
/bin/bash ../../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o iptcutil iptcutil.o ../../libtiff/libtiff.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o iptcutil iptcutil.o  -L/klee/build/lib -L/CrashRepair/lib ../../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy -llzma -ljbig -ljpeg -lz -lm
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/iptcutil'
Making all in mfs
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/mfs'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/mfs'
Making all in pds
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/pds'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/pds'
Making all in ras
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/ras'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/ras'
Making all in stream
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/stream'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/stream'
Making all in tags
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/tags'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/tags'
Making all in win_dib
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/win_dib'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/win_dib'
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib'
make[2]: Nothing to be done for 'all-am'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib'
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib'
Making all in test
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/test'
make[1]: Nothing to be done for 'all'.
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/test'
Making all in man
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/man'
make[1]: Nothing to be done for 'all'.
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/man'
Making all in html
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/html'
Making all in images
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/html/images'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/html/images'
Making all in man
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/html/man'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/html/man'
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/html'
make[2]: Nothing to be done for 'all-am'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/html'
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/html'
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src'
make[1]: Nothing to be done for 'all-am'.
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src'
2025-02-05 21:11:39.561 | DEBUG    | scenario:evaluate:655 - testing candidate #28 against test #crash...
2025-02-05 21:11:39.561 | DEBUG    | shell:__call__:41 - executing: /data/vulnloc/libtiff/CVE-2017-7600/src/tools/tiffcp -i /CrashRepair/experiments/vulnloc/libtiff/CVE-2017-7600/tests/1.tif out.tiff
2025-02-05 21:11:39.566 | DEBUG    | test:run:172 - test failed: stderr contains bad output substring (runtime error: -115 is outside the range of representable values)
2025-02-05 21:11:39.566 | INFO     | scenario:evaluate:662 - candidate #28 fails test #crash
2025-02-05 21:11:39.576 | INFO     | scenario:evaluate:635 - evaluating candidate patch #29:
@@ -939,6 +939,7 @@
 	return(0);
 }
 
+
 static int
 TIFFWriteDirectoryTagSampleformatArray(TIFF* tif, uint32* ndir, TIFFDirEntry* dir, uint16 tag, uint32 count, double* value)
 {
@@ -946,9 +947,14 @@
 	void* conv;
 	uint32 i;
 	int ok;
-	conv = _TIFFmalloc(count*sizeof(double));
-	if (conv == NULL)
-	{
+
+	if (tif == NULL || ndir == NULL || dir == NULL || value == NULL) {
+		TIFFErrorExt(tif->tif_clientdata, module, "Invalid input parameters");
+		return (0);
+	}
+
+	conv = _TIFFmalloc(count * sizeof(double));
+	if (conv == NULL) {
 		TIFFErrorExt(tif->tif_clientdata, module, "Out of memory");
 		return (0);
 	}
@@ -956,55 +962,55 @@
 	switch (tif->tif_dir.td_sampleformat)
 	{
 		case SAMPLEFORMAT_IEEEFP:
-			if (tif->tif_dir.td_bitspersample<=32)
+			if (tif->tif_dir.td_bitspersample <= 32)
 			{
 				for (i = 0; i < count; ++i)
 					((float*)conv)[i] = (float)value[i];
-				ok = TIFFWriteDirectoryTagFloatArray(tif,ndir,dir,tag,count,(float*)conv);
+				ok = TIFFWriteDirectoryTagFloatArray(tif, ndir, dir, tag, count, (float*)conv);
 			}
 			else
 			{
-				ok = TIFFWriteDirectoryTagDoubleArray(tif,ndir,dir,tag,count,value);
+				ok = TIFFWriteDirectoryTagDoubleArray(tif, ndir, dir, tag, count, value);
 			}
 			break;
 		case SAMPLEFORMAT_INT:
-			if (tif->tif_dir.td_bitspersample<=8)
+			if (tif->tif_dir.td_bitspersample <= 8)
 			{
 				for (i = 0; i < count; ++i)
 					((int8*)conv)[i] = (int8)value[i];
-				ok = TIFFWriteDirectoryTagSbyteArray(tif,ndir,dir,tag,count,(int8*)conv);
+				ok = TIFFWriteDirectoryTagSbyteArray(tif, ndir, dir, tag, count, (int8*)conv);
 			}
-			else if (tif->tif_dir.td_bitspersample<=16)
+			else if (tif->tif_dir.td_bitspersample <= 16)
 			{
 				for (i = 0; i < count; ++i)
 					((int16*)conv)[i] = (int16)value[i];
-				ok = TIFFWriteDirectoryTagSshortArray(tif,ndir,dir,tag,count,(int16*)conv);
+				ok = TIFFWriteDirectoryTagSshortArray(tif, ndir, dir, tag, count, (int16*)conv);
 			}
 			else
 			{
 				for (i = 0; i < count; ++i)
 					((int32*)conv)[i] = (int32)value[i];
-				ok = TIFFWriteDirectoryTagSlongArray(tif,ndir,dir,tag,count,(int32*)conv);
+				ok = TIFFWriteDirectoryTagSlongArray(tif, ndir, dir, tag, count, (int32*)conv);
 			}
 			break;
 		case SAMPLEFORMAT_UINT:
-			if (tif->tif_dir.td_bitspersample<=8)
+			if (tif->tif_dir.td_bitspersample <= 8)
 			{
 				for (i = 0; i < count; ++i)
 					((uint8*)conv)[i] = (uint8)value[i];
-				ok = TIFFWriteDirectoryTagByteArray(tif,ndir,dir,tag,count,(uint8*)conv);
+				ok = TIFFWriteDirectoryTagByteArray(tif, ndir, dir, tag, count, (uint8*)conv);
 			}
-			else if (tif->tif_dir.td_bitspersample<=16)
+			else if (tif->tif_dir.td_bitspersample <= 16)
 			{
 				for (i = 0; i < count; ++i)
 					((uint16*)conv)[i] = (uint16)value[i];
-				ok = TIFFWriteDirectoryTagShortArray(tif,ndir,dir,tag,count,(uint16*)conv);
+				ok = TIFFWriteDirectoryTagShortArray(tif, ndir, dir, tag, count, (uint16*)conv);
 			}
 			else
 			{
 				for (i = 0; i < count; ++i)
 					((uint32*)conv)[i] = (uint32)value[i];
-				ok = TIFFWriteDirectoryTagLongArray(tif,ndir,dir,tag,count,(uint32*)conv);
+				ok = TIFFWriteDirectoryTagLongArray(tif, ndir, dir, tag, count, (uint32*)conv);
 			}
 			break;
 		default:
@@ -1015,6 +1021,7 @@
 	return (ok);
 }
 
+
 #if 0
 static int
 TIFFWriteDirectoryTagSampleformatPerSample(TIFF* tif, uint32* ndir, TIFFDirEntry* dir, uint16 tag, double value)

2025-02-05 21:11:39.581 | DEBUG    | scenario:rebuild:369 - original environment: environ({'CONDA_SHLVL': '2', 'LC_ALL': 'C.UTF-8', 'LS_COLORS': 'rs=0:di=01;34:ln=01;36:mh=00:pi=40;33:so=01;35:do=01;35:bd=40;33;01:cd=40;33;01:or=40;31;01:mi=00:su=37;41:sg=30;43:ca=30;41:tw=30;42:ow=34;42:st=37;44:ex=01;32:*.tar=01;31:*.tgz=01;31:*.arc=01;31:*.arj=01;31:*.taz=01;31:*.lha=01;31:*.lz4=01;31:*.lzh=01;31:*.lzma=01;31:*.tlz=01;31:*.txz=01;31:*.tzo=01;31:*.t7z=01;31:*.zip=01;31:*.z=01;31:*.Z=01;31:*.dz=01;31:*.gz=01;31:*.lrz=01;31:*.lz=01;31:*.lzo=01;31:*.xz=01;31:*.zst=01;31:*.tzst=01;31:*.bz2=01;31:*.bz=01;31:*.tbz=01;31:*.tbz2=01;31:*.tz=01;31:*.deb=01;31:*.rpm=01;31:*.jar=01;31:*.war=01;31:*.ear=01;31:*.sar=01;31:*.rar=01;31:*.alz=01;31:*.ace=01;31:*.zoo=01;31:*.cpio=01;31:*.7z=01;31:*.rz=01;31:*.cab=01;31:*.wim=01;31:*.swm=01;31:*.dwm=01;31:*.esd=01;31:*.jpg=01;35:*.jpeg=01;35:*.mjpg=01;35:*.mjpeg=01;35:*.gif=01;35:*.bmp=01;35:*.pbm=01;35:*.pgm=01;35:*.ppm=01;35:*.tga=01;35:*.xbm=01;35:*.xpm=01;35:*.tif=01;35:*.tiff=01;35:*.png=01;35:*.svg=01;35:*.svgz=01;35:*.mng=01;35:*.pcx=01;35:*.mov=01;35:*.mpg=01;35:*.mpeg=01;35:*.m2v=01;35:*.mkv=01;35:*.webm=01;35:*.ogm=01;35:*.mp4=01;35:*.m4v=01;35:*.mp4v=01;35:*.vob=01;35:*.qt=01;35:*.nuv=01;35:*.wmv=01;35:*.asf=01;35:*.rm=01;35:*.rmvb=01;35:*.flc=01;35:*.avi=01;35:*.fli=01;35:*.flv=01;35:*.gl=01;35:*.dl=01;35:*.xcf=01;35:*.xwd=01;35:*.yuv=01;35:*.cgm=01;35:*.emf=01;35:*.ogv=01;35:*.ogx=01;35:*.aac=00;36:*.au=00;36:*.flac=00;36:*.m4a=00;36:*.mid=00;36:*.midi=00;36:*.mka=00;36:*.mp3=00;36:*.mpc=00;36:*.ogg=00;36:*.ra=00;36:*.wav=00;36:*.oga=00;36:*.opus=00;36:*.spx=00;36:*.xspf=00;36:', 'LD_LIBRARY_PATH': '/opt/crashrepair/lib:/CrashRepair/lib:/klee/build/lib:', 'CONDA_EXE': '/root/anaconda3/bin/conda', 'LANG': 'C.UTF-8', 'TZ': 'Asia/Shanghai', 'HOSTNAME': 'fea22102047d', 'OLDPWD': '/orchestrator', 'CONDA_PREFIX': '/root/anaconda3/envs/CrashRepair', '_CE_M': '', 'CC': 'crepair-cc', 'LLVM_COMPILER': 'clang', 'CONDA_PREFIX_1': '/root/anaconda3', 'PWD': '/orchestrator/crashrepair', 'HOME': '/root', 'CONDA_PYTHON_EXE': '/root/anaconda3/bin/python', '_CE_CONDA': '', 'CONDA_PROMPT_MODIFIER': '(CrashRepair) ', 'CXX': 'crepair-cxx', 'TERM': 'xterm', 'SHLVL': '2', 'PYTHONPATH': '/usr/lib/python3.8/site-packages:', 'PATH': '/root/anaconda3/envs/CrashRepair/bin:/root/anaconda3/condabin:~/anaconda3/bin:/opt/crashrepair/bin:/CrashRepair/compiler:/klee/build/bin:/opt/llvm-6/bin:/klee/build/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', 'CONDA_DEFAULT_ENV': 'CrashRepair', '_': '/root/anaconda3/envs/CrashRepair/bin/python'})
2025-02-05 21:11:39.581 | DEBUG    | scenario:rebuild:398 - using environment: {'INJECT_CFLAGS': '-g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy ', 'INJECT_CXXFLAGS': '-g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy ', 'INJECT_LDFLAGS': '-g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy '}
2025-02-05 21:11:39.581 | DEBUG    | shell:__call__:41 - executing: make CFLAGS="-fsanitize=float-cast-overflow ${INJECT_CFLAGS}" CXXFLAGS="-fsanitize=float-cast-overflow ${INJECT_CXXFLAGS}" LDFLAGS="${INJECT_LDFLAGS}"
Making all in port
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/port'
make[1]: Nothing to be done for 'all'.
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/port'
Making all in libtiff
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/libtiff'
make  all-am
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/libtiff'
/bin/bash ../libtool  --tag=CC   --mode=compile crepair-cc -DHAVE_CONFIG_H -I.     -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -MT tif_dirwrite.lo -MD -MP -MF .deps/tif_dirwrite.Tpo -c -o tif_dirwrite.lo tif_dirwrite.c
libtool: compile:  crepair-cc -DHAVE_CONFIG_H -I. -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy -MT tif_dirwrite.lo -MD -MP -MF .deps/tif_dirwrite.Tpo -c tif_dirwrite.c -o tif_dirwrite.o
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_runtime: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lcrepair_proxy: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: -lkleeRuntest: 'linker' input unused [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/lib' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/CrashRepair/compiler/../lib/' [-Wunused-command-line-argument]
clang-6.0: warning: argument unused during compilation: '-L/klee/build/lib/' [-Wunused-command-line-argument]
mv -f .deps/tif_dirwrite.Tpo .deps/tif_dirwrite.Plo
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -no-undefined -version-info 7:5:2   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o libtiff.la -rpath /usr/local/lib tif_aux.lo tif_close.lo tif_codec.lo tif_color.lo tif_compress.lo tif_dir.lo tif_dirinfo.lo tif_dirread.lo tif_dirwrite.lo tif_dumpmode.lo tif_error.lo tif_extension.lo tif_fax3.lo tif_fax3sm.lo tif_flush.lo tif_getimage.lo tif_jbig.lo tif_jpeg.lo tif_jpeg_12.lo tif_luv.lo tif_lzma.lo tif_lzw.lo tif_next.lo tif_ojpeg.lo tif_open.lo tif_packbits.lo tif_pixarlog.lo tif_predict.lo tif_print.lo tif_read.lo tif_strip.lo tif_swab.lo tif_thunder.lo tif_tile.lo tif_version.lo tif_warning.lo tif_write.lo tif_zip.lo  tif_unix.lo ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: rm -fr  .libs/libtiff.a .libs/libtiff.la .libs/libtiff.lai
libtool: link: (cd .libs/libtiff.lax/libport.a && ar x "/data/vulnloc/libtiff/CVE-2017-7600/src/libtiff/../port/.libs/libport.a")
libtool: link: ar cru .libs/libtiff.a  tif_aux.o tif_close.o tif_codec.o tif_color.o tif_compress.o tif_dir.o tif_dirinfo.o tif_dirread.o tif_dirwrite.o tif_dumpmode.o tif_error.o tif_extension.o tif_fax3.o tif_fax3sm.o tif_flush.o tif_getimage.o tif_jbig.o tif_jpeg.o tif_jpeg_12.o tif_luv.o tif_lzma.o tif_lzw.o tif_next.o tif_ojpeg.o tif_open.o tif_packbits.o tif_pixarlog.o tif_predict.o tif_print.o tif_read.o tif_strip.o tif_swab.o tif_thunder.o tif_tile.o tif_version.o tif_warning.o tif_write.o tif_zip.o tif_unix.o  .libs/libtiff.lax/libport.a/dummy.o 
ar: `u' modifier ignored since `D' is the default (see `U')
libtool: link: ranlib .libs/libtiff.a
libtool: link: rm -fr .libs/libtiff.lax
libtool: link: ( cd ".libs" && rm -f "libtiff.la" && ln -s "../libtiff.la" "libtiff.la" )
/bin/bash ../libtool  --tag=CXX   --mode=link crepair-cxx  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -no-undefined -version-info 7:5:2   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o libtiffxx.la -rpath /usr/local/lib tif_stream.lo ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: rm -fr  .libs/libtiffxx.a .libs/libtiffxx.la .libs/libtiffxx.lai
libtool: link: (cd .libs/libtiffxx.lax/libport.a && ar x "/data/vulnloc/libtiff/CVE-2017-7600/src/libtiff/../port/.libs/libport.a")
libtool: link: ar cru .libs/libtiffxx.a  tif_stream.o  .libs/libtiffxx.lax/libport.a/dummy.o 
ar: `u' modifier ignored since `D' is the default (see `U')
libtool: link: ranlib .libs/libtiffxx.a
libtool: link: rm -fr .libs/libtiffxx.lax
libtool: link: ( cd ".libs" && rm -f "libtiffxx.la" && ln -s "../libtiffxx.la" "libtiffxx.la" )
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/libtiff'
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/libtiff'
Making all in tools
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/tools'
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o bmp2tiff bmp2tiff.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o bmp2tiff bmp2tiff.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o fax2ps fax2ps.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o fax2ps fax2ps.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o fax2tiff fax2tiff.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o fax2tiff fax2tiff.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o gif2tiff gif2tiff.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o gif2tiff gif2tiff.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o pal2rgb pal2rgb.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o pal2rgb pal2rgb.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o ppm2tiff ppm2tiff.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o ppm2tiff ppm2tiff.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o ras2tiff ras2tiff.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o ras2tiff ras2tiff.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o raw2tiff raw2tiff.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o raw2tiff raw2tiff.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o rgb2ycbcr rgb2ycbcr.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o rgb2ycbcr rgb2ycbcr.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o thumbnail thumbnail.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o thumbnail thumbnail.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o tiff2bw tiff2bw.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o tiff2bw tiff2bw.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o tiff2pdf tiff2pdf.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o tiff2pdf tiff2pdf.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o tiff2ps tiff2ps.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o tiff2ps tiff2ps.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o tiff2rgba tiff2rgba.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o tiff2rgba tiff2rgba.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o tiffcmp tiffcmp.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o tiffcmp tiffcmp.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o tiffcp tiffcp.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o tiffcp tiffcp.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o tiffcrop tiffcrop.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o tiffcrop tiffcrop.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o tiffdither tiffdither.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o tiffdither tiffdither.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o tiffdump tiffdump.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o tiffdump tiffdump.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o tiffinfo tiffinfo.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o tiffinfo tiffinfo.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o tiffmedian tiffmedian.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o tiffmedian tiffmedian.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o tiffset tiffset.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o tiffset tiffset.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o tiffsplit tiffsplit.o ../libtiff/libtiff.la ../port/libport.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o tiffsplit tiffsplit.o  -L/klee/build/lib -L/CrashRepair/lib ../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy ../port/.libs/libport.a -llzma -ljbig -ljpeg -lz -lm
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/tools'
Making all in build
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/build'
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/build'
make[2]: Nothing to be done for 'all-am'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/build'
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/build'
Making all in contrib
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib'
Making all in addtiffo
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/addtiffo'
/bin/bash ../../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o addtiffo addtiffo.o tif_overview.o tif_ovrcache.o ../../libtiff/libtiff.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o addtiffo addtiffo.o tif_overview.o tif_ovrcache.o  -L/klee/build/lib -L/CrashRepair/lib ../../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy -llzma -ljbig -ljpeg -lz -lm
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/addtiffo'
Making all in dbs
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/dbs'
Making all in xtiff
make[3]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/dbs/xtiff'
make[3]: Nothing to be done for 'all'.
make[3]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/dbs/xtiff'
make[3]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/dbs'
/bin/bash ../../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o tiff-bi tiff-bi.o ../../libtiff/libtiff.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o tiff-bi tiff-bi.o  -L/klee/build/lib -L/CrashRepair/lib ../../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o tiff-grayscale tiff-grayscale.o ../../libtiff/libtiff.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o tiff-grayscale tiff-grayscale.o  -L/klee/build/lib -L/CrashRepair/lib ../../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o tiff-palette tiff-palette.o ../../libtiff/libtiff.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o tiff-palette tiff-palette.o  -L/klee/build/lib -L/CrashRepair/lib ../../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy -llzma -ljbig -ljpeg -lz -lm
/bin/bash ../../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o tiff-rgb tiff-rgb.o ../../libtiff/libtiff.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o tiff-rgb tiff-rgb.o  -L/klee/build/lib -L/CrashRepair/lib ../../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy -llzma -ljbig -ljpeg -lz -lm
make[3]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/dbs'
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/dbs'
Making all in iptcutil
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/iptcutil'
/bin/bash ../../libtool  --tag=CC   --mode=link crepair-cc  -fsanitize=float-cast-overflow -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy   -g -O0 -Wno-error -L/klee/build/lib -lkleeRuntest -I/CrashRepair/lib -L/CrashRepair/lib -lcrepair_runtime -lcrepair_proxy  -o iptcutil iptcutil.o ../../libtiff/libtiff.la -llzma -ljbig -ljpeg -lz -lm 
libtool: link: crepair-cc -fsanitize=float-cast-overflow -g -O0 -Wno-error -I/CrashRepair/lib -g -O0 -Wno-error -I/CrashRepair/lib -o iptcutil iptcutil.o  -L/klee/build/lib -L/CrashRepair/lib ../../libtiff/.libs/libtiff.a -lkleeRuntest -lcrepair_runtime -lcrepair_proxy -llzma -ljbig -ljpeg -lz -lm
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/iptcutil'
Making all in mfs
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/mfs'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/mfs'
Making all in pds
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/pds'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/pds'
Making all in ras
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/ras'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/ras'
Making all in stream
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/stream'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/stream'
Making all in tags
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/tags'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/tags'
Making all in win_dib
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/win_dib'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib/win_dib'
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib'
make[2]: Nothing to be done for 'all-am'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib'
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/contrib'
Making all in test
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/test'
make[1]: Nothing to be done for 'all'.
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/test'
Making all in man
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/man'
make[1]: Nothing to be done for 'all'.
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/man'
Making all in html
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/html'
Making all in images
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/html/images'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/html/images'
Making all in man
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/html/man'
make[2]: Nothing to be done for 'all'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/html/man'
make[2]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src/html'
make[2]: Nothing to be done for 'all-am'.
make[2]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/html'
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src/html'
make[1]: Entering directory '/data/vulnloc/libtiff/CVE-2017-7600/src'
make[1]: Nothing to be done for 'all-am'.
make[1]: Leaving directory '/data/vulnloc/libtiff/CVE-2017-7600/src'
2025-02-05 21:11:46.574 | DEBUG    | scenario:evaluate:655 - testing candidate #29 against test #crash...
2025-02-05 21:11:46.574 | DEBUG    | shell:__call__:41 - executing: /data/vulnloc/libtiff/CVE-2017-7600/src/tools/tiffcp -i /CrashRepair/experiments/vulnloc/libtiff/CVE-2017-7600/tests/1.tif out.tiff
2025-02-05 21:11:46.581 | INFO     | scenario:evaluate:659 - candidate #29 passes test #crash
2025-02-05 21:11:46.581 | INFO     | scenario:evaluate:674 - repair found! candidate #29 passes all tests
2025-02-05 21:11:46.591 | INFO     | scenario:validate:513 - saving successful patch #29...
2025-02-05 21:11:46.591 | INFO     | scenario:validate:520 - stopping search: patch was found

