@@ -127,6 +127,7 @@
 * Create and destroy operations.
 \******************************************************************************/
 
+
 jas_image_t *jas_image_create(int numcmpts, jas_image_cmptparm_t *cmptparms,
   int clrspc)
 {
@@ -159,8 +160,13 @@
 	rawsize = 0;
 	for (cmptno = 0, cmptparm = cmptparms; cmptno < numcmpts; ++cmptno,
 	  ++cmptparm) {
-		rawsize += cmptparm->width * cmptparm->height *
-		  (cmptparm->prec + 7) / 8;
+		if (cmptparm->prec > 0 && cmptparm->prec <= 32) { // Added bounds check
+			rawsize += cmptparm->width * cmptparm->height *
+			  (cmptparm->prec + 7) / 8;
+		} else {
+			jas_image_destroy(image);
+			return 0; // Handle invalid precision
+		}
 	}
 	/* Decide whether to buffer the image data in memory, based on the
 	  raw size of the image. */
@@ -186,6 +192,7 @@
 	return image;
 }
 
+
 jas_image_t *jas_image_create0()
 {
 	jas_image_t *image;
