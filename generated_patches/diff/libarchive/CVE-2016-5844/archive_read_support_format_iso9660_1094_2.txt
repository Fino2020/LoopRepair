@@ -1074,6 +1074,7 @@
 	return (ARCHIVE_OK);
 }
 
+
 static int
 choose_volume(struct archive_read *a, struct iso9660 *iso9660)
 {
@@ -1091,6 +1092,11 @@
 		/* This condition is unlikely; by way of caution. */
 		vd = &(iso9660->joliet);
 
+	if (vd->location < 0 || vd->location * LOGICAL_BLOCK_SIZE < 0) {
+		archive_set_error(&a->archive, ARCHIVE_ERRNO_MISC,
+		    "Invalid volume location");
+		return (ARCHIVE_FATAL);
+	}
 	skipsize = LOGICAL_BLOCK_SIZE * vd->location;
 	skipsize = __archive_read_consume(a, skipsize);
 	if (skipsize < 0)
@@ -1162,6 +1168,7 @@
 	return (ARCHIVE_OK);
 }
 
+
 static int
 archive_read_format_iso9660_read_header(struct archive_read *a,
     struct archive_entry *entry)
