@@ -122,6 +122,7 @@
 #undef EXTRASAMPLE_COREL_UNASSALPHA
 }
 
+
 static uint32
 checkInkNamesString(TIFF* tif, uint32 slen, const char* s)
 {
@@ -129,25 +130,27 @@
 	uint16 i = td->td_samplesperpixel;
 
 	if (slen > 0) {
-		const char* ep = s+slen;
+		const char* ep = s + slen;
 		const char* cp = s;
 		for (; i > 0; i--) {
-			for (; *cp != '\0'; cp++)
-				if (cp >= ep)
-					goto bad;
+			for (; cp < ep && *cp != '\0'; cp++)
+				; // Continue moving cp until we reach the end or '\0'
+			if (cp >= ep) // Check if we exhausted the length
+				goto bad;
 			cp++;				/* skip \0 */
 		}
-		return ((uint32)(cp-s));
+		return ((uint32)(cp - s));
 	}
 bad:
 	TIFFErrorExt(tif->tif_clientdata, "TIFFSetField",
 	    "%s: Invalid InkNames value; expecting %d names, found %d",
 	    tif->tif_name,
 	    td->td_samplesperpixel,
-	    td->td_samplesperpixel-i);
+	    td->td_samplesperpixel - i);
 	return (0);
 }
 
+
 static int
 _TIFFVSetField(TIFF* tif, uint32 tag, va_list ap)
 {
