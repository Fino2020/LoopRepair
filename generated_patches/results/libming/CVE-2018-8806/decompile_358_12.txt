@@ -301,6 +301,7 @@
 };
 
 
+
 static char *
 getString(struct SWF_ACTIONPUSHPARAM *act)
 {
@@ -355,19 +356,30 @@
 		}
 		return t;
 	case PUSH_CONSTANT: /* CONSTANT8 */
-		t=malloc(strlenext(pool[act->p.Constant8])+3); /* 2 "'"s and a NULL */
-		if (t) {
-			strcpy(t,"'");
-			strcatext(t,pool[act->p.Constant8]);
-			strcat(t,"'");
+		if (act->p.Constant8 < sizeof(pool) / sizeof(pool[0])) {
+			t=malloc(strlenext(pool[act->p.Constant8])+3); /* 2 "'"s and a NULL */
+			if (t) {
+				strcpy(t,"'");
+				strcatext(t,pool[act->p.Constant8]);
+				strcat(t,"'");
+			}
+			return t;
+		} else {
+			fprintf(stderr, "Error: Constant8 index out of bounds: %d\n", act->p.Constant8);
+			return "";
 		}
-		return t;
 	case PUSH_CONSTANT16: /* CONSTANT16 */
-		t=malloc(strlenext(pool[act->p.Constant16])+3); /* 2 '\"'s and a NULL */
-		if (t) {
-			strcpy(t,"'");
-			strcatext(t,pool[act->p.Constant16]);
-			strcat(t,"'");
+		if (act->p.Constant16 < sizeof(pool) / sizeof(pool[0])) {
+			t=malloc(strlenext(pool[act->p.Constant16])+3); /* 2 "'"s and a NULL */
+			if (t) {
+				strcpy(t,"'");
+				strcatext(t,pool[act->p.Constant16]);
+				strcat(t,"'");
+			}
+			return t;
+		} else {
+			fprintf(stderr, "Error: Constant16 index out of bounds: %d\n", act->p.Constant16);
+			return "";
 		}
 
 	case 12:
@@ -382,6 +394,7 @@
 }
 
 
+
 static char *
 getName(struct SWF_ACTIONPUSHPARAM *act)
 {
