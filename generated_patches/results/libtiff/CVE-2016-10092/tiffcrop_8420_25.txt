@@ -8389,6 +8389,7 @@
   return (0);
   }
 
+
 static int readContigStripsIntoBuffer (TIFF* in, uint8* buf)
 {
         uint8* bufp = buf;
@@ -8417,12 +8418,17 @@
                                   (unsigned long) strip, (unsigned long)rows);
                         return 0;
                 }
-                bufp += bytes_read;
+                if (bytes_read > 0) {
+                    bufp += bytes_read;
+                } else {
+                    break; // Break if no bytes were read to prevent buffer overrun
+                }
         }
 
         return 1;
 }
 
+
 static int
 combineSeparateSamplesBytes (unsigned char *srcbuffs[], unsigned char *out,
                              uint32 cols, uint32 rows, uint16 spp, uint16 bps,
